function Oy(e,s){for(var n=0;n<s.length;n++){const o=s[n];if(typeof o!="string"&&!Array.isArray(o)){for(const l in o)if(l!=="default"&&!(l in e)){const c=Object.getOwnPropertyDescriptor(o,l);c&&Object.defineProperty(e,l,c.get?c:{enumerable:!0,get:()=>o[l]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function n(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(l){if(l.ep)return;l.ep=!0;const c=n(l);fetch(l.href,c)}})();function Iu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Qg={exports:{}},_l={},qg={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ao=Symbol.for("react.element"),Ny=Symbol.for("react.portal"),Uy=Symbol.for("react.fragment"),zy=Symbol.for("react.strict_mode"),Hy=Symbol.for("react.profiler"),jy=Symbol.for("react.provider"),Wy=Symbol.for("react.context"),Vy=Symbol.for("react.forward_ref"),Gy=Symbol.for("react.suspense"),Xy=Symbol.for("react.memo"),$y=Symbol.for("react.lazy"),hp=Symbol.iterator;function Yy(e){return e===null||typeof e!="object"?null:(e=hp&&e[hp]||e["@@iterator"],typeof e=="function"?e:null)}var Zg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kg=Object.assign,Jg={};function lr(e,s,n){this.props=e,this.context=s,this.refs=Jg,this.updater=n||Zg}lr.prototype.isReactComponent={};lr.prototype.setState=function(e,s){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,s,"setState")};lr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function tm(){}tm.prototype=lr.prototype;function Du(e,s,n){this.props=e,this.context=s,this.refs=Jg,this.updater=n||Zg}var ku=Du.prototype=new tm;ku.constructor=Du;Kg(ku,lr.prototype);ku.isPureReactComponent=!0;var cp=Array.isArray,em=Object.prototype.hasOwnProperty,Fu={current:null},im={key:!0,ref:!0,__self:!0,__source:!0};function sm(e,s,n){var o,l={},c=null,f=null;if(s!=null)for(o in s.ref!==void 0&&(f=s.ref),s.key!==void 0&&(c=""+s.key),s)em.call(s,o)&&!im.hasOwnProperty(o)&&(l[o]=s[o]);var g=arguments.length-2;if(g===1)l.children=n;else if(1<g){for(var _=Array(g),v=0;v<g;v++)_[v]=arguments[v+2];l.children=_}if(e&&e.defaultProps)for(o in g=e.defaultProps,g)l[o]===void 0&&(l[o]=g[o]);return{$$typeof:Ao,type:e,key:c,ref:f,props:l,_owner:Fu.current}}function Qy(e,s){return{$$typeof:Ao,type:e.type,key:s,ref:e.ref,props:e.props,_owner:e._owner}}function Bu(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ao}function qy(e){var s={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return s[n]})}var up=/\/+/g;function Xh(e,s){return typeof e=="object"&&e!==null&&e.key!=null?qy(""+e.key):s.toString(36)}function Ta(e,s,n,o,l){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(c){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case Ao:case Ny:f=!0}}if(f)return f=e,l=l(f),e=o===""?"."+Xh(f,0):o,cp(l)?(n="",e!=null&&(n=e.replace(up,"$&/")+"/"),Ta(l,s,n,"",function(v){return v})):l!=null&&(Bu(l)&&(l=Qy(l,n+(!l.key||f&&f.key===l.key?"":(""+l.key).replace(up,"$&/")+"/")+e)),s.push(l)),1;if(f=0,o=o===""?".":o+":",cp(e))for(var g=0;g<e.length;g++){c=e[g];var _=o+Xh(c,g);f+=Ta(c,s,n,_,l)}else if(_=Yy(e),typeof _=="function")for(e=_.call(e),g=0;!(c=e.next()).done;)c=c.value,_=o+Xh(c,g++),f+=Ta(c,s,n,_,l);else if(c==="object")throw s=String(e),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return f}function ca(e,s,n){if(e==null)return e;var o=[],l=0;return Ta(e,o,"","",function(c){return s.call(n,c,l++)}),o}function Zy(e){if(e._status===-1){var s=e._result;s=s(),s.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=s)}if(e._status===1)return e._result.default;throw e._result}var Fe={current:null},Pa={transition:null},Ky={ReactCurrentDispatcher:Fe,ReactCurrentBatchConfig:Pa,ReactCurrentOwner:Fu};function nm(){throw Error("act(...) is not supported in production builds of React.")}yt.Children={map:ca,forEach:function(e,s,n){ca(e,function(){s.apply(this,arguments)},n)},count:function(e){var s=0;return ca(e,function(){s++}),s},toArray:function(e){return ca(e,function(s){return s})||[]},only:function(e){if(!Bu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};yt.Component=lr;yt.Fragment=Uy;yt.Profiler=Hy;yt.PureComponent=Du;yt.StrictMode=zy;yt.Suspense=Gy;yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ky;yt.act=nm;yt.cloneElement=function(e,s,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=Kg({},e.props),l=e.key,c=e.ref,f=e._owner;if(s!=null){if(s.ref!==void 0&&(c=s.ref,f=Fu.current),s.key!==void 0&&(l=""+s.key),e.type&&e.type.defaultProps)var g=e.type.defaultProps;for(_ in s)em.call(s,_)&&!im.hasOwnProperty(_)&&(o[_]=s[_]===void 0&&g!==void 0?g[_]:s[_])}var _=arguments.length-2;if(_===1)o.children=n;else if(1<_){g=Array(_);for(var v=0;v<_;v++)g[v]=arguments[v+2];o.children=g}return{$$typeof:Ao,type:e.type,key:l,ref:c,props:o,_owner:f}};yt.createContext=function(e){return e={$$typeof:Wy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:jy,_context:e},e.Consumer=e};yt.createElement=sm;yt.createFactory=function(e){var s=sm.bind(null,e);return s.type=e,s};yt.createRef=function(){return{current:null}};yt.forwardRef=function(e){return{$$typeof:Vy,render:e}};yt.isValidElement=Bu;yt.lazy=function(e){return{$$typeof:$y,_payload:{_status:-1,_result:e},_init:Zy}};yt.memo=function(e,s){return{$$typeof:Xy,type:e,compare:s===void 0?null:s}};yt.startTransition=function(e){var s=Pa.transition;Pa.transition={};try{e()}finally{Pa.transition=s}};yt.unstable_act=nm;yt.useCallback=function(e,s){return Fe.current.useCallback(e,s)};yt.useContext=function(e){return Fe.current.useContext(e)};yt.useDebugValue=function(){};yt.useDeferredValue=function(e){return Fe.current.useDeferredValue(e)};yt.useEffect=function(e,s){return Fe.current.useEffect(e,s)};yt.useId=function(){return Fe.current.useId()};yt.useImperativeHandle=function(e,s,n){return Fe.current.useImperativeHandle(e,s,n)};yt.useInsertionEffect=function(e,s){return Fe.current.useInsertionEffect(e,s)};yt.useLayoutEffect=function(e,s){return Fe.current.useLayoutEffect(e,s)};yt.useMemo=function(e,s){return Fe.current.useMemo(e,s)};yt.useReducer=function(e,s,n){return Fe.current.useReducer(e,s,n)};yt.useRef=function(e){return Fe.current.useRef(e)};yt.useState=function(e){return Fe.current.useState(e)};yt.useSyncExternalStore=function(e,s,n){return Fe.current.useSyncExternalStore(e,s,n)};yt.useTransition=function(){return Fe.current.useTransition()};yt.version="18.3.1";qg.exports=yt;var Y=qg.exports;const Ki=Iu(Y),Jy=Oy({__proto__:null,default:Ki},[Y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tw=Y,ew=Symbol.for("react.element"),iw=Symbol.for("react.fragment"),sw=Object.prototype.hasOwnProperty,nw=tw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rw={key:!0,ref:!0,__self:!0,__source:!0};function rm(e,s,n){var o,l={},c=null,f=null;n!==void 0&&(c=""+n),s.key!==void 0&&(c=""+s.key),s.ref!==void 0&&(f=s.ref);for(o in s)sw.call(s,o)&&!rw.hasOwnProperty(o)&&(l[o]=s[o]);if(e&&e.defaultProps)for(o in s=e.defaultProps,s)l[o]===void 0&&(l[o]=s[o]);return{$$typeof:ew,type:e,key:c,ref:f,props:l,_owner:nw.current}}_l.Fragment=iw;_l.jsx=rm;_l.jsxs=rm;Qg.exports=_l;var q=Qg.exports,Tc={},om={exports:{}},ri={},am={exports:{}},lm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function s(st,lt){var dt=st.length;st.push(lt);t:for(;0<dt;){var Et=dt-1>>>1,Tt=st[Et];if(0<l(Tt,lt))st[Et]=lt,st[dt]=Tt,dt=Et;else break t}}function n(st){return st.length===0?null:st[0]}function o(st){if(st.length===0)return null;var lt=st[0],dt=st.pop();if(dt!==lt){st[0]=dt;t:for(var Et=0,Tt=st.length,Hi=Tt>>>1;Et<Hi;){var Ye=2*(Et+1)-1,Qt=st[Ye],xt=Ye+1,ji=st[xt];if(0>l(Qt,dt))xt<Tt&&0>l(ji,Qt)?(st[Et]=ji,st[xt]=dt,Et=xt):(st[Et]=Qt,st[Ye]=dt,Et=Ye);else if(xt<Tt&&0>l(ji,dt))st[Et]=ji,st[xt]=dt,Et=xt;else break t}}return lt}function l(st,lt){var dt=st.sortIndex-lt.sortIndex;return dt!==0?dt:st.id-lt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var f=Date,g=f.now();e.unstable_now=function(){return f.now()-g}}var _=[],v=[],x=1,S=null,T=3,D=!1,F=!1,O=!1,L=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(st){for(var lt=n(v);lt!==null;){if(lt.callback===null)o(v);else if(lt.startTime<=st)o(v),lt.sortIndex=lt.expirationTime,s(_,lt);else break;lt=n(v)}}function H(st){if(O=!1,I(st),!F)if(n(_)!==null)F=!0,et(j);else{var lt=n(v);lt!==null&&gi(H,lt.startTime-st)}}function j(st,lt){F=!1,O&&(O=!1,P(B),B=-1),D=!0;var dt=T;try{for(I(lt),S=n(_);S!==null&&(!(S.expirationTime>lt)||st&&!at());){var Et=S.callback;if(typeof Et=="function"){S.callback=null,T=S.priorityLevel;var Tt=Et(S.expirationTime<=lt);lt=e.unstable_now(),typeof Tt=="function"?S.callback=Tt:S===n(_)&&o(_),I(lt)}else o(_);S=n(_)}if(S!==null)var Hi=!0;else{var Ye=n(v);Ye!==null&&gi(H,Ye.startTime-lt),Hi=!1}return Hi}finally{S=null,T=dt,D=!1}}var Z=!1,E=null,B=-1,G=5,nt=-1;function at(){return!(e.unstable_now()-nt<G)}function J(){if(E!==null){var st=e.unstable_now();nt=st;var lt=!0;try{lt=E(!0,st)}finally{lt?Gt():(Z=!1,E=null)}}else Z=!1}var Gt;if(typeof A=="function")Gt=function(){A(J)};else if(typeof MessageChannel<"u"){var Jt=new MessageChannel,vt=Jt.port2;Jt.port1.onmessage=J,Gt=function(){vt.postMessage(null)}}else Gt=function(){L(J,0)};function et(st){E=st,Z||(Z=!0,Gt())}function gi(st,lt){B=L(function(){st(e.unstable_now())},lt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(st){st.callback=null},e.unstable_continueExecution=function(){F||D||(F=!0,et(j))},e.unstable_forceFrameRate=function(st){0>st||125<st?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<st?Math.floor(1e3/st):5},e.unstable_getCurrentPriorityLevel=function(){return T},e.unstable_getFirstCallbackNode=function(){return n(_)},e.unstable_next=function(st){switch(T){case 1:case 2:case 3:var lt=3;break;default:lt=T}var dt=T;T=lt;try{return st()}finally{T=dt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(st,lt){switch(st){case 1:case 2:case 3:case 4:case 5:break;default:st=3}var dt=T;T=st;try{return lt()}finally{T=dt}},e.unstable_scheduleCallback=function(st,lt,dt){var Et=e.unstable_now();switch(typeof dt=="object"&&dt!==null?(dt=dt.delay,dt=typeof dt=="number"&&0<dt?Et+dt:Et):dt=Et,st){case 1:var Tt=-1;break;case 2:Tt=250;break;case 5:Tt=1073741823;break;case 4:Tt=1e4;break;default:Tt=5e3}return Tt=dt+Tt,st={id:x++,callback:lt,priorityLevel:st,startTime:dt,expirationTime:Tt,sortIndex:-1},dt>Et?(st.sortIndex=dt,s(v,st),n(_)===null&&st===n(v)&&(O?(P(B),B=-1):O=!0,gi(H,dt-Et))):(st.sortIndex=Tt,s(_,st),F||D||(F=!0,et(j))),st},e.unstable_shouldYield=at,e.unstable_wrapCallback=function(st){var lt=T;return function(){var dt=T;T=lt;try{return st.apply(this,arguments)}finally{T=dt}}}})(lm);am.exports=lm;var ow=am.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aw=Y,ni=ow;function K(e){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)s+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hm=new Set,no={};function pn(e,s){er(e,s),er(e+"Capture",s)}function er(e,s){for(no[e]=s,e=0;e<s.length;e++)hm.add(s[e])}var ts=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pc=Object.prototype.hasOwnProperty,lw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dp={},fp={};function hw(e){return Pc.call(fp,e)?!0:Pc.call(dp,e)?!1:lw.test(e)?fp[e]=!0:(dp[e]=!0,!1)}function cw(e,s,n,o){if(n!==null&&n.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return o?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function uw(e,s,n,o){if(s===null||typeof s>"u"||cw(e,s,n,o))return!0;if(o)return!1;if(n!==null)switch(n.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function Be(e,s,n,o,l,c,f){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=o,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=s,this.sanitizeURL=c,this.removeEmptyString=f}var we={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){we[e]=new Be(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var s=e[0];we[s]=new Be(s,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){we[e]=new Be(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){we[e]=new Be(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){we[e]=new Be(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){we[e]=new Be(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){we[e]=new Be(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){we[e]=new Be(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){we[e]=new Be(e,5,!1,e.toLowerCase(),null,!1,!1)});var Mu=/[\-:]([a-z])/g;function Lu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var s=e.replace(Mu,Lu);we[s]=new Be(s,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var s=e.replace(Mu,Lu);we[s]=new Be(s,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var s=e.replace(Mu,Lu);we[s]=new Be(s,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){we[e]=new Be(e,1,!1,e.toLowerCase(),null,!1,!1)});we.xlinkHref=new Be("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){we[e]=new Be(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ou(e,s,n,o){var l=we.hasOwnProperty(s)?we[s]:null;(l!==null?l.type!==0:o||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(uw(s,n,l,o)&&(n=null),o||l===null?hw(s)&&(n===null?e.removeAttribute(s):e.setAttribute(s,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(s=l.attributeName,o=l.attributeNamespace,n===null?e.removeAttribute(s):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,o?e.setAttributeNS(o,s,n):e.setAttribute(s,n))))}var ns=aw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ua=Symbol.for("react.element"),On=Symbol.for("react.portal"),Nn=Symbol.for("react.fragment"),Nu=Symbol.for("react.strict_mode"),Rc=Symbol.for("react.profiler"),cm=Symbol.for("react.provider"),um=Symbol.for("react.context"),Uu=Symbol.for("react.forward_ref"),Ic=Symbol.for("react.suspense"),Dc=Symbol.for("react.suspense_list"),zu=Symbol.for("react.memo"),ds=Symbol.for("react.lazy"),dm=Symbol.for("react.offscreen"),pp=Symbol.iterator;function Mr(e){return e===null||typeof e!="object"?null:(e=pp&&e[pp]||e["@@iterator"],typeof e=="function"?e:null)}var Ut=Object.assign,$h;function Gr(e){if($h===void 0)try{throw Error()}catch(n){var s=n.stack.trim().match(/\n( *(at )?)/);$h=s&&s[1]||""}return`
`+$h+e}var Yh=!1;function Qh(e,s){if(!e||Yh)return"";Yh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(v){var o=v}Reflect.construct(e,[],s)}else{try{s.call()}catch(v){o=v}e.call(s.prototype)}else{try{throw Error()}catch(v){o=v}e()}}catch(v){if(v&&o&&typeof v.stack=="string"){for(var l=v.stack.split(`
`),c=o.stack.split(`
`),f=l.length-1,g=c.length-1;1<=f&&0<=g&&l[f]!==c[g];)g--;for(;1<=f&&0<=g;f--,g--)if(l[f]!==c[g]){if(f!==1||g!==1)do if(f--,g--,0>g||l[f]!==c[g]){var _=`
`+l[f].replace(" at new "," at ");return e.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",e.displayName)),_}while(1<=f&&0<=g);break}}}finally{Yh=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Gr(e):""}function dw(e){switch(e.tag){case 5:return Gr(e.type);case 16:return Gr("Lazy");case 13:return Gr("Suspense");case 19:return Gr("SuspenseList");case 0:case 2:case 15:return e=Qh(e.type,!1),e;case 11:return e=Qh(e.type.render,!1),e;case 1:return e=Qh(e.type,!0),e;default:return""}}function kc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Nn:return"Fragment";case On:return"Portal";case Rc:return"Profiler";case Nu:return"StrictMode";case Ic:return"Suspense";case Dc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case um:return(e.displayName||"Context")+".Consumer";case cm:return(e._context.displayName||"Context")+".Provider";case Uu:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zu:return s=e.displayName||null,s!==null?s:kc(e.type)||"Memo";case ds:s=e._payload,e=e._init;try{return kc(e(s))}catch{}}return null}function fw(e){var s=e.type;switch(e.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=s.render,e=e.displayName||e.name||"",s.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kc(s);case 8:return s===Nu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Ts(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fm(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function pw(e){var s=fm(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,s),o=""+e[s];if(!e.hasOwnProperty(s)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,c=n.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return l.call(this)},set:function(f){o=""+f,c.call(this,f)}}),Object.defineProperty(e,s,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(f){o=""+f},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function da(e){e._valueTracker||(e._valueTracker=pw(e))}function pm(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var n=s.getValue(),o="";return e&&(o=fm(e)?e.checked?"true":"false":e.value),e=o,e!==n?(s.setValue(e),!0):!1}function ja(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Fc(e,s){var n=s.checked;return Ut({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function gp(e,s){var n=s.defaultValue==null?"":s.defaultValue,o=s.checked!=null?s.checked:s.defaultChecked;n=Ts(s.value!=null?s.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function gm(e,s){s=s.checked,s!=null&&Ou(e,"checked",s,!1)}function Bc(e,s){gm(e,s);var n=Ts(s.value),o=s.type;if(n!=null)o==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}s.hasOwnProperty("value")?Mc(e,s.type,n):s.hasOwnProperty("defaultValue")&&Mc(e,s.type,Ts(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(e.defaultChecked=!!s.defaultChecked)}function mp(e,s,n){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var o=s.type;if(!(o!=="submit"&&o!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+e._wrapperState.initialValue,n||s===e.value||(e.value=s),e.defaultValue=s}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Mc(e,s,n){(s!=="number"||ja(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Xr=Array.isArray;function Qn(e,s,n,o){if(e=e.options,s){s={};for(var l=0;l<n.length;l++)s["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=s.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&o&&(e[n].defaultSelected=!0)}else{for(n=""+Ts(n),s=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,o&&(e[l].defaultSelected=!0);return}s!==null||e[l].disabled||(s=e[l])}s!==null&&(s.selected=!0)}}function Lc(e,s){if(s.dangerouslySetInnerHTML!=null)throw Error(K(91));return Ut({},s,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function _p(e,s){var n=s.value;if(n==null){if(n=s.children,s=s.defaultValue,n!=null){if(s!=null)throw Error(K(92));if(Xr(n)){if(1<n.length)throw Error(K(93));n=n[0]}s=n}s==null&&(s=""),n=s}e._wrapperState={initialValue:Ts(n)}}function mm(e,s){var n=Ts(s.value),o=Ts(s.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),s.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),o!=null&&(e.defaultValue=""+o)}function vp(e){var s=e.textContent;s===e._wrapperState.initialValue&&s!==""&&s!==null&&(e.value=s)}function _m(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Oc(e,s){return e==null||e==="http://www.w3.org/1999/xhtml"?_m(s):e==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var fa,vm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,n,o,l){MSApp.execUnsafeLocalFunction(function(){return e(s,n,o,l)})}:e}(function(e,s){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=s;else{for(fa=fa||document.createElement("div"),fa.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=fa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;s.firstChild;)e.appendChild(s.firstChild)}});function ro(e,s){if(s){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=s;return}}e.textContent=s}var Qr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gw=["Webkit","ms","Moz","O"];Object.keys(Qr).forEach(function(e){gw.forEach(function(s){s=s+e.charAt(0).toUpperCase()+e.substring(1),Qr[s]=Qr[e]})});function ym(e,s,n){return s==null||typeof s=="boolean"||s===""?"":n||typeof s!="number"||s===0||Qr.hasOwnProperty(e)&&Qr[e]?(""+s).trim():s+"px"}function wm(e,s){e=e.style;for(var n in s)if(s.hasOwnProperty(n)){var o=n.indexOf("--")===0,l=ym(n,s[n],o);n==="float"&&(n="cssFloat"),o?e.setProperty(n,l):e[n]=l}}var mw=Ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nc(e,s){if(s){if(mw[e]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(K(137,e));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(K(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(K(61))}if(s.style!=null&&typeof s.style!="object")throw Error(K(62))}}function Uc(e,s){if(e.indexOf("-")===-1)return typeof s.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zc=null;function Hu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Hc=null,qn=null,Zn=null;function yp(e){if(e=Ro(e)){if(typeof Hc!="function")throw Error(K(280));var s=e.stateNode;s&&(s=bl(s),Hc(e.stateNode,e.type,s))}}function xm(e){qn?Zn?Zn.push(e):Zn=[e]:qn=e}function bm(){if(qn){var e=qn,s=Zn;if(Zn=qn=null,yp(e),s)for(e=0;e<s.length;e++)yp(s[e])}}function Cm(e,s){return e(s)}function Sm(){}var qh=!1;function Em(e,s,n){if(qh)return e(s,n);qh=!0;try{return Cm(e,s,n)}finally{qh=!1,(qn!==null||Zn!==null)&&(Sm(),bm())}}function oo(e,s){var n=e.stateNode;if(n===null)return null;var o=bl(n);if(o===null)return null;n=o[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break t;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(K(231,s,typeof n));return n}var jc=!1;if(ts)try{var Lr={};Object.defineProperty(Lr,"passive",{get:function(){jc=!0}}),window.addEventListener("test",Lr,Lr),window.removeEventListener("test",Lr,Lr)}catch{jc=!1}function _w(e,s,n,o,l,c,f,g,_){var v=Array.prototype.slice.call(arguments,3);try{s.apply(n,v)}catch(x){this.onError(x)}}var qr=!1,Wa=null,Va=!1,Wc=null,vw={onError:function(e){qr=!0,Wa=e}};function yw(e,s,n,o,l,c,f,g,_){qr=!1,Wa=null,_w.apply(vw,arguments)}function ww(e,s,n,o,l,c,f,g,_){if(yw.apply(this,arguments),qr){if(qr){var v=Wa;qr=!1,Wa=null}else throw Error(K(198));Va||(Va=!0,Wc=v)}}function gn(e){var s=e,n=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,s.flags&4098&&(n=s.return),e=s.return;while(e)}return s.tag===3?n:null}function Am(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function wp(e){if(gn(e)!==e)throw Error(K(188))}function xw(e){var s=e.alternate;if(!s){if(s=gn(e),s===null)throw Error(K(188));return s!==e?null:e}for(var n=e,o=s;;){var l=n.return;if(l===null)break;var c=l.alternate;if(c===null){if(o=l.return,o!==null){n=o;continue}break}if(l.child===c.child){for(c=l.child;c;){if(c===n)return wp(l),e;if(c===o)return wp(l),s;c=c.sibling}throw Error(K(188))}if(n.return!==o.return)n=l,o=c;else{for(var f=!1,g=l.child;g;){if(g===n){f=!0,n=l,o=c;break}if(g===o){f=!0,o=l,n=c;break}g=g.sibling}if(!f){for(g=c.child;g;){if(g===n){f=!0,n=c,o=l;break}if(g===o){f=!0,o=c,n=l;break}g=g.sibling}if(!f)throw Error(K(189))}}if(n.alternate!==o)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?e:s}function Tm(e){return e=xw(e),e!==null?Pm(e):null}function Pm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var s=Pm(e);if(s!==null)return s;e=e.sibling}return null}var Rm=ni.unstable_scheduleCallback,xp=ni.unstable_cancelCallback,bw=ni.unstable_shouldYield,Cw=ni.unstable_requestPaint,$t=ni.unstable_now,Sw=ni.unstable_getCurrentPriorityLevel,ju=ni.unstable_ImmediatePriority,Im=ni.unstable_UserBlockingPriority,Ga=ni.unstable_NormalPriority,Ew=ni.unstable_LowPriority,Dm=ni.unstable_IdlePriority,vl=null,Ui=null;function Aw(e){if(Ui&&typeof Ui.onCommitFiberRoot=="function")try{Ui.onCommitFiberRoot(vl,e,void 0,(e.current.flags&128)===128)}catch{}}var Ci=Math.clz32?Math.clz32:Rw,Tw=Math.log,Pw=Math.LN2;function Rw(e){return e>>>=0,e===0?32:31-(Tw(e)/Pw|0)|0}var pa=64,ga=4194304;function $r(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xa(e,s){var n=e.pendingLanes;if(n===0)return 0;var o=0,l=e.suspendedLanes,c=e.pingedLanes,f=n&268435455;if(f!==0){var g=f&~l;g!==0?o=$r(g):(c&=f,c!==0&&(o=$r(c)))}else f=n&~l,f!==0?o=$r(f):c!==0&&(o=$r(c));if(o===0)return 0;if(s!==0&&s!==o&&!(s&l)&&(l=o&-o,c=s&-s,l>=c||l===16&&(c&4194240)!==0))return s;if(o&4&&(o|=n&16),s=e.entangledLanes,s!==0)for(e=e.entanglements,s&=o;0<s;)n=31-Ci(s),l=1<<n,o|=e[n],s&=~l;return o}function Iw(e,s){switch(e){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dw(e,s){for(var n=e.suspendedLanes,o=e.pingedLanes,l=e.expirationTimes,c=e.pendingLanes;0<c;){var f=31-Ci(c),g=1<<f,_=l[f];_===-1?(!(g&n)||g&o)&&(l[f]=Iw(g,s)):_<=s&&(e.expiredLanes|=g),c&=~g}}function Vc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function km(){var e=pa;return pa<<=1,!(pa&4194240)&&(pa=64),e}function Zh(e){for(var s=[],n=0;31>n;n++)s.push(e);return s}function To(e,s,n){e.pendingLanes|=s,s!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,s=31-Ci(s),e[s]=n}function kw(e,s){var n=e.pendingLanes&~s;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=s,e.mutableReadLanes&=s,e.entangledLanes&=s,s=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-Ci(n),c=1<<l;s[l]=0,o[l]=-1,e[l]=-1,n&=~c}}function Wu(e,s){var n=e.entangledLanes|=s;for(e=e.entanglements;n;){var o=31-Ci(n),l=1<<o;l&s|e[o]&s&&(e[o]|=s),n&=~l}}var St=0;function Fm(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Bm,Vu,Mm,Lm,Om,Gc=!1,ma=[],ys=null,ws=null,xs=null,ao=new Map,lo=new Map,ps=[],Fw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bp(e,s){switch(e){case"focusin":case"focusout":ys=null;break;case"dragenter":case"dragleave":ws=null;break;case"mouseover":case"mouseout":xs=null;break;case"pointerover":case"pointerout":ao.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":lo.delete(s.pointerId)}}function Or(e,s,n,o,l,c){return e===null||e.nativeEvent!==c?(e={blockedOn:s,domEventName:n,eventSystemFlags:o,nativeEvent:c,targetContainers:[l]},s!==null&&(s=Ro(s),s!==null&&Vu(s)),e):(e.eventSystemFlags|=o,s=e.targetContainers,l!==null&&s.indexOf(l)===-1&&s.push(l),e)}function Bw(e,s,n,o,l){switch(s){case"focusin":return ys=Or(ys,e,s,n,o,l),!0;case"dragenter":return ws=Or(ws,e,s,n,o,l),!0;case"mouseover":return xs=Or(xs,e,s,n,o,l),!0;case"pointerover":var c=l.pointerId;return ao.set(c,Or(ao.get(c)||null,e,s,n,o,l)),!0;case"gotpointercapture":return c=l.pointerId,lo.set(c,Or(lo.get(c)||null,e,s,n,o,l)),!0}return!1}function Nm(e){var s=Js(e.target);if(s!==null){var n=gn(s);if(n!==null){if(s=n.tag,s===13){if(s=Am(n),s!==null){e.blockedOn=s,Om(e.priority,function(){Mm(n)});return}}else if(s===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ra(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var n=Xc(e.domEventName,e.eventSystemFlags,s[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var o=new n.constructor(n.type,n);zc=o,n.target.dispatchEvent(o),zc=null}else return s=Ro(n),s!==null&&Vu(s),e.blockedOn=n,!1;s.shift()}return!0}function Cp(e,s,n){Ra(e)&&n.delete(s)}function Mw(){Gc=!1,ys!==null&&Ra(ys)&&(ys=null),ws!==null&&Ra(ws)&&(ws=null),xs!==null&&Ra(xs)&&(xs=null),ao.forEach(Cp),lo.forEach(Cp)}function Nr(e,s){e.blockedOn===s&&(e.blockedOn=null,Gc||(Gc=!0,ni.unstable_scheduleCallback(ni.unstable_NormalPriority,Mw)))}function ho(e){function s(l){return Nr(l,e)}if(0<ma.length){Nr(ma[0],e);for(var n=1;n<ma.length;n++){var o=ma[n];o.blockedOn===e&&(o.blockedOn=null)}}for(ys!==null&&Nr(ys,e),ws!==null&&Nr(ws,e),xs!==null&&Nr(xs,e),ao.forEach(s),lo.forEach(s),n=0;n<ps.length;n++)o=ps[n],o.blockedOn===e&&(o.blockedOn=null);for(;0<ps.length&&(n=ps[0],n.blockedOn===null);)Nm(n),n.blockedOn===null&&ps.shift()}var Kn=ns.ReactCurrentBatchConfig,$a=!0;function Lw(e,s,n,o){var l=St,c=Kn.transition;Kn.transition=null;try{St=1,Gu(e,s,n,o)}finally{St=l,Kn.transition=c}}function Ow(e,s,n,o){var l=St,c=Kn.transition;Kn.transition=null;try{St=4,Gu(e,s,n,o)}finally{St=l,Kn.transition=c}}function Gu(e,s,n,o){if($a){var l=Xc(e,s,n,o);if(l===null)ac(e,s,o,Ya,n),bp(e,o);else if(Bw(l,e,s,n,o))o.stopPropagation();else if(bp(e,o),s&4&&-1<Fw.indexOf(e)){for(;l!==null;){var c=Ro(l);if(c!==null&&Bm(c),c=Xc(e,s,n,o),c===null&&ac(e,s,o,Ya,n),c===l)break;l=c}l!==null&&o.stopPropagation()}else ac(e,s,o,null,n)}}var Ya=null;function Xc(e,s,n,o){if(Ya=null,e=Hu(o),e=Js(e),e!==null)if(s=gn(e),s===null)e=null;else if(n=s.tag,n===13){if(e=Am(s),e!==null)return e;e=null}else if(n===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null);return Ya=e,null}function Um(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Sw()){case ju:return 1;case Im:return 4;case Ga:case Ew:return 16;case Dm:return 536870912;default:return 16}default:return 16}}var ms=null,Xu=null,Ia=null;function zm(){if(Ia)return Ia;var e,s=Xu,n=s.length,o,l="value"in ms?ms.value:ms.textContent,c=l.length;for(e=0;e<n&&s[e]===l[e];e++);var f=n-e;for(o=1;o<=f&&s[n-o]===l[c-o];o++);return Ia=l.slice(e,1<o?1-o:void 0)}function Da(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function _a(){return!0}function Sp(){return!1}function oi(e){function s(n,o,l,c,f){this._reactName=n,this._targetInst=l,this.type=o,this.nativeEvent=c,this.target=f,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(n=e[g],this[g]=n?n(c):c[g]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?_a:Sp,this.isPropagationStopped=Sp,this}return Ut(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_a)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_a)},persist:function(){},isPersistent:_a}),s}var hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$u=oi(hr),Po=Ut({},hr,{view:0,detail:0}),Nw=oi(Po),Kh,Jh,Ur,yl=Ut({},Po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ur&&(Ur&&e.type==="mousemove"?(Kh=e.screenX-Ur.screenX,Jh=e.screenY-Ur.screenY):Jh=Kh=0,Ur=e),Kh)},movementY:function(e){return"movementY"in e?e.movementY:Jh}}),Ep=oi(yl),Uw=Ut({},yl,{dataTransfer:0}),zw=oi(Uw),Hw=Ut({},Po,{relatedTarget:0}),tc=oi(Hw),jw=Ut({},hr,{animationName:0,elapsedTime:0,pseudoElement:0}),Ww=oi(jw),Vw=Ut({},hr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Gw=oi(Vw),Xw=Ut({},hr,{data:0}),Ap=oi(Xw),$w={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qw(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=Qw[e])?!!s[e]:!1}function Yu(){return qw}var Zw=Ut({},Po,{key:function(e){if(e.key){var s=$w[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=Da(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Yw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yu,charCode:function(e){return e.type==="keypress"?Da(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Da(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Kw=oi(Zw),Jw=Ut({},yl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tp=oi(Jw),tx=Ut({},Po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yu}),ex=oi(tx),ix=Ut({},hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),sx=oi(ix),nx=Ut({},yl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),rx=oi(nx),ox=[9,13,27,32],Qu=ts&&"CompositionEvent"in window,Zr=null;ts&&"documentMode"in document&&(Zr=document.documentMode);var ax=ts&&"TextEvent"in window&&!Zr,Hm=ts&&(!Qu||Zr&&8<Zr&&11>=Zr),Pp=" ",Rp=!1;function jm(e,s){switch(e){case"keyup":return ox.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Un=!1;function lx(e,s){switch(e){case"compositionend":return Wm(s);case"keypress":return s.which!==32?null:(Rp=!0,Pp);case"textInput":return e=s.data,e===Pp&&Rp?null:e;default:return null}}function hx(e,s){if(Un)return e==="compositionend"||!Qu&&jm(e,s)?(e=zm(),Ia=Xu=ms=null,Un=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Hm&&s.locale!=="ko"?null:s.data;default:return null}}var cx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ip(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!cx[e.type]:s==="textarea"}function Vm(e,s,n,o){xm(o),s=Qa(s,"onChange"),0<s.length&&(n=new $u("onChange","change",null,n,o),e.push({event:n,listeners:s}))}var Kr=null,co=null;function ux(e){e_(e,0)}function wl(e){var s=jn(e);if(pm(s))return e}function dx(e,s){if(e==="change")return s}var Gm=!1;if(ts){var ec;if(ts){var ic="oninput"in document;if(!ic){var Dp=document.createElement("div");Dp.setAttribute("oninput","return;"),ic=typeof Dp.oninput=="function"}ec=ic}else ec=!1;Gm=ec&&(!document.documentMode||9<document.documentMode)}function kp(){Kr&&(Kr.detachEvent("onpropertychange",Xm),co=Kr=null)}function Xm(e){if(e.propertyName==="value"&&wl(co)){var s=[];Vm(s,co,e,Hu(e)),Em(ux,s)}}function fx(e,s,n){e==="focusin"?(kp(),Kr=s,co=n,Kr.attachEvent("onpropertychange",Xm)):e==="focusout"&&kp()}function px(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wl(co)}function gx(e,s){if(e==="click")return wl(s)}function mx(e,s){if(e==="input"||e==="change")return wl(s)}function _x(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var Ei=typeof Object.is=="function"?Object.is:_x;function uo(e,s){if(Ei(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var n=Object.keys(e),o=Object.keys(s);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var l=n[o];if(!Pc.call(s,l)||!Ei(e[l],s[l]))return!1}return!0}function Fp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Bp(e,s){var n=Fp(e);e=0;for(var o;n;){if(n.nodeType===3){if(o=e+n.textContent.length,e<=s&&o>=s)return{node:n,offset:s-e};e=o}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=Fp(n)}}function $m(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?$m(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function Ym(){for(var e=window,s=ja();s instanceof e.HTMLIFrameElement;){try{var n=typeof s.contentWindow.location.href=="string"}catch{n=!1}if(n)e=s.contentWindow;else break;s=ja(e.document)}return s}function qu(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}function vx(e){var s=Ym(),n=e.focusedElem,o=e.selectionRange;if(s!==n&&n&&n.ownerDocument&&$m(n.ownerDocument.documentElement,n)){if(o!==null&&qu(n)){if(s=o.start,e=o.end,e===void 0&&(e=s),"selectionStart"in n)n.selectionStart=s,n.selectionEnd=Math.min(e,n.value.length);else if(e=(s=n.ownerDocument||document)&&s.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,c=Math.min(o.start,l);o=o.end===void 0?c:Math.min(o.end,l),!e.extend&&c>o&&(l=o,o=c,c=l),l=Bp(n,c);var f=Bp(n,o);l&&f&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(s=s.createRange(),s.setStart(l.node,l.offset),e.removeAllRanges(),c>o?(e.addRange(s),e.extend(f.node,f.offset)):(s.setEnd(f.node,f.offset),e.addRange(s)))}}for(s=[],e=n;e=e.parentNode;)e.nodeType===1&&s.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<s.length;n++)e=s[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var yx=ts&&"documentMode"in document&&11>=document.documentMode,zn=null,$c=null,Jr=null,Yc=!1;function Mp(e,s,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yc||zn==null||zn!==ja(o)||(o=zn,"selectionStart"in o&&qu(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Jr&&uo(Jr,o)||(Jr=o,o=Qa($c,"onSelect"),0<o.length&&(s=new $u("onSelect","select",null,s,n),e.push({event:s,listeners:o}),s.target=zn)))}function va(e,s){var n={};return n[e.toLowerCase()]=s.toLowerCase(),n["Webkit"+e]="webkit"+s,n["Moz"+e]="moz"+s,n}var Hn={animationend:va("Animation","AnimationEnd"),animationiteration:va("Animation","AnimationIteration"),animationstart:va("Animation","AnimationStart"),transitionend:va("Transition","TransitionEnd")},sc={},Qm={};ts&&(Qm=document.createElement("div").style,"AnimationEvent"in window||(delete Hn.animationend.animation,delete Hn.animationiteration.animation,delete Hn.animationstart.animation),"TransitionEvent"in window||delete Hn.transitionend.transition);function xl(e){if(sc[e])return sc[e];if(!Hn[e])return e;var s=Hn[e],n;for(n in s)if(s.hasOwnProperty(n)&&n in Qm)return sc[e]=s[n];return e}var qm=xl("animationend"),Zm=xl("animationiteration"),Km=xl("animationstart"),Jm=xl("transitionend"),t_=new Map,Lp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rs(e,s){t_.set(e,s),pn(s,[e])}for(var nc=0;nc<Lp.length;nc++){var rc=Lp[nc],wx=rc.toLowerCase(),xx=rc[0].toUpperCase()+rc.slice(1);Rs(wx,"on"+xx)}Rs(qm,"onAnimationEnd");Rs(Zm,"onAnimationIteration");Rs(Km,"onAnimationStart");Rs("dblclick","onDoubleClick");Rs("focusin","onFocus");Rs("focusout","onBlur");Rs(Jm,"onTransitionEnd");er("onMouseEnter",["mouseout","mouseover"]);er("onMouseLeave",["mouseout","mouseover"]);er("onPointerEnter",["pointerout","pointerover"]);er("onPointerLeave",["pointerout","pointerover"]);pn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pn("onBeforeInput",["compositionend","keypress","textInput","paste"]);pn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yr));function Op(e,s,n){var o=e.type||"unknown-event";e.currentTarget=n,ww(o,s,void 0,e),e.currentTarget=null}function e_(e,s){s=(s&4)!==0;for(var n=0;n<e.length;n++){var o=e[n],l=o.event;o=o.listeners;t:{var c=void 0;if(s)for(var f=o.length-1;0<=f;f--){var g=o[f],_=g.instance,v=g.currentTarget;if(g=g.listener,_!==c&&l.isPropagationStopped())break t;Op(l,g,v),c=_}else for(f=0;f<o.length;f++){if(g=o[f],_=g.instance,v=g.currentTarget,g=g.listener,_!==c&&l.isPropagationStopped())break t;Op(l,g,v),c=_}}}if(Va)throw e=Wc,Va=!1,Wc=null,e}function Pt(e,s){var n=s[Jc];n===void 0&&(n=s[Jc]=new Set);var o=e+"__bubble";n.has(o)||(i_(s,e,2,!1),n.add(o))}function oc(e,s,n){var o=0;s&&(o|=4),i_(n,e,o,s)}var ya="_reactListening"+Math.random().toString(36).slice(2);function fo(e){if(!e[ya]){e[ya]=!0,hm.forEach(function(n){n!=="selectionchange"&&(bx.has(n)||oc(n,!1,e),oc(n,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[ya]||(s[ya]=!0,oc("selectionchange",!1,s))}}function i_(e,s,n,o){switch(Um(s)){case 1:var l=Lw;break;case 4:l=Ow;break;default:l=Gu}n=l.bind(null,s,n,e),l=void 0,!jc||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(l=!0),o?l!==void 0?e.addEventListener(s,n,{capture:!0,passive:l}):e.addEventListener(s,n,!0):l!==void 0?e.addEventListener(s,n,{passive:l}):e.addEventListener(s,n,!1)}function ac(e,s,n,o,l){var c=o;if(!(s&1)&&!(s&2)&&o!==null)t:for(;;){if(o===null)return;var f=o.tag;if(f===3||f===4){var g=o.stateNode.containerInfo;if(g===l||g.nodeType===8&&g.parentNode===l)break;if(f===4)for(f=o.return;f!==null;){var _=f.tag;if((_===3||_===4)&&(_=f.stateNode.containerInfo,_===l||_.nodeType===8&&_.parentNode===l))return;f=f.return}for(;g!==null;){if(f=Js(g),f===null)return;if(_=f.tag,_===5||_===6){o=c=f;continue t}g=g.parentNode}}o=o.return}Em(function(){var v=c,x=Hu(n),S=[];t:{var T=t_.get(e);if(T!==void 0){var D=$u,F=e;switch(e){case"keypress":if(Da(n)===0)break t;case"keydown":case"keyup":D=Kw;break;case"focusin":F="focus",D=tc;break;case"focusout":F="blur",D=tc;break;case"beforeblur":case"afterblur":D=tc;break;case"click":if(n.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":D=Ep;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":D=zw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":D=ex;break;case qm:case Zm:case Km:D=Ww;break;case Jm:D=sx;break;case"scroll":D=Nw;break;case"wheel":D=rx;break;case"copy":case"cut":case"paste":D=Gw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":D=Tp}var O=(s&4)!==0,L=!O&&e==="scroll",P=O?T!==null?T+"Capture":null:T;O=[];for(var A=v,I;A!==null;){I=A;var H=I.stateNode;if(I.tag===5&&H!==null&&(I=H,P!==null&&(H=oo(A,P),H!=null&&O.push(po(A,H,I)))),L)break;A=A.return}0<O.length&&(T=new D(T,F,null,n,x),S.push({event:T,listeners:O}))}}if(!(s&7)){t:{if(T=e==="mouseover"||e==="pointerover",D=e==="mouseout"||e==="pointerout",T&&n!==zc&&(F=n.relatedTarget||n.fromElement)&&(Js(F)||F[es]))break t;if((D||T)&&(T=x.window===x?x:(T=x.ownerDocument)?T.defaultView||T.parentWindow:window,D?(F=n.relatedTarget||n.toElement,D=v,F=F?Js(F):null,F!==null&&(L=gn(F),F!==L||F.tag!==5&&F.tag!==6)&&(F=null)):(D=null,F=v),D!==F)){if(O=Ep,H="onMouseLeave",P="onMouseEnter",A="mouse",(e==="pointerout"||e==="pointerover")&&(O=Tp,H="onPointerLeave",P="onPointerEnter",A="pointer"),L=D==null?T:jn(D),I=F==null?T:jn(F),T=new O(H,A+"leave",D,n,x),T.target=L,T.relatedTarget=I,H=null,Js(x)===v&&(O=new O(P,A+"enter",F,n,x),O.target=I,O.relatedTarget=L,H=O),L=H,D&&F)e:{for(O=D,P=F,A=0,I=O;I;I=Ln(I))A++;for(I=0,H=P;H;H=Ln(H))I++;for(;0<A-I;)O=Ln(O),A--;for(;0<I-A;)P=Ln(P),I--;for(;A--;){if(O===P||P!==null&&O===P.alternate)break e;O=Ln(O),P=Ln(P)}O=null}else O=null;D!==null&&Np(S,T,D,O,!1),F!==null&&L!==null&&Np(S,L,F,O,!0)}}t:{if(T=v?jn(v):window,D=T.nodeName&&T.nodeName.toLowerCase(),D==="select"||D==="input"&&T.type==="file")var j=dx;else if(Ip(T))if(Gm)j=mx;else{j=px;var Z=fx}else(D=T.nodeName)&&D.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(j=gx);if(j&&(j=j(e,v))){Vm(S,j,n,x);break t}Z&&Z(e,T,v),e==="focusout"&&(Z=T._wrapperState)&&Z.controlled&&T.type==="number"&&Mc(T,"number",T.value)}switch(Z=v?jn(v):window,e){case"focusin":(Ip(Z)||Z.contentEditable==="true")&&(zn=Z,$c=v,Jr=null);break;case"focusout":Jr=$c=zn=null;break;case"mousedown":Yc=!0;break;case"contextmenu":case"mouseup":case"dragend":Yc=!1,Mp(S,n,x);break;case"selectionchange":if(yx)break;case"keydown":case"keyup":Mp(S,n,x)}var E;if(Qu)t:{switch(e){case"compositionstart":var B="onCompositionStart";break t;case"compositionend":B="onCompositionEnd";break t;case"compositionupdate":B="onCompositionUpdate";break t}B=void 0}else Un?jm(e,n)&&(B="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(B="onCompositionStart");B&&(Hm&&n.locale!=="ko"&&(Un||B!=="onCompositionStart"?B==="onCompositionEnd"&&Un&&(E=zm()):(ms=x,Xu="value"in ms?ms.value:ms.textContent,Un=!0)),Z=Qa(v,B),0<Z.length&&(B=new Ap(B,e,null,n,x),S.push({event:B,listeners:Z}),E?B.data=E:(E=Wm(n),E!==null&&(B.data=E)))),(E=ax?lx(e,n):hx(e,n))&&(v=Qa(v,"onBeforeInput"),0<v.length&&(x=new Ap("onBeforeInput","beforeinput",null,n,x),S.push({event:x,listeners:v}),x.data=E))}e_(S,s)})}function po(e,s,n){return{instance:e,listener:s,currentTarget:n}}function Qa(e,s){for(var n=s+"Capture",o=[];e!==null;){var l=e,c=l.stateNode;l.tag===5&&c!==null&&(l=c,c=oo(e,n),c!=null&&o.unshift(po(e,c,l)),c=oo(e,s),c!=null&&o.push(po(e,c,l))),e=e.return}return o}function Ln(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Np(e,s,n,o,l){for(var c=s._reactName,f=[];n!==null&&n!==o;){var g=n,_=g.alternate,v=g.stateNode;if(_!==null&&_===o)break;g.tag===5&&v!==null&&(g=v,l?(_=oo(n,c),_!=null&&f.unshift(po(n,_,g))):l||(_=oo(n,c),_!=null&&f.push(po(n,_,g)))),n=n.return}f.length!==0&&e.push({event:s,listeners:f})}var Cx=/\r\n?/g,Sx=/\u0000|\uFFFD/g;function Up(e){return(typeof e=="string"?e:""+e).replace(Cx,`
`).replace(Sx,"")}function wa(e,s,n){if(s=Up(s),Up(e)!==s&&n)throw Error(K(425))}function qa(){}var Qc=null,qc=null;function Zc(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Kc=typeof setTimeout=="function"?setTimeout:void 0,Ex=typeof clearTimeout=="function"?clearTimeout:void 0,zp=typeof Promise=="function"?Promise:void 0,Ax=typeof queueMicrotask=="function"?queueMicrotask:typeof zp<"u"?function(e){return zp.resolve(null).then(e).catch(Tx)}:Kc;function Tx(e){setTimeout(function(){throw e})}function lc(e,s){var n=s,o=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(o===0){e.removeChild(l),ho(s);return}o--}else n!=="$"&&n!=="$?"&&n!=="$!"||o++;n=l}while(n);ho(s)}function bs(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return e}function Hp(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(s===0)return e;s--}else n==="/$"&&s++}e=e.previousSibling}return null}var cr=Math.random().toString(36).slice(2),Ni="__reactFiber$"+cr,go="__reactProps$"+cr,es="__reactContainer$"+cr,Jc="__reactEvents$"+cr,Px="__reactListeners$"+cr,Rx="__reactHandles$"+cr;function Js(e){var s=e[Ni];if(s)return s;for(var n=e.parentNode;n;){if(s=n[es]||n[Ni]){if(n=s.alternate,s.child!==null||n!==null&&n.child!==null)for(e=Hp(e);e!==null;){if(n=e[Ni])return n;e=Hp(e)}return s}e=n,n=e.parentNode}return null}function Ro(e){return e=e[Ni]||e[es],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function jn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(K(33))}function bl(e){return e[go]||null}var tu=[],Wn=-1;function Is(e){return{current:e}}function Rt(e){0>Wn||(e.current=tu[Wn],tu[Wn]=null,Wn--)}function At(e,s){Wn++,tu[Wn]=e.current,e.current=s}var Ps={},Ee=Is(Ps),Ve=Is(!1),ln=Ps;function ir(e,s){var n=e.type.contextTypes;if(!n)return Ps;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===s)return o.__reactInternalMemoizedMaskedChildContext;var l={},c;for(c in n)l[c]=s[c];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=l),l}function Ge(e){return e=e.childContextTypes,e!=null}function Za(){Rt(Ve),Rt(Ee)}function jp(e,s,n){if(Ee.current!==Ps)throw Error(K(168));At(Ee,s),At(Ve,n)}function s_(e,s,n){var o=e.stateNode;if(s=s.childContextTypes,typeof o.getChildContext!="function")return n;o=o.getChildContext();for(var l in o)if(!(l in s))throw Error(K(108,fw(e)||"Unknown",l));return Ut({},n,o)}function Ka(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ps,ln=Ee.current,At(Ee,e),At(Ve,Ve.current),!0}function Wp(e,s,n){var o=e.stateNode;if(!o)throw Error(K(169));n?(e=s_(e,s,ln),o.__reactInternalMemoizedMergedChildContext=e,Rt(Ve),Rt(Ee),At(Ee,e)):Rt(Ve),At(Ve,n)}var Qi=null,Cl=!1,hc=!1;function n_(e){Qi===null?Qi=[e]:Qi.push(e)}function Ix(e){Cl=!0,n_(e)}function Ds(){if(!hc&&Qi!==null){hc=!0;var e=0,s=St;try{var n=Qi;for(St=1;e<n.length;e++){var o=n[e];do o=o(!0);while(o!==null)}Qi=null,Cl=!1}catch(l){throw Qi!==null&&(Qi=Qi.slice(e+1)),Rm(ju,Ds),l}finally{St=s,hc=!1}}return null}var Vn=[],Gn=0,Ja=null,tl=0,hi=[],ci=0,hn=null,qi=1,Zi="";function Zs(e,s){Vn[Gn++]=tl,Vn[Gn++]=Ja,Ja=e,tl=s}function r_(e,s,n){hi[ci++]=qi,hi[ci++]=Zi,hi[ci++]=hn,hn=e;var o=qi;e=Zi;var l=32-Ci(o)-1;o&=~(1<<l),n+=1;var c=32-Ci(s)+l;if(30<c){var f=l-l%5;c=(o&(1<<f)-1).toString(32),o>>=f,l-=f,qi=1<<32-Ci(s)+l|n<<l|o,Zi=c+e}else qi=1<<c|n<<l|o,Zi=e}function Zu(e){e.return!==null&&(Zs(e,1),r_(e,1,0))}function Ku(e){for(;e===Ja;)Ja=Vn[--Gn],Vn[Gn]=null,tl=Vn[--Gn],Vn[Gn]=null;for(;e===hn;)hn=hi[--ci],hi[ci]=null,Zi=hi[--ci],hi[ci]=null,qi=hi[--ci],hi[ci]=null}var ei=null,ti=null,kt=!1,bi=null;function o_(e,s){var n=ui(5,null,null,0);n.elementType="DELETED",n.stateNode=s,n.return=e,s=e.deletions,s===null?(e.deletions=[n],e.flags|=16):s.push(n)}function Vp(e,s){switch(e.tag){case 5:var n=e.type;return s=s.nodeType!==1||n.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(e.stateNode=s,ei=e,ti=bs(s.firstChild),!0):!1;case 6:return s=e.pendingProps===""||s.nodeType!==3?null:s,s!==null?(e.stateNode=s,ei=e,ti=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(n=hn!==null?{id:qi,overflow:Zi}:null,e.memoizedState={dehydrated:s,treeContext:n,retryLane:1073741824},n=ui(18,null,null,0),n.stateNode=s,n.return=e,e.child=n,ei=e,ti=null,!0):!1;default:return!1}}function eu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function iu(e){if(kt){var s=ti;if(s){var n=s;if(!Vp(e,s)){if(eu(e))throw Error(K(418));s=bs(n.nextSibling);var o=ei;s&&Vp(e,s)?o_(o,n):(e.flags=e.flags&-4097|2,kt=!1,ei=e)}}else{if(eu(e))throw Error(K(418));e.flags=e.flags&-4097|2,kt=!1,ei=e}}}function Gp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ei=e}function xa(e){if(e!==ei)return!1;if(!kt)return Gp(e),kt=!0,!1;var s;if((s=e.tag!==3)&&!(s=e.tag!==5)&&(s=e.type,s=s!=="head"&&s!=="body"&&!Zc(e.type,e.memoizedProps)),s&&(s=ti)){if(eu(e))throw a_(),Error(K(418));for(;s;)o_(e,s),s=bs(s.nextSibling)}if(Gp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(K(317));t:{for(e=e.nextSibling,s=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(s===0){ti=bs(e.nextSibling);break t}s--}else n!=="$"&&n!=="$!"&&n!=="$?"||s++}e=e.nextSibling}ti=null}}else ti=ei?bs(e.stateNode.nextSibling):null;return!0}function a_(){for(var e=ti;e;)e=bs(e.nextSibling)}function sr(){ti=ei=null,kt=!1}function Ju(e){bi===null?bi=[e]:bi.push(e)}var Dx=ns.ReactCurrentBatchConfig;function zr(e,s,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var o=n.stateNode}if(!o)throw Error(K(147,e));var l=o,c=""+e;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===c?s.ref:(s=function(f){var g=l.refs;f===null?delete g[c]:g[c]=f},s._stringRef=c,s)}if(typeof e!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,e))}return e}function ba(e,s){throw e=Object.prototype.toString.call(s),Error(K(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}function Xp(e){var s=e._init;return s(e._payload)}function l_(e){function s(P,A){if(e){var I=P.deletions;I===null?(P.deletions=[A],P.flags|=16):I.push(A)}}function n(P,A){if(!e)return null;for(;A!==null;)s(P,A),A=A.sibling;return null}function o(P,A){for(P=new Map;A!==null;)A.key!==null?P.set(A.key,A):P.set(A.index,A),A=A.sibling;return P}function l(P,A){return P=As(P,A),P.index=0,P.sibling=null,P}function c(P,A,I){return P.index=I,e?(I=P.alternate,I!==null?(I=I.index,I<A?(P.flags|=2,A):I):(P.flags|=2,A)):(P.flags|=1048576,A)}function f(P){return e&&P.alternate===null&&(P.flags|=2),P}function g(P,A,I,H){return A===null||A.tag!==6?(A=mc(I,P.mode,H),A.return=P,A):(A=l(A,I),A.return=P,A)}function _(P,A,I,H){var j=I.type;return j===Nn?x(P,A,I.props.children,H,I.key):A!==null&&(A.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===ds&&Xp(j)===A.type)?(H=l(A,I.props),H.ref=zr(P,A,I),H.return=P,H):(H=Na(I.type,I.key,I.props,null,P.mode,H),H.ref=zr(P,A,I),H.return=P,H)}function v(P,A,I,H){return A===null||A.tag!==4||A.stateNode.containerInfo!==I.containerInfo||A.stateNode.implementation!==I.implementation?(A=_c(I,P.mode,H),A.return=P,A):(A=l(A,I.children||[]),A.return=P,A)}function x(P,A,I,H,j){return A===null||A.tag!==7?(A=rn(I,P.mode,H,j),A.return=P,A):(A=l(A,I),A.return=P,A)}function S(P,A,I){if(typeof A=="string"&&A!==""||typeof A=="number")return A=mc(""+A,P.mode,I),A.return=P,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case ua:return I=Na(A.type,A.key,A.props,null,P.mode,I),I.ref=zr(P,null,A),I.return=P,I;case On:return A=_c(A,P.mode,I),A.return=P,A;case ds:var H=A._init;return S(P,H(A._payload),I)}if(Xr(A)||Mr(A))return A=rn(A,P.mode,I,null),A.return=P,A;ba(P,A)}return null}function T(P,A,I,H){var j=A!==null?A.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return j!==null?null:g(P,A,""+I,H);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case ua:return I.key===j?_(P,A,I,H):null;case On:return I.key===j?v(P,A,I,H):null;case ds:return j=I._init,T(P,A,j(I._payload),H)}if(Xr(I)||Mr(I))return j!==null?null:x(P,A,I,H,null);ba(P,I)}return null}function D(P,A,I,H,j){if(typeof H=="string"&&H!==""||typeof H=="number")return P=P.get(I)||null,g(A,P,""+H,j);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case ua:return P=P.get(H.key===null?I:H.key)||null,_(A,P,H,j);case On:return P=P.get(H.key===null?I:H.key)||null,v(A,P,H,j);case ds:var Z=H._init;return D(P,A,I,Z(H._payload),j)}if(Xr(H)||Mr(H))return P=P.get(I)||null,x(A,P,H,j,null);ba(A,H)}return null}function F(P,A,I,H){for(var j=null,Z=null,E=A,B=A=0,G=null;E!==null&&B<I.length;B++){E.index>B?(G=E,E=null):G=E.sibling;var nt=T(P,E,I[B],H);if(nt===null){E===null&&(E=G);break}e&&E&&nt.alternate===null&&s(P,E),A=c(nt,A,B),Z===null?j=nt:Z.sibling=nt,Z=nt,E=G}if(B===I.length)return n(P,E),kt&&Zs(P,B),j;if(E===null){for(;B<I.length;B++)E=S(P,I[B],H),E!==null&&(A=c(E,A,B),Z===null?j=E:Z.sibling=E,Z=E);return kt&&Zs(P,B),j}for(E=o(P,E);B<I.length;B++)G=D(E,P,B,I[B],H),G!==null&&(e&&G.alternate!==null&&E.delete(G.key===null?B:G.key),A=c(G,A,B),Z===null?j=G:Z.sibling=G,Z=G);return e&&E.forEach(function(at){return s(P,at)}),kt&&Zs(P,B),j}function O(P,A,I,H){var j=Mr(I);if(typeof j!="function")throw Error(K(150));if(I=j.call(I),I==null)throw Error(K(151));for(var Z=j=null,E=A,B=A=0,G=null,nt=I.next();E!==null&&!nt.done;B++,nt=I.next()){E.index>B?(G=E,E=null):G=E.sibling;var at=T(P,E,nt.value,H);if(at===null){E===null&&(E=G);break}e&&E&&at.alternate===null&&s(P,E),A=c(at,A,B),Z===null?j=at:Z.sibling=at,Z=at,E=G}if(nt.done)return n(P,E),kt&&Zs(P,B),j;if(E===null){for(;!nt.done;B++,nt=I.next())nt=S(P,nt.value,H),nt!==null&&(A=c(nt,A,B),Z===null?j=nt:Z.sibling=nt,Z=nt);return kt&&Zs(P,B),j}for(E=o(P,E);!nt.done;B++,nt=I.next())nt=D(E,P,B,nt.value,H),nt!==null&&(e&&nt.alternate!==null&&E.delete(nt.key===null?B:nt.key),A=c(nt,A,B),Z===null?j=nt:Z.sibling=nt,Z=nt);return e&&E.forEach(function(J){return s(P,J)}),kt&&Zs(P,B),j}function L(P,A,I,H){if(typeof I=="object"&&I!==null&&I.type===Nn&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case ua:t:{for(var j=I.key,Z=A;Z!==null;){if(Z.key===j){if(j=I.type,j===Nn){if(Z.tag===7){n(P,Z.sibling),A=l(Z,I.props.children),A.return=P,P=A;break t}}else if(Z.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===ds&&Xp(j)===Z.type){n(P,Z.sibling),A=l(Z,I.props),A.ref=zr(P,Z,I),A.return=P,P=A;break t}n(P,Z);break}else s(P,Z);Z=Z.sibling}I.type===Nn?(A=rn(I.props.children,P.mode,H,I.key),A.return=P,P=A):(H=Na(I.type,I.key,I.props,null,P.mode,H),H.ref=zr(P,A,I),H.return=P,P=H)}return f(P);case On:t:{for(Z=I.key;A!==null;){if(A.key===Z)if(A.tag===4&&A.stateNode.containerInfo===I.containerInfo&&A.stateNode.implementation===I.implementation){n(P,A.sibling),A=l(A,I.children||[]),A.return=P,P=A;break t}else{n(P,A);break}else s(P,A);A=A.sibling}A=_c(I,P.mode,H),A.return=P,P=A}return f(P);case ds:return Z=I._init,L(P,A,Z(I._payload),H)}if(Xr(I))return F(P,A,I,H);if(Mr(I))return O(P,A,I,H);ba(P,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,A!==null&&A.tag===6?(n(P,A.sibling),A=l(A,I),A.return=P,P=A):(n(P,A),A=mc(I,P.mode,H),A.return=P,P=A),f(P)):n(P,A)}return L}var nr=l_(!0),h_=l_(!1),el=Is(null),il=null,Xn=null,td=null;function ed(){td=Xn=il=null}function id(e){var s=el.current;Rt(el),e._currentValue=s}function su(e,s,n){for(;e!==null;){var o=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,o!==null&&(o.childLanes|=s)):o!==null&&(o.childLanes&s)!==s&&(o.childLanes|=s),e===n)break;e=e.return}}function Jn(e,s){il=e,td=Xn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&s&&(We=!0),e.firstContext=null)}function fi(e){var s=e._currentValue;if(td!==e)if(e={context:e,memoizedValue:s,next:null},Xn===null){if(il===null)throw Error(K(308));Xn=e,il.dependencies={lanes:0,firstContext:e}}else Xn=Xn.next=e;return s}var tn=null;function sd(e){tn===null?tn=[e]:tn.push(e)}function c_(e,s,n,o){var l=s.interleaved;return l===null?(n.next=n,sd(s)):(n.next=l.next,l.next=n),s.interleaved=n,is(e,o)}function is(e,s){e.lanes|=s;var n=e.alternate;for(n!==null&&(n.lanes|=s),n=e,e=e.return;e!==null;)e.childLanes|=s,n=e.alternate,n!==null&&(n.childLanes|=s),n=e,e=e.return;return n.tag===3?n.stateNode:null}var fs=!1;function nd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function u_(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ji(e,s){return{eventTime:e,lane:s,tag:0,payload:null,callback:null,next:null}}function Cs(e,s,n){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,wt&2){var l=o.pending;return l===null?s.next=s:(s.next=l.next,l.next=s),o.pending=s,is(e,n)}return l=o.interleaved,l===null?(s.next=s,sd(o)):(s.next=l.next,l.next=s),o.interleaved=s,is(e,n)}function ka(e,s,n){if(s=s.updateQueue,s!==null&&(s=s.shared,(n&4194240)!==0)){var o=s.lanes;o&=e.pendingLanes,n|=o,s.lanes=n,Wu(e,n)}}function $p(e,s){var n=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var l=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var f={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};c===null?l=c=f:c=c.next=f,n=n.next}while(n!==null);c===null?l=c=s:c=c.next=s}else l=c=s;n={baseState:o.baseState,firstBaseUpdate:l,lastBaseUpdate:c,shared:o.shared,effects:o.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=s:e.next=s,n.lastBaseUpdate=s}function sl(e,s,n,o){var l=e.updateQueue;fs=!1;var c=l.firstBaseUpdate,f=l.lastBaseUpdate,g=l.shared.pending;if(g!==null){l.shared.pending=null;var _=g,v=_.next;_.next=null,f===null?c=v:f.next=v,f=_;var x=e.alternate;x!==null&&(x=x.updateQueue,g=x.lastBaseUpdate,g!==f&&(g===null?x.firstBaseUpdate=v:g.next=v,x.lastBaseUpdate=_))}if(c!==null){var S=l.baseState;f=0,x=v=_=null,g=c;do{var T=g.lane,D=g.eventTime;if((o&T)===T){x!==null&&(x=x.next={eventTime:D,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});t:{var F=e,O=g;switch(T=s,D=n,O.tag){case 1:if(F=O.payload,typeof F=="function"){S=F.call(D,S,T);break t}S=F;break t;case 3:F.flags=F.flags&-65537|128;case 0:if(F=O.payload,T=typeof F=="function"?F.call(D,S,T):F,T==null)break t;S=Ut({},S,T);break t;case 2:fs=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,T=l.effects,T===null?l.effects=[g]:T.push(g))}else D={eventTime:D,lane:T,tag:g.tag,payload:g.payload,callback:g.callback,next:null},x===null?(v=x=D,_=S):x=x.next=D,f|=T;if(g=g.next,g===null){if(g=l.shared.pending,g===null)break;T=g,g=T.next,T.next=null,l.lastBaseUpdate=T,l.shared.pending=null}}while(!0);if(x===null&&(_=S),l.baseState=_,l.firstBaseUpdate=v,l.lastBaseUpdate=x,s=l.shared.interleaved,s!==null){l=s;do f|=l.lane,l=l.next;while(l!==s)}else c===null&&(l.shared.lanes=0);un|=f,e.lanes=f,e.memoizedState=S}}function Yp(e,s,n){if(e=s.effects,s.effects=null,e!==null)for(s=0;s<e.length;s++){var o=e[s],l=o.callback;if(l!==null){if(o.callback=null,o=n,typeof l!="function")throw Error(K(191,l));l.call(o)}}}var Io={},zi=Is(Io),mo=Is(Io),_o=Is(Io);function en(e){if(e===Io)throw Error(K(174));return e}function rd(e,s){switch(At(_o,s),At(mo,e),At(zi,Io),e=s.nodeType,e){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Oc(null,"");break;default:e=e===8?s.parentNode:s,s=e.namespaceURI||null,e=e.tagName,s=Oc(s,e)}Rt(zi),At(zi,s)}function rr(){Rt(zi),Rt(mo),Rt(_o)}function d_(e){en(_o.current);var s=en(zi.current),n=Oc(s,e.type);s!==n&&(At(mo,e),At(zi,n))}function od(e){mo.current===e&&(Rt(zi),Rt(mo))}var Ot=Is(0);function nl(e){for(var s=e;s!==null;){if(s.tag===13){var n=s.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var cc=[];function ad(){for(var e=0;e<cc.length;e++)cc[e]._workInProgressVersionPrimary=null;cc.length=0}var Fa=ns.ReactCurrentDispatcher,uc=ns.ReactCurrentBatchConfig,cn=0,Nt=null,re=null,ce=null,rl=!1,to=!1,vo=0,kx=0;function be(){throw Error(K(321))}function ld(e,s){if(s===null)return!1;for(var n=0;n<s.length&&n<e.length;n++)if(!Ei(e[n],s[n]))return!1;return!0}function hd(e,s,n,o,l,c){if(cn=c,Nt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Fa.current=e===null||e.memoizedState===null?Lx:Ox,e=n(o,l),to){c=0;do{if(to=!1,vo=0,25<=c)throw Error(K(301));c+=1,ce=re=null,s.updateQueue=null,Fa.current=Nx,e=n(o,l)}while(to)}if(Fa.current=ol,s=re!==null&&re.next!==null,cn=0,ce=re=Nt=null,rl=!1,s)throw Error(K(300));return e}function cd(){var e=vo!==0;return vo=0,e}function Oi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ce===null?Nt.memoizedState=ce=e:ce=ce.next=e,ce}function pi(){if(re===null){var e=Nt.alternate;e=e!==null?e.memoizedState:null}else e=re.next;var s=ce===null?Nt.memoizedState:ce.next;if(s!==null)ce=s,re=e;else{if(e===null)throw Error(K(310));re=e,e={memoizedState:re.memoizedState,baseState:re.baseState,baseQueue:re.baseQueue,queue:re.queue,next:null},ce===null?Nt.memoizedState=ce=e:ce=ce.next=e}return ce}function yo(e,s){return typeof s=="function"?s(e):s}function dc(e){var s=pi(),n=s.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=e;var o=re,l=o.baseQueue,c=n.pending;if(c!==null){if(l!==null){var f=l.next;l.next=c.next,c.next=f}o.baseQueue=l=c,n.pending=null}if(l!==null){c=l.next,o=o.baseState;var g=f=null,_=null,v=c;do{var x=v.lane;if((cn&x)===x)_!==null&&(_=_.next={lane:0,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null}),o=v.hasEagerState?v.eagerState:e(o,v.action);else{var S={lane:x,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null};_===null?(g=_=S,f=o):_=_.next=S,Nt.lanes|=x,un|=x}v=v.next}while(v!==null&&v!==c);_===null?f=o:_.next=g,Ei(o,s.memoizedState)||(We=!0),s.memoizedState=o,s.baseState=f,s.baseQueue=_,n.lastRenderedState=o}if(e=n.interleaved,e!==null){l=e;do c=l.lane,Nt.lanes|=c,un|=c,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[s.memoizedState,n.dispatch]}function fc(e){var s=pi(),n=s.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=e;var o=n.dispatch,l=n.pending,c=s.memoizedState;if(l!==null){n.pending=null;var f=l=l.next;do c=e(c,f.action),f=f.next;while(f!==l);Ei(c,s.memoizedState)||(We=!0),s.memoizedState=c,s.baseQueue===null&&(s.baseState=c),n.lastRenderedState=c}return[c,o]}function f_(){}function p_(e,s){var n=Nt,o=pi(),l=s(),c=!Ei(o.memoizedState,l);if(c&&(o.memoizedState=l,We=!0),o=o.queue,ud(__.bind(null,n,o,e),[e]),o.getSnapshot!==s||c||ce!==null&&ce.memoizedState.tag&1){if(n.flags|=2048,wo(9,m_.bind(null,n,o,l,s),void 0,null),ue===null)throw Error(K(349));cn&30||g_(n,s,l)}return l}function g_(e,s,n){e.flags|=16384,e={getSnapshot:s,value:n},s=Nt.updateQueue,s===null?(s={lastEffect:null,stores:null},Nt.updateQueue=s,s.stores=[e]):(n=s.stores,n===null?s.stores=[e]:n.push(e))}function m_(e,s,n,o){s.value=n,s.getSnapshot=o,v_(s)&&y_(e)}function __(e,s,n){return n(function(){v_(s)&&y_(e)})}function v_(e){var s=e.getSnapshot;e=e.value;try{var n=s();return!Ei(e,n)}catch{return!0}}function y_(e){var s=is(e,1);s!==null&&Si(s,e,1,-1)}function Qp(e){var s=Oi();return typeof e=="function"&&(e=e()),s.memoizedState=s.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yo,lastRenderedState:e},s.queue=e,e=e.dispatch=Mx.bind(null,Nt,e),[s.memoizedState,e]}function wo(e,s,n,o){return e={tag:e,create:s,destroy:n,deps:o,next:null},s=Nt.updateQueue,s===null?(s={lastEffect:null,stores:null},Nt.updateQueue=s,s.lastEffect=e.next=e):(n=s.lastEffect,n===null?s.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,s.lastEffect=e)),e}function w_(){return pi().memoizedState}function Ba(e,s,n,o){var l=Oi();Nt.flags|=e,l.memoizedState=wo(1|s,n,void 0,o===void 0?null:o)}function Sl(e,s,n,o){var l=pi();o=o===void 0?null:o;var c=void 0;if(re!==null){var f=re.memoizedState;if(c=f.destroy,o!==null&&ld(o,f.deps)){l.memoizedState=wo(s,n,c,o);return}}Nt.flags|=e,l.memoizedState=wo(1|s,n,c,o)}function qp(e,s){return Ba(8390656,8,e,s)}function ud(e,s){return Sl(2048,8,e,s)}function x_(e,s){return Sl(4,2,e,s)}function b_(e,s){return Sl(4,4,e,s)}function C_(e,s){if(typeof s=="function")return e=e(),s(e),function(){s(null)};if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function S_(e,s,n){return n=n!=null?n.concat([e]):null,Sl(4,4,C_.bind(null,s,e),n)}function dd(){}function E_(e,s){var n=pi();s=s===void 0?null:s;var o=n.memoizedState;return o!==null&&s!==null&&ld(s,o[1])?o[0]:(n.memoizedState=[e,s],e)}function A_(e,s){var n=pi();s=s===void 0?null:s;var o=n.memoizedState;return o!==null&&s!==null&&ld(s,o[1])?o[0]:(e=e(),n.memoizedState=[e,s],e)}function T_(e,s,n){return cn&21?(Ei(n,s)||(n=km(),Nt.lanes|=n,un|=n,e.baseState=!0),s):(e.baseState&&(e.baseState=!1,We=!0),e.memoizedState=n)}function Fx(e,s){var n=St;St=n!==0&&4>n?n:4,e(!0);var o=uc.transition;uc.transition={};try{e(!1),s()}finally{St=n,uc.transition=o}}function P_(){return pi().memoizedState}function Bx(e,s,n){var o=Es(e);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},R_(e))I_(s,n);else if(n=c_(e,s,n,o),n!==null){var l=ke();Si(n,e,o,l),D_(n,s,o)}}function Mx(e,s,n){var o=Es(e),l={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(R_(e))I_(s,l);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=s.lastRenderedReducer,c!==null))try{var f=s.lastRenderedState,g=c(f,n);if(l.hasEagerState=!0,l.eagerState=g,Ei(g,f)){var _=s.interleaved;_===null?(l.next=l,sd(s)):(l.next=_.next,_.next=l),s.interleaved=l;return}}catch{}finally{}n=c_(e,s,l,o),n!==null&&(l=ke(),Si(n,e,o,l),D_(n,s,o))}}function R_(e){var s=e.alternate;return e===Nt||s!==null&&s===Nt}function I_(e,s){to=rl=!0;var n=e.pending;n===null?s.next=s:(s.next=n.next,n.next=s),e.pending=s}function D_(e,s,n){if(n&4194240){var o=s.lanes;o&=e.pendingLanes,n|=o,s.lanes=n,Wu(e,n)}}var ol={readContext:fi,useCallback:be,useContext:be,useEffect:be,useImperativeHandle:be,useInsertionEffect:be,useLayoutEffect:be,useMemo:be,useReducer:be,useRef:be,useState:be,useDebugValue:be,useDeferredValue:be,useTransition:be,useMutableSource:be,useSyncExternalStore:be,useId:be,unstable_isNewReconciler:!1},Lx={readContext:fi,useCallback:function(e,s){return Oi().memoizedState=[e,s===void 0?null:s],e},useContext:fi,useEffect:qp,useImperativeHandle:function(e,s,n){return n=n!=null?n.concat([e]):null,Ba(4194308,4,C_.bind(null,s,e),n)},useLayoutEffect:function(e,s){return Ba(4194308,4,e,s)},useInsertionEffect:function(e,s){return Ba(4,2,e,s)},useMemo:function(e,s){var n=Oi();return s=s===void 0?null:s,e=e(),n.memoizedState=[e,s],e},useReducer:function(e,s,n){var o=Oi();return s=n!==void 0?n(s):s,o.memoizedState=o.baseState=s,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},o.queue=e,e=e.dispatch=Bx.bind(null,Nt,e),[o.memoizedState,e]},useRef:function(e){var s=Oi();return e={current:e},s.memoizedState=e},useState:Qp,useDebugValue:dd,useDeferredValue:function(e){return Oi().memoizedState=e},useTransition:function(){var e=Qp(!1),s=e[0];return e=Fx.bind(null,e[1]),Oi().memoizedState=e,[s,e]},useMutableSource:function(){},useSyncExternalStore:function(e,s,n){var o=Nt,l=Oi();if(kt){if(n===void 0)throw Error(K(407));n=n()}else{if(n=s(),ue===null)throw Error(K(349));cn&30||g_(o,s,n)}l.memoizedState=n;var c={value:n,getSnapshot:s};return l.queue=c,qp(__.bind(null,o,c,e),[e]),o.flags|=2048,wo(9,m_.bind(null,o,c,n,s),void 0,null),n},useId:function(){var e=Oi(),s=ue.identifierPrefix;if(kt){var n=Zi,o=qi;n=(o&~(1<<32-Ci(o)-1)).toString(32)+n,s=":"+s+"R"+n,n=vo++,0<n&&(s+="H"+n.toString(32)),s+=":"}else n=kx++,s=":"+s+"r"+n.toString(32)+":";return e.memoizedState=s},unstable_isNewReconciler:!1},Ox={readContext:fi,useCallback:E_,useContext:fi,useEffect:ud,useImperativeHandle:S_,useInsertionEffect:x_,useLayoutEffect:b_,useMemo:A_,useReducer:dc,useRef:w_,useState:function(){return dc(yo)},useDebugValue:dd,useDeferredValue:function(e){var s=pi();return T_(s,re.memoizedState,e)},useTransition:function(){var e=dc(yo)[0],s=pi().memoizedState;return[e,s]},useMutableSource:f_,useSyncExternalStore:p_,useId:P_,unstable_isNewReconciler:!1},Nx={readContext:fi,useCallback:E_,useContext:fi,useEffect:ud,useImperativeHandle:S_,useInsertionEffect:x_,useLayoutEffect:b_,useMemo:A_,useReducer:fc,useRef:w_,useState:function(){return fc(yo)},useDebugValue:dd,useDeferredValue:function(e){var s=pi();return re===null?s.memoizedState=e:T_(s,re.memoizedState,e)},useTransition:function(){var e=fc(yo)[0],s=pi().memoizedState;return[e,s]},useMutableSource:f_,useSyncExternalStore:p_,useId:P_,unstable_isNewReconciler:!1};function wi(e,s){if(e&&e.defaultProps){s=Ut({},s),e=e.defaultProps;for(var n in e)s[n]===void 0&&(s[n]=e[n]);return s}return s}function nu(e,s,n,o){s=e.memoizedState,n=n(o,s),n=n==null?s:Ut({},s,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var El={isMounted:function(e){return(e=e._reactInternals)?gn(e)===e:!1},enqueueSetState:function(e,s,n){e=e._reactInternals;var o=ke(),l=Es(e),c=Ji(o,l);c.payload=s,n!=null&&(c.callback=n),s=Cs(e,c,l),s!==null&&(Si(s,e,l,o),ka(s,e,l))},enqueueReplaceState:function(e,s,n){e=e._reactInternals;var o=ke(),l=Es(e),c=Ji(o,l);c.tag=1,c.payload=s,n!=null&&(c.callback=n),s=Cs(e,c,l),s!==null&&(Si(s,e,l,o),ka(s,e,l))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var n=ke(),o=Es(e),l=Ji(n,o);l.tag=2,s!=null&&(l.callback=s),s=Cs(e,l,o),s!==null&&(Si(s,e,o,n),ka(s,e,o))}};function Zp(e,s,n,o,l,c,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,c,f):s.prototype&&s.prototype.isPureReactComponent?!uo(n,o)||!uo(l,c):!0}function k_(e,s,n){var o=!1,l=Ps,c=s.contextType;return typeof c=="object"&&c!==null?c=fi(c):(l=Ge(s)?ln:Ee.current,o=s.contextTypes,c=(o=o!=null)?ir(e,l):Ps),s=new s(n,c),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=El,e.stateNode=s,s._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=c),s}function Kp(e,s,n,o){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(n,o),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(n,o),s.state!==e&&El.enqueueReplaceState(s,s.state,null)}function ru(e,s,n,o){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},nd(e);var c=s.contextType;typeof c=="object"&&c!==null?l.context=fi(c):(c=Ge(s)?ln:Ee.current,l.context=ir(e,c)),l.state=e.memoizedState,c=s.getDerivedStateFromProps,typeof c=="function"&&(nu(e,s,c,n),l.state=e.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(s=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),s!==l.state&&El.enqueueReplaceState(l,l.state,null),sl(e,n,l,o),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function or(e,s){try{var n="",o=s;do n+=dw(o),o=o.return;while(o);var l=n}catch(c){l=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:s,stack:l,digest:null}}function pc(e,s,n){return{value:e,source:null,stack:n??null,digest:s??null}}function ou(e,s){try{console.error(s.value)}catch(n){setTimeout(function(){throw n})}}var Ux=typeof WeakMap=="function"?WeakMap:Map;function F_(e,s,n){n=Ji(-1,n),n.tag=3,n.payload={element:null};var o=s.value;return n.callback=function(){ll||(ll=!0,mu=o),ou(e,s)},n}function B_(e,s,n){n=Ji(-1,n),n.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var l=s.value;n.payload=function(){return o(l)},n.callback=function(){ou(e,s)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(n.callback=function(){ou(e,s),typeof o!="function"&&(Ss===null?Ss=new Set([this]):Ss.add(this));var f=s.stack;this.componentDidCatch(s.value,{componentStack:f!==null?f:""})}),n}function Jp(e,s,n){var o=e.pingCache;if(o===null){o=e.pingCache=new Ux;var l=new Set;o.set(s,l)}else l=o.get(s),l===void 0&&(l=new Set,o.set(s,l));l.has(n)||(l.add(n),e=Jx.bind(null,e,s,n),s.then(e,e))}function tg(e){do{var s;if((s=e.tag===13)&&(s=e.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return e;e=e.return}while(e!==null);return null}function eg(e,s,n,o,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===s?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(s=Ji(-1,1),s.tag=2,Cs(n,s,1))),n.lanes|=1),e)}var zx=ns.ReactCurrentOwner,We=!1;function De(e,s,n,o){s.child=e===null?h_(s,null,n,o):nr(s,e.child,n,o)}function ig(e,s,n,o,l){n=n.render;var c=s.ref;return Jn(s,l),o=hd(e,s,n,o,c,l),n=cd(),e!==null&&!We?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~l,ss(e,s,l)):(kt&&n&&Zu(s),s.flags|=1,De(e,s,o,l),s.child)}function sg(e,s,n,o,l){if(e===null){var c=n.type;return typeof c=="function"&&!wd(c)&&c.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(s.tag=15,s.type=c,M_(e,s,c,o,l)):(e=Na(n.type,null,o,s,s.mode,l),e.ref=s.ref,e.return=s,s.child=e)}if(c=e.child,!(e.lanes&l)){var f=c.memoizedProps;if(n=n.compare,n=n!==null?n:uo,n(f,o)&&e.ref===s.ref)return ss(e,s,l)}return s.flags|=1,e=As(c,o),e.ref=s.ref,e.return=s,s.child=e}function M_(e,s,n,o,l){if(e!==null){var c=e.memoizedProps;if(uo(c,o)&&e.ref===s.ref)if(We=!1,s.pendingProps=o=c,(e.lanes&l)!==0)e.flags&131072&&(We=!0);else return s.lanes=e.lanes,ss(e,s,l)}return au(e,s,n,o,l)}function L_(e,s,n){var o=s.pendingProps,l=o.children,c=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(Yn,Je),Je|=n;else{if(!(n&1073741824))return e=c!==null?c.baseLanes|n:n,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:e,cachePool:null,transitions:null},s.updateQueue=null,At(Yn,Je),Je|=e,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=c!==null?c.baseLanes:n,At(Yn,Je),Je|=o}else c!==null?(o=c.baseLanes|n,s.memoizedState=null):o=n,At(Yn,Je),Je|=o;return De(e,s,l,n),s.child}function O_(e,s){var n=s.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(s.flags|=512,s.flags|=2097152)}function au(e,s,n,o,l){var c=Ge(n)?ln:Ee.current;return c=ir(s,c),Jn(s,l),n=hd(e,s,n,o,c,l),o=cd(),e!==null&&!We?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~l,ss(e,s,l)):(kt&&o&&Zu(s),s.flags|=1,De(e,s,n,l),s.child)}function ng(e,s,n,o,l){if(Ge(n)){var c=!0;Ka(s)}else c=!1;if(Jn(s,l),s.stateNode===null)Ma(e,s),k_(s,n,o),ru(s,n,o,l),o=!0;else if(e===null){var f=s.stateNode,g=s.memoizedProps;f.props=g;var _=f.context,v=n.contextType;typeof v=="object"&&v!==null?v=fi(v):(v=Ge(n)?ln:Ee.current,v=ir(s,v));var x=n.getDerivedStateFromProps,S=typeof x=="function"||typeof f.getSnapshotBeforeUpdate=="function";S||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(g!==o||_!==v)&&Kp(s,f,o,v),fs=!1;var T=s.memoizedState;f.state=T,sl(s,o,f,l),_=s.memoizedState,g!==o||T!==_||Ve.current||fs?(typeof x=="function"&&(nu(s,n,x,o),_=s.memoizedState),(g=fs||Zp(s,n,g,o,T,_,v))?(S||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(s.flags|=4194308)):(typeof f.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=o,s.memoizedState=_),f.props=o,f.state=_,f.context=v,o=g):(typeof f.componentDidMount=="function"&&(s.flags|=4194308),o=!1)}else{f=s.stateNode,u_(e,s),g=s.memoizedProps,v=s.type===s.elementType?g:wi(s.type,g),f.props=v,S=s.pendingProps,T=f.context,_=n.contextType,typeof _=="object"&&_!==null?_=fi(_):(_=Ge(n)?ln:Ee.current,_=ir(s,_));var D=n.getDerivedStateFromProps;(x=typeof D=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(g!==S||T!==_)&&Kp(s,f,o,_),fs=!1,T=s.memoizedState,f.state=T,sl(s,o,f,l);var F=s.memoizedState;g!==S||T!==F||Ve.current||fs?(typeof D=="function"&&(nu(s,n,D,o),F=s.memoizedState),(v=fs||Zp(s,n,v,o,T,F,_)||!1)?(x||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(o,F,_),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(o,F,_)),typeof f.componentDidUpdate=="function"&&(s.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof f.componentDidUpdate!="function"||g===e.memoizedProps&&T===e.memoizedState||(s.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&T===e.memoizedState||(s.flags|=1024),s.memoizedProps=o,s.memoizedState=F),f.props=o,f.state=F,f.context=_,o=v):(typeof f.componentDidUpdate!="function"||g===e.memoizedProps&&T===e.memoizedState||(s.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&T===e.memoizedState||(s.flags|=1024),o=!1)}return lu(e,s,n,o,c,l)}function lu(e,s,n,o,l,c){O_(e,s);var f=(s.flags&128)!==0;if(!o&&!f)return l&&Wp(s,n,!1),ss(e,s,c);o=s.stateNode,zx.current=s;var g=f&&typeof n.getDerivedStateFromError!="function"?null:o.render();return s.flags|=1,e!==null&&f?(s.child=nr(s,e.child,null,c),s.child=nr(s,null,g,c)):De(e,s,g,c),s.memoizedState=o.state,l&&Wp(s,n,!0),s.child}function N_(e){var s=e.stateNode;s.pendingContext?jp(e,s.pendingContext,s.pendingContext!==s.context):s.context&&jp(e,s.context,!1),rd(e,s.containerInfo)}function rg(e,s,n,o,l){return sr(),Ju(l),s.flags|=256,De(e,s,n,o),s.child}var hu={dehydrated:null,treeContext:null,retryLane:0};function cu(e){return{baseLanes:e,cachePool:null,transitions:null}}function U_(e,s,n){var o=s.pendingProps,l=Ot.current,c=!1,f=(s.flags&128)!==0,g;if((g=f)||(g=e!==null&&e.memoizedState===null?!1:(l&2)!==0),g?(c=!0,s.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),At(Ot,l&1),e===null)return iu(s),e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(s.mode&1?e.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(f=o.children,e=o.fallback,c?(o=s.mode,c=s.child,f={mode:"hidden",children:f},!(o&1)&&c!==null?(c.childLanes=0,c.pendingProps=f):c=Pl(f,o,0,null),e=rn(e,o,n,null),c.return=s,e.return=s,c.sibling=e,s.child=c,s.child.memoizedState=cu(n),s.memoizedState=hu,e):fd(s,f));if(l=e.memoizedState,l!==null&&(g=l.dehydrated,g!==null))return Hx(e,s,f,o,g,l,n);if(c){c=o.fallback,f=s.mode,l=e.child,g=l.sibling;var _={mode:"hidden",children:o.children};return!(f&1)&&s.child!==l?(o=s.child,o.childLanes=0,o.pendingProps=_,s.deletions=null):(o=As(l,_),o.subtreeFlags=l.subtreeFlags&14680064),g!==null?c=As(g,c):(c=rn(c,f,n,null),c.flags|=2),c.return=s,o.return=s,o.sibling=c,s.child=o,o=c,c=s.child,f=e.child.memoizedState,f=f===null?cu(n):{baseLanes:f.baseLanes|n,cachePool:null,transitions:f.transitions},c.memoizedState=f,c.childLanes=e.childLanes&~n,s.memoizedState=hu,o}return c=e.child,e=c.sibling,o=As(c,{mode:"visible",children:o.children}),!(s.mode&1)&&(o.lanes=n),o.return=s,o.sibling=null,e!==null&&(n=s.deletions,n===null?(s.deletions=[e],s.flags|=16):n.push(e)),s.child=o,s.memoizedState=null,o}function fd(e,s){return s=Pl({mode:"visible",children:s},e.mode,0,null),s.return=e,e.child=s}function Ca(e,s,n,o){return o!==null&&Ju(o),nr(s,e.child,null,n),e=fd(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function Hx(e,s,n,o,l,c,f){if(n)return s.flags&256?(s.flags&=-257,o=pc(Error(K(422))),Ca(e,s,f,o)):s.memoizedState!==null?(s.child=e.child,s.flags|=128,null):(c=o.fallback,l=s.mode,o=Pl({mode:"visible",children:o.children},l,0,null),c=rn(c,l,f,null),c.flags|=2,o.return=s,c.return=s,o.sibling=c,s.child=o,s.mode&1&&nr(s,e.child,null,f),s.child.memoizedState=cu(f),s.memoizedState=hu,c);if(!(s.mode&1))return Ca(e,s,f,null);if(l.data==="$!"){if(o=l.nextSibling&&l.nextSibling.dataset,o)var g=o.dgst;return o=g,c=Error(K(419)),o=pc(c,o,void 0),Ca(e,s,f,o)}if(g=(f&e.childLanes)!==0,We||g){if(o=ue,o!==null){switch(f&-f){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(o.suspendedLanes|f)?0:l,l!==0&&l!==c.retryLane&&(c.retryLane=l,is(e,l),Si(o,e,l,-1))}return yd(),o=pc(Error(K(421))),Ca(e,s,f,o)}return l.data==="$?"?(s.flags|=128,s.child=e.child,s=tb.bind(null,e),l._reactRetry=s,null):(e=c.treeContext,ti=bs(l.nextSibling),ei=s,kt=!0,bi=null,e!==null&&(hi[ci++]=qi,hi[ci++]=Zi,hi[ci++]=hn,qi=e.id,Zi=e.overflow,hn=s),s=fd(s,o.children),s.flags|=4096,s)}function og(e,s,n){e.lanes|=s;var o=e.alternate;o!==null&&(o.lanes|=s),su(e.return,s,n)}function gc(e,s,n,o,l){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:l}:(c.isBackwards=s,c.rendering=null,c.renderingStartTime=0,c.last=o,c.tail=n,c.tailMode=l)}function z_(e,s,n){var o=s.pendingProps,l=o.revealOrder,c=o.tail;if(De(e,s,o.children,n),o=Ot.current,o&2)o=o&1|2,s.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&og(e,n,s);else if(e.tag===19)og(e,n,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break t;for(;e.sibling===null;){if(e.return===null||e.return===s)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(At(Ot,o),!(s.mode&1))s.memoizedState=null;else switch(l){case"forwards":for(n=s.child,l=null;n!==null;)e=n.alternate,e!==null&&nl(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=s.child,s.child=null):(l=n.sibling,n.sibling=null),gc(s,!1,l,n,c);break;case"backwards":for(n=null,l=s.child,s.child=null;l!==null;){if(e=l.alternate,e!==null&&nl(e)===null){s.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}gc(s,!0,n,null,c);break;case"together":gc(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ma(e,s){!(s.mode&1)&&e!==null&&(e.alternate=null,s.alternate=null,s.flags|=2)}function ss(e,s,n){if(e!==null&&(s.dependencies=e.dependencies),un|=s.lanes,!(n&s.childLanes))return null;if(e!==null&&s.child!==e.child)throw Error(K(153));if(s.child!==null){for(e=s.child,n=As(e,e.pendingProps),s.child=n,n.return=s;e.sibling!==null;)e=e.sibling,n=n.sibling=As(e,e.pendingProps),n.return=s;n.sibling=null}return s.child}function jx(e,s,n){switch(s.tag){case 3:N_(s),sr();break;case 5:d_(s);break;case 1:Ge(s.type)&&Ka(s);break;case 4:rd(s,s.stateNode.containerInfo);break;case 10:var o=s.type._context,l=s.memoizedProps.value;At(el,o._currentValue),o._currentValue=l;break;case 13:if(o=s.memoizedState,o!==null)return o.dehydrated!==null?(At(Ot,Ot.current&1),s.flags|=128,null):n&s.child.childLanes?U_(e,s,n):(At(Ot,Ot.current&1),e=ss(e,s,n),e!==null?e.sibling:null);At(Ot,Ot.current&1);break;case 19:if(o=(n&s.childLanes)!==0,e.flags&128){if(o)return z_(e,s,n);s.flags|=128}if(l=s.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),At(Ot,Ot.current),o)break;return null;case 22:case 23:return s.lanes=0,L_(e,s,n)}return ss(e,s,n)}var H_,uu,j_,W_;H_=function(e,s){for(var n=s.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uu=function(){};j_=function(e,s,n,o){var l=e.memoizedProps;if(l!==o){e=s.stateNode,en(zi.current);var c=null;switch(n){case"input":l=Fc(e,l),o=Fc(e,o),c=[];break;case"select":l=Ut({},l,{value:void 0}),o=Ut({},o,{value:void 0}),c=[];break;case"textarea":l=Lc(e,l),o=Lc(e,o),c=[];break;default:typeof l.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=qa)}Nc(n,o);var f;n=null;for(v in l)if(!o.hasOwnProperty(v)&&l.hasOwnProperty(v)&&l[v]!=null)if(v==="style"){var g=l[v];for(f in g)g.hasOwnProperty(f)&&(n||(n={}),n[f]="")}else v!=="dangerouslySetInnerHTML"&&v!=="children"&&v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(no.hasOwnProperty(v)?c||(c=[]):(c=c||[]).push(v,null));for(v in o){var _=o[v];if(g=l!=null?l[v]:void 0,o.hasOwnProperty(v)&&_!==g&&(_!=null||g!=null))if(v==="style")if(g){for(f in g)!g.hasOwnProperty(f)||_&&_.hasOwnProperty(f)||(n||(n={}),n[f]="");for(f in _)_.hasOwnProperty(f)&&g[f]!==_[f]&&(n||(n={}),n[f]=_[f])}else n||(c||(c=[]),c.push(v,n)),n=_;else v==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,g=g?g.__html:void 0,_!=null&&g!==_&&(c=c||[]).push(v,_)):v==="children"?typeof _!="string"&&typeof _!="number"||(c=c||[]).push(v,""+_):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&(no.hasOwnProperty(v)?(_!=null&&v==="onScroll"&&Pt("scroll",e),c||g===_||(c=[])):(c=c||[]).push(v,_))}n&&(c=c||[]).push("style",n);var v=c;(s.updateQueue=v)&&(s.flags|=4)}};W_=function(e,s,n,o){n!==o&&(s.flags|=4)};function Hr(e,s){if(!kt)switch(e.tailMode){case"hidden":s=e.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Ce(e){var s=e.alternate!==null&&e.alternate.child===e.child,n=0,o=0;if(s)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,o|=l.subtreeFlags&14680064,o|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,o|=l.subtreeFlags,o|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=o,e.childLanes=n,s}function Wx(e,s,n){var o=s.pendingProps;switch(Ku(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ce(s),null;case 1:return Ge(s.type)&&Za(),Ce(s),null;case 3:return o=s.stateNode,rr(),Rt(Ve),Rt(Ee),ad(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(xa(s)?s.flags|=4:e===null||e.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,bi!==null&&(yu(bi),bi=null))),uu(e,s),Ce(s),null;case 5:od(s);var l=en(_o.current);if(n=s.type,e!==null&&s.stateNode!=null)j_(e,s,n,o,l),e.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!o){if(s.stateNode===null)throw Error(K(166));return Ce(s),null}if(e=en(zi.current),xa(s)){o=s.stateNode,n=s.type;var c=s.memoizedProps;switch(o[Ni]=s,o[go]=c,e=(s.mode&1)!==0,n){case"dialog":Pt("cancel",o),Pt("close",o);break;case"iframe":case"object":case"embed":Pt("load",o);break;case"video":case"audio":for(l=0;l<Yr.length;l++)Pt(Yr[l],o);break;case"source":Pt("error",o);break;case"img":case"image":case"link":Pt("error",o),Pt("load",o);break;case"details":Pt("toggle",o);break;case"input":gp(o,c),Pt("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!c.multiple},Pt("invalid",o);break;case"textarea":_p(o,c),Pt("invalid",o)}Nc(n,c),l=null;for(var f in c)if(c.hasOwnProperty(f)){var g=c[f];f==="children"?typeof g=="string"?o.textContent!==g&&(c.suppressHydrationWarning!==!0&&wa(o.textContent,g,e),l=["children",g]):typeof g=="number"&&o.textContent!==""+g&&(c.suppressHydrationWarning!==!0&&wa(o.textContent,g,e),l=["children",""+g]):no.hasOwnProperty(f)&&g!=null&&f==="onScroll"&&Pt("scroll",o)}switch(n){case"input":da(o),mp(o,c,!0);break;case"textarea":da(o),vp(o);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(o.onclick=qa)}o=l,s.updateQueue=o,o!==null&&(s.flags|=4)}else{f=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=_m(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=f.createElement(n,{is:o.is}):(e=f.createElement(n),n==="select"&&(f=e,o.multiple?f.multiple=!0:o.size&&(f.size=o.size))):e=f.createElementNS(e,n),e[Ni]=s,e[go]=o,H_(e,s,!1,!1),s.stateNode=e;t:{switch(f=Uc(n,o),n){case"dialog":Pt("cancel",e),Pt("close",e),l=o;break;case"iframe":case"object":case"embed":Pt("load",e),l=o;break;case"video":case"audio":for(l=0;l<Yr.length;l++)Pt(Yr[l],e);l=o;break;case"source":Pt("error",e),l=o;break;case"img":case"image":case"link":Pt("error",e),Pt("load",e),l=o;break;case"details":Pt("toggle",e),l=o;break;case"input":gp(e,o),l=Fc(e,o),Pt("invalid",e);break;case"option":l=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},l=Ut({},o,{value:void 0}),Pt("invalid",e);break;case"textarea":_p(e,o),l=Lc(e,o),Pt("invalid",e);break;default:l=o}Nc(n,l),g=l;for(c in g)if(g.hasOwnProperty(c)){var _=g[c];c==="style"?wm(e,_):c==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&vm(e,_)):c==="children"?typeof _=="string"?(n!=="textarea"||_!=="")&&ro(e,_):typeof _=="number"&&ro(e,""+_):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(no.hasOwnProperty(c)?_!=null&&c==="onScroll"&&Pt("scroll",e):_!=null&&Ou(e,c,_,f))}switch(n){case"input":da(e),mp(e,o,!1);break;case"textarea":da(e),vp(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Ts(o.value));break;case"select":e.multiple=!!o.multiple,c=o.value,c!=null?Qn(e,!!o.multiple,c,!1):o.defaultValue!=null&&Qn(e,!!o.multiple,o.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=qa)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break t;case"img":o=!0;break t;default:o=!1}}o&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Ce(s),null;case 6:if(e&&s.stateNode!=null)W_(e,s,e.memoizedProps,o);else{if(typeof o!="string"&&s.stateNode===null)throw Error(K(166));if(n=en(_o.current),en(zi.current),xa(s)){if(o=s.stateNode,n=s.memoizedProps,o[Ni]=s,(c=o.nodeValue!==n)&&(e=ei,e!==null))switch(e.tag){case 3:wa(o.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&wa(o.nodeValue,n,(e.mode&1)!==0)}c&&(s.flags|=4)}else o=(n.nodeType===9?n:n.ownerDocument).createTextNode(o),o[Ni]=s,s.stateNode=o}return Ce(s),null;case 13:if(Rt(Ot),o=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kt&&ti!==null&&s.mode&1&&!(s.flags&128))a_(),sr(),s.flags|=98560,c=!1;else if(c=xa(s),o!==null&&o.dehydrated!==null){if(e===null){if(!c)throw Error(K(318));if(c=s.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(K(317));c[Ni]=s}else sr(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Ce(s),c=!1}else bi!==null&&(yu(bi),bi=null),c=!0;if(!c)return s.flags&65536?s:null}return s.flags&128?(s.lanes=n,s):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(s.child.flags|=8192,s.mode&1&&(e===null||Ot.current&1?oe===0&&(oe=3):yd())),s.updateQueue!==null&&(s.flags|=4),Ce(s),null);case 4:return rr(),uu(e,s),e===null&&fo(s.stateNode.containerInfo),Ce(s),null;case 10:return id(s.type._context),Ce(s),null;case 17:return Ge(s.type)&&Za(),Ce(s),null;case 19:if(Rt(Ot),c=s.memoizedState,c===null)return Ce(s),null;if(o=(s.flags&128)!==0,f=c.rendering,f===null)if(o)Hr(c,!1);else{if(oe!==0||e!==null&&e.flags&128)for(e=s.child;e!==null;){if(f=nl(e),f!==null){for(s.flags|=128,Hr(c,!1),o=f.updateQueue,o!==null&&(s.updateQueue=o,s.flags|=4),s.subtreeFlags=0,o=n,n=s.child;n!==null;)c=n,e=o,c.flags&=14680066,f=c.alternate,f===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=f.childLanes,c.lanes=f.lanes,c.child=f.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=f.memoizedProps,c.memoizedState=f.memoizedState,c.updateQueue=f.updateQueue,c.type=f.type,e=f.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return At(Ot,Ot.current&1|2),s.child}e=e.sibling}c.tail!==null&&$t()>ar&&(s.flags|=128,o=!0,Hr(c,!1),s.lanes=4194304)}else{if(!o)if(e=nl(f),e!==null){if(s.flags|=128,o=!0,n=e.updateQueue,n!==null&&(s.updateQueue=n,s.flags|=4),Hr(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!kt)return Ce(s),null}else 2*$t()-c.renderingStartTime>ar&&n!==1073741824&&(s.flags|=128,o=!0,Hr(c,!1),s.lanes=4194304);c.isBackwards?(f.sibling=s.child,s.child=f):(n=c.last,n!==null?n.sibling=f:s.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=$t(),s.sibling=null,n=Ot.current,At(Ot,o?n&1|2:n&1),s):(Ce(s),null);case 22:case 23:return vd(),o=s.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(s.flags|=8192),o&&s.mode&1?Je&1073741824&&(Ce(s),s.subtreeFlags&6&&(s.flags|=8192)):Ce(s),null;case 24:return null;case 25:return null}throw Error(K(156,s.tag))}function Vx(e,s){switch(Ku(s),s.tag){case 1:return Ge(s.type)&&Za(),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return rr(),Rt(Ve),Rt(Ee),ad(),e=s.flags,e&65536&&!(e&128)?(s.flags=e&-65537|128,s):null;case 5:return od(s),null;case 13:if(Rt(Ot),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(K(340));sr()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return Rt(Ot),null;case 4:return rr(),null;case 10:return id(s.type._context),null;case 22:case 23:return vd(),null;case 24:return null;default:return null}}var Sa=!1,Se=!1,Gx=typeof WeakSet=="function"?WeakSet:Set,rt=null;function $n(e,s){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(o){Vt(e,s,o)}else n.current=null}function du(e,s,n){try{n()}catch(o){Vt(e,s,o)}}var ag=!1;function Xx(e,s){if(Qc=$a,e=Ym(),qu(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else t:{n=(n=e.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var l=o.anchorOffset,c=o.focusNode;o=o.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break t}var f=0,g=-1,_=-1,v=0,x=0,S=e,T=null;e:for(;;){for(var D;S!==n||l!==0&&S.nodeType!==3||(g=f+l),S!==c||o!==0&&S.nodeType!==3||(_=f+o),S.nodeType===3&&(f+=S.nodeValue.length),(D=S.firstChild)!==null;)T=S,S=D;for(;;){if(S===e)break e;if(T===n&&++v===l&&(g=f),T===c&&++x===o&&(_=f),(D=S.nextSibling)!==null)break;S=T,T=S.parentNode}S=D}n=g===-1||_===-1?null:{start:g,end:_}}else n=null}n=n||{start:0,end:0}}else n=null;for(qc={focusedElem:e,selectionRange:n},$a=!1,rt=s;rt!==null;)if(s=rt,e=s.child,(s.subtreeFlags&1028)!==0&&e!==null)e.return=s,rt=e;else for(;rt!==null;){s=rt;try{var F=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(F!==null){var O=F.memoizedProps,L=F.memoizedState,P=s.stateNode,A=P.getSnapshotBeforeUpdate(s.elementType===s.type?O:wi(s.type,O),L);P.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var I=s.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(H){Vt(s,s.return,H)}if(e=s.sibling,e!==null){e.return=s.return,rt=e;break}rt=s.return}return F=ag,ag=!1,F}function eo(e,s,n){var o=s.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&e)===e){var c=l.destroy;l.destroy=void 0,c!==void 0&&du(s,n,c)}l=l.next}while(l!==o)}}function Al(e,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==s)}}function fu(e){var s=e.ref;if(s!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof s=="function"?s(e):s.current=e}}function V_(e){var s=e.alternate;s!==null&&(e.alternate=null,V_(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&(delete s[Ni],delete s[go],delete s[Jc],delete s[Px],delete s[Rx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function G_(e){return e.tag===5||e.tag===3||e.tag===4}function lg(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||G_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function pu(e,s,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,s?n.nodeType===8?n.parentNode.insertBefore(e,s):n.insertBefore(e,s):(n.nodeType===8?(s=n.parentNode,s.insertBefore(e,n)):(s=n,s.appendChild(e)),n=n._reactRootContainer,n!=null||s.onclick!==null||(s.onclick=qa));else if(o!==4&&(e=e.child,e!==null))for(pu(e,s,n),e=e.sibling;e!==null;)pu(e,s,n),e=e.sibling}function gu(e,s,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,s?n.insertBefore(e,s):n.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(gu(e,s,n),e=e.sibling;e!==null;)gu(e,s,n),e=e.sibling}var ve=null,xi=!1;function cs(e,s,n){for(n=n.child;n!==null;)X_(e,s,n),n=n.sibling}function X_(e,s,n){if(Ui&&typeof Ui.onCommitFiberUnmount=="function")try{Ui.onCommitFiberUnmount(vl,n)}catch{}switch(n.tag){case 5:Se||$n(n,s);case 6:var o=ve,l=xi;ve=null,cs(e,s,n),ve=o,xi=l,ve!==null&&(xi?(e=ve,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ve.removeChild(n.stateNode));break;case 18:ve!==null&&(xi?(e=ve,n=n.stateNode,e.nodeType===8?lc(e.parentNode,n):e.nodeType===1&&lc(e,n),ho(e)):lc(ve,n.stateNode));break;case 4:o=ve,l=xi,ve=n.stateNode.containerInfo,xi=!0,cs(e,s,n),ve=o,xi=l;break;case 0:case 11:case 14:case 15:if(!Se&&(o=n.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){l=o=o.next;do{var c=l,f=c.destroy;c=c.tag,f!==void 0&&(c&2||c&4)&&du(n,s,f),l=l.next}while(l!==o)}cs(e,s,n);break;case 1:if(!Se&&($n(n,s),o=n.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(g){Vt(n,s,g)}cs(e,s,n);break;case 21:cs(e,s,n);break;case 22:n.mode&1?(Se=(o=Se)||n.memoizedState!==null,cs(e,s,n),Se=o):cs(e,s,n);break;default:cs(e,s,n)}}function hg(e){var s=e.updateQueue;if(s!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Gx),s.forEach(function(o){var l=eb.bind(null,e,o);n.has(o)||(n.add(o),o.then(l,l))})}}function yi(e,s){var n=s.deletions;if(n!==null)for(var o=0;o<n.length;o++){var l=n[o];try{var c=e,f=s,g=f;t:for(;g!==null;){switch(g.tag){case 5:ve=g.stateNode,xi=!1;break t;case 3:ve=g.stateNode.containerInfo,xi=!0;break t;case 4:ve=g.stateNode.containerInfo,xi=!0;break t}g=g.return}if(ve===null)throw Error(K(160));X_(c,f,l),ve=null,xi=!1;var _=l.alternate;_!==null&&(_.return=null),l.return=null}catch(v){Vt(l,s,v)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)$_(s,e),s=s.sibling}function $_(e,s){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yi(s,e),Li(e),o&4){try{eo(3,e,e.return),Al(3,e)}catch(O){Vt(e,e.return,O)}try{eo(5,e,e.return)}catch(O){Vt(e,e.return,O)}}break;case 1:yi(s,e),Li(e),o&512&&n!==null&&$n(n,n.return);break;case 5:if(yi(s,e),Li(e),o&512&&n!==null&&$n(n,n.return),e.flags&32){var l=e.stateNode;try{ro(l,"")}catch(O){Vt(e,e.return,O)}}if(o&4&&(l=e.stateNode,l!=null)){var c=e.memoizedProps,f=n!==null?n.memoizedProps:c,g=e.type,_=e.updateQueue;if(e.updateQueue=null,_!==null)try{g==="input"&&c.type==="radio"&&c.name!=null&&gm(l,c),Uc(g,f);var v=Uc(g,c);for(f=0;f<_.length;f+=2){var x=_[f],S=_[f+1];x==="style"?wm(l,S):x==="dangerouslySetInnerHTML"?vm(l,S):x==="children"?ro(l,S):Ou(l,x,S,v)}switch(g){case"input":Bc(l,c);break;case"textarea":mm(l,c);break;case"select":var T=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!c.multiple;var D=c.value;D!=null?Qn(l,!!c.multiple,D,!1):T!==!!c.multiple&&(c.defaultValue!=null?Qn(l,!!c.multiple,c.defaultValue,!0):Qn(l,!!c.multiple,c.multiple?[]:"",!1))}l[go]=c}catch(O){Vt(e,e.return,O)}}break;case 6:if(yi(s,e),Li(e),o&4){if(e.stateNode===null)throw Error(K(162));l=e.stateNode,c=e.memoizedProps;try{l.nodeValue=c}catch(O){Vt(e,e.return,O)}}break;case 3:if(yi(s,e),Li(e),o&4&&n!==null&&n.memoizedState.isDehydrated)try{ho(s.containerInfo)}catch(O){Vt(e,e.return,O)}break;case 4:yi(s,e),Li(e);break;case 13:yi(s,e),Li(e),l=e.child,l.flags&8192&&(c=l.memoizedState!==null,l.stateNode.isHidden=c,!c||l.alternate!==null&&l.alternate.memoizedState!==null||(md=$t())),o&4&&hg(e);break;case 22:if(x=n!==null&&n.memoizedState!==null,e.mode&1?(Se=(v=Se)||x,yi(s,e),Se=v):yi(s,e),Li(e),o&8192){if(v=e.memoizedState!==null,(e.stateNode.isHidden=v)&&!x&&e.mode&1)for(rt=e,x=e.child;x!==null;){for(S=rt=x;rt!==null;){switch(T=rt,D=T.child,T.tag){case 0:case 11:case 14:case 15:eo(4,T,T.return);break;case 1:$n(T,T.return);var F=T.stateNode;if(typeof F.componentWillUnmount=="function"){o=T,n=T.return;try{s=o,F.props=s.memoizedProps,F.state=s.memoizedState,F.componentWillUnmount()}catch(O){Vt(o,n,O)}}break;case 5:$n(T,T.return);break;case 22:if(T.memoizedState!==null){ug(S);continue}}D!==null?(D.return=T,rt=D):ug(S)}x=x.sibling}t:for(x=null,S=e;;){if(S.tag===5){if(x===null){x=S;try{l=S.stateNode,v?(c=l.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(g=S.stateNode,_=S.memoizedProps.style,f=_!=null&&_.hasOwnProperty("display")?_.display:null,g.style.display=ym("display",f))}catch(O){Vt(e,e.return,O)}}}else if(S.tag===6){if(x===null)try{S.stateNode.nodeValue=v?"":S.memoizedProps}catch(O){Vt(e,e.return,O)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===e)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===e)break t;for(;S.sibling===null;){if(S.return===null||S.return===e)break t;x===S&&(x=null),S=S.return}x===S&&(x=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:yi(s,e),Li(e),o&4&&hg(e);break;case 21:break;default:yi(s,e),Li(e)}}function Li(e){var s=e.flags;if(s&2){try{t:{for(var n=e.return;n!==null;){if(G_(n)){var o=n;break t}n=n.return}throw Error(K(160))}switch(o.tag){case 5:var l=o.stateNode;o.flags&32&&(ro(l,""),o.flags&=-33);var c=lg(e);gu(e,c,l);break;case 3:case 4:var f=o.stateNode.containerInfo,g=lg(e);pu(e,g,f);break;default:throw Error(K(161))}}catch(_){Vt(e,e.return,_)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function $x(e,s,n){rt=e,Y_(e)}function Y_(e,s,n){for(var o=(e.mode&1)!==0;rt!==null;){var l=rt,c=l.child;if(l.tag===22&&o){var f=l.memoizedState!==null||Sa;if(!f){var g=l.alternate,_=g!==null&&g.memoizedState!==null||Se;g=Sa;var v=Se;if(Sa=f,(Se=_)&&!v)for(rt=l;rt!==null;)f=rt,_=f.child,f.tag===22&&f.memoizedState!==null?dg(l):_!==null?(_.return=f,rt=_):dg(l);for(;c!==null;)rt=c,Y_(c),c=c.sibling;rt=l,Sa=g,Se=v}cg(e)}else l.subtreeFlags&8772&&c!==null?(c.return=l,rt=c):cg(e)}}function cg(e){for(;rt!==null;){var s=rt;if(s.flags&8772){var n=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:Se||Al(5,s);break;case 1:var o=s.stateNode;if(s.flags&4&&!Se)if(n===null)o.componentDidMount();else{var l=s.elementType===s.type?n.memoizedProps:wi(s.type,n.memoizedProps);o.componentDidUpdate(l,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var c=s.updateQueue;c!==null&&Yp(s,c,o);break;case 3:var f=s.updateQueue;if(f!==null){if(n=null,s.child!==null)switch(s.child.tag){case 5:n=s.child.stateNode;break;case 1:n=s.child.stateNode}Yp(s,f,n)}break;case 5:var g=s.stateNode;if(n===null&&s.flags&4){n=g;var _=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&n.focus();break;case"img":_.src&&(n.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var v=s.alternate;if(v!==null){var x=v.memoizedState;if(x!==null){var S=x.dehydrated;S!==null&&ho(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}Se||s.flags&512&&fu(s)}catch(T){Vt(s,s.return,T)}}if(s===e){rt=null;break}if(n=s.sibling,n!==null){n.return=s.return,rt=n;break}rt=s.return}}function ug(e){for(;rt!==null;){var s=rt;if(s===e){rt=null;break}var n=s.sibling;if(n!==null){n.return=s.return,rt=n;break}rt=s.return}}function dg(e){for(;rt!==null;){var s=rt;try{switch(s.tag){case 0:case 11:case 15:var n=s.return;try{Al(4,s)}catch(_){Vt(s,n,_)}break;case 1:var o=s.stateNode;if(typeof o.componentDidMount=="function"){var l=s.return;try{o.componentDidMount()}catch(_){Vt(s,l,_)}}var c=s.return;try{fu(s)}catch(_){Vt(s,c,_)}break;case 5:var f=s.return;try{fu(s)}catch(_){Vt(s,f,_)}}}catch(_){Vt(s,s.return,_)}if(s===e){rt=null;break}var g=s.sibling;if(g!==null){g.return=s.return,rt=g;break}rt=s.return}}var Yx=Math.ceil,al=ns.ReactCurrentDispatcher,pd=ns.ReactCurrentOwner,di=ns.ReactCurrentBatchConfig,wt=0,ue=null,Kt=null,ye=0,Je=0,Yn=Is(0),oe=0,xo=null,un=0,Tl=0,gd=0,io=null,je=null,md=0,ar=1/0,Yi=null,ll=!1,mu=null,Ss=null,Ea=!1,_s=null,hl=0,so=0,_u=null,La=-1,Oa=0;function ke(){return wt&6?$t():La!==-1?La:La=$t()}function Es(e){return e.mode&1?wt&2&&ye!==0?ye&-ye:Dx.transition!==null?(Oa===0&&(Oa=km()),Oa):(e=St,e!==0||(e=window.event,e=e===void 0?16:Um(e.type)),e):1}function Si(e,s,n,o){if(50<so)throw so=0,_u=null,Error(K(185));To(e,n,o),(!(wt&2)||e!==ue)&&(e===ue&&(!(wt&2)&&(Tl|=n),oe===4&&gs(e,ye)),Xe(e,o),n===1&&wt===0&&!(s.mode&1)&&(ar=$t()+500,Cl&&Ds()))}function Xe(e,s){var n=e.callbackNode;Dw(e,s);var o=Xa(e,e===ue?ye:0);if(o===0)n!==null&&xp(n),e.callbackNode=null,e.callbackPriority=0;else if(s=o&-o,e.callbackPriority!==s){if(n!=null&&xp(n),s===1)e.tag===0?Ix(fg.bind(null,e)):n_(fg.bind(null,e)),Ax(function(){!(wt&6)&&Ds()}),n=null;else{switch(Fm(o)){case 1:n=ju;break;case 4:n=Im;break;case 16:n=Ga;break;case 536870912:n=Dm;break;default:n=Ga}n=iv(n,Q_.bind(null,e))}e.callbackPriority=s,e.callbackNode=n}}function Q_(e,s){if(La=-1,Oa=0,wt&6)throw Error(K(327));var n=e.callbackNode;if(tr()&&e.callbackNode!==n)return null;var o=Xa(e,e===ue?ye:0);if(o===0)return null;if(o&30||o&e.expiredLanes||s)s=cl(e,o);else{s=o;var l=wt;wt|=2;var c=Z_();(ue!==e||ye!==s)&&(Yi=null,ar=$t()+500,nn(e,s));do try{Zx();break}catch(g){q_(e,g)}while(!0);ed(),al.current=c,wt=l,Kt!==null?s=0:(ue=null,ye=0,s=oe)}if(s!==0){if(s===2&&(l=Vc(e),l!==0&&(o=l,s=vu(e,l))),s===1)throw n=xo,nn(e,0),gs(e,o),Xe(e,$t()),n;if(s===6)gs(e,o);else{if(l=e.current.alternate,!(o&30)&&!Qx(l)&&(s=cl(e,o),s===2&&(c=Vc(e),c!==0&&(o=c,s=vu(e,c))),s===1))throw n=xo,nn(e,0),gs(e,o),Xe(e,$t()),n;switch(e.finishedWork=l,e.finishedLanes=o,s){case 0:case 1:throw Error(K(345));case 2:Ks(e,je,Yi);break;case 3:if(gs(e,o),(o&130023424)===o&&(s=md+500-$t(),10<s)){if(Xa(e,0)!==0)break;if(l=e.suspendedLanes,(l&o)!==o){ke(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=Kc(Ks.bind(null,e,je,Yi),s);break}Ks(e,je,Yi);break;case 4:if(gs(e,o),(o&4194240)===o)break;for(s=e.eventTimes,l=-1;0<o;){var f=31-Ci(o);c=1<<f,f=s[f],f>l&&(l=f),o&=~c}if(o=l,o=$t()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Yx(o/1960))-o,10<o){e.timeoutHandle=Kc(Ks.bind(null,e,je,Yi),o);break}Ks(e,je,Yi);break;case 5:Ks(e,je,Yi);break;default:throw Error(K(329))}}}return Xe(e,$t()),e.callbackNode===n?Q_.bind(null,e):null}function vu(e,s){var n=io;return e.current.memoizedState.isDehydrated&&(nn(e,s).flags|=256),e=cl(e,s),e!==2&&(s=je,je=n,s!==null&&yu(s)),e}function yu(e){je===null?je=e:je.push.apply(je,e)}function Qx(e){for(var s=e;;){if(s.flags&16384){var n=s.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var o=0;o<n.length;o++){var l=n[o],c=l.getSnapshot;l=l.value;try{if(!Ei(c(),l))return!1}catch{return!1}}}if(n=s.child,s.subtreeFlags&16384&&n!==null)n.return=s,s=n;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function gs(e,s){for(s&=~gd,s&=~Tl,e.suspendedLanes|=s,e.pingedLanes&=~s,e=e.expirationTimes;0<s;){var n=31-Ci(s),o=1<<n;e[n]=-1,s&=~o}}function fg(e){if(wt&6)throw Error(K(327));tr();var s=Xa(e,0);if(!(s&1))return Xe(e,$t()),null;var n=cl(e,s);if(e.tag!==0&&n===2){var o=Vc(e);o!==0&&(s=o,n=vu(e,o))}if(n===1)throw n=xo,nn(e,0),gs(e,s),Xe(e,$t()),n;if(n===6)throw Error(K(345));return e.finishedWork=e.current.alternate,e.finishedLanes=s,Ks(e,je,Yi),Xe(e,$t()),null}function _d(e,s){var n=wt;wt|=1;try{return e(s)}finally{wt=n,wt===0&&(ar=$t()+500,Cl&&Ds())}}function dn(e){_s!==null&&_s.tag===0&&!(wt&6)&&tr();var s=wt;wt|=1;var n=di.transition,o=St;try{if(di.transition=null,St=1,e)return e()}finally{St=o,di.transition=n,wt=s,!(wt&6)&&Ds()}}function vd(){Je=Yn.current,Rt(Yn)}function nn(e,s){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Ex(n)),Kt!==null)for(n=Kt.return;n!==null;){var o=n;switch(Ku(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&Za();break;case 3:rr(),Rt(Ve),Rt(Ee),ad();break;case 5:od(o);break;case 4:rr();break;case 13:Rt(Ot);break;case 19:Rt(Ot);break;case 10:id(o.type._context);break;case 22:case 23:vd()}n=n.return}if(ue=e,Kt=e=As(e.current,null),ye=Je=s,oe=0,xo=null,gd=Tl=un=0,je=io=null,tn!==null){for(s=0;s<tn.length;s++)if(n=tn[s],o=n.interleaved,o!==null){n.interleaved=null;var l=o.next,c=n.pending;if(c!==null){var f=c.next;c.next=l,o.next=f}n.pending=o}tn=null}return e}function q_(e,s){do{var n=Kt;try{if(ed(),Fa.current=ol,rl){for(var o=Nt.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}rl=!1}if(cn=0,ce=re=Nt=null,to=!1,vo=0,pd.current=null,n===null||n.return===null){oe=1,xo=s,Kt=null;break}t:{var c=e,f=n.return,g=n,_=s;if(s=ye,g.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var v=_,x=g,S=x.tag;if(!(x.mode&1)&&(S===0||S===11||S===15)){var T=x.alternate;T?(x.updateQueue=T.updateQueue,x.memoizedState=T.memoizedState,x.lanes=T.lanes):(x.updateQueue=null,x.memoizedState=null)}var D=tg(f);if(D!==null){D.flags&=-257,eg(D,f,g,c,s),D.mode&1&&Jp(c,v,s),s=D,_=v;var F=s.updateQueue;if(F===null){var O=new Set;O.add(_),s.updateQueue=O}else F.add(_);break t}else{if(!(s&1)){Jp(c,v,s),yd();break t}_=Error(K(426))}}else if(kt&&g.mode&1){var L=tg(f);if(L!==null){!(L.flags&65536)&&(L.flags|=256),eg(L,f,g,c,s),Ju(or(_,g));break t}}c=_=or(_,g),oe!==4&&(oe=2),io===null?io=[c]:io.push(c),c=f;do{switch(c.tag){case 3:c.flags|=65536,s&=-s,c.lanes|=s;var P=F_(c,_,s);$p(c,P);break t;case 1:g=_;var A=c.type,I=c.stateNode;if(!(c.flags&128)&&(typeof A.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Ss===null||!Ss.has(I)))){c.flags|=65536,s&=-s,c.lanes|=s;var H=B_(c,g,s);$p(c,H);break t}}c=c.return}while(c!==null)}J_(n)}catch(j){s=j,Kt===n&&n!==null&&(Kt=n=n.return);continue}break}while(!0)}function Z_(){var e=al.current;return al.current=ol,e===null?ol:e}function yd(){(oe===0||oe===3||oe===2)&&(oe=4),ue===null||!(un&268435455)&&!(Tl&268435455)||gs(ue,ye)}function cl(e,s){var n=wt;wt|=2;var o=Z_();(ue!==e||ye!==s)&&(Yi=null,nn(e,s));do try{qx();break}catch(l){q_(e,l)}while(!0);if(ed(),wt=n,al.current=o,Kt!==null)throw Error(K(261));return ue=null,ye=0,oe}function qx(){for(;Kt!==null;)K_(Kt)}function Zx(){for(;Kt!==null&&!bw();)K_(Kt)}function K_(e){var s=ev(e.alternate,e,Je);e.memoizedProps=e.pendingProps,s===null?J_(e):Kt=s,pd.current=null}function J_(e){var s=e;do{var n=s.alternate;if(e=s.return,s.flags&32768){if(n=Vx(n,s),n!==null){n.flags&=32767,Kt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{oe=6,Kt=null;return}}else if(n=Wx(n,s,Je),n!==null){Kt=n;return}if(s=s.sibling,s!==null){Kt=s;return}Kt=s=e}while(s!==null);oe===0&&(oe=5)}function Ks(e,s,n){var o=St,l=di.transition;try{di.transition=null,St=1,Kx(e,s,n,o)}finally{di.transition=l,St=o}return null}function Kx(e,s,n,o){do tr();while(_s!==null);if(wt&6)throw Error(K(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(K(177));e.callbackNode=null,e.callbackPriority=0;var c=n.lanes|n.childLanes;if(kw(e,c),e===ue&&(Kt=ue=null,ye=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ea||(Ea=!0,iv(Ga,function(){return tr(),null})),c=(n.flags&15990)!==0,n.subtreeFlags&15990||c){c=di.transition,di.transition=null;var f=St;St=1;var g=wt;wt|=4,pd.current=null,Xx(e,n),$_(n,e),vx(qc),$a=!!Qc,qc=Qc=null,e.current=n,$x(n),Cw(),wt=g,St=f,di.transition=c}else e.current=n;if(Ea&&(Ea=!1,_s=e,hl=l),c=e.pendingLanes,c===0&&(Ss=null),Aw(n.stateNode),Xe(e,$t()),s!==null)for(o=e.onRecoverableError,n=0;n<s.length;n++)l=s[n],o(l.value,{componentStack:l.stack,digest:l.digest});if(ll)throw ll=!1,e=mu,mu=null,e;return hl&1&&e.tag!==0&&tr(),c=e.pendingLanes,c&1?e===_u?so++:(so=0,_u=e):so=0,Ds(),null}function tr(){if(_s!==null){var e=Fm(hl),s=di.transition,n=St;try{if(di.transition=null,St=16>e?16:e,_s===null)var o=!1;else{if(e=_s,_s=null,hl=0,wt&6)throw Error(K(331));var l=wt;for(wt|=4,rt=e.current;rt!==null;){var c=rt,f=c.child;if(rt.flags&16){var g=c.deletions;if(g!==null){for(var _=0;_<g.length;_++){var v=g[_];for(rt=v;rt!==null;){var x=rt;switch(x.tag){case 0:case 11:case 15:eo(8,x,c)}var S=x.child;if(S!==null)S.return=x,rt=S;else for(;rt!==null;){x=rt;var T=x.sibling,D=x.return;if(V_(x),x===v){rt=null;break}if(T!==null){T.return=D,rt=T;break}rt=D}}}var F=c.alternate;if(F!==null){var O=F.child;if(O!==null){F.child=null;do{var L=O.sibling;O.sibling=null,O=L}while(O!==null)}}rt=c}}if(c.subtreeFlags&2064&&f!==null)f.return=c,rt=f;else t:for(;rt!==null;){if(c=rt,c.flags&2048)switch(c.tag){case 0:case 11:case 15:eo(9,c,c.return)}var P=c.sibling;if(P!==null){P.return=c.return,rt=P;break t}rt=c.return}}var A=e.current;for(rt=A;rt!==null;){f=rt;var I=f.child;if(f.subtreeFlags&2064&&I!==null)I.return=f,rt=I;else t:for(f=A;rt!==null;){if(g=rt,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:Al(9,g)}}catch(j){Vt(g,g.return,j)}if(g===f){rt=null;break t}var H=g.sibling;if(H!==null){H.return=g.return,rt=H;break t}rt=g.return}}if(wt=l,Ds(),Ui&&typeof Ui.onPostCommitFiberRoot=="function")try{Ui.onPostCommitFiberRoot(vl,e)}catch{}o=!0}return o}finally{St=n,di.transition=s}}return!1}function pg(e,s,n){s=or(n,s),s=F_(e,s,1),e=Cs(e,s,1),s=ke(),e!==null&&(To(e,1,s),Xe(e,s))}function Vt(e,s,n){if(e.tag===3)pg(e,e,n);else for(;s!==null;){if(s.tag===3){pg(s,e,n);break}else if(s.tag===1){var o=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ss===null||!Ss.has(o))){e=or(n,e),e=B_(s,e,1),s=Cs(s,e,1),e=ke(),s!==null&&(To(s,1,e),Xe(s,e));break}}s=s.return}}function Jx(e,s,n){var o=e.pingCache;o!==null&&o.delete(s),s=ke(),e.pingedLanes|=e.suspendedLanes&n,ue===e&&(ye&n)===n&&(oe===4||oe===3&&(ye&130023424)===ye&&500>$t()-md?nn(e,0):gd|=n),Xe(e,s)}function tv(e,s){s===0&&(e.mode&1?(s=ga,ga<<=1,!(ga&130023424)&&(ga=4194304)):s=1);var n=ke();e=is(e,s),e!==null&&(To(e,s,n),Xe(e,n))}function tb(e){var s=e.memoizedState,n=0;s!==null&&(n=s.retryLane),tv(e,n)}function eb(e,s){var n=0;switch(e.tag){case 13:var o=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(K(314))}o!==null&&o.delete(s),tv(e,n)}var ev;ev=function(e,s,n){if(e!==null)if(e.memoizedProps!==s.pendingProps||Ve.current)We=!0;else{if(!(e.lanes&n)&&!(s.flags&128))return We=!1,jx(e,s,n);We=!!(e.flags&131072)}else We=!1,kt&&s.flags&1048576&&r_(s,tl,s.index);switch(s.lanes=0,s.tag){case 2:var o=s.type;Ma(e,s),e=s.pendingProps;var l=ir(s,Ee.current);Jn(s,n),l=hd(null,s,o,e,l,n);var c=cd();return s.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Ge(o)?(c=!0,Ka(s)):c=!1,s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,nd(s),l.updater=El,s.stateNode=l,l._reactInternals=s,ru(s,o,e,n),s=lu(null,s,o,!0,c,n)):(s.tag=0,kt&&c&&Zu(s),De(null,s,l,n),s=s.child),s;case 16:o=s.elementType;t:{switch(Ma(e,s),e=s.pendingProps,l=o._init,o=l(o._payload),s.type=o,l=s.tag=sb(o),e=wi(o,e),l){case 0:s=au(null,s,o,e,n);break t;case 1:s=ng(null,s,o,e,n);break t;case 11:s=ig(null,s,o,e,n);break t;case 14:s=sg(null,s,o,wi(o.type,e),n);break t}throw Error(K(306,o,""))}return s;case 0:return o=s.type,l=s.pendingProps,l=s.elementType===o?l:wi(o,l),au(e,s,o,l,n);case 1:return o=s.type,l=s.pendingProps,l=s.elementType===o?l:wi(o,l),ng(e,s,o,l,n);case 3:t:{if(N_(s),e===null)throw Error(K(387));o=s.pendingProps,c=s.memoizedState,l=c.element,u_(e,s),sl(s,o,null,n);var f=s.memoizedState;if(o=f.element,c.isDehydrated)if(c={element:o,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},s.updateQueue.baseState=c,s.memoizedState=c,s.flags&256){l=or(Error(K(423)),s),s=rg(e,s,o,n,l);break t}else if(o!==l){l=or(Error(K(424)),s),s=rg(e,s,o,n,l);break t}else for(ti=bs(s.stateNode.containerInfo.firstChild),ei=s,kt=!0,bi=null,n=h_(s,null,o,n),s.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sr(),o===l){s=ss(e,s,n);break t}De(e,s,o,n)}s=s.child}return s;case 5:return d_(s),e===null&&iu(s),o=s.type,l=s.pendingProps,c=e!==null?e.memoizedProps:null,f=l.children,Zc(o,l)?f=null:c!==null&&Zc(o,c)&&(s.flags|=32),O_(e,s),De(e,s,f,n),s.child;case 6:return e===null&&iu(s),null;case 13:return U_(e,s,n);case 4:return rd(s,s.stateNode.containerInfo),o=s.pendingProps,e===null?s.child=nr(s,null,o,n):De(e,s,o,n),s.child;case 11:return o=s.type,l=s.pendingProps,l=s.elementType===o?l:wi(o,l),ig(e,s,o,l,n);case 7:return De(e,s,s.pendingProps,n),s.child;case 8:return De(e,s,s.pendingProps.children,n),s.child;case 12:return De(e,s,s.pendingProps.children,n),s.child;case 10:t:{if(o=s.type._context,l=s.pendingProps,c=s.memoizedProps,f=l.value,At(el,o._currentValue),o._currentValue=f,c!==null)if(Ei(c.value,f)){if(c.children===l.children&&!Ve.current){s=ss(e,s,n);break t}}else for(c=s.child,c!==null&&(c.return=s);c!==null;){var g=c.dependencies;if(g!==null){f=c.child;for(var _=g.firstContext;_!==null;){if(_.context===o){if(c.tag===1){_=Ji(-1,n&-n),_.tag=2;var v=c.updateQueue;if(v!==null){v=v.shared;var x=v.pending;x===null?_.next=_:(_.next=x.next,x.next=_),v.pending=_}}c.lanes|=n,_=c.alternate,_!==null&&(_.lanes|=n),su(c.return,n,s),g.lanes|=n;break}_=_.next}}else if(c.tag===10)f=c.type===s.type?null:c.child;else if(c.tag===18){if(f=c.return,f===null)throw Error(K(341));f.lanes|=n,g=f.alternate,g!==null&&(g.lanes|=n),su(f,n,s),f=c.sibling}else f=c.child;if(f!==null)f.return=c;else for(f=c;f!==null;){if(f===s){f=null;break}if(c=f.sibling,c!==null){c.return=f.return,f=c;break}f=f.return}c=f}De(e,s,l.children,n),s=s.child}return s;case 9:return l=s.type,o=s.pendingProps.children,Jn(s,n),l=fi(l),o=o(l),s.flags|=1,De(e,s,o,n),s.child;case 14:return o=s.type,l=wi(o,s.pendingProps),l=wi(o.type,l),sg(e,s,o,l,n);case 15:return M_(e,s,s.type,s.pendingProps,n);case 17:return o=s.type,l=s.pendingProps,l=s.elementType===o?l:wi(o,l),Ma(e,s),s.tag=1,Ge(o)?(e=!0,Ka(s)):e=!1,Jn(s,n),k_(s,o,l),ru(s,o,l,n),lu(null,s,o,!0,e,n);case 19:return z_(e,s,n);case 22:return L_(e,s,n)}throw Error(K(156,s.tag))};function iv(e,s){return Rm(e,s)}function ib(e,s,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(e,s,n,o){return new ib(e,s,n,o)}function wd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function sb(e){if(typeof e=="function")return wd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Uu)return 11;if(e===zu)return 14}return 2}function As(e,s){var n=e.alternate;return n===null?(n=ui(e.tag,s,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=s,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,s=e.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Na(e,s,n,o,l,c){var f=2;if(o=e,typeof e=="function")wd(e)&&(f=1);else if(typeof e=="string")f=5;else t:switch(e){case Nn:return rn(n.children,l,c,s);case Nu:f=8,l|=8;break;case Rc:return e=ui(12,n,s,l|2),e.elementType=Rc,e.lanes=c,e;case Ic:return e=ui(13,n,s,l),e.elementType=Ic,e.lanes=c,e;case Dc:return e=ui(19,n,s,l),e.elementType=Dc,e.lanes=c,e;case dm:return Pl(n,l,c,s);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case cm:f=10;break t;case um:f=9;break t;case Uu:f=11;break t;case zu:f=14;break t;case ds:f=16,o=null;break t}throw Error(K(130,e==null?e:typeof e,""))}return s=ui(f,n,s,l),s.elementType=e,s.type=o,s.lanes=c,s}function rn(e,s,n,o){return e=ui(7,e,o,s),e.lanes=n,e}function Pl(e,s,n,o){return e=ui(22,e,o,s),e.elementType=dm,e.lanes=n,e.stateNode={isHidden:!1},e}function mc(e,s,n){return e=ui(6,e,null,s),e.lanes=n,e}function _c(e,s,n){return s=ui(4,e.children!==null?e.children:[],e.key,s),s.lanes=n,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}function nb(e,s,n,o,l){this.tag=s,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zh(0),this.expirationTimes=Zh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zh(0),this.identifierPrefix=o,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function xd(e,s,n,o,l,c,f,g,_){return e=new nb(e,s,n,g,_),s===1?(s=1,c===!0&&(s|=8)):s=0,c=ui(3,null,null,s),e.current=c,c.stateNode=e,c.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},nd(c),e}function rb(e,s,n){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:On,key:o==null?null:""+o,children:e,containerInfo:s,implementation:n}}function sv(e){if(!e)return Ps;e=e._reactInternals;t:{if(gn(e)!==e||e.tag!==1)throw Error(K(170));var s=e;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(Ge(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(s!==null);throw Error(K(171))}if(e.tag===1){var n=e.type;if(Ge(n))return s_(e,n,s)}return s}function nv(e,s,n,o,l,c,f,g,_){return e=xd(n,o,!0,e,l,c,f,g,_),e.context=sv(null),n=e.current,o=ke(),l=Es(n),c=Ji(o,l),c.callback=s??null,Cs(n,c,l),e.current.lanes=l,To(e,l,o),Xe(e,o),e}function Rl(e,s,n,o){var l=s.current,c=ke(),f=Es(l);return n=sv(n),s.context===null?s.context=n:s.pendingContext=n,s=Ji(c,f),s.payload={element:e},o=o===void 0?null:o,o!==null&&(s.callback=o),e=Cs(l,s,f),e!==null&&(Si(e,l,f,c),ka(e,l,f)),f}function ul(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function gg(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<s?n:s}}function bd(e,s){gg(e,s),(e=e.alternate)&&gg(e,s)}function ob(){return null}var rv=typeof reportError=="function"?reportError:function(e){console.error(e)};function Cd(e){this._internalRoot=e}Il.prototype.render=Cd.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(K(409));Rl(e,s,null,null)};Il.prototype.unmount=Cd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;dn(function(){Rl(null,e,null,null)}),s[es]=null}};function Il(e){this._internalRoot=e}Il.prototype.unstable_scheduleHydration=function(e){if(e){var s=Lm();e={blockedOn:null,target:e,priority:s};for(var n=0;n<ps.length&&s!==0&&s<ps[n].priority;n++);ps.splice(n,0,e),n===0&&Nm(e)}};function Sd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Dl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function mg(){}function ab(e,s,n,o,l){if(l){if(typeof o=="function"){var c=o;o=function(){var v=ul(f);c.call(v)}}var f=nv(s,o,e,0,null,!1,!1,"",mg);return e._reactRootContainer=f,e[es]=f.current,fo(e.nodeType===8?e.parentNode:e),dn(),f}for(;l=e.lastChild;)e.removeChild(l);if(typeof o=="function"){var g=o;o=function(){var v=ul(_);g.call(v)}}var _=xd(e,0,!1,null,null,!1,!1,"",mg);return e._reactRootContainer=_,e[es]=_.current,fo(e.nodeType===8?e.parentNode:e),dn(function(){Rl(s,_,n,o)}),_}function kl(e,s,n,o,l){var c=n._reactRootContainer;if(c){var f=c;if(typeof l=="function"){var g=l;l=function(){var _=ul(f);g.call(_)}}Rl(s,f,e,l)}else f=ab(n,s,e,l,o);return ul(f)}Bm=function(e){switch(e.tag){case 3:var s=e.stateNode;if(s.current.memoizedState.isDehydrated){var n=$r(s.pendingLanes);n!==0&&(Wu(s,n|1),Xe(s,$t()),!(wt&6)&&(ar=$t()+500,Ds()))}break;case 13:dn(function(){var o=is(e,1);if(o!==null){var l=ke();Si(o,e,1,l)}}),bd(e,1)}};Vu=function(e){if(e.tag===13){var s=is(e,134217728);if(s!==null){var n=ke();Si(s,e,134217728,n)}bd(e,134217728)}};Mm=function(e){if(e.tag===13){var s=Es(e),n=is(e,s);if(n!==null){var o=ke();Si(n,e,s,o)}bd(e,s)}};Lm=function(){return St};Om=function(e,s){var n=St;try{return St=e,s()}finally{St=n}};Hc=function(e,s,n){switch(s){case"input":if(Bc(e,n),s=n.name,n.type==="radio"&&s!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<n.length;s++){var o=n[s];if(o!==e&&o.form===e.form){var l=bl(o);if(!l)throw Error(K(90));pm(o),Bc(o,l)}}}break;case"textarea":mm(e,n);break;case"select":s=n.value,s!=null&&Qn(e,!!n.multiple,s,!1)}};Cm=_d;Sm=dn;var lb={usingClientEntryPoint:!1,Events:[Ro,jn,bl,xm,bm,_d]},jr={findFiberByHostInstance:Js,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hb={bundleType:jr.bundleType,version:jr.version,rendererPackageName:jr.rendererPackageName,rendererConfig:jr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ns.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Tm(e),e===null?null:e.stateNode},findFiberByHostInstance:jr.findFiberByHostInstance||ob,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Aa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Aa.isDisabled&&Aa.supportsFiber)try{vl=Aa.inject(hb),Ui=Aa}catch{}}ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lb;ri.createPortal=function(e,s){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sd(s))throw Error(K(200));return rb(e,s,null,n)};ri.createRoot=function(e,s){if(!Sd(e))throw Error(K(299));var n=!1,o="",l=rv;return s!=null&&(s.unstable_strictMode===!0&&(n=!0),s.identifierPrefix!==void 0&&(o=s.identifierPrefix),s.onRecoverableError!==void 0&&(l=s.onRecoverableError)),s=xd(e,1,!1,null,null,n,!1,o,l),e[es]=s.current,fo(e.nodeType===8?e.parentNode:e),new Cd(s)};ri.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(K(188)):(e=Object.keys(e).join(","),Error(K(268,e)));return e=Tm(s),e=e===null?null:e.stateNode,e};ri.flushSync=function(e){return dn(e)};ri.hydrate=function(e,s,n){if(!Dl(s))throw Error(K(200));return kl(null,e,s,!0,n)};ri.hydrateRoot=function(e,s,n){if(!Sd(e))throw Error(K(405));var o=n!=null&&n.hydratedSources||null,l=!1,c="",f=rv;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),s=nv(s,null,e,1,n??null,l,!1,c,f),e[es]=s.current,fo(e),o)for(e=0;e<o.length;e++)n=o[e],l=n._getVersion,l=l(n._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[n,l]:s.mutableSourceEagerHydrationData.push(n,l);return new Il(s)};ri.render=function(e,s,n){if(!Dl(s))throw Error(K(200));return kl(null,e,s,!1,n)};ri.unmountComponentAtNode=function(e){if(!Dl(e))throw Error(K(40));return e._reactRootContainer?(dn(function(){kl(null,null,e,!1,function(){e._reactRootContainer=null,e[es]=null})}),!0):!1};ri.unstable_batchedUpdates=_d;ri.unstable_renderSubtreeIntoContainer=function(e,s,n,o){if(!Dl(n))throw Error(K(200));if(e==null||e._reactInternals===void 0)throw Error(K(38));return kl(e,s,n,!1,o)};ri.version="18.3.1-next-f1338f8080-20240426";function ov(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ov)}catch(e){console.error(e)}}ov(),om.exports=ri;var cb=om.exports,_g=cb;Tc.createRoot=_g.createRoot,Tc.hydrateRoot=_g.hydrateRoot;const ub="modulepreload",db=function(e){return"/ais-telegram-webpages/"+e},vg={},fb=function(s,n,o){let l=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));l=Promise.all(n.map(g=>{if(g=db(g),g in vg)return;vg[g]=!0;const _=g.endsWith(".css"),v=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${v}`))return;const x=document.createElement("link");if(x.rel=_?"stylesheet":ub,_||(x.as="script",x.crossOrigin=""),x.href=g,f&&x.setAttribute("nonce",f),document.head.appendChild(x),_)return new Promise((S,T)=>{x.addEventListener("load",S),x.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${g}`)))})}))}return l.then(()=>s()).catch(c=>{const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c})};var av={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var s={}.hasOwnProperty;function n(){for(var c="",f=0;f<arguments.length;f++){var g=arguments[f];g&&(c=l(c,o(g)))}return c}function o(c){if(typeof c=="string"||typeof c=="number")return c;if(typeof c!="object")return"";if(Array.isArray(c))return n.apply(null,c);if(c.toString!==Object.prototype.toString&&!c.toString.toString().includes("[native code]"))return c.toString();var f="";for(var g in c)s.call(c,g)&&c[g]&&(f=l(f,g));return f}function l(c,f){return f?c?c+" "+f:c+f:c}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(av);var pb=av.exports;const Me=Iu(pb),gb=["xxl","xl","lg","md","sm","xs"],mb="xs",_b=Y.createContext({prefixes:{},breakpoints:gb,minBreakpoint:mb});function ai(e,s){const{prefixes:n}=Y.useContext(_b);return e||n[s]||s}var lv={exports:{}},vb="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",yb=vb,wb=yb;function hv(){}function cv(){}cv.resetWarningCache=hv;var xb=function(){function e(o,l,c,f,g,_){if(_!==wb){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}e.isRequired=e;function s(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:s,element:e,elementType:e,instanceOf:s,node:e,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:cv,resetWarningCache:hv};return n.PropTypes=n,n};lv.exports=xb();var bb=lv.exports;const Wr=Iu(bb),uv=e=>Y.forwardRef((s,n)=>q.jsx("div",{...s,ref:n,className:Me(s.className,e)})),Cb=["as","disabled"];function Sb(e,s){if(e==null)return{};var n={},o=Object.keys(e),l,c;for(c=0;c<o.length;c++)l=o[c],!(s.indexOf(l)>=0)&&(n[l]=e[l]);return n}function Eb(e){return!e||e.trim()==="#"}function dv({tagName:e,disabled:s,href:n,target:o,rel:l,role:c,onClick:f,tabIndex:g=0,type:_}){e||(n!=null||o!=null||l!=null?e="a":e="button");const v={tagName:e};if(e==="button")return[{type:_||"button",disabled:s},v];const x=T=>{if((s||e==="a"&&Eb(n))&&T.preventDefault(),s){T.stopPropagation();return}f==null||f(T)},S=T=>{T.key===" "&&(T.preventDefault(),x(T))};return e==="a"&&(n||(n="#"),s&&(n=void 0)),[{role:c??"button",disabled:void 0,tabIndex:s?void 0:g,href:n,target:e==="a"?o:void 0,"aria-disabled":s||void 0,rel:e==="a"?l:void 0,onClick:x,onKeyDown:S},v]}const Ab=Y.forwardRef((e,s)=>{let{as:n,disabled:o}=e,l=Sb(e,Cb);const[c,{tagName:f}]=dv(Object.assign({tagName:n,disabled:o},l));return q.jsx(f,Object.assign({},l,c,{ref:s}))});Ab.displayName="Button";const Ed=Y.forwardRef(({as:e,bsPrefix:s,variant:n="primary",size:o,active:l=!1,disabled:c=!1,className:f,...g},_)=>{const v=ai(s,"btn"),[x,{tagName:S}]=dv({tagName:e,disabled:c,...g}),T=S;return q.jsx(T,{...x,...g,ref:_,disabled:c,className:Me(f,v,l&&"active",n&&`${v}-${n}`,o&&`${v}-${o}`,g.href&&c&&"disabled")})});Ed.displayName="Button";const Ad=Y.forwardRef(({className:e,bsPrefix:s,as:n="div",...o},l)=>(s=ai(s,"card-body"),q.jsx(n,{ref:l,className:Me(e,s),...o})));Ad.displayName="CardBody";const fv=Y.forwardRef(({className:e,bsPrefix:s,as:n="div",...o},l)=>(s=ai(s,"card-footer"),q.jsx(n,{ref:l,className:Me(e,s),...o})));fv.displayName="CardFooter";const pv=Y.createContext(null);pv.displayName="CardHeaderContext";const gv=Y.forwardRef(({bsPrefix:e,className:s,as:n="div",...o},l)=>{const c=ai(e,"card-header"),f=Y.useMemo(()=>({cardHeaderBsPrefix:c}),[c]);return q.jsx(pv.Provider,{value:f,children:q.jsx(n,{ref:l,...o,className:Me(s,c)})})});gv.displayName="CardHeader";const mv=Y.forwardRef(({bsPrefix:e,className:s,variant:n,as:o="img",...l},c)=>{const f=ai(e,"card-img");return q.jsx(o,{ref:c,className:Me(n?`${f}-${n}`:f,s),...l})});mv.displayName="CardImg";const _v=Y.forwardRef(({className:e,bsPrefix:s,as:n="div",...o},l)=>(s=ai(s,"card-img-overlay"),q.jsx(n,{ref:l,className:Me(e,s),...o})));_v.displayName="CardImgOverlay";const vv=Y.forwardRef(({className:e,bsPrefix:s,as:n="a",...o},l)=>(s=ai(s,"card-link"),q.jsx(n,{ref:l,className:Me(e,s),...o})));vv.displayName="CardLink";const Tb=uv("h6"),yv=Y.forwardRef(({className:e,bsPrefix:s,as:n=Tb,...o},l)=>(s=ai(s,"card-subtitle"),q.jsx(n,{ref:l,className:Me(e,s),...o})));yv.displayName="CardSubtitle";const wv=Y.forwardRef(({className:e,bsPrefix:s,as:n="p",...o},l)=>(s=ai(s,"card-text"),q.jsx(n,{ref:l,className:Me(e,s),...o})));wv.displayName="CardText";const Pb=uv("h5"),xv=Y.forwardRef(({className:e,bsPrefix:s,as:n=Pb,...o},l)=>(s=ai(s,"card-title"),q.jsx(n,{ref:l,className:Me(e,s),...o})));xv.displayName="CardTitle";const bv=Y.forwardRef(({bsPrefix:e,className:s,bg:n,text:o,border:l,body:c=!1,children:f,as:g="div",..._},v)=>{const x=ai(e,"card");return q.jsx(g,{ref:v,..._,className:Me(s,x,n&&`bg-${n}`,o&&`text-${o}`,l&&`border-${l}`),children:c?q.jsx(Ad,{children:f}):f})});bv.displayName="Card";const yg=Object.assign(bv,{Img:mv,Title:xv,Subtitle:yv,Body:Ad,Link:vv,Text:wv,Header:gv,Footer:fv,ImgOverlay:_v});function Rb(e,s){let n=0;return Y.Children.map(e,o=>Y.isValidElement(o)?s(o,n++):o)}Wr.string,Wr.bool,Wr.bool,Wr.bool,Wr.bool;const mn=Y.forwardRef(({bsPrefix:e,className:s,fluid:n=!1,rounded:o=!1,roundedCircle:l=!1,thumbnail:c=!1,...f},g)=>(e=ai(e,"img"),q.jsx("img",{ref:g,...f,className:Me(s,n&&`${e}-fluid`,o&&"rounded",l&&"rounded-circle",c&&`${e}-thumbnail`)})));mn.displayName="Image";const wg=1e3;function Ib(e,s,n){const o=(e-s)/(n-s)*100;return Math.round(o*wg)/wg}function xg({min:e,now:s,max:n,label:o,visuallyHidden:l,striped:c,animated:f,className:g,style:_,variant:v,bsPrefix:x,...S},T){return q.jsx("div",{ref:T,...S,role:"progressbar",className:Me(g,`${x}-bar`,{[`bg-${v}`]:v,[`${x}-bar-animated`]:f,[`${x}-bar-striped`]:f||c}),style:{width:`${Ib(s,e,n)}%`,..._},"aria-valuenow":s,"aria-valuemin":e,"aria-valuemax":n,children:l?q.jsx("span",{className:"visually-hidden",children:o}):o})}const Cv=Y.forwardRef(({isChild:e=!1,...s},n)=>{const o={min:0,max:100,animated:!1,visuallyHidden:!1,striped:!1,...s};if(o.bsPrefix=ai(o.bsPrefix,"progress"),e)return xg(o,n);const{min:l,now:c,max:f,label:g,visuallyHidden:_,striped:v,animated:x,bsPrefix:S,variant:T,className:D,children:F,...O}=o;return q.jsx("div",{ref:n,...O,className:Me(D,S),children:F?Rb(F,L=>Y.cloneElement(L,{isChild:!0})):xg({min:l,now:c,max:f,label:g,visuallyHidden:_,striped:v,animated:x,bsPrefix:S,variant:T},n)})});Cv.displayName="ProgressBar";const Db="/ais-telegram-webpages/assets/DiggerButton-CiwoLz5n.png";function kb({onTap:e,children:s}){const n=Y.useRef(null),[o,l]=Y.useState(!1);Y.useContext(Fd),Y.useEffect(()=>{if(o){const _=setTimeout(()=>l(!1),100);return()=>clearTimeout(_)}},[o]);const c=(_,v)=>{const x=n.current;if(x){const S=x.getBoundingClientRect();return[_-S.left,v-S.top]}return[_,v]},f=_=>{l(!0);const v=_.touches;for(let x=0;x<v.length;x++){const S=v[x],[T,D]=c(S.clientX,S.clientY);e(T,D)}},g=_=>{if(!o){const[v,x]=c(_.clientX,_.clientY);e(v,x)}};return Y.useEffect(()=>{const _=x=>{x.touches.length===1&&x.changedTouches[0].clientY>0&&x.preventDefault()},v=n.current;return v&&(v.addEventListener("touchstart",_,{passive:!1}),v.addEventListener("touchmove",_,{passive:!1})),()=>{v&&(v.removeEventListener("touchstart",_),v.removeEventListener("touchmove",_))}},[]),q.jsxs("div",{ref:n,className:"relative flex h-72 justify-center",onTouchStart:f,onMouseDown:g,children:[q.jsx(mn,{src:Db,className:"tap-button w-100 h-auto object-contain",rounded:!0,draggable:"false"}),s]})}const Sv="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAABHNCSVQICAgIfAhkiAAABHFJREFUWEfVWVFO20AQnbWd/paegPxWVQn8VW0Q4QTQE5AbEE5AOAHhBA0naDhBjaBV/0ioqv7CCQq/je3pm107cRw7sZNg2pWiRIl39+3szJs3E0UrGny7vUMcVMlSVWJq6GUZnxVVU7dg7uO3B/z2gPc+nu2T7d+rN9/6WZDUolj5prFGlneAjQBM7S+6ztQ81uB7OLiral/P478XBqtB2v4pFmmuDGDWQgLc4o56e30ijxQCyz/fb5Jnf8GstScHGt9AXCZwdouBHWz/Lh3oGPRFbrDaqr59U6pFJ6xLj7nB6uC+rSNSVe1ZADOfFQOrg8vrAfBOqYAFaO26VQhsBBCcCibgVglWPifFXbCBW5gNktY07KAapIRnV2BtpkfNsUQuVYauev39bimenXX9/OtdlTynSkGYwZSq4gbwShmMrCXZixhciuzlOX215UpGmxo8+HBAZLUXcoMy/FUf/I+zhxtrRSn7nwE70hbK2iRmca3NpFFyg9UnHVbWR2IlzbyB5HUtSB5nCZJwrTZcYB2Wa+S9qUywOngCa08rKMYpF0qxjCgGeASM2ri6iIMKhVAbhzvMCfZ8AqxewPEOKVDNTGmXc+XpKAnVVGV4Eo9yQ4P0ac6yF8iezRFYPYnpdDELFj5BB5Y+imYh2hFElii5xOBL4GlP8CyAysnkhOWNSEmFdDVO5QDI3KMXfm+KZ7NPVQZu7qmN64+yk7hgJs/+qCNu6FjxoH6TRhNlQNV7+ParNJAmAId7wIYbN4wBsNtSRrwsDVxyI9vfimgO7ghwDJ7VpZIGGB8KD3TxBdLZMwzme6iparQzsPAsFMrUVJ5bgoKaxCGixfEb8eQxB6zh2bAIFAsjF5cxeEB20ExmuWywYAjf2Z9MCibq2iuRe2lnxrUjYNrgWDHM1JgCm3he2OAQfnMWn2l0qiVZTBx9uTLGbAg3I9DUlWjV0WAxjhU8xAIMPgurM/SsE3STlpcAkwdcADuJMsXEgiYFQydEGjV8Hz8kZflYh0Y6VQSNb7uptGRE0THmwSC8m7ZvmuVDsKN4dJE9uslOyKq8WFuSlTBPc7Tm4mDDJXQLB9Y213E5S+7NOogR0PYO8r7EAjRqSt9rabDpwRE20tQdDnKXCpIVXEKT+lrurFgQrDh9SZSVOCK4VtWucreioqTwHL2Ae7jYfhEXS+hZFuWOUuMJh2Qu4g4abZ0slZW1+1RZoyM2IOm37q8MeKwfkJUQ8pgH1FX/TBXvKCl0ZXJY5qRzrKnLYmoNKXHEgGFPQLi2MuzPWFvqr8tFeLaLqvSsiA/lsUbymbARcoA6T/oBYI2Fk4KYk0BN4Fe0ycnhwbLgw7JbUja4NqUfsBTYdAJ1zde4VoV2T3xIr8BKdMLHf4DML+ELgv3veBaWW1JdFXXgFPE9b4kxzw7q7bAJ9rT1WERjvt1anmdNh0SEB3h2RYWkAWiCNqh0i4KMLD6zMRf+6YF/DCFOdFePJY/jleEyWmiDTTRJA5wyoicvj85zg7/ODzdd40KoLAAAAABJRU5ErkJggg==";function Fb({score:e}){return q.jsxs("section",{className:"flex items-center justify-center gap-3 pb-2 pt-3",children:[q.jsx("div",{className:"score-icon",children:q.jsx(mn,{src:Sv})}),q.jsx("span",{className:"text-5xl font-bold",children:e.toLocaleString()})]})}const Bb=({number:e,x:s,y:n,onAnimationEnd:o})=>{const l=Y.useRef(null),[c,f]=Y.useState({x:s,y:n});return Y.useLayoutEffect(()=>{if(l.current){const g=s-l.current.clientWidth/2,_=n-l.current.clientHeight/2;f({x:g,y:_})}},[s,n]),Y.useEffect(()=>{const g=setTimeout(()=>{o()},1e3);return()=>clearTimeout(g)},[o]),q.jsxs("div",{ref:l,className:"floating-number",style:{left:`${c.x}px`,top:`${c.y}px`},children:["+",e]})};function Mb({size:e=1,className:s=""}){return q.jsx("span",{className:`absolute top-[-3px] right-[-3px] bg-red-500 
                 rounded-full p-${e} ${s}`})}function vc({addClass:e,caption:s,onClick:n,disabled:o,children:l}){return q.jsxs("div",{className:`captioned-button ${e??""}`,children:[q.jsxs(Ed,{className:"button group",onClick:n,disabled:o,children:[l,q.jsx(Mb,{className:"group-disabled:hidden"})]}),q.jsx("div",{className:"text",children:s})]})}const Lb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAcCAYAAABlL09dAAAABHNCSVQICAgIfAhkiAAAAiBJREFUSEullU1OAkEQhatA3MoNHJfGKLgzOkQ8gXgC9QTqCdQTiCcQTyCeQAho3OFgjEvxBOJWA2X1AP033STOzGpoqr9+XfWqBiHjQ1FlCAhLEkPwjaVOEbNwqV+p8f47i3GMG51GVnCToftKLX1iqRuI3wkwvW8F8FtYdt2ElbRn69O4DyvugGPEYQ5wP2zx8m4STG3c6FYlONo5BcxdqTjzf0OxR8Vkb+F3BVefBwocDgBR3QxpD9e7LGrymOAovODgc0cabvmKRxL6tl2GUb6ncgtDyFFdQte7lzbYVCEi2T4wzge42RpKcL/S4PdDhwCxdM8iahJMr2EVCB8SwUSXXOkLfT3hXXmiEqHALhUOtfbBFBm5Nl1BvWoRcqMPznjR2hib3XNlIDPXRh1ixdxBojA3BoCU2b3g2S05FsYLZb0OU7DDuwRcSBooKH6LojhzbVlNxOBc7xqU8RmWHqWl5C2Jrrm4p/atkJPv864eG1vIOKdfaQJR2U7BLAbjk4kCuQmxzO/aYHH4eDJPuNhmt+kHJ4eQUKKDAaSFpF3FnAAs2v72gmPb5UdfWkAiBVMXNe3UJHJsVlmbWJ7miA9f/Alw7enFZ8PYFWZBQg7G0nQtkYJ5IK9iq4ucKUgHjsI6j8wT1zT7D1DaTVVafm0zpcAAy6+tp4tSK2bw3C5KBZbendNF6cCTLgpcgyQNUJ8VTf4wHumzNAtwtvcPuoUeLFmI7gkAAAAASUVORK5CYII=";function Ob({energy:e,limit:s}){return q.jsxs("section",{className:"flex w-auto items-center justify-center gap-1",children:[q.jsx(mn,{src:Lb}),q.jsxs("span",{children:[e>=0?e:0," / ",s]})]})}function Nb({token:e}){const s=n=>n>=1e9?`+${(n/1e9).toFixed(2)}K`:n>=1e6?`+${(n/1e6).toFixed(2)}K`:n>=1e3?`+${(n/1e3).toFixed(2)}K`:`+${n}`;return q.jsxs("div",{className:"flex flex-col items-end justify-between",children:[q.jsx("div",{className:"label",children:"Token Per Hour"}),q.jsxs("div",{className:"flex flex-row items-center justify-end gap-2",children:[q.jsx(mn,{src:Sv,className:"h-6"}),q.jsx("span",{className:"text-3xl",children:s(e)})]})]})}function Ev(e,s){return function(){return e.apply(s,arguments)}}const{toString:Ub}=Object.prototype,{getPrototypeOf:Td}=Object,Fl=(e=>s=>{const n=Ub.call(s);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ai=e=>(e=e.toLowerCase(),s=>Fl(s)===e),Bl=e=>s=>typeof s===e,{isArray:ur}=Array,bo=Bl("undefined");function zb(e){return e!==null&&!bo(e)&&e.constructor!==null&&!bo(e.constructor)&&ii(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Av=Ai("ArrayBuffer");function Hb(e){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(e):s=e&&e.buffer&&Av(e.buffer),s}const jb=Bl("string"),ii=Bl("function"),Tv=Bl("number"),Ml=e=>e!==null&&typeof e=="object",Wb=e=>e===!0||e===!1,Ua=e=>{if(Fl(e)!=="object")return!1;const s=Td(e);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Vb=Ai("Date"),Gb=Ai("File"),Xb=Ai("Blob"),$b=Ai("FileList"),Yb=e=>Ml(e)&&ii(e.pipe),Qb=e=>{let s;return e&&(typeof FormData=="function"&&e instanceof FormData||ii(e.append)&&((s=Fl(e))==="formdata"||s==="object"&&ii(e.toString)&&e.toString()==="[object FormData]"))},qb=Ai("URLSearchParams"),[Zb,Kb,Jb,tC]=["ReadableStream","Request","Response","Headers"].map(Ai),eC=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Do(e,s,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let o,l;if(typeof e!="object"&&(e=[e]),ur(e))for(o=0,l=e.length;o<l;o++)s.call(null,e[o],o,e);else{const c=n?Object.getOwnPropertyNames(e):Object.keys(e),f=c.length;let g;for(o=0;o<f;o++)g=c[o],s.call(null,e[g],g,e)}}function Pv(e,s){s=s.toLowerCase();const n=Object.keys(e);let o=n.length,l;for(;o-- >0;)if(l=n[o],s===l.toLowerCase())return l;return null}const sn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Rv=e=>!bo(e)&&e!==sn;function wu(){const{caseless:e}=Rv(this)&&this||{},s={},n=(o,l)=>{const c=e&&Pv(s,l)||l;Ua(s[c])&&Ua(o)?s[c]=wu(s[c],o):Ua(o)?s[c]=wu({},o):ur(o)?s[c]=o.slice():s[c]=o};for(let o=0,l=arguments.length;o<l;o++)arguments[o]&&Do(arguments[o],n);return s}const iC=(e,s,n,{allOwnKeys:o}={})=>(Do(s,(l,c)=>{n&&ii(l)?e[c]=Ev(l,n):e[c]=l},{allOwnKeys:o}),e),sC=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),nC=(e,s,n,o)=>{e.prototype=Object.create(s.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:s.prototype}),n&&Object.assign(e.prototype,n)},rC=(e,s,n,o)=>{let l,c,f;const g={};if(s=s||{},e==null)return s;do{for(l=Object.getOwnPropertyNames(e),c=l.length;c-- >0;)f=l[c],(!o||o(f,e,s))&&!g[f]&&(s[f]=e[f],g[f]=!0);e=n!==!1&&Td(e)}while(e&&(!n||n(e,s))&&e!==Object.prototype);return s},oC=(e,s,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=s.length;const o=e.indexOf(s,n);return o!==-1&&o===n},aC=e=>{if(!e)return null;if(ur(e))return e;let s=e.length;if(!Tv(s))return null;const n=new Array(s);for(;s-- >0;)n[s]=e[s];return n},lC=(e=>s=>e&&s instanceof e)(typeof Uint8Array<"u"&&Td(Uint8Array)),hC=(e,s)=>{const o=(e&&e[Symbol.iterator]).call(e);let l;for(;(l=o.next())&&!l.done;){const c=l.value;s.call(e,c[0],c[1])}},cC=(e,s)=>{let n;const o=[];for(;(n=e.exec(s))!==null;)o.push(n);return o},uC=Ai("HTMLFormElement"),dC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,o,l){return o.toUpperCase()+l}),bg=(({hasOwnProperty:e})=>(s,n)=>e.call(s,n))(Object.prototype),fC=Ai("RegExp"),Iv=(e,s)=>{const n=Object.getOwnPropertyDescriptors(e),o={};Do(n,(l,c)=>{let f;(f=s(l,c,e))!==!1&&(o[c]=f||l)}),Object.defineProperties(e,o)},pC=e=>{Iv(e,(s,n)=>{if(ii(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const o=e[n];if(ii(o)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},gC=(e,s)=>{const n={},o=l=>{l.forEach(c=>{n[c]=!0})};return ur(e)?o(e):o(String(e).split(s)),n},mC=()=>{},_C=(e,s)=>e!=null&&Number.isFinite(e=+e)?e:s,yc="abcdefghijklmnopqrstuvwxyz",Cg="0123456789",Dv={DIGIT:Cg,ALPHA:yc,ALPHA_DIGIT:yc+yc.toUpperCase()+Cg},vC=(e=16,s=Dv.ALPHA_DIGIT)=>{let n="";const{length:o}=s;for(;e--;)n+=s[Math.random()*o|0];return n};function yC(e){return!!(e&&ii(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const wC=e=>{const s=new Array(10),n=(o,l)=>{if(Ml(o)){if(s.indexOf(o)>=0)return;if(!("toJSON"in o)){s[l]=o;const c=ur(o)?[]:{};return Do(o,(f,g)=>{const _=n(f,l+1);!bo(_)&&(c[g]=_)}),s[l]=void 0,c}}return o};return n(e,0)},xC=Ai("AsyncFunction"),bC=e=>e&&(Ml(e)||ii(e))&&ii(e.then)&&ii(e.catch),kv=((e,s)=>e?setImmediate:s?((n,o)=>(sn.addEventListener("message",({source:l,data:c})=>{l===sn&&c===n&&o.length&&o.shift()()},!1),l=>{o.push(l),sn.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",ii(sn.postMessage)),CC=typeof queueMicrotask<"u"?queueMicrotask.bind(sn):typeof process<"u"&&process.nextTick||kv,V={isArray:ur,isArrayBuffer:Av,isBuffer:zb,isFormData:Qb,isArrayBufferView:Hb,isString:jb,isNumber:Tv,isBoolean:Wb,isObject:Ml,isPlainObject:Ua,isReadableStream:Zb,isRequest:Kb,isResponse:Jb,isHeaders:tC,isUndefined:bo,isDate:Vb,isFile:Gb,isBlob:Xb,isRegExp:fC,isFunction:ii,isStream:Yb,isURLSearchParams:qb,isTypedArray:lC,isFileList:$b,forEach:Do,merge:wu,extend:iC,trim:eC,stripBOM:sC,inherits:nC,toFlatObject:rC,kindOf:Fl,kindOfTest:Ai,endsWith:oC,toArray:aC,forEachEntry:hC,matchAll:cC,isHTMLForm:uC,hasOwnProperty:bg,hasOwnProp:bg,reduceDescriptors:Iv,freezeMethods:pC,toObjectSet:gC,toCamelCase:dC,noop:mC,toFiniteNumber:_C,findKey:Pv,global:sn,isContextDefined:Rv,ALPHABET:Dv,generateString:vC,isSpecCompliantForm:yC,toJSONObject:wC,isAsyncFn:xC,isThenable:bC,setImmediate:kv,asap:CC};function ft(e,s,n,o,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",s&&(this.code=s),n&&(this.config=n),o&&(this.request=o),l&&(this.response=l,this.status=l.status?l.status:null)}V.inherits(ft,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:V.toJSONObject(this.config),code:this.code,status:this.status}}});const Fv=ft.prototype,Bv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Bv[e]={value:e}});Object.defineProperties(ft,Bv);Object.defineProperty(Fv,"isAxiosError",{value:!0});ft.from=(e,s,n,o,l,c)=>{const f=Object.create(Fv);return V.toFlatObject(e,f,function(_){return _!==Error.prototype},g=>g!=="isAxiosError"),ft.call(f,e.message,s,n,o,l),f.cause=e,f.name=e.name,c&&Object.assign(f,c),f};const SC=null;function xu(e){return V.isPlainObject(e)||V.isArray(e)}function Mv(e){return V.endsWith(e,"[]")?e.slice(0,-2):e}function Sg(e,s,n){return e?e.concat(s).map(function(l,c){return l=Mv(l),!n&&c?"["+l+"]":l}).join(n?".":""):s}function EC(e){return V.isArray(e)&&!e.some(xu)}const AC=V.toFlatObject(V,{},null,function(s){return/^is[A-Z]/.test(s)});function Ll(e,s,n){if(!V.isObject(e))throw new TypeError("target must be an object");s=s||new FormData,n=V.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(O,L){return!V.isUndefined(L[O])});const o=n.metaTokens,l=n.visitor||x,c=n.dots,f=n.indexes,_=(n.Blob||typeof Blob<"u"&&Blob)&&V.isSpecCompliantForm(s);if(!V.isFunction(l))throw new TypeError("visitor must be a function");function v(F){if(F===null)return"";if(V.isDate(F))return F.toISOString();if(!_&&V.isBlob(F))throw new ft("Blob is not supported. Use a Buffer instead.");return V.isArrayBuffer(F)||V.isTypedArray(F)?_&&typeof Blob=="function"?new Blob([F]):Buffer.from(F):F}function x(F,O,L){let P=F;if(F&&!L&&typeof F=="object"){if(V.endsWith(O,"{}"))O=o?O:O.slice(0,-2),F=JSON.stringify(F);else if(V.isArray(F)&&EC(F)||(V.isFileList(F)||V.endsWith(O,"[]"))&&(P=V.toArray(F)))return O=Mv(O),P.forEach(function(I,H){!(V.isUndefined(I)||I===null)&&s.append(f===!0?Sg([O],H,c):f===null?O:O+"[]",v(I))}),!1}return xu(F)?!0:(s.append(Sg(L,O,c),v(F)),!1)}const S=[],T=Object.assign(AC,{defaultVisitor:x,convertValue:v,isVisitable:xu});function D(F,O){if(!V.isUndefined(F)){if(S.indexOf(F)!==-1)throw Error("Circular reference detected in "+O.join("."));S.push(F),V.forEach(F,function(P,A){(!(V.isUndefined(P)||P===null)&&l.call(s,P,V.isString(A)?A.trim():A,O,T))===!0&&D(P,O?O.concat(A):[A])}),S.pop()}}if(!V.isObject(e))throw new TypeError("data must be an object");return D(e),s}function Eg(e){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(o){return s[o]})}function Pd(e,s){this._pairs=[],e&&Ll(e,this,s)}const Lv=Pd.prototype;Lv.append=function(s,n){this._pairs.push([s,n])};Lv.toString=function(s){const n=s?function(o){return s.call(this,o,Eg)}:Eg;return this._pairs.map(function(l){return n(l[0])+"="+n(l[1])},"").join("&")};function TC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ov(e,s,n){if(!s)return e;const o=n&&n.encode||TC,l=n&&n.serialize;let c;if(l?c=l(s,n):c=V.isURLSearchParams(s)?s.toString():new Pd(s,n).toString(o),c){const f=e.indexOf("#");f!==-1&&(e=e.slice(0,f)),e+=(e.indexOf("?")===-1?"?":"&")+c}return e}class Ag{constructor(){this.handlers=[]}use(s,n,o){return this.handlers.push({fulfilled:s,rejected:n,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){V.forEach(this.handlers,function(o){o!==null&&s(o)})}}const Nv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},PC=typeof URLSearchParams<"u"?URLSearchParams:Pd,RC=typeof FormData<"u"?FormData:null,IC=typeof Blob<"u"?Blob:null,DC={isBrowser:!0,classes:{URLSearchParams:PC,FormData:RC,Blob:IC},protocols:["http","https","file","blob","url","data"]},Rd=typeof window<"u"&&typeof document<"u",bu=typeof navigator=="object"&&navigator||void 0,kC=Rd&&(!bu||["ReactNative","NativeScript","NS"].indexOf(bu.product)<0),FC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",BC=Rd&&window.location.href||"http://localhost",MC=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Rd,hasStandardBrowserEnv:kC,hasStandardBrowserWebWorkerEnv:FC,navigator:bu,origin:BC},Symbol.toStringTag,{value:"Module"})),si={...MC,...DC};function LC(e,s){return Ll(e,new si.classes.URLSearchParams,Object.assign({visitor:function(n,o,l,c){return si.isNode&&V.isBuffer(n)?(this.append(o,n.toString("base64")),!1):c.defaultVisitor.apply(this,arguments)}},s))}function OC(e){return V.matchAll(/\w+|\[(\w*)]/g,e).map(s=>s[0]==="[]"?"":s[1]||s[0])}function NC(e){const s={},n=Object.keys(e);let o;const l=n.length;let c;for(o=0;o<l;o++)c=n[o],s[c]=e[c];return s}function Uv(e){function s(n,o,l,c){let f=n[c++];if(f==="__proto__")return!0;const g=Number.isFinite(+f),_=c>=n.length;return f=!f&&V.isArray(l)?l.length:f,_?(V.hasOwnProp(l,f)?l[f]=[l[f],o]:l[f]=o,!g):((!l[f]||!V.isObject(l[f]))&&(l[f]=[]),s(n,o,l[f],c)&&V.isArray(l[f])&&(l[f]=NC(l[f])),!g)}if(V.isFormData(e)&&V.isFunction(e.entries)){const n={};return V.forEachEntry(e,(o,l)=>{s(OC(o),l,n,0)}),n}return null}function UC(e,s,n){if(V.isString(e))try{return(s||JSON.parse)(e),V.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(n||JSON.stringify)(e)}const ko={transitional:Nv,adapter:["xhr","http","fetch"],transformRequest:[function(s,n){const o=n.getContentType()||"",l=o.indexOf("application/json")>-1,c=V.isObject(s);if(c&&V.isHTMLForm(s)&&(s=new FormData(s)),V.isFormData(s))return l?JSON.stringify(Uv(s)):s;if(V.isArrayBuffer(s)||V.isBuffer(s)||V.isStream(s)||V.isFile(s)||V.isBlob(s)||V.isReadableStream(s))return s;if(V.isArrayBufferView(s))return s.buffer;if(V.isURLSearchParams(s))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let g;if(c){if(o.indexOf("application/x-www-form-urlencoded")>-1)return LC(s,this.formSerializer).toString();if((g=V.isFileList(s))||o.indexOf("multipart/form-data")>-1){const _=this.env&&this.env.FormData;return Ll(g?{"files[]":s}:s,_&&new _,this.formSerializer)}}return c||l?(n.setContentType("application/json",!1),UC(s)):s}],transformResponse:[function(s){const n=this.transitional||ko.transitional,o=n&&n.forcedJSONParsing,l=this.responseType==="json";if(V.isResponse(s)||V.isReadableStream(s))return s;if(s&&V.isString(s)&&(o&&!this.responseType||l)){const f=!(n&&n.silentJSONParsing)&&l;try{return JSON.parse(s)}catch(g){if(f)throw g.name==="SyntaxError"?ft.from(g,ft.ERR_BAD_RESPONSE,this,null,this.response):g}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:si.classes.FormData,Blob:si.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};V.forEach(["delete","get","head","post","put","patch"],e=>{ko.headers[e]={}});const zC=V.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),HC=e=>{const s={};let n,o,l;return e&&e.split(`
`).forEach(function(f){l=f.indexOf(":"),n=f.substring(0,l).trim().toLowerCase(),o=f.substring(l+1).trim(),!(!n||s[n]&&zC[n])&&(n==="set-cookie"?s[n]?s[n].push(o):s[n]=[o]:s[n]=s[n]?s[n]+", "+o:o)}),s},Tg=Symbol("internals");function Vr(e){return e&&String(e).trim().toLowerCase()}function za(e){return e===!1||e==null?e:V.isArray(e)?e.map(za):String(e)}function jC(e){const s=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(e);)s[o[1]]=o[2];return s}const WC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function wc(e,s,n,o,l){if(V.isFunction(o))return o.call(this,s,n);if(l&&(s=n),!!V.isString(s)){if(V.isString(o))return s.indexOf(o)!==-1;if(V.isRegExp(o))return o.test(s)}}function VC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,n,o)=>n.toUpperCase()+o)}function GC(e,s){const n=V.toCamelCase(" "+s);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+n,{value:function(l,c,f){return this[o].call(this,s,l,c,f)},configurable:!0})})}class $e{constructor(s){s&&this.set(s)}set(s,n,o){const l=this;function c(g,_,v){const x=Vr(_);if(!x)throw new Error("header name must be a non-empty string");const S=V.findKey(l,x);(!S||l[S]===void 0||v===!0||v===void 0&&l[S]!==!1)&&(l[S||_]=za(g))}const f=(g,_)=>V.forEach(g,(v,x)=>c(v,x,_));if(V.isPlainObject(s)||s instanceof this.constructor)f(s,n);else if(V.isString(s)&&(s=s.trim())&&!WC(s))f(HC(s),n);else if(V.isHeaders(s))for(const[g,_]of s.entries())c(_,g,o);else s!=null&&c(n,s,o);return this}get(s,n){if(s=Vr(s),s){const o=V.findKey(this,s);if(o){const l=this[o];if(!n)return l;if(n===!0)return jC(l);if(V.isFunction(n))return n.call(this,l,o);if(V.isRegExp(n))return n.exec(l);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,n){if(s=Vr(s),s){const o=V.findKey(this,s);return!!(o&&this[o]!==void 0&&(!n||wc(this,this[o],o,n)))}return!1}delete(s,n){const o=this;let l=!1;function c(f){if(f=Vr(f),f){const g=V.findKey(o,f);g&&(!n||wc(o,o[g],g,n))&&(delete o[g],l=!0)}}return V.isArray(s)?s.forEach(c):c(s),l}clear(s){const n=Object.keys(this);let o=n.length,l=!1;for(;o--;){const c=n[o];(!s||wc(this,this[c],c,s,!0))&&(delete this[c],l=!0)}return l}normalize(s){const n=this,o={};return V.forEach(this,(l,c)=>{const f=V.findKey(o,c);if(f){n[f]=za(l),delete n[c];return}const g=s?VC(c):String(c).trim();g!==c&&delete n[c],n[g]=za(l),o[g]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const n=Object.create(null);return V.forEach(this,(o,l)=>{o!=null&&o!==!1&&(n[l]=s&&V.isArray(o)?o.join(", "):o)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,n])=>s+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...n){const o=new this(s);return n.forEach(l=>o.set(l)),o}static accessor(s){const o=(this[Tg]=this[Tg]={accessors:{}}).accessors,l=this.prototype;function c(f){const g=Vr(f);o[g]||(GC(l,f),o[g]=!0)}return V.isArray(s)?s.forEach(c):c(s),this}}$e.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);V.reduceDescriptors($e.prototype,({value:e},s)=>{let n=s[0].toUpperCase()+s.slice(1);return{get:()=>e,set(o){this[n]=o}}});V.freezeMethods($e);function xc(e,s){const n=this||ko,o=s||n,l=$e.from(o.headers);let c=o.data;return V.forEach(e,function(g){c=g.call(n,c,l.normalize(),s?s.status:void 0)}),l.normalize(),c}function zv(e){return!!(e&&e.__CANCEL__)}function dr(e,s,n){ft.call(this,e??"canceled",ft.ERR_CANCELED,s,n),this.name="CanceledError"}V.inherits(dr,ft,{__CANCEL__:!0});function Hv(e,s,n){const o=n.config.validateStatus;!n.status||!o||o(n.status)?e(n):s(new ft("Request failed with status code "+n.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function XC(e){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return s&&s[1]||""}function $C(e,s){e=e||10;const n=new Array(e),o=new Array(e);let l=0,c=0,f;return s=s!==void 0?s:1e3,function(_){const v=Date.now(),x=o[c];f||(f=v),n[l]=_,o[l]=v;let S=c,T=0;for(;S!==l;)T+=n[S++],S=S%e;if(l=(l+1)%e,l===c&&(c=(c+1)%e),v-f<s)return;const D=x&&v-x;return D?Math.round(T*1e3/D):void 0}}function YC(e,s){let n=0,o=1e3/s,l,c;const f=(v,x=Date.now())=>{n=x,l=null,c&&(clearTimeout(c),c=null),e.apply(null,v)};return[(...v)=>{const x=Date.now(),S=x-n;S>=o?f(v,x):(l=v,c||(c=setTimeout(()=>{c=null,f(l)},o-S)))},()=>l&&f(l)]}const dl=(e,s,n=3)=>{let o=0;const l=$C(50,250);return YC(c=>{const f=c.loaded,g=c.lengthComputable?c.total:void 0,_=f-o,v=l(_),x=f<=g;o=f;const S={loaded:f,total:g,progress:g?f/g:void 0,bytes:_,rate:v||void 0,estimated:v&&g&&x?(g-f)/v:void 0,event:c,lengthComputable:g!=null,[s?"download":"upload"]:!0};e(S)},n)},Pg=(e,s)=>{const n=e!=null;return[o=>s[0]({lengthComputable:n,total:e,loaded:o}),s[1]]},Rg=e=>(...s)=>V.asap(()=>e(...s)),QC=si.hasStandardBrowserEnv?function(){const s=si.navigator&&/(msie|trident)/i.test(si.navigator.userAgent),n=document.createElement("a");let o;function l(c){let f=c;return s&&(n.setAttribute("href",f),f=n.href),n.setAttribute("href",f),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return o=l(window.location.href),function(f){const g=V.isString(f)?l(f):f;return g.protocol===o.protocol&&g.host===o.host}}():function(){return function(){return!0}}(),qC=si.hasStandardBrowserEnv?{write(e,s,n,o,l,c){const f=[e+"="+encodeURIComponent(s)];V.isNumber(n)&&f.push("expires="+new Date(n).toGMTString()),V.isString(o)&&f.push("path="+o),V.isString(l)&&f.push("domain="+l),c===!0&&f.push("secure"),document.cookie=f.join("; ")},read(e){const s=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ZC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function KC(e,s){return s?e.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):e}function jv(e,s){return e&&!ZC(s)?KC(e,s):s}const Ig=e=>e instanceof $e?{...e}:e;function fn(e,s){s=s||{};const n={};function o(v,x,S){return V.isPlainObject(v)&&V.isPlainObject(x)?V.merge.call({caseless:S},v,x):V.isPlainObject(x)?V.merge({},x):V.isArray(x)?x.slice():x}function l(v,x,S){if(V.isUndefined(x)){if(!V.isUndefined(v))return o(void 0,v,S)}else return o(v,x,S)}function c(v,x){if(!V.isUndefined(x))return o(void 0,x)}function f(v,x){if(V.isUndefined(x)){if(!V.isUndefined(v))return o(void 0,v)}else return o(void 0,x)}function g(v,x,S){if(S in s)return o(v,x);if(S in e)return o(void 0,v)}const _={url:c,method:c,data:c,baseURL:f,transformRequest:f,transformResponse:f,paramsSerializer:f,timeout:f,timeoutMessage:f,withCredentials:f,withXSRFToken:f,adapter:f,responseType:f,xsrfCookieName:f,xsrfHeaderName:f,onUploadProgress:f,onDownloadProgress:f,decompress:f,maxContentLength:f,maxBodyLength:f,beforeRedirect:f,transport:f,httpAgent:f,httpsAgent:f,cancelToken:f,socketPath:f,responseEncoding:f,validateStatus:g,headers:(v,x)=>l(Ig(v),Ig(x),!0)};return V.forEach(Object.keys(Object.assign({},e,s)),function(x){const S=_[x]||l,T=S(e[x],s[x],x);V.isUndefined(T)&&S!==g||(n[x]=T)}),n}const Wv=e=>{const s=fn({},e);let{data:n,withXSRFToken:o,xsrfHeaderName:l,xsrfCookieName:c,headers:f,auth:g}=s;s.headers=f=$e.from(f),s.url=Ov(jv(s.baseURL,s.url),e.params,e.paramsSerializer),g&&f.set("Authorization","Basic "+btoa((g.username||"")+":"+(g.password?unescape(encodeURIComponent(g.password)):"")));let _;if(V.isFormData(n)){if(si.hasStandardBrowserEnv||si.hasStandardBrowserWebWorkerEnv)f.setContentType(void 0);else if((_=f.getContentType())!==!1){const[v,...x]=_?_.split(";").map(S=>S.trim()).filter(Boolean):[];f.setContentType([v||"multipart/form-data",...x].join("; "))}}if(si.hasStandardBrowserEnv&&(o&&V.isFunction(o)&&(o=o(s)),o||o!==!1&&QC(s.url))){const v=l&&c&&qC.read(c);v&&f.set(l,v)}return s},JC=typeof XMLHttpRequest<"u",t1=JC&&function(e){return new Promise(function(n,o){const l=Wv(e);let c=l.data;const f=$e.from(l.headers).normalize();let{responseType:g,onUploadProgress:_,onDownloadProgress:v}=l,x,S,T,D,F;function O(){D&&D(),F&&F(),l.cancelToken&&l.cancelToken.unsubscribe(x),l.signal&&l.signal.removeEventListener("abort",x)}let L=new XMLHttpRequest;L.open(l.method.toUpperCase(),l.url,!0),L.timeout=l.timeout;function P(){if(!L)return;const I=$e.from("getAllResponseHeaders"in L&&L.getAllResponseHeaders()),j={data:!g||g==="text"||g==="json"?L.responseText:L.response,status:L.status,statusText:L.statusText,headers:I,config:e,request:L};Hv(function(E){n(E),O()},function(E){o(E),O()},j),L=null}"onloadend"in L?L.onloadend=P:L.onreadystatechange=function(){!L||L.readyState!==4||L.status===0&&!(L.responseURL&&L.responseURL.indexOf("file:")===0)||setTimeout(P)},L.onabort=function(){L&&(o(new ft("Request aborted",ft.ECONNABORTED,e,L)),L=null)},L.onerror=function(){o(new ft("Network Error",ft.ERR_NETWORK,e,L)),L=null},L.ontimeout=function(){let H=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded";const j=l.transitional||Nv;l.timeoutErrorMessage&&(H=l.timeoutErrorMessage),o(new ft(H,j.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,e,L)),L=null},c===void 0&&f.setContentType(null),"setRequestHeader"in L&&V.forEach(f.toJSON(),function(H,j){L.setRequestHeader(j,H)}),V.isUndefined(l.withCredentials)||(L.withCredentials=!!l.withCredentials),g&&g!=="json"&&(L.responseType=l.responseType),v&&([T,F]=dl(v,!0),L.addEventListener("progress",T)),_&&L.upload&&([S,D]=dl(_),L.upload.addEventListener("progress",S),L.upload.addEventListener("loadend",D)),(l.cancelToken||l.signal)&&(x=I=>{L&&(o(!I||I.type?new dr(null,e,L):I),L.abort(),L=null)},l.cancelToken&&l.cancelToken.subscribe(x),l.signal&&(l.signal.aborted?x():l.signal.addEventListener("abort",x)));const A=XC(l.url);if(A&&si.protocols.indexOf(A)===-1){o(new ft("Unsupported protocol "+A+":",ft.ERR_BAD_REQUEST,e));return}L.send(c||null)})},e1=(e,s)=>{let n=new AbortController,o;const l=function(_){if(!o){o=!0,f();const v=_ instanceof Error?_:this.reason;n.abort(v instanceof ft?v:new dr(v instanceof Error?v.message:v))}};let c=s&&setTimeout(()=>{l(new ft(`timeout ${s} of ms exceeded`,ft.ETIMEDOUT))},s);const f=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(_=>{_&&(_.removeEventListener?_.removeEventListener("abort",l):_.unsubscribe(l))}),e=null)};e.forEach(_=>_&&_.addEventListener&&_.addEventListener("abort",l));const{signal:g}=n;return g.unsubscribe=f,[g,()=>{c&&clearTimeout(c),c=null}]},i1=function*(e,s){let n=e.byteLength;if(!s||n<s){yield e;return}let o=0,l;for(;o<n;)l=o+s,yield e.slice(o,l),o=l},s1=async function*(e,s,n){for await(const o of e)yield*i1(ArrayBuffer.isView(o)?o:await n(String(o)),s)},Dg=(e,s,n,o,l)=>{const c=s1(e,s,l);let f=0,g,_=v=>{g||(g=!0,o&&o(v))};return new ReadableStream({async pull(v){try{const{done:x,value:S}=await c.next();if(x){_(),v.close();return}let T=S.byteLength;if(n){let D=f+=T;n(D)}v.enqueue(new Uint8Array(S))}catch(x){throw _(x),x}},cancel(v){return _(v),c.return()}},{highWaterMark:2})},Ol=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Vv=Ol&&typeof ReadableStream=="function",Cu=Ol&&(typeof TextEncoder=="function"?(e=>s=>e.encode(s))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Gv=(e,...s)=>{try{return!!e(...s)}catch{return!1}},n1=Vv&&Gv(()=>{let e=!1;const s=new Request(si.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!s}),kg=64*1024,Su=Vv&&Gv(()=>V.isReadableStream(new Response("").body)),fl={stream:Su&&(e=>e.body)};Ol&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(s=>{!fl[s]&&(fl[s]=V.isFunction(e[s])?n=>n[s]():(n,o)=>{throw new ft(`Response type '${s}' is not supported`,ft.ERR_NOT_SUPPORT,o)})})})(new Response);const r1=async e=>{if(e==null)return 0;if(V.isBlob(e))return e.size;if(V.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(V.isArrayBufferView(e)||V.isArrayBuffer(e))return e.byteLength;if(V.isURLSearchParams(e)&&(e=e+""),V.isString(e))return(await Cu(e)).byteLength},o1=async(e,s)=>{const n=V.toFiniteNumber(e.getContentLength());return n??r1(s)},a1=Ol&&(async e=>{let{url:s,method:n,data:o,signal:l,cancelToken:c,timeout:f,onDownloadProgress:g,onUploadProgress:_,responseType:v,headers:x,withCredentials:S="same-origin",fetchOptions:T}=Wv(e);v=v?(v+"").toLowerCase():"text";let[D,F]=l||c||f?e1([l,c],f):[],O,L;const P=()=>{!O&&setTimeout(()=>{D&&D.unsubscribe()}),O=!0};let A;try{if(_&&n1&&n!=="get"&&n!=="head"&&(A=await o1(x,o))!==0){let E=new Request(s,{method:"POST",body:o,duplex:"half"}),B;if(V.isFormData(o)&&(B=E.headers.get("content-type"))&&x.setContentType(B),E.body){const[G,nt]=Pg(A,dl(Rg(_)));o=Dg(E.body,kg,G,nt,Cu)}}V.isString(S)||(S=S?"include":"omit");const I="credentials"in Request.prototype;L=new Request(s,{...T,signal:D,method:n.toUpperCase(),headers:x.normalize().toJSON(),body:o,duplex:"half",credentials:I?S:void 0});let H=await fetch(L);const j=Su&&(v==="stream"||v==="response");if(Su&&(g||j)){const E={};["status","statusText","headers"].forEach(at=>{E[at]=H[at]});const B=V.toFiniteNumber(H.headers.get("content-length")),[G,nt]=g&&Pg(B,dl(Rg(g),!0))||[];H=new Response(Dg(H.body,kg,G,()=>{nt&&nt(),j&&P()},Cu),E)}v=v||"text";let Z=await fl[V.findKey(fl,v)||"text"](H,e);return!j&&P(),F&&F(),await new Promise((E,B)=>{Hv(E,B,{data:Z,headers:$e.from(H.headers),status:H.status,statusText:H.statusText,config:e,request:L})})}catch(I){throw P(),I&&I.name==="TypeError"&&/fetch/i.test(I.message)?Object.assign(new ft("Network Error",ft.ERR_NETWORK,e,L),{cause:I.cause||I}):ft.from(I,I&&I.code,e,L)}}),Eu={http:SC,xhr:t1,fetch:a1};V.forEach(Eu,(e,s)=>{if(e){try{Object.defineProperty(e,"name",{value:s})}catch{}Object.defineProperty(e,"adapterName",{value:s})}});const Fg=e=>`- ${e}`,l1=e=>V.isFunction(e)||e===null||e===!1,Xv={getAdapter:e=>{e=V.isArray(e)?e:[e];const{length:s}=e;let n,o;const l={};for(let c=0;c<s;c++){n=e[c];let f;if(o=n,!l1(n)&&(o=Eu[(f=String(n)).toLowerCase()],o===void 0))throw new ft(`Unknown adapter '${f}'`);if(o)break;l[f||"#"+c]=o}if(!o){const c=Object.entries(l).map(([g,_])=>`adapter ${g} `+(_===!1?"is not supported by the environment":"is not available in the build"));let f=s?c.length>1?`since :
`+c.map(Fg).join(`
`):" "+Fg(c[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+f,"ERR_NOT_SUPPORT")}return o},adapters:Eu};function bc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new dr(null,e)}function Bg(e){return bc(e),e.headers=$e.from(e.headers),e.data=xc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Xv.getAdapter(e.adapter||ko.adapter)(e).then(function(o){return bc(e),o.data=xc.call(e,e.transformResponse,o),o.headers=$e.from(o.headers),o},function(o){return zv(o)||(bc(e),o&&o.response&&(o.response.data=xc.call(e,e.transformResponse,o.response),o.response.headers=$e.from(o.response.headers))),Promise.reject(o)})}const $v="1.7.5",Id={};["object","boolean","number","function","string","symbol"].forEach((e,s)=>{Id[e]=function(o){return typeof o===e||"a"+(s<1?"n ":" ")+e}});const Mg={};Id.transitional=function(s,n,o){function l(c,f){return"[Axios v"+$v+"] Transitional option '"+c+"'"+f+(o?". "+o:"")}return(c,f,g)=>{if(s===!1)throw new ft(l(f," has been removed"+(n?" in "+n:"")),ft.ERR_DEPRECATED);return n&&!Mg[f]&&(Mg[f]=!0,console.warn(l(f," has been deprecated since v"+n+" and will be removed in the near future"))),s?s(c,f,g):!0}};function h1(e,s,n){if(typeof e!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let l=o.length;for(;l-- >0;){const c=o[l],f=s[c];if(f){const g=e[c],_=g===void 0||f(g,c,e);if(_!==!0)throw new ft("option "+c+" must be "+_,ft.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ft("Unknown option "+c,ft.ERR_BAD_OPTION)}}const Au={assertOptions:h1,validators:Id},us=Au.validators;class on{constructor(s){this.defaults=s,this.interceptors={request:new Ag,response:new Ag}}async request(s,n){try{return await this._request(s,n)}catch(o){if(o instanceof Error){let l;Error.captureStackTrace?Error.captureStackTrace(l={}):l=new Error;const c=l.stack?l.stack.replace(/^.+\n/,""):"";try{o.stack?c&&!String(o.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+c):o.stack=c}catch{}}throw o}}_request(s,n){typeof s=="string"?(n=n||{},n.url=s):n=s||{},n=fn(this.defaults,n);const{transitional:o,paramsSerializer:l,headers:c}=n;o!==void 0&&Au.assertOptions(o,{silentJSONParsing:us.transitional(us.boolean),forcedJSONParsing:us.transitional(us.boolean),clarifyTimeoutError:us.transitional(us.boolean)},!1),l!=null&&(V.isFunction(l)?n.paramsSerializer={serialize:l}:Au.assertOptions(l,{encode:us.function,serialize:us.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let f=c&&V.merge(c.common,c[n.method]);c&&V.forEach(["delete","get","head","post","put","patch","common"],F=>{delete c[F]}),n.headers=$e.concat(f,c);const g=[];let _=!0;this.interceptors.request.forEach(function(O){typeof O.runWhen=="function"&&O.runWhen(n)===!1||(_=_&&O.synchronous,g.unshift(O.fulfilled,O.rejected))});const v=[];this.interceptors.response.forEach(function(O){v.push(O.fulfilled,O.rejected)});let x,S=0,T;if(!_){const F=[Bg.bind(this),void 0];for(F.unshift.apply(F,g),F.push.apply(F,v),T=F.length,x=Promise.resolve(n);S<T;)x=x.then(F[S++],F[S++]);return x}T=g.length;let D=n;for(S=0;S<T;){const F=g[S++],O=g[S++];try{D=F(D)}catch(L){O.call(this,L);break}}try{x=Bg.call(this,D)}catch(F){return Promise.reject(F)}for(S=0,T=v.length;S<T;)x=x.then(v[S++],v[S++]);return x}getUri(s){s=fn(this.defaults,s);const n=jv(s.baseURL,s.url);return Ov(n,s.params,s.paramsSerializer)}}V.forEach(["delete","get","head","options"],function(s){on.prototype[s]=function(n,o){return this.request(fn(o||{},{method:s,url:n,data:(o||{}).data}))}});V.forEach(["post","put","patch"],function(s){function n(o){return function(c,f,g){return this.request(fn(g||{},{method:s,headers:o?{"Content-Type":"multipart/form-data"}:{},url:c,data:f}))}}on.prototype[s]=n(),on.prototype[s+"Form"]=n(!0)});class Dd{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(c){n=c});const o=this;this.promise.then(l=>{if(!o._listeners)return;let c=o._listeners.length;for(;c-- >0;)o._listeners[c](l);o._listeners=null}),this.promise.then=l=>{let c;const f=new Promise(g=>{o.subscribe(g),c=g}).then(l);return f.cancel=function(){o.unsubscribe(c)},f},s(function(c,f,g){o.reason||(o.reason=new dr(c,f,g),n(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const n=this._listeners.indexOf(s);n!==-1&&this._listeners.splice(n,1)}static source(){let s;return{token:new Dd(function(l){s=l}),cancel:s}}}function c1(e){return function(n){return e.apply(null,n)}}function u1(e){return V.isObject(e)&&e.isAxiosError===!0}const Tu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Tu).forEach(([e,s])=>{Tu[s]=e});function Yv(e){const s=new on(e),n=Ev(on.prototype.request,s);return V.extend(n,on.prototype,s,{allOwnKeys:!0}),V.extend(n,s,null,{allOwnKeys:!0}),n.create=function(l){return Yv(fn(e,l))},n}const Yt=Yv(ko);Yt.Axios=on;Yt.CanceledError=dr;Yt.CancelToken=Dd;Yt.isCancel=zv;Yt.VERSION=$v;Yt.toFormData=Ll;Yt.AxiosError=ft;Yt.Cancel=Yt.CanceledError;Yt.all=function(s){return Promise.all(s)};Yt.spread=c1;Yt.isAxiosError=u1;Yt.mergeConfig=fn;Yt.AxiosHeaders=$e;Yt.formToJSON=e=>Uv(V.isHTMLForm(e)?new FormData(e):e);Yt.getAdapter=Xv.getAdapter;Yt.HttpStatusCode=Tu;Yt.default=Yt;const Qv=Y.createContext(void 0),Co=()=>{const e=Y.useContext(Qv);if(!e)throw new Error("useSession must be used within a SessionProvider");return e},d1=({children:e})=>{const[s,n]=Y.useState({playFabId:null,userData:{},gameData:{}}),o=g=>{n(_=>({..._,playFabId:g}))},l=(g,_,v)=>{n(x=>{const S=typeof g=="object"?{...g}:{[g]:_},T={playFabId:x.playFabId,data:S};return(v??!0)&&f(T),{...x,userData:{...x.userData,...S}}})},c=(g,_)=>{n(v=>{const x=typeof g=="object"?{...g}:{[g]:_};return{...v,gameData:{...v.gameData,...x}}})},f=async g=>{try{const v=await Yt.put("https://4ca8-103-200-32-6.ngrok-free.app"+"/playFab/update/userData",g);console.log("Payload:",g),console.log("Data successfully sent to server:",v.data)}catch(_){console.error("Error sending data to the server:",_)}};return q.jsx(Qv.Provider,{value:{sessionData:s,setPlayFabId:o,setData:l,setGameData:c},children:e})};function f1({coins:e}){const{sessionData:s}=Co(),[n,o]=Y.useState(0),l=s.gameData.levelNames||[],c=s.gameData.levelThresholds||[],f=()=>{if(n>=l.length-1)return 100;const g=c[n],_=c[n+1],v=(e-g)/(_-g)*100;return Math.min(v,100)};return Y.useEffect(()=>{const g=c[n+1];e>=g&&n<l.length-1&&o(n+1)},[e,n,c,l.length]),q.jsxs("section",{className:"mt-1 flex flex-col justify-between",children:[q.jsxs("div",{className:"level",children:[l[n]," ",n," / ",c.length]}),q.jsx(Cv,{now:f(),className:"progress-gradient h-2"})]})}var qv={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Lg=Ki.createContext&&Ki.createContext(qv),p1=["attr","size","title"];function g1(e,s){if(e==null)return{};var n=m1(e,s),o,l;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(l=0;l<c.length;l++)o=c[l],!(s.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function m1(e,s){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(s.indexOf(o)>=0)continue;n[o]=e[o]}return n}function pl(){return pl=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},pl.apply(this,arguments)}function Og(e,s){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);s&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,o)}return n}function gl(e){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Og(Object(n),!0).forEach(function(o){_1(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Og(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function _1(e,s,n){return s=v1(s),s in e?Object.defineProperty(e,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[s]=n,e}function v1(e){var s=y1(e,"string");return typeof s=="symbol"?s:s+""}function y1(e,s){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,s||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(e)}function Zv(e){return e&&e.map((s,n)=>Ki.createElement(s.tag,gl({key:n},s.attr),Zv(s.child)))}function Kv(e){return s=>Ki.createElement(w1,pl({attr:gl({},e.attr)},s),Zv(e.child))}function w1(e){var s=n=>{var{attr:o,size:l,title:c}=e,f=g1(e,p1),g=l||n.size||"1em",_;return n.className&&(_=n.className),e.className&&(_=(_?_+" ":"")+e.className),Ki.createElement("svg",pl({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,f,{className:_,style:gl(gl({color:e.color||n.color},n.style),e.style),height:g,width:g,xmlns:"http://www.w3.org/2000/svg"}),c&&Ki.createElement("title",null,c),e.children)};return Lg!==void 0?Ki.createElement(Lg.Consumer,null,n=>s(n)):s(qv)}function Ng(e){return Kv({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"},child:[]}]})(e)}function x1(e){return Kv({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9 11.24V7.5a2.5 2.5 0 0 1 5 0v3.74c1.21-.81 2-2.18 2-3.74C16 5.01 13.99 3 11.5 3S7 5.01 7 7.5c0 1.56.79 2.93 2 3.74zm9.84 4.63-4.54-2.26c-.17-.07-.35-.11-.54-.11H13v-6c0-.83-.67-1.5-1.5-1.5S10 6.67 10 7.5v10.74c-3.6-.76-3.54-.75-3.67-.75-.31 0-.59.13-.79.33l-.79.8 4.94 4.94c.27.27.65.44 1.06.44h6.79c.75 0 1.33-.55 1.44-1.28l.75-5.27c.01-.07.02-.14.02-.2 0-.62-.38-1.16-.91-1.38z"},child:[]}]})(e)}function b1(){var ji,gr;const{sessionData:e}=Co(),s=Number(e.userData.energyLimit.Value),n=Number(e.userData.tapValue.Value),o=Number(e.userData.refill.Value),l=Number(e.userData.tapUpgradeCost.Value),c=Number(e.userData.energyLimitUpgradeCost.Value),f=6e3,g=Y.useContext(Fd),{setData:_}=Co(),[v,x]=Y.useState(!1),[S,T]=Y.useState(!1),[D]=Y.useState(f),[F,O]=Y.useState(Number(e.userData.coins.Value)),[L,P]=Y.useState(n),[A,I]=Y.useState(s),[H,j]=Y.useState(A),[Z,E]=Y.useState(A),[B,G]=Y.useState(o),[nt,at]=Y.useState(l),[J,Gt]=Y.useState(c),[Jt,vt]=Y.useState([]),et=F<nt,gi=F<J,st=Z==0||H>=A,lt=st?B==6||H>=A?"Energy Full":`${B}/6`:`${B}/6`,dt=()=>{x(bt=>!bt)},Et=()=>{T(bt=>!bt)},Tt=bt=>{vt(Ft=>Ft.filter(Xt=>Xt.id!==bt))},Hi=(bt,Ft)=>{H>=L&&(O(Xt=>Xt+L),j(Xt=>Xt-L),vt(Xt=>[...Xt,{id:Date.now(),value:L,x:bt,y:Ft}]))},Ye=()=>{H<A&&(G(bt=>{const Ft=bt-1;return _("refill",Ft),Ft}),j(bt=>bt+A),E(bt=>bt-1))},Qt=()=>{F>=J&&(I(bt=>{const Ft=bt+1e3;return _("energyLimit",Ft),Ft}),Gt(bt=>{const Ft=bt*2;return _("energyUpgradeCost",Ft),Ft}))},xt=()=>{F>=nt&&P(bt=>{const Ft=bt+1;return O(Xt=>{const mr=Xt-nt;return at(Hl=>{const _r=Hl*2;return _({tapUpgradeCost:_r,tapValue:Ft,coins:mr}),_r}),mr}),Ft})};return Y.useEffect(()=>{const bt=Math.floor(f/3600),Ft=setInterval(()=>{O(Xt=>Xt+bt)},1e3);return()=>clearInterval(Ft)},[f]),q.jsxs("div",{className:"flex flex-1 grow flex-col justify-between text-white",children:[q.jsx(Fb,{score:F}),q.jsxs("section",{className:"align-center mb-2 flex justify-center gap-3 px-2",children:[q.jsxs("div",{className:"flip-container flex grow-[5] rounded-md bg-violet-200 px-2",children:[q.jsxs("div",{className:`flip-card-inner flex grow justify-end ${v?"flipped":""}`,children:[q.jsx("div",{className:"flip-card-front w-100 flex grow items-center justify-center",children:q.jsx(Ob,{energy:H,limit:A})}),q.jsxs("div",{className:"flip-card-back flex grow justify-around py-1 pr-2",children:[q.jsx(vc,{addClass:"flex-1",caption:lt,onClick:Ye,disabled:st,children:"Refill"}),q.jsx(vc,{caption:`${J} pts to Upgrade`,onClick:Qt,disabled:gi,children:"Upgrade Limit"})]})]}),q.jsx("button",{onClick:dt,children:q.jsx(Ng,{})})]}),q.jsxs("div",{className:"flip-container flex grow-[3] rounded-md bg-violet-200 px-2",children:[q.jsxs("div",{className:`flip-card-inner flex grow items-center justify-end ${S?"flipped":""}`,children:[q.jsxs("div",{className:"flip-card-front flex grow items-center justify-center",children:[q.jsx(x1,{})," +",L]}),q.jsx("div",{className:"flip-card-back flex grow justify-around py-1 pr-2",children:q.jsx(vc,{caption:`${nt} pts to Upgrade`,onClick:xt,disabled:et,children:"Upgrade Tap"})})]}),q.jsx("button",{onClick:Et,children:q.jsx(Ng,{})})]})]}),q.jsx(kb,{onTap:Hi,children:Jt.map(bt=>q.jsx(Bb,{number:bt.value,x:bt.x,y:bt.y,onAnimationEnd:()=>Tt(bt.id)},bt.id))}),q.jsxs("section",{className:"flex flex-row justify-between px-3 pb-3",children:[q.jsxs("div",{className:"level-progress",children:[q.jsx("div",{className:"text-md font-bold",children:((gr=(ji=g==null?void 0:g.tgData)==null?void 0:ji.initDataUnsafe)==null?void 0:gr.user.username)??"Guest"}),q.jsx(f1,{coins:F})]}),q.jsx(Nb,{token:D})]})]})}/*!
 * excalibur - 0.29.3 - 2024-5-5
 * https://github.com/excaliburjs/Excalibur
 * Copyright (c) 2024 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>
 * Licensed BSD-2-Clause
 * @preserve
 */var C1={8851:(e,s,n)=>{n.d(s,{A:()=>_});var o=n(2001),l=n.n(o),c=n(935),f=n.n(c),g=f()(l());g.push([e.id,`/* Buttons styles start */

button#excalibur-play {
  display: inline-block;
  position: relative;
  z-index: 999;
  border-radius: 6px;
  border: none;
  /*border: 3px solid;
    border-color: white;
    box-shadow: 0 0 10px #ccc;*/
  padding: 1rem 1.5rem 1rem 4rem;
  margin: 0;
  text-decoration: none;
  background: #00b233;
  color: #ffffff;
  font-family: sans-serif;
  font-size: 2rem;
  white-space: nowrap;
  line-height: 1;
  cursor: pointer;
  text-align: center;
  transition: background 250ms ease-in-out, transform 150ms ease;
  -webkit-appearance: none;
  -moz-appearance: none;

  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */
  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */
  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */
  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */
  animation: excalibur-button-fadein 200ms;
}

/*
button#excalibur-play {
  display: none;
}*/

button#excalibur-play:after {
  position: absolute;
  content: '';
  border: 8px solid;
  border-color: transparent transparent transparent white;
  left: 35px;
  top: 24px;
  width: 0;
  height: 0;
}

button#excalibur-play:before {
  position: absolute;
  content: '';
  border: 3px solid;
  left: 19px;
  top: 14px;
  border-radius: 20px;
  width: 30px;
  height: 30px;
}

button#excalibur-play:hover,
button#excalibur-play:focus {
  background: #00982c;
}

button#excalibur-play:focus {
  outline: 1px solid #fff;
  outline-offset: -4px;
}

button#excalibur-play:active {
  transform: scale(0.99);
}

@keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Firefox < 16 */
@-moz-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Safari, Chrome and Opera > 12.1 */
@-webkit-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Internet Explorer */
@-ms-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Opera < 12.1 */
@-o-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
`,"",{version:3,sources:["webpack://./Director/Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:[`/* Buttons styles start */\r
\r
button#excalibur-play {\r
  display: inline-block;\r
  position: relative;\r
  z-index: 999;\r
  border-radius: 6px;\r
  border: none;\r
  /*border: 3px solid;\r
    border-color: white;\r
    box-shadow: 0 0 10px #ccc;*/\r
  padding: 1rem 1.5rem 1rem 4rem;\r
  margin: 0;\r
  text-decoration: none;\r
  background: #00b233;\r
  color: #ffffff;\r
  font-family: sans-serif;\r
  font-size: 2rem;\r
  white-space: nowrap;\r
  line-height: 1;\r
  cursor: pointer;\r
  text-align: center;\r
  transition: background 250ms ease-in-out, transform 150ms ease;\r
  -webkit-appearance: none;\r
  -moz-appearance: none;\r
\r
  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r
  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r
  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r
  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r
  animation: excalibur-button-fadein 200ms;\r
}\r
\r
/*\r
button#excalibur-play {\r
  display: none;\r
}*/\r
\r
button#excalibur-play:after {\r
  position: absolute;\r
  content: '';\r
  border: 8px solid;\r
  border-color: transparent transparent transparent white;\r
  left: 35px;\r
  top: 24px;\r
  width: 0;\r
  height: 0;\r
}\r
\r
button#excalibur-play:before {\r
  position: absolute;\r
  content: '';\r
  border: 3px solid;\r
  left: 19px;\r
  top: 14px;\r
  border-radius: 20px;\r
  width: 30px;\r
  height: 30px;\r
}\r
\r
button#excalibur-play:hover,\r
button#excalibur-play:focus {\r
  background: #00982c;\r
}\r
\r
button#excalibur-play:focus {\r
  outline: 1px solid #fff;\r
  outline-offset: -4px;\r
}\r
\r
button#excalibur-play:active {\r
  transform: scale(0.99);\r
}\r
\r
@keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Firefox < 16 */\r
@-moz-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Safari, Chrome and Opera > 12.1 */\r
@-webkit-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Internet Explorer */\r
@-ms-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Opera < 12.1 */\r
@-o-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
`],sourceRoot:""}]);const _=g},4296:(e,s,n)=>{n.d(s,{A:()=>_});var o=n(2001),l=n.n(o),c=n(935),f=n.n(c),g=f()(l());g.push([e.id,`
#ex-toast-container {
  position: absolute;
  height: 0;
  min-width: 50%;
  left: 50%;
  top: 0;
}

.ex-toast-message {
  left: -50%;
  position: relative;
  display: flex;
  justify-content: space-between;


  padding: 10px;
  margin-top: 5px;
  font-size: 18px;
  font-family: sans-serif;
  border-radius: 6px;
  border: 3px solid #b7b779;
  background-color: rgb(253, 253, 192);
}


.ex-toast-message button {
  align-self: flex-start;
}`,"",{version:3,sources:["webpack://./Util/Toaster.css"],names:[],mappings:";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB",sourcesContent:[`\r
#ex-toast-container {\r
  position: absolute;\r
  height: 0;\r
  min-width: 50%;\r
  left: 50%;\r
  top: 0;\r
}\r
\r
.ex-toast-message {\r
  left: -50%;\r
  position: relative;\r
  display: flex;\r
  justify-content: space-between;\r
\r
\r
  padding: 10px;\r
  margin-top: 5px;\r
  font-size: 18px;\r
  font-family: sans-serif;\r
  border-radius: 6px;\r
  border: 3px solid #b7b779;\r
  background-color: rgb(253, 253, 192);\r
}\r
\r
\r
.ex-toast-message button {\r
  align-self: flex-start;\r
}`],sourceRoot:""}]);const _=g},935:e=>{e.exports=function(s){var n=[];return n.toString=function(){return this.map(function(l){var c="",f=typeof l[5]<"u";return l[4]&&(c+="@supports (".concat(l[4],") {")),l[2]&&(c+="@media ".concat(l[2]," {")),f&&(c+="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {")),c+=s(l),f&&(c+="}"),l[2]&&(c+="}"),l[4]&&(c+="}"),c}).join("")},n.i=function(l,c,f,g,_){typeof l=="string"&&(l=[[null,l,void 0]]);var v={};if(f)for(var x=0;x<this.length;x++){var S=this[x][0];S!=null&&(v[S]=!0)}for(var T=0;T<l.length;T++){var D=[].concat(l[T]);f&&v[D[0]]||(typeof _<"u"&&(typeof D[5]>"u"||(D[1]="@layer".concat(D[5].length>0?" ".concat(D[5]):""," {").concat(D[1],"}")),D[5]=_),c&&(D[2]&&(D[1]="@media ".concat(D[2]," {").concat(D[1],"}")),D[2]=c),g&&(D[4]?(D[1]="@supports (".concat(D[4],") {").concat(D[1],"}"),D[4]=g):D[4]="".concat(g)),n.push(D))}},n}},2001:e=>{e.exports=function(s){var n=s[1],o=s[3];if(!o)return n;if(typeof btoa=="function"){var l=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),f="/*# ".concat(c," */");return[n].concat([f]).join(`
`)}return[n].join(`
`)}},9493:(e,s,n)=>{n(3975);var o=n(2564);e.exports=o("Array","sort")},311:(e,s,n)=>{n(8291);var o=n(9120);e.exports=o.Object.keys},4977:(e,s,n)=>{var o=n(4188),l=n(3174),c=TypeError;e.exports=function(f){if(o(f))return f;throw new c(l(f)+" is not a function")}},3770:(e,s,n)=>{var o=n(831),l=String,c=TypeError;e.exports=function(f){if(o(f))return f;throw new c(l(f)+" is not an object")}},1458:(e,s,n)=>{var o=n(380),l=n(675),c=n(9389),f=function(g){return function(_,v,x){var S=o(_),T=c(S);if(T===0)return!g&&-1;var D=l(x,T),F;if(g&&v!==v){for(;T>D;)if(F=S[D++],F!==F)return!0}else for(;T>D;D++)if((g||D in S)&&S[D]===v)return g||D||0;return!g&&-1}};e.exports={includes:f(!0),indexOf:f(!1)}},5397:(e,s,n)=>{var o=n(5234);e.exports=function(l,c){var f=[][l];return!!f&&o(function(){f.call(null,c||function(){return 1},1)})}},7825:(e,s,n)=>{var o=n(6881);e.exports=o([].slice)},9295:(e,s,n)=>{var o=n(7825),l=Math.floor,c=function(f,g){var _=f.length;if(_<8)for(var v=1,x,S;v<_;){for(S=v,x=f[v];S&&g(f[S-1],x)>0;)f[S]=f[--S];S!==v++&&(f[S]=x)}else for(var T=l(_/2),D=c(o(f,0,T),g),F=c(o(f,T),g),O=D.length,L=F.length,P=0,A=0;P<O||A<L;)f[P+A]=P<O&&A<L?g(D[P],F[A])<=0?D[P++]:F[A++]:P<O?D[P++]:F[A++];return f};e.exports=c},8689:(e,s,n)=>{var o=n(6881),l=o({}.toString),c=o("".slice);e.exports=function(f){return c(l(f),8,-1)}},5438:(e,s,n)=>{var o=n(9345),l=n(4188),c=n(8689),f=n(4282),g=f("toStringTag"),_=Object,v=c(function(){return arguments}())==="Arguments",x=function(S,T){try{return S[T]}catch{}};e.exports=o?c:function(S){var T,D,F;return S===void 0?"Undefined":S===null?"Null":typeof(D=x(T=_(S),g))=="string"?D:v?c(T):(F=c(T))==="Object"&&l(T.callee)?"Arguments":F}},8657:(e,s,n)=>{var o=n(4418),l=n(3168),c=n(9304),f=n(4466);e.exports=function(g,_,v){for(var x=l(_),S=f.f,T=c.f,D=0;D<x.length;D++){var F=x[D];!o(g,F)&&!(v&&o(v,F))&&S(g,F,T(_,F))}}},8088:(e,s,n)=>{var o=n(6893),l=n(4466),c=n(9123);e.exports=o?function(f,g,_){return l.f(f,g,c(1,_))}:function(f,g,_){return f[g]=_,f}},9123:e=>{e.exports=function(s,n){return{enumerable:!(s&1),configurable:!(s&2),writable:!(s&4),value:n}}},7509:(e,s,n)=>{var o=n(4188),l=n(4466),c=n(4530),f=n(4798);e.exports=function(g,_,v,x){x||(x={});var S=x.enumerable,T=x.name!==void 0?x.name:_;if(o(v)&&c(v,T,x),x.global)S?g[_]=v:f(_,v);else{try{x.unsafe?g[_]&&(S=!0):delete g[_]}catch{}S?g[_]=v:l.f(g,_,{value:v,enumerable:!1,configurable:!x.nonConfigurable,writable:!x.nonWritable})}return g}},4798:(e,s,n)=>{var o=n(1488),l=Object.defineProperty;e.exports=function(c,f){try{l(o,c,{value:f,configurable:!0,writable:!0})}catch{o[c]=f}return f}},1305:(e,s,n)=>{var o=n(3174),l=TypeError;e.exports=function(c,f){if(!delete c[f])throw new l("Cannot delete property "+o(f)+" of "+o(c))}},6893:(e,s,n)=>{var o=n(5234);e.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},5926:(e,s,n)=>{var o=n(1488),l=n(831),c=o.document,f=l(c)&&l(c.createElement);e.exports=function(g){return f?c.createElement(g):{}}},8807:(e,s,n)=>{var o=n(4109),l=o.match(/firefox\/(\d+)/i);e.exports=!!l&&+l[1]},5661:(e,s,n)=>{var o=n(4109);e.exports=/MSIE|Trident/.test(o)},4109:e=>{e.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},3749:(e,s,n)=>{var o=n(1488),l=n(4109),c=o.process,f=o.Deno,g=c&&c.versions||f&&f.version,_=g&&g.v8,v,x;_&&(v=_.split("."),x=v[0]>0&&v[0]<4?1:+(v[0]+v[1])),!x&&l&&(v=l.match(/Edge\/(\d+)/),(!v||v[1]>=74)&&(v=l.match(/Chrome\/(\d+)/),v&&(x=+v[1]))),e.exports=x},3589:(e,s,n)=>{var o=n(4109),l=o.match(/AppleWebKit\/(\d+)\./);e.exports=!!l&&+l[1]},2564:(e,s,n)=>{var o=n(1488),l=n(6881);e.exports=function(c,f){return l(o[c].prototype[f])}},1274:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},5613:(e,s,n)=>{var o=n(1488),l=n(9304).f,c=n(8088),f=n(7509),g=n(4798),_=n(8657),v=n(8489);e.exports=function(x,S){var T=x.target,D=x.global,F=x.stat,O,L,P,A,I,H;if(D?L=o:F?L=o[T]||g(T,{}):L=o[T]&&o[T].prototype,L)for(P in S){if(I=S[P],x.dontCallGetSet?(H=l(L,P),A=H&&H.value):A=L[P],O=v(D?P:T+(F?".":"#")+P,x.forced),!O&&A!==void 0){if(typeof I==typeof A)continue;_(I,A)}(x.sham||A&&A.sham)&&c(I,"sham",!0),f(L,P,I,x)}}},5234:e=>{e.exports=function(s){try{return!!s()}catch{return!0}}},9055:(e,s,n)=>{var o=n(5234);e.exports=!o(function(){var l=(function(){}).bind();return typeof l!="function"||l.hasOwnProperty("prototype")})},9944:(e,s,n)=>{var o=n(9055),l=Function.prototype.call;e.exports=o?l.bind(l):function(){return l.apply(l,arguments)}},2735:(e,s,n)=>{var o=n(6893),l=n(4418),c=Function.prototype,f=o&&Object.getOwnPropertyDescriptor,g=l(c,"name"),_=g&&(function(){}).name==="something",v=g&&(!o||o&&f(c,"name").configurable);e.exports={EXISTS:g,PROPER:_,CONFIGURABLE:v}},6881:(e,s,n)=>{var o=n(9055),l=Function.prototype,c=l.call,f=o&&l.bind.bind(c,c);e.exports=o?f:function(g){return function(){return c.apply(g,arguments)}}},5604:(e,s,n)=>{var o=n(1488),l=n(4188),c=function(f){return l(f)?f:void 0};e.exports=function(f,g){return arguments.length<2?c(o[f]):o[f]&&o[f][g]}},2913:(e,s,n)=>{var o=n(4977),l=n(4318);e.exports=function(c,f){var g=c[f];return l(g)?void 0:o(g)}},1488:function(e,s,n){var o=function(l){return l&&l.Math===Math&&l};e.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof n.g=="object"&&n.g)||o(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},4418:(e,s,n)=>{var o=n(6881),l=n(3628),c=o({}.hasOwnProperty);e.exports=Object.hasOwn||function(g,_){return c(l(g),_)}},7588:e=>{e.exports={}},9622:(e,s,n)=>{var o=n(6893),l=n(5234),c=n(5926);e.exports=!o&&!l(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!==7})},7568:(e,s,n)=>{var o=n(6881),l=n(5234),c=n(8689),f=Object,g=o("".split);e.exports=l(function(){return!f("z").propertyIsEnumerable(0)})?function(_){return c(_)==="String"?g(_,""):f(_)}:f},3029:(e,s,n)=>{var o=n(6881),l=n(4188),c=n(2694),f=o(Function.toString);l(c.inspectSource)||(c.inspectSource=function(g){return f(g)}),e.exports=c.inspectSource},3086:(e,s,n)=>{var o=n(5945),l=n(1488),c=n(831),f=n(8088),g=n(4418),_=n(2694),v=n(168),x=n(7588),S="Object already initialized",T=l.TypeError,D=l.WeakMap,F,O,L,P=function(j){return L(j)?O(j):F(j,{})},A=function(j){return function(Z){var E;if(!c(Z)||(E=O(Z)).type!==j)throw new T("Incompatible receiver, "+j+" required");return E}};if(o||_.state){var I=_.state||(_.state=new D);I.get=I.get,I.has=I.has,I.set=I.set,F=function(j,Z){if(I.has(j))throw new T(S);return Z.facade=j,I.set(j,Z),Z},O=function(j){return I.get(j)||{}},L=function(j){return I.has(j)}}else{var H=v("state");x[H]=!0,F=function(j,Z){if(g(j,H))throw new T(S);return Z.facade=j,f(j,H,Z),Z},O=function(j){return g(j,H)?j[H]:{}},L=function(j){return g(j,H)}}e.exports={set:F,get:O,has:L,enforce:P,getterFor:A}},4188:e=>{var s=typeof document=="object"&&document.all;e.exports=typeof s>"u"&&s!==void 0?function(n){return typeof n=="function"||n===s}:function(n){return typeof n=="function"}},8489:(e,s,n)=>{var o=n(5234),l=n(4188),c=/#|\.prototype\./,f=function(S,T){var D=_[g(S)];return D===x?!0:D===v?!1:l(T)?o(T):!!T},g=f.normalize=function(S){return String(S).replace(c,".").toLowerCase()},_=f.data={},v=f.NATIVE="N",x=f.POLYFILL="P";e.exports=f},4318:e=>{e.exports=function(s){return s==null}},831:(e,s,n)=>{var o=n(4188);e.exports=function(l){return typeof l=="object"?l!==null:o(l)}},1942:e=>{e.exports=!1},6032:(e,s,n)=>{var o=n(5604),l=n(4188),c=n(4578),f=n(9809),g=Object;e.exports=f?function(_){return typeof _=="symbol"}:function(_){var v=o("Symbol");return l(v)&&c(v.prototype,g(_))}},9389:(e,s,n)=>{var o=n(7611);e.exports=function(l){return o(l.length)}},4530:(e,s,n)=>{var o=n(6881),l=n(5234),c=n(4188),f=n(4418),g=n(6893),_=n(2735).CONFIGURABLE,v=n(3029),x=n(3086),S=x.enforce,T=x.get,D=String,F=Object.defineProperty,O=o("".slice),L=o("".replace),P=o([].join),A=g&&!l(function(){return F(function(){},"length",{value:8}).length!==8}),I=String(String).split("String"),H=e.exports=function(j,Z,E){O(D(Z),0,7)==="Symbol("&&(Z="["+L(D(Z),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),E&&E.getter&&(Z="get "+Z),E&&E.setter&&(Z="set "+Z),(!f(j,"name")||_&&j.name!==Z)&&(g?F(j,"name",{value:Z,configurable:!0}):j.name=Z),A&&E&&f(E,"arity")&&j.length!==E.arity&&F(j,"length",{value:E.arity});try{E&&f(E,"constructor")&&E.constructor?g&&F(j,"prototype",{writable:!1}):j.prototype&&(j.prototype=void 0)}catch{}var B=S(j);return f(B,"source")||(B.source=P(I,typeof Z=="string"?Z:"")),j};Function.prototype.toString=H(function(){return c(this)&&T(this).source||v(this)},"toString")},142:e=>{var s=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(l){var c=+l;return(c>0?n:s)(c)}},4466:(e,s,n)=>{var o=n(6893),l=n(9622),c=n(3315),f=n(3770),g=n(2344),_=TypeError,v=Object.defineProperty,x=Object.getOwnPropertyDescriptor,S="enumerable",T="configurable",D="writable";s.f=o?c?function(O,L,P){if(f(O),L=g(L),f(P),typeof O=="function"&&L==="prototype"&&"value"in P&&D in P&&!P[D]){var A=x(O,L);A&&A[D]&&(O[L]=P.value,P={configurable:T in P?P[T]:A[T],enumerable:S in P?P[S]:A[S],writable:!1})}return v(O,L,P)}:v:function(O,L,P){if(f(O),L=g(L),f(P),l)try{return v(O,L,P)}catch{}if("get"in P||"set"in P)throw new _("Accessors not supported");return"value"in P&&(O[L]=P.value),O}},9304:(e,s,n)=>{var o=n(6893),l=n(9944),c=n(4416),f=n(9123),g=n(380),_=n(2344),v=n(4418),x=n(9622),S=Object.getOwnPropertyDescriptor;s.f=o?S:function(D,F){if(D=g(D),F=_(F),x)try{return S(D,F)}catch{}if(v(D,F))return f(!l(c.f,D,F),D[F])}},5629:(e,s,n)=>{var o=n(1843),l=n(1274),c=l.concat("length","prototype");s.f=Object.getOwnPropertyNames||function(g){return o(g,c)}},156:(e,s)=>{s.f=Object.getOwnPropertySymbols},4578:(e,s,n)=>{var o=n(6881);e.exports=o({}.isPrototypeOf)},1843:(e,s,n)=>{var o=n(6881),l=n(4418),c=n(380),f=n(1458).indexOf,g=n(7588),_=o([].push);e.exports=function(v,x){var S=c(v),T=0,D=[],F;for(F in S)!l(g,F)&&l(S,F)&&_(D,F);for(;x.length>T;)l(S,F=x[T++])&&(~f(D,F)||_(D,F));return D}},7137:(e,s,n)=>{var o=n(1843),l=n(1274);e.exports=Object.keys||function(f){return o(f,l)}},4416:(e,s)=>{var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,l=o&&!n.call({1:2},1);s.f=l?function(f){var g=o(this,f);return!!g&&g.enumerable}:n},2287:(e,s,n)=>{var o=n(9944),l=n(4188),c=n(831),f=TypeError;e.exports=function(g,_){var v,x;if(_==="string"&&l(v=g.toString)&&!c(x=o(v,g))||l(v=g.valueOf)&&!c(x=o(v,g))||_!=="string"&&l(v=g.toString)&&!c(x=o(v,g)))return x;throw new f("Can't convert object to primitive value")}},3168:(e,s,n)=>{var o=n(5604),l=n(6881),c=n(5629),f=n(156),g=n(3770),_=l([].concat);e.exports=o("Reflect","ownKeys")||function(x){var S=c.f(g(x)),T=f.f;return T?_(S,T(x)):S}},9120:(e,s,n)=>{var o=n(1488);e.exports=o},9509:(e,s,n)=>{var o=n(4318),l=TypeError;e.exports=function(c){if(o(c))throw new l("Can't call method on "+c);return c}},168:(e,s,n)=>{var o=n(746),l=n(6209),c=o("keys");e.exports=function(f){return c[f]||(c[f]=l(f))}},2694:(e,s,n)=>{var o=n(1942),l=n(1488),c=n(4798),f="__core-js_shared__",g=e.exports=l[f]||c(f,{});(g.versions||(g.versions=[])).push({version:"3.36.1",mode:o?"pure":"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE",source:"https://github.com/zloirock/core-js"})},746:(e,s,n)=>{var o=n(2694);e.exports=function(l,c){return o[l]||(o[l]=c||{})}},8944:(e,s,n)=>{var o=n(3749),l=n(5234),c=n(1488),f=c.String;e.exports=!!Object.getOwnPropertySymbols&&!l(function(){var g=Symbol("symbol detection");return!f(g)||!(Object(g)instanceof Symbol)||!Symbol.sham&&o&&o<41})},675:(e,s,n)=>{var o=n(6744),l=Math.max,c=Math.min;e.exports=function(f,g){var _=o(f);return _<0?l(_+g,0):c(_,g)}},380:(e,s,n)=>{var o=n(7568),l=n(9509);e.exports=function(c){return o(l(c))}},6744:(e,s,n)=>{var o=n(142);e.exports=function(l){var c=+l;return c!==c||c===0?0:o(c)}},7611:(e,s,n)=>{var o=n(6744),l=Math.min;e.exports=function(c){var f=o(c);return f>0?l(f,9007199254740991):0}},3628:(e,s,n)=>{var o=n(9509),l=Object;e.exports=function(c){return l(o(c))}},290:(e,s,n)=>{var o=n(9944),l=n(831),c=n(6032),f=n(2913),g=n(2287),_=n(4282),v=TypeError,x=_("toPrimitive");e.exports=function(S,T){if(!l(S)||c(S))return S;var D=f(S,x),F;if(D){if(T===void 0&&(T="default"),F=o(D,S,T),!l(F)||c(F))return F;throw new v("Can't convert object to primitive value")}return T===void 0&&(T="number"),g(S,T)}},2344:(e,s,n)=>{var o=n(290),l=n(6032);e.exports=function(c){var f=o(c,"string");return l(f)?f:f+""}},9345:(e,s,n)=>{var o=n(4282),l=o("toStringTag"),c={};c[l]="z",e.exports=String(c)==="[object z]"},2618:(e,s,n)=>{var o=n(5438),l=String;e.exports=function(c){if(o(c)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return l(c)}},3174:e=>{var s=String;e.exports=function(n){try{return s(n)}catch{return"Object"}}},6209:(e,s,n)=>{var o=n(6881),l=0,c=Math.random(),f=o(1 .toString);e.exports=function(g){return"Symbol("+(g===void 0?"":g)+")_"+f(++l+c,36)}},9809:(e,s,n)=>{var o=n(8944);e.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3315:(e,s,n)=>{var o=n(6893),l=n(5234);e.exports=o&&l(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},5945:(e,s,n)=>{var o=n(1488),l=n(4188),c=o.WeakMap;e.exports=l(c)&&/native code/.test(String(c))},4282:(e,s,n)=>{var o=n(1488),l=n(746),c=n(4418),f=n(6209),g=n(8944),_=n(9809),v=o.Symbol,x=l("wks"),S=_?v.for||v:v&&v.withoutSetter||f;e.exports=function(T){return c(x,T)||(x[T]=g&&c(v,T)?v[T]:S("Symbol."+T)),x[T]}},3975:(e,s,n)=>{var o=n(5613),l=n(6881),c=n(4977),f=n(3628),g=n(9389),_=n(1305),v=n(2618),x=n(5234),S=n(9295),T=n(5397),D=n(8807),F=n(5661),O=n(3749),L=n(3589),P=[],A=l(P.sort),I=l(P.push),H=x(function(){P.sort(void 0)}),j=x(function(){P.sort(null)}),Z=T("sort"),E=!x(function(){if(O)return O<70;if(!(D&&D>3)){if(F)return!0;if(L)return L<603;var nt="",at,J,Gt,Jt;for(at=65;at<76;at++){switch(J=String.fromCharCode(at),at){case 66:case 69:case 70:case 72:Gt=3;break;case 68:case 71:Gt=4;break;default:Gt=2}for(Jt=0;Jt<47;Jt++)P.push({k:J+Jt,v:Gt})}for(P.sort(function(vt,et){return et.v-vt.v}),Jt=0;Jt<P.length;Jt++)J=P[Jt].k.charAt(0),nt.charAt(nt.length-1)!==J&&(nt+=J);return nt!=="DGBEFHACIJK"}}),B=H||!j||!Z||!E,G=function(nt){return function(at,J){return J===void 0?-1:at===void 0?1:nt!==void 0?+nt(at,J)||0:v(at)>v(J)?1:-1}};o({target:"Array",proto:!0,forced:B},{sort:function(at){at!==void 0&&c(at);var J=f(this);if(E)return at===void 0?A(J):A(J,at);var Gt=[],Jt=g(J),vt,et;for(et=0;et<Jt;et++)et in J&&I(Gt,J[et]);for(S(Gt,G(at)),vt=g(Gt),et=0;et<vt;)J[et]=Gt[et++];for(;et<Jt;)_(J,et++);return J}})},8291:(e,s,n)=>{var o=n(5613),l=n(3628),c=n(7137),f=n(5234),g=f(function(){c(1)});o({target:"Object",stat:!0,forced:g},{keys:function(v){return c(l(v))}})}},Ug={};function Dt(e){var s=Ug[e];if(s!==void 0)return s.exports;var n=Ug[e]={id:e,exports:{}};return C1[e].call(n.exports,n,n.exports,Dt),n.exports}Dt.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return Dt.d(s,{a:s}),s};Dt.d=(e,s)=>{for(var n in s)Dt.o(s,n)&&!Dt.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})};Dt.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();Dt.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s);Dt.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var C={};(()=>{Dt.d(C,{eKr:()=>mh,yVm:()=>Er,a7j:()=>qd,U_w:()=>zh,JF2:()=>gh,htg:()=>Sn,HXL:()=>Mf,mcg:()=>hh,Agj:()=>Oe,u6S:()=>X0,x7M:()=>xt,X55:()=>Ii,m3M:()=>Cr,aE5:()=>Z0,YJU:()=>vi,eZi:()=>Ih,GNv:()=>vn,Y56:()=>Rn,_0v:()=>na,vhs:()=>Jo,Z8b:()=>hf,Yfw:()=>ht,IcQ:()=>et,Rl2:()=>$o,kgJ:()=>Oh,GTT:()=>Gf,ypY:()=>Pn,i7d:()=>bf,fQ3:()=>J0,HlI:()=>Oo,jlt:()=>qo,VQc:()=>fe,zD7:()=>Nh,I0I:()=>Qo,AUF:()=>Ri,JoF:()=>as,MlA:()=>Wt,PZh:()=>Ws,qA:()=>wr,CrD:()=>Hs,dQK:()=>Ti,D3r:()=>_i,Qpo:()=>Vo,D9n:()=>Wo,b6v:()=>yr,mvh:()=>kh,Bpo:()=>ut,Q1f:()=>G,IKv:()=>Wf,fcV:()=>$s,Glf:()=>jf,uAl:()=>mi,ElT:()=>de,MPu:()=>Df,Z8r:()=>Gt,QSL:()=>If,sPV:()=>jo,nAn:()=>js,zCU:()=>Ho,QrV:()=>ie,fF9:()=>Dy,xI8:()=>ch,yar:()=>se,SP7:()=>Vf,oRy:()=>sa,f5X:()=>Bf,V1c:()=>jl,Mlx:()=>Xf,ZCo:()=>xr,Vy3:()=>Pi,J5p:()=>$f,mL_:()=>Te,Guw:()=>uf,VKx:()=>Sh,N5j:()=>Gd,pgY:()=>df,OP3:()=>ea,rl5:()=>Zf,eod:()=>cy,q5Z:()=>ee,YUC:()=>Ch,saR:()=>Xo,hvr:()=>Gh,Qol:()=>lf,Wf4:()=>af,JCs:()=>It,gJV:()=>Le,fWD:()=>yf,Va_:()=>An,N$8:()=>Re,_jQ:()=>fy,rxj:()=>fh,rhv:()=>dh,wCu:()=>ge,HAp:()=>q0,Zy1:()=>Sf,Qev:()=>py,bkB:()=>v,wfL:()=>Uo,sVA:()=>s,$Gs:()=>Xl,CJ0:()=>Lo,NWh:()=>Gi,tWi:()=>ph,xAj:()=>uh,zWh:()=>cf,i_4:()=>Iy,iIx:()=>f,c9e:()=>Th,KQV:()=>Vs,weH:()=>Ct,jXp:()=>Py,zzY:()=>ta,yRQ:()=>Zo,MtE:()=>Yf,rPj:()=>Br,KLc:()=>_,Fir:()=>mt,V5f:()=>Ql,Xj7:()=>ql,Wud:()=>Dr,FVg:()=>oh,g5Y:()=>rh,YQB:()=>sh,KPb:()=>nh,nHK:()=>Ir,TX_:()=>Ay,r3n:()=>kr,vYh:()=>zt,hnk:()=>ne,D2R:()=>Cn,n1o:()=>Ff,RLG:()=>lh,fBU:()=>Yd,Adb:()=>qt,bEs:()=>_n,wCy:()=>te,CbD:()=>Ht,x_C:()=>bn,pde:()=>o,pGf:()=>Lh,ibQ:()=>Uf,QlN:()=>Yo,shR:()=>Rr,Yjk:()=>Lf,_u1:()=>my,OBI:()=>Kf,klh:()=>Dn,s3S:()=>Fh,D$R:()=>In,xth:()=>zo,JU7:()=>gy,h9x:()=>xf,N1A:()=>Wh,e_k:()=>Ae,aHM:()=>Us,tlv:()=>U0,Vi9:()=>vf,ieR:()=>_f,$bb:()=>at,VyI:()=>J,imn:()=>Ud,uqu:()=>Qt,QnL:()=>Ye,vnc:()=>_h,wk_:()=>Ph,GH0:()=>Mt,_1r:()=>Rf,l0X:()=>Jd,HHX:()=>tf,tjk:()=>$i,rWe:()=>Ns,j9l:()=>jd,NVp:()=>Qd,cPK:()=>xe,XoL:()=>Of,RmF:()=>qe,DXI:()=>ia,tCD:()=>_y,oGn:()=>tp,J3D:()=>ra,vCJ:()=>kf,f9l:()=>Tn,AQx:()=>ct,v9m:()=>aa,yRJ:()=>Nf,EU6:()=>Mh,m3O:()=>Fi,Ryz:()=>Di,OxP:()=>kn,LEs:()=>Fr,Ec:()=>x,Pi5:()=>oa,gmH:()=>Bi,tS:()=>Vh,XxX:()=>le,bCz:()=>Nd,nYS:()=>Os,yiT:()=>th,NHl:()=>xn,mO8:()=>ih,PXI:()=>Yl,bn5:()=>Kl,Ywr:()=>os,cMd:()=>Ls,Bs6:()=>Jl,G0k:()=>wn,pyn:()=>eh,QeM:()=>$l,aPX:()=>oy,ITP:()=>Zl,BY0:()=>rs,MFw:()=>br,sBn:()=>vr,S3L:()=>Fn,XKQ:()=>Tr,ESI:()=>Ef,uxz:()=>wf,o8N:()=>T,u_r:()=>yn,RlV:()=>Xi,gVA:()=>Dh,M_G:()=>Sr,GRB:()=>Y0,kM6:()=>Zd,dO8:()=>Kd,jgM:()=>Vl,FWq:()=>Ft,s3j:()=>bt,hlw:()=>sf,B7e:()=>ef,H_X:()=>Ze,S_d:()=>rf,U7E:()=>nf,Z58:()=>Ke,yh2:()=>ay,ff$:()=>Gl,cWi:()=>Jt,NBt:()=>Rh,oNz:()=>M0,QlU:()=>Hf,Xey:()=>hs,jft:()=>My,Mtr:()=>Qe,ypk:()=>pe,mnM:()=>vt,bAZ:()=>ls,ABN:()=>Wd,VK6:()=>N0,kxk:()=>ks,DT1:()=>Bo,FLG:()=>Bs,qN_:()=>Uh,Z37:()=>No,FtL:()=>mf,Z6X:()=>Jf,iQT:()=>li,ziO:()=>Tf,OEF:()=>ki,uuE:()=>Ne,tiv:()=>Pr,T$Y:()=>Qf,EYj:()=>Ar,nOB:()=>Ko,Tap:()=>Zt,FAs:()=>gf,B_P:()=>pf,aA5:()=>K0,M4G:()=>Gs,l$l:()=>qf,dLy:()=>zs,WZP:()=>it,eB6:()=>jh,nFK:()=>bh,l9z:()=>Cf,YOF:()=>ty,yhB:()=>D,J0N:()=>l,Miz:()=>E,Bj4:()=>xh,Rcs:()=>Wi,vJ4:()=>Vi,TqC:()=>$d,nM0:()=>ah,X1u:()=>Ms,SpZ:()=>Hd,DX8:()=>Xs,Yx$:()=>Bh,HK4:()=>Pf,SE$:()=>P,qE8:()=>L,Pz7:()=>ip,sX_:()=>g,JuI:()=>F,Nl$:()=>Ah,OwT:()=>yy,P$G:()=>Cy,mHV:()=>xy,Fx_:()=>Ey,WFC:()=>Sy,aDq:()=>vy,jIg:()=>by,UH3:()=>wy,K6X:()=>$0,C1Y:()=>Xd,Aw1:()=>vh,A8$:()=>Q0,hsx:()=>Mi,l9E:()=>ff,aSf:()=>Af,Zex:()=>sp,mXP:()=>Fy,vt$:()=>Fo,hCA:()=>Fs,pjR:()=>_t,U43:()=>j,pSZ:()=>Z,y17:()=>H,jVr:()=>ky,_SZ:()=>O,xWn:()=>A,ehJ:()=>I,t6s:()=>B,Eyn:()=>e});var e={};Dt.r(e),Dt.d(e,{getAttributeComponentSize:()=>Ld,getAttributePointerType:()=>Od,getGLTypeFromSource:()=>Md,getGlTypeSizeBytes:()=>Wl,isAttributeInSource:()=>Bd});var s={};Dt.r(s),Dt.d(s,{ActionCompleteEvent:()=>mh,ActionStartEvent:()=>gh,ActivateEvent:()=>hh,CollisionEndEvent:()=>wr,CollisionPostSolveEvent:()=>Vo,CollisionPreSolveEvent:()=>Wo,CollisionStartEvent:()=>yr,ContactEndEvent:()=>jo,ContactStartEvent:()=>Ho,DeactivateEvent:()=>ch,EnterTriggerEvent:()=>fh,EnterViewPortEvent:()=>dh,EventTypes:()=>Uo,ExitTriggerEvent:()=>ph,ExitViewPortEvent:()=>uh,GameEvent:()=>mt,GameStartEvent:()=>Ql,GameStopEvent:()=>ql,GamepadAxisEvent:()=>oh,GamepadButtonEvent:()=>rh,GamepadConnectEvent:()=>sh,GamepadDisconnectEvent:()=>nh,HiddenEvent:()=>lh,InitializeEvent:()=>bn,KillEvent:()=>zo,PostCollisionEvent:()=>Os,PostDebugDrawEvent:()=>th,PostDrawEvent:()=>xn,PostFrameEvent:()=>ih,PostKillEvent:()=>Yl,PostTransformDrawEvent:()=>Kl,PostUpdateEvent:()=>os,PreCollisionEvent:()=>Ls,PreDebugDrawEvent:()=>Jl,PreDrawEvent:()=>wn,PreFrameEvent:()=>eh,PreKillEvent:()=>$l,PreTransformDrawEvent:()=>Zl,PreUpdateEvent:()=>rs,VisibleEvent:()=>ah});var n={};Dt.r(n),Dt.d(n,{circle:()=>j0,line:()=>yh,point:()=>z0,roundRect:()=>wh,vector:()=>H0});var o={};Dt.r(o),Dt.d(o,{Axes:()=>Rn,Buttons:()=>Pn,Gamepad:()=>Dr,Gamepads:()=>Ir,KeyEvent:()=>Dn,Keyboard:()=>Fh,Keys:()=>In,NativePointerButton:()=>$i,PointerButton:()=>Fi,PointerComponent:()=>Di,PointerEvent:()=>kn,PointerEventReceiver:()=>Fr,PointerScope:()=>x,PointerSystem:()=>oa,PointerType:()=>Bi,WheelDeltaMode:()=>Xs,WheelEvent:()=>Bh});var l={};Dt.r(l),Dt.d(l,{ConsoleAppender:()=>Gt,DrawUtil:()=>n,EasingFunctions:()=>It,LogLevel:()=>at,Logger:()=>J,Observable:()=>xe,ScreenAppender:()=>Jt,addItemToArray:()=>st,contains:()=>dt,delay:()=>Tt,fail:()=>Et,getPosition:()=>gi,omit:()=>Hi,removeItemFromArray:()=>lt}),Dt(9493),Dt(311);function c(){if(typeof window>"u"&&(window={audioContext:function(){}}),typeof window<"u"&&!window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(u){window.setInterval(u,1e3/60)}),typeof window<"u"&&!window.cancelAnimationFrame&&(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),typeof window<"u"&&!window.AudioContext){if(window.webkitAudioContext){const t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(i){return new Promise((r,a)=>{t.call(this,i,r,a)})}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}typeof window<"u"&&!window.devicePixelRatio&&(window.devicePixelRatio=window.devicePixelRatio||1)}class f{static useCanvasGraphicsContext(){f.enable("use-canvas-context")}static freeze(){f._FROZEN=!0}static _reset(){f._FROZEN=!1,f._FLAGS={}}static enable(t){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");f._FLAGS[t]=!0}static disable(t){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");f._FLAGS[t]=!1}static isEnabled(t){return!!f._FLAGS[t]}static show(){return Object.keys(f._FLAGS)}}f._FROZEN=!1,f._FLAGS={};function g(u,t){return{type:u,value:t}}class _{constructor(){this._isCompleted=!1,this.promise=new Promise((t,i)=>{this._resolver=t,this._rejecter=i})}get isCompleted(){return this._isCompleted}resolve(t){this._isCompleted||(this._isCompleted=!0,this._resolver(t))}reject(t){this._isCompleted||(this._isCompleted=!0,this._rejecter(t))}}class v{constructor(){this._paused=!1,this._listeners={},this._listenersOnce={},this._pipes=[]}clear(){this._listeners={},this._listenersOnce={},this._pipes.length=0}on(t,i){var r;return this._listeners[t]=(r=this._listeners[t])!==null&&r!==void 0?r:[],this._listeners[t].push(i),{close:()=>this.off(t,i)}}once(t,i){var r;return this._listenersOnce[t]=(r=this._listenersOnce[t])!==null&&r!==void 0?r:[],this._listenersOnce[t].push(i),{close:()=>this.off(t,i)}}off(t,i){var r,a;if(i){const h=(r=this._listeners[t])===null||r===void 0?void 0:r.filter(p=>p!==i);this._listeners[t]=h;const d=(a=this._listenersOnce[t])===null||a===void 0?void 0:a.filter(p=>p!==i);this._listenersOnce[t]=d}else delete this._listeners[t]}emit(t,i){var r;if(this._paused)return;(r=this._listeners[t])===null||r===void 0||r.forEach(h=>h(i));const a=this._listenersOnce[t];this._listenersOnce[t]=[],a&&a.forEach(h=>h(i)),this._pipes.forEach(h=>{h.emit(t,i)})}pipe(t){if(this===t)throw Error("Cannot pipe to self");return this._pipes.push(t),{close:()=>{const i=this._pipes.indexOf(t);i>-1&&this._pipes.splice(i,1)}}}unpipe(t){const i=this._pipes.indexOf(t);i>-1&&this._pipes.splice(i,1)}pause(){this._paused=!0}unpause(){this._paused=!1}}var x;(function(u){u.Canvas="Canvas",u.Document="Document"})(x||(x={}));const S=4294967295;class T{constructor(t){this.seed=t,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(t||Date.now())>>>0;for(let i=1;i<this._n;i++){const r=this._mt[i-1]^this._mt[i-1]>>>this._w-2;this._mt[i]=(this._f*((r&4294901760)>>>16)<<16)+this._f*(r&65535)+i>>>0}this._index=this._n}_twist(){const t=[0,this._a];let i=0,r=0;for(;r<this._n-this._m;r++)i=this._mt[r]&this._upperMask|this._mt[r+1]&this._lowerMask,this._mt[r]=this._mt[r+this._m]^i>>>1^t[i&1]&S;for(;r<this._n-1;r++)i=this._mt[r]&this._upperMask|this._mt[r+1]&this._lowerMask,this._mt[r]=this._mt[r+(this._m-this._n)]^i>>>1^t[i&1]&S;i=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^i>>>1^t[i&1]&S,this._index=0}nextInt(){this._index>=this._n&&this._twist();let t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,t^=t>>>this._l,t>>>0}next(){return this.nextInt()*(1/4294967296)}floating(t,i){return(i-t)*this.next()+t}integer(t,i){return Math.floor((i-t+1)*this.next()+t)}bool(t=.5){return this.next()<=t}pickOne(t){return t[this.integer(0,t.length-1)]}pickSet(t,i,r=!1){return r?this._pickSetWithDuplicates(t,i):this._pickSetWithoutDuplicates(t,i)}_pickSetWithoutDuplicates(t,i){if(i>t.length||i<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(i===t.length)return t;const r=new Array(i);let a=0;const h=t.slice(0);for(;a<i;){const d=this.integer(0,h.length-1);r[a++]=h[d],h.splice(d,1)}return r}_pickSetWithDuplicates(t,i){if(i<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");const r=new Array(i);for(let a=0;a<i;a++)r[a]=this.pickOne(t);return r}shuffle(t){const i=t.slice(0);let r=null;for(let a=0;a<i.length-2;a++){const h=this.integer(a,i.length-1);r=i[a],i[a]=i[h],i[h]=r}return i}range(t,i,r){const a=new Array(t);for(let h=0;h<t;h++)a[h]=this.integer(i,r);return a}d4(){return this.integer(1,4)}d6(){return this.integer(1,6)}d8(){return this.integer(1,8)}d10(){return this.integer(1,10)}d12(){return this.integer(1,12)}d20(){return this.integer(1,20)}}const D=Math.PI*2;function F(u){return u>=0?u-Math.floor(u):u-Math.ceil(u)}function O(u){return u===0?0:u<0?-1:1}function L(u,t,i){return Math.min(Math.max(t,u),i)}function P(u){let t=u;if(u>D)for(;t>D;)t-=D;if(u<0)for(;t<0;)t+=D;return t}function A(u){return 180/Math.PI*u}function I(u){return u/180*Math.PI}const H=(u,t)=>Array.from(new Array(t-u+1),(i,r)=>r+u);function j(u,t,i=new T){return i?i.floating(u,t):u+Math.random()*(t-u)}function Z(u,t,i=new T){return i?i.integer(u,t):Math.round(j(u,t))}class E{static get Zero(){return new E(0,0)}static get One(){return new E(1,1)}static get Half(){return new E(.5,.5)}static get Up(){return new E(0,-1)}static get Down(){return new E(0,1)}static get Left(){return new E(-1,0)}static get Right(){return new E(1,0)}static fromAngle(t){return new E(Math.cos(t),Math.sin(t))}static isValid(t){return!(t==null||isNaN(t.x)||isNaN(t.y)||t.x===1/0||t.y===1/0||t.x===-1/0||t.y===-1/0)}static distance(t,i){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}static min(t,i){return new E(Math.min(t.x,i.x),Math.min(t.y,i.y))}static max(t,i){return new E(Math.max(t.x,i.x),Math.max(t.y,i.y))}constructor(t,i){this._x=0,this._y=0,this._x=t,this._y=i}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}setTo(t,i){this.x=t,this.y=i}equals(t,i=E.EQUALS_EPSILON){return Math.abs(this.x-t.x)<=i&&Math.abs(this.y-t.y)<=i}distance(t){if(!t)return Math.sqrt(this.x*this.x+this.y*this.y);const i=this.x-t.x,r=this.y-t.y;return Math.sqrt(i*i+r*r)}squareDistance(t){t||(t=E.Zero);const i=this.x-t.x,r=this.y-t.y;return i*i+r*r}clampMagnitude(t){const i=this.size,r=L(i,0,t);return this.size=r,this}get size(){return this.distance()}set size(t){const i=this.normalize().scale(t);this.setTo(i.x,i.y)}normalize(){const t=this.distance();return t>0?new E(this.x/t,this.y/t):new E(0,1)}average(t){return this.add(t).scale(.5)}scale(t,i){const r=i||new E(0,0);return t instanceof E?(r.x=this.x*t.x,r.y=this.y*t.y):(r.x=this.x*t,r.y=this.y*t),r}add(t,i){return i?(i.x=this.x+t.x,i.y=this.y+t.y,i):new E(this.x+t.x,this.y+t.y)}sub(t){return new E(this.x-t.x,this.y-t.y)}addEqual(t){return this.setTo(this.x+t.x,this.y+t.y),this}subEqual(t){return this.setTo(this.x-t.x,this.y-t.y),this}scaleEqual(t){return this.setTo(this.x*t,this.y*t),this}dot(t){return this.x*t.x+this.y*t.y}cross(t){if(t instanceof E)return this.x*t.y-this.y*t.x;if(typeof t=="number")return new E(t*this.y,-t*this.x)}static cross(t,i){return new E(-t*i.y,t*i.x)}perpendicular(){return new E(this.y,-this.x)}normal(){return this.perpendicular().normalize()}negate(){return this.scale(-1)}toAngle(){return P(Math.atan2(this.y,this.x))}rotate(t,i){i||(i=new E(0,0));const r=Math.sin(t),a=Math.cos(t),h=a*(this.x-i.x)-r*(this.y-i.y)+i.x,d=r*(this.x-i.x)+a*(this.y-i.y)+i.y;return new E(h,d)}clone(t){const i=t??new E(0,0);return i.x=this.x,i.y=this.y,i}toString(t){return t?`(${this.x.toFixed(t)}, ${this.y.toFixed(t)})`:`(${this.x}, ${this.y})`}}E.EQUALS_EPSILON=.001;function B(u,t){return new E(u,t)}class G{constructor(t,i,r,a){this.r=t,this.g=i,this.b=r,this.a=a??1}static fromRGB(t,i,r,a){return new G(t,i,r,a)}static fromRGBString(t){const i=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i;let r=null;if(r=t.match(i)){const a=parseInt(r[1],10),h=parseInt(r[2],10),d=parseInt(r[3],10);let p=1;return r[4]&&(p=parseFloat(r[4])),new G(a,h,d,p)}else throw new Error("Invalid rgb/a string: "+t)}static fromHex(t){const i=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;let r=null;if(r=t.match(i)){const a=parseInt(r[1],16),h=parseInt(r[2],16),d=parseInt(r[3],16);let p=1;return r[4]&&(p=parseInt(r[4],16)/255),new G(a,h,d,p)}else throw new Error("Invalid hex string: "+t)}static fromHSL(t,i,r,a=1){return new nt(t,i,r,a).toRGBA()}lighten(t=.1){const i=nt.fromRGBA(this.r,this.g,this.b,this.a);return i.l+=(1-i.l)*t,i.toRGBA()}darken(t=.1){const i=nt.fromRGBA(this.r,this.g,this.b,this.a);return i.l-=i.l*t,i.toRGBA()}saturate(t=.1){const i=nt.fromRGBA(this.r,this.g,this.b,this.a);return i.s+=i.s*t,i.toRGBA()}desaturate(t=.1){const i=nt.fromRGBA(this.r,this.g,this.b,this.a);return i.s-=i.s*t,i.toRGBA()}multiply(t){const i=t.r/255*this.r/255*255,r=t.g/255*this.g/255*255,a=t.b/255*this.b/255*255,h=t.a*this.a;return new G(i,r,a,h)}screen(t){const i=t.invert(),r=t.invert();return i.multiply(r).invert()}invert(){return new G(255-this.r,255-this.g,255-this.b,1-this.a)}average(t){const i=(t.r+this.r)/2,r=(t.g+this.g)/2,a=(t.b+this.b)/2,h=(t.a+this.a)/2;return new G(i,r,a,h)}equal(t){return this.toString()===t.toString()}toString(t="rgb"){switch(t){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}_componentToHex(t){const i=Math.max(Math.round(t),0).toString(16);return i.length===1?"0"+i:i}toHex(){let t="#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b);return this.a!==1&&(t+=this._componentToHex(this.a*255)),t}toRGBA(){const t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return this.a!==void 0||this.a!==null?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}toHSLA(){return nt.fromRGBA(this.r,this.g,this.b,this.a).toString()}fillStyle(){return this.toString()}clone(){return new G(this.r,this.g,this.b,this.a)}static get Black(){return G.fromHex("#000000")}static get White(){return G.fromHex("#FFFFFF")}static get Gray(){return G.fromHex("#808080")}static get LightGray(){return G.fromHex("#D3D3D3")}static get DarkGray(){return G.fromHex("#A9A9A9")}static get Yellow(){return G.fromHex("#FFFF00")}static get Orange(){return G.fromHex("#FFA500")}static get Red(){return G.fromHex("#FF0000")}static get Vermilion(){return G.fromHex("#FF5B31")}static get Rose(){return G.fromHex("#FF007F")}static get Magenta(){return G.fromHex("#FF00FF")}static get Violet(){return G.fromHex("#7F00FF")}static get Blue(){return G.fromHex("#0000FF")}static get Azure(){return G.fromHex("#007FFF")}static get Cyan(){return G.fromHex("#00FFFF")}static get Viridian(){return G.fromHex("#59978F")}static get Green(){return G.fromHex("#00FF00")}static get Chartreuse(){return G.fromHex("#7FFF00")}static get Transparent(){return G.fromHex("#FFFFFF00")}static get ExcaliburBlue(){return G.fromHex("#176BAA")}}class nt{constructor(t,i,r,a){this.h=t,this.s=i,this.l=r,this.a=a}static hue2rgb(t,i,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(i-t)*6*r:r<1/2?i:r<2/3?t+(i-t)*(2/3-r)*6:t}static fromRGBA(t,i,r,a){t/=255,i/=255,r/=255;const h=Math.max(t,i,r),d=Math.min(t,i,r);let p,m;const y=(h+d)/2;if(h===d)p=m=0;else{const w=h-d;switch(m=y>.5?w/(2-h-d):w/(h+d),h){case t:p=(i-r)/w+(i<r?6:0);break;case i:p=(r-t)/w+2;break;case r:p=(t-i)/w+4;break}p/=6}return new nt(p,m,y,a)}toRGBA(){let t,i,r;if(this.s===0)t=i=r=this.l;else{const a=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,h=2*this.l-a;t=nt.hue2rgb(h,a,this.h+1/3),i=nt.hue2rgb(h,a,this.h),r=nt.hue2rgb(h,a,this.h-1/3)}return new G(t*255,i*255,r*255,this.a)}toString(){const t=this.h.toFixed(0),i=this.s.toFixed(0),r=this.l.toFixed(0),a=this.a.toFixed(0);return`hsla(${t}, ${i}, ${r}, ${a})`}}var at;(function(u){u[u.Debug=0]="Debug",u[u.Info=1]="Info",u[u.Warn=2]="Warn",u[u.Error=3]="Error",u[u.Fatal=4]="Fatal"})(at||(at={}));class J{constructor(){if(this._appenders=[],this.defaultLevel=at.Info,this._logOnceSet=new Set,J._INSTANCE)throw new Error("Logger is a singleton");return J._INSTANCE=this,J._INSTANCE.addAppender(new Gt),J._INSTANCE}static getInstance(){return J._INSTANCE==null&&(J._INSTANCE=new J),J._INSTANCE}addAppender(t){this._appenders.push(t)}clearAppenders(){this._appenders.length=0}_log(t,i){t==null&&(t=this.defaultLevel);const r=this._appenders.length;for(let a=0;a<r;a++)t>=this.defaultLevel&&this._appenders[a].log(t,i)}_logOnce(t,i){const r=t+i.join("+");this._logOnceSet.has(r)||(this._logOnceSet.add(r),this._log(t,i))}debug(...t){this._log(at.Debug,t)}debugOnce(...t){this._logOnce(at.Debug,t)}info(...t){this._log(at.Info,t)}infoOnce(...t){this._logOnce(at.Info,t)}warn(...t){this._log(at.Warn,t)}warnOnce(...t){this._logOnce(at.Warn,t)}error(...t){this._log(at.Error,t)}errorOnce(...t){this._logOnce(at.Error,t)}fatal(...t){this._log(at.Fatal,t)}fatalOnce(...t){this._logOnce(at.Fatal,t)}}J._INSTANCE=null;class Gt{log(t,i){if(!console&&!console.log&&console.warn&&console.error)return;const r=[];r.unshift.apply(r,i),r.unshift("["+at[t]+"] : "),t<at.Warn?console.log.apply?console.log.apply(console,r):console.log(r.join(" ")):t<at.Error?console.warn.apply?console.warn.apply(console,r):console.warn(r.join(" ")):console.error.apply?console.error.apply(console,r):console.error(r.join(" "))}}class Jt{constructor(t){var i,r;this._messages=[],this._pos=10,this._color=G.Black,this._options=t,this.canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.zIndex=(r=(i=t.zIndex)===null||i===void 0?void 0:i.toString())!==null&&r!==void 0?r:"99",document.body.appendChild(this.canvas),this._positionScreenAppenderCanvas(),t.engine.screen.events.on("resize",()=>{this._positionScreenAppenderCanvas()})}_positionScreenAppenderCanvas(){var t,i,r,a;const h=this._options;this.canvas.width=(t=h.width)!==null&&t!==void 0?t:h.engine.screen.resolution.width,this.canvas.height=(i=h.height)!==null&&i!==void 0?i:h.engine.screen.resolution.height,this.canvas.style.position="absolute";const d=h.engine.screen.screenToPageCoordinates(B(0,0));this.canvas.style.left=d.x+"px",this.canvas.style.top=d.y+"px",this._pos=(r=h.xPos)!==null&&r!==void 0?r:this._pos,this._color=(a=h.color)!==null&&a!==void 0?a:this._color}log(t,i){const r=i.join(",");this._ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this._messages.unshift("["+at[t]+"] : "+r);let a=10;this._messages=this._messages.slice(0,1e3);for(let h=0;h<this._messages.length;h++)this._ctx.fillStyle=this._color.toRGBA(),this._ctx.fillText(this._messages[h],this._pos,a),a+=10}}var vt;(function(u){u.None="None",u.Top="Top",u.Bottom="Bottom",u.Left="Left",u.Right="Right"})(vt||(vt={})),function(u){function t(r){return r===u.Top?u.Bottom:r===u.Bottom?u.Top:r===u.Left?u.Right:r===u.Right?u.Left:u.None}u.getOpposite=t;function i(r){const a=[E.Left,E.Right,E.Up,E.Down],h=[u.Left,u.Right,u.Top,u.Bottom];let d=-Number.MAX_VALUE,p=-1;for(let m=0;m<a.length;m++)a[m].dot(r)>d&&(d=a[m].dot(r),p=m);return h[p]}u.fromDirection=i}(vt||(vt={}));class et{constructor(t=0,i=0,r=0,a=0){this._points=[],typeof t=="object"?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):typeof t=="number"&&(this.left=t,this.top=i,this.right=r,this.bottom=a)}clone(){return new et(this.left,this.top,this.right,this.bottom)}static getSideFromIntersection(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?vt.Right:vt.Left:t.y<0?vt.Bottom:vt.Top:vt.None}static fromPoints(t){let i=1/0,r=1/0,a=-1/0,h=-1/0;for(let d=0;d<t.length;d++)t[d].x<i&&(i=t[d].x),t[d].x>a&&(a=t[d].x),t[d].y<r&&(r=t[d].y),t[d].y>h&&(h=t[d].y);return new et(i,r,a,h)}static fromDimension(t,i,r=E.Half,a=E.Zero){return new et(-t*r.x+a.x,-i*r.y+a.y,t-t*r.x+a.x,i-i*r.y+a.y)}get width(){return this.right-this.left}get height(){return this.bottom-this.top}hasZeroDimensions(){return this.width===0||this.height===0}get center(){return new E((this.left+this.right)/2,(this.top+this.bottom)/2)}get topLeft(){return new E(this.left,this.top)}get bottomRight(){return new E(this.right,this.bottom)}get topRight(){return new E(this.right,this.top)}get bottomLeft(){return new E(this.left,this.bottom)}translate(t){return new et(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)}rotate(t,i=E.Zero){const r=this.getPoints().map(a=>a.rotate(t,i));return et.fromPoints(r)}scale(t,i=E.Zero){const r=this.translate(i);return new et(r.left*t.x,r.top*t.y,r.right*t.x,r.bottom*t.y)}transform(t){const i=t.data[0]*this.left,r=t.data[1]*this.left,a=t.data[0]*this.right,h=t.data[1]*this.right,d=t.data[2]*this.top,p=t.data[3]*this.top,m=t.data[2]*this.bottom,y=t.data[3]*this.bottom,w=t.getPosition(),b=Math.min(i,a)+Math.min(d,m)+w.x,R=Math.min(r,h)+Math.min(p,y)+w.y,k=Math.max(i,a)+Math.max(d,m)+w.x,M=Math.max(r,h)+Math.max(p,y)+w.y;return new et({left:b,top:R,right:k,bottom:M})}getPerimeter(){const t=this.width,i=this.height;return 2*(t+i)}getPoints(){return(this._left!==this.left||this._right!==this.right||this._top!==this.top||this._bottom!==this.bottom)&&(this._points.length=0,this._points.push(new E(this.left,this.top)),this._points.push(new E(this.right,this.top)),this._points.push(new E(this.right,this.bottom)),this._points.push(new E(this.left,this.bottom)),this._left=this.left,this._right=this.right,this._top=this.top,this._bottom=this.bottom),this._points}rayCast(t,i=1/0){let r=-1/0,a=1/0;const h=t.dir.x===0?Number.MAX_VALUE:1/t.dir.x,d=t.dir.y===0?Number.MAX_VALUE:1/t.dir.y,p=(this.left-t.pos.x)*h,m=(this.right-t.pos.x)*h;r=Math.min(p,m),a=Math.max(p,m);const y=(this.top-t.pos.y)*d,w=(this.bottom-t.pos.y)*d;return r=Math.max(r,Math.min(y,w)),a=Math.min(a,Math.max(y,w)),a>=Math.max(0,r)&&r<i}rayCastTime(t,i=1/0){let r=-1/0,a=1/0;const h=t.dir.x===0?Number.MAX_VALUE:1/t.dir.x,d=t.dir.y===0?Number.MAX_VALUE:1/t.dir.y,p=(this.left-t.pos.x)*h,m=(this.right-t.pos.x)*h;r=Math.min(p,m),a=Math.max(p,m);const y=(this.top-t.pos.y)*d,w=(this.bottom-t.pos.y)*d;return r=Math.max(r,Math.min(y,w)),a=Math.min(a,Math.max(y,w)),a>=Math.max(0,r)&&r<i?r:-1}contains(t){return t instanceof E?this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x:t instanceof et?this.left<=t.left&&this.top<=t.top&&t.bottom<=this.bottom&&t.right<=this.right:!1}combine(t){return new et(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom))}get dimensions(){return new E(this.width,this.height)}overlaps(t,i){const r=i||0;if(t.hasZeroDimensions())return this.contains(t);if(this.hasZeroDimensions())return t.contains(this);const a=this.combine(t);return a.width+r<t.width+this.width&&a.height+r<t.height+this.height}intersect(t){const i=this.combine(t);if(i.width<t.width+this.width&&i.height<t.height+this.height&&!i.dimensions.equals(t.dimensions)&&!i.dimensions.equals(this.dimensions)){let r=0;this.right>=t.left&&this.right<=t.right?r=t.left-this.right:r=t.right-this.left;let a=0;return this.top<=t.bottom&&this.top>=t.top?a=t.bottom-this.top:a=t.top-this.bottom,Math.abs(r)<Math.abs(a)?new E(r,0):new E(0,a)}else if(i.dimensions.equals(t.dimensions)||i.dimensions.equals(this.dimensions)){let r=0;this.width-t.width>=0?this.right-t.right<=t.left-this.left?r=t.left-this.right:r=t.right-this.left:t.right-this.right<=this.left-t.left?r=this.left-t.right:r=this.right-t.left;let a=0;return this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?a=t.top-this.bottom:a=t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?a=this.top-t.bottom:a=this.bottom-t.top,Math.abs(r)<Math.abs(a)?new E(r,0):new E(0,a)}else return null}intersectWithSide(t){const i=this.intersect(t);return et.getSideFromIntersection(i)}draw(t,i=G.Yellow){t.debug.drawRect(this.left,this.top,this.width,this.height,{color:i})}}function gi(u){if(u){const t=u.getBoundingClientRect();return B(t.x+window.scrollX,t.y+window.scrollY)}return E.Zero}function st(u,t){return t.indexOf(u)===-1?(t.push(u),!0):!1}function lt(u,t){let i=-1;return(i=t.indexOf(u))>-1?(t.splice(i,1),!0):!1}function dt(u,t){for(let i=0;i<u.length;i++)if(u[i]===t)return!0;return!1}function Et(u){throw new Error(u)}function Tt(u,t){var i;const r=new _;return((i=t==null?void 0:t.schedule.bind(t))!==null&&i!==void 0?i:setTimeout)(()=>{r.resolve()},u),r.promise}function Hi(u,t){const i={};for(const r in u)t.includes(r)||(i[r]=u[r]);return i}var Ye;(function(u){u[u.X=12]="X",u[u.Y=13]="Y"})(Ye||(Ye={}));class Qt{constructor(){this.data=new Float32Array(16),this._scaleX=1,this._scaleSignX=1,this._scaleY=1,this._scaleSignY=1}static ortho(t,i,r,a,h,d){const p=new Qt;return p.data[0]=2/(i-t),p.data[1]=0,p.data[2]=0,p.data[3]=0,p.data[4]=0,p.data[5]=2/(a-r),p.data[6]=0,p.data[7]=0,p.data[8]=0,p.data[9]=0,p.data[10]=-2/(d-h),p.data[11]=0,p.data[12]=-(i+t)/(i-t),p.data[13]=-(a+r)/(a-r),p.data[14]=-(d+h)/(d-h),p.data[15]=1,p}clone(t){const i=t||new Qt;return i.data[0]=this.data[0],i.data[1]=this.data[1],i.data[2]=this.data[2],i.data[3]=this.data[3],i.data[4]=this.data[4],i.data[5]=this.data[5],i.data[6]=this.data[6],i.data[7]=this.data[7],i.data[8]=this.data[8],i.data[9]=this.data[9],i.data[10]=this.data[10],i.data[11]=this.data[11],i.data[12]=this.data[12],i.data[13]=this.data[13],i.data[14]=this.data[14],i.data[15]=this.data[15],i}toDOMMatrix(){return new DOMMatrix([...this.data])}static fromFloat32Array(t){const i=new Qt;return i.data=t,i}static identity(){const t=new Qt;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}static translation(t,i){const r=Qt.identity();return r.data[12]=t,r.data[13]=i,r}static scale(t,i){const r=Qt.identity();return r.data[0]=t,r.data[5]=i,r.data[10]=1,r.data[15]=1,r}static rotation(t){const i=Qt.identity();return i.data[0]=Math.cos(t),i.data[4]=-Math.sin(t),i.data[1]=Math.sin(t),i.data[5]=Math.cos(t),i}multiply(t,i){if(t instanceof E){const r=i||new E(0,0),a=t,h=a.x*this.data[0]+a.y*this.data[4]+this.data[12],d=a.x*this.data[1]+a.y*this.data[5]+this.data[13];return r.x=h,r.y=d,r}else{const r=i||new Qt,a=t,h=this.data[0],d=this.data[1],p=this.data[2],m=this.data[3],y=this.data[4],w=this.data[5],b=this.data[6],R=this.data[7],k=this.data[8],M=this.data[9],z=this.data[10],X=this.data[11],N=this.data[12],U=this.data[13],$=this.data[14],W=this.data[15],tt=a.data[0],pt=a.data[1],Q=a.data[2],gt=a.data[3],Lt=a.data[4],he=a.data[5],Ue=a.data[6],ze=a.data[7],He=a.data[8],Ie=a.data[9],me=a.data[10],_e=a.data[11],ot=a.data[12],Ys=a.data[13],Qs=a.data[14],qs=a.data[15];r.data[0]=h*tt+y*pt+k*Q+N*gt,r.data[1]=d*tt+w*pt+M*Q+U*gt,r.data[2]=p*tt+b*pt+z*Q+$*gt,r.data[3]=m*tt+R*pt+X*Q+W*gt,r.data[4]=h*Lt+y*he+k*Ue+N*ze,r.data[5]=d*Lt+w*he+M*Ue+U*ze,r.data[6]=p*Lt+b*he+z*Ue+$*ze,r.data[7]=m*Lt+R*he+X*Ue+W*ze,r.data[8]=h*He+y*Ie+k*me+N*_e,r.data[9]=d*He+w*Ie+M*me+U*_e,r.data[10]=p*He+b*Ie+z*me+$*_e,r.data[11]=m*He+R*Ie+X*me+W*_e,r.data[12]=h*ot+y*Ys+k*Qs+N*qs,r.data[13]=d*ot+w*Ys+M*Qs+U*qs,r.data[14]=p*ot+b*Ys+z*Qs+$*qs,r.data[15]=m*ot+R*Ys+X*Qs+W*qs;const Mn=this.getScale();return r._scaleSignX=O(Mn.x)*O(r._scaleSignX),r._scaleSignY=O(Mn.y)*O(r._scaleSignY),r}}translate(t,i){const r=this.data[0],a=this.data[1],h=this.data[2],d=this.data[3],p=this.data[4],m=this.data[5],y=this.data[6],w=this.data[7],b=this.data[8],R=this.data[9],k=this.data[10],M=this.data[11],z=this.data[12],X=this.data[13],N=this.data[14],U=this.data[15],$=0,W=1;return this.data[12]=r*t+p*i+b*$+z*W,this.data[13]=a*t+m*i+R*$+X*W,this.data[14]=h*t+y*i+k*$+N*W,this.data[15]=d*t+w*i+M*$+U*W,this}setPosition(t,i){this.data[12]=t,this.data[13]=i}getPosition(){return B(this.data[12],this.data[13])}rotate(t){const i=this.data[0],r=this.data[1],a=this.data[2],h=this.data[3],d=this.data[4],p=this.data[5],m=this.data[6],y=this.data[7],w=Math.sin(t),b=Math.cos(t);return this.data[0]=b*i+w*d,this.data[1]=b*r+w*p,this.data[2]=b*a+w*m,this.data[3]=b*h+w*y,this.data[4]=b*d-w*i,this.data[5]=b*p-w*r,this.data[6]=b*m-w*a,this.data[7]=b*y-w*h,this}scale(t,i){const r=this.data[0],a=this.data[1],h=this.data[2],d=this.data[3],p=this.data[4],m=this.data[5],y=this.data[6],w=this.data[7];return this.data[0]=r*t,this.data[1]=a*t,this.data[2]=h*t,this.data[3]=d*t,this.data[4]=p*i,this.data[5]=m*i,this.data[6]=y*i,this.data[7]=w*i,this}setRotation(t){const i=this.getScale(),r=Math.sin(t),a=Math.cos(t);this.data[0]=a*i.x,this.data[1]=r*i.y,this.data[4]=-r*i.x,this.data[5]=a*i.y}getRotation(){const t=Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX());return P(t)}getScaleX(){const t=B(this.data[0],this.data[4]).size;return this._scaleSignX*t}getScaleY(){const t=B(this.data[1],this.data[5]).size;return this._scaleSignY*t}getScale(){return B(this.getScaleX(),this.getScaleY())}setScaleX(t){if(this._scaleX===t)return;this._scaleSignX=O(t);const i=B(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=i.x*t,this.data[4]=i.y*t,this._scaleX=t}setScaleY(t){if(this._scaleY===t)return;this._scaleSignY=O(t);const i=B(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=i.x*t,this.data[5]=i.y*t,this._scaleY=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}getBasisDeterminant(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}getAffineInverse(t){const r=1/this.getBasisDeterminant(),a=this.data[0],h=this.data[4],d=this.data[1],p=this.data[5],m=t||Qt.identity();m.data[0]=p*r,m.data[1]=-d*r,m.data[4]=-h*r,m.data[5]=a*r;const y=this.data[12],w=this.data[13];return m.data[12]=-(y*m.data[0]+w*m.data[4]),m.data[13]=-(y*m.data[1]+w*m.data[5]),m}isIdentity(){return this.data[0]===1&&this.data[1]===0&&this.data[2]===0&&this.data[3]===0&&this.data[4]===0&&this.data[5]===1&&this.data[6]===0&&this.data[7]===0&&this.data[8]===0&&this.data[9]===0&&this.data[10]===1&&this.data[11]===0&&this.data[12]===0&&this.data[13]===0&&this.data[14]===0&&this.data[15]===1}toString(){return`
[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]
[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]
[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]
[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]
`}}class xt{constructor(){this.data=new Float64Array(6),this._scale=new Float64Array([1,1]),this._scaleSignX=1,this._scaleSignY=1}toDOMMatrix(){return new DOMMatrix([...this.data])}static identity(){const t=new xt;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}static translation(t,i){const r=xt.identity();return r.data[4]=t,r.data[5]=i,r}static scale(t,i){const r=xt.identity();return r.data[0]=t,r.data[3]=i,r._scale[0]=t,r._scale[1]=i,r}static rotation(t){const i=xt.identity();return i.data[0]=Math.cos(t),i.data[1]=Math.sin(t),i.data[2]=-Math.sin(t),i.data[3]=Math.cos(t),i}setPosition(t,i){this.data[4]=t,this.data[5]=i}getPosition(){return B(this.data[4],this.data[5])}rotate(t){const i=this.data[0],r=this.data[1],a=this.data[2],h=this.data[3],d=Math.sin(t),p=Math.cos(t);return this.data[0]=p*i+d*a,this.data[1]=p*r+d*h,this.data[2]=p*a-d*i,this.data[3]=p*h-d*r,this}translate(t,i){const r=this.data[0],a=this.data[1],h=this.data[2],d=this.data[3],p=this.data[4],m=this.data[5];return this.data[4]=r*t+h*i+p,this.data[5]=a*t+d*i+m,this}scale(t,i){const r=this.data[0],a=this.data[1],h=this.data[2],d=this.data[3];return this.data[0]=r*t,this.data[1]=a*t,this.data[2]=h*i,this.data[3]=d*i,this._scale[0]=t,this._scale[1]=i,this}determinant(){return this.data[0]*this.data[3]-this.data[1]*this.data[2]}inverse(t){const r=1/this.determinant(),a=this.data[0],h=this.data[2],d=this.data[1],p=this.data[3],m=t||xt.identity();m.data[0]=p*r,m.data[1]=-d*r,m.data[2]=-h*r,m.data[3]=a*r;const y=this.data[4],w=this.data[5];return m.data[4]=-(y*m.data[0]+w*m.data[2]),m.data[5]=-(y*m.data[1]+w*m.data[3]),m}multiply(t,i){if(t instanceof E){const r=i||new E(0,0),a=t,h=a.x*this.data[0]+a.y*this.data[2]+this.data[4],d=a.x*this.data[1]+a.y*this.data[3]+this.data[5];return r.x=h,r.y=d,r}else{const r=i||new xt,a=t,h=this.data[0],d=this.data[1],p=this.data[2],m=this.data[3],y=this.data[4],w=this.data[5],b=a.data[0],R=a.data[1],k=a.data[2],M=a.data[3],z=a.data[4],X=a.data[5];r.data[0]=h*b+p*R,r.data[1]=d*b+m*R,r.data[2]=h*k+p*M,r.data[3]=d*k+m*M,r.data[4]=h*z+p*X+y,r.data[5]=d*z+m*X+w;const N=this.getScale();return r._scaleSignX=O(N.x)*O(r._scaleSignX),r._scaleSignY=O(N.y)*O(r._scaleSignY),r}}multiplyQuadInPlace(t){const i=t[0]*this.data[0]+t[1]*this.data[2]+this.data[4],r=t[0]*this.data[1]+t[1]*this.data[3]+this.data[5];t[0]=i,t[1]=r;const a=t[2]*this.data[0]+t[3]*this.data[2]+this.data[4],h=t[2]*this.data[1]+t[3]*this.data[3]+this.data[5];t[2]=a,t[3]=h;const d=t[4]*this.data[0]+t[5]*this.data[2]+this.data[4],p=t[4]*this.data[1]+t[5]*this.data[3]+this.data[5];t[4]=d,t[5]=p;const m=t[6]*this.data[0]+t[7]*this.data[2]+this.data[4],y=t[6]*this.data[1]+t[7]*this.data[3]+this.data[5];t[6]=m,t[7]=y}to4x4(){const t=new Qt;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=0,t.data[3]=0,t.data[4]=this.data[2],t.data[5]=this.data[3],t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=this.data[4],t.data[13]=this.data[5],t.data[14]=0,t.data[15]=1,t}setRotation(t){const i=this.getScale(),r=Math.sin(t),a=Math.cos(t);this.data[0]=a*i.x,this.data[1]=r*i.y,this.data[2]=-r*i.x,this.data[3]=a*i.y}getRotation(){const t=Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX());return P(t)}getScaleX(){const t=B(this.data[0],this.data[2]).distance();return this._scaleSignX*t}getScaleY(){const t=B(this.data[1],this.data[3]).distance();return this._scaleSignY*t}getScale(){return B(this.getScaleX(),this.getScaleY())}setScaleX(t){if(t===this._scale[0])return;this._scaleSignX=O(t);const i=B(this.data[0]*this._scaleSignX,this.data[2]*this._scaleSignX).normalize();this.data[0]=i.x*t,this.data[2]=i.y*t,this._scale[0]=t}setScaleY(t){if(t===this._scale[1])return;this._scaleSignY=O(t);const i=B(this.data[1]*this._scaleSignY,this.data[3]*this._scaleSignY).normalize();this.data[1]=i.x*t,this.data[3]=i.y*t,this._scale[1]=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}isIdentity(){return this.data[0]===1&&this.data[1]===0&&this.data[2]===0&&this.data[3]===1&&this.data[4]===0&&this.data[5]===0}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}clone(t){const i=t||new xt;return i.data.set(this.data),i}toString(){return`
[${this.data[0]} ${this.data[2]} ${this.data[4]}]
[${this.data[1]} ${this.data[3]} ${this.data[5]}]
[0 0 1]
`}}class ji{constructor(){this._transforms=[],this._currentTransform=xt.identity()}save(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}restore(){this._currentTransform=this._transforms.pop()}translate(t,i){return this._currentTransform.translate(t,i)}rotate(t){return this._currentTransform.rotate(t)}scale(t,i){return this._currentTransform.scale(t,i)}set current(t){this._currentTransform=t}get current(){return this._currentTransform}}class gr{constructor(){this.current=this._getDefaultState(),this._states=[]}_getDefaultState(){return{opacity:1,z:0,tint:G.White,material:null}}_cloneState(){return{opacity:this.current.opacity,z:this.current.z,tint:this.current.tint.clone(),material:this.current.material}}save(){this._states.push(this.current),this.current=this._cloneState()}restore(){this.current=this._states.pop()}}const bt={Complete:"complete",Load:"load",LoadStart:"loadstart",Progress:"progress",Error:"error"};class Ft{constructor(t,i,r=!1){this.path=t,this.responseType=i,this.bustCache=r,this.data=null,this.logger=J.getInstance(),this.events=new v}isLoaded(){return this.data!==null}_cacheBust(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}load(){return new Promise((t,i)=>{if(this.data!==null){this.logger.debug("Already have data for resource",this.path),this.events.emit("complete",this.data),t(this.data);return}const r=new XMLHttpRequest;r.open("GET",this.bustCache?this._cacheBust(this.path):this.path,!0),r.responseType=this.responseType,r.addEventListener("loadstart",a=>this.events.emit("loadstart",a)),r.addEventListener("progress",a=>this.events.emit("progress",a)),r.addEventListener("error",a=>this.events.emit("error",a)),r.addEventListener("load",a=>this.events.emit("load",a)),r.addEventListener("load",()=>{if(r.status!==0&&r.status!==200){this.logger.error("Failed to load resource ",this.path," server responded with error code",r.status),this.events.emit("error",r.response),i(new Error(r.statusText));return}this.data=r.response,this.events.emit("complete",this.data),this.logger.debug("Completed loading resource",this.path),t(this.data)}),r.send()})}}function Xt(u,t){return u&&(u.__isProxy===void 0?new Proxy(u,{set:(i,r,a)=>(i[r]!==a&&(i[r]=a,typeof r=="string"&&r[0]!=="_"&&t(i)),!0),get:(i,r)=>r!=="__isProxy"?i[r]:!0}):u)}const mr=(u=[],t,i)=>({get:(r,a)=>a==="__isProxy"?!0:typeof r[a]=="object"&&r[a]!=null?new Proxy(r[a],mr([...u,a],t,i)):r[a],set:(r,a,h)=>(typeof a=="string"&&a[0]!=="_"&&t(i),r[a]=h,!0)});function Hl(u,t){return u&&(u.__isProxy===void 0?new Proxy(u,mr([],t,u)):u)}function _r(u,t){return u&&(u.__isProxy===void 0?new Proxy(u,{set:(i,r,a)=>(i[r]=a,typeof r=="string"&&r[0]!=="_"&&t(i),!0),get:(i,r)=>r!=="__isProxy"?i[r]:!0}):u)}class zt{isStale(){return this._transformStale}get flipHorizontal(){return this._flipHorizontal}set flipHorizontal(t){this._flipHorizontal=t,this._transformStale=!0}get flipVertical(){return this._flipVertical}set flipVertical(t){this._flipVertical=t,this._transformStale=!0}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._transformStale=!0}get scale(){return this._scale}set scale(t){this._scale=Xt(t,()=>{this._transformStale=!0}),this._transformStale=!0}get origin(){return this._origin}set origin(t){this._origin=Xt(t,()=>{this._transformStale=!0}),this._transformStale=!0}constructor(t){var i,r,a,h,d,p,m;this.id=zt._ID++,this.transform=xt.identity(),this.tint=null,this._transformStale=!0,this.showDebug=!1,this._flipHorizontal=!1,this._flipVertical=!1,this._rotation=0,this.opacity=1,this._scale=E.One,this._origin=null,this._width=0,this._height=0,t&&(this.origin=(i=t.origin)!==null&&i!==void 0?i:this.origin,this.flipHorizontal=(r=t.flipHorizontal)!==null&&r!==void 0?r:this.flipHorizontal,this.flipVertical=(a=t.flipVertical)!==null&&a!==void 0?a:this.flipVertical,this.rotation=(h=t.rotation)!==null&&h!==void 0?h:this.rotation,this.opacity=(d=t.opacity)!==null&&d!==void 0?d:this.opacity,this.scale=(p=t.scale)!==null&&p!==void 0?p:this.scale,this.tint=(m=t.tint)!==null&&m!==void 0?m:this.tint)}cloneGraphicOptions(){return{width:this.width/this.scale.x,height:this.height/this.scale.y,origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null,tint:this.tint?this.tint.clone():null}}get width(){return Math.abs(this._width*this.scale.x)}get height(){return Math.abs(this._height*this.scale.y)}set width(t){this._width=t,this._transformStale=!0}set height(t){this._height=t,this._transformStale=!0}get localBounds(){return et.fromDimension(this.width,this.height,E.Zero)}draw(t,i,r){this._preDraw(t,i,r),this._drawImage(t,0,0),this._postDraw(t)}_preDraw(t,i,r){t.save(),t.translate(i,r),this._transformStale&&(this.transform.reset(),this.transform.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(this.transform),this._flip(this.transform),this._transformStale=!1),t.multiply(this.transform),t.opacity=t.opacity*this.opacity,this.tint&&(t.tint=this.tint)}_rotate(t){var i;const r=this.scale.x>0?1:-1,a=this.scale.y>0?1:-1,h=(i=this.origin)!==null&&i!==void 0?i:B(this.width/2,this.height/2);t.translate(h.x,h.y),t.rotate(this.rotation),t.scale(r,a),t.translate(-h.x,-h.y)}_flip(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}_postDraw(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}zt._ID=0;class ks extends zt{static from(t){return new ks({image:t})}constructor(t){var i,r;super(t),this._logger=J.getInstance(),this._dirty=!0,this.image=t.image;const{width:a,height:h}=t;this.sourceView=(i=t.sourceView)!==null&&i!==void 0?i:{x:0,y:0,width:a??0,height:h??0},this.destSize=(r=t.destSize)!==null&&r!==void 0?r:{width:a??0,height:h??0},this._updateSpriteDimensions(),this.image.ready.then(()=>{this._updateSpriteDimensions()})}get width(){return Math.abs(this.destSize.width*this.scale.x)}get height(){return Math.abs(this.destSize.height*this.scale.y)}set width(t){t/=Math.abs(this.scale.x),this.destSize.width=t,super.width=Math.ceil(this.destSize.width)}set height(t){t/=Math.abs(this.scale.y),this.destSize.height=t,super.height=Math.ceil(this.destSize.height)}_updateSpriteDimensions(){var t,i,r,a,h,d;const{width:p,height:m}=this.image;this.sourceView.width=((t=this.sourceView)===null||t===void 0?void 0:t.width)||p,this.sourceView.height=((i=this.sourceView)===null||i===void 0?void 0:i.height)||m,this.destSize.width=((r=this.destSize)===null||r===void 0?void 0:r.width)||((a=this.sourceView)===null||a===void 0?void 0:a.width)||p,this.destSize.height=((h=this.destSize)===null||h===void 0?void 0:h.height)||((d=this.sourceView)===null||d===void 0?void 0:d.height)||m,this.width=Math.ceil(this.destSize.width)*this.scale.x,this.height=Math.ceil(this.destSize.height)*this.scale.y}_preDraw(t,i,r){this.image.isLoaded()&&this._dirty&&(this._dirty=!1,this._updateSpriteDimensions()),super._preDraw(t,i,r)}_drawImage(t,i,r){this.image.isLoaded()?t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,i,r,this.destSize.width,this.destSize.height):this._logger.warnOnce(`ImageSource ${this.image.path} is not yet loaded and won't be drawn. Please call .load() or include in a Loader.

Read https://excaliburjs.com/docs/imagesource for more information.`)}clone(){return new ks({image:this.image,sourceView:{...this.sourceView},destSize:{...this.destSize},...this.cloneGraphicOptions()})}}var qt;(function(u){u.Pixel="Pixel",u.Blended="Blended"})(qt||(qt={}));function Fo(u){switch(u){case qt.Pixel:return qt.Pixel;case qt.Blended:return qt.Blended;default:return null}}var Ht;(function(u){u.Clamp="Clamp",u.Repeat="Repeat",u.Mirror="Mirror"})(Ht||(Ht={}));function Fs(u){switch(u){case Ht.Clamp:return Ht.Clamp;case Ht.Repeat:return Ht.Repeat;case Ht.Mirror:return Ht.Mirror;default:return Ht.Clamp}}class Zt{constructor(t){this._textureMap=new Map,this._gl=t,Zt._MAX_TEXTURE_SIZE=t.getParameter(t.MAX_TEXTURE_SIZE)}dispose(){for(const[t]of this._textureMap)this.delete(t);this._textureMap.clear(),this._gl=null}get(t){return this._textureMap.get(t)}has(t){return this._textureMap.has(t)}load(t,i,r=!1){const a=this._gl;if(!a)return null;const{filtering:h,wrapping:d}={...i};let p=null;if(this.has(t)&&(p=this.get(t)),p)return r&&(a.bindTexture(a.TEXTURE_2D,p),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,t)),p;p=a.createTexture(),Zt.checkImageSizeSupportedAndLog(t),a.bindTexture(a.TEXTURE_2D,p),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);let m;d&&(typeof d=="string"?m={x:d,y:d}:m={x:d.x,y:d.y});const{x:y,y:w}=m??Zt.wrapping;switch(y){case Ht.Clamp:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);break;case Ht.Repeat:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT);break;case Ht.Mirror:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.MIRRORED_REPEAT);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE)}switch(w){case Ht.Clamp:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);break;case Ht.Repeat:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT);break;case Ht.Mirror:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.MIRRORED_REPEAT);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)}const b=h??Zt.filtering;return a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,b===qt.Pixel?a.NEAREST:a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,b===qt.Pixel?a.NEAREST:a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,t),this._textureMap.set(t,p),p}delete(t){const i=this._gl;if(!i)return null;let r=null;this.has(t)&&(r=this.get(t),i.deleteTexture(r))}static checkImageSizeSupportedAndLog(t){var i;const r=(i=t.dataset.originalSrc)!==null&&i!==void 0?i:"internal canvas bitmap";return t.width>Zt._MAX_TEXTURE_SIZE||t.height>Zt._MAX_TEXTURE_SIZE?(Zt._LOGGER.error(`The image [${r}] provided to Excalibur is too large for the device's maximum texture size of (${Zt._MAX_TEXTURE_SIZE}x${Zt._MAX_TEXTURE_SIZE}) please resize to an image for excalibur to render properly.

Images will likely render as black rectangles.

Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!1):((t.width>4096||t.height>4096)&&Zt._LOGGER.warn(`The image [${r}] provided to excalibur is too large may not work on all mobile devices, it is recommended you resize images to a maximum (4096x4096).

Images will likely render as black rectangles on some mobile platforms.

Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!0)}}Zt._LOGGER=J.getInstance(),Zt.filtering=qt.Blended,Zt.wrapping={x:Ht.Clamp,y:Ht.Clamp},Zt._MAX_TEXTURE_SIZE=4096;const te={Filtering:"filtering",WrappingX:"wrapping-x",WrappingY:"wrapping-y"};class _n{get width(){return this.image.naturalWidth}get height(){return this.image.naturalHeight}isLoaded(){return this._src||(this._src=this.data.src),!!this._src}get image(){return this.data}constructor(t,i,r){this._logger=J.getInstance(),this.data=new Image,this._readyFuture=new _,this.ready=this._readyFuture.promise,this.path=t;let a=!1,h;typeof i=="boolean"?a=i:{filtering:r,wrapping:h,bustCache:a}={...i},this._resource=new Ft(t,"blob",a),this.filtering=r??this.filtering,typeof h=="string"?this.wrapping={x:h,y:h}:this.wrapping=h??this.wrapping,(t.endsWith(".svg")||t.endsWith(".gif"))&&this._logger.warn(`Image type is not fully supported, you may have mixed results ${t}. Fully supported: jpg, bmp, and png`)}static fromHtmlImageElement(t,i){const r=new _n("");if(r._src="image-element",r.data=t,r.data.setAttribute("data-original-src","image-element"),i!=null&&i.filtering?r.data.setAttribute(te.Filtering,i==null?void 0:i.filtering):r.data.setAttribute(te.Filtering,qt.Blended),i!=null&&i.wrapping){let a;typeof i.wrapping=="string"?a={x:i.wrapping,y:i.wrapping}:a={x:i.wrapping.x,y:i.wrapping.y},r.data.setAttribute(te.WrappingX,a.x),r.data.setAttribute(te.WrappingY,a.y)}else r.data.setAttribute(te.WrappingX,Ht.Clamp),r.data.setAttribute(te.WrappingY,Ht.Clamp);return Zt.checkImageSizeSupportedAndLog(t),r._readyFuture.resolve(t),r}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){var t,i,r,a;if(this.isLoaded())return this.data;try{let h;if(this.path.includes("data:image/"))h=this.path;else{const m=await this._resource.load();h=URL.createObjectURL(m)}const d=new Image,p=new _;d.onload=()=>p.resolve(),d.src=h,d.setAttribute("data-original-src",this.path),await p.promise,this.data=d,Zt.checkImageSizeSupportedAndLog(this.data)}catch(h){throw`Error loading ImageSource from path '${this.path}' with error [${h.message}]`}return this.data.setAttribute(te.Filtering,this.filtering),this.data.setAttribute(te.WrappingX,(i=(t=this.wrapping)===null||t===void 0?void 0:t.x)!==null&&i!==void 0?i:Ht.Clamp),this.data.setAttribute(te.WrappingY,(a=(r=this.wrapping)===null||r===void 0?void 0:r.y)!==null&&a!==void 0?a:Ht.Clamp),this._readyFuture.resolve(this.data),this.data}toSprite(){return ks.from(this)}unload(){this.data=new Image}}class Bo extends zt{constructor(t){super(t),this._text="",this.alphabet="",this.shadow=null,this.caseInsensitive=!1,this.spacing=0,this.lineHeight=void 0,this._logger=J.getInstance();const{alphabet:i,spriteSheet:r,caseInsensitive:a,spacing:h,shadow:d,lineHeight:p}=t;this.alphabet=i,this.spriteSheet=r,this.caseInsensitive=a??this.caseInsensitive,this.spacing=h??this.spacing,this.shadow=d??this.shadow,this.lineHeight=p??this.lineHeight}_getCharacterSprites(t){const i=[],r=this.caseInsensitive?t.toLocaleLowerCase():t,a=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet;for(let h=0;h<r.length;h++){const d=r[h];let p=a.indexOf(d);p===-1&&(p=0,this._logger.warnOnce(`SpriteFont - Cannot find letter '${d}' in configured alphabet '${a}'.`),this._logger.warnOnce("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."));const m=this.spriteSheet.sprites[p];m?i.push(m):(this._logger.warnOnce(`SpriteFont - Cannot find sprite for '${d}' at index '${p}' in configured SpriteSheet`),this._logger.warnOnce("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."))}return i}measureText(t,i){const r=this._getLinesFromText(t,i),a=r.reduce((m,y)=>m.length>y.length?m:y),h=this._getCharacterSprites(a);let d=0,p=0;for(const m of h)d+=m.width+this.spacing,p=Math.max(p,m.height);return et.fromDimension(d,p*r.length,E.Zero)}_drawImage(t,i,r,a){var h;let d=0,p=0,m=0;const y=this._getLinesFromText(this._text,a);for(const w of y){for(const b of this._getCharacterSprites(w))b.draw(t,i+d,r+p),d+=b.width+this.spacing,m=Math.max(m,b.height);d=0,p+=(h=this.lineHeight)!==null&&h!==void 0?h:m}}render(t,i,r,a,h,d){this._text=i;const p=this.measureText(i,d);this.width=p.width,this.height=p.height,this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this._preDraw(t,a,h),this._drawImage(t,0,0,d),this._postDraw(t),t.restore()),this._preDraw(t,a,h),this._drawImage(t,0,0,d),this._postDraw(t)}clone(){return new Bo({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}_getLinesFromText(t,i){if(this._cachedText===t&&this._cachedRenderWidth===i)return this._cachedLines;const r=t.split(`
`);if(i==null)return r;for(let a=0;a<r.length;a++){let h=r[a],d="";if(this.measureText(h).width>i){for(;this.measureText(h).width>i;)d=h[h.length-1]+d,h=h.slice(0,-1);r[a]=h,r[a+1]=d}}return this._cachedText=t,this._cachedLines=r,this._cachedRenderWidth=i,r}}class Bs{constructor(t){this.sprites=[];const{sprites:i,rows:r,columns:a}=t;this.sprites=i,this.rows=r??1,this.columns=a??this.sprites.length}getSprite(t,i,r){var a,h,d,p,m,y,w,b,R;if(t>=this.columns||t<0)throw Error(`No sprite exists in the SpriteSheet at (${t}, ${i}), x: ${t} should be between 0 and ${this.columns-1}`);if(i>=this.rows||i<0)throw Error(`No sprite exists in the SpriteSheet at (${t}, ${i}), y: ${i} should be between 0 and ${this.rows-1}`);const k=t+i*this.columns,M=this.sprites[k];if(M){if(r){const z=M.clone();return z.flipHorizontal=(a=r.flipHorizontal)!==null&&a!==void 0?a:z.flipHorizontal,z.flipVertical=(h=r.flipVertical)!==null&&h!==void 0?h:z.flipVertical,z.width=(d=r.width)!==null&&d!==void 0?d:z.width,z.height=(p=r.height)!==null&&p!==void 0?p:z.height,z.rotation=(m=r.rotation)!==null&&m!==void 0?m:z.rotation,z.scale=(y=r.scale)!==null&&y!==void 0?y:z.scale,z.opacity=(w=r.opacity)!==null&&w!==void 0?w:z.opacity,z.tint=(b=r.tint)!==null&&b!==void 0?b:z.tint,z.origin=(R=r.origin)!==null&&R!==void 0?R:z.origin,z}return M}throw Error(`Invalid sprite coordinates (${t}, ${i}`)}static fromImageSourceWithSourceViews(t){const i=t.sourceViews.map(r=>new ks({image:t.image,sourceView:r}));return new Bs({sprites:i})}static fromImageSource(t){var i;const r=[];t.spacing=(i=t.spacing)!==null&&i!==void 0?i:{};const{image:a,grid:{rows:h,columns:d,spriteWidth:p,spriteHeight:m},spacing:{originOffset:y,margin:w}}=t,b={x:0,y:0,...y},R={x:0,y:0,...w};for(let k=0;k<d;k++)for(let M=0;M<h;M++)r[k+M*d]=new ks({image:a,sourceView:{x:k*p+R.x*k+b.x,y:M*m+R.y*M+b.y,width:p,height:m},destSize:{height:m,width:p}});return new Bs({sprites:r,rows:h,columns:d})}clone(){return new Bs({sprites:this.sprites.map(t=>t.clone()),rows:this.rows,columns:this.columns})}}const u0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAYAAAD1Xam+AAAAAXNSR0IArs4c6QAABlFJREFUeJztndmy4yoMRcWt/v9fdr8EWoDAaDD4JntVpeqcxBrMIGQDNhEAAAAAAAAAAAAAAOCrSbMfr+u6yoEpTY+906GV57YtPkjyXj9WZZ+wHWHfo2N3/bU6Tte9Rv6ptruqRyMvKvvIX/zY3I/vjLeqsg6l/CWdp0KHKO/1Y1H2EdsR9j06Ntdfp+N03SvkH2u7i3pu5XkQ+DNTkgNJSok+/183xpcdWZHjgUzpQ2pGD67vaf//KRAGAq3tdhCy2tcMQKPyXyz7iPqrdBjbX5h9g7xbtvWf4ZJvM4D/BKG24Sd+IkQ0TC9aW5NM5FbO2HgrPVzW2vmN50DZNv/QWtl5bfPy85SBtdy9dFmjsf2F2SehTBVE+u+tkE5+lAGcJlFwGuodwRRU2Qe3rx0FhPNflc3HWC7BEh8EDGVR5IMCiLnDONtPp87qhxVH/S/LvzUAuDs/kyGimA5oSONKR1w8vsLpv+v+S9vhmS71JRiX1xB5CWZNw7m6rMrllMag/RJyWb67BEgpDVMWSydc+K47pr35w05kWd7ReEq6116KaG4CsbJ7OmV9PdZLEKkONiC1/7ZONVgDsajLIJPYp2OUAXRpnPcGmnIE6eSK4nv5YQqqSYO52JqnYfYj/PdQXQIY7XszuMofMgZRT/1LdeC5h2I5/0EdWDMY2Yb05WDE1RodVdpSA5r85slArAVnSf+89iP896St0f5bZKVA7Gk/3ja8q+152/+wrLqBWZTem3IBADbRBoDuHgAA4HdAAADgh0EAAOCHQQAA4IdBAADgh0EAAOCHuVsKbJ3P9M7jjuxHzGfv8j9iDt47Dx7hP8cjq5F/o/0T62Aer//ZOgDrajBp6aNlOWTEajKLjgj/Pcs/vfZD/a++3Pc8hNfZ966EVeh5vP75luDRJUAl0KzJfnopaqbaTuzZiulc2BS5lltFXntu3dcQsXadl59Wn1H+dfYNtrt2d6D/LDF9HkCQw6eXFbr8P9X5W/un5Ol8gz1t39p5pWOPn0vLynbgdnfe8maEQw+UIPJdfxdOd/4oTtVD0IYg8wDywGas0I04T5O3P8/qf2UWwPpkn1PbOT1bN2tFe59EM7TvKf+TRFw+erZ2ey4hpS3hp9qBkqq/tjsSU1OYqucBWB1yynt5QxC42Mdk30pAEIio//zRG3feBzLUX+TTjCKwlH83aI/KbpQBVEHgUGF0j/SitcLofHem8q6AyH0wBhFv4WszuOjy0yK2vc/oRWQoP2X9ve78jfaLnpncbBqQSC6s0HnIRT0a2yNZjfxT8+ir8t+yDsDTWaS6X70GP33+d77stp+I5HtBdwEAAPBl8ECApcAA/DBvfSowAGAB7/05ZAAA/DAIAADMMU3fOuS2ggAAwBjrorKoxWiPBxHMAgAg490Ts0VeePdA+ZfJDKcCh7sBqY88mmjklZeOt9iXPrvx2I2QPRnN2/qzyJ84h4gNcbtfasq5mM1rZr+bBWh2A+bIIX13Z9wqL+nQvFno7v3oq4tJItCed7isUT6C/I7BUn9KP95wDicYBYpcjncrO2c/dmW4tBtw4RiRld1IDxDyYsoXMHxF1w3dyz0Nne8033AOFsT6VgRCafl89fenTZUfbm8CGhrgdDcS7anAsvnkkP0IeCfQ+JzYunky6jhNYj5bl7++4fJvN9WDSKS/292A0wyANyKDI91bfkm3kcH7ckaP/SKW/VHKRZAcI14pP3beu0fPyn/DuZQbWMogNnsc16sziE96f7H/iai7uTf0/3N8lwFz/e13T00Djt4OrInCnkeChXT+qOcKOLA21tJpsv/G8/COnGnw97J9QwbTvd6djYSv7fxEVTuV/LzNhj7nOawv6bfbAGCYEpQ6HxFtuxs6sq9tzOYHobQ6Nje+6vo5BwFrPZ4OgMayS4PPt1NlzdLfbRCYBoBc+NaO4JWPwLEf33oN3unY3InKPQBW6Z7nEZzEmrl4iZjC804lqgePPEOguQcwWghUphxm343wyt/pWpWR0OrR+jvyxavHajfb9pTjbt9bH07Z5/expM4TLWfwb7QQqMoC+UDWXZo/4RgA38LOgUvLJAAQ1Td9y9//0ylxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB+g79apuVUsS5ZmwAAAABJRU5ErkJggg==";class jl{constructor(){this.fontSheet=u0,this.size=16,this.load()}load(){return this._imageSource=new _n(this.fontSheet),this._imageSource.load().then(()=>{this._spriteSheet=Bs.fromImageSource({image:this._imageSource,grid:{rows:4,columns:16,spriteWidth:16,spriteHeight:16}}),this._spriteFont=new Bo({alphabet:`0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&."?-()+# `,caseInsensitive:!0,spriteSheet:this._spriteSheet,spacing:-6})})}write(t,i,r){this._imageSource.isLoaded()&&this._spriteFont.render(t,i,null,r.x,r.y)}}class d0{constructor(t,i){this._gl=t,this._texture=i}use(){const t=this._gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._texture)}disable(){const t=this._gl;t.bindTexture(t.TEXTURE_2D,null)}}class Mo{constructor(t){var i,r;this.antialias=!1,this.samples=1,this._gl=t.gl,this.width=t.width,this.height=t.height,this.transparency=t.transparency,this.antialias=(i=t.antialias)!==null&&i!==void 0?i:this.antialias,this.samples=(r=t.samples)!==null&&r!==void 0?r:this._gl.getParameter(this._gl.MAX_SAMPLES);const a=this._gl;a.drawingBufferFormat?this.bufferFormat=a.drawingBufferFormat:this.transparency?this.bufferFormat=a.RGBA8:this.bufferFormat=a.RGB8,this._setupRenderBuffer(),this._setupFramebuffer()}setResolution(t,i){const r=this._gl;this.width=t,this.height=i,r.bindTexture(r.TEXTURE_2D,this._frameTexture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),this._renderBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,this._renderBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,Math.min(this.samples,r.getParameter(r.MAX_SAMPLES)),this.bufferFormat,this.width,this.height))}get renderBuffer(){return this._renderBuffer}get renderFrameBuffer(){return this._renderFrameBuffer}get frameBuffer(){return this._frameBuffer}get frameTexture(){return this._frameTexture}_setupRenderBuffer(){if(this.antialias){const t=this._gl;this._renderBuffer=t.createRenderbuffer(),this._renderFrameBuffer=t.createFramebuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this._renderBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,Math.min(this.samples,t.getParameter(t.MAX_SAMPLES)),this.bufferFormat,this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,this._renderFrameBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,this._renderBuffer)}}_setupFramebuffer(){const t=this._gl;this._frameTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._frameTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const i=t.COLOR_ATTACHMENT0;this._frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,i,t.TEXTURE_2D,this._frameTexture,0),this.disable()}toRenderSource(){return this.renderBuffer&&this.blitRenderBufferToFrameBuffer(),new d0(this._gl,this._frameTexture)}blitToScreen(){const t=this._gl;this._renderBuffer?(t.bindFramebuffer(t.READ_FRAMEBUFFER,this.renderFrameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.clearBufferfv(t.COLOR,0,[0,0,1,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.LINEAR)):(t.bindFramebuffer(t.READ_FRAMEBUFFER,this.frameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.clearBufferfv(t.COLOR,0,[0,0,1,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.LINEAR))}blitRenderBufferToFrameBuffer(){if(this._renderBuffer){const t=this._gl;t.bindFramebuffer(t.READ_FRAMEBUFFER,this.renderFrameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.frameBuffer),t.clearBufferfv(t.COLOR,0,[0,0,1,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.LINEAR)}}copyToTexture(t){const i=this._gl;this._renderBuffer&&this.blitRenderBufferToFrameBuffer(),i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.bindTexture(i.TEXTURE_2D,t),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,this.width,this.height,0)}use(){const t=this._gl;this.antialias?t.bindFramebuffer(t.FRAMEBUFFER,this._renderFrameBuffer):t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.viewport(0,0,this.width,this.height)}disable(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null)}}const f0=`#version 300 es\r
in vec2 a_position;\r
in vec4 a_color;\r
\r
out lowp vec4 v_color;\r
\r
uniform mat4 u_matrix;\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Passthrough the color\r
   v_color = a_color;\r
}`,p0=`#version 300 es\r
precision mediump float;\r
\r
// Color\r
in lowp vec4 v_color;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  fragColor = v_color;\r
}`;function Wl(u,t){switch(t){case u.FLOAT:return 4;case u.SHORT:return 2;case u.UNSIGNED_SHORT:return 2;case u.BYTE:return 1;case u.UNSIGNED_BYTE:return 1;default:return 1}}function Bd(u,t){const i=`(?<type>[a-z0-9]+)\\s+${t};`,a=new RegExp(i,"g").exec(u);return(a==null?void 0:a.length)>0}function Md(u,t,i){var r;const a=`(?<type>[a-z0-9]+)\\s+${i};`,d=new RegExp(a,"g").exec(t);switch((r=d==null?void 0:d.groups)===null||r===void 0?void 0:r.type){case"float":case"vec2":case"vec3":case"vec4":return u.FLOAT;case"int":case"ivec2":case"ivec3":case"ivec4":return u.INT;case"uint":case"uvec2":case"uvec3":case"uvec4":return u.UNSIGNED_INT;case"bool":case"bvec2":case"bvec3":case"bvec4":return u.BOOL;case"short":return u.SHORT;case"ushort":return u.UNSIGNED_SHORT;case"ubyte":return u.UNSIGNED_BYTE;case"byte":return u.BYTE;default:return u.FLOAT}}function Ld(u,t){switch(t){case u.LOW_FLOAT:case u.HIGH_FLOAT:case u.FLOAT:return 1;case u.FLOAT_VEC2:return 2;case u.FLOAT_VEC3:return 3;case u.FLOAT_VEC4:return 4;case u.BYTE:return 1;case u.UNSIGNED_BYTE:return 1;case u.UNSIGNED_SHORT:case u.SHORT:return 1;default:return 1}}function Od(u,t){switch(t){case u.LOW_FLOAT:case u.HIGH_FLOAT:case u.FLOAT:case u.FLOAT_VEC2:case u.FLOAT_VEC3:case u.FLOAT_VEC4:return u.FLOAT;case u.BYTE:return u.BYTE;case u.UNSIGNED_BYTE:return u.UNSIGNED_BYTE;case u.SHORT:return u.SHORT;case u.UNSIGNED_SHORT:return u.UNSIGNED_SHORT;default:return u.FLOAT}}class Qe{get compiled(){return this._compiled}constructor(t){this._logger=J.getInstance(),this.uniforms={},this.attributes={},this._compiled=!1;const{gl:i,vertexSource:r,fragmentSource:a}=t;this._gl=i,this.vertexSource=r,this.fragmentSource=a}dispose(){this._gl.deleteProgram(this.program),this._gl=null}use(){this._gl.useProgram(this.program),Qe._ACTIVE_SHADER_INSTANCE=this}isCurrentlyBound(){return Qe._ACTIVE_SHADER_INSTANCE===this}compile(){const t=this._gl,i=this._compileShader(t,this.vertexSource,t.VERTEX_SHADER),r=this._compileShader(t,this.fragmentSource,t.FRAGMENT_SHADER);this.program=this._createProgram(t,i,r);const a=this.getAttributes();for(const d of a)this.attributes[d.name]=d;const h=this.getUniforms();for(const d of h)this.uniforms[d.name]=d;return this._compiled=!0,this.program}getUniforms(){const t=this._gl,i=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),r=[];for(let a=0;a<i;a++){const h=t.getActiveUniform(this.program,a),d=t.getUniformLocation(this.program,h.name);r.push({name:h.name,glType:h.type,location:d})}return r}getAttributes(){const t=this._gl,i=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),r=[];for(let a=0;a<i;a++){const h=t.getActiveAttrib(this.program,a),d=t.getAttribLocation(this.program,h.name);r.push({name:h.name,glType:Od(t,h.type),size:Ld(t,h.type),location:d,normalized:!1})}return r}setTexture(t,i){const r=this._gl;r.activeTexture(r.TEXTURE0+t),r.bindTexture(r.TEXTURE_2D,i)}setUniformInt(t,i){this.setUniform("uniform1i",t,~~i)}trySetUniformInt(t,i){return this.trySetUniform("uniform1i",t,~~i)}setUniformIntArray(t,i){this.setUniform("uniform1iv",t,i)}trySetUniformIntArray(t,i){return this.trySetUniform("uniform1iv",t,i)}setUniformBoolean(t,i){this.setUniform("uniform1i",t,i?1:0)}trySetUniformBoolean(t,i){return this.trySetUniform("uniform1i",t,i?1:0)}setUniformFloat(t,i){this.setUniform("uniform1f",t,i)}trySetUniformFloat(t,i){return this.trySetUniform("uniform1f",t,i)}setUniformFloatArray(t,i){this.setUniform("uniform1fv",t,i)}trySetUniformFloatArray(t,i){return this.trySetUniform("uniform1fv",t,i)}setUniformFloatVector(t,i){this.setUniform("uniform2f",t,i.x,i.y)}trySetUniformFloatVector(t,i){return this.trySetUniform("uniform2f",t,i.x,i.y)}setUniformFloatColor(t,i){this.setUniform("uniform4f",t,i.r/255,i.g/255,i.b/255,i.a)}trySetUniformFloatColor(t,i){return this.trySetUniform("uniform4f",t,i.r/255,i.g/255,i.b/255,i.a)}setUniformMatrix(t,i){this.setUniform("uniformMatrix4fv",t,!1,i.data)}trySetUniformMatrix(t,i){return this.trySetUniform("uniformMatrix4fv",t,!1,i.data)}setUniform(t,i,...r){if(!this._compiled)throw Error(`Must compile shader before setting a uniform ${t}:${i}`);if(!this.isCurrentlyBound())throw Error("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms");const h=this._gl.getUniformLocation(this.program,i);if(h){const d=[h,...r];this._gl[t].apply(this._gl,d)}else throw Error(`Uniform ${t}:${i} doesn't exist or is not used in the shader source code, unused uniforms are optimized away by most browsers`)}trySetUniform(t,i,...r){if(!this._compiled)return this._logger.warn(`Must compile shader before setting a uniform ${t}:${i}`),!1;if(!this.isCurrentlyBound())return this._logger.warn("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms"),!1;const h=this._gl.getUniformLocation(this.program,i);if(h){const d=[h,...r];this._gl[t].apply(this._gl,d)}else return!1;return!0}_createProgram(t,i,r){const a=t.createProgram();if(a===null)throw Error("Could not create graphics shader program");if(t.attachShader(a,i),t.attachShader(a,r),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw Error(`Could not link the program: [${t.getProgramInfoLog(a)}]`);return a}_compileShader(t,i,r){const a=t.VERTEX_SHADER===r?"vertex":"fragment",h=t.createShader(r);if(h===null)throw Error(`Could not build shader: [${i}]`);if(t.shaderSource(h,i),t.compileShader(h),!t.getShaderParameter(h,t.COMPILE_STATUS)){const p=t.getShaderInfoLog(h);throw Error(`Could not compile ${a} shader:

${p}${this._processSourceForError(i,p)}`)}return h}_processSourceForError(t,i){if(!t)return i;const r=t.split(`
`),a=i.search(/\d:\d/),h=i.indexOf(" ",a),[d,p]=i.slice(a,h).split(":").map(m=>Number(m));for(let m=0;m<r.length;m++)r[m]=`${m+1}: ${r[m]}${p===m+1?" <----- ERROR!":""}`;return`

Source:
`+r.join(`
`)}}Qe._ACTIVE_SHADER_INSTANCE=null;class Wi{constructor(t){this.type="dynamic";const{gl:i,size:r,type:a,data:h}=t;if(this._gl=i,this.buffer=this._gl.createBuffer(),!h&&!r)throw Error("Must either provide data or a size to the VertexBuffer");h?this.bufferData=h:this.bufferData=new Float32Array(r),this.type=a??this.type,i.bindBuffer(i.ARRAY_BUFFER,this.buffer),i.bufferData(i.ARRAY_BUFFER,this.bufferData,this.type==="static"?i.STATIC_DRAW:i.DYNAMIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}unbind(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,null)}upload(t){const i=this._gl;i.bindBuffer(i.ARRAY_BUFFER,this.buffer),t?i.bufferSubData(i.ARRAY_BUFFER,0,this.bufferData,0,t):i.bufferData(i.ARRAY_BUFFER,this.bufferData,this.type==="static"?i.STATIC_DRAW:i.DYNAMIC_DRAW)}dispose(){this._gl.deleteBuffer(this.buffer),this._gl=null}}class Vi{get vertexBuffer(){return this._vertexBuffer}get attributes(){return this._attributes}constructor(t){this._logger=J.getInstance(),this._suppressWarnings=!1,this._layout=[],this._attributes=[],this._vertexTotalSizeBytes=0,this._initialized=!1;const{gl:i,shader:r,vertexBuffer:a,attributes:h,suppressWarnings:d}=t;this._gl=i,this._vertexBuffer=a,this._attributes=h,this._shader=r,this._suppressWarnings=d,r&&this.initialize()}get totalVertexSizeBytes(){return this._vertexTotalSizeBytes}set shader(t){t&&this._shader!==t&&(this._shader=t,this.initialize())}get shader(){return this._shader}initialize(){if(this._initialized||!this._shader)return;if(!this._shader.compiled)throw Error("Shader not compiled, shader must be compiled before defining a vertex layout");this._vertexTotalSizeBytes=0,this._layout.length=0;const t=this._shader.attributes;for(const h of this._attributes){const d=t[h[0]];if(!d){if(!Bd(this._shader.vertexSource,h[0]))throw Error(`The attribute named: ${h[0]} size ${h[1]} not found in the shader source code:
 ${this._shader.vertexSource}`);this._suppressWarnings||this._logger.warn(`The attribute named: ${h[0]} size ${h[1]} not found in the compiled shader. This is possibly a bug:
 1. Not a bug, but should remove unused code - attribute "${h[0]}" is unused in vertex/fragment and has been automatically removed by glsl compiler.
 2. Definitely a bug, attribute "${h[0]}" in layout has been mistyped or is missing in shader, check vertex/fragment source.`);const p=Md(this._gl,this._shader.vertexSource,h[0]);this._layout.push({name:h[0],glType:p,size:h[1],location:-1,normalized:!1})}if(d){if(d.size!==h[1])throw Error(`VertexLayout size definition for attribute: [${h[0]}, ${h[1]}], doesn't match shader source size ${d.size}:
 ${this._shader.vertexSource}`);this._layout.push(d)}}let i=0;for(const h of this._layout){const d=Wl(this._gl,h.glType);this._vertexTotalSizeBytes+=d*h.size,i+=h.size}this._vertexBuffer.bufferData.length%i!==0&&this._logger.warn(`The vertex component size (${i})  does NOT divide evenly into the specified vertex buffer (${this._vertexBuffer.bufferData.length})`);const r=this._gl;this._vao=r.createVertexArray(),r.bindVertexArray(this._vao),this._vertexBuffer.bind();let a=0;for(const h of this._layout)h.location!==-1&&(r.vertexAttribPointer(h.location,h.size,h.glType,h.normalized,this.totalVertexSizeBytes,a),r.enableVertexAttribArray(h.location)),a+=Wl(r,h.glType)*h.size;r.bindVertexArray(null),this._vertexBuffer.unbind(),this._initialized=!0}use(t=!1,i){if(!this._shader)throw Error("No shader is associated with this vertex layout, a shader must be set");const r=this._gl;if(!this._shader.isCurrentlyBound())throw Error("Shader associated with this vertex layout is not active! Call shader.use() before layout.use()");this._vertexBuffer.bind(),t&&this._vertexBuffer.upload(i),r.bindVertexArray(this._vao)}}class Bt{static clear(){Bt.DrawCallCount=0,Bt.DrawnImagesCount=0}}Bt.DrawCallCount=0,Bt.DrawnImagesCount=0;class g0{constructor(){this.type="ex.line",this.priority=0,this._maxLines=10922,this._vertexIndex=0,this._lineCount=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new Qe({gl:t,vertexSource:f0,fragmentSource:p0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._vertexBuffer=new Wi({gl:t,size:6*2*this._maxLines,type:"dynamic"}),this._layout=new Vi({gl:t,vertexBuffer:this._vertexBuffer,shader:this._shader,attributes:[["a_position",2],["a_color",4]]})}dispose(){this._vertexBuffer.dispose(),this._shader.dispose(),this._context=null,this._gl=null}draw(t,i,r){this._isFull()&&this.flush(),this._lineCount++;const a=this._context.getTransform(),h=a.multiply(t),d=a.multiply(i),p=this._vertexBuffer.bufferData;p[this._vertexIndex++]=h.x,p[this._vertexIndex++]=h.y,p[this._vertexIndex++]=r.r/255,p[this._vertexIndex++]=r.g/255,p[this._vertexIndex++]=r.b/255,p[this._vertexIndex++]=r.a,p[this._vertexIndex++]=d.x,p[this._vertexIndex++]=d.y,p[this._vertexIndex++]=r.r/255,p[this._vertexIndex++]=r.g/255,p[this._vertexIndex++]=r.b/255,p[this._vertexIndex++]=r.a}_isFull(){return this._lineCount>=this._maxLines}hasPendingDraws(){return this._lineCount!==0}flush(){if(this._lineCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.LINES,0,this._lineCount*2),Bt.DrawnImagesCount+=this._lineCount,Bt.DrawCallCount++,this._vertexIndex=0,this._lineCount=0}}const m0=`#version 300 es\r
in vec2 a_position;\r
in vec4 a_color;\r
in float a_size;\r
out lowp vec4 v_color;\r
uniform mat4 u_matrix;\r
\r
void main() {\r
  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
  gl_PointSize = a_size * 2.0;\r
  v_color = a_color;\r
}`,_0=`#version 300 es\r
\r
precision mediump float;\r
in lowp vec4 v_color;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  float r = 0.0, delta = 0.0, alpha = 1.0;\r
  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r
  r = dot(cxy, cxy);\r
\r
  delta = fwidth(r);\r
  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r
  // "premultiply" the color by alpha\r
  vec4 color = v_color;\r
  color.a = color.a * alpha;\r
  color.rgb = color.rgb * color.a;\r
  fragColor = color;\r
}`;class v0{constructor(){this.type="ex.point",this.priority=0,this._maxPoints=10922,this._pointCount=0,this._vertexIndex=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new Qe({gl:t,vertexSource:m0,fragmentSource:_0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._buffer=new Wi({gl:t,size:7*this._maxPoints,type:"dynamic"}),this._layout=new Vi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_color",4],["a_size",1]]})}dispose(){this._buffer.dispose(),this._shader.dispose(),this._context=null,this._gl=null}draw(t,i,r){this._isFull()&&this.flush(),this._pointCount++;const a=this._context.getTransform(),h=this._context.opacity,d=this._context.snapToPixel,p=a.multiply(t);d&&(p.x=~~(p.x+_t),p.y=~~(p.y+_t));const m=this._buffer.bufferData;m[this._vertexIndex++]=p.x,m[this._vertexIndex++]=p.y,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a*h,m[this._vertexIndex++]=r*Math.max(a.getScaleX(),a.getScaleY())}_isFull(){return this._pointCount>=this._maxPoints}hasPendingDraws(){return this._pointCount!==0}flush(){if(this._pointCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.POINTS,0,this._pointCount),Bt.DrawnImagesCount+=this._pointCount,Bt.DrawCallCount++,this._pointCount=0,this._vertexIndex=0}}const y0=`#version 300 es\r
in vec2 a_position;\r
\r
in vec2 a_texcoord;\r
out vec2 v_texcoord;\r
\r
void main() {\r
  gl_Position = vec4(a_position, 0.0, 1.0);\r
\r
  // Pass the texcoord to the fragment shader.\r
  v_texcoord = a_texcoord;\r
}`,w0=`#version 300 es\r
precision mediump float;\r
\r
// Passed in from the vertex shader.\r
in vec2 v_texcoord;\r
\r
// The texture.\r
uniform sampler2D u_texture;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
   fragColor = texture(u_texture, v_texcoord);\r
}`;class x0{constructor(t){this._gl=t,this._shader=new Qe({gl:t,vertexSource:y0,fragmentSource:w0}),this._shader.compile(),this._buffer=new Wi({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new Vi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}renderWithPostProcessor(t){const i=this._gl;t.getShader().use(),t.getLayout().use(),i.drawArrays(i.TRIANGLES,0,6)}renderToScreen(){const t=this._gl;this._shader.use(),this._layout.use(),t.drawArrays(t.TRIANGLES,0,6)}}class vr{constructor(t,i,r){this._logger=J.getInstance(),this._gl=t,this.buffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer);const a=i*6;if(!r)this.bufferData=new Uint32Array(a);else{const p=Math.floor(16383.5);this.bufferGlType=t.UNSIGNED_SHORT,this.bufferData=new Uint16Array(a),i>p&&this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${p}) requested quads(${i})`)}let h=0;for(let d=0;d<a;d+=6)this.bufferData[d+0]=h+0,this.bufferData[d+1]=h+1,this.bufferData[d+2]=h+2,this.bufferData[d+3]=h+2,this.bufferData[d+4]=h+1,this.bufferData[d+5]=h+3,h+=4;t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}get size(){return this.bufferData.length}upload(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer)}dispose(){this._gl.deleteBuffer(this.buffer),this._gl=null}}const b0=`#version 300 es\r
precision mediump float;\r
\r
// UV coord\r
in vec2 v_texcoord;\r
\r
// Texture index\r
in lowp float v_textureIndex;\r
\r
// Textures in the current draw\r
uniform sampler2D u_textures[%%count%%];\r
\r
uniform bool u_pixelart;\r
\r
// Opacity\r
in float v_opacity;\r
\r
in vec4 v_tint;\r
\r
in vec2 v_res;\r
\r
out vec4 fragColor;\r
\r
// Inigo Quilez pixel art filter https://jorenjoestar.github.io/post/pixel_art_filtering/\r
vec2 uv_iq(in vec2 uv, in vec2 texture_size) {\r
  vec2 pixel = uv * texture_size;\r
  \r
  vec2 seam=floor(pixel+.5);\r
  vec2 dudv=fwidth(pixel);\r
  pixel=seam+clamp((pixel-seam)/dudv,-.5,.5);\r
  \r
  return pixel/texture_size;\r
}\r
\r
void main(){\r
  // In order to support the most efficient sprite batching, we have multiple\r
  // textures loaded into the gpu (usually 8) this picker logic skips over textures\r
  // that do not apply to a particular sprite.\r
  \r
  vec4 color=vec4(1.,0,0,1.);\r
  \r
  // GLSL is templated out to pick the right texture and set the vec4 color\r
  %%texture_picker%%\r
  \r
  color.rgb=color.rgb*v_opacity;\r
  color.a=color.a*v_opacity;\r
  fragColor=color*v_tint;\r
}`,C0=`#version 300 es\r
in vec2 a_position;\r
\r
// Opacity\r
in float a_opacity;\r
out float v_opacity;\r
\r
// UV coordinate\r
in vec2 a_texcoord;\r
out vec2 v_texcoord;\r
\r
// Texture res\r
in vec2 a_res;\r
out vec2 v_res;\r
\r
// Texture number\r
in lowp float a_textureIndex;\r
out lowp float v_textureIndex;\r
\r
in vec4 a_tint;\r
out vec4 v_tint;\r
\r
uniform mat4 u_matrix;\r
\r
void main(){\r
  // Set the vertex position using the ortho transform matrix\r
  gl_Position=u_matrix*vec4(a_position,0.,1.);\r
  \r
  // Pass through the Opacity to the fragment shader\r
  v_opacity=a_opacity;\r
  // Pass through the UV coord to the fragment shader\r
  v_texcoord=a_texcoord;\r
\r
  v_res = a_res;\r
\r
  // Pass through the texture number to the fragment shader\r
  v_textureIndex=a_textureIndex;\r
  // Pass through the tint\r
  v_tint=a_tint;\r
}`;class S0{constructor(t){this.type="ex.image",this.priority=0,this._maxImages=10922,this._maxTextures=0,this._imageCount=0,this._textures=[],this._textureIndex=0,this._textureToIndex=new Map,this._images=new Set,this._vertexIndex=0,this._imageToWidth=new Map,this._imageToHeight=new Map,this._view=[0,0,0,0],this._dest=[0,0],this._quad=[0,0,0,0,0,0,0,0],this.pixelArtSampler=t.pixelArtSampler,this.uvPadding=t.uvPadding}initialize(t,i){this._gl=t,this._context=i,this._maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),125);const r=this._transformFragmentSource(b0,this._maxTextures);this._shader=new Qe({gl:t,fragmentSource:r,vertexSource:C0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",i.ortho),this._shader.setUniformIntArray("u_textures",[...Array(this._maxTextures)].map((a,h)=>h)),this._buffer=new Wi({gl:t,size:12*4*this._maxImages,type:"dynamic"}),this._layout=new Vi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_opacity",1],["a_res",2],["a_texcoord",2],["a_textureIndex",1],["a_tint",4]]}),this._quads=new vr(t,this._maxImages,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._shader.dispose(),this._textures.length=0,this._context=null,this._gl=null}_transformFragmentSource(t,i){let r=t.replace("%%count%%",i.toString()),a="";for(let h=0;h<i;h++)h===0?a+=`if (v_textureIndex <= ${h}.5) {
`:a+=`   else if (v_textureIndex <= ${h}.5) {
`,a+=`      vec2 uv = u_pixelart ? uv_iq(v_texcoord, v_res) : v_texcoord;
`,a+=`      color = texture(u_textures[${h}], uv);
`,a+=`   }
`;return r=r.replace("%%texture_picker%%",a),r}_addImageAsTexture(t){if(this._images.has(t))return;const i=t.getAttribute(te.Filtering),r=i?Fo(i):null,a=Fs(t.getAttribute(te.WrappingX)),h=Fs(t.getAttribute(te.WrappingY)),d=t.getAttribute("forceUpload")==="true",p=this._context.textureLoader.load(t,{filtering:r,wrapping:{x:a,y:h}},d);t.removeAttribute("forceUpload"),this._textures.indexOf(p)===-1&&(this._textures.push(p),this._textureToIndex.set(p,this._textureIndex++),this._images.add(t))}_bindTextures(t){for(let i=0;i<this._maxTextures;i++)t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,this._textures[i]||this._textures[0])}_getTextureIdForImage(t){var i;if(t){const r=this._context.textureLoader.get(t);return(i=this._textureToIndex.get(r))!==null&&i!==void 0?i:-1}return-1}_isFull(){return this._imageCount>=this._maxImages||this._textures.length>=this._maxTextures}_getImageWidth(t){let i=this._imageToWidth.get(t);return i===void 0&&(i=t.width,this._imageToWidth.set(t,i)),i}_getImageHeight(t){let i=this._imageToHeight.get(t);return i===void 0&&(i=t.height,this._imageToHeight.set(t,i)),i}draw(t,i,r,a,h,d,p,m,y){var w,b,R,k;this._isFull()&&this.flush(),this._imageCount++,this._addImageAsTexture(t);const M=this._getImageWidth(t),z=this._getImageHeight(t);let X=M||a||0,N=z||h||0;this._view[0]=0,this._view[1]=0,this._view[2]=(w=a??M)!==null&&w!==void 0?w:0,this._view[3]=(b=h??z)!==null&&b!==void 0?b:0,this._dest[0]=i??1,this._dest[1]=r??1,d!==void 0&&p!==void 0&&m!==void 0&&y!==void 0&&(this._view[0]=i??1,this._view[1]=r??1,this._view[2]=(R=a??M)!==null&&R!==void 0?R:0,this._view[3]=(k=h??z)!==null&&k!==void 0?k:0,this._dest[0]=d,this._dest[1]=p,X=m,N=y),i=this._view[0],r=this._view[1];const U=this._view[2],$=this._view[3],W=this._context.getTransform(),tt=this._context.opacity,pt=this._context.snapToPixel;this._quad[0]=this._dest[0],this._quad[1]=this._dest[1],this._quad[2]=this._dest[0]+X,this._quad[3]=this._dest[1],this._quad[4]=this._dest[0],this._quad[5]=this._dest[1]+N,this._quad[6]=this._dest[0]+X,this._quad[7]=this._dest[1]+N,W.multiplyQuadInPlace(this._quad),pt&&(this._quad[0]=~~(this._quad[0]+O(this._quad[0])*_t),this._quad[1]=~~(this._quad[1]+O(this._quad[1])*_t),this._quad[2]=~~(this._quad[2]+O(this._quad[2])*_t),this._quad[3]=~~(this._quad[3]+O(this._quad[3])*_t),this._quad[4]=~~(this._quad[4]+O(this._quad[4])*_t),this._quad[5]=~~(this._quad[5]+O(this._quad[5])*_t),this._quad[6]=~~(this._quad[6]+O(this._quad[6])*_t),this._quad[7]=~~(this._quad[7]+O(this._quad[7])*_t));const Q=this._context.tint,gt=this._getTextureIdForImage(t),Lt=M||X,he=z||N,Ue=(i+this.uvPadding)/Lt,ze=(r+this.uvPadding)/he,He=(i+U-this.uvPadding)/Lt,Ie=(r+$-this.uvPadding)/he,me=M,_e=z,ot=this._layout.vertexBuffer.bufferData;ot[this._vertexIndex++]=this._quad[0],ot[this._vertexIndex++]=this._quad[1],ot[this._vertexIndex++]=tt,ot[this._vertexIndex++]=me,ot[this._vertexIndex++]=_e,ot[this._vertexIndex++]=Ue,ot[this._vertexIndex++]=ze,ot[this._vertexIndex++]=gt,ot[this._vertexIndex++]=Q.r/255,ot[this._vertexIndex++]=Q.g/255,ot[this._vertexIndex++]=Q.b/255,ot[this._vertexIndex++]=Q.a,ot[this._vertexIndex++]=this._quad[4],ot[this._vertexIndex++]=this._quad[5],ot[this._vertexIndex++]=tt,ot[this._vertexIndex++]=me,ot[this._vertexIndex++]=_e,ot[this._vertexIndex++]=Ue,ot[this._vertexIndex++]=Ie,ot[this._vertexIndex++]=gt,ot[this._vertexIndex++]=Q.r/255,ot[this._vertexIndex++]=Q.g/255,ot[this._vertexIndex++]=Q.b/255,ot[this._vertexIndex++]=Q.a,ot[this._vertexIndex++]=this._quad[2],ot[this._vertexIndex++]=this._quad[3],ot[this._vertexIndex++]=tt,ot[this._vertexIndex++]=me,ot[this._vertexIndex++]=_e,ot[this._vertexIndex++]=He,ot[this._vertexIndex++]=ze,ot[this._vertexIndex++]=gt,ot[this._vertexIndex++]=Q.r/255,ot[this._vertexIndex++]=Q.g/255,ot[this._vertexIndex++]=Q.b/255,ot[this._vertexIndex++]=Q.a,ot[this._vertexIndex++]=this._quad[6],ot[this._vertexIndex++]=this._quad[7],ot[this._vertexIndex++]=tt,ot[this._vertexIndex++]=me,ot[this._vertexIndex++]=_e,ot[this._vertexIndex++]=He,ot[this._vertexIndex++]=Ie,ot[this._vertexIndex++]=gt,ot[this._vertexIndex++]=Q.r/255,ot[this._vertexIndex++]=Q.g/255,ot[this._vertexIndex++]=Q.b/255,ot[this._vertexIndex++]=Q.a}hasPendingDraws(){return this._imageCount!==0}flush(){if(this._imageCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0,4*12*this._imageCount),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._shader.setUniformBoolean("u_pixelart",this.pixelArtSampler),this._bindTextures(t),this._quads.bind(),t.drawElements(t.TRIANGLES,this._imageCount*6,this._quads.bufferGlType,0),Bt.DrawnImagesCount+=this._imageCount,Bt.DrawCallCount++,this._imageCount=0,this._vertexIndex=0,this._textures.length=0,this._textureIndex=0,this._textureToIndex.clear(),this._images.clear(),this._imageToWidth.clear(),this._imageToHeight.clear()}}const E0=`#version 300 es\r
\r
precision mediump float;\r
\r
// UV coord\r
in vec2 v_uv;\r
\r
in vec2 v_size; // in pixels\r
\r
// Color coord to blend with image\r
in lowp vec4 v_color;\r
\r
// Stroke color if used\r
in lowp vec4 v_strokeColor;\r
\r
// Stroke thickness if used\r
in lowp float v_strokeThickness; // in pixels\r
\r
// Opacity\r
in float v_opacity;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r
    vec2 uv = v_uv;\r
    vec2 fragCoord = uv * v_size;\r
    float maxX = v_size.x - v_strokeThickness;\r
    float minX = v_strokeThickness;\r
    float maxY = v_size.y - v_strokeThickness;\r
    float minY = v_strokeThickness;\r
\r
    if (fragCoord.x < maxX && fragCoord.x > minX &&\r
        fragCoord.y < maxY && fragCoord.y > minY) {\r
      fragColor = v_color;\r
    } else {\r
      fragColor = v_strokeColor;\r
    }\r
    fragColor.a *= v_opacity;\r
    fragColor.rgb *= fragColor.a;\r
\r
    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\r
    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\r
\r
    // float fHalfBorderDist      = 0.0;\r
    // float fHalfBorderThickness = 0.0;\r
\r
    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \r
    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\r
    // {\r
    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\r
    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r
    // }\r
    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \r
    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\r
    // {\r
    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\r
    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r
    // }\r
    // else\r
    // {\r
    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\r
    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\r
    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\r
        \r
    //     float ellipse_ab    = v_radius-v_strokeThickness;\r
    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\r
    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \r
            \r
    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\r
    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\r
    // }\r
\r
    // vec4 v4FromColor = v_strokeColor;\r
    // v4FromColor.rgb *= v4FromColor.a;\r
    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\r
    // if (fHalfBorderDist < 0.0) {\r
    //     v4ToColor = v_color;\r
    //     v4ToColor.rgb *= v4ToColor.a;\r
    // }\r
\r
    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\r
\r
    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\r
    // gl_FragColor = finalColor;\r
}`,A0=`#version 300 es\r
in vec2 a_position;\r
\r
// UV coordinate\r
in vec2 a_uv;\r
out vec2 v_uv;\r
\r
in vec2 a_size;\r
out vec2 v_size;\r
\r
// Opacity \r
in float a_opacity;\r
out float v_opacity;\r
\r
in vec4 a_color;\r
out vec4 v_color;\r
\r
in vec4 a_strokeColor;\r
out vec4 v_strokeColor;\r
\r
in float a_strokeThickness;\r
out float v_strokeThickness;\r
\r
uniform mat4 u_matrix;\r
\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Pass through UV coords\r
   v_uv = a_uv;\r
   // Pass through size\r
   v_size = a_size;\r
   // Pass through the Opacity to the fragment shader\r
   v_opacity = a_opacity;\r
   // Pass through the color to the fragment shader\r
   v_color = a_color;\r
   // Pass through the stroke color to the fragment shader\r
   v_strokeColor = a_strokeColor;\r
   // Pass through the stroke thickenss to the fragment shader\r
   v_strokeThickness = a_strokeThickness;\r
}`;class T0{constructor(){this.type="ex.rectangle",this.priority=0,this._maxRectangles=10922,this._rectangleCount=0,this._vertexIndex=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new Qe({gl:t,fragmentSource:E0,vertexSource:A0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",i.ortho),this._buffer=new Wi({gl:t,size:16*4*this._maxRectangles,type:"dynamic"}),this._layout=new Vi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_size",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new vr(t,this._maxRectangles,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._shader.dispose(),this._context=null,this._gl=null}_isFull(){return this._rectangleCount>=this._maxRectangles}draw(...t){t[0]instanceof E&&t[1]instanceof E?this.drawLine.apply(this,t):this.drawRectangle.apply(this,t)}drawLine(t,i,r,a=1){this._isFull()&&this.flush(),this._rectangleCount++;const h=this._context.getTransform(),d=this._context.opacity,p=this._context.snapToPixel,m=i.sub(t),y=m.size,w=m.normalize().perpendicular(),b=a/2,R=h.multiply(w.scale(b).add(t)),k=h.multiply(w.scale(-b).add(t)),M=h.multiply(w.scale(b).add(i)),z=h.multiply(w.scale(-b).add(i));p&&(R.x=~~(R.x+_t),R.y=~~(R.y+_t),M.x=~~(M.x+_t),M.y=~~(M.y+_t),k.x=~~(k.x+_t),k.y=~~(k.y+_t),z.x=~~(z.x+_t),z.y=~~(z.y+_t));const X=0,N=0,U=1,$=1,W=G.Transparent,tt=0,pt=1,Q=this._layout.vertexBuffer.bufferData;Q[this._vertexIndex++]=R.x,Q[this._vertexIndex++]=R.y,Q[this._vertexIndex++]=X,Q[this._vertexIndex++]=N,Q[this._vertexIndex++]=y,Q[this._vertexIndex++]=a,Q[this._vertexIndex++]=d,Q[this._vertexIndex++]=r.r/255,Q[this._vertexIndex++]=r.g/255,Q[this._vertexIndex++]=r.b/255,Q[this._vertexIndex++]=r.a,Q[this._vertexIndex++]=W.r/255,Q[this._vertexIndex++]=W.g/255,Q[this._vertexIndex++]=W.b/255,Q[this._vertexIndex++]=W.a,Q[this._vertexIndex++]=tt/pt,Q[this._vertexIndex++]=k.x,Q[this._vertexIndex++]=k.y,Q[this._vertexIndex++]=X,Q[this._vertexIndex++]=$,Q[this._vertexIndex++]=y,Q[this._vertexIndex++]=a,Q[this._vertexIndex++]=d,Q[this._vertexIndex++]=r.r/255,Q[this._vertexIndex++]=r.g/255,Q[this._vertexIndex++]=r.b/255,Q[this._vertexIndex++]=r.a,Q[this._vertexIndex++]=W.r/255,Q[this._vertexIndex++]=W.g/255,Q[this._vertexIndex++]=W.b/255,Q[this._vertexIndex++]=W.a,Q[this._vertexIndex++]=tt/pt,Q[this._vertexIndex++]=M.x,Q[this._vertexIndex++]=M.y,Q[this._vertexIndex++]=U,Q[this._vertexIndex++]=N,Q[this._vertexIndex++]=y,Q[this._vertexIndex++]=a,Q[this._vertexIndex++]=d,Q[this._vertexIndex++]=r.r/255,Q[this._vertexIndex++]=r.g/255,Q[this._vertexIndex++]=r.b/255,Q[this._vertexIndex++]=r.a,Q[this._vertexIndex++]=W.r/255,Q[this._vertexIndex++]=W.g/255,Q[this._vertexIndex++]=W.b/255,Q[this._vertexIndex++]=W.a,Q[this._vertexIndex++]=tt/pt,Q[this._vertexIndex++]=z.x,Q[this._vertexIndex++]=z.y,Q[this._vertexIndex++]=U,Q[this._vertexIndex++]=$,Q[this._vertexIndex++]=y,Q[this._vertexIndex++]=a,Q[this._vertexIndex++]=d,Q[this._vertexIndex++]=r.r/255,Q[this._vertexIndex++]=r.g/255,Q[this._vertexIndex++]=r.b/255,Q[this._vertexIndex++]=r.a,Q[this._vertexIndex++]=W.r/255,Q[this._vertexIndex++]=W.g/255,Q[this._vertexIndex++]=W.b/255,Q[this._vertexIndex++]=W.a,Q[this._vertexIndex++]=tt/pt}drawRectangle(t,i,r,a,h=G.Transparent,d=0){this._isFull()&&this.flush(),this._rectangleCount++;const p=this._context.getTransform(),m=this._context.opacity,y=this._context.snapToPixel,w=p.multiply(t.add(B(0,0))),b=p.multiply(t.add(B(i,0))),R=p.multiply(t.add(B(i,r))),k=p.multiply(t.add(B(0,r)));y&&(w.x=~~(w.x+_t),w.y=~~(w.y+_t),b.x=~~(b.x+_t),b.y=~~(b.y+_t),k.x=~~(k.x+_t),k.y=~~(k.y+_t),R.x=~~(R.x+_t),R.y=~~(R.y+_t));const M=0,z=0,X=1,N=1,U=this._layout.vertexBuffer.bufferData;U[this._vertexIndex++]=w.x,U[this._vertexIndex++]=w.y,U[this._vertexIndex++]=M,U[this._vertexIndex++]=z,U[this._vertexIndex++]=i,U[this._vertexIndex++]=r,U[this._vertexIndex++]=m,U[this._vertexIndex++]=a.r/255,U[this._vertexIndex++]=a.g/255,U[this._vertexIndex++]=a.b/255,U[this._vertexIndex++]=a.a,U[this._vertexIndex++]=h.r/255,U[this._vertexIndex++]=h.g/255,U[this._vertexIndex++]=h.b/255,U[this._vertexIndex++]=h.a,U[this._vertexIndex++]=d,U[this._vertexIndex++]=k.x,U[this._vertexIndex++]=k.y,U[this._vertexIndex++]=M,U[this._vertexIndex++]=N,U[this._vertexIndex++]=i,U[this._vertexIndex++]=r,U[this._vertexIndex++]=m,U[this._vertexIndex++]=a.r/255,U[this._vertexIndex++]=a.g/255,U[this._vertexIndex++]=a.b/255,U[this._vertexIndex++]=a.a,U[this._vertexIndex++]=h.r/255,U[this._vertexIndex++]=h.g/255,U[this._vertexIndex++]=h.b/255,U[this._vertexIndex++]=h.a,U[this._vertexIndex++]=d,U[this._vertexIndex++]=b.x,U[this._vertexIndex++]=b.y,U[this._vertexIndex++]=X,U[this._vertexIndex++]=z,U[this._vertexIndex++]=i,U[this._vertexIndex++]=r,U[this._vertexIndex++]=m,U[this._vertexIndex++]=a.r/255,U[this._vertexIndex++]=a.g/255,U[this._vertexIndex++]=a.b/255,U[this._vertexIndex++]=a.a,U[this._vertexIndex++]=h.r/255,U[this._vertexIndex++]=h.g/255,U[this._vertexIndex++]=h.b/255,U[this._vertexIndex++]=h.a,U[this._vertexIndex++]=d,U[this._vertexIndex++]=R.x,U[this._vertexIndex++]=R.y,U[this._vertexIndex++]=X,U[this._vertexIndex++]=N,U[this._vertexIndex++]=i,U[this._vertexIndex++]=r,U[this._vertexIndex++]=m,U[this._vertexIndex++]=a.r/255,U[this._vertexIndex++]=a.g/255,U[this._vertexIndex++]=a.b/255,U[this._vertexIndex++]=a.a,U[this._vertexIndex++]=h.r/255,U[this._vertexIndex++]=h.g/255,U[this._vertexIndex++]=h.b/255,U[this._vertexIndex++]=h.a,U[this._vertexIndex++]=d}hasPendingDraws(){return this._rectangleCount!==0}flush(){if(this._rectangleCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,this._rectangleCount*6,this._quads.bufferGlType,0),Bt.DrawnImagesCount+=this._rectangleCount,Bt.DrawCallCount++,this._rectangleCount=0,this._vertexIndex=0}}const P0=`#version 300 es\r
precision highp float;\r
\r
// UV coord\r
in vec2 v_uv;\r
\r
// Color coord to blend with image\r
in lowp vec4 v_color;\r
\r
// Stroke color if used\r
in lowp vec4 v_strokeColor;\r
\r
// Stroke thickness if used\r
in lowp float v_strokeThickness;\r
\r
// Opacity\r
in float v_opacity;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  // make (0, 0) the center the uv \r
  vec2 uv = v_uv * 2.0 - 1.0;\r
\r
  vec4 color = v_color;\r
  vec4 strokeColor = v_strokeColor;\r
\r
  // circle border is at radius 1.0 \r
  // dist is > 0 when inside the circle \r
  float d = length(uv);\r
  float dist = 1.0 - length(uv);\r
\r
  // Fade based on fwidth\r
  float fade = fwidth(dot(uv, uv));\r
\r
  // if dist is greater than 0 step to 1;\r
  // when we cross this 0 threshold add a smooth fade\r
  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\r
\r
  // if dist is greater than the stroke thickness step to 1\r
  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\r
\r
  strokeColor.a *= fill * stroke;\r
  strokeColor.rgb *= strokeColor.a;\r
\r
  color.a *= fill * (1.0 - stroke);\r
  color.rgb *= color.a;\r
\r
  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\r
  finalColor.rgb = finalColor.rgb * v_opacity;\r
  finalColor.a = finalColor.a * v_opacity;\r
  fragColor = finalColor;\r
}`,R0=`#version 300 es\r
in vec2 a_position;\r
\r
// UV coordinate\r
in vec2 a_uv;\r
out vec2 v_uv;\r
\r
// Opacity \r
in float a_opacity;\r
out float v_opacity;\r
\r
in vec4 a_color;\r
out vec4 v_color;\r
\r
in vec4 a_strokeColor;\r
out vec4 v_strokeColor;\r
\r
in float a_strokeThickness;\r
out float v_strokeThickness;\r
\r
uniform mat4 u_matrix;\r
\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Pass through UV coords\r
   v_uv = a_uv;\r
   // Pass through the Opacity to the fragment shader\r
   v_opacity = a_opacity;\r
   // Pass through the color to the fragment shader\r
   v_color = a_color;\r
   // Pass through the stroke color to the fragment shader\r
   v_strokeColor = a_strokeColor;\r
   // Pass through the stroke thickenss to the fragment shader\r
   v_strokeThickness = a_strokeThickness;\r
}`;class I0{constructor(){this.type="ex.circle",this.priority=0,this._maxCircles=10922,this._circleCount=0,this._vertexIndex=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new Qe({gl:t,fragmentSource:P0,vertexSource:R0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",i.ortho),this._buffer=new Wi({gl:t,size:14*4*this._maxCircles,type:"dynamic"}),this._layout=new Vi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new vr(t,this._maxCircles,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._shader.dispose(),this._context=null,this._gl=null}_isFull(){return this._circleCount>=this._maxCircles}draw(t,i,r,a=G.Transparent,h=0){this._isFull()&&this.flush(),this._circleCount++;const d=this._context.getTransform(),p=this._context.opacity,m=this._context.snapToPixel,y=d.multiply(t.add(B(-i,-i))),w=d.multiply(t.add(B(i,-i))),b=d.multiply(t.add(B(i,i))),R=d.multiply(t.add(B(-i,i)));m&&(y.x=~~(y.x+_t),y.y=~~(y.y+_t),w.x=~~(w.x+_t),w.y=~~(w.y+_t),R.x=~~(R.x+_t),R.y=~~(R.y+_t),b.x=~~(b.x+_t),b.y=~~(b.y+_t));const k=0,M=0,z=1,X=1,N=this._layout.vertexBuffer.bufferData;N[this._vertexIndex++]=y.x,N[this._vertexIndex++]=y.y,N[this._vertexIndex++]=k,N[this._vertexIndex++]=M,N[this._vertexIndex++]=p,N[this._vertexIndex++]=r.r/255,N[this._vertexIndex++]=r.g/255,N[this._vertexIndex++]=r.b/255,N[this._vertexIndex++]=r.a,N[this._vertexIndex++]=a.r/255,N[this._vertexIndex++]=a.g/255,N[this._vertexIndex++]=a.b/255,N[this._vertexIndex++]=a.a,N[this._vertexIndex++]=h/i,N[this._vertexIndex++]=R.x,N[this._vertexIndex++]=R.y,N[this._vertexIndex++]=k,N[this._vertexIndex++]=X,N[this._vertexIndex++]=p,N[this._vertexIndex++]=r.r/255,N[this._vertexIndex++]=r.g/255,N[this._vertexIndex++]=r.b/255,N[this._vertexIndex++]=r.a,N[this._vertexIndex++]=a.r/255,N[this._vertexIndex++]=a.g/255,N[this._vertexIndex++]=a.b/255,N[this._vertexIndex++]=a.a,N[this._vertexIndex++]=h/i,N[this._vertexIndex++]=w.x,N[this._vertexIndex++]=w.y,N[this._vertexIndex++]=z,N[this._vertexIndex++]=M,N[this._vertexIndex++]=p,N[this._vertexIndex++]=r.r/255,N[this._vertexIndex++]=r.g/255,N[this._vertexIndex++]=r.b/255,N[this._vertexIndex++]=r.a,N[this._vertexIndex++]=a.r/255,N[this._vertexIndex++]=a.g/255,N[this._vertexIndex++]=a.b/255,N[this._vertexIndex++]=a.a,N[this._vertexIndex++]=h/i,N[this._vertexIndex++]=b.x,N[this._vertexIndex++]=b.y,N[this._vertexIndex++]=z,N[this._vertexIndex++]=X,N[this._vertexIndex++]=p,N[this._vertexIndex++]=r.r/255,N[this._vertexIndex++]=r.g/255,N[this._vertexIndex++]=r.b/255,N[this._vertexIndex++]=r.a,N[this._vertexIndex++]=a.r/255,N[this._vertexIndex++]=a.g/255,N[this._vertexIndex++]=a.b/255,N[this._vertexIndex++]=a.a,N[this._vertexIndex++]=h/i}hasPendingDraws(){return this._circleCount!==0}flush(){if(this._circleCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,this._circleCount*6,this._quads.bufferGlType,0),Bt.DrawnImagesCount+=this._circleCount,Bt.DrawCallCount++,this._circleCount=0,this._vertexIndex=0}}class Nd{constructor(t,i,r=100){this.builder=t,this.recycler=i,this.maxObjects=r,this.totalAllocations=0,this.index=0,this.objects=[],this.disableWarnings=!1,this._logger=J.getInstance()}dispose(){this.objects.length=0}preallocate(){for(let t=0;t<this.maxObjects;t++)this.objects[t]=this.builder()}using(t){const i=t(this);return i?this.done(...i):this.done()}borrow(t){const i=this.get();t(i),this.index--}get(){return this.index===this.maxObjects&&(this.disableWarnings||this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=this.maxObjects*2),this.objects[this.index]?this.recycler(this.objects[this.index++]):(this.totalAllocations++,this.objects[this.index++]=this.builder())}done(...t){this.index=0;for(const i of t){const r=this.objects.indexOf(i);this.objects[r]=this.builder(),this.totalAllocations++}return t}}class D0{constructor(){this.z=0,this.priority=0,this.transform=xt.identity(),this.state={z:0,opacity:1,tint:G.White,material:null}}}const k0=`#version 300 es
in vec2 a_position;

in vec2 a_uv;
out vec2 v_uv;

in vec2 a_screenuv;
out vec2 v_screenuv;

uniform mat4 u_matrix;
uniform mat4 u_transform;

void main() {
  // Set the vertex position using the ortho & transform matrix
  gl_Position = u_matrix * u_transform * vec4(a_position, 0.0, 1.0);

  // Pass through the UV coord to the fragment shader
  v_uv = a_uv;
  v_screenuv = a_screenuv;
}
`;class Ud{constructor(t){this._logger=J.getInstance(),this._color=G.Transparent,this._initialized=!1,this._images=new Map,this._textures=new Map;const{color:i,name:r,vertexSource:a,fragmentSource:h,graphicsContext:d,images:p}=t;if(this._name=r??"anonymous material",this._vertexSource=a??k0,this._fragmentSource=h,this._color=i??this._color,!d)throw Error(`Material ${r} must be provided an excalibur webgl graphics context`);if(d instanceof Gi?(this._graphicsContext=d,this._initialize(d)):this._logger.warn(`Material ${r} was created in 2D Canvas mode, currently only WebGL is supported`),p)for(const m in p)this.addImageSource(m,p[m])}_initialize(t){if(this._initialized)return;const i=t.__gl;this._maxTextureSlots=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS)-2,this._shader=t.createShader({vertexSource:this._vertexSource,fragmentSource:this._fragmentSource}),this._shader.compile(),this._initialized=!0}get name(){var t;return(t=this._name)!==null&&t!==void 0?t:"anonymous material"}get isUsingScreenTexture(){return this._fragmentSource.includes("u_screen_texture")}update(t){this._shader&&(this._shader.use(),t(this._shader))}getShader(){return this._shader}addImageSource(t,i){this._images.size<this._maxTextureSlots?this._images.set(t,i):this._logger.warn(`Max number texture slots ${this._maxTextureSlots} have been reached for material "${this.name}", no more textures will be uploaded due to hardware constraints.`)}removeImageSource(t){const i=this._images.get(t);this._graphicsContext.textureLoader.delete(i.image),this._images.delete(t)}_loadImageSource(t){const i=t.image,r=i.getAttribute(te.Filtering),a=r?Fo(r):null,h=Fs(i.getAttribute(te.WrappingX)),d=Fs(i.getAttribute(te.WrappingY)),p=i.getAttribute("forceUpload")==="true",m=this._graphicsContext.textureLoader.load(i,{filtering:a,wrapping:{x:h,y:d}},p);return i.removeAttribute("forceUpload"),this._textures.has(t)||this._textures.set(t,m),m}uploadAndBind(t,i=2){let r=i;for(const[a,h]of this._images.entries()){if(!h.isLoaded()){this._logger.warnOnce(`Image named ${a} in material ${this.name} not loaded, nothing will be uploaded to the shader. Did you forget to add this to a loader? https://excaliburjs.com/docs/loaders/`);continue}const d=this._loadImageSource(h);t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,d),this._shader.trySetUniformInt(a,r),r++}}use(){if(this._initialized)this._shader.use(),this._shader.trySetUniformFloatColor("u_color",this._color);else throw Error(`Material ${this.name} not yet initialized, use the ExcaliburGraphicsContext.createMaterial() to work around this.`)}}class zd{constructor(){this.type="ex.material",this.priority=0,this._textures=[]}initialize(t,i){this._gl=t,this._context=i,this._buffer=new Wi({gl:t,size:6*4,type:"dynamic"}),this._layout=new Vi({gl:t,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_screenuv",2]],suppressWarnings:!0}),this._quads=new vr(t,1,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._textures.length=0,this._context=null,this._gl=null}draw(t,i,r,a,h,d,p,m,y){var w,b,R,k;const M=this._gl,z=this._context.material,X=this._context.getTransform(),N=this._context.opacity,U=z.getShader(),$=this._layout.vertexBuffer.bufferData;let W=0,tt=(t==null?void 0:t.width)||a||0,pt=(t==null?void 0:t.height)||h||0,Q=[0,0,(w=a??(t==null?void 0:t.width))!==null&&w!==void 0?w:0,(b=h??(t==null?void 0:t.height))!==null&&b!==void 0?b:0],gt=[i??1,r??1];d!==void 0&&p!==void 0&&m!==void 0&&y!==void 0&&(Q=[i??1,r??1,(R=a??(t==null?void 0:t.width))!==null&&R!==void 0?R:0,(k=h??(t==null?void 0:t.height))!==null&&k!==void 0?k:0],gt=[d,p],tt=m,pt=y),i=Q[0],r=Q[1];const Lt=Q[2],he=Q[3],Ue=B(gt[0],gt[1]),ze=B(gt[0]+tt,gt[1]),He=B(gt[0],gt[1]+pt),Ie=B(gt[0]+tt,gt[1]+pt),me=t.width||tt,_e=t.height||pt,ot=i/me,Ys=r/_e,Qs=(i+Lt-.01)/me,qs=(r+he-.01)/_e,Mn=X.getPosition(),np=Mn.add(Ie),rp=Mn.x/this._context.width,op=Mn.y/this._context.height,ap=np.x/this._context.width,lp=np.y/this._context.height;$[W++]=Ue.x,$[W++]=Ue.y,$[W++]=ot,$[W++]=Ys,$[W++]=rp,$[W++]=op,$[W++]=He.x,$[W++]=He.y,$[W++]=ot,$[W++]=qs,$[W++]=rp,$[W++]=lp,$[W++]=ze.x,$[W++]=ze.y,$[W++]=Qs,$[W++]=Ys,$[W++]=ap,$[W++]=op,$[W++]=Ie.x,$[W++]=Ie.y,$[W++]=Qs,$[W++]=qs,$[W++]=ap,$[W++]=lp;const Ly=this._addImageAsTexture(t);z.use(),this._layout.shader=U,this._layout.use(!0),U.trySetUniformFloat("u_time_ms",performance.now()),U.trySetUniformFloat("u_opacity",N),U.trySetUniformFloatVector("u_resolution",B(this._context.width,this._context.height)),U.trySetUniformFloatVector("u_graphic_resolution",B(me,_e)),U.trySetUniformFloatVector("u_size",B(Lt,he)),U.trySetUniformMatrix("u_matrix",this._context.ortho),U.trySetUniformMatrix("u_transform",X.to4x4()),M.activeTexture(M.TEXTURE0+0),M.bindTexture(M.TEXTURE_2D,Ly),U.trySetUniformInt("u_graphic",0),M.activeTexture(M.TEXTURE0+1),M.bindTexture(M.TEXTURE_2D,this._context.materialScreenTexture),U.trySetUniformInt("u_screen_texture",1),z.uploadAndBind(M),this._quads.bind(),M.drawElements(M.TRIANGLES,6,this._quads.bufferGlType,0),Bt.DrawnImagesCount++,Bt.DrawCallCount++}_addImageAsTexture(t){const i=t.getAttribute(te.Filtering),r=i?Fo(i):null,a=Fs(t.getAttribute(te.WrappingX)),h=Fs(t.getAttribute(te.WrappingY)),d=t.getAttribute("forceUpload")==="true",p=this._context.textureLoader.load(t,{filtering:r,wrapping:{x:a,y:h}},d);return t.removeAttribute("forceUpload"),this._textures.indexOf(p)===-1&&this._textures.push(p),p}hasPendingDraws(){return!1}flush(){}}const _t=1e-4;class F0{constructor(t){this._webglCtx=t,this._debugText=new jl}drawRect(t,i,r,a,h={color:G.Black}){this.drawLine(B(t,i),B(t+r,i),{...h}),this.drawLine(B(t+r,i),B(t+r,i+a),{...h}),this.drawLine(B(t+r,i+a),B(t,i+a),{...h}),this.drawLine(B(t,i+a),B(t,i),{...h})}drawLine(t,i,r={color:G.Black}){this._webglCtx.draw("ex.line",t,i,r.color)}drawPoint(t,i={color:G.Black,size:5}){this._webglCtx.draw("ex.point",t,i.color,i.size)}drawText(t,i){this._debugText.write(this._webglCtx,t,i)}}class Gi{get z(){return this._state.current.z}set z(t){this._state.current.z=t}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get width(){return this.__gl.canvas.width}get height(){return this.__gl.canvas.height}get ortho(){return this._ortho}checkIfResolutionSupported(t){let i=!0;return(t.width>4096||t.height>4096)&&(i=!1),i}constructor(t){this._logger=J.getInstance(),this._renderers=new Map,this._isDrawLifecycle=!1,this.useDrawSorting=!0,this._drawCallPool=new Nd(()=>new D0,z=>(z.priority=0,z.z=0,z.renderer=void 0,z.args=void 0,z),4e3),this._drawCallIndex=0,this._drawCalls=new Array(4e3).fill(null),this._postProcessTargets=[],this._postprocessors=[],this._transform=new ji,this._state=new gr,this.snapToPixel=!1,this.smoothing=!1,this.pixelArtSampler=!1,this.uvPadding=.01,this.backgroundColor=G.ExcaliburBlue,this.multiSampleAntialiasing=!0,this.transparency=!0,this._isContextLost=!1,this._disposed=!1,this._imageToWidth=new Map,this._imageToHeight=new Map,this.debug=new F0(this),this._totalPostProcessorTime=0;const{canvasElement:i,context:r,enableTransparency:a,antialiasing:h,uvPadding:d,multiSampleAntialiasing:p,pixelArtSampler:m,powerPreference:y,snapToPixel:w,backgroundColor:b,useDrawSorting:R,handleContextLost:k,handleContextRestored:M}=t;if(this.__gl=r??i.getContext("webgl2",{antialias:h??this.smoothing,premultipliedAlpha:!1,alpha:a??this.transparency,depth:!1,powerPreference:y??"high-performance"}),!this.__gl)throw Error("Failed to retrieve webgl context from browser");k&&this.__gl.canvas.addEventListener("webglcontextlost",k,!1),M&&this.__gl.canvas.addEventListener("webglcontextrestored",M,!1),this.__gl.canvas.addEventListener("webglcontextlost",()=>{this._isContextLost=!0}),this.__gl.canvas.addEventListener("webglcontextrestored",()=>{this._isContextLost=!1}),this.textureLoader=new Zt(this.__gl),this.snapToPixel=w??this.snapToPixel,this.smoothing=h??this.smoothing,this.transparency=a??this.transparency,this.pixelArtSampler=m??this.pixelArtSampler,this.uvPadding=d??this.uvPadding,this.multiSampleAntialiasing=typeof p=="boolean"?p:this.multiSampleAntialiasing,this.samples=typeof p=="object"?p.samples:void 0,this.backgroundColor=b??this.backgroundColor,this.useDrawSorting=R??this.useDrawSorting,this._drawCallPool.disableWarnings=!0,this._drawCallPool.preallocate(),this._init()}dispose(){if(!this._disposed){this._disposed=!0,this.textureLoader.dispose();for(const t of this._renderers.values())t.dispose();this._renderers.clear(),this._drawCallPool.dispose(),this._drawCalls.length=0,this.__gl=null}}_init(){const t=this.__gl;this._ortho=Qt.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.register(new S0({uvPadding:this.uvPadding,pixelArtSampler:this.pixelArtSampler})),this.register(new zd),this.register(new T0),this.register(new I0),this.register(new v0),this.register(new g0),this.materialScreenTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.materialScreenTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.bindTexture(t.TEXTURE_2D,null),this._screenRenderer=new x0(t),this._renderTarget=new Mo({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height}),this._postProcessTargets=[new Mo({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height}),new Mo({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height})],this._msaaTarget=new Mo({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height,antialias:this.multiSampleAntialiasing,samples:this.samples})}register(t){this._renderers.set(t.type,t),t.initialize(this.__gl,this)}get(t){return this._renderers.get(t)}_isCurrentRenderer(t){return!this._currentRenderer||this._currentRenderer===t}beginDrawLifecycle(){this._isDrawLifecycle=!0}endDrawLifecycle(){this._isDrawLifecycle=!1}draw(t,...i){if(this._isDrawLifecycle||this._logger.warnOnce(`Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.
If you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler.`),this._isContextLost){this._logger.errorOnce(`Unable to draw ${t}, the webgl context is lost`);return}const r=this._renderers.get(t);if(r)if(this.useDrawSorting){const a=this._drawCallPool.get();a.z=this._state.current.z,a.priority=r.priority,a.renderer=t,this.getTransform().clone(a.transform),a.state.z=this._state.current.z,a.state.opacity=this._state.current.opacity,a.state.tint=this._state.current.tint,a.state.material=this._state.current.material,a.args=i,this._drawCalls[this._drawCallIndex++]=a}else this._currentRenderer||(this._currentRenderer=r),this._isCurrentRenderer(r)||this._currentRenderer.flush(),r.draw(...i),this._currentRenderer=r;else throw Error(`No renderer with name ${t} has been registered`)}resetTransform(){this._transform.current=xt.identity()}updateViewport(t){const i=this.__gl;this._ortho=this._ortho=Qt.ortho(0,t.width,t.height,0,400,-400),this._renderTarget.setResolution(i.canvas.width,i.canvas.height),this._msaaTarget.setResolution(i.canvas.width,i.canvas.height),this._postProcessTargets[0].setResolution(i.canvas.width,i.canvas.height),this._postProcessTargets[1].setResolution(i.canvas.width,i.canvas.height)}_getImageWidth(t){let i=this._imageToWidth.get(t);return i===void 0&&(i=t.width,this._imageToWidth.set(t,i)),i}_getImageHeight(t){let i=this._imageToHeight.get(t);return i===void 0&&(i=t.height,this._imageToHeight.set(t,i)),i}drawImage(t,i,r,a,h,d,p,m,y){if(!(a===0||h===0)){{if(m===0||y===0)return;if(this._getImageWidth(t)===0||this._getImageHeight(t)===0)return}if(!t){J.getInstance().warn("Cannot draw a null or undefined image"),console.trace&&console.trace();return}this._state.current.material?this.draw("ex.material",t,i,r,a,h,d,p,m,y):this.draw("ex.image",t,i,r,a,h,d,p,m,y)}}drawLine(t,i,r,a=1){this.draw("ex.rectangle",t,i,r,a)}drawRectangle(t,i,r,a,h,d){this.draw("ex.rectangle",t,i,r,a,h,d)}drawCircle(t,i,r,a,h){this.draw("ex.circle",t,i,r,a,h)}save(){this._transform.save(),this._state.save()}restore(){this._transform.restore(),this._state.restore()}translate(t,i){this._transform.translate(this.snapToPixel?~~(t+_t):t,this.snapToPixel?~~(i+_t):i)}rotate(t){this._transform.rotate(t)}scale(t,i){this._transform.scale(t,i)}transform(t){this._transform.current=t}getTransform(){return this._transform.current}multiply(t){this._transform.current.multiply(t,this._transform.current)}addPostProcessor(t){this._postprocessors.push(t),t.initialize(this.__gl)}removePostProcessor(t){const i=this._postprocessors.indexOf(t);i!==-1&&this._postprocessors.splice(i,1)}clearPostProcessors(){this._postprocessors.length=0}updatePostProcessors(t){for(const i of this._postprocessors){const r=i.getShader();r.use();const a=r.getUniforms();this._totalPostProcessorTime+=t,a.find(h=>h.name==="u_time_ms")&&r.setUniformFloat("u_time_ms",this._totalPostProcessorTime),a.find(h=>h.name==="u_elapsed_ms")&&r.setUniformFloat("u_elapsed_ms",t),a.find(h=>h.name==="u_resolution")&&r.setUniformFloatVector("u_resolution",B(this.width,this.height)),i.onUpdate&&i.onUpdate(t)}}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){return new Ud({...t,graphicsContext:this})}createShader(t){const i=this.__gl,{vertexSource:r,fragmentSource:a}=t,h=new Qe({gl:i,vertexSource:r,fragmentSource:a});return h.compile(),h}clear(){const t=this.__gl;(this.multiSampleAntialiasing?this._msaaTarget:this._renderTarget).use(),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT)}flush(){if(this._isContextLost){this._logger.errorOnce("Unable to flush the webgl context is lost");return}let t=this.multiSampleAntialiasing?this._msaaTarget:this._renderTarget;if(t.use(),this.useDrawSorting){for(let h=this._drawCallIndex;h<this._drawCalls.length;h++)this._drawCalls[h]=null;const i=new Map;for(const[h]of this._renderers){let d=0;for(d=0;d<this._drawCallIndex&&this._drawCalls[d].renderer!==h;d++);i.set(h,d)}this._drawCalls.sort((h,d)=>{if(h===null||d===null)return 0;const p=h.z-d.z,m=i.get(h.renderer)-i.get(d.renderer),y=h.priority-d.priority;return p===0?y===0?m:y:p});const r=this._transform.current,a=this._state.current;if(this._drawCalls.length&&this._drawCallIndex){let h=this._drawCalls[0].renderer,d=this._renderers.get(h);for(let p=0;p<this._drawCallIndex;p++)this._transform.current=this._drawCalls[p].transform,this._state.current=this._drawCalls[p].state,this._drawCalls[p].renderer!==h&&(d.flush(),h=this._drawCalls[p].renderer,d=this._renderers.get(h)),d instanceof zd&&this.material.isUsingScreenTexture&&(t.copyToTexture(this.materialScreenTexture),t.use()),d.draw(...this._drawCalls[p].args);d.hasPendingDraws()&&d.flush()}this._transform.current=r,this._state.current=a,this._drawCallPool.done(),this._drawCallIndex=0,this._imageToHeight.clear(),this._imageToWidth.clear()}else for(const i of this._renderers.values())i.hasPendingDraws()&&i.flush();t.disable(),this._postprocessors.length>0&&t.toRenderSource().use();for(let i=0;i<this._postprocessors.length;i++)t=this._postProcessTargets[i%2],this._postProcessTargets[i%2].use(),this._screenRenderer.renderWithPostProcessor(this._postprocessors[i]),this._postProcessTargets[i%2].toRenderSource().use();t.blitToScreen()}}const jt=1e-4;class B0{constructor(t){this._ex=t,this._debugText=new jl}drawRect(t,i,r,a){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~(t+jt):t,this._ex.snapToPixel?~~(i+jt):i,this._ex.snapToPixel?~~(r+jt):r,this._ex.snapToPixel?~~(a+jt):a),this._ex.__ctx.restore()}drawLine(t,i,r={color:G.Black}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=r.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~(t.x+jt):t.x,this._ex.snapToPixel?~~(t.y+jt):t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~(i.x+jt):i.x,this._ex.snapToPixel?~~(i.y+jt):i.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawPoint(t,i={color:G.Black,size:5}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=i.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~(t.x+jt):t.x,this._ex.snapToPixel?~~(t.y+jt):t.y,i.size,0,Math.PI*2),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawText(t,i){this._debugText.write(this._ex,t,i)}}class Lo{get width(){return this.__ctx.canvas.width}get height(){return this.__ctx.canvas.height}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get smoothing(){return this.__ctx.imageSmoothingEnabled}set smoothing(t){this.__ctx.imageSmoothingEnabled=t}constructor(t){this.useDrawSorting=!1,this.z=0,this.backgroundColor=G.ExcaliburBlue,this._state=new gr,this.snapToPixel=!1,this.debug=new B0(this);const{canvasElement:i,context:r,enableTransparency:a,snapToPixel:h,antialiasing:d,backgroundColor:p}=t;if(this.__ctx=r??i.getContext("2d",{alpha:a??!0}),!this.__ctx)throw new Error("Cannot build new ExcaliburGraphicsContext2D for some reason!");this.backgroundColor=p??this.backgroundColor,this.snapToPixel=h??this.snapToPixel,this.smoothing=d??this.smoothing}resetTransform(){this.__ctx.resetTransform()}updateViewport(t){}drawImage(t,i,r,a,h,d,p,m,y){if(a===0||h===0)return;if(m===0||y===0)return;if(t.width===0||t.height===0)return;this.__ctx.globalAlpha=this.opacity;const w=[t,i,r,a,h,d,p,m,y].filter(b=>b!==void 0).map(b=>typeof b=="number"&&this.snapToPixel?~~b:b);this.__ctx.drawImage.apply(this.__ctx,w),Bt.DrawCallCount++,Bt.DrawnImagesCount=1}drawLine(t,i,r,a=1){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=r.toString(),this.__ctx.moveTo(this.snapToPixel?~~(t.x+jt):t.x,this.snapToPixel?~~(t.y+jt):t.y),this.__ctx.lineTo(this.snapToPixel?~~(i.x+jt):i.x,this.snapToPixel?~~(i.y+jt):i.y),this.__ctx.lineWidth=a,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}drawRectangle(t,i,r,a){this.__ctx.save(),this.__ctx.fillStyle=a.toString(),this.__ctx.fillRect(this.snapToPixel?~~(t.x+jt):t.x,this.snapToPixel?~~(t.y+jt):t.y,this.snapToPixel?~~(i+jt):i,this.snapToPixel?~~(r+jt):r),this.__ctx.restore()}drawCircle(t,i,r,a,h){this.__ctx.save(),this.__ctx.beginPath(),a&&(this.__ctx.strokeStyle=a.toString()),h&&(this.__ctx.lineWidth=h),this.__ctx.fillStyle=r.toString(),this.__ctx.arc(this.snapToPixel?~~(t.x+jt):t.x,this.snapToPixel?~~(t.y+jt):t.y,i,0,Math.PI*2),this.__ctx.fill(),a&&this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}save(){this.__ctx.save(),this._state.save()}restore(){this.__ctx.restore(),this._state.restore()}translate(t,i){this.__ctx.translate(this.snapToPixel?~~(t+jt):t,this.snapToPixel?~~(i+jt):i)}rotate(t){this.__ctx.rotate(t)}scale(t,i){this.__ctx.scale(t,i)}getTransform(){throw new Error("Not implemented")}multiply(t){this.__ctx.setTransform(this.__ctx.getTransform().multiply(t.toDOMMatrix()))}addPostProcessor(t){}removePostProcessor(t){}clearPostProcessors(){}updatePostProcessors(t){}beginDrawLifecycle(){}endDrawLifecycle(){}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){return null}clear(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),Bt.clear()}flush(){}dispose(){this.__ctx=null}}var ee;(function(u){u.Fixed="Fixed",u.FitContainerAndFill="FitContainerAndFill",u.FitScreenAndFill="FitScreenAndFill",u.FitContainerAndZoom="FitContainerAndZoom",u.FitScreenAndZoom="FitScreenAndZoom",u.FitScreen="FitScreen",u.FillScreen="FillScreen",u.FitContainer="FitContainer",u.FillContainer="FillContainer"})(ee||(ee={}));class Vl{static get SVGA(){return{width:800,height:600}}static get Standard(){return{width:1920,height:1080}}static get Atari2600(){return{width:160,height:192}}static get GameBoy(){return{width:160,height:144}}static get GameBoyAdvance(){return{width:240,height:160}}static get NintendoDS(){return{width:256,height:192}}static get NES(){return{width:256,height:224}}static get SNES(){return{width:256,height:244}}}const M0={ScreenResize:"resize",PixelRatioChange:"pixelratio",FullScreenChange:"fullscreen"};class Gl{constructor(t){var i,r,a,h;this.events=new v,this._antialiasing=!0,this._canvasImageRendering="auto",this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=J.getInstance(),this._fullscreenChangeHandler=()=>{this._isDisposed||(this._isFullScreen=!this._isFullScreen,this._logger.debug("Fullscreen Change",this._isFullScreen),this.events.emit("fullscreen",{fullscreen:this.isFullScreen}))},this._pixelRatioChangeHandler=()=>{this._isDisposed||(this._logger.debug("Pixel Ratio Change",window.devicePixelRatio),this._listenForPixelRatio(),this._devicePixelRatio=this._calculateDevicePixelRatio(),this.applyResolutionAndViewport(),this.events.emit("pixelratio",{pixelRatio:this.pixelRatio}))},this._resizeHandler=()=>{if(this._isDisposed)return;const d=this.parent;this._logger.debug("View port resized"),this._setResolutionAndViewportByDisplayMode(d),this.applyResolutionAndViewport(),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._contentArea=new et,this._unsafeArea=new et,this.viewport=t.viewport,this.resolution=(i=t.resolution)!==null&&i!==void 0?i:{...this.viewport},this._contentResolution=this.resolution,this._displayMode=(r=t.displayMode)!==null&&r!==void 0?r:ee.Fixed,this._canvas=t.canvas,this.graphicsContext=t.context,this._antialiasing=(a=t.antialiasing)!==null&&a!==void 0?a:this._antialiasing,this._canvasImageRendering=(h=t.canvasImageRendering)!==null&&h!==void 0?h:this._canvasImageRendering,this._browser=t.browser,this._pixelRatioOverride=t.pixelRatio,this._applyDisplayMode(),this._listenForPixelRatio(),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}_listenForPixelRatio(){this._mediaQueryList&&!this._mediaQueryList.addEventListener&&this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler,{once:!0}):this._mediaQueryList.addListener(this._pixelRatioChangeHandler)}dispose(){this._isDisposed||(this._isDisposed=!0,this.events.clear(),this._browser.window.off("resize",this._resizeHandler),this._browser.window.clear(),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler):this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler),this._canvas=null)}_calculateDevicePixelRatio(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}get pixelRatio(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}get pixelRatioOverride(){return this._pixelRatioOverride}set pixelRatioOverride(t){this._pixelRatioOverride=t}get isHiDpi(){return this.pixelRatio!==1}get displayMode(){return this._displayMode}get canvas(){return this._canvas}get parent(){switch(this.displayMode){case ee.FillContainer:case ee.FitContainer:case ee.FitContainerAndFill:case ee.FitContainerAndZoom:return this.canvas.parentElement||document.body;default:return window}}get resolution(){return this._resolution}set resolution(t){this._resolution=t}get viewport(){return this._viewport?this._viewport:this._resolution}set viewport(t){this._viewport=t}get aspectRatio(){return this._resolution.width/this._resolution.height}get scaledWidth(){return this._resolution.width*this.pixelRatio}get scaledHeight(){return this._resolution.height*this.pixelRatio}setCurrentCamera(t){this._camera=t}pushResolutionAndViewport(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution={...this.resolution},this.viewport={...this.viewport}}peekViewport(){return this._viewportStack[this._viewportStack.length-1]}peekResolution(){return this._resolutionStack[this._resolutionStack.length-1]}popResolutionAndViewport(){this._resolutionStack.length&&this._viewportStack.length&&(this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop())}applyResolutionAndViewport(){if(this.graphicsContext instanceof Gi&&!this.graphicsContext.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})&&(this._logger.warnOnce(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) and pixel ratio (${this.pixelRatio}) are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`),!this.pixelRatioOverride)){let a=Math.max(1,this.pixelRatio-.5),h=!1;for(;a>1&&!h;){a=Math.max(1,a-.5);const d=this._resolution.width*a,p=this._resolution.height*a;h=this.graphicsContext.checkIfResolutionSupported({width:d,height:p})}this.pixelRatioOverride=a,this._logger.warnOnce(`Scaled resolution too big attempted recovery! Pixel ratio was automatically reduced to (${this.pixelRatio}) to avoid 4k texture limit. Setting \`ex.Engine({pixelRatio: ...}) will override any automatic recalculation, do so at your own risk.\`  (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`)}this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this._canvasImageRendering==="auto"?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",this._canvas.style.imageRendering===""&&(this._canvas.style.imageRendering="crisp-edges"));const t=this.viewport.widthUnit==="percent"?"%":"px",i=this.viewport.heightUnit==="percent"?"%":"px";this._canvas.style.width=this.viewport.width+t,this._canvas.style.height=this.viewport.height+i,this.graphicsContext.updateViewport(this.resolution),this.graphicsContext.resetTransform(),this.graphicsContext.smoothing=this._antialiasing,this.graphicsContext instanceof Lo&&this.graphicsContext.scale(this.pixelRatio,this.pixelRatio)}get antialiasing(){return this._antialiasing}set antialiasing(t){this._antialiasing=t,this.graphicsContext.smoothing=this._antialiasing}get isFullScreen(){return this._isFullScreen}goFullScreen(t){if(t){const i=document.getElementById(t);if(i)return i.getAttribute("ex-fullscreen-listener")||(i.setAttribute("ex-fullscreen-listener","true"),i.addEventListener("fullscreenchange",this._fullscreenChangeHandler)),i.requestFullscreen()}return this._canvas.requestFullscreen()}exitFullScreen(){return document.exitFullscreen()}_viewportToPixels(t){return{width:t.widthUnit==="percent"?this.canvas.offsetWidth:t.width,height:t.heightUnit==="percent"?this.canvas.offsetHeight:t.height}}pageToScreenCoordinates(t){let i=t.x,r=t.y;this._isFullScreen||(i-=gi(this._canvas).x,r-=gi(this._canvas).y);const a=this._viewportToPixels(this.viewport);if(this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const h=window.innerWidth/this.aspectRatio,d=(window.innerHeight-h)/2;r=(r-d)/h*a.height,i=i/window.innerWidth*a.width}else{const h=window.innerHeight*this.aspectRatio,d=(window.innerWidth-h)/2;i=(i-d)/h*a.width,r=r/window.innerHeight*a.height}return i=i/a.width*this.resolution.width,r=r/a.height*this.resolution.height,i=i-this.contentArea.left,r=r-this.contentArea.top,new E(i,r)}screenToPageCoordinates(t){let i=t.x,r=t.y;const a=this._viewportToPixels(this.viewport);if(i=i/this.resolution.width*a.width,r=r/this.resolution.height*a.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const h=window.innerWidth/this.aspectRatio,d=(window.innerHeight-h)/2;r=r/a.height*h+d,i=i/a.width*window.innerWidth}else{const h=window.innerHeight*this.aspectRatio,d=(window.innerWidth-h)/2;i=i/a.width*h+d,r=r/a.height*window.innerHeight}return this._isFullScreen||(i+=gi(this._canvas).x,r+=gi(this._canvas).y),new E(i,r)}screenToWorldCoordinates(t){return t=t.add(B(this.contentArea.left,this.contentArea.top)),this._camera?this._camera.inverse.multiply(t):t.sub(B(this.resolution.width/2,this.resolution.height/2))}worldToScreenCoordinates(t){return this._camera?this._camera.transform.multiply(t):t.add(B(this.resolution.width/2,this.resolution.height/2))}pageToWorldCoordinates(t){const i=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(i)}worldToPageCoordinates(t){const i=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(i)}getWorldBounds(){return et.fromDimension(this.resolution.width,this.resolution.height,E.Half).scale(B(1/this._camera.zoom,1/this._camera.zoom)).rotate(this._camera.rotation).translate(this._camera.drawPos)}getScreenBounds(){return et.fromDimension(this.resolution.width,this.resolution.height,E.Zero,E.Zero)}get canvasWidth(){return this.canvas.width}get halfCanvasWidth(){return this.canvas.width/2}get canvasHeight(){return this.canvas.height}get halfCanvasHeight(){return this.canvas.height/2}get drawWidth(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}get halfDrawWidth(){return this.drawWidth/2}get drawHeight(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}get halfDrawHeight(){return this.drawHeight/2}get center(){return B(this.halfDrawWidth,this.halfDrawHeight)}get contentArea(){return this._contentArea}get unsafeArea(){return this._unsafeArea}_computeFit(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.aspectRatio;let i=0,r=0;window.innerWidth/t<window.innerHeight?(i=window.innerWidth,r=window.innerWidth/t):(i=window.innerHeight*t,r=window.innerHeight),this.viewport={width:i,height:r},this._contentArea=et.fromDimension(this.resolution.width,this.resolution.height,E.Zero),this._unsafeArea=et.fromDimension(this.resolution.width,this.resolution.height,E.Zero),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitScreenAndFill(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=window.innerWidth,i=window.innerHeight;this._computeFitAndFill(t,i),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitContainerAndFill(){this.canvas.style.width="100%",this.canvas.style.height="100%",this._computeFitAndFill(this.canvas.offsetWidth,this.canvas.offsetHeight,{width:100,widthUnit:"percent",height:100,heightUnit:"percent"}),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitAndFill(t,i,r){if(this.viewport=r??{width:t,height:i},t/i<=this._contentResolution.width/this._contentResolution.height){this.resolution={width:t*this._contentResolution.width/t,height:t*this._contentResolution.width/t*i/t};const a=(this.resolution.height-this._contentResolution.height)/2;this._contentArea=new et({top:a,left:0,right:this._contentResolution.width,bottom:this.resolution.height-a}),this._unsafeArea=new et({top:-a,left:0,right:this._contentResolution.width,bottom:this.resolution.height+a})}else{this.resolution={width:i*this._contentResolution.height/i*t/i,height:i*this._contentResolution.height/i};const a=(this.resolution.width-this._contentResolution.width)/2;this._contentArea=new et({top:0,left:a,right:this.resolution.width-a,bottom:this._contentResolution.height}),this._unsafeArea=new et({top:0,left:-a,right:this.resolution.width+a,bottom:this._contentResolution.height})}}_computeFitScreenAndZoom(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";const t=window.innerWidth,i=window.innerHeight;this._computeFitAndZoom(t,i),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitContainerAndZoom(){this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="relative";const t=this.canvas.parentElement;t.style.overflow="hidden";const{offsetWidth:i,offsetHeight:r}=this.canvas;this._computeFitAndZoom(i,r),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitAndZoom(t,i){const r=this.aspectRatio;let a=0,h=0;t/r<i?(a=t,h=t/r):(a=i*r,h=i);const d=t/a,p=i/h,m=Math.max(d,p),y=a*m,w=h*m;y>t?this.canvas.style.left=-(y-t)/2+"px":this.canvas.style.left="",w>i?this.canvas.style.top=-(w-i)/2+"px":this.canvas.style.top="",this.viewport={width:y,height:w};const b=et.fromDimension(this.viewport.width,this.viewport.height,E.Zero);if(this.viewport.width>t){const R=(this.viewport.width-t)/this.viewport.width*this.resolution.width;b.top=0,b.left=R/2,b.right=this.resolution.width-R/2,b.bottom=this.resolution.height}if(this.viewport.height>i){const R=(this.viewport.height-i)/this.viewport.height*this.resolution.height;b.top=R/2,b.left=0,b.bottom=this.resolution.height-R/2,b.right=this.resolution.width}this._contentArea=b}_computeFitContainer(){const t=this.aspectRatio;let i=0,r=0,a="pixel",h="pixel";const d=this.canvas.parentElement;d.clientWidth/t<d.clientHeight?(this.canvas.style.width="100%",i=100,a="percent",r=this.canvas.offsetWidth/t):(this.canvas.style.height="100%",r=100,h="percent",i=this.canvas.offsetHeight*t),this.viewport={width:i,widthUnit:a,height:r,heightUnit:h},this._contentArea=et.fromDimension(this.resolution.width,this.resolution.height,E.Zero),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_applyDisplayMode(){this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver(()=>{this._resizeHandler()}),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler)}_setResolutionAndViewportByDisplayMode(t){this.displayMode===ee.FillContainer&&(this.canvas.style.width="100%",this.canvas.style.height="100%",this.viewport={width:100,widthUnit:"percent",height:100,heightUnit:"percent"},this.resolution={width:this.canvas.offsetWidth,height:this.canvas.offsetHeight}),this.displayMode===ee.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this._contentArea=et.fromDimension(this.resolution.width,this.resolution.height,E.Zero),this.displayMode===ee.FitScreen&&this._computeFit(),this.displayMode===ee.FitContainer&&this._computeFitContainer(),this.displayMode===ee.FitScreenAndFill&&this._computeFitScreenAndFill(),this.displayMode===ee.FitContainerAndFill&&this._computeFitContainerAndFill(),this.displayMode===ee.FitScreenAndZoom&&this._computeFitScreenAndZoom(),this.displayMode===ee.FitContainerAndZoom&&this._computeFitContainerAndZoom()}}class vn{static create(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}vn._INSTANCE=null;function L0(u){return!!u.playbackState}class Ms{static unlock(){return new Promise((i,r)=>{if(Ms._UNLOCKED||!vn.create())return i(!0);const a=setTimeout(()=>{J.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),i(!1)},200),h=vn.create();h.resume().then(()=>{const d=h.createBuffer(1,1,22050),p=h.createBufferSource();let m=!1;p.buffer=d,p.connect(h.destination),p.onended=()=>m=!0,p.start(0),setTimeout(()=>{L0(p)?(p.playbackState===p.PLAYING_STATE||p.playbackState===p.FINISHED_STATE)&&(Ms._UNLOCKED=!0):(h.currentTime>0||m)&&(Ms._UNLOCKED=!0)},0),clearTimeout(a),i(!0)},()=>{r()})})}static isUnlocked(){return this._UNLOCKED}}Ms._UNLOCKED=!1;class yn extends zt{constructor(t){var i,r,a,h,d,p,m,y,w,b;super(Hi(t,["width","height"])),this.filtering=null,this.lineCap="butt",this.quality=1,this._dirty=!0,this._smoothing=!1,this._color=Xt(G.Black,()=>this.flagDirty()),this._lineWidth=1,this._lineDash=[],this._padding=0,t&&(this.quality=(i=t.quality)!==null&&i!==void 0?i:this.quality,this.color=(r=t.color)!==null&&r!==void 0?r:G.Black,this.strokeColor=t==null?void 0:t.strokeColor,this.smoothing=(a=t.smoothing)!==null&&a!==void 0?a:this.smoothing,this.lineWidth=(h=t.lineWidth)!==null&&h!==void 0?h:this.lineWidth,this.lineDash=(d=t.lineDash)!==null&&d!==void 0?d:this.lineDash,this.lineCap=(p=t.lineCap)!==null&&p!==void 0?p:this.lineCap,this.padding=(m=t.padding)!==null&&m!==void 0?m:this.padding,this.filtering=(y=t.filtering)!==null&&y!==void 0?y:this.filtering),this._bitmap=document.createElement("canvas");const R=(w=t==null?void 0:t.width)!==null&&w!==void 0?w:this._bitmap.width,k=(b=t==null?void 0:t.height)!==null&&b!==void 0?b:this._bitmap.height;this.width=R,this.height=k;const M=this._bitmap.getContext("2d");if(M)this._ctx=M;else throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic")}cloneRasterOptions(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,lineCap:this.lineCap,quality:this.quality,padding:this.padding}}get dirty(){return this._dirty}flagDirty(){this._dirty=!0}get width(){return Math.abs(this._getTotalWidth()*this.scale.x)}set width(t){t/=Math.abs(this.scale.x),this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}get height(){return Math.abs(this._getTotalHeight()*this.scale.y)}set height(t){t/=Math.abs(this.scale.y),this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}_getTotalWidth(){var t;return(((t=this._originalWidth)!==null&&t!==void 0?t:this._bitmap.width)+this.padding*2)*1}_getTotalHeight(){var t;return(((t=this._originalHeight)!==null&&t!==void 0?t:this._bitmap.height)+this.padding*2)*1}get localBounds(){return et.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,E.Zero)}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this.flagDirty()}get color(){return this._color}set color(t){this.flagDirty(),this._color=Xt(t,()=>this.flagDirty())}get strokeColor(){return this._strokeColor}set strokeColor(t){this.flagDirty(),this._strokeColor=Xt(t,()=>this.flagDirty())}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this.flagDirty()}get lineDash(){return this._lineDash}set lineDash(t){this._lineDash=t,this.flagDirty()}get padding(){return this._padding}set padding(t){this._padding=t,this.flagDirty()}rasterize(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperties(this._ctx),this.execute(this._ctx),this._ctx.restore()}_applyRasterProperties(t){var i,r,a;this._bitmap.width=this._getTotalWidth()*this.quality,this._bitmap.height=this._getTotalHeight()*this.quality,this._bitmap.setAttribute("filtering",this.filtering),this._bitmap.setAttribute("forceUpload","true"),t.scale(this.quality,this.quality),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash((i=this.lineDash)!==null&&i!==void 0?i:t.getLineDash()),t.lineCap=this.lineCap,t.strokeStyle=(r=this.strokeColor)===null||r===void 0?void 0:r.toString(),t.fillStyle=(a=this.color)===null||a===void 0?void 0:a.toString()}_drawImage(t,i,r){this._dirty&&this.rasterize(),t.scale(1/this.quality,1/this.quality),t.drawImage(this._bitmap,i,r)}}class Oo extends yn{get ctx(){return this._ctx}constructor(t){super(t),this._options=t}clone(){return new Oo({...this._options,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){var i,r;!((i=this._options)===null||i===void 0)&&i.draw&&((r=this._options)===null||r===void 0||r.draw(t)),this._options.cache||this.flagDirty()}}class Xl{}Xl.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};class No{constructor(){this.states=new Map}get currentState(){return this._currentState}set currentState(t){this._currentState=t}static create(t,i){const r=new No;r.data=i;for(const a in t.states)r.states.set(a,{name:a,...t.states[a]});for(const a of r.states.values())for(const h of a.transitions)if(h!=="*"&&!r.states.has(h))throw Error(`Invalid state machine, state [${a.name}] has a transition to another state that doesn't exist [${h}]`);return r.currentState=r.startState=r.states.get(t.start),r}in(t){return this.currentState.name===t}go(t,i){var r,a;if(this.currentState.transitions.includes(t)||this.currentState.transitions.includes("*")){const h=this.states.get(t);return this.currentState.onExit&&((r=this.currentState)===null||r===void 0?void 0:r.onExit({to:h.name,data:this.data}))===!1||h!=null&&h.onEnter&&(h==null?void 0:h.onEnter({from:this.currentState.name,eventData:i,data:this.data}))===!1?!1:(this.currentState=h,!((a=this.currentState)===null||a===void 0)&&a.onState&&this.currentState.onState(),!0)}return!1}update(t){this.currentState.onUpdate&&this.currentState.onUpdate(this.data,t)}save(t){localStorage.setItem(t,JSON.stringify({currentState:this.currentState.name,data:this.data}))}restore(t){const i=JSON.parse(localStorage.getItem(t));this.currentState=this.states.get(i.currentState),this.data=i.data}}class Hd{_createNewBufferSource(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.value=this._playbackRate,this._instance.connect(this._volumeNode),this._volumeNode.connect(this._audioContext.destination)}_handleEnd(){this.loop||(this._instance.onended=()=>{this._playingFuture.resolve(!0)})}set loop(t){this._loop=t,this._instance&&(this._instance.loop=t,this.loop||(this._instance.onended=()=>{this._playingFuture.resolve(!0)}))}get loop(){return this._loop}set volume(t){t=L(t,0,1),this._volume=t,this._stateMachine.in("PLAYING")&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}get volume(){return this._volume}get duration(){var t;return(t=this._duration)!==null&&t!==void 0?t:this.getTotalPlaybackDuration()}set duration(t){this._duration=t}constructor(t){this._src=t,this._audioContext=vn.create(),this._volumeNode=this._audioContext.createGain(),this._playingFuture=new _,this._stateMachine=No.create({start:"STOPPED",states:{PLAYING:{onEnter:({data:i})=>{this._createNewBufferSource(),this._handleEnd(),this.loop?this._instance.start(0,i.pausedAt*this._playbackRate):this._instance.start(0,i.pausedAt*this._playbackRate,this.duration),i.startedAt=this._audioContext.currentTime-i.pausedAt,i.pausedAt=0},onState:()=>this._playStarted(),onExit:({to:i})=>{i==="STOPPED"&&this._playingFuture.resolve(!0),this._instance.onended=null,this._instance.disconnect(),this._instance.stop(0),this._instance=null},transitions:["STOPPED","PAUSED","SEEK"]},SEEK:{onEnter:({eventData:i,data:r})=>{r.pausedAt=(i??0)/this._playbackRate,r.startedAt=0},transitions:["*"]},STOPPED:{onEnter:({data:i})=>{i.pausedAt=0,i.startedAt=0,this._playingFuture.resolve(!0)},transitions:["PLAYING","PAUSED","SEEK"]},PAUSED:{onEnter:({data:i})=>{i.pausedAt=this._audioContext.currentTime-i.startedAt},transitions:["PLAYING","STOPPED","SEEK"]}}},{startedAt:0,pausedAt:0}),this._volume=1,this._loop=!1,this._playStarted=()=>{},this._playbackRate=1,this._createNewBufferSource()}isPlaying(){return this._stateMachine.in("PLAYING")}isPaused(){return this._stateMachine.in("PAUSED")||this._stateMachine.in("SEEK")}isStopped(){return this._stateMachine.in("STOPPED")}play(t=()=>{}){return this._playStarted=t,this._stateMachine.go("PLAYING"),this._playingFuture.promise}pause(){this._stateMachine.go("PAUSED")}stop(){this._stateMachine.go("STOPPED")}seek(t){this._stateMachine.go("PAUSED"),this._stateMachine.go("SEEK",t)}getTotalPlaybackDuration(){return this._src.duration}getPlaybackPosition(){const{pausedAt:t,startedAt:i}=this._stateMachine.data;return t?t*this._playbackRate:i?(this._audioContext.currentTime-i)*this._playbackRate:0}set playbackRate(t){this._instance.playbackRate.value=this._playbackRate=t}get playbackRate(){return this._instance.playbackRate.value}}var Uo;(function(u){u.Kill="kill",u.PreKill="prekill",u.PostKill="postkill",u.PreDraw="predraw",u.PostDraw="postdraw",u.PreDebugDraw="predebugdraw",u.PostDebugDraw="postdebugdraw",u.PreUpdate="preupdate",u.PostUpdate="postupdate",u.PreFrame="preframe",u.PostFrame="postframe",u.PreCollision="precollision",u.CollisionStart="collisionstart",u.CollisionEnd="collisionend",u.PostCollision="postcollision",u.Initialize="initialize",u.Activate="activate",u.Deactivate="deactivate",u.ExitViewport="exitviewport",u.EnterViewport="enterviewport",u.ExitTrigger="exit",u.EnterTrigger="enter",u.Connect="connect",u.Disconnect="disconnect",u.Button="button",u.Axis="axis",u.Visible="visible",u.Hidden="hidden",u.Start="start",u.Stop="stop",u.PointerUp="pointerup",u.PointerDown="pointerdown",u.PointerMove="pointermove",u.PointerEnter="pointerenter",u.PointerLeave="pointerleave",u.PointerCancel="pointercancel",u.PointerWheel="pointerwheel",u.Up="up",u.Down="down",u.Move="move",u.Enter="enter",u.Leave="leave",u.Cancel="cancel",u.Wheel="wheel",u.Press="press",u.Release="release",u.Hold="hold",u.PointerDragStart="pointerdragstart",u.PointerDragEnd="pointerdragend",u.PointerDragEnter="pointerdragenter",u.PointerDragLeave="pointerdragleave",u.PointerDragMove="pointerdragmove",u.ActionStart="actionstart",u.ActionComplete="actioncomplete"})(Uo||(Uo={}));class mt{constructor(){this._bubbles=!0}get bubbles(){return this._bubbles}set bubbles(t){this._bubbles=t}stopPropagation(){this.bubbles=!1}}class zo extends mt{constructor(t){super(),this.target=t}}class $l extends mt{constructor(t){super(),this.target=t}}class Yl extends mt{constructor(t){super(),this.target=t}}class Ql extends mt{constructor(t){super(),this.target=t}}class ql extends mt{constructor(t){super(),this.target=t}}class wn extends mt{constructor(t,i,r){super(),this.ctx=t,this.delta=i,this.target=r}}class xn extends mt{constructor(t,i,r){super(),this.ctx=t,this.delta=i,this.target=r}}class Zl extends mt{constructor(t,i,r){super(),this.ctx=t,this.delta=i,this.target=r}}class Kl extends mt{constructor(t,i,r){super(),this.ctx=t,this.delta=i,this.target=r}}class Jl extends mt{constructor(t,i){super(),this.ctx=t,this.target=i}}class th extends mt{constructor(t,i){super(),this.ctx=t,this.target=i}}class rs extends mt{constructor(t,i,r){super(),this.engine=t,this.delta=i,this.target=r}}class os extends mt{constructor(t,i,r){super(),this.engine=t,this.delta=i,this.target=r}}class eh extends mt{constructor(t,i){super(),this.engine=t,this.prevStats=i,this.target=t}}class ih extends mt{constructor(t,i){super(),this.engine=t,this.stats=i,this.target=t}}class sh extends mt{constructor(t,i){super(),this.index=t,this.gamepad=i,this.target=i}}class nh extends mt{constructor(t,i){super(),this.index=t,this.gamepad=i,this.target=i}}class rh extends mt{constructor(t,i,r){super(),this.button=t,this.value=i,this.target=r}}class oh extends mt{constructor(t,i,r){super(),this.axis=t,this.value=i,this.target=r}}class ah extends mt{constructor(t){super(),this.target=t}}class lh extends mt{constructor(t){super(),this.target=t}}class Ls extends mt{constructor(t,i,r,a,h){super(),this.other=i,this.side=r,this.intersection=a,this.contact=h,this.target=t}}class Os extends mt{constructor(t,i,r,a,h){super(),this.other=i,this.side=r,this.intersection=a,this.contact=h,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class Ho{constructor(t,i,r,a){this.target=t,this.other=i,this.side=r,this.contact=a}}class jo{constructor(t,i,r,a){this.target=t,this.other=i,this.side=r,this.lastContact=a}}class Wo{constructor(t,i,r,a,h){this.target=t,this.other=i,this.side=r,this.intersection=a,this.contact=h}}class Vo{constructor(t,i,r,a,h){this.target=t,this.other=i,this.side=r,this.intersection=a,this.contact=h}}class yr extends mt{constructor(t,i,r,a){super(),this.other=i,this.side=r,this.contact=a,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class wr extends mt{constructor(t,i,r,a){super(),this.other=i,this.side=r,this.lastContact=a,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class bn extends mt{constructor(t,i){super(),this.engine=t,this.target=i}}class hh extends mt{constructor(t,i){super(),this.context=t,this.target=i}}class ch extends mt{constructor(t,i){super(),this.context=t,this.target=i}}class uh extends mt{constructor(t){super(),this.target=t}}class dh extends mt{constructor(t){super(),this.target=t}}class fh extends mt{constructor(t,i){super(),this.target=t,this.actor=i}}class ph extends mt{constructor(t,i){super(),this.target=t,this.actor=i}}class gh extends mt{constructor(t,i){super(),this.action=t,this.target=i}}class mh extends mt{constructor(t,i){super(),this.action=t,this.target=i}}class _h extends mt{set bubbles(t){}get bubbles(){return!1}get _path(){return null}set _path(t){}constructor(t,i="MediaEvent"){super(),this.target=t,this._name=i}stopPropagation(){}action(){}propagate(){}layPath(t){}}class Ns extends _h{constructor(t,i){super(t,"NativeSoundEvent"),this.track=i}}class jd extends _h{constructor(t,i){super(t,"NativeSoundProcessedEvent"),this._processedData=i,this.data=this._processedData}}function O0(u){try{const t=new Audio,i=/.*\.([A-Za-z0-9]+)(?:(?:\?|\#).*)*$/,r=u.match(i)[1];return!!t.canPlayType("audio/"+r)}catch(t){return J.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",t),!1}}const N0={VolumeChange:"volumechange",Processed:"processed",Pause:"pause",Stop:"stop",PlaybackEnd:"playbackend",Resume:"resume",PlaybackStart:"playbackstart"};class Wd{set loop(t){this._loop=t;for(const i of this._tracks)i.loop=this._loop;this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}get loop(){return this._loop}set volume(t){this._volume=t;for(const i of this._tracks)i.volume=this._volume;this.events.emit("volumechange",new Ns(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}get volume(){return this._volume}get duration(){return this._duration}set duration(t){this._duration=t}get instances(){return this._tracks}get path(){return this._resource.path}set path(t){this._resource.path=t}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}constructor(...t){this.events=new v,this.logger=J.getInstance(),this._loop=!1,this._volume=1,this._isStopped=!1,this._tracks=[],this._wasPlayingOnHidden=!1,this._playbackRate=1,this._audioContext=vn.create(),this._resource=new Ft("",Xl.type.arraybuffer);for(const i of t)if(O0(i)){this.path=i;break}this.path||(this.logger.warn("This browser does not support any of the audio files specified:",t.join(", ")),this.logger.warn("Attempting to use",t[0]),this.path=t[0])}isLoaded(){return!!this.data}async load(){var t,i;if(this.data)return this.data;const r=await this._resource.load(),a=await this.decodeAudio(r.slice(0));return this._duration=(i=(t=this._duration)!==null&&t!==void 0?t:a==null?void 0:a.duration)!==null&&i!==void 0?i:void 0,this.events.emit("processed",new jd(this,a)),this.data=a}async decodeAudio(t){try{return await this._audioContext.decodeAudioData(t.slice(0))}catch{return this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),await Promise.reject()}}wireEngine(t){t&&(this._engine=t,this._engine.on("hidden",()=>{t.pauseAudioWhenHidden&&this.isPlaying()&&(this._wasPlayingOnHidden=!0,this.pause())}),this._engine.on("visible",()=>{t.pauseAudioWhenHidden&&this._wasPlayingOnHidden&&(this.play(),this._wasPlayingOnHidden=!1)}),this._engine.on("start",()=>{this._isStopped=!1}),this._engine.on("stop",()=>{this.stop(),this._isStopped=!0}))}instanceCount(){return this._tracks.length}isPlaying(){return this._tracks.some(t=>t.isPlaying())}isPaused(){return this._tracks.some(t=>t.isPaused())}isStopped(){return this._tracks.some(t=>t.isStopped())}play(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this.isPaused()?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}pause(){if(this.isPlaying()){for(const t of this._tracks)t.pause();this.events.emit("pause",new Ns(this)),this.logger.debug("Paused all instances of sound",this.path)}}stop(){for(const t of this._tracks)t.stop();this.events.emit("stop",new Ns(this)),this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._tracks.forEach(i=>{i.playbackRate=this._playbackRate})}seek(t,i=0){this._tracks.length===0&&this._getTrackInstance(this.data),this._tracks[i].seek(t)}getTotalPlaybackDuration(){return this.isLoaded()?this.data.duration:(this.logger.warnOnce(`Sound from ${this.path} is not loaded, cannot return total playback duration.Did you forget to add Sound to a loader? https://excaliburjs.com/docs/loaders/`),0)}getPlaybackPosition(t=0){return this._tracks.length?this._tracks[t].getPlaybackPosition():0}getTrackId(t){return this._tracks.indexOf(t)}async _resumePlayback(){if(this.isPaused){const t=[];for(const i of this._tracks)t.push(i.play().then(()=>(this._tracks.splice(this.getTrackId(i),1),!0)));this.events.emit("resume",new Ns(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),await Promise.all(t)}return!0}async _startPlayback(){const t=this._getTrackInstance(this.data),i=await t.play(()=>{this.events.emit("playbackstart",new Ns(this,t)),this.logger.debug("Playing new instance for sound",this.path)});this.events.emit("playbackend",new Ns(this,t));const r=this.getTrackId(t);return r!==-1&&this._tracks.splice(r,1),i}_getTrackInstance(t){const i=new Hd(t);return i.loop=this.loop,i.volume=this.volume,i.duration=this.duration,i.playbackRate=this._playbackRate,this._tracks.push(i),i}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}const U0={BeforeLoad:"beforeload",AfterLoad:"afterload",UserAction:"useraction",LoadResourceStart:"loadresourcestart",LoadResourceEnd:"loadresourceend"};function vh(u){var t,i;return!!(u!=null&&u.prototype)&&!!(!((i=(t=u==null?void 0:u.prototype)===null||t===void 0?void 0:t.constructor)===null||i===void 0)&&i.name)}class xr{get resources(){return this._resources}constructor(t){var i;this.events=new v,this.canvas=new Oo({filtering:qt.Blended,smoothing:!0,cache:!1,draw:this.onDraw.bind(this)}),this._resources=[],this._numLoaded=0,this._totalTimeMs=0,this._loadingFuture=new _,t&&(!((i=t.loadables)===null||i===void 0)&&i.length)&&this.addResources(t.loadables)}onInitialize(t){this.engine=t,this.canvas.width=this.engine.screen.resolution.width,this.canvas.height=this.engine.screen.resolution.height}async onUserAction(){return await Promise.resolve()}async onBeforeLoad(){}async onAfterLoad(){await Tt(500,this.engine.clock)}addResource(t){this._resources.push(t)}addResources(t){let i=0;const r=t.length;for(i;i<r;i++)this.addResource(t[i])}markResourceComplete(){this._numLoaded++}get progress(){const t=this._resources.length;return t>0?L(this._numLoaded,0,t)/t:1}isLoaded(){return this._numLoaded===this._resources.length}onUpdate(t,i){this._totalTimeMs+=i}onDraw(t){const i=this._totalTimeMs/1e3;t.fillStyle=G.Black.toRGBA(),t.fillRect(0,0,this.engine.screen.resolution.width,this.engine.screen.resolution.height),t.save(),t.translate(this.engine.screen.resolution.width/2,this.engine.screen.resolution.height/2);const r=i*10;t.strokeStyle="white",t.lineWidth=10,t.lineCap="round",t.arc(0,0,40,r,r+Math.PI*3/2),t.stroke(),t.fillStyle="white",t.font="16px sans-serif";const a=(this.progress*100).toFixed(0)+"%",h=t.measureText(a),d=Math.abs(h.actualBoundingBoxLeft)+Math.abs(h.actualBoundingBoxRight),p=Math.abs(h.actualBoundingBoxAscent)+Math.abs(h.actualBoundingBoxDescent);t.fillText(a,-d/2,p/2),t.restore()}areResourcesLoaded(){return this._loadingFuture.promise}async load(){await this.onBeforeLoad(),this.events.emit("beforeload"),this.canvas.flagDirty(),await Promise.all(this._resources.map(async t=>{this.events.emit("loadresourcestart",t),await t.load().finally(()=>{this._numLoaded++,this.canvas.flagDirty(),this.events.emit("loadresourceend",t)})}));for(const t of this._resources)t instanceof Wd&&t.wireEngine(this.engine);return this._loadingFuture.resolve(),this.canvas.flagDirty(),await this.onUserAction(),this.events.emit("useraction"),await Ms.unlock(),await this.onAfterLoad(),this.events.emit("afterload"),this.data=this._resources}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}function yh(u,t=G.Red,i,r,a,h,d=1,p="butt"){u.save(),u.beginPath(),u.lineWidth=d,u.lineCap=p,u.strokeStyle=t.toString(),u.moveTo(i,r),u.lineTo(a,h),u.closePath(),u.stroke(),u.restore()}function z0(u,t=G.Red,i){u.beginPath(),u.strokeStyle=t.toString(),u.arc(i.x,i.y,5,0,Math.PI*2),u.closePath(),u.stroke()}function H0(u,t,i,r,a=1){const h=t?t.toString():"blue",d=r.scale(a);u.beginPath(),u.strokeStyle=h,u.moveTo(i.x,i.y),u.lineTo(i.x+d.x,i.y+d.y),u.closePath(),u.stroke()}function wh(u,t,i,r,a,h=5,d=G.White,p=null){let m;if(typeof h=="number")m={tl:h,tr:h,br:h,bl:h};else{const y={tl:0,tr:0,br:0,bl:0};for(const w in y)if(y.hasOwnProperty(w)){const b=w;m[b]=h[b]||y[b]}}u.beginPath(),u.moveTo(t+m.tl,i),u.lineTo(t+r-m.tr,i),u.quadraticCurveTo(t+r,i,t+r,i+m.tr),u.lineTo(t+r,i+a-m.br),u.quadraticCurveTo(t+r,i+a,t+r-m.br,i+a),u.lineTo(t+m.bl,i+a),u.quadraticCurveTo(t,i+a,t,i+a-m.bl),u.lineTo(t,i+m.tl),u.quadraticCurveTo(t,i,t+m.tl,i),u.closePath(),p&&(u.fillStyle=p.toString(),u.fill()),d&&(u.strokeStyle=d.toString(),u.stroke())}function j0(u,t,i,r,a=G.White,h=null){u.beginPath(),u.arc(t,i,r,0,Math.PI*2),u.closePath(),h&&(u.fillStyle=h.toString(),u.fill()),a&&(u.strokeStyle=a.toString(),u.stroke())}const W0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=";var V0=Dt(8851);class Us extends xr{get _image(){return this._imageElement||(this._imageElement=new Image,this._imageElement.onload=()=>this._imageLoaded.resolve(),this._imageElement.src=this.logo),this._imageElement}get playButtonRootElement(){return this._playButtonRootElement}get playButtonElement(){return this._playButtonElement}get _playButton(){const t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}constructor(t){const i=Array.isArray(t)?{loadables:t}:t;super(i),this._logger=J.getInstance(),this._originalOptions={loadables:[]},this.events=new v,this._playButtonShown=!1,this.logo=W0,this.logoWidth=468,this.logoHeight=118,this.loadingBarColor=G.White,this.backgroundColor="#176BAA",this._imageLoaded=new _,this.suppressPlayButton=!1,this._playButtonStyles=V0.A.toString(),this.playButtonText="Play game",this.startButtonFactory=()=>{let r=document.getElementById("excalibur-play");return r||(r=document.createElement("button")),r.id="excalibur-play",r.textContent=this.playButtonText,r.style.display="none",r},this._configuredPixelRatio=null,this._originalOptions={...Us._DEFAULT_LOADER_OPTIONS,...i}}onInitialize(t){this.engine=t,this.screen=t.screen,this.canvas.width=this.engine.canvas.width,this.canvas.height=this.engine.canvas.height,this.screen.events.on("resize",()=>{this.canvas.width=this.engine.canvas.width,this.canvas.height=this.engine.canvas.height})}async showPlayButton(){var t,i;if(this.suppressPlayButton)this.hidePlayButton(),await Tt(500,(t=this.engine)===null||t===void 0?void 0:t.clock);else{const r=()=>{try{this._positionPlayButton()}catch{}};return!((i=this.engine)===null||i===void 0)&&i.browser&&this.engine.browser.window.on("resize",r),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",h=>{h.key==="Enter"&&this._playButton.click()}),this._positionPlayButton(),await new Promise(h=>{const d=p=>{var m;if(p.stopPropagation(),this.hidePlayButton(),!((m=this.engine)===null||m===void 0)&&m.browser&&this.engine.browser.window.off("resize",r),this._originalOptions.fullscreenAfterLoad)try{this._logger.info("requesting fullscreen"),this._originalOptions.fullscreenContainer instanceof HTMLElement?this._originalOptions.fullscreenContainer.requestFullscreen():this.engine.screen.goFullScreen(this._originalOptions.fullscreenContainer)}catch(y){this._logger.error("could not go fullscreen",y)}h()};this._playButton.addEventListener("click",d),this._playButton.addEventListener("touchend",d),this._playButton.addEventListener("pointerup",d)})}}hidePlayButton(){this._playButtonShown=!1,this._playButton.style.display="none"}dispose(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}async onUserAction(){var t;await Tt(200,(t=this.engine)===null||t===void 0?void 0:t.clock),this.canvas.flagDirty(),await this.showPlayButton()}async onBeforeLoad(){const t=this._image;await this._imageLoaded.promise,await(t==null?void 0:t.decode())}async onAfterLoad(){this.screen.pixelRatioOverride=this._configuredPixelRatio,this.screen.popResolutionAndViewport(),this.screen.applyResolutionAndViewport(),this.dispose()}_positionPlayButton(){if(this.engine){const{x:t,y:i,width:r,height:a}=this.engine.canvas.getBoundingClientRect();if(this._playButtonRootElement){const h=this._playButton.clientWidth,d=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left=`${this.playButtonPosition.x}px`,this._playButtonRootElement.style.top=`${this.playButtonPosition.y}px`):(this._playButtonRootElement.style.left=`${t+r/2-h/2}px`,this._playButtonRootElement.style.top=`${i+a/2-d/2+100}px`)}}}onDraw(t){const i=this.engine.canvasHeight/this.engine.pixelRatio,r=this.engine.canvasWidth/this.engine.pixelRatio;this._positionPlayButton(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,r,i);let a=i/2;const h=Math.min(this.logoWidth,r*.75);let d=r/2-h/2;this.logoPosition&&(d=this.logoPosition.x,a=this.logoPosition.y);const p=Math.floor(h*(this.logoHeight/this.logoWidth)),m=this.engine.getAntialiasing();if(this.engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,d,a,h,p):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,d,a-p-20,h,p),!this.suppressPlayButton&&this._playButtonShown){this.engine.setAntialiasing(m);return}let y=d,w=a;this.loadingBarPosition&&(y=this.loadingBarPosition.x,w=this.loadingBarPosition.y),t.lineWidth=2,wh(t,y,w,h,20,10,this.loadingBarColor);const b=h*this.progress,R=5,k=b-R*2,M=20-R*2;wh(t,y+R,w+R,k>10?k:10,M,5,null,this.loadingBarColor),this.engine.setAntialiasing(m)}}Us._DEFAULT_LOADER_OPTIONS={loadables:[],fullscreenAfterLoad:!1,fullscreenContainer:void 0};const Vd={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"};class Gd{constructor(){this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){const t=document.createElement("canvas");return!!(t.getContext&&t.getContext("2d"))},arrayBufferSupport:function(){const t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch{return!1}return t.responseType==="arraybuffer"},dataUrlSupport:function(){return document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")===0},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){const t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){const t=document.createElement("canvas");return!!(t.getContext&&t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}getBrowserFeatures(){return this._features===null&&(this._features=this._loadBrowserFeatures()),this._features}logBrowserFeatures(){let t=`%cSUPPORTED BROWSER FEATURES
==========================%c
`;const i=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],r=this.getBrowserFeatures();for(const a of Object.keys(Vd))r[a]?(t+="(%c%c)",i.push("font-weight: bold; color: green"),i.push("font-weight: normal; color: inherit")):(t+="(%c%c)",i.push("font-weight: bold; color: red"),i.push("font-weight: normal; color: inherit")),t+=" "+Vd[a]+`
`;i.unshift(t),console.log.apply(console,i)}_loadBrowserFeatures(){return{canvas:this._criticalTests.canvasSupport(),arraybuffer:this._criticalTests.arrayBufferSupport(),dataurl:this._criticalTests.dataUrlSupport(),objecturl:this._criticalTests.objectUrlSupport(),rgba:this._criticalTests.rgbaSupport(),webaudio:this._warningTest.webAudioSupport(),webgl:this._warningTest.webglSupport(),gamepadapi:!!navigator.getGamepads}}test(){let t=!1;for(const i in this._criticalTests)this._criticalTests[i].call(this)||(this.failedTests.push(i),J.getInstance().error("Critical browser feature missing, Excalibur requires:",i),t=!0);if(t)return!1;for(const i in this._warningTest)this._warningTest[i]()||J.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",i);return!0}}var ut;(function(u){u.PreventCollision="PreventCollision",u.Passive="Passive",u.Active="Active",u.Fixed="Fixed"})(ut||(ut={}));var ie;(function(u){u.World="world",u.Screen="screen"})(ie||(ie={}));class xh extends E{constructor(t){super(0,0),this._getX=t.getX,this._getY=t.getY,this._setX=t.setX,this._setY=t.setY}get x(){return this._x=this._getX()}set x(t){this._setX(t),this._x=t}get y(){return this._y=this._getY()}set y(t){this._setY(t),this._y=t}}class Go extends E{constructor(t,i){super(t.x,t.y),this.original=t,this.change=i}get x(){return this._x=this.original.x}set x(t){this.change(t,this._y),this._x=this.original.x=t}get y(){return this._y=this.original.y}set y(t){this.change(this._x,t),this._y=this.original.y=t}}class zs{constructor(){this._parent=null,this._children=[],this._pos=B(0,0),this._rotation=0,this._scale=B(1,1),this._isDirty=!1,this._isInverseDirty=!1,this._matrix=xt.identity(),this._inverse=xt.identity()}get parent(){return this._parent}set parent(t){if(this._parent){const i=this._parent._children.indexOf(this);i>-1&&this._parent._children.splice(i,1)}this._parent=t,this._parent&&this._parent._children.push(this),this.flagDirty()}get children(){return this._children}set pos(t){t.equals(this._pos)||(this._pos.x=t.x,this._pos.y=t.y,this.flagDirty())}get pos(){return new Go(this._pos,(t,i)=>{(t!==this._pos.x||i!==this._pos.y)&&this.flagDirty()})}set globalPos(t){let i=t.clone();this.parent&&(i=this.parent.inverse.multiply(t)),i.equals(this._pos)||(this._pos=i,this.flagDirty())}get globalPos(){return new xh({getX:()=>this.matrix.data[4],getY:()=>this.matrix.data[5],setX:t=>{if(this.parent){const{x:i}=this.parent.inverse.multiply(B(t,this.pos.y));this.pos.x=i}else this.pos.x=t;t!==this.matrix.data[4]&&this.flagDirty()},setY:t=>{if(this.parent){const{y:i}=this.parent.inverse.multiply(B(this.pos.x,t));this.pos.y=i}else this.pos.y=t;t!==this.matrix.data[5]&&this.flagDirty()}})}set rotation(t){const i=P(t);i!==this._rotation&&this.flagDirty(),this._rotation=i}get rotation(){return this._rotation}set globalRotation(t){let i=0;this.parent&&(i=this.parent.globalRotation);const r=P(t+i);r!==this._rotation&&this.flagDirty(),this._rotation=r}get globalRotation(){return this.parent?this.matrix.getRotation():this.rotation}set scale(t){(t.x!==this._scale.x||t.y!==this._scale.y)&&(this._scale.x=t.x,this._scale.y=t.y,this.flagDirty())}get scale(){return new Go(this._scale,(t,i)=>{(t!==this._scale.x||i!==this._scale.y)&&this.flagDirty()})}set globalScale(t){let i=B(1,1);this.parent&&(i=this.parent.globalScale),this.scale=t.scale(B(1/i.x,1/i.y))}get globalScale(){return new xh({getX:()=>this.parent?this.matrix.getScaleX():this.scale.x,getY:()=>this.parent?this.matrix.getScaleY():this.scale.y,setX:t=>{if(this.parent){const i=this.parent.globalScale.x;this.scale.x=t/i}else this.scale.x=t},setY:t=>{if(this.parent){const i=this.parent.globalScale.y;this.scale.y=t/i}else this.scale.y=t}})}get matrix(){return this._isDirty&&(this.parent===null?this._matrix=this._calculateMatrix():this._matrix=this.parent.matrix.multiply(this._calculateMatrix()),this._isDirty=!1),this._matrix}get inverse(){return this._isInverseDirty&&(this._inverse=this.matrix.inverse(),this._isInverseDirty=!1),this._inverse}_calculateMatrix(){return xt.identity().translate(this.pos.x,this.pos.y).rotate(this.rotation).scale(this.scale.x,this.scale.y)}flagDirty(){this._isDirty=!0,this._isInverseDirty=!0;for(let t=0;t<this._children.length;t++)this._children[t].flagDirty()}apply(t){return this.matrix.multiply(t)}applyInverse(t){return this.inverse.multiply(t)}setTransform(t,i,r){this._pos.x=t.x,this._pos.y=t.y,this._rotation=P(i),this._scale.x=r.x,this._scale.y=r.y,this.flagDirty()}clone(t){const i=t??new zs;return this._pos.clone(i._pos),i._rotation=this._rotation,this._scale.clone(i._scale),i.flagDirty(),i}}function Xd(u){return!!u&&!!u.prototype&&!!u.prototype.constructor}function G0(u){return!!(u!=null&&u.clone)}class mi{constructor(){this.owner=void 0}clone(){const t=new this.constructor;for(const i in this)if(this.hasOwnProperty(i)){const r=this[i];G0(r)&&i!=="owner"&&i!=="clone"?t[i]=r.clone():t[i]=r}return t}}class xe{constructor(){this.observers=[],this.subscriptions=[]}register(t){this.observers.push(t)}subscribe(t){this.subscriptions.push(t)}unregister(t){const i=this.observers.indexOf(t);i!==-1&&this.observers.splice(i,1)}unsubscribe(t){const i=this.subscriptions.indexOf(t);i!==-1&&this.subscriptions.splice(i,1)}notifyAll(t){const i=this.observers.length;for(let a=0;a<i;a++)this.observers[a].notify(t);const r=this.subscriptions.length;for(let a=0;a<r;a++)this.subscriptions[a](t)}clear(){this.observers.length=0,this.subscriptions.length=0}}class it extends mi{constructor(){super(...arguments),this._logger=J.getInstance(),this._parentComponent=null,this._transform=new zs,this._addChildTransform=t=>{const i=t.get(it);i&&(i._transform.parent=this._transform,i._parentComponent=this)},this.zIndexChanged$=new xe,this._z=0,this._coordPlane=ie.World}get(){return this._transform}onAdd(t){for(const i of t.children)this._addChildTransform(i);t.childrenAdded$.subscribe(i=>this._addChildTransform(i)),t.childrenRemoved$.subscribe(i=>{const r=i.get(it);r&&(r._transform.parent=null,r._parentComponent=null)})}onRemove(t){this._transform.parent=null,this._parentComponent=null}get z(){return this._z}set z(t){const i=this._z;this._z=t,i!==t&&this.zIndexChanged$.notifyAll(t)}get coordPlane(){return this._parentComponent?this._parentComponent.coordPlane:this._coordPlane}set coordPlane(t){var i;this._parentComponent?this._logger.warn(`Cannot set coordinate plane on child entity ${(i=this.owner)===null||i===void 0?void 0:i.name}, children inherit their coordinate plane from their parents.`):this._coordPlane=t}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get globalPos(){return this._transform.globalPos}set globalPos(t){this._transform.globalPos=t}get rotation(){return this._transform.rotation}set rotation(t){this._transform.rotation=t}get globalRotation(){return this._transform.globalRotation}set globalRotation(t){this._transform.globalRotation=t}get scale(){return this._transform.scale}set scale(t){this._transform.scale=t}get globalScale(){return this._transform.globalScale}set globalScale(t){this._transform.globalScale=t}applyInverse(t){return this._transform.applyInverse(t)}apply(t){return this._transform.apply(t)}clone(){const t=new it;return t._transform=this._transform.clone(),t._z=this._z,t}}class Mt extends mi{constructor(){super(...arguments),this.vel=E.Zero,this.acc=E.Zero,this.scaleFactor=E.Zero,this.angularVelocity=0,this.torque=0,this.inertia=1}}class Ti{static create(t,i){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);if(this._GROUPS.get(t)){const a=this._GROUPS.get(t);if(a.mask===i)return a;throw new Error(`Collision group ${t} already exists with a different mask!`)}const r=new Hs(t,this._CURRENT_BIT,i!==void 0?i:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,r),r}static get groups(){return Array.from(this._GROUPS.values())}static groupByName(t){return this._GROUPS.get(t)}static reset(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}Ti._STARTING_BIT=1,Ti._MAX_GROUPS=32,Ti._CURRENT_GROUP=1,Ti._CURRENT_BIT=Ti._STARTING_BIT,Ti._GROUPS=new Map;class Hs{constructor(t,i,r){this._name=t,this._category=i,this._mask=r}get name(){return this._name}get category(){return this._category}get mask(){return this._mask}canCollide(t){const i=this.category&t.mask,r=this.mask&t.category;return i!==0&&r!==0}invert(){const t=Ti.create("~("+this.name+")",~this.mask|0);return t._category=~this.category,t}static combine(t){const i=t.map(h=>h.name).join("+"),a=~t.reduce((h,d)=>d.category|h,0);return Ti.create(i,a)}static collidesWith(t){const i=`collidesWith(${t.map(a=>a.name).join("+")})`,r=t.reduce((a,h)=>h.category|a,0);return Ti.create(i,r)}toString(){return`
category: ${this.category.toString(2).padStart(32,"0")}
mask:     ${(this.mask>>>0).toString(2).padStart(32,"0")}
    `}}Hs.All=new Hs("Collide with all groups",-1,-1);class qe{constructor(t,i){this.colliderA=t,this.colliderB=i,this.id=null,this.id=qe.calculatePairHash(t.id,i.id)}static canCollide(t,i){var r,a;const h=(r=t==null?void 0:t.owner)===null||r===void 0?void 0:r.get(ht),d=(a=i==null?void 0:i.owner)===null||a===void 0?void 0:a.get(ht);return!(t.id===i.id||t.owner&&i.owner&&t.owner.id===i.owner.id||t.localBounds.hasZeroDimensions()||i.localBounds.hasZeroDimensions()||!h||!d||!h.group.canCollide(d.group)||h.collisionType===ut.Fixed&&d.collisionType===ut.Fixed||d.collisionType===ut.PreventCollision||h.collisionType===ut.PreventCollision||!h.active||!d.active)}get canCollide(){const t=this.colliderA,i=this.colliderB;return qe.canCollide(t,i)}collide(){return this.colliderA.collide(this.colliderB)}hasCollider(t){return t===this.colliderA||t===this.colliderB}static calculatePairHash(t,i){return t.value<i.value?`#${t.value}+${i.value}`:`#${i.value}+${t.value}`}}class br{constructor(t,i){this.min=t,this.max=i}overlaps(t){return this.max>t.min&&t.max>this.min}getOverlap(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}class bh{constructor(t){this.parent=t,this.parent=t||null,this.data=null,this.bounds=new et,this.left=null,this.right=null,this.height=0}isLeaf(){return!this.left&&!this.right}}class Ch{constructor(t,i=new et(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)){this._config=t,this.worldBounds=i,this.root=null,this.nodes={}}_insert(t){if(this.root===null){this.root=t,this.root.parent=null;return}const i=t.bounds;let r=this.root;for(;!r.isLeaf();){const p=r.left,m=r.right,y=r.bounds.getPerimeter(),b=r.bounds.combine(i).getPerimeter(),R=2*b,k=2*(b-y);let M=0;const z=i.combine(p.bounds);let X,N;p.isLeaf()?M=z.getPerimeter()+k:(N=p.bounds.getPerimeter(),X=z.getPerimeter(),M=X-N+k);let U=0;const $=i.combine(m.bounds);if(m.isLeaf()?U=$.getPerimeter()+k:(N=m.bounds.getPerimeter(),X=$.getPerimeter(),U=X-N+k),R<M&&R<U)break;M<U?r=p:r=m}const a=r.parent,h=new bh(a);h.bounds=i.combine(r.bounds),h.height=r.height+1,a!==null?(a.left===r?a.left=h:a.right=h,h.left=r,h.right=t,r.parent=h,t.parent=h):(h.left=r,h.right=t,r.parent=h,t.parent=h,this.root=h);let d=t.parent;for(;d;){if(d=this._balance(d),!d.left)throw new Error("Parent of current leaf cannot have a null left child"+d);if(!d.right)throw new Error("Parent of current leaf cannot have a null right child"+d);d.height=1+Math.max(d.left.height,d.right.height),d.bounds=d.left.bounds.combine(d.right.bounds),d=d.parent}}_remove(t){if(t===this.root){this.root=null;return}const i=t.parent,r=i.parent;let a;if(i.left===t?a=i.right:a=i.left,r){r.left===i?r.left=a:r.right=a,a.parent=r;let h=r;for(;h;)h=this._balance(h),h.bounds=h.left.bounds.combine(h.right.bounds),h.height=1+Math.max(h.left.height,h.right.height),h=h.parent}else this.root=a,a.parent=null}trackCollider(t){const i=new bh;i.data=t,i.bounds=t.bounds,i.bounds.left-=2,i.bounds.top-=2,i.bounds.right+=2,i.bounds.bottom+=2,this.nodes[t.id.value]=i,this._insert(i)}updateCollider(t){var i;const r=this.nodes[t.id.value];if(!r)return!1;const a=t.bounds;if(!this.worldBounds.contains(a))return J.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(r.bounds.contains(a))return!1;if(this._remove(r),a.left-=this._config.boundsPadding,a.top-=this._config.boundsPadding,a.right+=this._config.boundsPadding,a.bottom+=this._config.boundsPadding,t.owner){const h=(i=t.owner)===null||i===void 0?void 0:i.get(ht);if(h){const d=h.vel.x*32/1e3*this._config.velocityMultiplier,p=h.vel.y*32/1e3*this._config.velocityMultiplier;d<0?a.left+=d:a.right+=d,p<0?a.top+=p:a.bottom+=p}}return r.bounds=a,this._insert(r),!0}untrackCollider(t){const i=this.nodes[t.id.value];i&&(this._remove(i),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}_balance(t){if(t===null)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;const i=t.left,r=t.right,a=t,h=i,d=r,p=i.left,m=i.right,y=r.left,w=r.right,b=d.height-h.height;if(b>1)return d.left=a,d.parent=a.parent,a.parent=d,d.parent?d.parent.left===a?d.parent.left=d:d.parent.right=d:this.root=d,y.height>w.height?(d.right=y,a.right=w,w.parent=a,a.bounds=h.bounds.combine(w.bounds),d.bounds=a.bounds.combine(y.bounds),a.height=1+Math.max(h.height,w.height),d.height=1+Math.max(a.height,y.height)):(d.right=w,a.right=y,y.parent=a,a.bounds=h.bounds.combine(y.bounds),d.bounds=a.bounds.combine(w.bounds),a.height=1+Math.max(h.height,y.height),d.height=1+Math.max(a.height,w.height)),d;if(b<-1){if(h.left=a,h.parent=a.parent,a.parent=h,h.parent)if(h.parent.left===a)h.parent.left=h;else{if(h.parent.right!==a)throw"Error rotating Dynamic Tree";h.parent.right=h}else this.root=h;return p.height>m.height?(h.right=p,a.left=m,m.parent=a,a.bounds=d.bounds.combine(m.bounds),h.bounds=a.bounds.combine(p.bounds),a.height=1+Math.max(d.height,m.height),h.height=1+Math.max(a.height,p.height)):(h.right=m,a.left=p,p.parent=a,a.bounds=d.bounds.combine(p.bounds),h.bounds=a.bounds.combine(m.bounds),a.height=1+Math.max(d.height,p.height),h.height=1+Math.max(a.height,m.height)),h}return t}getHeight(){return this.root===null?0:this.root.height}query(t,i){const r=t.bounds,a=h=>{if(h&&h.bounds.overlaps(r))if(h.isLeaf()&&h.data!==t){if(i.call(t,h.data))return!0}else return a(h.left)||a(h.right);return!1};a(this.root)}rayCastQuery(t,i=1/0,r){const a=h=>{if(h&&h.bounds.rayCast(t,i))if(h.isLeaf()){if(r.call(t,h.data))return!0}else return a(h.left)||a(h.right);return!1};a(this.root)}getNodes(){const t=i=>i?[i].concat(t(i.left),t(i.right)):[];return t(this.root)}debug(t){const i=r=>{r&&(r.isLeaf()?r.bounds.draw(t,G.Green):r.bounds.draw(t,G.White),r.left&&i(r.left),r.right&&i(r.right))};i(this.root)}}class Xi{constructor(t,i){this.pos=t,this.dir=i.normalize()}intersect(t){const i=t.begin.sub(this.pos);if(this.dir.cross(t.getSlope())===0&&i.cross(this.dir)!==0)return-1;const r=this.dir.cross(t.getSlope());if(r===0)return-1;const a=i.cross(t.getSlope())/r;if(a>=0){const h=i.cross(this.dir)/r/t.getLength();if(h>=0&&h<=1)return a}return-1}intersectPoint(t){const i=this.intersect(t);return i<0?null:this.getPoint(i)}getPoint(t){return this.pos.add(this.dir.scale(t))}}class Xo{constructor(t){this._config=t,this._pairs=new Set,this._collisionPairCache=[],this._colliders=[],this._dynamicCollisionTree=new Ch(t.dynamicTree)}getColliders(){return this._colliders}rayCast(t,i){var r,a,h;const d=[],p=(r=i==null?void 0:i.maxDistance)!==null&&r!==void 0?r:1/0,m=i==null?void 0:i.collisionGroup,y=m?m.category:(a=i==null?void 0:i.collisionMask)!==null&&a!==void 0?a:Hs.All.category,w=(h=i==null?void 0:i.searchAllColliders)!==null&&h!==void 0?h:!1;return this._dynamicCollisionTree.rayCastQuery(t,p,b=>{const k=b.owner.get(ht);if(i!=null&&i.ignoreCollisionGroupAll&&k.group===Hs.All)return!1;const M=(y&k.group.category)!==0;if(k!=null&&k.group&&!M)return!1;const z=b.rayCast(t,p);if(z){if(i!=null&&i.filter){if(i.filter(z)&&(d.push(z),!w))return!0}else if(d.push(z),!w)return!0}return!1}),d}track(t){if(!t){J.getInstance().warn("Cannot track null collider");return}if(t instanceof de){const i=t.getColliders();for(const r of i)r.owner=t.owner,this._colliders.push(r),this._dynamicCollisionTree.trackCollider(r)}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t)}untrack(t){if(!t){J.getInstance().warn("Cannot untrack a null collider");return}if(t instanceof de){const i=t.getColliders();for(const r of i){const a=this._colliders.indexOf(r);a!==-1&&this._colliders.splice(a,1),this._dynamicCollisionTree.untrackCollider(r)}}else{const i=this._colliders.indexOf(t);i!==-1&&this._colliders.splice(i,1),this._dynamicCollisionTree.untrackCollider(t)}}_pairExists(t,i){const r=qe.calculatePairHash(t.id,i.id);return this._pairs.has(r)}broadphase(t,i,r){const a=i/1e3,h=t.filter(p=>{var m,y;const w=(m=p.owner)===null||m===void 0?void 0:m.get(ht);return((y=p.owner)===null||y===void 0?void 0:y.active)&&w.collisionType!==ut.PreventCollision});this._collisionPairCache=[],this._pairs.clear();let d;for(let p=0,m=h.length;p<m;p++)d=h[p],this._dynamicCollisionTree.query(d,y=>{if(!this._pairExists(d,y)&&qe.canCollide(d,y)){const w=new qe(d,y);this._pairs.add(w.id),this._collisionPairCache.push(w)}return!1});if(r&&(r.physics.pairs=this._collisionPairCache.length),this._config.continuous.checkForFastBodies)for(const p of h){const m=p.owner.get(ht);if(m.collisionType!==ut.Active)continue;const y=m.vel.size*a+m.acc.size*.5*a*a,w=Math.min(p.bounds.height,p.bounds.width);if(this._config.continuous.disableMinimumSpeedForFastBody||y>w/2){r&&r.physics.fastBodies++;const b=m.globalPos.sub(m.oldPos),R=p.center,k=p.getFurthestPoint(m.vel),M=k.sub(b),z=new Xi(M,m.vel);z.pos=z.pos.add(z.dir.scale(-2*this._config.continuous.surfaceEpsilon));let X,N=new E(1/0,1/0);if(this._dynamicCollisionTree.rayCastQuery(z,y+this._config.continuous.surfaceEpsilon*2,U=>{if(!this._pairExists(p,U)&&qe.canCollide(p,U)){const $=U.rayCast(z,y+this._config.continuous.surfaceEpsilon*10);if($){const W=$.point.sub(M);W.size<N.size&&(N=W,X=U)}}return!1}),X&&E.isValid(N)){const U=new qe(p,X);this._pairs.has(U.id)||(this._pairs.add(U.id),this._collisionPairCache.push(U));const $=R.sub(k);m.globalPos=M.add($).add(N).add(z.dir.scale(10*this._config.continuous.surfaceEpsilon)),p.update(m.transform.get()),r&&r.physics.fastBodyCollisions++}}}return this._collisionPairCache}narrowphase(t,i){let r=[];for(let a=0;a<t.length;a++){const h=t[a].collide();if(r=r.concat(h),i&&h.length>0)for(const d of h)i.physics.contacts.set(d.id,d)}return i&&(i.physics.collisions+=r.length),r}update(t){let i=0;const r=t.length;for(let a=0;a<r;a++)this._dynamicCollisionTree.updateCollider(t[a])&&i++;return i}debug(t){this._dynamicCollisionTree.debug(t)}}class as{constructor(){this.id=g("collider",as._ID++),this.composite=null,this.events=new v,this.offset=E.Zero}touching(t){return!!this.collide(t)}}as._ID=0;var ls;(function(u){u.Arcade="arcade",u.Realistic="realistic"})(ls||(ls={}));var $o;(function(u){u[u.DynamicAABBTree=0]="DynamicAABBTree"})($o||($o={}));var Yo;(function(u){u[u.Euler=0]="Euler"})(Yo||(Yo={}));class ct{static get gravity(){return ct.acc}static set gravity(t){ct.acc=t}static useArcadePhysics(){ct.collisionResolutionStrategy=ls.Arcade}static useRealisticPhysics(){ct.collisionResolutionStrategy=ls.Realistic}}ct.acc=new E(0,0),ct.enabled=!0,ct.broadphaseStrategy=$o.DynamicAABBTree,ct.collisionResolutionStrategy=ls.Arcade,ct.defaultMass=10,ct.integrator=Yo.Euler,ct.dynamicTreeVelocityMultiplier=2,ct.boundsPadding=5,ct.positionIterations=3,ct.velocityIterations=8,ct.slop=1,ct.steeringFactor=.2,ct.warmStart=!0,ct.bodiesCanSleepByDefault=!1,ct.surfaceEpsilon=.1,ct.sleepEpsilon=.07,ct.wakeThreshold=ct.sleepEpsilon*3,ct.sleepBias=.9,ct.checkForFastBodies=!0,ct.disableMinimumSpeedForFastBody=!1;var js;(function(u){u.None="none",u.VerticalFirst="vertical-first",u.HorizontalFirst="horizontal-first"})(js||(js={}));const $d={vertical:1,horizontal:2},Yd={horizontal:1,vertical:2},Qd={horizontal:0,vertical:0},Pi={enabled:!0,gravity:B(0,0),solver:ls.Arcade,colliders:{compositeStrategy:"together"},continuous:{checkForFastBodies:!0,disableMinimumSpeedForFastBody:!1,surfaceEpsilon:.1},bodies:{canSleepByDefault:!1,sleepEpsilon:.07,wakeThreshold:.07*3,sleepBias:.9,defaultMass:10},dynamicTree:{boundsPadding:5,velocityMultiplier:2},arcade:{contactSolveBias:js.None},realistic:{positionIterations:3,velocityIterations:8,slop:1,steeringFactor:.2,warmStart:!0}};function Sh(){return{enabled:ct.enabled,gravity:ct.gravity,solver:ct.collisionResolutionStrategy,continuous:{checkForFastBodies:ct.checkForFastBodies,disableMinimumSpeedForFastBody:ct.disableMinimumSpeedForFastBody,surfaceEpsilon:ct.surfaceEpsilon},colliders:{compositeStrategy:"together"},bodies:{canSleepByDefault:ct.bodiesCanSleepByDefault,sleepEpsilon:ct.sleepEpsilon,wakeThreshold:ct.wakeThreshold,sleepBias:ct.sleepBias,defaultMass:ct.defaultMass},dynamicTree:{boundsPadding:ct.boundsPadding,velocityMultiplier:ct.dynamicTreeVelocityMultiplier},arcade:{contactSolveBias:js.None},realistic:{positionIterations:ct.positionIterations,velocityIterations:ct.velocityIterations,slop:ct.slop,steeringFactor:ct.steeringFactor,warmStart:ct.warmStart}}}class de extends as{set compositeStrategy(t){this._compositeStrategy=t}get compositeStrategy(){return this._compositeStrategy}constructor(t){super(),this._collisionProcessor=new Xo(Pi),this._dynamicAABBTree=new Ch(Pi.dynamicTree),this._colliders=[];for(const i of t)this.addCollider(i)}clearColliders(){this._colliders=[]}addCollider(t){let i;t instanceof de?(i=t.getColliders(),i.forEach(r=>r.offset.addEqual(t.offset))):i=[t];for(const r of i)r.events.pipe(this.events),r.composite=this,this._colliders.push(r),this._collisionProcessor.track(r),this._dynamicAABBTree.trackCollider(r)}removeCollider(t){t.events.pipe(this.events),t.composite=null,lt(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}getColliders(){return this._colliders}get worldPos(){var t,i;return((i=(t=this._transform)===null||t===void 0?void 0:t.pos)!==null&&i!==void 0?i:E.Zero).add(this.offset)}get center(){var t,i;return((i=(t=this._transform)===null||t===void 0?void 0:t.pos)!==null&&i!==void 0?i:E.Zero).add(this.offset)}get bounds(){var t,i;const r=this.getColliders();return r.reduce((h,d)=>h.combine(d.bounds),(i=(t=r[0])===null||t===void 0?void 0:t.bounds)!==null&&i!==void 0?i:new et().translate(this.worldPos)).translate(this.offset)}get localBounds(){var t,i;const r=this.getColliders();return r.reduce((h,d)=>h.combine(d.localBounds),(i=(t=r[0])===null||t===void 0?void 0:t.localBounds)!==null&&i!==void 0?i:new et)}get axes(){const t=this.getColliders();let i=[];for(const r of t)i=i.concat(r.axes);return i}getFurthestPoint(t){const i=this.getColliders(),r=[];for(const d of i)r.push(d.getFurthestPoint(t));let a=r[0],h=-Number.MAX_VALUE;for(const d of r){const p=d.dot(t);p>h&&(a=d,h=p)}return a}getInertia(t){const i=this.getColliders();let r=0;for(const a of i)r+=a.getInertia(t);return r}collide(t){let i=[t];t instanceof de&&(i=t.getColliders());const r=[];for(const h of i)this._dynamicAABBTree.query(h,d=>(r.push(new qe(h,d)),!1));let a=[];for(const h of r)a=a.concat(h.collide());return a}getClosestLineBetween(t){const i=this.getColliders(),r=[];if(t instanceof de){const a=t.getColliders();for(const h of i)for(const d of a){const p=h.getClosestLineBetween(d);p&&r.push(p)}}else for(const a of i){const h=t.getClosestLineBetween(a);h&&r.push(h)}if(r.length){let a=r[0].getLength(),h=r[0];for(const d of r){const p=d.getLength();p<a&&(a=p,h=d)}return h}return null}contains(t){const i=this.getColliders();for(const r of i)if(r.contains(t))return!0;return!1}rayCast(t,i){const r=this.getColliders(),a=[];for(const h of r){const d=h.rayCast(t,i);d&&a.push(d)}if(a.length){let h=a[0],d=h.point.dot(t.dir);for(const p of a){const m=t.dir.dot(p.point);m<d&&(h=p,d=m)}return h}return null}project(t){const i=this.getColliders(),r=[];for(const a of i){const h=a.project(t);h&&r.push(h)}if(r.length){const a=new br(r[0].min,r[0].max);for(const h of r)a.min=Math.min(h.min,a.min),a.max=Math.max(h.max,a.max);return a}return null}update(t){if(t){const i=this.getColliders();for(const r of i)r.owner=this.owner,r.update(t)}}debug(t,i,r){const a=this.getColliders();t.save(),t.translate(this.offset.x,this.offset.y);for(const h of a)h.debug(t,i,r);t.restore()}clone(){const t=new de(this._colliders.map(i=>i.clone()));return t.offset=this.offset.clone(),t}}class Ae{constructor(t,i){this.begin=t,this.end=i}get slope(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}get intercept(){return this.begin.y-this.slope*this.begin.x}normal(){return this._normal?this._normal:this._normal=this.end.sub(this.begin).normal()}dir(){return this._dir?this._dir:this._dir=this.end.sub(this.begin)}getPoints(){return[this.begin,this.end]}getSlope(){if(this._slope)return this._slope;const t=this.begin,i=this.end,r=t.distance(i);return this._slope=i.sub(t).scale(1/r)}getEdge(){const t=this.begin;return this.end.sub(t)}getLength(){if(this._length)return this._length;const t=this.begin,i=this.end,r=t.distance(i);return this._length=r}get midpoint(){return this.begin.add(this.end).scale(.5)}flip(){return new Ae(this.end,this.begin)}below(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}clip(t,i){let r=t;r=r.normalize();const a=r.dot(this.begin)-i,h=r.dot(this.end)-i,d=[];if(a<=0&&d.push(this.begin),h<=0&&d.push(this.end),a*h<0){const p=a/(a-h);d.push(this.begin.add(this.end.sub(this.begin).scale(p)))}return d.length!==2?null:new Ae(d[0],d[1])}distanceToPoint(t,i=!1){const r=t.x,a=t.y,h=this.getLength(),d=this.end.y-this.begin.y,p=this.end.x-this.begin.x,m=(d*r-p*a+this.end.x*this.begin.y-this.end.y*this.begin.x)/h;return i?m:Math.abs(m)}findVectorToPoint(t){const i=this.begin.sub(t),r=this.getSlope();return i.sub(r.scale(i.dot(r)))}findPoint(t=null,i=null){const r=this.slope,a=this.intercept;if(t!==null)return new E(t,r*t+a);if(i!==null)return new E((i-a)/r,i);throw new Error("You must provide an X or a Y value")}hasPoint(){let t,i=0;if(typeof arguments[0]=="number"&&typeof arguments[1]=="number")t=new E(arguments[0],arguments[1]),i=arguments[2]||0;else if(arguments[0]instanceof E)t=arguments[0],i=arguments[1]||0;else throw"Could not determine the arguments for Vector.hasPoint";const r=t.x-this.begin.x,a=t.y-this.begin.y,h=this.end.x-this.begin.x,d=this.end.y-this.begin.y,p=r*d-a*h;return Math.abs(p)>i?!1:Math.abs(h)>=Math.abs(d)?h>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:d>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y}}function Qo(u,t,i,r){const a=u.sub(i),h=t.dot(t),d=t.dot(r),p=r.dot(r),m=t.dot(a),y=r.dot(a),w=h*p-d*d;let b=w,R=w;if(w===0||w<=.01){const z=m/d;return new Ae(u,i.add(r.scale(z)))}let k=d*y-p*m,M=h*y-d*m;return k<0?(k=0,M=y,R=p):k>b&&(k=b,M=y+d,R=p),M<0?(M=0,-m<0?k=0:-m>h?k=b:(k=-m,b=h)):M>R&&(M=R,-m+d<0?k=0:-m+d>h?k=b:(k=-m+d,b=h)),k=Math.abs(k)<.001?0:k/b,M=Math.abs(M)<.001?0:M/R,new Ae(u.add(t.scale(k)),i.add(r.scale(M)))}const Ri={PolygonPolygonClosestLine(u,t){const i=t.worldPos,r=i.sub(u.worldPos),a=r.negate(),h=new Xi(u.worldPos,r),d=new Xi(i,a),p=u.rayCast(h).point.add(h.dir.scale(.1)),m=t.rayCast(d).point.add(d.dir.scale(.1)),y=u.getClosestFace(p),w=t.getClosestFace(m),b=y.face.begin,R=y.face.getEdge(),k=w.face.begin,M=w.face.getEdge();return Qo(b,R,k,M)},PolygonEdgeClosestLine(u,t){const r=t.worldPos.sub(u.worldPos),a=new Xi(u.worldPos,r),h=u.rayCast(a).point.add(a.dir.scale(.1)),d=u.getClosestFace(h),p=d.face.begin,m=d.face.getEdge(),y=t.asLine(),w=y.begin,b=y.getEdge();return Qo(p,m,w,b)},PolygonCircleClosestLine(u,t){const i=t.worldPos,r=i.sub(u.worldPos),a=new Xi(u.worldPos,r.normalize()),h=u.rayCast(a).point.add(a.dir.scale(.1)),d=u.getClosestFace(h),p=d.face.begin,m=d.face.getEdge();let y=(m.x*(i.x-p.x)+m.y*(i.y-p.y))/(m.x*m.x+m.y*m.y);y>1?y=1:y<0&&(y=0);const w=Math.sqrt(Math.pow(p.x+m.x*y-i.x,2)+Math.pow(p.y+m.y*y-i.y,2))-t.radius,b=(p.x+m.x*y-i.x)*t.radius/(t.radius+w),R=(p.y+m.y*y-i.y)*t.radius/(t.radius+w);return new Ae(m.scale(y).add(p),new E(i.x+b,i.y+R))},CircleCircleClosestLine(u,t){const r=t.worldPos.sub(u.worldPos),h=u.worldPos.sub(t.worldPos),d=new Xi(u.worldPos,r),p=new Xi(t.worldPos,h),m=u.rayCast(d),y=t.rayCast(p);return new Ae(m.point,y.point)},CircleEdgeClosestLine(u,t){const i=u.worldPos,r=t.asLine(),a=r.begin,h=r.getEdge(),d=a,p=h;let m=(p.x*(i.x-d.x)+p.y*(i.y-d.y))/(p.x*p.x+p.y*p.y);m>1?m=1:m<0&&(m=0);const y=Math.sqrt(Math.pow(d.x+p.x*m-i.x,2)+Math.pow(d.y+p.y*m-i.y,2))-u.radius,w=(d.x+p.x*m-i.x)*u.radius/(u.radius+y),b=(d.y+p.y*m-i.y)*u.radius/(u.radius+y);return new Ae(p.scale(m).add(d),new E(i.x+w,i.y+b))},EdgeEdgeClosestLine(u,t){const i=u.asLine(),r=i.begin,a=i.getEdge(),h=r,d=a,p=t.asLine(),m=p.begin,y=p.getEdge();return Qo(h,d,m,y)}};class fe extends as{get worldPos(){return this._globalMatrix.getPosition()}get radius(){var t;const i=this._transform,r=(t=i==null?void 0:i.globalScale)!==null&&t!==void 0?t:E.One;return this._naturalRadius*Math.min(r.x,r.y)}set radius(t){var i;const r=this._transform,a=(i=r==null?void 0:r.globalScale)!==null&&i!==void 0?i:E.One;this._naturalRadius=t/Math.min(a.x,a.y)}constructor(t){super(),this.offset=E.Zero,this._globalMatrix=xt.identity(),this.offset=t.offset||E.Zero,this.radius=t.radius||0,this._globalMatrix.translate(this.offset.x,this.offset.y)}clone(){return new fe({offset:this.offset.clone(),radius:this.radius})}get center(){return this._globalMatrix.getPosition()}contains(t){var i,r;return((r=(i=this._transform)===null||i===void 0?void 0:i.pos)!==null&&r!==void 0?r:this.offset).distance(t)<=this.radius}rayCast(t,i=1/0){var r,a;const h=this.center,d=t.dir,p=t.pos,m=Math.sqrt(Math.pow(d.dot(p.sub(h)),2)-Math.pow(p.sub(h).distance(),2)+Math.pow(this.radius,2));if(m<0)return null;{let y=0;if(m===0){if(y=-d.dot(p.sub(h)),y>0&&y<i){const w=t.getPoint(y);return{point:w,normal:w.sub(h).normalize(),collider:this,body:(r=this.owner)===null||r===void 0?void 0:r.get(ht),distance:y}}return null}else{const w=-d.dot(p.sub(h))+m,b=-d.dot(p.sub(h))-m,R=[];w>=0&&R.push(w),b>=0&&R.push(b);const k=Math.min(...R);if(k<=i){const M=t.getPoint(k);return{point:M,normal:M.sub(h).normalize(),collider:this,body:(a=this.owner)===null||a===void 0?void 0:a.get(ht),distance:k}}return null}}}getClosestLineBetween(t){if(t instanceof fe)return Ri.CircleCircleClosestLine(this,t);if(t instanceof le)return Ri.PolygonCircleClosestLine(t,this).flip();if(t instanceof Le)return Ri.CircleEdgeClosestLine(this,t).flip();throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof fe)return _i.CollideCircleCircle(this,t);if(t instanceof le)return _i.CollideCirclePolygon(this,t);if(t instanceof Le)return _i.CollideCircleEdge(this,t);throw new Error(`Circle could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){return this.center.add(t.normalize().scale(this.radius))}getFurthestLocalPoint(t){return t.normalize().scale(this.radius)}get bounds(){var t,i,r;const a=this._transform,h=(t=a==null?void 0:a.globalScale)!==null&&t!==void 0?t:E.One,d=(i=a==null?void 0:a.globalRotation)!==null&&i!==void 0?i:0,p=(r=a==null?void 0:a.globalPos)!==null&&r!==void 0?r:E.Zero;return new et(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius).rotate(d).scale(h).translate(p)}get localBounds(){return new et(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius)}get axes(){return[]}getInertia(t){return t*this.radius*this.radius/2}update(t){var i;this._transform=t,((i=t.matrix)!==null&&i!==void 0?i:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const i=[],a=this.center.dot(t);return i.push(a),i.push(a+this.radius),i.push(a-this.radius),new br(Math.min.apply(Math,i),Math.max.apply(Math,i))}debug(t,i,r){var a,h,d,p;const{lineWidth:m}={lineWidth:1,...r},y=this._transform,w=(a=y==null?void 0:y.globalScale)!==null&&a!==void 0?a:E.One,b=(h=y==null?void 0:y.globalRotation)!==null&&h!==void 0?h:0,R=(d=y==null?void 0:y.globalPos)!==null&&d!==void 0?d:E.Zero;t.save(),t.translate(R.x,R.y),t.rotate(b),t.scale(w.x,w.y),t.drawCircle((p=this.offset)!==null&&p!==void 0?p:E.Zero,this._naturalRadius,G.Transparent,i,m),t.restore()}}class Ws{constructor(t,i,r,a,h,d,p,m){var y,w,b,R,k,M;if(this._canceled=!1,this.colliderA=t,this.colliderB=i,this.mtv=r,this.normal=a,this.tangent=h,this.points=d,this.localPoints=p,this.info=m,this.id=qe.calculatePairHash(t.id,i.id),t.composite||i.composite){const z=((y=t.composite)===null||y===void 0?void 0:y.compositeStrategy)==="separate"?t.id:(b=(w=t.composite)===null||w===void 0?void 0:w.id)!==null&&b!==void 0?b:t.id,X=((R=i.composite)===null||R===void 0?void 0:R.compositeStrategy)==="separate"?i.id:(M=(k=i.composite)===null||k===void 0?void 0:k.id)!==null&&M!==void 0?M:i.id;this.id+="|"+qe.calculatePairHash(z,X)}}matchAwake(){const t=this.colliderA.owner.get(ht),i=this.colliderB.owner.get(ht);t&&i&&t.sleeping!==i.sleeping&&(t.sleeping&&t.collisionType!==ut.Fixed&&i.sleepMotion>=t.wakeThreshold&&t.setSleeping(!1),i.sleeping&&i.collisionType!==ut.Fixed&&t.sleepMotion>=i.wakeThreshold&&i.setSleeping(!1))}isCanceled(){return this._canceled}cancel(){this._canceled=!0}}class Eh{static findPolygonPolygonSeparation(t,i){let r=-Number.MAX_VALUE,a=null,h=null,d=-1,p=null;const m=t.getSides(),y=t.getLocalSides();for(let w=0;w<m.length;w++){const b=m[w],R=b.normal(),k=i.getFurthestPoint(R.negate()),M=b.distanceToPoint(k,!0);M>r&&(r=M,a=b,h=R,d=w,p=k)}return{collider:t,separation:h?r:99,axis:h,side:a,localSide:y[d],sideId:d,point:p,localPoint:h?i.getFurthestLocalPoint(h.negate()):null}}static findCirclePolygonSeparation(t,i){const r=i.axes,h=i.center.sub(t.worldPos),d=i.getFurthestPoint(h.negate());r.push(d.sub(t.worldPos).normalize());let p=Number.MAX_VALUE,m=null,y=-1;for(let w=0;w<r.length;w++){const b=i.project(r[w]),R=t.project(r[w]),k=b.getOverlap(R);if(k<=0)return null;k<p&&(p=k,m=r[w],y=w)}return y<0?null:m.normalize().scale(p)}}const _i={CollideCircleCircle(u,t){const i=u.worldPos,r=t.worldPos,a=u.radius+t.radius,h=i.distance(r);if(h>a)return[];const d=a-h,p=r.sub(i).normalize(),m=p.perpendicular(),y=p.scale(d),w=u.getFurthestPoint(p),b=u.getFurthestLocalPoint(p),R={collider:u,separation:d,axis:p,point:w};return[new Ws(u,t,y,p,m,[w],[b],R)]},CollideCirclePolygon(u,t){var i,r;let a=Eh.findCirclePolygonSeparation(u,t);if(!a)return[];a=a.dot(t.center.sub(u.center))<0?a.negate():a;const d=u.getFurthestPoint(a),m=((r=(i=u.owner)===null||i===void 0?void 0:i.get(it))!==null&&r!==void 0?r:new it).applyInverse(d),y=a.normalize(),w={collider:u,separation:-a.size,axis:y,point:d,localPoint:m,side:t.findSide(y.negate()),localSide:t.findLocalSide(y.negate())};return[new Ws(u,t,a,y,y.perpendicular(),[d],[m],w)]},CollideCircleEdge(u,t){const i=u.center,r=t.asLine(),a=r.end.sub(r.begin),h=a.dot(r.end.sub(i)),d=a.dot(i.sub(r.begin)),p=t.asLine(),m=t.asLocalLine();if(d<=0){const N=r.begin.sub(i),U=N.dot(N);if(U>u.radius*u.radius)return[];const $=N.normalize(),W=u.radius-Math.sqrt(U),tt={collider:u,separation:W,axis:$,point:p.begin,side:p,localSide:m};return[new Ws(u,t,$.scale(W),$,$.perpendicular(),[p.begin],[m.begin],tt)]}if(h<=0){const N=r.end.sub(i),U=N.dot(N);if(U>u.radius*u.radius)return[];const $=N.normalize(),W=u.radius-Math.sqrt(U),tt={collider:u,separation:W,axis:$,point:p.end,side:p,localSide:m};return[new Ws(u,t,$.scale(W),$,$.perpendicular(),[p.end],[m.end],tt)]}const y=a.dot(a),w=r.begin.scale(h).add(r.end.scale(d)).scale(1/y),b=i.sub(w),R=b.dot(b);if(R>u.radius*u.radius)return[];let k=a.perpendicular();k.dot(i.sub(r.begin))<0&&(k.x=-k.x,k.y=-k.y),k=k.normalize();const M=u.radius-Math.sqrt(R),z=k.scale(M),X={collider:u,separation:M,axis:k,point:w,side:p,localSide:m};return[new Ws(u,t,z,k.negate(),k.negate().perpendicular(),[w],[w.sub(t.worldPos)],X)]},CollideEdgeEdge(){return[]},CollidePolygonEdge(u,t){var i;const r=u.center,h=t.center.sub(r).normalize(),d=new le({points:[t.begin,t.end,t.end.add(h.scale(100)),t.begin.add(h.scale(100))],offset:t.offset});d.owner=t.owner,((i=t.owner)===null||i===void 0?void 0:i.get(it))&&d.update(t.owner.get(it).get());const m=this.CollidePolygonPolygon(u,d);return m.length&&(m[0].colliderB=t,m[0].id=qe.calculatePairHash(u.id,t.id)),m},CollidePolygonPolygon(u,t){var i,r,a,h;const d=Eh.findPolygonPolygonSeparation(u,t);if(d.separation>0)return[];const p=Eh.findPolygonPolygonSeparation(t,u);if(p.separation>0)return[];const m=d.separation>p.separation?d:p,w=(m.collider===u?t:u).findSide(m.axis.negate()),b=m.side,R=b.dir().normalize(),k=w.clip(R.negate(),-R.dot(b.begin));let M=null;if(k&&(M=k.clip(R,R.dot(b.end))),M){const z=M.getPoints().filter($=>b.below($));let X=m.axis,N=X.perpendicular();t.center.sub(u.center).dot(X)<0&&(X=X.negate(),N=X.perpendicular());let U=[];if(m.collider===u){const $=(r=(i=t.owner)===null||i===void 0?void 0:i.get(it))!==null&&r!==void 0?r:new it;U=z.map(W=>$.applyInverse(W))}else{const $=(h=(a=u.owner)===null||a===void 0?void 0:a.get(it))!==null&&h!==void 0?h:new it;U=z.map(W=>$.applyInverse(W))}return[new Ws(u,t,X.scale(-m.separation),X,N,z,U,m)]}return[]},FindContactSeparation(u,t){var i,r,a,h;const d=u.colliderA,p=(r=(i=u.colliderA.owner)===null||i===void 0?void 0:i.get(it))!==null&&r!==void 0?r:new it,m=u.colliderB,y=(h=(a=u.colliderB.owner)===null||a===void 0?void 0:a.get(it))!==null&&h!==void 0?h:new it;if(d instanceof fe&&m instanceof fe){const w=d.radius+m.radius,b=p.pos.distance(y.pos);return-(w-b)}if(d instanceof le&&m instanceof le&&u.info.localSide){let w,b;return u.info.collider===d?(w=new Ae(p.apply(u.info.localSide.begin),p.apply(u.info.localSide.end)),b=y.apply(t)):(w=new Ae(y.apply(u.info.localSide.begin),y.apply(u.info.localSide.end)),b=p.apply(t)),w.distanceToPoint(b,!0)}if(d instanceof le&&m instanceof fe||m instanceof le&&d instanceof fe){const w=p.apply(t);if(u.info.side)return u.info.side.distanceToPoint(w,!0)}if(d instanceof Le&&m instanceof le||m instanceof Le&&d instanceof le){let w;if(u.info.collider===d?w=y.apply(t):w=p.apply(t),u.info.side)return u.info.side.distanceToPoint(w,!0)}if(d instanceof fe&&m instanceof Le||m instanceof fe&&d instanceof Le){const w=y.apply(t);let b;d instanceof fe&&(b=d.getFurthestPoint(u.normal));const R=w.distance(b);if(u.info.side)return R>0?-R:0}return 0}};class Le extends as{constructor(t){var i;super(),this._globalMatrix=xt.identity(),this.begin=t.begin||E.Zero,this.end=t.end||E.Zero,this.offset=(i=t.offset)!==null&&i!==void 0?i:E.Zero}clone(){return new Le({begin:this.begin.clone(),end:this.end.clone()})}get worldPos(){var t;const i=this._transform;return(t=i==null?void 0:i.globalPos.add(this.offset))!==null&&t!==void 0?t:this.offset}get center(){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return t.average(i)}_getTransformedBegin(){return this._globalMatrix.multiply(this.begin)}_getTransformedEnd(){return this._globalMatrix.multiply(this.end)}getSlope(){const t=this._getTransformedBegin(),i=this._getTransformedEnd(),r=t.distance(i);return i.sub(t).scale(1/r)}getLength(){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return t.distance(i)}contains(){return!1}rayCast(t,i=1/0){var r;const a=this._getTransformedBegin().sub(t.pos);if(t.dir.cross(this.getSlope())===0&&a.cross(t.dir)!==0)return null;const h=t.dir.cross(this.getSlope());if(h===0)return null;const d=a.cross(this.getSlope())/h;if(d>=0&&d<=i){const p=a.cross(t.dir)/h/this.getLength();if(p>=0&&p<=1)return{distance:d,normal:this.asLine().normal(),collider:this,body:(r=this.owner)===null||r===void 0?void 0:r.get(ht),point:t.getPoint(d)}}return null}getClosestLineBetween(t){if(t instanceof fe)return Ri.CircleEdgeClosestLine(t,this);if(t instanceof le)return Ri.PolygonEdgeClosestLine(t,this).flip();if(t instanceof Le)return Ri.EdgeEdgeClosestLine(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof fe)return _i.CollideCircleEdge(t,this);if(t instanceof le)return _i.CollidePolygonEdge(t,this);if(t instanceof Le)return _i.CollideEdgeEdge();throw new Error(`Edge could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){const i=this._getTransformedBegin(),r=this._getTransformedEnd();return t.dot(i)>0?i:r}_boundsFromBeginEnd(t,i,r=10){return new et(Math.min(t.x,i.x)-r,Math.min(t.y,i.y)-r,Math.max(t.x,i.x)+r,Math.max(t.y,i.y)+r)}get bounds(){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return this._boundsFromBeginEnd(t,i)}get localBounds(){return this._boundsFromBeginEnd(this.begin,this.end)}asLine(){return new Ae(this._getTransformedBegin(),this._getTransformedEnd())}asLocalLine(){return new Ae(this.begin,this.end)}get axes(){const i=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),r=[];return r.push(i),r.push(i.negate()),r.push(i.normal()),r.push(i.normal().negate()),r}getInertia(t){const i=this.end.sub(this.begin).distance()/2;return t*i*i}update(t){var i;this._transform=t,((i=t.matrix)!==null&&i!==void 0?i:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const i=[],r=[this._getTransformedBegin(),this._getTransformedEnd()],a=r.length;for(let h=0;h<a;h++)i.push(r[h].dot(t));return new br(Math.min.apply(Math,i),Math.max.apply(Math,i))}debug(t,i){const r=this._getTransformedBegin(),a=this._getTransformedEnd();t.drawLine(r,a,i,2),t.drawCircle(r,2,i),t.drawCircle(a,2,i)}}class se{static registerGraphicsContext(t){se._ctx=t}static draw(t){this._drawCalls.push(t)}static drawPoint(t,i){se.draw(r=>{r.debug.drawPoint(t,i)})}static drawLine(t,i,r){se.draw(a=>{a.debug.drawLine(t,i,r)})}static drawLines(t,i){t.length>1&&se.draw(r=>{for(let a=0;a<t.length-1;a++)r.debug.drawLine(t[a],t[a+1],i)})}static drawText(t,i){se.draw(r=>{r.debug.drawText(t,i)})}static drawPolygon(t,i){t.length>1&&se.draw(r=>{const a=t[0],h=[...t,a];for(let d=0;d<h.length-1;d++)r.debug.drawLine(h[d],h[d+1],i)})}static drawCircle(t,i,r){const{color:a,strokeColor:h,width:d}={color:G.Black,strokeColor:void 0,width:void 0,...r};se.draw(p=>{p.drawCircle(t,i,a,h,d)})}static drawBounds(t,i){se.draw(r=>{r.debug.drawRect(t.left,t.top,t.width,t.height,i)})}static drawRay(t,i){const{distance:r,color:a}={color:G.Blue,distance:10,...i};se.draw(h=>{const d=t.pos,p=t.pos.add(t.dir.scale(r));h.debug.drawLine(d,p,{color:a})})}static flush(t){t.save(),t.z=se.z;for(const i of se._drawCalls)i(t);t.restore(),se.clear()}static clear(){se._drawCalls.length=0}}se._drawCalls=[],se.z=1/0;class le extends as{flagDirty(){this._localBoundsDirty=!0,this._localSidesDirty=!0,this._transformedPointsDirty=!0,this._sidesDirty=!0}set points(t){this._points=t,this.flagDirty()}get points(){return this._points}constructor(t){var i,r;super(),this._logger=J.getInstance(),this._transformedPoints=[],this._sides=[],this._localSides=[],this._globalMatrix=xt.identity(),this._transformedPointsDirty=!0,this._sidesDirty=!0,this._localSidesDirty=!0,this._localBoundsDirty=!0,this.offset=(i=t.offset)!==null&&i!==void 0?i:E.Zero,this._globalMatrix.translate(this.offset.x,this.offset.y),this.points=(r=t.points)!==null&&r!==void 0?r:[],this._isCounterClockwiseWinding(this.points)||this.points.reverse(),this.isConvex()||t.suppressConvexWarning||this._logger.warn("Excalibur only supports convex polygon colliders and will not behave properly.Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles"),this._calculateTransformation()}_isCounterClockwiseWinding(t){let i=0;for(let r=0;r<t.length;r++)i+=(t[(r+1)%t.length].x-t[r].x)*(t[(r+1)%t.length].y+t[r].y);return i<0}isConvex(){if(this.points.length<3)return!1;let t=this.points[this.points.length-2],i=this.points[this.points.length-1],r=Math.atan2(i.y-t.y,i.x-t.x),a=0,h=0,d=0;for(const[p,m]of this.points.entries()){if(t=i,a=r,i=m,r=Math.atan2(i.y-t.y,i.x-t.x),t.equals(i))return!1;let y=r-a;if(y<=-Math.PI?y+=Math.PI*2:y>Math.PI&&(y-=Math.PI*2),p===0){if(y===0)return!1;h=y>0?1:-1}else if(h*y<=0)return!1;d+=y}return Math.abs(Math.round(d/(Math.PI*2)))===1}tessellate(){const t=[];for(let i=1;i<this.points.length-2;i++)t.push([this.points[0],this.points[i+1],this.points[i+2]]);return t.push([this.points[0],this.points[1],this.points[2]]),new de(t.map(i=>pe.Polygon(i)))}triangulate(){if(this.points.length<3)throw Error("Invalid polygon");const t=[],i=[...this.points].reverse();let r=i.length;function a(b){return b===0?r-1:b-1}function h(b){return b===r-1?0:b+1}function d(b){const R=a(b),k=h(b),M=i[R],z=i[b],X=i[k],N=M.sub(z),U=X.sub(z);return!(N.cross(U)<0)}const p=i.map((b,R)=>d(R));function m(b,R,k,M){const z=k.sub(R),X=M.sub(k),N=R.sub(M),U=b.sub(R),$=b.sub(k),W=b.sub(M),tt=z.cross(U),pt=X.cross($),Q=N.cross(W);return!(tt>0||pt>0||Q>0)}function y(){for(let b=0;b<r;b++)if(p[b]){const R=a(b),k=h(b),M=i[R],z=i[b],X=i[k];let N=!0;for(let U=0;U<r;U++){if(U===b||U===R||U===k)continue;const $=i[U];if(m($,M,z,X)){N=!1;break}}if(N)return b}for(let b=0;b<r;b++)if(p[b])return b;return 0}function w(b){const R=a(b),k=h(b),M=i[R],z=i[b],X=i[k];t.push([M,z,X]),i.splice(b,1),p.splice(b,1),r--}for(;r>3;){const b=y();w(b);for(let R=0;R<r;R++)p[R]=d(R)}return t.push([i[0],i[1],i[2]]),new de(t.map(b=>pe.Polygon(b,E.Zero,!0)))}clone(){return new le({offset:this.offset.clone(),points:this.points.map(t=>t.clone())})}get worldPos(){return this._transform?this._transform.pos.add(this.offset):this.offset}get center(){return this.bounds.center}_calculateTransformation(){const t=this.points,i=t.length;this._transformedPoints.length=0;for(let r=0;r<i;r++)this._transformedPoints[r]=this._globalMatrix.multiply(t[r].clone())}getTransformedPoints(){return this._transformedPointsDirty&&(this._calculateTransformation(),this._transformedPointsDirty=!1),this._transformedPoints}getSides(){if(this._sidesDirty){const t=[],i=this.getTransformedPoints(),r=i.length;for(let a=0;a<r;a++)t.push(new Ae(i[a],i[(a+1)%r]));this._sides=t,this._sidesDirty=!1}return this._sides}getLocalSides(){if(this._localSidesDirty){const t=[],i=this.points,r=i.length;for(let a=0;a<r;a++)t.push(new Ae(i[a],i[(a+1)%r]));this._localSides=t,this._localSidesDirty=!1}return this._localSides}findSide(t){const i=this.getSides();let r=i[0],a=-Number.MAX_VALUE;for(let h=0;h<i.length;h++){const d=i[h],m=d.normal().dot(t);m>a&&(r=d,a=m)}return r}findLocalSide(t){const i=this.getLocalSides();let r=i[0],a=-Number.MAX_VALUE;for(let h=0;h<i.length;h++){const d=i[h],m=d.normal().dot(t);m>a&&(r=d,a=m)}return r}get axes(){const t=[],i=this.getSides();for(let r=0;r<i.length;r++)t.push(i[r].normal());return t}update(t){var i;t&&(this._transform=t,this._transformedPointsDirty=!0,this._sidesDirty=!0,((i=t.matrix)!==null&&i!==void 0?i:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y))}contains(t){const i=new Xi(t,new E(1,0));return this.getSides().reduce(function(a,h){return i.intersect(h)>=0?a+1:a},0)%2!==0}getClosestLineBetween(t){if(t instanceof fe)return Ri.PolygonCircleClosestLine(this,t);if(t instanceof le)return Ri.PolygonPolygonClosestLine(this,t);if(t instanceof Le)return Ri.PolygonEdgeClosestLine(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof fe)return _i.CollideCirclePolygon(t,this);if(t instanceof le)return _i.CollidePolygonPolygon(this,t);if(t instanceof Le)return _i.CollidePolygonEdge(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){const i=this.getTransformedPoints();let r=null,a=-Number.MAX_VALUE;for(let h=0;h<i.length;h++){const d=t.dot(i[h]);d>a&&(a=d,r=i[h])}return r}getFurthestLocalPoint(t){const i=this.points;let r=i[0],a=-Number.MAX_VALUE;for(let h=0;h<i.length;h++){const d=t.dot(i[h]);d>a&&(a=d,r=i[h])}return r}getClosestFace(t){const i=this.getSides();let r=Number.POSITIVE_INFINITY,a=-1,h=-1;for(let d=0;d<i.length;d++){const p=i[d].distanceToPoint(t);p<r&&(r=p,a=d,h=p)}return a!==-1?{distance:i[a].normal().scale(h),face:i[a]}:null}get bounds(){return this.localBounds.transform(this._globalMatrix)}get localBounds(){return this._localBoundsDirty&&(this._localBounds=et.fromPoints(this.points),this._localBoundsDirty=!1),this._localBounds}getInertia(t){if(this._cachedMass===t&&this._cachedInertia)return this._cachedInertia;let i=0,r=0;const a=this.points;for(let h=0;h<a.length;h++){const d=(h+1)%a.length,p=a[d].cross(a[h]);i+=p*(a[h].dot(a[h])+a[h].dot(a[d])+a[d].dot(a[d])),r+=p}return this._cachedMass=t,this._cachedInertia=t/6*(i/r)}rayCast(t,i=1/0){var r;const a=this.getSides(),h=a.length;let d=Number.MAX_VALUE,p,m=-1;for(let y=0;y<h;y++){const w=t.intersect(a[y]);w>=0&&w<d&&w<=i&&(d=w,p=a[y],m=y)}return m>=0?{collider:this,distance:d,body:(r=this.owner)===null||r===void 0?void 0:r.get(ht),point:t.getPoint(d),normal:p.normal()}:null}project(t){const i=this.getTransformedPoints(),r=i.length;let a=Number.MAX_VALUE,h=-Number.MAX_VALUE;for(let d=0;d<r;d++){const p=i[d].dot(t);a=Math.min(a,p),h=Math.max(h,p)}return new br(a,h)}debug(t,i,r){const a=this.getTransformedPoints();se.drawPolygon(a,{color:i})}}class pe{static Box(t,i,r=E.Half,a=E.Zero){return new le({points:new et(-t*r.x,-i*r.y,t-t*r.x,i-i*r.y).getPoints(),offset:a})}static Polygon(t,i=E.Zero,r=!1){return new le({points:t,offset:i,suppressConvexWarning:r})}static Circle(t,i=E.Zero){return new fe({radius:t,offset:i})}static Edge(t,i){return new Le({begin:t,end:i})}static Capsule(t,i,r=E.Zero){const a=J.getInstance();return t===i&&a.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider"),i>=t?new de([pe.Circle(t/2,B(0,-i/2+t/2).add(r)),pe.Box(t,i-t,E.Half,r),pe.Circle(t/2,B(0,i/2-t/2).add(r))]):new de([pe.Circle(i/2,B(-t/2+i/2,0).add(r)),pe.Box(t-i,i,E.Half,r),pe.Circle(i/2,B(t/2-i/2,0).add(r))])}}class Wt extends mi{constructor(t){super(),this.events=new v,this.$colliderAdded=new xe,this.$colliderRemoved=new xe,this._collidersToRemove=[],this.set(t)}get(){return this._collider}set(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,t.events.pipe(this.events),this.$colliderAdded.notifyAll(t),this.update()),t}clear(){this._collider&&(this._collidersToRemove.push(this._collider),this._collider=null)}processColliderRemoval(){for(const t of this._collidersToRemove)t.events.unpipe(this.events),this.$colliderRemoved.notifyAll(t),t.owner=null}clone(){return new Wt(this._collider.clone())}get bounds(){var t,i;return(i=(t=this._collider)===null||t===void 0?void 0:t.bounds)!==null&&i!==void 0?i:new et}get localBounds(){var t,i;return(i=(t=this._collider)===null||t===void 0?void 0:t.localBounds)!==null&&i!==void 0?i:new et}update(){var t;const i=(t=this.owner)===null||t===void 0?void 0:t.get(it);this._collider&&(this._collider.owner=this.owner,i&&this._collider.update(i.get()))}collide(t){let i=this._collider,r=t._collider;if(!i||!r)return[];let a=!1;if(r instanceof de&&(i=r,r=this._collider,a=!0),this._collider){const h=i.collide(r);return h?(a&&h.forEach(d=>{d.mtv=d.mtv.negate(),d.normal=d.normal.negate(),d.tangent=d.normal.perpendicular(),d.colliderA=this._collider,d.colliderB=t._collider}),h):[]}return[]}onAdd(t){this._collider&&this.update(),this.events.on("precollision",i=>{const r=i;t.events.emit("precollision",new Ls(r.target.owner,r.other.owner,r.side,r.intersection,r.contact)),t instanceof Oe&&t.onPreCollisionResolve(r.target,r.other,r.side,r.contact)}),this.events.on("postcollision",i=>{const r=i;t.events.emit("postcollision",new Os(r.target.owner,r.other.owner,r.side,r.intersection,r.contact)),t instanceof Oe&&t.onPostCollisionResolve(r.target,r.other,r.side,r.contact)}),this.events.on("collisionstart",i=>{const r=i;t.events.emit("collisionstart",new yr(r.target.owner,r.other.owner,r.side,r.contact)),t instanceof Oe&&t.onCollisionStart(r.target,r.other,r.side,r.contact)}),this.events.on("collisionend",i=>{const r=i;t.events.emit("collisionend",new wr(r.target.owner,r.other.owner,r.side,r.lastContact)),t instanceof Oe&&t.onCollisionEnd(r.target,r.other,r.side,r.lastContact)})}onRemove(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}useBoxCollider(t,i,r=E.Half,a=E.Zero){const h=pe.Box(t,i,r,a);return this.set(h)}usePolygonCollider(t,i=E.Zero){const r=pe.Polygon(t,i);return this.set(r)}useCircleCollider(t,i=E.Zero){const r=pe.Circle(t,i);return this.set(r)}useEdgeCollider(t,i){const r=pe.Edge(t,i);return this.set(r)}useCompositeCollider(t){return this.set(new de(t))}}var Te;(function(u){u.Rotation="rotation",u.X="x",u.Y="y"})(Te||(Te={}));class ht extends mi{constructor(t){var i,r,a;super(),this.dependencies=[it,Mt],this.id=g("body",ht._ID++),this.events=new v,this.oldTransform=new zs,this.__oldTransformCaptured=!1,this.enableFixedUpdateInterpolate=!0,this.collisionType=ut.PreventCollision,this.group=Hs.All,this._sleeping=!1,this.bounciness=.2,this.friction=.99,this.useGravity=!0,this.limitDegreeOfFreedom=[],this.oldVel=new E(0,0),this.oldAcc=E.Zero,t?(this.collisionType=(i=t.type)!==null&&i!==void 0?i:this.collisionType,this.group=(r=t.group)!==null&&r!==void 0?r:this.group,this.useGravity=(a=t.useGravity)!==null&&a!==void 0?a:this.useGravity,this._bodyConfig={...Pi.bodies,...t.config}):this._bodyConfig={...Pi.bodies},this.updatePhysicsConfig(this._bodyConfig),this._mass=ht._DEFAULT_CONFIG.defaultMass}get matrix(){return this.transform.get().matrix}updatePhysicsConfig(t){this._bodyConfig={...Pi.bodies,...t},this.canSleep=this._bodyConfig.canSleepByDefault,this.sleepMotion=this._bodyConfig.sleepEpsilon*5,this.wakeThreshold=this._bodyConfig.wakeThreshold}static updateDefaultPhysicsConfig(t){ht._DEFAULT_CONFIG=t}get mass(){return this._mass}set mass(t){this._mass=t,this._cachedInertia=void 0,this._cachedInverseInertia=void 0}get inverseMass(){return this.collisionType===ut.Fixed?0:1/this.mass}get sleeping(){return this._sleeping}setSleeping(t){this._sleeping=t,t?(this.vel=E.Zero,this.acc=E.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=this._bodyConfig.sleepEpsilon*5}updateMotion(){this._sleeping&&this.setSleeping(!0);const t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),i=this._bodyConfig.sleepBias;this.sleepMotion=i*this.sleepMotion+(1-i)*t,this.sleepMotion=L(this.sleepMotion,0,10*this._bodyConfig.sleepEpsilon),this.canSleep&&this.sleepMotion<this._bodyConfig.sleepEpsilon&&this.setSleeping(!0)}get inertia(){if(this._cachedInertia)return this._cachedInertia;const t=this.owner.get(Wt);if(t){t.$colliderAdded.subscribe(()=>{this._cachedInertia=null}),t.$colliderRemoved.subscribe(()=>{this._cachedInertia=null});const i=t.get();if(i)return this._cachedInertia=i.getInertia(this.mass)}return 0}get inverseInertia(){return this._cachedInverseInertia?this._cachedInverseInertia:this._cachedInverseInertia=this.collisionType===ut.Fixed?0:1/this.inertia}get active(){var t;return!!(!((t=this.owner)===null||t===void 0)&&t.active)}get center(){return this.globalPos}get transform(){var t;return(t=this.owner)===null||t===void 0?void 0:t.get(it)}get motion(){var t;return(t=this.owner)===null||t===void 0?void 0:t.get(Mt)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t}get globalPos(){return this.transform.globalPos}set globalPos(t){this.transform.globalPos=t}get oldPos(){return this.oldTransform.pos}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t}get torque(){return this.motion.torque}set torque(t){this.motion.torque=t}get oldRotation(){return this.oldTransform.rotation}get rotation(){return this.transform.globalRotation}set rotation(t){this.transform.globalRotation=t}get scale(){return this.transform.globalScale}set scale(t){this.transform.globalScale=t}get oldScale(){return this.oldTransform.scale}get scaleFactor(){return this.motion.scaleFactor}set scaleFactor(t){this.motion.scaleFactor=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}applyImpulse(t,i){if(this.collisionType!==ut.Active)return;const r=i.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(Te.X)&&(r.x=0),this.limitDegreeOfFreedom.includes(Te.Y)&&(r.y=0),this.vel.addEqual(r),!this.limitDegreeOfFreedom.includes(Te.Rotation)){const a=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*a.cross(i)}}applyLinearImpulse(t){if(this.collisionType!==ut.Active)return;const i=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(Te.X)&&(i.x=0),this.limitDegreeOfFreedom.includes(Te.Y)&&(i.y=0),this.vel=this.vel.add(i)}applyAngularImpulse(t,i){if(this.collisionType===ut.Active&&!this.limitDegreeOfFreedom.includes(Te.Rotation)){const r=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*r.cross(i)}}captureOldTransform(){this.__oldTransformCaptured=!0;const t=this.transform.get();t.clone(this.oldTransform),this.oldTransform.parent=t.parent,this.oldVel.setTo(this.vel.x,this.vel.y),this.oldAcc.setTo(this.acc.x,this.acc.y)}clone(){return super.clone()}}ht._ID=0,ht._DEFAULT_CONFIG={...Pi.bodies};class X0{constructor(t){this.data=t,this.type="Component Added"}}function $0(u){return!!u&&u.type==="Component Added"}class Y0{constructor(t){this.data=t,this.type="Component Removed"}}function Q0(u){return!!u&&u.type==="Component Removed"}const q0={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate",Kill:"kill"};class ge{constructor(t,i){this.id=ge._ID++,this.name=`Entity#${this.id}`,this.events=new v,this._tags=new Set,this.componentAdded$=new xe,this.componentRemoved$=new xe,this.tagAdded$=new xe,this.tagRemoved$=new xe,this.components=new Map,this._componentsToRemove=[],this._instanceOfComponentCacheDirty=!0,this._instanceOfComponentCache=new Map,this.scene=null,this.active=!0,this._parent=null,this.childrenAdded$=new xe,this.childrenRemoved$=new xe,this._children=[],this._isInitialized=!1;let r,a;if(Array.isArray(t))r=t,a=i;else if(t&&typeof t=="object"){const{components:h,name:d}=t;r=h??[],a=d}if(a&&(this.name=a),r)for(const h of r)this.addComponent(h)}kill(){this.active&&(this.active=!1,this.unparent()),this.emit("kill",new zo(this))}isKilled(){return!this.active}get tags(){return this._tags}hasTag(t){return this._tags.has(t)}addTag(t){return this._tags.add(t),this.tagAdded$.notifyAll(t),this}removeTag(t){return this._tags.delete(t),this.tagRemoved$.notifyAll(t),this}get types(){return Array.from(this.components.keys())}getComponents(){return Array.from(this.components.values())}hasAll(t){for(let i=0;i<t.length;i++)if(!this.components.has(t[i]))return!1;return!0}hasAllTags(t){for(let i=0;i<t.length;i++)if(!this.tags.has(t[i]))return!1;return!0}_getCachedInstanceOfType(t){if(this._instanceOfComponentCacheDirty&&(this._instanceOfComponentCacheDirty=!1,this._instanceOfComponentCache.clear()),this._instanceOfComponentCache.has(t))return this._instanceOfComponentCache.get(t);for(const i of this.components.values())if(i instanceof t)return this._instanceOfComponentCache.set(t,i),i}get(t){const i=this._getCachedInstanceOfType(t);return i??this.components.get(t)}get parent(){return this._parent}get children(){return this._children}unparent(){this._parent&&(this._parent.removeChild(this),this._parent=null)}addChild(t){if(t.parent===null){if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t)}else throw new Error("Entity already has a parent, cannot add without unparenting");return this}removeChild(t){return t.parent===this&&(lt(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}removeAllChildren(){for(let t=this.children.length-1;t>=0;t--)this.removeChild(this.children[t]);return this}getAncestors(){const t=[this];let i=this.parent;for(;i;)t.push(i),i=i.parent;return t.reverse()}getDescendants(){let t=[this],i=[this];for(;i.length>0;){const r=i.pop();r&&(i=i.concat(r.children),t=t.concat(r.children))}return t}clone(){const t=new ge;for(const i of this.types){const r=this.get(i);r&&t.addComponent(r.clone())}for(const i of this.children)t.addChild(i.clone());return t}addTemplate(t,i=!1){for(const r of t.getComponents())this.addComponent(r.clone(),i);for(const r of t.children)this.addChild(r.clone().addTemplate(r));return this}addComponent(t,i=!1){if(this._instanceOfComponentCacheDirty=!0,this.has(t.constructor))if(i)this.removeComponent(t.constructor,!0);else return this;if(t.dependencies&&t.dependencies.length)for(const r of t.dependencies)this.addComponent(new r);return t.owner=this,this.components.set(t.constructor,t),t.onAdd&&t.onAdd(this),this.componentAdded$.notifyAll(t),this}removeComponent(t,i=!1){let r;if(Xd(t)?r=t:r=t.constructor,i){const a=this.components.get(r);a&&(this.componentRemoved$.notifyAll(a),a.owner=void 0,a.onRemove&&a.onRemove(this)),this.components.delete(r),this._instanceOfComponentCacheDirty=!0}else this._componentsToRemove.push(r);return this}clearComponents(){const t=this.types;for(const i of t)this.removeComponent(i)}processComponentRemoval(){for(const t of this._componentsToRemove)this.removeComponent(t,!0);this._componentsToRemove.length=0}has(t){return this.components.has(t)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.onInitialize(t),this.events.emit("initialize",new bn(t,this)),this._isInitialized=!0)}_preupdate(t,i){this.events.emit("preupdate",new rs(t,i,this)),this.onPreUpdate(t,i)}_postupdate(t,i){this.events.emit("postupdate",new os(t,i,this)),this.onPostUpdate(t,i)}onInitialize(t){}onPreUpdate(t,i){}onPostUpdate(t,i){}update(t,i){this._initialize(t),this._preupdate(t,i);for(const r of this.children)r.update(t,i);this._postupdate(t,i)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){i?this.events.off(t,i):this.events.off(t)}}ge._ID=0;var Cr;(function(u){u.Forward="forward",u.Backward="backward"})(Cr||(Cr={}));var vi;(function(u){u.End="end",u.Loop="loop",u.PingPong="pingpong",u.Freeze="freeze"})(vi||(vi={}));const Z0={Frame:"frame",Loop:"loop",End:"end"};class Ii extends zt{constructor(t){var i,r,a;super(t),this.events=new v,this.frames=[],this.strategy=vi.Loop,this.frameDuration=100,this._idempotencyToken=-1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=0,this._pingPongDirection=1,this._done=!1,this._playing=!0,this._speed=1,this._reversed=!1,this.frames=t.frames,this.speed=(i=t.speed)!==null&&i!==void 0?i:this.speed,this.strategy=(r=t.strategy)!==null&&r!==void 0?r:this.strategy,this.frameDuration=t.totalDuration?t.totalDuration/this.frames.length:(a=t.frameDuration)!==null&&a!==void 0?a:this.frameDuration,t.reverse&&this.reverse(),this.goToFrame(0)}clone(){return new Ii({frames:this.frames.map(t=>({...t})),frameDuration:this.frameDuration,speed:this.speed,reverse:this._reversed,strategy:this.strategy,...this.cloneGraphicOptions()})}get width(){const t=this.currentFrame;return t?Math.abs(t.graphic.width*this.scale.x):0}get height(){const t=this.currentFrame;return t?Math.abs(t.graphic.height*this.scale.y):0}static fromSpriteSheet(t,i,r,a=vi.Loop){const h=t.sprites.length-1,d=i.filter(p=>p<0||p>h);return d.length&&Ii._LOGGER.warn(`Indices into SpriteSheet were provided that don't exist: ${d.join(",")} no frame will be shown`),new Ii({frames:t.sprites.filter((p,m)=>i.indexOf(m)>-1).map(p=>({graphic:p,duration:r})),strategy:a})}static fromSpriteSheetCoordinates(t){const{spriteSheet:i,frameCoordinates:r,durationPerFrameMs:a,speed:h,strategy:d,reverse:p}=t,m=a??100,y=[];for(const w of r){const{x:b,y:R,duration:k,options:M}=w,z=i.getSprite(b,R,M);z?y.push({graphic:z,duration:k??m}):Ii._LOGGER.warn(`Skipping frame! SpriteSheet does not have coordinate (${b}, ${R}), please check your SpriteSheet to confirm that sprite exists`)}return new Ii({frames:y,strategy:d,speed:h,reverse:p})}get speed(){return this._speed}set speed(t){this._speed=L(Math.abs(t),0,1/0)}get currentFrame(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}get currentFrameIndex(){return this._currentFrame}get currentFrameTimeLeft(){return this._timeLeftInFrame}get isPlaying(){return this._playing}reverse(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}get direction(){return!!(this._reversed&&this._pingPongDirection===1)?Cr.Backward:Cr.Forward}play(){this._playing=!0}pause(){this._playing=!1,this._firstTick=!0}reset(){this._done=!1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=this.frameDuration;const t=this.frames[this._currentFrame];t&&(this._timeLeftInFrame=(t==null?void 0:t.duration)||this.frameDuration)}get canFinish(){switch(this.strategy){case vi.End:case vi.Freeze:return!0;default:return!1}}get done(){return this._done}goToFrame(t,i){this._currentFrame=t,this._timeLeftInFrame=i??this.frameDuration;const r=this.frames[this._currentFrame];r&&!this._done&&(this._timeLeftInFrame=i??((r==null?void 0:r.duration)||this.frameDuration),this.events.emit("frame",{...r,frameIndex:this.currentFrameIndex}))}_nextFrame(){const t=this._currentFrame;if(this._done)return t;let i=-1;switch(this.strategy){case vi.Loop:{i=(t+1)%this.frames.length,i===0&&this.events.emit("loop",this);break}case vi.End:{i=t+1,i>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break}case vi.Freeze:{i=L(t+1,0,this.frames.length-1),i>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break}case vi.PingPong:{t+this._pingPongDirection>=this.frames.length&&(this._pingPongDirection=-1,this.events.emit("loop",this)),t+this._pingPongDirection<0&&(this._pingPongDirection=1,this.events.emit("loop",this)),i=t+this._pingPongDirection%this.frames.length;break}}return i}tick(t,i=0){this._idempotencyToken!==i&&(this._idempotencyToken=i,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",{...this.currentFrame,frameIndex:this.currentFrameIndex})),this._timeLeftInFrame-=t*this._speed,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame())))}_drawImage(t,i,r){this.currentFrame&&this.currentFrame.graphic.draw(t,i,r)}}Ii._LOGGER=J.getInstance();class Cn extends zt{constructor(t){var i;super(t),this._logger=J.getInstance(),this.useAnchor=!0,this.members=[],this.members=t.members,this.useAnchor=(i=t.useAnchor)!==null&&i!==void 0?i:this.useAnchor,this._updateDimensions()}clone(){return new Cn({members:[...this.members],...this.cloneGraphicOptions()})}_updateDimensions(){const t=this.localBounds;return this.width=t.width,this.height=t.height,t}get localBounds(){let t=new et;for(const i of this.members)if(i instanceof zt)t=i.localBounds.combine(t);else{const{graphic:r,offset:a,useBounds:h}=i;r?(h===void 0?!0:h)&&(t=r.localBounds.translate(a).combine(t)):this._logger.warnOnce(`Graphics group member has an null or undefined graphic, member definition: ${JSON.stringify(i)}.`)}return t}_isAnimationOrGroup(t){return t instanceof Ii||t instanceof Cn}tick(t,i){for(const r of this.members){let a;r instanceof zt?a=r:a=r.graphic,this._isAnimationOrGroup(a)&&a.tick(t,i)}}reset(){for(const t of this.members){let i;t instanceof zt?i=t:i=t.graphic,this._isAnimationOrGroup(i)&&i.reset()}}_preDraw(t,i,r){this._updateDimensions(),super._preDraw(t,this.useAnchor?i:0,this.useAnchor?r:0)}_drawImage(t,i,r){const a=E.Zero;for(const h of this.members){let d;h instanceof zt?d=h:(d=h.graphic,h.offset.clone(a)),d&&(t.save(),t.translate(i,r),d.draw(t,a.x,a.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore())}}}function Ah(u){return!!u.tick}class ne extends mi{get offset(){return new Go(this._offset,()=>{this.recalculateBounds()})}set offset(t){this._offset=t,this.recalculateBounds()}get anchor(){return new Go(this._anchor,()=>{this.recalculateBounds()})}set anchor(t){this._anchor=t,this.recalculateBounds()}constructor(t){super(),this._logger=J.getInstance(),this._current="default",this._graphics={},this._options={},this.material=null,this.visible=!0,this.opacity=1,this._offset=E.Zero,this._anchor=E.Half,this.flipHorizontal=!1,this.flipVertical=!1,this.copyGraphics=!1,this._localBounds=null,t={visible:this.visible,graphics:{},...t};const{current:i,anchor:r,opacity:a,visible:h,graphics:d,offset:p,copyGraphics:m,onPreDraw:y,onPostDraw:w,onPreTransformDraw:b,onPostTransformDraw:R}=t;for(const[k,M]of Object.entries(d))M instanceof zt?this._graphics[k]=M:(this._graphics[k]=M.graphic,this._options[k]=M.options);this.offset=p??this.offset,this.opacity=a??this.opacity,this.anchor=r??this.anchor,this.copyGraphics=m??this.copyGraphics,this.onPreDraw=y??this.onPreDraw,this.onPostDraw=w??this.onPostDraw,this.onPreDraw=b??this.onPreTransformDraw,this.onPostTransformDraw=R??this.onPostTransformDraw,this.visible=!!h,this._current=i??this._current,i&&this._graphics[i]&&this.use(i)}getGraphic(t){return this._graphics[t]}getOptions(t){return this._options[t]}getNames(){return Object.keys(this._graphics)}get current(){return this._graphics[this._current]}get currentOptions(){return this._options[this._current]}get graphics(){return this._graphics}get options(){return this._options}add(t,i,r){let a="default",h=null,d;return typeof t=="string"&&i instanceof zt&&(a=t,h=i,d=r),t instanceof zt&&!(i instanceof zt)&&(h=t,d=i),this._graphics[a]=this.copyGraphics?h.clone():h,this._options[a]=this.copyGraphics?{...d}:d,a==="default"&&this.use("default"),h}remove(t){delete this._graphics[t],delete this._options[t],this._current===t&&(this._current="default",this.recalculateBounds())}show(t,i){return this.use(t,i)}use(t,i){var r;if(t instanceof zt){let a=t;this.copyGraphics&&(a=t.clone()),this._current="default",this._graphics[this._current]=a,this._options[this._current]=i}else this._current=t,this._options[this._current]=i,this._current in this._graphics||this._logger.warn(`Graphic ${this._current} is not registered with the graphics component owned by ${(r=this.owner)===null||r===void 0?void 0:r.name}. Nothing will be drawn.`);return this.recalculateBounds(),this.current}hide(){this._current="ex.none"}set localBounds(t){this._localBounds=t}recalculateBounds(){let t=new et;const i=this._graphics[this._current],r=this._options[this._current];if(!i){this._localBounds=t;return}let a=this.anchor,h=this.offset;r!=null&&r.anchor&&(a=r.anchor),r!=null&&r.offset&&(h=r.offset);const d=i.localBounds,p=-d.width*a.x+h.x,m=-d.height*a.y+h.y;i instanceof Cn&&!i.useAnchor?t=i==null?void 0:i.localBounds.combine(t):t=i==null?void 0:i.localBounds.translate(B(p,m)).combine(t),this._localBounds=t}get localBounds(){return(!this._localBounds||this._localBounds.hasZeroDimensions())&&this.recalculateBounds(),this._localBounds}get bounds(){let t=this.localBounds;if(this.owner){const i=this.owner.get(it);i&&(t=t.transform(i.get().matrix))}return t}update(t,i=0){const r=this.current;r&&Ah(r)&&r.tick(t,i)}clone(){const t=new ne;return t._graphics={...this._graphics},t._options={...this._options},t.offset=this.offset.clone(),t.opacity=this.opacity,t.anchor=this.anchor.clone(),t.copyGraphics=this.copyGraphics,t.onPreDraw=this.onPreDraw,t.onPostDraw=this.onPostDraw,t.visible=this.visible,t}}class Sr extends yn{constructor(t){super(t),this.width=t.width,this.height=t.height,this.rasterize()}clone(){return new Sr({width:this.width,height:this.height,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}class qo extends yn{get radius(){return this._radius}set radius(t){this._radius=t,this.width=this._radius*2,this.height=this._radius*2,this.flagDirty()}constructor(t){var i,r,a;super(t),this._radius=0;const h=(i=t.lineWidth)!==null&&i!==void 0?i:t.strokeColor?1:0;this.padding=(r=t.padding)!==null&&r!==void 0?r:2+h/2,this.radius=t.radius,this.filtering=(a=t.filtering)!==null&&a!==void 0?a:qt.Blended,this.rasterize()}clone(){return new qo({radius:this.radius,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,Math.PI*2),this.color&&t.fill(),this.strokeColor&&t.stroke())}}class Di extends mi{constructor(t){var i,r;super(),this.useColliderShape=!0,this.useGraphicsBounds=!0,this.useColliderShape=(i=t==null?void 0:t.useColliderShape)!==null&&i!==void 0?i:this.useColliderShape,this.useGraphicsBounds=(r=t==null?void 0:t.useGraphicsBounds)!==null&&r!==void 0?r:this.useGraphicsBounds,this.localBounds=t==null?void 0:t.localBounds}}class It{static CreateReversibleEasingFunction(t){return(i,r,a,h)=>a<r?r-(t(i,a,r,h)-a):t(i,r,a,h)}static CreateVectorEasingFunction(t){return(i,r,a,h)=>new E(t(i,r.x,a.x,h),t(i,r.y,a.y,h))}}It.Linear=It.CreateReversibleEasingFunction((u,t,i,r)=>(i=i-t,i*u/r+t)),It.EaseInQuad=It.CreateReversibleEasingFunction((u,t,i,r)=>(i=i-t,u/=r,i*u*u+t)),It.EaseOutQuad=It.CreateReversibleEasingFunction((u,t,i,r)=>(i=i-t,u/=r,-i*u*(u-2)+t)),It.EaseInOutQuad=It.CreateReversibleEasingFunction((u,t,i,r)=>(i=i-t,u/=r/2,u<1?i/2*u*u+t:(u--,-i/2*(u*(u-2)-1)+t))),It.EaseInCubic=It.CreateReversibleEasingFunction((u,t,i,r)=>(i=i-t,u/=r,i*u*u*u+t)),It.EaseOutCubic=It.CreateReversibleEasingFunction((u,t,i,r)=>(i=i-t,u/=r,u--,i*(u*u*u+1)+t)),It.EaseInOutCubic=It.CreateReversibleEasingFunction((u,t,i,r)=>(i=i-t,u/=r/2,u<1?i/2*u*u*u+t:(u-=2,i/2*(u*u*u+2)+t)));class qd{constructor(t){this._actions=[],this._currentAction=null,this._completedActions=[],this._entity=t}add(t){this._actions.push(t)}remove(t){const i=this._actions.indexOf(t);this._actions.splice(i,1)}clearActions(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}getActions(){return this._actions.concat(this._completedActions)}hasNext(){return this._actions.length>0}isComplete(){return this._actions.length===0}reset(){this._actions=this.getActions();const t=this._actions.length;for(let i=0;i<t;i++)this._actions[i].reset();this._completedActions=[]}update(t){if(this._actions.length>0&&(this._currentAction!==this._actions[0]&&(this._currentAction=this._actions[0],this._entity.emit("actionstart",new gh(this._currentAction,this._entity))),this._currentAction.update(t),this._currentAction.isComplete(this._entity))){this._entity.emit("actioncomplete",new mh(this._currentAction,this._entity));const i=this._actions.shift();i&&this._completedActions.push(i)}}}class Zd{constructor(t,i,r){this._stopped=!1,this._repeatBuilder=i,this._repeatContext=new Er(t),this._actionQueue=this._repeatContext.getQueue(),this._repeat=r,this._originalRepeat=r,this._repeatBuilder(this._repeatContext),this._repeat--}update(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}isComplete(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._repeat=this._originalRepeat}}class Kd{constructor(t,i){this._stopped=!1,this._repeatBuilder=i,this._repeatContext=new Er(t),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}update(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}isComplete(){return this._stopped}stop(){this._stopped=!0,this._actionQueue.clearActions()}reset(){}}class Jd{constructor(t,i,r,a){if(this._started=!1,this._stopped=!1,this._entity=t,this._tx=t.get(it),this._motion=t.get(Mt),this._speed=a,this._offset=new E(i,r),a<=0)throw J.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+a),new Error("Speed must be greater than 0 pixels per second")}update(t){this._started||(this._started=!0,this._start=new E(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=B(this._end.x,this._end.y),this._motion.vel=B(0,0)):this._motion.vel=this._dir.scale(this._speed)}isComplete(t){const i=t.get(it);return this._stopped||i.pos.distance(this._start)>=this._distance}stop(){this._motion.vel=B(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class tf{constructor(t,i,r,a){this.entity=t,this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Mt),this._end=new E(i,r),this._speed=a}update(t){this._started||(this._started=!0,this._start=new E(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());const i=this._dir.scale(this._speed);this._motion.vel=B(i.x,i.y),this.isComplete(this.entity)&&(this._tx.pos=B(this._end.x,this._end.y),this._motion.vel=B(0,0))}isComplete(t){const i=t.get(it);return this._stopped||new E(i.pos.x,i.pos.y).distance(this._start)>=this._distance}stop(){this._motion.vel=B(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}var Ze;(function(u){u[u.ShortestPath=0]="ShortestPath",u[u.LongestPath=1]="LongestPath",u[u.Clockwise=2]="Clockwise",u[u.CounterClockwise=3]="CounterClockwise"})(Ze||(Ze={}));class ef{constructor(t,i,r,a){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Mt),this._end=i,this._speed=r,this._rotationType=a||Ze.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;const i=Math.abs(this._end-this._start),r=D-i;switch(i>r?(this._shortDistance=r,this._longDistance=i):(this._shortDistance=i,this._longDistance=r),this._shortestPathIsPositive=(this._start-this._end+D)%D>=Math.PI,this._rotationType){case Ze.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case Ze.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case Ze.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case Ze.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance;break}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class sf{constructor(t,i,r,a){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Mt),this._speed=r,this._offset=i,this._rotationType=a||Ze.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;const i=Math.abs(this._end-this._start),r=D-i;switch(i>r?(this._shortDistance=r,this._longDistance=i):(this._shortDistance=i,this._longDistance=r),this._shortestPathIsPositive=(this._start-this._end+D)%D>=Math.PI,this._rotationType){case Ze.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case Ze.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case Ze.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case Ze.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance;break}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._start=void 0,this._currentNonCannonAngle=void 0,this._distance=void 0}}class nf{constructor(t,i,r,a,h){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Mt),this._endX=i,this._endY=r,this._speedX=a,this._speedY=h}update(t){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{const i=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*i}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{const i=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*i}this.isComplete()&&(this._tx.scale=B(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startX)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class rf{constructor(t,i,r,a){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Mt),this._offset=new E(i,r),this._speedX=this._speedY=a}update(t){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class of{constructor(t){this._method=null,this._hasBeenCalled=!1,this._method=t}update(t){this._method(),this._hasBeenCalled=!0}isComplete(){return this._hasBeenCalled}reset(){this._hasBeenCalled=!1}stop(){this._hasBeenCalled=!0}}class af{constructor(t,i,r,a,h){this.easingFcn=h,this._currentLerpTime=0,this._lerpDuration=1*1e3,this._lerpStart=new E(0,0),this._lerpEnd=new E(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Mt),this._lerpDuration=a,this._lerpEnd=new E(i,r)}_initialize(){this._lerpStart=new E(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let i=this._tx.pos.x,r=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(this._lerpEnd.x<this._lerpStart.x?i=this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):i=this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),this._lerpEnd.y<this._lerpStart.y?r=this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):r=this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=B((i-this._tx.pos.x)/(t/1e3),(r-this._tx.pos.y)/(t/1e3))):(this._tx.pos=B(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=E.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=B(0,0),this._stopped=!0}}class lf{constructor(t,i,r,a,h){this.easingFcn=h,this._currentLerpTime=0,this._lerpDuration=1*1e3,this._lerpStart=new E(0,0),this._lerpEnd=new E(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Mt),this._lerpDuration=a,this._offset=new E(i,r)}_initialize(){this._lerpStart=new E(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._lerpEnd=this._lerpStart.add(this._offset)}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let i=this._tx.pos.x,r=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(this._lerpEnd.x<this._lerpStart.x?i=this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):i=this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),this._lerpEnd.y<this._lerpStart.y?r=this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):r=this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=B((i-this._tx.pos.x)/(t/1e3),(r-this._tx.pos.y)/(t/1e3))):(this._tx.pos=B(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=E.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=B(0,0),this._stopped=!0}}class hf{constructor(t,i,r,a=1){this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=t.get(ne),this._timeVisible=i,this._timeNotVisible=r,this._duration=(i+r)*a}update(t){this._started||(this._started=!0,this._elapsedTime=0,this._totalTime=0),this._graphics&&(this._elapsedTime+=t,this._totalTime+=t,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}isComplete(){return this._stopped||this._totalTime>=this._duration}stop(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._elapsedTime=0,this._totalTime=0}}class cf{constructor(t,i,r){this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=t.get(ne),this._endOpacity=i,this._speed=this._ogspeed=r}update(t){this._graphics&&(this._started||(this._started=!0,this._speed=this._ogspeed,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._graphics.opacity=this._endOpacity),J.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}isComplete(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}stop(){this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class uf{constructor(t){this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=t}update(t){this._started||(this._started=!0),this._elapsedTime+=t}isComplete(){return this._stopped||this._elapsedTime>=this._delay}stop(){this._stopped=!0}reset(){this._elapsedTime=0,this._started=!1,this._stopped=!1}}class df{constructor(t){this._stopped=!1,this._entity=t}update(t){this._entity.get(Sn).clearActions(),this._entity.kill(),this._stopped=!0}isComplete(){return this._stopped}stop(){}reset(){}}class Th{constructor(t,i,r){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Mt),this._followTx=i.get(it),this._followMotion=i.get(Mt),this._current=new E(this._tx.pos.x,this._tx.pos.y),this._end=new E(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=r!==void 0?r:this._current.distance(this._end),this._speed=0}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const i=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(i!==0&&(this._speed=i),this._current=B(this._tx.pos.x,this._tx.pos.y),this._end=B(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){const r=this._dir.scale(this._speed);this._motion.vel=B(r.x,r.y)}else this._motion.vel=B(0,0);this.isComplete()&&(this._tx.pos=B(this._end.x,this._end.y),this._motion.vel=B(0,0))}stop(){this._motion.vel=B(0,0),this._stopped=!0}isComplete(){return this._stopped}reset(){this._started=!1,this._stopped=!1}}class Ph{constructor(t,i,r){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=t.get(it),this._motion=t.get(Mt),this._meetTx=i.get(it),this._meetMotion=i.get(Mt),this._current=new E(this._tx.pos.x,this._tx.pos.y),this._end=new E(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=r||0,r!==void 0&&(this._speedWasSpecified=!0)}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const i=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));i!==0&&!this._speedWasSpecified&&(this._speed=i),this._current=B(this._tx.pos.x,this._tx.pos.y),this._end=B(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();const r=this._dir.scale(this._speed);this._motion.vel=B(r.x,r.y),this.isComplete()&&(this._tx.pos=B(this._end.x,this._end.y),this._motion.vel=B(0,0))}isComplete(){return this._stopped||this._distanceBetween<=1}stop(){this._motion.vel=B(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._distanceBetween=void 0}}class Er{constructor(t){this._entity=t,this._queue=new qd(t)}getQueue(){return this._queue}update(t){this._queue.update(t)}clearActions(){this._queue.clearActions()}runAction(t){return t.reset(),this._queue.add(t),this}easeTo(...t){var i,r;let a=0,h=0,d=0,p=It.Linear;return t[0]instanceof E?(a=t[0].x,h=t[0].y,d=t[1],p=(i=t[2])!==null&&i!==void 0?i:p):(a=t[0],h=t[1],d=t[2],p=(r=t[3])!==null&&r!==void 0?r:p),this._queue.add(new af(this._entity,a,h,d,p)),this}easeBy(...t){var i,r;let a=0,h=0,d=0,p=It.Linear;return t[0]instanceof E?(a=t[0].x,h=t[0].y,d=t[1],p=(i=t[2])!==null&&i!==void 0?i:p):(a=t[0],h=t[1],d=t[2],p=(r=t[3])!==null&&r!==void 0?r:p),this._queue.add(new lf(this._entity,a,h,d,p)),this}moveTo(t,i,r){let a=0,h=0,d=0;return t instanceof E?(a=t.x,h=t.y,d=i):(a=t,h=i,d=r),this._queue.add(new tf(this._entity,a,h,d)),this}moveBy(t,i,r){let a=0,h=0,d=0;return t instanceof E?(a=t.x,h=t.y,d=i):(a=t,h=i,d=r),this._queue.add(new Jd(this._entity,a,h,d)),this}rotateTo(t,i,r){return this._queue.add(new ef(this._entity,t,i,r)),this}rotateBy(t,i,r){return this._queue.add(new sf(this._entity,t,i,r)),this}scaleTo(t,i,r,a){let h=1,d=1,p=0,m=0;return t instanceof E&&i instanceof E&&(h=t.x,d=t.y,p=i.x,m=i.y),typeof t=="number"&&typeof i=="number"&&(h=t,d=i,p=r,m=a),this._queue.add(new nf(this._entity,h,d,p,m)),this}scaleBy(t,i,r){let a=1,h=1;return t instanceof E&&(a=t.x,h=t.y,r=i),typeof t=="number"&&typeof i=="number"&&(a=t,h=i),this._queue.add(new rf(this._entity,a,h,r)),this}blink(t,i,r=1){return this._queue.add(new hf(this._entity,t,i,r)),this}fade(t,i){return this._queue.add(new cf(this._entity,t,i)),this}delay(t){return this._queue.add(new uf(t)),this}die(){return this._queue.add(new df(this._entity)),this}callMethod(t){return this._queue.add(new of(t)),this}repeat(t,i){return i?(this._queue.add(new Zd(this._entity,t,i)),this):(this.repeatForever(t),this)}repeatForever(t){return this._queue.add(new Kd(this._entity,t)),this}follow(t,i){return i===void 0?this._queue.add(new Th(this._entity,t)):this._queue.add(new Th(this._entity,t,i)),this}meet(t,i){return i===void 0?this._queue.add(new Ph(this._entity,t)):this._queue.add(new Ph(this._entity,t,i)),this}toPromise(){return new Promise(i=>{this._queue.add(new of(()=>{i()}))})}}class Sn extends mi{constructor(){super(...arguments),this.dependencies=[it,Mt],this._ctx=null}onAdd(t){this._ctx=new Er(t)}onRemove(){this._ctx=null}_getCtx(){if(!this._ctx)throw new Error("Actions component not attached to an entity, no context available");return this._ctx}getQueue(){if(!this._ctx)throw new Error("Actions component not attached to an entity, no queue available");return this._ctx.getQueue()}runAction(t){if(!this._ctx)throw new Error("Actions component not attached to an entity, cannot run action");return this._ctx.runAction(t)}update(t){var i;return(i=this._ctx)===null||i===void 0?void 0:i.update(t)}clearActions(){var t;(t=this._ctx)===null||t===void 0||t.clearActions()}easeTo(...t){return this._getCtx().easeTo.apply(this._ctx,t)}easeBy(...t){return this._getCtx().easeBy.apply(this._ctx,t)}moveTo(t,i,r){return this._getCtx().moveTo.apply(this._ctx,[t,i,r])}moveBy(t,i,r){return this._getCtx().moveBy.apply(this._ctx,[t,i,r])}rotateTo(t,i,r){return this._getCtx().rotateTo(t,i,r)}rotateBy(t,i,r){return this._getCtx().rotateBy(t,i,r)}scaleTo(t,i,r,a){return this._getCtx().scaleTo.apply(this._ctx,[t,i,r,a])}scaleBy(t,i,r){return this._getCtx().scaleBy.apply(this._ctx,[t,i,r])}blink(t,i,r){return this._getCtx().blink(t,i,r)}fade(t,i){return this._getCtx().fade(t,i)}delay(t){return this._getCtx().delay(t)}die(){return this._getCtx().die()}callMethod(t){return this._getCtx().callMethod(t)}repeat(t,i){return this._getCtx().repeat(t,i)}repeatForever(t){return this._getCtx().repeatForever(t)}follow(t,i){return this._getCtx().follow(t,i)}meet(t,i){return this._getCtx().meet(t,i)}toPromise(){return this._getCtx().toPromise()}}var Zo;(function(u){u.Em="em",u.Rem="rem",u.Px="px",u.Pt="pt",u.Percent="%"})(Zo||(Zo={}));var Ko;(function(u){u.Left="left",u.Right="right",u.Center="center",u.Start="start",u.End="end"})(Ko||(Ko={}));var Jo;(function(u){u.Top="top",u.Hanging="hanging",u.Middle="middle",u.Alphabetic="alphabetic",u.Ideographic="ideographic",u.Bottom="bottom"})(Jo||(Jo={}));var ta;(function(u){u.Normal="normal",u.Italic="italic",u.Oblique="oblique"})(ta||(ta={}));var ea;(function(u){u.LeftToRight="ltr",u.RightToLeft="rtl"})(ea||(ea={}));class En{constructor(t,i,r,a){this.font=t,this.text=i,this.color=r,this.maxWidth=a,this._textFragments=[],this.disposed=!1,this._dirty=!0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.dimensions=this.measureText(i),this._setDimension(this.dimensions,this.ctx),this._lastHashCode=this.getHashCode()}measureText(t,i){if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);let r=null;i!=null?r=this._getLinesFromText(t,i):r=t.split(`
`);const a=r.reduce((R,k)=>R.length>k.length?R:k);this._applyFont(this.ctx);const h=this.ctx.measureText(a);let d=Math.abs(h.actualBoundingBoxAscent)+Math.abs(h.actualBoundingBoxDescent);const p=d*r.length;d=p;const m=p-Math.abs(h.actualBoundingBoxAscent),y=0,w=0;return new et({left:y-Math.abs(h.actualBoundingBoxLeft)-this.font.padding,top:w-Math.abs(h.actualBoundingBoxAscent)-this.font.padding,bottom:w+m+this.font.padding,right:y+Math.abs(h.actualBoundingBoxRight)+this.font.padding})}_setDimension(t,i){let r=1;this.font.lineHeight&&(r=this.font.lineHeight/this.font.size),i.canvas.width=(t.width+this.font.padding*2)*2*this.font.quality,i.canvas.height=(t.height+this.font.padding*2)*2*this.font.quality*r}static getHashCode(t,i,r){var a;return i+"__hashcode__"+t.fontString+t.showDebug+t.textAlign+t.baseAlign+t.direction+t.lineHeight+JSON.stringify(t.shadow)+(t.padding.toString()+t.smoothing.toString()+t.lineWidth.toString()+t.lineDash.toString()+((a=t.strokeColor)===null||a===void 0?void 0:a.toString())+(r?r.toString():t.color.toString()))}getHashCode(t=!0){return En.getHashCode(this.font,this.text,t?this.color:void 0)}_applyRasterProperties(t){var i,r;t.translate(this.font.padding,this.font.padding),t.imageSmoothingEnabled=this.font.smoothing,t.lineWidth=this.font.lineWidth,t.setLineDash((i=this.font.lineDash)!==null&&i!==void 0?i:t.getLineDash()),t.strokeStyle=(r=this.font.strokeColor)===null||r===void 0?void 0:r.toString(),t.fillStyle=this.color.toString()}_applyFont(t){t.resetTransform(),t.translate(this.font.padding+t.canvas.width/2,this.font.padding+t.canvas.height/2),t.scale(this.font.quality,this.font.quality),t.textAlign=this.font.textAlign,t.textBaseline=this.font.baseAlign,t.font=this.font.fontString,t.direction=this.font.direction,this.font.shadow&&(t.shadowColor=this.font.shadow.color.toString(),t.shadowBlur=this.font.shadow.blur,t.shadowOffsetX=this.font.shadow.offset.x,t.shadowOffsetY=this.font.shadow.offset.y)}_drawText(t,i,r){this._applyRasterProperties(t),this._applyFont(t);for(let a=0;a<i.length;a++){const h=i[a];this.color&&t.fillText(h,0,a*r),this.font.strokeColor&&t.strokeText(h,0,a*r)}this.font.showDebug&&(yh(t,G.Green,-t.canvas.width/2,0,t.canvas.width/2,0,2),yh(t,G.Red,0,-t.canvas.height/2,0,t.canvas.height/2,2))}_splitTextBitmap(t){const i=[];let r=0,a=0;const h=Math.min(4096,t.canvas.width),d=Math.min(4096,t.canvas.height);for(;r<t.canvas.width;){for(;a<t.canvas.height;){const p=document.createElement("canvas");p.width=h,p.height=d,p.getContext("2d").drawImage(t.canvas,r,a,h,d,0,0,h,d),i.push({x:r,y:a,canvas:p}),a+=d}r+=h,a=0}return i}flagDirty(){this._dirty=!0}render(t,i,r,a){var h;if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);this._ex=t;const d=this.getHashCode();if(this._lastHashCode!==d&&(this._dirty=!0),this._dirty){this.dimensions=this.measureText(this.text,a),this._setDimension(this.dimensions,this.ctx);const p=this._getLinesFromText(this.text,a),m=(h=this.font.lineHeight)!==null&&h!==void 0?h:this.dimensions.height/p.length;if(this._drawText(this.ctx,p,m),t instanceof Gi)for(const y of this._textFragments)t.textureLoader.delete(y.canvas);if(this._textFragments=this._splitTextBitmap(this.ctx),t instanceof Gi)for(const y of this._textFragments)t.textureLoader.load(y.canvas,{filtering:this.font.filtering},!0);this._lastHashCode=d,this._dirty=!1}for(const p of this._textFragments)t.drawImage(p.canvas,0,0,p.canvas.width,p.canvas.height,p.x/this.font.quality+i-this.ctx.canvas.width/this.font.quality/2,p.y/this.font.quality+r-this.ctx.canvas.height/this.font.quality/2,p.canvas.width/this.font.quality,p.canvas.height/this.font.quality)}dispose(){if(this.disposed=!0,this.dimensions=void 0,this.canvas=void 0,this.ctx=void 0,this._ex instanceof Gi)for(const t of this._textFragments)this._ex.textureLoader.delete(t.canvas);this._textFragments.length=0}_getLinesFromText(t,i){if(this._cachedText===t&&this._cachedRenderWidth===i)return this._cachedLines;const r=t.split(`
`);if(i==null)return r;for(let a=0;a<r.length;a++){let h=r[a],d="";if(this.measureText(h).width>i){for(;this.measureText(h).width>i;)d=h[h.length-1]+d,h=h.slice(0,-1);r[a]=h,r[a+1]=d}}return this._cachedText=t,this._cachedLines=r,this._cachedRenderWidth=i,r}}class Ct{static measureText(t,i,r){const a=En.getHashCode(i,t);if(Ct._MEASURE_CACHE.has(a))return Ct._MEASURE_CACHE.get(a);Ct._LOGGER.debug("Font text measurement cache miss");const h=i.measureTextWithoutCache(t,r);return Ct._MEASURE_CACHE.set(a,h),h}static getTextInstance(t,i,r){const a=En.getHashCode(i,t,r);let h=Ct._TEXT_CACHE.get(a);return h||(h=new En(i,t,r),Ct._TEXT_CACHE.set(a,h),Ct._LOGGER.debug("Font text instance cache miss")),Ct._TEXT_USAGE.set(h,performance.now()),h}static checkAndClearCache(){const t=[],i=new Set;for(const[a,h]of Ct._TEXT_USAGE.entries())if(h+Ct.FONT_TIMEOUT<performance.now())Ct._LOGGER.debug(`Text cache entry timed out ${a.text}`),t.push(a),a.dispose();else{const d=a.getHashCode(!1);i.add(d)}t.forEach(a=>{Ct._TEXT_USAGE.delete(a)}),this._TEXT_CACHE.clear();for(const[a]of this._TEXT_USAGE.entries())this._TEXT_CACHE.set(a.getHashCode(),a);const r=new Map;for(const a of i)Ct._MEASURE_CACHE.has(a)&&r.set(a,Ct._MEASURE_CACHE.get(a));this._MEASURE_CACHE.clear(),this._MEASURE_CACHE=r}static get cacheSize(){return Ct._TEXT_USAGE.size}static clearCache(){for(const[t]of Ct._TEXT_USAGE.entries())t.dispose();Ct._TEXT_USAGE.clear(),Ct._TEXT_CACHE.clear(),Ct._MEASURE_CACHE.clear()}}Ct.FONT_TIMEOUT=500,Ct._LOGGER=J.getInstance(),Ct._TEXT_USAGE=new Map,Ct._TEXT_CACHE=new Map,Ct._MEASURE_CACHE=new Map;class Vs extends zt{constructor(t={}){var i,r,a,h,d,p,m,y,w,b,R,k,M,z,X,N,U,$,W,tt;super(t),this.filtering=qt.Blended,this.quality=2,this.padding=2,this.smoothing=!1,this.lineWidth=1,this.lineDash=[],this.color=G.Black,this.family="sans-serif",this.style=ta.Normal,this.bold=!1,this.unit=Zo.Px,this.textAlign=Ko.Left,this.baseAlign=Jo.Top,this.direction=ea.LeftToRight,this.lineHeight=void 0,this.size=10,this.shadow=null,this._textBounds=new et,this._textMeasurement=new En(this,"",G.Black),this.smoothing=(i=t==null?void 0:t.smoothing)!==null&&i!==void 0?i:this.smoothing,this.padding=(r=t==null?void 0:t.padding)!==null&&r!==void 0?r:this.padding,this.color=(a=t==null?void 0:t.color)!==null&&a!==void 0?a:this.color,this.strokeColor=(h=t==null?void 0:t.strokeColor)!==null&&h!==void 0?h:this.strokeColor,this.lineDash=(d=t==null?void 0:t.lineDash)!==null&&d!==void 0?d:this.lineDash,this.lineWidth=(p=t==null?void 0:t.lineWidth)!==null&&p!==void 0?p:this.lineWidth,this.filtering=(m=t==null?void 0:t.filtering)!==null&&m!==void 0?m:this.filtering,this.family=(y=t==null?void 0:t.family)!==null&&y!==void 0?y:this.family,this.style=(w=t==null?void 0:t.style)!==null&&w!==void 0?w:this.style,this.bold=(b=t==null?void 0:t.bold)!==null&&b!==void 0?b:this.bold,this.size=(R=t==null?void 0:t.size)!==null&&R!==void 0?R:this.size,this.unit=(k=t==null?void 0:t.unit)!==null&&k!==void 0?k:this.unit,this.textAlign=(M=t==null?void 0:t.textAlign)!==null&&M!==void 0?M:this.textAlign,this.baseAlign=(z=t==null?void 0:t.baseAlign)!==null&&z!==void 0?z:this.baseAlign,this.direction=(X=t==null?void 0:t.direction)!==null&&X!==void 0?X:this.direction,this.lineHeight=(N=t==null?void 0:t.lineHeight)!==null&&N!==void 0?N:this.lineHeight,this.quality=(U=t==null?void 0:t.quality)!==null&&U!==void 0?U:this.quality,t!=null&&t.shadow&&(this.shadow={},this.shadow.blur=($=t.shadow.blur)!==null&&$!==void 0?$:this.shadow.blur,this.shadow.offset=(W=t.shadow.offset)!==null&&W!==void 0?W:this.shadow.offset,this.shadow.color=(tt=t.shadow.color)!==null&&tt!==void 0?tt:this.shadow.color)}clone(){return new Vs({...this.cloneGraphicOptions(),size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null})}get fontString(){return`${this.style} ${this.bold?"bold":""} ${this.size}${this.unit} ${this.family}`}get localBounds(){return this._textBounds}_drawImage(t,i,r){}_rotate(t){var i;const r=(i=this.origin)!==null&&i!==void 0?i:this._textBounds.center;t.translate(r.x,r.y),t.rotate(this.rotation),t.translate(-r.x,-r.y)}_flip(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}measureTextWithoutCache(t,i){return this._textMeasurement.measureText(t,i)}measureText(t,i){return Ct.measureText(t,this,i)}_postDraw(t){t.restore()}render(t,i,r,a,h,d){const p=Ct.getTextInstance(i,this,r);this._textBounds=p.dimensions,this._preDraw(t,a,h),p.render(t,a,h,d),this._postDraw(t)}}class Ar extends zt{constructor(t){var i,r;super(t),this._text="",this._textWidth=0,this._textHeight=0,this.font=(i=t.font)!==null&&i!==void 0?i:new Vs,this.color=(r=t.color)!==null&&r!==void 0?r:this.color,this.text=t.text,this.maxWidth=t.maxWidth}clone(){var t,i;return new Ar({text:this.text.slice(),color:(i=(t=this.color)===null||t===void 0?void 0:t.clone())!==null&&i!==void 0?i:G.Black,font:this.font.clone(),maxWidth:this.maxWidth})}get text(){return this._text}set text(t){this._text=t,this._calculateDimension()}get font(){return this._font}set font(t){this._font=t}get width(){return this._textWidth===0&&this._calculateDimension(),this._textWidth*this.scale.x}get height(){return this._textHeight===0&&this._calculateDimension(),this._textHeight*this.scale.y}_calculateDimension(){const{width:t,height:i}=this.font.measureText(this._text,this.maxWidth);this._textWidth=t,this._textHeight=i}get localBounds(){return this.font.measureText(this._text,this.maxWidth).scale(this.scale)}_rotate(t){}_flip(t){}_preDraw(t,i,r){(this.isStale()||this.font.isStale())&&(this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity),this.font.tint=this.tint,super._preDraw(t,i,r)}_drawImage(t,i,r){var a;let h=G.Black;this.font instanceof Vs&&(h=(a=this.color)!==null&&a!==void 0?a:this.font.color);const{width:d,height:p}=this.font.measureText(this._text,this.maxWidth);this._textWidth=d,this._textHeight=p,this.font.render(t,this._text,h,i,r,this.maxWidth),this.font.showDebug&&(t.debug.drawRect(i-d,r-p,d*2,p*2),this.maxWidth!=null&&t.debug.drawRect(i,r,this.maxWidth,this.height,{color:G.Yellow}))}}class Oe extends ge{get pos(){return this.transform.pos}set pos(t){this.transform.pos=t.clone()}get oldPos(){return this.body.oldPos}set oldPos(t){this.body.oldPos.setTo(t.x,t.y)}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t.clone()}get oldVel(){return this.body.oldVel}set oldVel(t){this.body.oldVel.setTo(t.x,t.y)}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t.clone()}set oldAcc(t){this.body.oldAcc.setTo(t.x,t.y)}get oldAcc(){return this.body.oldAcc}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}get scale(){return this.get(it).scale}set scale(t){this.get(it).scale=t}get anchor(){return this._anchor}set anchor(t){this._anchor=Xt(t,i=>this._handleAnchorChange(i)),this._handleAnchorChange(t)}_handleAnchorChange(t){this.graphics&&(this.graphics.anchor=t)}get offset(){return this._offset}set offset(t){this._offset=Xt(t,i=>this._handleOffsetChange(i)),this._handleOffsetChange(t)}_handleOffsetChange(t){this.graphics&&(this.graphics.offset=t)}get isOffScreen(){return this.hasTag("ex.offscreen")}get draggable(){return this._draggable}set draggable(t){t&&(t&&!this._draggable?(this.events.on("pointerdragstart",this._pointerDragStartHandler),this.events.on("pointerdragend",this._pointerDragEndHandler),this.events.on("pointerdragmove",this._pointerDragMoveHandler),this.events.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.events.off("pointerdragstart",this._pointerDragStartHandler),this.events.off("pointerdragend",this._pointerDragEndHandler),this.events.off("pointerdragmove",this._pointerDragMoveHandler),this.events.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}get color(){return this._color}set color(t){this._color=t.clone();const i=this.graphics.current;(i instanceof yn||i instanceof Ar)&&(i.color=this._color)}constructor(t){super(),this.events=new v,this._anchor=Xt(E.Half,gt=>this._handleAnchorChange(gt)),this._offset=Xt(E.Zero,gt=>this._handleOffsetChange(gt)),this.logger=J.getInstance(),this._draggable=!1,this._dragging=!1,this._pointerDragStartHandler=()=>{this._dragging=!0},this._pointerDragEndHandler=()=>{this._dragging=!1},this._pointerDragMoveHandler=gt=>{this._dragging&&(this.pos=gt.worldPos)},this._pointerDragLeaveHandler=gt=>{this._dragging&&(this.pos=gt.worldPos)};const{name:i,x:r,y:a,pos:h,coordPlane:d,scale:p,width:m,height:y,radius:w,collider:b,vel:R,acc:k,rotation:M,angularVelocity:z,z:X,color:N,visible:U,opacity:$,anchor:W,offset:tt,collisionType:pt,collisionGroup:Q}={...t};this.name=i??this.name,this.anchor=W??Oe.defaults.anchor.clone(),this.offset=tt??E.Zero,this.transform=new it,this.addComponent(this.transform),this.pos=h??B(r??0,a??0),this.rotation=M??0,this.scale=p??B(1,1),this.z=X??0,this.transform.coordPlane=d??ie.World,this.pointer=new Di,this.addComponent(this.pointer),this.graphics=new ne({anchor:this.anchor,offset:this.offset,opacity:$}),this.addComponent(this.graphics),this.motion=new Mt,this.addComponent(this.motion),this.vel=R??E.Zero,this.acc=k??E.Zero,this.angularVelocity=z??0,this.actions=new Sn,this.addComponent(this.actions),this.body=new ht,this.addComponent(this.body),this.body.collisionType=pt??ut.Passive,Q&&(this.body.group=Q),b?(this.collider=new Wt(b),this.addComponent(this.collider)):w?(this.collider=new Wt(pe.Circle(w)),this.addComponent(this.collider)):m>0&&y>0?(this.collider=new Wt(pe.Box(m,y,this.anchor)),this.addComponent(this.collider)):(this.collider=new Wt,this.addComponent(this.collider)),this.graphics.visible=U??!0,N&&(this.color=N,m&&y?this.graphics.add(new Sr({color:N,width:m,height:y})):w&&this.graphics.add(new qo({color:N,radius:w})))}clone(){const t=new Oe({color:this.color.clone(),anchor:this.anchor.clone(),offset:this.offset.clone()});t.clearComponents(),t.processComponentRemoval(),t.addComponent(t.transform=this.transform.clone(),!0),t.addComponent(t.pointer=this.pointer.clone(),!0),t.addComponent(t.graphics=this.graphics.clone(),!0),t.addComponent(t.motion=this.motion.clone(),!0),t.addComponent(t.actions=this.actions.clone(),!0),t.addComponent(t.body=this.body.clone(),!0),t.addComponent(t.collider=this.collider.clone(),!0);const i=[this.transform,this.pointer,this.graphics,this.motion,this.actions,this.body,this.collider],r=this.getComponents();for(const a of r)i.includes(a)||t.addComponent(a.clone(),!0);return t}onInitialize(t){}_initialize(t){super._initialize(t);for(const i of this.children)i._initialize(t)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}_prekill(t){this.events.emit("prekill",new $l(this)),this.onPreKill(t)}onPreKill(t){}_postkill(t){this.events.emit("postkill",new Yl(this)),this.onPostKill(t)}onPostKill(t){}kill(){this.scene?(this._prekill(this.scene),this.events.emit("kill",new zo(this)),super.kill(),this._postkill(this.scene)):this.logger.warn(`Cannot kill actor named "${this.name}", it was never added to the Scene`)}unkill(){this.active=!0}isKilled(){return!this.active}get z(){return this.get(it).z}set z(t){this.get(it).z=t}get center(){const t=this.getGlobalPos();return new E(t.x+this.width/2-this.anchor.x*this.width,t.y+this.height/2-this.anchor.y*this.height)}get localCenter(){return new E(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}get width(){return this.collider.localBounds.width*this.getGlobalScale().x}get height(){return this.collider.localBounds.height*this.getGlobalScale().y}getGlobalRotation(){return this.get(it).globalRotation}getGlobalPos(){return this.get(it).globalPos}getGlobalScale(){return this.get(it).globalScale}contains(t,i,r=!1){const a=B(t,i),h=this.get(Wt);h.update();const d=h.get();if(!d)return!1;const p=d.contains(a);return r?p||this.children.some(m=>m.contains(t,i,!0)):p}within(t,i){const r=this.get(Wt),a=t.get(Wt),h=r.get(),d=a.get();return h&&d?h.getClosestLineBetween(d).getLength()<=i:!1}update(t,i){this._initialize(t),this._preupdate(t,i),this._postupdate(t,i)}onPreUpdate(t,i){}onPostUpdate(t,i){}onPreCollisionResolve(t,i,r,a){}onPostCollisionResolve(t,i,r,a){}onCollisionStart(t,i,r,a){}onCollisionEnd(t,i,r,a){}_preupdate(t,i){this.events.emit("preupdate",new rs(t,i,this)),this.onPreUpdate(t,i)}_postupdate(t,i){this.events.emit("postupdate",new os(t,i,this)),this.onPostUpdate(t,i)}}Oe.defaults={anchor:E.Half};function ff(u){return u instanceof Rh}class Rh extends Oe{constructor(t){var i,r;super({...t}),this.get(it).coordPlane=ie.Screen,this.anchor=(i=t==null?void 0:t.anchor)!==null&&i!==void 0?i:B(0,0),this.body.collisionType=(r=t==null?void 0:t.collisionType)!==null&&r!==void 0?r:ut.PreventCollision,this.pointer.useGraphicsBounds=!0,this.pointer.useColliderShape=!1,!(t!=null&&t.collider)&&(t==null?void 0:t.width)>0&&(t==null?void 0:t.height)>0&&this.collider.useBoxCollider(this.width,this.height,this.anchor)}_initialize(t){this._engine=t,super._initialize(t)}contains(t,i,r=!0){if(r)return super.contains(t,i);const a=this._engine.worldToScreenCoordinates(new E(t,i));return super.contains(a.x,a.y)}}class Gs{get complete(){return this._complete}constructor(t,i,r,a,h,d){if(this._logger=J.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this.randomRange=[0,0],this._baseInterval=10,this._generateRandomInterval=()=>this._baseInterval+this.random.integer(this.randomRange[0],this.randomRange[1]),this._complete=!1,this.scene=null,typeof t!="function"){const p=t;t=p.fcn,i=p.interval,r=p.repeats,a=p.numberOfRepeats,h=p.randomRange,d=p.random}if(a&&a>=0&&(this.maxNumberOfRepeats=a,!r))throw new Error("repeats must be set to true if numberOfRepeats is set");if(this.id=Gs._MAX_ID++,this._callbacks=[],this._baseInterval=this.interval=i,h){if(h[0]>h[1])throw new Error("min value must be lower than max value for range");this.random=d??new T,this.randomRange=h,this.interval=this._generateRandomInterval(),this.on(()=>{this.interval=this._generateRandomInterval()})}this.repeats=r||this.repeats,t&&this.on(t)}on(t){this._callbacks.push(t)}off(t){const i=this._callbacks.indexOf(t);this._callbacks.splice(i,1)}update(t){this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach(i=>{i.call(this)}),this._numberOfTicks++,this.repeats?this._elapsedTime=0:(this._complete=!0,this._running=!1,this._elapsedTime=0)))}reset(t,i){if(t&&t>=0&&(this._baseInterval=this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=i,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}get timesRepeated(){return this._numberOfTicks}getTimeRunning(){return this._totalTimeAlive}get timeToNextAction(){return this.complete?0:this.interval-this._elapsedTime}get timeElapsedTowardNextAction(){return this._elapsedTime}get isRunning(){return this._running}pause(){return this._running=!1,this}resume(){return this._running=!0,this}start(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}stop(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}cancel(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}Gs._MAX_ID=0;class ia extends mi{constructor(t){super(),this.parallaxFactor=B(1,1),this.parallaxFactor=t??this.parallaxFactor}}class sa extends mi{constructor(t,i=!0){super(),this.draw=t,this.useTransform=i}}const K0={PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw",PointerUp:"pointerup",PointerDown:"pointerdown",PointerMove:"pointermove",PointerCancel:"pointercancel"};class pf extends ge{flagCollidersDirty(){this._collidersDirty=!0}flagTilesDirty(){for(let t=0;t<this.tiles.length;t++)this.tiles[t]&&this.tiles[t].flagDirty()}get x(){var t;return(t=this.transform.pos.x)!==null&&t!==void 0?t:0}set x(t){var i;!((i=this.transform)===null||i===void 0)&&i.pos&&(this.get(it).pos=B(t,this.y))}get y(){var t,i;return(i=(t=this.transform)===null||t===void 0?void 0:t.pos.y)!==null&&i!==void 0?i:0}set y(t){var i;!((i=this.transform)===null||i===void 0)&&i.pos&&(this.transform.pos=B(this.x,t))}get z(){var t;return(t=this.transform.z)!==null&&t!==void 0?t:0}set z(t){this.transform&&(this.transform.z=t)}get rotation(){var t,i;return(i=(t=this.transform)===null||t===void 0?void 0:t.rotation)!==null&&i!==void 0?i:0}set rotation(t){this.transform&&(this.transform.rotation=t)}get scale(){var t,i;return(i=(t=this.transform)===null||t===void 0?void 0:t.scale)!==null&&i!==void 0?i:E.One}set scale(t){var i;!((i=this.transform)===null||i===void 0)&&i.scale&&(this.transform.scale=t)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t}get vel(){return this._motion.vel}set vel(t){this._motion.vel=t}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}constructor(t){var i,r,a;super([],t.name),this.events=new v,this._token=0,this.logger=J.getInstance(),this.tiles=[],this._rows=[],this._cols=[],this.renderFromTopOfGraphic=!1,this.meshingLookBehind=10,this._collidersDirty=!0,this._forwardPointerEventToTile=d=>p=>{const m=this.getTileByPoint(p.worldPos);m&&m.events.emit(d,p)},this._originalOffsets=new WeakMap,this.meshingLookBehind=(i=t.meshingLookBehind)!==null&&i!==void 0?i:this.meshingLookBehind,this.addComponent(new it),this.addComponent(new Mt),this.addComponent(new ht({type:ut.Fixed})),this.addComponent(new ne({onPostDraw:(d,p)=>this.draw(d,p)})),this.addComponent(new sa((d,p)=>this.debug(d,p),!1)),this.addComponent(new Wt),this.addComponent(new Di),this.pointer=this.get(Di),this._graphics=this.get(ne),this.transform=this.get(it),this._motion=this.get(Mt),this.collider=this.get(Wt),this._composite=this.collider.useCompositeCollider([]),this.transform.pos=(r=t.pos)!==null&&r!==void 0?r:E.Zero,this._oldPos=this.transform.pos.clone(),this._oldScale=this.transform.scale.clone(),this.renderFromTopOfGraphic=(a=t.renderFromTopOfGraphic)!==null&&a!==void 0?a:this.renderFromTopOfGraphic,this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight,this.rows=t.rows,this.columns=t.columns,this.tiles=new Array(this.rows*this.columns),this._rows=new Array(this.rows),this._cols=new Array(this.columns);let h=[];for(let d=0;d<this.columns;d++){for(let p=0;p<this.rows;p++){const m=new gf({x:d,y:p,map:this});m.map=this,this.tiles[d+p*this.columns]=m,h.push(m),this._rows[p]||(this._rows[p]=[]),this._rows[p].push(m)}this._cols[d]=h,h=[]}this._setupPointerToTile(),this._graphics.localBounds=new et({left:0,top:0,right:this.columns*this.tileWidth*this.scale.x,bottom:this.rows*this.tileHeight*this.scale.y})}_initialize(t){super._initialize(t),this._engine=t}_setupPointerToTile(){this.events.on("pointerup",this._forwardPointerEventToTile("pointerup")),this.events.on("pointerdown",this._forwardPointerEventToTile("pointerdown")),this.events.on("pointermove",this._forwardPointerEventToTile("pointermove")),this.events.on("pointercancel",this._forwardPointerEventToTile("pointercancel"))}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const i=t.offset;return this._originalOffsets.set(t,i),i}}_updateColliders(){this.collider.$colliderRemoved.notifyAll(this._composite),this._composite.clearColliders();const t=[];this._composite=this.collider.useCompositeCollider([]);let i;const r=(h,d)=>h&&d?h.top===d.top&&h.bottom===d.bottom&&h.right===d.left:!1,a=(h,d,p=this.meshingLookBehind)=>{if(!h)return!1;for(let m=d.length-1;m>=0;m--){if(p--<0)return!1;const y=d[m];if(r(y,h))return d[m]=y.combine(h),!0}return!1};for(let h=0;h<this.columns;h++){for(let d=0;d<this.rows;d++){const p=this.tiles[h+d*this.columns];if(p.solid)if(p.getColliders().length>0){for(const m of p.getColliders()){const y=this._getOrSetColliderOriginalOffset(m);m.offset=B(p.x*this.tileWidth*this.scale.x,p.y*this.tileHeight*this.scale.y).add(y),m.owner=this,this._composite.addCollider(m)}i&&!a(i,t)&&t.push(i),i=null}else i?i=i.combine(p.defaultGeometry):i=p.defaultGeometry;else i&&!a(i,t)&&t.push(i),i=null}i&&!a(i,t)&&t.push(i),i=null}for(const h of t){const d=pe.Box(h.width,h.height,E.Zero,B(h.left-this.pos.x,h.top-this.pos.y));d.owner=this,this._composite.addCollider(d)}this.collider.update(),this.collider.$colliderAdded.notifyAll(this._composite)}getTileByIndex(t){return this.tiles[t]}getTile(t,i){return t<0||i<0||t>=this.columns||i>=this.rows?null:this.tiles[t+i*this.columns]}getTileByPoint(t){const{x:i,y:r}=this._getTileCoordinates(t),a=this.getTile(i,r);return i>=0&&r>=0&&i<this.columns&&r<this.rows&&a?a:null}_getTileCoordinates(t){t=this.transform.applyInverse(t);const i=Math.floor(t.x/this.tileWidth),r=Math.floor(t.y/this.tileHeight);return{x:i,y:r}}getRows(){return this._rows}getColumns(){return this._cols}getOnScreenTiles(){let t=this._engine.screen.getWorldBounds();const i=this.get(ia);if(i&&this.isInitialized){let k=this.pos;const M=E.One.sub(i.parallaxFactor),z=this._engine.currentScene.camera.pos.scale(M);k=k.sub(z),t=t.translate(k)}const r=this.transform.coordPlane===ie.Screen?this._engine.screen.getScreenBounds():t,a=this._getTileCoordinates(r.topLeft),h=this._getTileCoordinates(r.topRight),d=this._getTileCoordinates(r.bottomRight),p=this._getTileCoordinates(r.bottomLeft),m=Math.min(L(a.x,0,this.columns-1),L(h.x,0,this.columns-1)),y=Math.min(L(a.y,0,this.rows-1),L(h.y,0,this.rows-1)),w=Math.max(L(d.x,0,this.columns-1),L(p.x,0,this.columns-1)),b=Math.max(L(d.y,0,this.rows-1),L(p.y,0,this.rows-1)),R=[];for(let k=m;k<=w;k++)for(let M=y;M<=b;M++)R.push(this.getTile(k,M));return R}update(t,i){this._initialize(t),this.onPreUpdate(t,i),this.emit("preupdate",new rs(t,i,this)),(!this._oldPos.equals(this.pos)||this._oldRotation!==this.rotation||!this._oldScale.equals(this.scale))&&(this.flagCollidersDirty(),this.flagTilesDirty()),this._collidersDirty&&(this._collidersDirty=!1,this._updateColliders()),this._token++,this.pos.clone(this._oldPos),this._oldRotation=this.rotation,this.scale.clone(this._oldScale),this.transform.pos=this.pos,this.onPostUpdate(t,i),this.emit("postupdate",new os(t,i,this))}draw(t,i){if(!this.isInitialized)return;this.emit("predraw",new wn(t,i,this));let r,a,h;const d=this.getOnScreenTiles();for(let p=0;p<d.length;p++){const m=d[p],y=m.getGraphicsOffsets();for(r=m.getGraphics(),a=0,h=r.length;a<h;a++){const w=r[a],b=y[a];if(w){Ah(w)&&(w==null||w.tick(i,this._token));const R=this.renderFromTopOfGraphic?0:w.height-this.tileHeight;w.draw(t,m.x*this.tileWidth+b.x,m.y*this.tileHeight-R+b.y)}}}this.emit("postdraw",new xn(t,i,this))}debug(t,i){const{showAll:r,showGrid:a,gridColor:h,gridWidth:d,showSolidBounds:p,solidBoundsColor:m,showColliderGeometry:y}=i.tilemap,{geometryColor:w,geometryLineWidth:b,geometryPointSize:R}=i.collider,k=this.tileWidth*this.columns*this.scale.x,M=this.tileHeight*this.rows*this.scale.y,z=this.pos;if(a||r){for(let X=0;X<this.rows+1;X++){const N=B(0,X*this.tileHeight*this.scale.y);t.drawLine(z.add(N),z.add(B(k,N.y)),h,d)}for(let X=0;X<this.columns+1;X++){const N=B(X*this.tileWidth*this.scale.x,0);t.drawLine(z.add(N),z.add(B(N.x,M)),h,d)}}if(r||p||y){const X=this._composite.getColliders();t.save(),t.translate(this.pos.x,this.pos.y),t.scale(this.scale.x,this.scale.y);for(const N of X){const U=N.localBounds,$=N.worldPos.sub(this.pos);p&&t.drawRectangle($,U.width,U.height,m)}if(t.restore(),y)for(const N of X)N.debug(t,w,{lineWidth:b,pointSize:R})}if(r||p){if(t.save(),t.z=999,p)for(let X=0;X<this.tiles.length;X++)this.tiles[X].bounds.draw(t);t.restore()}}}class gf{get pos(){return this._posDirty&&(this._recalculate(),this._posDirty=!1),this._pos}get width(){return this._width}get height(){return this._height}get solid(){return this._solid}set solid(t){var i;(i=this.map)===null||i===void 0||i.flagCollidersDirty(),this._solid=t}getGraphics(){return this._graphics}getGraphicsOffsets(){return this._offsets}addGraphic(t,i){this._graphics.push(t),i!=null&&i.offset?this._offsets.push(i.offset):this._offsets.push(E.Zero)}removeGraphic(t){const i=this._graphics.indexOf(t);i>-1&&(this._graphics.splice(i,1),this._offsets.splice(i,1))}clearGraphics(){this._graphics.length=0,this._offsets.length=0}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const i=this._colliders.indexOf(t);i>-1&&this._colliders.splice(i,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}constructor(t){var i,r;this._posDirty=!1,this.events=new v,this._solid=!1,this._graphics=[],this._offsets=[],this._colliders=[],this.data=new Map,this.x=t.x,this.y=t.y,this.map=t.map,this._width=t.map.tileWidth*this.map.scale.x,this._height=t.map.tileHeight*this.map.scale.y,this.solid=(i=t.solid)!==null&&i!==void 0?i:this.solid,this._graphics=(r=t.graphics)!==null&&r!==void 0?r:[],this._recalculate()}flagDirty(){return this._posDirty=!0}_recalculate(){const t=this.map.pos.add(B(this.x*this.map.tileWidth,this.y*this.map.tileHeight));this._geometry=new et(t.x,t.y,t.x+this.map.tileWidth,t.y+this.map.tileHeight),this._width=this.map.tileWidth*this.map.scale.x,this._height=this.map.tileHeight*this.map.scale.y,this._pos=this.map.pos.add(B(this.x*this._width,this.y*this._height)),this._bounds=new et(this._pos.x,this._pos.y,this._pos.x+this._width,this._pos.y+this._height),this.map.rotation&&(this._bounds=this._bounds.rotate(this.map.rotation,this.map.pos)),this._posDirty=!1}get bounds(){return this._posDirty&&this._recalculate(),this._bounds}get defaultGeometry(){return this._geometry}get center(){return this._posDirty&&this._recalculate(),new E(this._pos.x+this._width/2,this._pos.y+this._height/2)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){i?this.events.off(t,i):this.events.off(t)}}class mf{constructor(t){this.camera=t}lockToActor(t){this.camera.addStrategy(new _f(t))}lockToActorAxis(t,i){this.camera.addStrategy(new vf(t,i))}elasticToActor(t,i,r){this.camera.addStrategy(new yf(t,i,r))}radiusAroundActor(t,i){this.camera.addStrategy(new wf(t,i))}limitCameraBounds(t){this.camera.addStrategy(new xf(t))}}var na;(function(u){u[u.X=0]="X",u[u.Y=1]="Y"})(na||(na={}));class _f{constructor(t){this.target=t,this.action=(i,r,a,h)=>i.center}}class vf{constructor(t,i){this.target=t,this.axis=i,this.action=(r,a,h,d)=>{const p=r.center,m=a.getFocus();return this.axis===na.X?new E(p.x,m.y):new E(m.x,p.y)}}}class yf{constructor(t,i,r){this.target=t,this.cameraElasticity=i,this.cameraFriction=r,this.action=(a,h,d,p)=>{const m=a.center;let y=h.getFocus(),w=h.vel.clone();const b=m.sub(y).scale(this.cameraElasticity);w=w.add(b);const R=w.scale(-1).scale(this.cameraFriction);return w=w.add(R),y=y.add(w),y}}}class wf{constructor(t,i){this.target=t,this.radius=i,this.action=(r,a,h,d)=>{const p=r.center,m=a.getFocus(),y=p.sub(m),w=y.size;if(w>=this.radius){const b=w-this.radius;return m.add(y.normalize().scale(b))}return m}}}class xf{constructor(t){this.target=t,this.boundSizeChecked=!1,this.action=(i,r,a,h)=>{const d=r.getFocus();this.boundSizeChecked||((i.bottom-i.top<a.drawHeight||i.right-i.left<a.drawWidth)&&J.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),this.boundSizeChecked=!0);let p=d.x,m=d.y;return d.x<i.left+a.halfDrawWidth?p=i.left+a.halfDrawWidth:d.x>i.right-a.halfDrawWidth&&(p=i.right-a.halfDrawWidth),d.y<i.top+a.halfDrawHeight?m=i.top+a.halfDrawHeight:d.y>i.bottom-a.halfDrawHeight&&(m=i.bottom-a.halfDrawHeight),B(p,m)}}}const J0={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate"};class bf{constructor(){this.events=new v,this.transform=xt.identity(),this.inverse=xt.identity(),this._cameraStrategies=[],this.strategy=new mf(this),this._z=1,this.dz=0,this.az=0,this.rotation=0,this._angularVelocity=0,this._posChanged=!1,this._pos=_r(E.Zero,()=>this._posChanged=!0),this.drawPos=this.pos.clone(),this._oldPos=this.pos.clone(),this.vel=E.Zero,this.acc=E.Zero,this._cameraMoving=!1,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=null,this._lerpEnd=null,this._isShaking=!1,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._elapsedShakeTime=0,this._xShake=0,this._yShake=0,this._isZooming=!1,this._zoomStart=1,this._zoomEnd=1,this._currentZoomTime=0,this._zoomDuration=0,this._zoomEasing=It.EaseInOutCubic,this._easing=It.EaseInOutCubic,this._halfWidth=0,this._halfHeight=0,this._viewport=null,this._isInitialized=!1,this._snapPos=B(0,0)}get zoom(){return this._z}set zoom(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}get angularVelocity(){return this._angularVelocity}set angularVelocity(t){this._angularVelocity=t}get pos(){return this._pos}set pos(t){this._pos=_r(t,()=>this._posChanged=!0),this._posChanged=!0}get x(){return this.pos.x}set x(t){!this._follow&&!this._cameraMoving&&(this.pos=B(t,this.pos.y))}get y(){return this.pos.y}set y(t){!this._follow&&!this._cameraMoving&&(this.pos=B(this.pos.x,t))}get dx(){return this.vel.x}set dx(t){this.vel=B(t,this.vel.y)}get dy(){return this.vel.y}set dy(t){this.vel=B(this.vel.x,t)}get ax(){return this.acc.x}set ax(t){this.acc=B(t,this.acc.y)}get ay(){return this.acc.y}set ay(t){this.acc=B(this.acc.x,t)}getFocus(){return this.pos}move(t,i,r=It.EaseInOutCubic){if(typeof r!="function")throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise(a=>{this._lerpResolve=a}),this._lerpStart=this.getFocus().clone(),this._lerpDuration=i,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=r,this._lerpPromise)}shake(t,i,r){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=i,this._shakeDuration=r}zoomOverTime(t,i=0,r=It.EaseInOutCubic){if(this._zoomPromise=new Promise(a=>{this._zoomResolve=a}),i)this._isZooming=!0,this._zoomEasing=r,this._currentZoomTime=0,this._zoomDuration=i,this._zoomStart=this.zoom,this._zoomEnd=t;else return this._isZooming=!1,this.zoom=t,Promise.resolve(!0);return this._zoomPromise}get viewport(){return this._viewport?this._viewport:new et(0,0,0,0)}addStrategy(t){this._cameraStrategies.push(t)}removeStrategy(t){lt(t,this._cameraStrategies)}clearAllStrategies(){this._cameraStrategies.length=0}_preupdate(t,i){this.events.emit("preupdate",new rs(t,i,this)),this.onPreUpdate(t,i)}onPreUpdate(t,i){}_postupdate(t,i){this.events.emit("postupdate",new os(t,i,this)),this.onPostUpdate(t,i)}onPostUpdate(t,i){}get isInitialized(){return this._isInitialized}_initialize(t){if(!this.isInitialized){this._engine=t,this._screen=t.screen;const i=this._screen.contentArea;let r=B(i.width/2,i.height/2);if(!this._engine.loadingComplete){const a=this._screen.peekResolution();a&&(r=B(a.width/2,a.height/2))}this._halfWidth=r.x,this._halfHeight=r.y,this._posChanged||(this.pos=r),this.pos.clone(this.drawPos),this.updateTransform(this.pos),this.runStrategies(t,t.clock.elapsed()),this.updateViewport(),this.updateTransform(this.pos),this.pos.clone(this._oldPos),this.onInitialize(t),this.events.emit("initialize",new bn(t,this)),this._isInitialized=!0}}onInitialize(t){}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}runStrategies(t,i){for(const r of this._cameraStrategies)this.pos=r.action.call(r,r.target,this,t,i)}updateViewport(){this._viewport=new et(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight)}update(t,i){if(this._initialize(t),this._preupdate(t,i),this.pos.clone(this._oldPos),this.pos=this.pos.add(this.vel.scale(i/1e3)),this.zoom+=this.dz*i/1e3,this.vel=this.vel.add(this.acc.scale(i/1e3)),this.dz+=this.az*i/1e3,this.rotation+=this.angularVelocity*i/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){const r=this._zoomEasing,a=r(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=a,this._currentZoomTime+=i}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){const a=It.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=a,this._currentLerpTime+=i}else{this.pos=this._lerpEnd;const r=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(r)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=i,this._xShake=(Math.random()*this._shakeMagnitudeX|0)+1,this._yShake=(Math.random()*this._shakeMagnitudeY|0)+1),this.runStrategies(t,i),this.updateViewport(),this.updateTransform(this.pos),this._postupdate(t,i)}draw(t){if(this.pos.clone(this.drawPos),this._engine.fixedUpdateFps){const i=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps),r=this.pos.scale(i).add(this._oldPos.scale(1-i));r.clone(this.drawPos),this.updateTransform(r)}if(t.snapToPixel){const i=this.drawPos.clone(this._snapPos);i.x=~~(i.x+_t*O(i.x)),i.y=~~(i.y+_t*O(i.y)),i.clone(this.drawPos),this.updateTransform(i)}t.multiply(this.transform)}updateTransform(t){const i=this._screen.resolution.width/this.zoom,r=this._screen.resolution.height/this.zoom,a=B(-t.x+i/2+this._xShake,-t.y+r/2+this._yShake);this.transform.reset(),this.transform.scale(this.zoom,this.zoom),this.transform.translate(i/2,r/2),this.transform.rotate(this.rotation),this.transform.translate(-i/2,-r/2),this.transform.translate(a.x,a.y),this.transform.inverse(this.inverse)}_isDoneShaking(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}const ty={ExitTrigger:"exit",EnterTrigger:"enter"},ey={pos:E.Zero,width:10,height:10,visible:!1,action:()=>{},filter:()=>!0,repeat:-1};class Cf extends Oe{constructor(t){super({x:t.pos.x,y:t.pos.y,width:t.width,height:t.height}),this.events=new v,this.action=()=>{},this.filter=()=>!0,this.repeat=-1,t={...ey,...t},this.filter=t.filter||this.filter,this.repeat=t.repeat||this.repeat,this.action=t.action||this.action,t.target&&(this.target=t.target),this.graphics.visible=t.visible,this.body.collisionType=ut.Passive,this.events.on("collisionstart",i=>{this.filter(i.other)&&(this.events.emit("enter",new fh(this,i.other)),this._dispatchAction(),this.repeat===0&&this.kill())}),this.events.on("collisionend",i=>{this.filter(i.other)&&this.events.emit("exit",new ph(this,i.other))})}set target(t){this._target=t,this.filter=i=>i===t}get target(){return this._target}_initialize(t){super._initialize(t)}_dispatchAction(){this.repeat!==0&&(this.action.call(this),this.repeat--)}}const ki={Highest:-1/0,Higher:-5,Average:0,Lower:5,Lowest:1/0};var Ne;(function(u){u.Update="update",u.Draw="draw"})(Ne||(Ne={}));class li{constructor(){this.priority=ki.Average}}class Sf{constructor(t){this._world=t,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}updateEntities(t,i){for(const r of this.entities)r.update(t.engine,i),r.active||this.removeEntity(r)}findEntitiesForRemoval(){for(const t of this.entities)t.active||this.removeEntity(t)}addEntity(t){t.active=!0,t.scene=this._world.scene,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.children.forEach(i=>{i.scene=t.scene,this.addEntity(i)}),t.childrenAdded$.register({notify:i=>{this.addEntity(i)}}),t.childrenRemoved$.register({notify:i=>{this.removeEntity(i,!1)}}))}removeEntity(t,i=!0){var r,a;let h=0;t instanceof ge?h=t.id:h=t;const d=this._entityIndex[h];if(d&&d.active&&(d.active=!1),d&&i){this._entitiesToRemove.push(d);return}delete this._entityIndex[h],d&&(d.scene=null,lt(d,this.entities),this._world.queryManager.removeEntity(d),d.children.forEach(p=>{p.scene=null,this.removeEntity(p,i)}),d.childrenAdded$.clear(),d.childrenRemoved$.clear(),!((a=(r=this._world)===null||r===void 0?void 0:r.scene)===null||a===void 0)&&a.engine&&this._world.scene.engine.stats.currFrame.actors.killed++)}processEntityRemovals(){for(const t of this._entitiesToRemove)t.active||this.removeEntity(t,!1);this._entitiesToRemove.length=0}processComponentRemovals(){for(const t of this.entities)t.processComponentRemoval()}getById(t){return this._entityIndex[t]}getByName(t){return this.entities.filter(i=>i.name===t)}clear(){for(let t=this.entities.length-1;t>=0;t--)this.removeEntity(this.entities[t])}}class Tr{constructor(t){if(this.requiredComponents=t,this.components=new Set,this.entities=[],this.entityAdded$=new xe,this.entityRemoved$=new xe,t.length===0)throw new Error("Cannot create query without components");for(const i of t)this.components.add(i);this.id=Tr.createId(t)}static createId(t){return t.slice().map(i=>i.name).sort().join("-")}checkAndAdd(t){return!this.entities.includes(t)&&t.hasAll(Array.from(this.components))?(this.entities.push(t),this.entityAdded$.notifyAll(t),!0):!1}removeEntity(t){const i=this.entities.indexOf(t);i>-1&&(this.entities.splice(i,1),this.entityRemoved$.notifyAll(t))}getEntities(t){return t&&this.entities.sort(t),this.entities}}class Pr{constructor(t){if(this.requiredTags=t,this.tags=new Set,this.entities=[],this.entityAdded$=new xe,this.entityRemoved$=new xe,t.length===0)throw new Error("Cannot create tag query without tags");for(const i of t)this.tags.add(i);this.id=Pr.createId(t)}static createId(t){return t.slice().sort().join("-")}checkAndAdd(t){return!this.entities.includes(t)&&t.hasAllTags(Array.from(this.tags))?(this.entities.push(t),this.entityAdded$.notifyAll(t),!0):!1}removeEntity(t){const i=this.entities.indexOf(t);i>-1&&(this.entities.splice(i,1),this.entityRemoved$.notifyAll(t))}getEntities(t){return t&&this.entities.sort(t),this.entities}}class Ef{constructor(t){this._world=t,this._queries=new Map,this._addComponentHandlers=new Map,this._removeComponentHandlers=new Map,this._componentToQueriesIndex=new Map,this._tagQueries=new Map,this._addTagHandlers=new Map,this._removeTagHandlers=new Map,this._tagToQueriesIndex=new Map,this._createAddComponentHandler=i=>r=>{this.addComponent(i,r)},this._createRemoveComponentHandler=i=>r=>{this.removeComponent(i,r)},this._createAddTagHandler=i=>r=>{this.addTag(i,r)},this._createRemoveTagHandler=i=>r=>{this.removeTag(i,r)}}createQuery(t){const i=Tr.createId(t);if(this._queries.has(i))return this._queries.get(i);const r=new Tr(t);this._queries.set(r.id,r);for(const a of t){const h=this._componentToQueriesIndex.get(a);h?h.push(r):this._componentToQueriesIndex.set(a,[r])}for(const a of this._world.entities)this.addEntity(a);return r}createTagQuery(t){const i=Pr.createId(t);if(this._tagQueries.has(i))return this._tagQueries.get(i);const r=new Pr(t);this._tagQueries.set(r.id,r);for(const a of t){const h=this._tagToQueriesIndex.get(a);h?h.push(r):this._tagToQueriesIndex.set(a,[r])}for(const a of this._world.entities)this.addEntity(a);return r}addEntity(t){const i=this._addComponentHandlers.get(t),r=this._removeComponentHandlers.get(t),a=i??this._createAddComponentHandler(t),h=r??this._createRemoveComponentHandler(t);this._addComponentHandlers.set(t,a),this._removeComponentHandlers.set(t,h);const d=this._addTagHandlers.get(t),p=this._removeTagHandlers.get(t),m=d??this._createAddTagHandler(t),y=p??this._createRemoveTagHandler(t);this._addTagHandlers.set(t,m),this._removeTagHandlers.set(t,y);for(const w of this._queries.values())w.checkAndAdd(t);for(const w of this._tagQueries.values())w.checkAndAdd(t);t.componentAdded$.subscribe(a),t.componentRemoved$.subscribe(h),t.tagAdded$.subscribe(m),t.tagRemoved$.subscribe(y)}removeEntity(t){const i=this._addComponentHandlers.get(t),r=this._removeComponentHandlers.get(t);for(const d of this._queries.values())d.removeEntity(t);i&&t.componentAdded$.unsubscribe(i),r&&t.componentRemoved$.unsubscribe(r);const a=this._addTagHandlers.get(t),h=this._removeTagHandlers.get(t);for(const d of this._tagQueries.values())d.removeEntity(t);a&&t.tagAdded$.unsubscribe(a),h&&t.tagRemoved$.unsubscribe(h)}addComponent(t,i){var r;const a=(r=this._componentToQueriesIndex.get(i.constructor))!==null&&r!==void 0?r:[];for(const h of a)h.checkAndAdd(t)}removeComponent(t,i){var r;const a=(r=this._componentToQueriesIndex.get(i.constructor))!==null&&r!==void 0?r:[];for(const h of a)h.removeEntity(t)}addTag(t,i){var r;const a=(r=this._tagToQueriesIndex.get(i))!==null&&r!==void 0?r:[];for(const h of a)h.checkAndAdd(t)}removeTag(t,i){var r;const a=(r=this._tagToQueriesIndex.get(i))!==null&&r!==void 0?r:[];for(const h of a)h.removeEntity(t)}}function Af(u){var t,i;return!!(u!=null&&u.prototype)&&!!(!((i=(t=u==null?void 0:u.prototype)===null||t===void 0?void 0:t.constructor)===null||i===void 0)&&i.name)}class Tf{constructor(t){this._world=t,this.systems=[],this.initialized=!1}get(t){return this.systems.find(i=>i instanceof t)}addSystem(t){let i;t instanceof li?i=t:i=new t(this._world),this.systems.push(i),this.systems.sort((r,a)=>r.priority-a.priority),this.initialized&&i.initialize&&i.initialize(this._world,this._world.scene)}removeSystem(t){lt(t,this.systems)}initialize(){if(!this.initialized){this.initialized=!0;for(const t of this.systems)t.initialize&&t.initialize(this._world,this._world.scene)}}updateSystems(t,i,r){const a=this.systems.filter(h=>h.systemType===t);for(const h of a)h.preupdate&&h.preupdate(i,r);for(const h of a)h.update(r);for(const h of a)h.postupdate&&h.postupdate(i,r)}clear(){for(let t=this.systems.length-1;t>=0;t--)this.removeSystem(this.systems[t])}}class Pf{constructor(t){this.scene=t,this.queryManager=new Ef(this),this.entityManager=new Sf(this),this.systemManager=new Tf(this)}query(t){return this.queryManager.createQuery(t)}queryTags(t){return this.queryManager.createTagQuery(t)}update(t,i){t===Ne.Update&&this.entityManager.updateEntities(this.scene,i),this.systemManager.updateSystems(t,this.scene,i),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}add(t){t instanceof ge&&this.entityManager.addEntity(t),(t instanceof li||Af(t))&&this.systemManager.addSystem(t)}get(t){return this.systemManager.get(t)}remove(t,i=!0){t instanceof ge&&this.entityManager.removeEntity(t,i),t instanceof li&&this.systemManager.removeSystem(t)}get entities(){return this.entityManager.entities}clearEntities(){this.entityManager.clear()}clearSystems(){this.systemManager.clear()}}class Pe{static integrate(t,i,r,a){const h=a/1e3;i.vel.addEqual(r.scale(h,Pe._ACC)),t.pos.add(i.vel.scale(h,Pe._VEL),Pe._POS).addEqual(r.scale(.5*h*h,Pe._VEL_ACC)),i.angularVelocity+=i.torque*(1/i.inertia)*h;const d=t.rotation+i.angularVelocity*h;t.scale.add(i.scaleFactor.scale(h,this._SCALE_FACTOR),Pe._SCALE),t.get().setTransform(Pe._POS,d,Pe._SCALE)}}Pe._POS=new E(0,0),Pe._SCALE=new E(1,1),Pe._ACC=new E(0,0),Pe._VEL=new E(0,0),Pe._VEL_ACC=new E(0,0),Pe._SCALE_FACTOR=new E(0,0);class Rf extends li{constructor(t,i){super(),this.world=t,this.physics=i,this.systemType=Ne.Update,this.priority=ki.Higher,this._physicsConfigDirty=!1,i.$configUpdate.subscribe(()=>this._physicsConfigDirty=!0),this.query=this.world.query([it,Mt])}update(t){let i,r;const a=this.query.entities;for(let h=0;h<a.length;h++){i=a[h].get(it),r=a[h].get(Mt);const d=a[h].get(ht);if(this._physicsConfigDirty&&d&&d.updatePhysicsConfig(this.physics.config.bodies),d!=null&&d.sleeping)continue;const p=r.acc.clone();(d==null?void 0:d.collisionType)===ut.Active&&(d!=null&&d.useGravity)&&p.addEqual(this.physics.config.gravity),d==null||d.captureOldTransform(),Pe.integrate(i,r,p,t)}this._physicsConfigDirty=!1}}class Ih{constructor(t){this.config=t,this.directionMap=new Map,this.distanceMap=new Map}solve(t){this.preSolve(t),t=t.filter(r=>!r.isCanceled());let i;switch(this.config.contactSolveBias){case js.HorizontalFirst:{i=Yd;break}case js.VerticalFirst:{i=$d;break}default:i=Qd}t.sort((r,a)=>{const h=this.directionMap.get(r.id),d=this.directionMap.get(a.id),p=this.distanceMap.get(r.id),m=this.distanceMap.get(a.id);return i[h]-i[d]||p-m});for(const r of t)this.solvePosition(r),this.solveVelocity(r);return this.postSolve(t),t}preSolve(t){for(const r of t){if(Math.abs(r.mtv.x)<1e-4&&Math.abs(r.mtv.y)<1e-4){r.cancel();continue}const a=vt.fromDirection(r.mtv),h=r.mtv.negate(),d=r.colliderA.worldPos.squareDistance(r.colliderB.worldPos);this.distanceMap.set(r.id,d),this.directionMap.set(r.id,a===vt.Left||a===vt.Right?"horizontal":"vertical"),r.colliderA.events.emit("precollision",new Ls(r.colliderA,r.colliderB,a,h,r)),r.colliderB.events.emit("precollision",new Ls(r.colliderB,r.colliderA,vt.getOpposite(a),h.negate(),r))}}postSolve(t){var i,r;for(const a of t){if(a.isCanceled())continue;const h=a.colliderA,d=a.colliderB,p=(i=h.owner)===null||i===void 0?void 0:i.get(ht),m=(r=d.owner)===null||r===void 0?void 0:r.get(ht);if(p&&m&&(p.collisionType===ut.Passive||m.collisionType===ut.Passive))continue;const y=vt.fromDirection(a.mtv),w=a.mtv.negate();a.colliderA.events.emit("postcollision",new Os(a.colliderA,a.colliderB,y,w,a)),a.colliderB.events.emit("postcollision",new Os(a.colliderB,a.colliderA,vt.getOpposite(y),w.negate(),a))}}solvePosition(t){var i,r;if(!t.colliderA.bounds.overlaps(t.colliderB.bounds,1e-4)){t.cancel();return}if(Math.abs(t.mtv.x)<1e-4&&Math.abs(t.mtv.y)<1e-4){t.cancel();return}let h=t.mtv;const d=t.colliderA,p=t.colliderB,m=(i=d.owner)===null||i===void 0?void 0:i.get(ht),y=(r=p.owner)===null||r===void 0?void 0:r.get(ht);if(m&&y){if(m.collisionType===ut.Passive||y.collisionType===ut.Passive)return;m.collisionType===ut.Active&&y.collisionType===ut.Active&&(h=h.scale(.5)),m.collisionType===ut.Active&&(m.globalPos.x-=h.x,m.globalPos.y-=h.y,d.update(m.transform.get())),y.collisionType===ut.Active&&(y.globalPos.x+=h.x,y.globalPos.y+=h.y,p.update(y.transform.get()))}}solveVelocity(t){var i,r;if(t.isCanceled())return;const a=t.colliderA,h=t.colliderB,d=(i=a.owner)===null||i===void 0?void 0:i.get(ht),p=(r=h.owner)===null||r===void 0?void 0:r.get(ht);if(d&&p){if(d.collisionType===ut.Passive||p.collisionType===ut.Passive)return;const m=t.normal,y=m.negate();if(d.collisionType===ut.Active&&d.vel.normalize().dot(y)<0){const w=m.scale(m.dot(d.vel.negate()));d.vel=d.vel.add(w)}if(p.collisionType===ut.Active&&p.vel.normalize().dot(m)<0){const w=y.scale(y.dot(p.vel.negate()));p.vel=p.vel.add(w)}}}}class If{constructor(t,i,r){this.point=t,this.local=i,this.contact=r,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new E(0,0),this.bToContact=new E(0,0),this.originalVelocityAndRestitution=0,this.update()}update(){var t,i;const r=(t=this.contact.colliderA.owner)===null||t===void 0?void 0:t.get(ht),a=(i=this.contact.colliderB.owner)===null||i===void 0?void 0:i.get(ht);if(r&&a){const h=this.contact.normal,d=this.contact.tangent;this.aToContact=this.point.sub(r.globalPos),this.bToContact=this.point.sub(a.globalPos);const p=this.aToContact.cross(h),m=this.bToContact.cross(h);this.normalMass=r.inverseMass+a.inverseMass+r.inverseInertia*p*p+a.inverseInertia*m*m;const y=this.aToContact.cross(d),w=this.bToContact.cross(d);this.tangentMass=r.inverseMass+a.inverseMass+r.inverseInertia*y*y+a.inverseInertia*w*w}return this}getRelativeVelocity(){var t,i;const r=(t=this.contact.colliderA.owner)===null||t===void 0?void 0:t.get(ht),a=(i=this.contact.colliderB.owner)===null||i===void 0?void 0:i.get(ht);if(r&&a){const h=r.vel.add(E.cross(r.angularVelocity,this.aToContact));return a.vel.add(E.cross(a.angularVelocity,this.bToContact)).sub(h)}return E.Zero}}class Dh{constructor(t){this.config=t,this.lastFrameContacts=new Map,this.idToContactConstraint=new Map}getContactConstraints(t){var i;return(i=this.idToContactConstraint.get(t))!==null&&i!==void 0?i:[]}solve(t){return this.preSolve(t),t=t.filter(i=>!i.isCanceled()),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}preSolve(t){var i,r,a;for(const p of t){if(Math.abs(p.mtv.x)<1e-4&&Math.abs(p.mtv.y)<1e-4){p.cancel();continue}const m=vt.fromDirection(p.mtv);p.colliderA.events.emit("precollision",new Ls(p.colliderA,p.colliderB,m,p.mtv,p)),p.colliderA.events.emit("beforecollisionresolve",new Wo(p.colliderA,p.colliderB,m,p.mtv,p)),p.colliderB.events.emit("precollision",new Ls(p.colliderB,p.colliderA,vt.getOpposite(m),p.mtv.negate(),p)),p.colliderB.events.emit("beforecollisionresolve",new Wo(p.colliderB,p.colliderA,vt.getOpposite(m),p.mtv.negate(),p)),p.matchAwake()}const d=Array.from(this.idToContactConstraint.keys());for(const p of t){const m=d.indexOf(p.id);m>-1&&d.splice(m,1);const y=(i=this.idToContactConstraint.get(p.id))!==null&&i!==void 0?i:[];let w=0;const b=p.colliderA.owner.get(ht),R=p.colliderB.owner.get(ht);if(b&&R)for(const k of p.points){const M=p.normal,z=p.tangent,X=k.sub(b.globalPos),N=k.sub(R.globalPos),U=X.cross(M),$=N.cross(M),W=b.inverseMass+R.inverseMass+b.inverseInertia*U*U+R.inverseInertia*$*$,tt=X.cross(z),pt=N.cross(z),Q=b.inverseMass+R.inverseMass+b.inverseInertia*tt*tt+R.inverseInertia*pt*pt;y[w]&&((a=(r=y[w])===null||r===void 0?void 0:r.point)===null||a===void 0?void 0:a.squareDistance(k))<4?(y[w].point=k,y[w].local=p.localPoints[w]):y[w]=new If(k,p.localPoints[w],p),y[w].aToContact=X,y[w].bToContact=N,y[w].normalMass=1/W,y[w].tangentMass=1/Q;const gt=b.bounciness>R.bounciness?b.bounciness:R.bounciness,Lt=p.normal.dot(y[w].getRelativeVelocity());y[w].originalVelocityAndRestitution=0,Lt<-.1&&(y[w].originalVelocityAndRestitution=-gt*Lt),w++}this.idToContactConstraint.set(p.id,y)}for(const p of d)this.idToContactConstraint.delete(p);if(this.config.warmStart)this.warmStart(t);else for(const p of t){const m=this.getContactConstraints(p.id);for(const y of m)y.normalImpulse=0,y.tangentImpulse=0}}postSolve(t){for(const i of t){const r=i.colliderA.owner.get(ht),a=i.colliderB.owner.get(ht);if(r&&a){if(r.collisionType===ut.Passive||a.collisionType===ut.Passive)continue;r.updateMotion(),a.updateMotion()}const h=vt.fromDirection(i.mtv);i.colliderA.events.emit("postcollision",new Os(i.colliderA,i.colliderB,h,i.mtv,i)),i.colliderA.events.emit("aftercollisionresolve",new Vo(i.colliderA,i.colliderB,h,i.mtv,i)),i.colliderB.events.emit("postcollision",new Os(i.colliderB,i.colliderA,vt.getOpposite(h),i.mtv.negate(),i)),i.colliderB.events.emit("aftercollisionresolve",new Vo(i.colliderB,i.colliderA,vt.getOpposite(h),i.mtv.negate(),i))}this.lastFrameContacts.clear();for(const i of t)this.lastFrameContacts.set(i.id,i)}warmStart(t){var i,r,a;for(const h of t){const d=(i=h.colliderA.owner)===null||i===void 0?void 0:i.get(ht),p=(r=h.colliderB.owner)===null||r===void 0?void 0:r.get(ht);if(d&&p){const m=(a=this.idToContactConstraint.get(h.id))!==null&&a!==void 0?a:[];for(const y of m)if(this.config.warmStart){const w=h.normal.scale(y.normalImpulse),b=h.tangent.scale(y.tangentImpulse),R=w.add(b);d.applyImpulse(y.point,R.negate()),p.applyImpulse(y.point,R)}else y.normalImpulse=0,y.tangentImpulse=0}}}solvePosition(t){var i,r,a;for(let h=0;h<this.config.positionIterations;h++)for(const d of t){const p=(i=d.colliderA.owner)===null||i===void 0?void 0:i.get(ht),m=(r=d.colliderB.owner)===null||r===void 0?void 0:r.get(ht);if(p&&m){if(p.collisionType===ut.Passive||m.collisionType===ut.Passive)continue;const y=(a=this.idToContactConstraint.get(d.id))!==null&&a!==void 0?a:[];for(const w of y){const b=d.normal,R=_i.FindContactSeparation(d,w.local),k=this.config.steeringFactor,M=-5,z=this.config.slop,X=L(k*(R+z),M,0),N=b.scale(-X*w.normalMass);if(p.collisionType===ut.Active){const U=N.negate().scale(p.inverseMass);p.limitDegreeOfFreedom.includes(Te.X)&&(U.x=0),p.limitDegreeOfFreedom.includes(Te.Y)&&(U.y=0),p.globalPos=p.globalPos.add(U),p.limitDegreeOfFreedom.includes(Te.Rotation)||(p.rotation-=w.aToContact.cross(N)*p.inverseInertia)}if(m.collisionType===ut.Active){const U=N.scale(m.inverseMass);m.limitDegreeOfFreedom.includes(Te.X)&&(U.x=0),m.limitDegreeOfFreedom.includes(Te.Y)&&(U.y=0),m.globalPos=m.globalPos.add(U),m.limitDegreeOfFreedom.includes(Te.Rotation)||(m.rotation+=w.bToContact.cross(N)*m.inverseInertia)}}}}}solveVelocity(t){var i,r,a;for(let h=0;h<this.config.velocityIterations;h++)for(const d of t){const p=(i=d.colliderA.owner)===null||i===void 0?void 0:i.get(ht),m=(r=d.colliderB.owner)===null||r===void 0?void 0:r.get(ht);if(p&&m){if(p.collisionType===ut.Passive||m.collisionType===ut.Passive)continue;const y=Math.min(p.friction,m.friction),w=(a=this.idToContactConstraint.get(d.id))!==null&&a!==void 0?a:[];for(const b of w){let M=-b.getRelativeVelocity().dot(d.tangent)*b.tangentMass;const z=y*b.normalImpulse,X=L(b.tangentImpulse+M,-z,z);M=X-b.tangentImpulse,b.tangentImpulse=X;const N=d.tangent.scale(M);p.applyImpulse(b.point,N.negate()),m.applyImpulse(b.point,N)}for(const b of w){const k=b.getRelativeVelocity().dot(d.normal);let M=-b.normalMass*(k-b.originalVelocityAndRestitution);const z=Math.max(b.normalImpulse+M,0);M=z-b.normalImpulse,b.normalImpulse=z;const X=d.normal.scale(M);p.applyImpulse(b.point,X.negate()),m.applyImpulse(b.point,X)}}}}}class kh extends li{get _processor(){return this._physics.collisionProcessor}constructor(t,i){super(),this._physics=i,this.systemType=Ne.Update,this.priority=ki.Higher,this._configDirty=!1,this._lastFrameContacts=new Map,this._currentFrameContacts=new Map,this._arcadeSolver=new Ih(i.config.arcade),this._realisticSolver=new Dh(i.config.realistic),this._physics.$configUpdate.subscribe(()=>this._configDirty=!0),this._trackCollider=r=>this._processor.track(r),this._untrackCollider=r=>this._processor.untrack(r),this.query=t.query([it,Mt,Wt]),this.query.entityAdded$.subscribe(r=>{const a=r.get(Wt);a.$colliderAdded.subscribe(this._trackCollider),a.$colliderRemoved.subscribe(this._untrackCollider);const h=a.get();h&&this._processor.track(h)}),this.query.entityRemoved$.subscribe(r=>{const a=r.get(Wt),h=a.get();a&&h&&this._processor.untrack(h)})}initialize(t,i){this._engine=i.engine}update(t){var i,r,a,h;if(!this._physics.config.enabled)return;let d=[];for(const w of this.query.entities){const b=w.get(Wt),R=b==null?void 0:b.get();if(b&&(!((i=b.owner)===null||i===void 0)&&i.active)&&R)if(b.update(),R instanceof de){const k=R.getColliders();R.compositeStrategy||(R.compositeStrategy=this._physics.config.colliders.compositeStrategy),d=d.concat(k)}else d.push(R)}this._processor.update(d);const p=this._processor.broadphase(d,t);this._currentFrameContacts.clear();let m=this._processor.narrowphase(p,(h=(a=(r=this._engine)===null||r===void 0?void 0:r.debug)===null||a===void 0?void 0:a.stats)===null||h===void 0?void 0:h.currFrame);m=this.getSolver().solve(m);for(const w of m){if(w.isCanceled())continue;const b=w.id.indexOf("|");if(b>0){const R=w.id.substring(b+1);this._currentFrameContacts.set(R,w)}else this._currentFrameContacts.set(w.id,w)}this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts);for(const w of this.query.entities){const b=w.get(Wt);b&&b.processColliderRemoval()}}getSolver(){return this._configDirty&&(this._configDirty=!1,this._arcadeSolver=new Ih(this._physics.config.arcade),this._realisticSolver=new Dh(this._physics.config.realistic)),this._physics.config.solver===ls.Realistic?this._realisticSolver:this._arcadeSolver}debug(t){this._processor.debug(t)}runContactStartEnd(){for(const[t,i]of this._currentFrameContacts)if(!this._lastFrameContacts.has(t)){const r=i.colliderA,a=i.colliderB,h=vt.fromDirection(i.mtv),d=vt.getOpposite(h);r.events.emit("collisionstart",new yr(r,a,h,i)),r.events.emit("contactstart",new Ho(r,a,h,i)),a.events.emit("collisionstart",new yr(a,r,d,i)),a.events.emit("contactstart",new Ho(a,r,d,i))}for(const[t,i]of this._lastFrameContacts)if(!this._currentFrameContacts.has(t)){const r=i.colliderA,a=i.colliderB,h=vt.fromDirection(i.mtv),d=vt.getOpposite(h);r.events.emit("collisionend",new wr(r,a,h,i)),r.events.emit("contactend",new jo(r,a,h,i)),a.events.emit("collisionend",new wr(a,r,d,i)),a.events.emit("contactend",new jo(a,r,d,i))}}}function Df(u){return class extends u{assign(t){for(const i in t)typeof this[i]!="function"&&(this[i]=t[i])}constructor(...t){super(...t),t.filter(function(r){return r!==void 0}).length===1&&t[0]&&typeof t[0]=="object"&&!(t[0]instanceof Array)&&this.assign(t[0])}}}var An;(function(u){u[u.Circle=0]="Circle",u[u.Rectangle=1]="Rectangle"})(An||(An={}));class iy extends ge{constructor(t,i,r,a,h,d,p,m,y,w,b){super(),this.position=new E(0,0),this.velocity=new E(0,0),this.acceleration=new E(0,0),this.particleRotationalVelocity=0,this.currentRotation=0,this.focus=null,this.focusAccel=0,this.opacity=1,this.beginColor=G.White,this.endColor=G.White,this.life=300,this.fadeFlag=!1,this._rRate=1,this._gRate=1,this._bRate=1,this._aRate=0,this._currentColor=G.White,this.emitter=null,this.particleSize=5,this.particleSprite=null,this.sizeRate=0,this.elapsedMultiplier=0,this.visible=!0,this.isOffscreen=!1;let R=t;if(R&&!(t instanceof kf)){const k=t;R=k.emitter,i=k.life,r=k.opacity,h=k.endColor,a=k.beginColor,d=k.position,p=k.velocity,m=k.acceleration,y=k.startSize,w=k.endSize,b=k.particleSprite}if(this.emitter=R,this.life=i||this.life,this.opacity=r||this.opacity,this.endColor=h||this.endColor.clone(),this.beginColor=a||this.beginColor.clone(),this._currentColor=this.beginColor.clone(),this.particleSprite=b,this.emitter.particleTransform===Tn.Global){const k=this.emitter.transform.globalPos;this.position=(d||this.position).add(k),this.velocity=(p||this.velocity).rotate(this.emitter.transform.globalRotation)}else this.velocity=p||this.velocity,this.position=d||this.position;this.acceleration=m||this.acceleration,this._rRate=(this.endColor.r-this.beginColor.r)/this.life,this._gRate=(this.endColor.g-this.beginColor.g)/this.life,this._bRate=(this.endColor.b-this.beginColor.b)/this.life,this._aRate=this.opacity/this.life,this.startSize=y||0,this.endSize=w||0,this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize),this.addComponent(this.transform=new it),this.addComponent(this.graphics=new ne),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=B(1,1),this.transform.z=this.emitter.z,this.particleSprite?(this.graphics.opacity=this.opacity,this.graphics.use(this.particleSprite)):(this.graphics.localBounds=et.fromDimension(this.particleSize,this.particleSize,E.Half),this.graphics.onPostDraw=k=>{k.save(),this.graphics.opacity=this.opacity;const M=this._currentColor.clone();M.a=1,k.debug.drawPoint(B(0,0),{color:M,size:this.particleSize}),k.restore()})}kill(){this.emitter.removeParticle(this)}update(t,i){if(this.life=this.life-i,this.elapsedMultiplier=this.elapsedMultiplier+i,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=L(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=L(this.sizeRate*i+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=L(this._currentColor.r+this._rRate*i,0,255),this._currentColor.g=L(this._currentColor.g+this._gRate*i,0,255),this._currentColor.b=L(this._currentColor.b+this._bRate*i,0,255),this._currentColor.a=L(this.opacity,1e-4,1),this.focus){const r=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(i/1e3);this.velocity=this.velocity.add(r)}else this.velocity=this.velocity.add(this.acceleration.scale(i/1e3));this.position=this.position.add(this.velocity.scale(i/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*i/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=B(1,1),this.graphics.opacity=this.opacity}}class ra extends Df(iy){constructor(t,i,r,a,h,d,p,m,y,w,b){super(t,i,r,a,h,d,p,m,y,w,b)}}var Tn;(function(u){u.Global="global",u.Local="local"})(Tn||(Tn={}));class kf extends Oe{get opacity(){return this.graphics.opacity}set opacity(t){this.graphics.opacity=t}get particleSprite(){return this._sprite}set particleSprite(t){t&&(this._sprite=t)}constructor(t){var i,r;super({width:(i=t.width)!==null&&i!==void 0?i:0,height:(r=t.height)!==null&&r!==void 0?r:0}),this._particlesToEmit=0,this.numParticles=0,this.isEmitting=!0,this.particles=[],this.deadParticles=[],this.minVel=0,this.maxVel=0,this.acceleration=new E(0,0),this.minAngle=0,this.maxAngle=0,this.emitRate=1,this.particleLife=2e3,this.fadeFlag=!1,this.focus=null,this.focusAccel=null,this.startSize=null,this.endSize=null,this.minSize=5,this.maxSize=5,this.beginColor=G.White,this.endColor=G.White,this._sprite=null,this.emitterType=An.Rectangle,this.radius=0,this.particleRotationalVelocity=0,this.randomRotation=!1,this.particleTransform=Tn.Global;const{x:a,y:h,z:d,pos:p,isEmitting:m,minVel:y,maxVel:w,acceleration:b,minAngle:R,maxAngle:k,emitRate:M,particleLife:z,opacity:X,fadeFlag:N,focus:U,focusAccel:$,startSize:W,endSize:tt,minSize:pt,maxSize:Q,beginColor:gt,endColor:Lt,particleSprite:he,emitterType:Ue,radius:ze,particleRotationalVelocity:He,particleTransform:Ie,randomRotation:me,random:_e}={...t};this.pos=p??B(a??0,h??0),this.z=d??0,this.isEmitting=m??this.isEmitting,this.minVel=y??this.minVel,this.maxVel=w??this.maxVel,this.acceleration=b??this.acceleration,this.minAngle=R??this.minAngle,this.maxAngle=k??this.maxAngle,this.emitRate=M??this.emitRate,this.particleLife=z??this.particleLife,this.opacity=X??this.opacity,this.fadeFlag=N??this.fadeFlag,this.focus=U??this.focus,this.focusAccel=$??this.focusAccel,this.startSize=W??this.startSize,this.endSize=tt??this.endSize,this.minSize=pt??this.minSize,this.maxSize=Q??this.maxSize,this.beginColor=gt??this.beginColor,this.endColor=Lt??this.endColor,this.particleSprite=he??this.particleSprite,this.emitterType=Ue??this.emitterType,this.radius=ze??this.radius,this.particleRotationalVelocity=He??this.particleRotationalVelocity,this.randomRotation=me??this.randomRotation,this.particleTransform=Ie??this.particleTransform,this.body.collisionType=ut.PreventCollision,this.random=_e??new T}removeParticle(t){this.deadParticles.push(t)}emitParticles(t){var i;for(let r=0;r<t;r++){const a=this._createParticle();this.particles.push(a),!((i=this===null||this===void 0?void 0:this.scene)===null||i===void 0)&&i.world&&(this.particleTransform===Tn.Global?this.scene.world.add(a):this.addChild(a))}}clearParticles(){this.particles.length=0}_createParticle(){let t=0,i=0;const r=j(this.minAngle,this.maxAngle,this.random),a=j(this.minVel,this.maxVel,this.random),h=this.startSize||j(this.minSize,this.maxSize,this.random),d=a*Math.cos(r),p=a*Math.sin(r);if(this.emitterType===An.Rectangle)t=j(0,this.width,this.random),i=j(0,this.height,this.random);else if(this.emitterType===An.Circle){const y=j(0,this.radius,this.random);t=y*Math.cos(r),i=y*Math.sin(r)}const m=new ra(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new E(t,i),new E(d,p),this.acceleration,this.startSize,this.endSize,this.particleSprite);return m.fadeFlag=this.fadeFlag,m.particleSize=h,m.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(m.currentRotation=j(0,Math.PI*2,this.random)),this.focus&&(m.focus=this.focus.add(new E(this.pos.x,this.pos.y)),m.focusAccel=this.focusAccel),m}update(t,i){var r;super.update(t,i),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(i/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(let a=0;a<this.deadParticles.length;a++)lt(this.deadParticles[a],this.particles),!((r=this===null||this===void 0?void 0:this.scene)===null||r===void 0)&&r.world&&this.scene.world.remove(this.deadParticles[a],!1);this.deadParticles.length=0}}function sy(u,t,i,r){if(u.parent!==t.parent){const w=u.clone(),b=u.globalPos.clone(),R=u.globalScale.clone(),k=u.globalRotation;w.parent=t.parent,w.globalPos=b,w.globalScale=R,w.globalRotation=k,u=w}let a=t.pos,h=t.scale,d=t.rotation;a=t.pos.scale(i).add(u.pos.scale(1-i)),h=t.scale.scale(i).add(u.scale.scale(1-i));const p=(1-i)*Math.cos(u.rotation)+i*Math.cos(t.rotation),m=(1-i)*Math.sin(u.rotation)+i*Math.sin(t.rotation);d=Math.atan2(m,p);const y=r??new zs;return y.setTransform(a,d,h),y}class Ff extends li{get sortedTransforms(){return this._sortedTransforms}constructor(t){super(),this.world=t,this.systemType=Ne.Draw,this.priority=ki.Average,this._token=0,this._sortedTransforms=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0},this._targetInterpolationTransform=new zs,this.query=this.world.query([it,ne]),this.query.entityAdded$.subscribe(i=>{const r=i.get(it);this._sortedTransforms.push(r),r.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}),this.query.entityRemoved$.subscribe(i=>{const r=i.get(it);r.zIndexChanged$.unsubscribe(this._zIndexUpdate);const a=this._sortedTransforms.indexOf(r);a>-1&&this._sortedTransforms.splice(a,1)})}initialize(t,i){this._camera=i.camera,this._engine=i.engine}preupdate(){this._graphicsContext=this._engine.graphicsContext,this._zHasChanged&&(this._sortedTransforms.sort((t,i)=>t.z-i.z),this._zHasChanged=!1)}update(t){this._token++;let i;Ct.checkAndClearCache(),this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext);for(const r of this._sortedTransforms){const a=r.owner;if(a.hasTag("ex.offscreen")||(i=a.get(ne),!i.visible))continue;i.onPreTransformDraw&&i.onPreTransformDraw(this._graphicsContext,t),a.events.emit("pretransformdraw",new Zl(this._graphicsContext,t,a)),r.coordPlane===ie.Screen&&this._graphicsContext.restore(),this._graphicsContext.save(),r.coordPlane===ie.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),i.update(t,this._token);const h=a.get(ia);if(h){const p=E.One.sub(h.parallaxFactor),m=this._camera.drawPos.scale(p);this._graphicsContext.translate(m.x,m.y)}this._applyTransform(a),i.material&&(this._graphicsContext.material=i.material),i.onPreDraw&&i.onPreDraw(this._graphicsContext,t),a.events.emit("predraw",new wn(this._graphicsContext,t,a));const d=a instanceof ra?a.opacity:1;this._graphicsContext.opacity*=i.opacity*d,this._drawGraphicsComponent(i,r),i.onPostDraw&&i.onPostDraw(this._graphicsContext,t),a.events.emit("postdraw",new xn(this._graphicsContext,t,a)),this._graphicsContext.restore(),r.coordPlane===ie.Screen&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext)),i.onPostTransformDraw&&i.onPostTransformDraw(this._graphicsContext,t),a.events.emit("posttransformdraw",new Kl(this._graphicsContext,t,a))}this._graphicsContext.restore()}_drawGraphicsComponent(t,i){var r,a;if(t.visible){const h=t.flipHorizontal,d=t.flipVertical,p=t.current,m=(r=t.currentOptions)!==null&&r!==void 0?r:{};if(p){let y=t.anchor,w=t.offset,b=1,R=1;m!=null&&m.anchor&&(y=m.anchor),m!=null&&m.offset&&(w=m.offset);const k=i.globalScale;b*=p.scale.x*k.x,R*=p.scale.y*k.y;const M=-p.width*y.x+w.x*b,z=-p.height*y.y+w.y*R,X=p.flipHorizontal,N=p.flipVertical;if((h||d)&&(p.flipHorizontal=h?!X:X,p.flipVertical=d?!N:N),p==null||p.draw(this._graphicsContext,M,z),(h||d)&&(p.flipHorizontal=X,p.flipVertical=N),!((a=this._engine)===null||a===void 0)&&a.isDebug&&this._engine.debug.graphics.showBounds){const U=B(M,z);if(p instanceof Cn)for(const $ of p.members){let W,tt=E.Zero;$ instanceof zt?W=$:(W=$.graphic,tt=$.offset),p.useAnchor?W==null||W.localBounds.translate(U.add(tt)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor):W==null||W.localBounds.translate(tt).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}else p==null||p.localBounds.translate(U).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}}_applyTransform(t){const i=t.getAncestors();for(const r of i){const a=r==null?void 0:r.get(it),h=r==null?void 0:r.get(ht);let d=a.get();if(h&&this._engine.fixedUpdateFps&&h.__oldTransformCaptured&&h.enableFixedUpdateInterpolate){const p=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps);d=sy(h.oldTransform,a.get(),p,this._targetInterpolationTransform)}a&&(this._graphicsContext.z=a.z,this._graphicsContext.translate(d.pos.x,d.pos.y),this._graphicsContext.scale(d.scale.x,d.scale.y),this._graphicsContext.rotate(d.rotation))}}}class Bf extends li{constructor(t){super(),this.world=t,this.systemType=Ne.Draw,this.priority=ki.Lowest,this.query=this.world.query([it])}initialize(t,i){this._graphicsContext=i.engine.graphicsContext,this._camera=i.camera,this._engine=i.engine,this._collisionSystem=t.systemManager.get(kh)}update(){var t;if(!this._engine.isDebug)return;const i=this._engine.debug.filter;let r,a;const h=this._engine.debug.entity;let d;const p=this._engine.debug.transform;let m;const y=this._engine.debug.motion;let w;const b=this._engine.debug.collider,R=this._engine.debug.physics;let k;const M=this._engine.debug.graphics;let z,X;const N=this._engine.debug.body,U=this._engine.debug.camera;for(const $ of this.query.entities){if($.hasTag("offscreen")||$ instanceof ra||i.useFilter&&(!(i.ids.length===0||i.ids.includes($.id))||!(i.nameQuery===""||$.name.includes(i.nameQuery))))continue;let W=E.Zero;const tt=B(0,16);if(r=$.id,a=$.name,d=$.get(it),this._pushCameraTransform(d),this._graphicsContext.save(),d.coordPlane===ie.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),this._graphicsContext.z=p.debugZIndex,this._applyTransform($),d&&((p.showAll||p.showPosition)&&this._graphicsContext.debug.drawPoint(E.Zero,{size:4,color:p.positionColor}),(p.showAll||p.showPositionLabel)&&(this._graphicsContext.debug.drawText(`pos${d.pos.toString(2)}`,W),W=W.add(tt)),(p.showAll||p.showZIndex)&&(this._graphicsContext.debug.drawText(`z(${d.z.toFixed(1)})`,W),W=W.add(tt)),(h.showAll||h.showId)&&(this._graphicsContext.debug.drawText(`id(${r}) ${$.parent?"child of id("+((t=$.parent)===null||t===void 0?void 0:t.id)+")":""}`,W),W=W.add(tt)),(h.showAll||h.showName)&&(this._graphicsContext.debug.drawText(`name(${a})`,W),W=W.add(tt)),(p.showAll||p.showRotation)&&(this._graphicsContext.drawLine(E.Zero,E.fromAngle(d.rotation).scale(50).add(E.Zero),p.rotationColor,2),this._graphicsContext.debug.drawText(`rot deg(${A(d.rotation).toFixed(2)})`,W),W=W.add(tt)),(p.showAll||p.showScale)&&this._graphicsContext.drawLine(E.Zero,d.scale.add(E.Zero),p.scaleColor,2)),k=$.get(ne),k&&(M.showAll||M.showBounds)&&k.localBounds.draw(this._graphicsContext,M.boundsColor),z=$.get(sa),z&&(z.useTransform||this._graphicsContext.restore(),z.draw(this._graphicsContext,this._engine.debug),z.useTransform||(this._graphicsContext.save(),this._applyTransform($))),X=$.get(ht),X&&((N.showAll||N.showCollisionGroup)&&(this._graphicsContext.debug.drawText(`collision group(${X.group.name})`,W),W=W.add(tt)),(N.showAll||N.showCollisionType)&&(this._graphicsContext.debug.drawText(`collision type(${X.collisionType})`,W),W=W.add(tt)),(N.showAll||N.showMass)&&(this._graphicsContext.debug.drawText(`mass(${X.mass})`,W),W=W.add(tt)),(N.showAll||N.showMotion)&&(this._graphicsContext.debug.drawText(`motion(${X.sleepMotion})`,W),W=W.add(tt)),(N.showAll||N.showSleeping)&&(this._graphicsContext.debug.drawText(`sleeping(${X.canSleep?X.sleeping:"cant sleep"})`,W),W=W.add(tt))),this._graphicsContext.restore(),this._graphicsContext.save(),d.coordPlane===ie.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),this._graphicsContext.z=p.debugZIndex,m=$.get(Mt),m&&((y.showAll||y.showVelocity)&&(this._graphicsContext.debug.drawText(`vel${m.vel.toString(2)}`,W.add(d.globalPos)),this._graphicsContext.drawLine(d.globalPos,d.globalPos.add(m.vel),y.velocityColor,2),W=W.add(tt)),(y.showAll||y.showAcceleration)&&this._graphicsContext.drawLine(d.globalPos,d.globalPos.add(m.acc),y.accelerationColor,2)),w=$.get(Wt),w){const pt=w.get();if((b.showAll||b.showGeometry)&&pt&&pt.debug(this._graphicsContext,b.geometryColor,{lineWidth:b.geometryLineWidth,pointSize:b.geometryPointSize}),b.showAll||b.showBounds){if(pt instanceof de){const Q=pt.getColliders();for(const gt of Q){const Lt=gt.bounds,he=B(Lt.left,Lt.top);this._graphicsContext.debug.drawRect(he.x,he.y,Lt.width,Lt.height,{color:b.boundsColor}),(b.showAll||b.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${gt.owner.id})`,he)}w.bounds.draw(this._graphicsContext,b.boundsColor)}else if(pt){const Q=w.bounds,gt=B(Q.left,Q.top);this._graphicsContext.debug.drawRect(gt.x,gt.y,Q.width,Q.height,{color:b.boundsColor}),(b.showAll||b.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${w.owner.id})`,gt)}}}this._graphicsContext.restore(),this._popCameraTransform(d)}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(R.showAll||R.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),R.showAll||R.showCollisionContacts||R.showCollisionNormals)for(const[$,W]of this._engine.debug.stats.currFrame.physics.contacts){if(R.showAll||R.showCollisionContacts)for(const tt of W.points)this._graphicsContext.debug.drawPoint(tt,{size:R.contactSize,color:R.collisionContactColor});if(R.showAll||R.showCollisionNormals)for(const tt of W.points)this._graphicsContext.debug.drawLine(tt,W.normal.scale(30).add(tt),{color:R.collisionNormalColor})}this._graphicsContext.restore(),U&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(U.showAll||U.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,U.focusColor),(U.showAll||U.showZoom)&&this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`,this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}postupdate(t,i){this._engine.isDebug&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext),se.flush(this._graphicsContext),this._graphicsContext.restore())}_applyTransform(t){const i=t.getAncestors();for(const r of i){const a=r==null?void 0:r.get(it);a&&(this._graphicsContext.translate(a.pos.x,a.pos.y),this._graphicsContext.scale(a.scale.x,a.scale.y),this._graphicsContext.rotate(a.rotation))}}_pushCameraTransform(t){t.coordPlane===ie.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}_popCameraTransform(t){t.coordPlane===ie.World&&this._graphicsContext.restore()}}class oa extends li{constructor(t){super(),this.world=t,this.systemType=Ne.Update,this.priority=ki.Higher,this.overrideUseColliderShape=!1,this.overrideUseGraphicsBounds=!1,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map,this._sortedTransforms=[],this._sortedEntities=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0},this.query=this.world.query([it,Di]),this.query.entityAdded$.subscribe(i=>{const r=i.get(it);this._sortedTransforms.push(r),this._sortedEntities.push(r.owner),r.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}),this.query.entityRemoved$.subscribe(i=>{const r=i.get(it);r.zIndexChanged$.unsubscribe(this._zIndexUpdate);const a=this._sortedTransforms.indexOf(r);a>-1&&(this._sortedTransforms.splice(a,1),this._sortedEntities.splice(a,1))})}initialize(t,i){this._engine=i.engine,this._scene=i}preupdate(){this._receivers=[this._engine.input.pointers,this._scene.input.pointers],this._engineReceiver=this._engine.input.pointers,this._zHasChanged&&(this._sortedTransforms.sort((t,i)=>i.z-t.z),this._sortedEntities=this._sortedTransforms.map(t=>t.owner),this._zHasChanged=!1)}entityCurrentlyUnderPointer(t,i){return this.currentFrameEntityToPointers.has(t.id)&&this.currentFrameEntityToPointers.get(t.id).includes(i)}entityWasUnderPointer(t,i){return this.lastFrameEntityToPointers.has(t.id)&&this.lastFrameEntityToPointers.get(t.id).includes(i)}entered(t,i){return this.entityCurrentlyUnderPointer(t,i)&&!this.lastFrameEntityToPointers.has(t.id)}left(t,i){return!this.currentFrameEntityToPointers.has(t.id)&&this.entityWasUnderPointer(t,i)}addPointerToEntity(t,i){if(!this.currentFrameEntityToPointers.has(t.id)){this.currentFrameEntityToPointers.set(t.id,[i]);return}const r=this.currentFrameEntityToPointers.get(t.id);this.currentFrameEntityToPointers.set(t.id,r.concat(i))}update(){this._processPointerToEntity(this._sortedEntities),this._dispatchEvents(this._sortedEntities),this._receivers.forEach(t=>t.update()),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear(),this._receivers.forEach(t=>t.clear())}_processPointerToEntity(t){var i;let r,a,h,d;const p=this._engineReceiver;for(const m of t){if(r=m.get(it),d=(i=m.get(Di))!==null&&i!==void 0?i:new Di,d.localBounds){const y=d.localBounds.transform(r.get().matrix);for(const[w,b]of p.currentFramePointerCoords.entries())y.contains(r.coordPlane===ie.World?b.worldPos:b.screenPos)&&this.addPointerToEntity(m,w)}if(a=m.get(Wt),a&&(d.useColliderShape||this.overrideUseColliderShape)){a.update();const y=a.get();if(y)for(const[w,b]of p.currentFramePointerCoords.entries())y.contains(r.coordPlane===ie.World?b.worldPos:b.screenPos)&&this.addPointerToEntity(m,w)}if(h=m.get(ne),h&&(d.useGraphicsBounds||this.overrideUseGraphicsBounds)){const y=h.localBounds.transform(r.get().matrix);for(const[w,b]of p.currentFramePointerCoords.entries())y.contains(r.coordPlane===ie.World?b.worldPos:b.screenPos)&&this.addPointerToEntity(m,w)}}}_processDownAndEmit(t){const i=this._engineReceiver,r=new Map;for(const a of i.currentFrameDown)a.active&&t.active&&this.entityCurrentlyUnderPointer(t,a.pointerId)&&(t.events.emit("pointerdown",a),i.isDragStart(a.pointerId)&&t.events.emit("pointerdragstart",a)),r.set(a.pointerId,a);return r}_processUpAndEmit(t){const i=this._engineReceiver,r=new Map;for(const a of i.currentFrameUp)a.active&&t.active&&this.entityCurrentlyUnderPointer(t,a.pointerId)&&(t.events.emit("pointerup",a),i.isDragEnd(a.pointerId)&&t.events.emit("pointerdragend",a)),r.set(a.pointerId,a);return r}_processMoveAndEmit(t){const i=this._engineReceiver,r=new Map;for(const a of i.currentFrameMove)a.active&&t.active&&this.entityCurrentlyUnderPointer(t,a.pointerId)&&(t.events.emit("pointermove",a),i.isDragging(a.pointerId)&&t.events.emit("pointerdragmove",a)),r.set(a.pointerId,a);return r}_processEnterLeaveAndEmit(t,i){const r=this._engineReceiver;for(const a of i){if(a.active&&t.active&&this.entered(t,a.pointerId)){t.events.emit("pointerenter",a),r.isDragging(a.pointerId)&&t.events.emit("pointerdragenter",a);break}if(a.active&&t.active&&(this.left(t,a.pointerId)||this.entityCurrentlyUnderPointer(t,a.pointerId)&&a.type==="up")){t.events.emit("pointerleave",a),r.isDragging(a.pointerId)&&t.events.emit("pointerdragleave",a);break}}}_processCancelAndEmit(t){const i=this._engineReceiver;for(const r of i.currentFrameCancel)r.active&&t.active&&this.entityCurrentlyUnderPointer(t,r.pointerId)&&t.events.emit("pointercancel",r)}_processWheelAndEmit(t){const i=this._engineReceiver;for(const r of i.currentFrameWheel)r.active&&t.active&&this.entityCurrentlyUnderPointer(t,0)&&t.events.emit("pointerwheel",r)}_dispatchEvents(t){const i=new Set(this.lastFrameEntityToPointers.keys()),r=new Set(this.currentFrameEntityToPointers.keys()),a=t.filter(m=>i.has(m.id)||r.has(m.id));let h,d,p;for(const m of a){p=this._processDownAndEmit(m),d=this._processUpAndEmit(m),h=this._processMoveAndEmit(m);const y=[...h.values(),...p.values(),...d.values()];this._processEnterLeaveAndEmit(m,y),this._processCancelAndEmit(m),this._processWheelAndEmit(m)}}}class Mf extends li{constructor(t){super(),this.world=t,this.systemType=Ne.Update,this.priority=ki.Higher,this._actions=[],this.query=this.world.query([Sn]),this.query.entityAdded$.subscribe(i=>this._actions.push(i.get(Sn))),this.query.entityRemoved$.subscribe(i=>{const r=i.get(Sn),a=this._actions.indexOf(r);a>-1&&this._actions.splice(a,1)})}update(t){for(const i of this._actions)i.update(t)}}class Rr extends mi{constructor(t){super(),this.elevation=0,this.columns=t.columns,this.rows=t.rows,this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight}}class Lf extends li{constructor(t){super(),this.world=t,this.systemType=Ne.Update,this.priority=ki.Lower,this.query=this.world.query([it,Rr])}update(){let t,i;for(const r of this.query.entities){t=r.get(it),i=r.get(Rr);const h=Math.max(i.columns*i.tileWidth,i.rows*i.tileHeight)*i.elevation+t.pos.y;t.z=h}}}class Of extends li{constructor(t){super(),this.world=t,this.systemType=Ne.Draw,this.priority=ki.Higher,this.query=this.world.query([it,ne])}initialize(t,i){this._camera=i.camera,this._screen=i.engine.screen}update(){this._worldBounds=this._screen.getWorldBounds();let t,i,r;for(const a of this.query.entities){i=a.get(ne),t=a.get(it),r=a.get(ia);let h;if(r){const p=E.One.sub(r.parallaxFactor);h=this._camera.pos.scale(p)}const d=this._isOffscreen(t,i,h);d&&!a.hasTag("ex.offscreen")&&(a.events.emit("exitviewport",new uh(a)),a.addTag("ex.offscreen")),!d&&a.hasTag("ex.offscreen")&&(a.events.emit("enterviewport",new dh(a)),a.removeTag("ex.offscreen"))}}_isOffscreen(t,i,r){if(t.coordPlane===ie.World){let a=i.localBounds;r&&(a=a.translate(r));const h=a.transform(t.get().matrix);return!this._worldBounds.overlaps(h)}else return!1}}class Nf{get config(){return Hl(this._config,t=>{this.$configUpdate.notifyAll(t)})}set config(t){this._config=t,this.$configUpdate.notifyAll(t)}get collisionProcessor(){if(this._configDirty){this._configDirty=!1;const t=this._collisionProcessor.getColliders();this._collisionProcessor=new Xo(this._config);for(const i of t)this._collisionProcessor.track(i)}return this._collisionProcessor}constructor(t){this.$configUpdate=new xe,this._configDirty=!1,this.config=t,this.$configUpdate.subscribe(i=>{this._configDirty=!0,ht.updateDefaultPhysicsConfig(i.bodies)}),this._collisionProcessor=new Xo(this.config)}rayCast(t,i){return this.collisionProcessor.rayCast(t,i)}}class Ir{constructor(){this.events=new v,this.enabled=!1,this.supported=!!navigator.getGamepads,this._gamePadTimeStamps=[0,0,0,0],this._oldPads=[],this._pads=[],this._initSuccess=!1,this._navigator=navigator,this._minimumConfiguration=null,this._enabled=!0}init(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}toggleEnabled(t){this._enabled=t}setMinimumGamepadConfiguration(t){this._enableAndUpdate(),this._minimumConfiguration=t}_enableAndUpdate(){this.enabled||(this.enabled=!0,this.update())}_isGamepadValid(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;const i=t.axes.filter(a=>typeof a!==void 0).length,r=t.buttons.filter(a=>typeof a!==void 0).length;return i>=this._minimumConfiguration.axis&&r>=this._minimumConfiguration.buttons&&t.connected}emit(t,i){this.events.emit(t,i)}on(t,i){return this._enableAndUpdate(),this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this._enableAndUpdate(),this.events.off(t,i)}update(){if(!this.enabled||!this.supported||!this._enabled)return;this.init();const t=this._navigator.getGamepads();for(let i=0;i<t.length;i++){if(t[i])!this.at(i).connected&&this._isGamepadValid(t[i])&&this.events.emit("connect",new sh(i,this.at(i))),this.at(i).connected=!0;else{const m=this.at(i);m.connected&&this.events.emit("disconnect",new nh(i,m)),m.connected=!1;continue}if(this.at(i).update(),t[i].timestamp&&t[i].timestamp===this._gamePadTimeStamps[i])continue;this._gamePadTimeStamps[i]=t[i].timestamp,this.at(i).navigatorGamepad=t[i];let r,a,h,d,p;for(r in Pn)a=Pn[r],typeof a=="number"&&t[i].buttons[a]&&(p=t[i].buttons[a].value,p!==this._oldPads[i].getButton(a)&&(t[i].buttons[a].pressed?(this.at(i).updateButton(a,p),this.at(i).events.emit("button",new rh(a,p,this.at(i)))):this.at(i).updateButton(a,0)));for(h in Rn)d=Rn[h],typeof d=="number"&&(p=t[i].axes[d],p!==this._oldPads[i].getAxes(d)&&(this.at(i).updateAxes(d,p),this.at(i).events.emit("axis",new oh(d,p,this.at(i)))));this._oldPads[i]=this._clonePad(t[i])}}at(t){if(this._enableAndUpdate(),t>=this._pads.length)for(let i=this._pads.length-1,r=t;i<r;i++)this._pads.push(new Dr),this._oldPads.push(new Dr);return this._pads[t]}getValidGamepads(){this._enableAndUpdate();const t=[];for(let i=0;i<this._pads.length;i++)this._isGamepadValid(this.at(i).navigatorGamepad)&&this.at(i).connected&&t.push(this.at(i));return t}count(){return this._pads.filter(t=>t.connected).length}_clonePads(t){const i=[];for(let r=0,a=t.length;r<a;r++)i.push(this._clonePad(t[r]));return i}_clonePad(t){let i,r;const a=new Dr;if(!t)return a;for(i=0,r=t.buttons.length;i<r;i++)t.buttons[i]&&a.updateButton(i,t.buttons[i].value);for(i=0,r=t.axes.length;i<r;i++)a.updateAxes(i,t.axes[i]);return a}}Ir.MinAxisMoveThreshold=.05;class Dr{constructor(){this.events=new v,this.connected=!1,this._axes=new Array(4),this._buttons=new Array(16),this._buttonsUp=new Array(16),this._buttonsDown=new Array(16);for(let t=0;t<this._buttons.length;t++)this._buttons[t]=0;for(let t=0;t<this._axes.length;t++)this._axes[t]=0}update(){this._buttonsDown=new Array(16),this._buttonsUp=new Array(16)}isButtonPressed(t,i=1){return this._buttons[t]>=i}isButtonHeld(t,i=1){return this._buttons[t]>=i}wasButtonPressed(t,i=1){return this._buttonsDown[t]>=i}wasButtonReleased(t){return!!this._buttonsUp[t]}getButton(t){return this._buttons[t]}getAxes(t){const i=this._axes[t];return Math.abs(i)<Ir.MinAxisMoveThreshold?0:i}updateButton(t,i){i===0&&this._buttons[t]?this._buttonsUp[t]=1:this._buttonsDown[t]=i,this._buttons[t]=i}updateAxes(t,i){this._axes[t]=i}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}var Pn;(function(u){u[u.Face1=0]="Face1",u[u.Face2=1]="Face2",u[u.Face3=2]="Face3",u[u.Face4=3]="Face4",u[u.LeftBumper=4]="LeftBumper",u[u.RightBumper=5]="RightBumper",u[u.LeftTrigger=6]="LeftTrigger",u[u.RightTrigger=7]="RightTrigger",u[u.Select=8]="Select",u[u.Start=9]="Start",u[u.LeftStick=10]="LeftStick",u[u.RightStick=11]="RightStick",u[u.DpadUp=12]="DpadUp",u[u.DpadDown=13]="DpadDown",u[u.DpadLeft=14]="DpadLeft",u[u.DpadRight=15]="DpadRight"})(Pn||(Pn={}));var Rn;(function(u){u[u.LeftStickX=0]="LeftStickX",u[u.LeftStickY=1]="LeftStickY",u[u.RightStickX=2]="RightStickX",u[u.RightStickY=3]="RightStickY"})(Rn||(Rn={}));class Uf{constructor(t){this.inputs=t,this._handlers=new Map}execute(){for(const[t,i]of this._handlers.entries()){const r=t(this.inputs);r&&i(r)}}on(t,i){this._handlers.set(t,i)}}function zf(){try{const u=()=>{};window.top.addEventListener("blur",u),window.top.removeEventListener("blur",u)}catch{return!0}return!1}var In;(function(u){u.Num0="Numpad0",u.Num1="Numpad1",u.Num2="Numpad2",u.Num3="Numpad3",u.Num4="Numpad4",u.Num5="Numpad5",u.Num6="Numpad6",u.Num7="Numpad7",u.Num8="Numpad8",u.Num9="Numpad9",u.NumAdd="NumpadAdd",u.NumSubtract="NumpadSubtract",u.NumMultiply="NumpadMultiply",u.NumDivide="NumpadDivide",u.NumDecimal="NumpadDecimal",u.Numpad0="Numpad0",u.Numpad1="Numpad1",u.Numpad2="Numpad2",u.Numpad3="Numpad3",u.Numpad4="Numpad4",u.Numpad5="Numpad5",u.Numpad6="Numpad6",u.Numpad7="Numpad7",u.Numpad8="Numpad8",u.Numpad9="Numpad9",u.NumpadAdd="NumpadAdd",u.NumpadSubtract="NumpadSubtract",u.NumpadMultiply="NumpadMultiply",u.NumpadDivide="NumpadDivide",u.NumpadDecimal="NumpadDecimal",u.NumLock="NumLock",u.ShiftLeft="ShiftLeft",u.ShiftRight="ShiftRight",u.AltLeft="AltLeft",u.AltRight="AltRight",u.ControlLeft="ControlLeft",u.ControlRight="ControlRight",u.MetaLeft="MetaLeft",u.MetaRight="MetaRight",u.Key0="Digit0",u.Key1="Digit1",u.Key2="Digit2",u.Key3="Digit3",u.Key4="Digit4",u.Key5="Digit5",u.Key6="Digit6",u.Key7="Digit7",u.Key8="Digit8",u.Key9="Digit9",u.Digit0="Digit0",u.Digit1="Digit1",u.Digit2="Digit2",u.Digit3="Digit3",u.Digit4="Digit4",u.Digit5="Digit5",u.Digit6="Digit6",u.Digit7="Digit7",u.Digit8="Digit8",u.Digit9="Digit9",u.F1="F1",u.F2="F2",u.F3="F3",u.F4="F4",u.F5="F5",u.F6="F6",u.F7="F7",u.F8="F8",u.F9="F9",u.F10="F10",u.F11="F11",u.F12="F12",u.A="KeyA",u.B="KeyB",u.C="KeyC",u.D="KeyD",u.E="KeyE",u.F="KeyF",u.G="KeyG",u.H="KeyH",u.I="KeyI",u.J="KeyJ",u.K="KeyK",u.L="KeyL",u.M="KeyM",u.N="KeyN",u.O="KeyO",u.P="KeyP",u.Q="KeyQ",u.R="KeyR",u.S="KeyS",u.T="KeyT",u.U="KeyU",u.V="KeyV",u.W="KeyW",u.X="KeyX",u.Y="KeyY",u.Z="KeyZ",u.KeyA="KeyA",u.KeyB="KeyB",u.KeyC="KeyC",u.KeyD="KeyD",u.KeyE="KeyE",u.KeyF="KeyF",u.KeyG="KeyG",u.KeyH="KeyH",u.KeyI="KeyI",u.KeyJ="KeyJ",u.KeyK="KeyK",u.KeyL="KeyL",u.KeyM="KeyM",u.KeyN="KeyN",u.KeyO="KeyO",u.KeyP="KeyP",u.KeyQ="KeyQ",u.KeyR="KeyR",u.KeyS="KeyS",u.KeyT="KeyT",u.KeyU="KeyU",u.KeyV="KeyV",u.KeyW="KeyW",u.KeyX="KeyX",u.KeyY="KeyY",u.KeyZ="KeyZ",u.Semicolon="Semicolon",u.Quote="Quote",u.Comma="Comma",u.Minus="Minus",u.Period="Period",u.Slash="Slash",u.Equal="Equal",u.BracketLeft="BracketLeft",u.Backslash="Backslash",u.BracketRight="BracketRight",u.Backquote="Backquote",u.Up="ArrowUp",u.Down="ArrowDown",u.Left="ArrowLeft",u.Right="ArrowRight",u.ArrowUp="ArrowUp",u.ArrowDown="ArrowDown",u.ArrowLeft="ArrowLeft",u.ArrowRight="ArrowRight",u.Space="Space",u.Backspace="Backspace",u.Delete="Delete",u.Esc="Escape",u.Escape="Escape",u.Enter="Enter",u.NumpadEnter="NumpadEnter",u.ContextMenu="ContextMenu"})(In||(In={}));class Dn extends mt{constructor(t,i,r){super(),this.key=t,this.value=i,this.originalEvent=r}}class Fh{constructor(){this.events=new v,this._enabled=!0,this._keys=[],this._keysUp=[],this._keysDown=[],this._releaseAllKeys=t=>{for(const i of this._keys){const r=new Dn(i,t.key,t);this.events.emit("up",r),this.events.emit("release",r)}this._keysUp=Array.from(new Set(this._keys.concat(this._keysUp))),this._keys.length=0},this._handleKeyDown=t=>{if(!this._enabled)return;!t.metaKey&&(this._keys.includes(In.MetaLeft)||this._keys.includes(In.MetaRight))&&this._releaseAllKeys(t);const i=t.code;if(this._keys.indexOf(i)===-1){this._keys.push(i),this._keysDown.push(i);const r=new Dn(i,t.key,t);this.events.emit("down",r),this.events.emit("press",r)}},this._handleKeyUp=t=>{if(!this._enabled)return;const i=t.code,r=this._keys.indexOf(i);this._keys.splice(r,1),this._keysUp.push(i);const a=new Dn(i,t.key,t);this.events.emit("up",a),this.events.emit("release",a),t.key==="Meta"&&this._releaseAllKeys(t)}}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}init(t){let{global:i}=t;const{grabWindowFocus:r}=t;i||(zf()?(i=window,r&&window.focus(),J.getInstance().warn("Excalibur might be in a cross-origin iframe, in order to receive keyboard events it must be in focus")):i=window.top),i.addEventListener("blur",()=>{this._keys.length=0}),i.addEventListener("keyup",this._handleKeyUp),i.addEventListener("keydown",this._handleKeyDown)}toggleEnabled(t){this._enabled=t}update(){this._keysDown.length=0,this._keysUp.length=0;for(let t=0;t<this._keys.length;t++)this.events.emit("hold",new Dn(this._keys[t]))}getKeys(){return this._keys}wasPressed(t){return this._keysDown.indexOf(t)>-1}isHeld(t){return this._keys.indexOf(t)>-1}wasReleased(t){return this._keysUp.indexOf(t)>-1}triggerEvent(t,i,r){t==="down"&&this._handleKeyDown(new KeyboardEvent("keydown",{code:i,key:r??null})),t==="up"&&this._handleKeyUp(new KeyboardEvent("keyup",{code:i,key:r??null}))}}class kr{static fromPagePosition(t,i,r){let a,h,d,p;arguments.length===3?(a=t,h=i,d=new E(a,h),p=r):(d=t,a=d.x,h=d.y,p=i);const m=p.screen.pageToScreenCoordinates(d),y=p.screen.screenToWorldCoordinates(m);return new kr(y,d,m)}constructor(t,i,r){this.worldPos=t,this.pagePos=i,this.screenPos=r}}class kn{cancel(){this.active=!1}get pagePos(){return this.coordinates.pagePos}get screenPos(){return this.coordinates.screenPos}get worldPos(){return this.coordinates.worldPos}constructor(t,i,r,a,h,d){this.type=t,this.pointerId=i,this.button=r,this.pointerType=a,this.coordinates=h,this.nativeEvent=d,this.active=!0}}class Bh{cancel(){this.active=!1}constructor(t,i,r,a,h,d,p,m,y,w,b,R){this.x=t,this.y=i,this.pageX=r,this.pageY=a,this.screenX=h,this.screenY=d,this.index=p,this.deltaX=m,this.deltaY=y,this.deltaZ=w,this.deltaMode=b,this.ev=R,this.active=!0}}class Mh{constructor(){this.events=new v,this.lastPagePos=E.Zero,this.lastScreenPos=E.Zero,this.lastWorldPos=E.Zero,this._onPointerMove=t=>{this.lastPagePos=new E(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new E(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new E(t.worldPos.x,t.worldPos.y)},this._onPointerDown=t=>{this.lastPagePos=new E(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new E(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new E(t.worldPos.x,t.worldPos.y)},this.on("move",this._onPointerMove),this.on("down",this._onPointerDown)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}var Xs;(function(u){u.Pixel="Pixel",u.Line="Line",u.Page="Page"})(Xs||(Xs={}));var $i;(function(u){u[u.NoButton=-1]="NoButton",u[u.Left=0]="Left",u[u.Middle=1]="Middle",u[u.Right=2]="Right",u[u.Unknown=3]="Unknown"})($i||($i={}));var Fi;(function(u){u.Left="Left",u.Middle="Middle",u.Right="Right",u.Unknown="Unknown",u.NoButton="NoButton"})(Fi||(Fi={}));var Bi;(function(u){u.Touch="Touch",u.Mouse="Mouse",u.Pen="Pen",u.Unknown="Unknown"})(Bi||(Bi={}));function ny(u){return globalThis.TouchEvent&&u instanceof globalThis.TouchEvent}function ry(u){return globalThis.PointerEvent&&u instanceof globalThis.PointerEvent}class Fr{constructor(t,i){this.target=t,this.engine=i,this.events=new v,this.primary=new Mh,this._activeNativePointerIdsToNormalized=new Map,this.lastFramePointerCoords=new Map,this.currentFramePointerCoords=new Map,this.currentFramePointerDown=new Map,this.lastFramePointerDown=new Map,this.currentFrameDown=[],this.currentFrameUp=[],this.currentFrameMove=[],this.currentFrameCancel=[],this.currentFrameWheel=[],this._enabled=!0,this._pointers=[this.primary],this._boundHandle=this._handle.bind(this),this._boundWheel=this._handleWheel.bind(this)}toggleEnabled(t){this._enabled=t}recreate(t,i){const r=new Fr(t,i);return r.primary=this.primary,r._pointers=this._pointers,r}at(t){if(t>=this._pointers.length)for(let i=this._pointers.length-1,r=t;i<r;i++)this._pointers.push(new Mh);return this._pointers[t]}count(){return this._pointers.length}isDown(t){var i;return(i=this.currentFramePointerDown.get(t))!==null&&i!==void 0?i:!1}wasDown(t){var i;return(i=this.lastFramePointerDown.get(t))!==null&&i!==void 0?i:!1}isDragging(t){return this.isDown(t)}isDragStart(t){return this.isDown(t)&&!this.wasDown(t)}isDragEnd(t){return!this.isDown(t)&&this.wasDown(t)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}update(){this.lastFramePointerDown=new Map(this.currentFramePointerDown),this.lastFramePointerCoords=new Map(this.currentFramePointerCoords);for(const t of this.currentFrameDown)this.emit("down",t),this.at(t.pointerId).emit("down",t),this.primary.emit("pointerdown",t);for(const t of this.currentFrameUp)this.emit("up",t),this.at(t.pointerId).emit("up",t);for(const t of this.currentFrameMove)this.emit("move",t),this.at(t.pointerId).emit("move",t);for(const t of this.currentFrameCancel)this.emit("cancel",t),this.at(t.pointerId).emit("cancel",t);for(const t of this.currentFrameWheel)this.emit("wheel",t),this.primary.emit("pointerwheel",t),this.primary.emit("wheel",t)}clear(){for(const t of this.currentFrameUp){this.currentFramePointerCoords.delete(t.pointerId);const i=this._activeNativePointerIdsToNormalized.entries();for(const[r,a]of i)a===t.pointerId&&this._activeNativePointerIdsToNormalized.delete(r)}this.currentFrameDown.length=0,this.currentFrameUp.length=0,this.currentFrameMove.length=0,this.currentFrameCancel.length=0,this.currentFrameWheel.length=0}init(t){var i;if(this.engine.isDisposed())return;this.target===this.engine.canvas?this.engine.canvas.style.touchAction="none":document.body.style.touchAction="none",window.PointerEvent?(this.target.addEventListener("pointerdown",this._boundHandle),this.target.addEventListener("pointerup",this._boundHandle),this.target.addEventListener("pointermove",this._boundHandle),this.target.addEventListener("pointercancel",this._boundHandle)):(this.target.addEventListener("touchstart",this._boundHandle),this.target.addEventListener("touchend",this._boundHandle),this.target.addEventListener("touchmove",this._boundHandle),this.target.addEventListener("touchcancel",this._boundHandle),this.target.addEventListener("mousedown",this._boundHandle),this.target.addEventListener("mouseup",this._boundHandle),this.target.addEventListener("mousemove",this._boundHandle));const r={passive:!(this.engine.pageScrollPreventionMode===hs.All||this.engine.pageScrollPreventionMode===hs.Canvas)};if("onwheel"in document.createElement("div")?this.target.addEventListener("wheel",this._boundWheel,r):document.onmousewheel!==void 0?this.target.addEventListener("mousewheel",this._boundWheel,r):this.target.addEventListener("MozMousePixelScroll",this._boundWheel,r),((i=t==null?void 0:t.grabWindowFocus)!==null&&i!==void 0?i:!0)&&zf()){const h=()=>{window.focus()};window.PointerEvent?this.target.addEventListener("pointerdown",h):(this.target.addEventListener("touchstart",h),this.target.addEventListener("mousedown",h))}}detach(){window.PointerEvent?(this.target.removeEventListener("pointerdown",this._boundHandle),this.target.removeEventListener("pointerup",this._boundHandle),this.target.removeEventListener("pointermove",this._boundHandle),this.target.removeEventListener("pointercancel",this._boundHandle)):(this.target.removeEventListener("touchstart",this._boundHandle),this.target.removeEventListener("touchend",this._boundHandle),this.target.removeEventListener("touchmove",this._boundHandle),this.target.removeEventListener("touchcancel",this._boundHandle),this.target.removeEventListener("mousedown",this._boundHandle),this.target.removeEventListener("mouseup",this._boundHandle),this.target.removeEventListener("mousemove",this._boundHandle)),"onwheel"in document.createElement("div")?this.target.removeEventListener("wheel",this._boundWheel):document.onmousewheel!==void 0?this.target.addEventListener("mousewheel",this._boundWheel):this.target.addEventListener("MozMousePixelScroll",this._boundWheel)}_normalizePointerId(t){this._activeNativePointerIdsToNormalized.set(t,-1);const r=Array.from(this._activeNativePointerIdsToNormalized.keys()).sort((a,h)=>a-h).findIndex(a=>a===t);return this._activeNativePointerIdsToNormalized.set(t,r),r}_handle(t){if(!this._enabled)return;t.preventDefault();const i=new Map;let r,a;if(ny(t)){r=Fi.Unknown,a=Bi.Touch;for(let h=0;h<t.changedTouches.length;h++){const d=t.changedTouches[h],p=kr.fromPagePosition(d.pageX,d.pageY,this.engine),m=h+1,y=this._normalizePointerId(m);this.currentFramePointerCoords.set(y,p),i.set(y,p)}}else{r=this._nativeButtonToPointerButton(t.button),a=Bi.Mouse;const h=kr.fromPagePosition(t.pageX,t.pageY,this.engine);let d=1;ry(t)&&(d=t.pointerId,a=this._stringToPointerType(t.pointerType));const p=this._normalizePointerId(d);this.currentFramePointerCoords.set(p,h),i.set(p,h)}for(const[h,d]of i.entries())switch(t.type){case"mousedown":case"pointerdown":case"touchstart":this.currentFrameDown.push(new kn("down",h,r,a,d,t)),this.currentFramePointerDown.set(h,!0);break;case"mouseup":case"pointerup":case"touchend":this.currentFrameUp.push(new kn("up",h,r,a,d,t)),this.currentFramePointerDown.set(h,!1);break;case"mousemove":case"pointermove":case"touchmove":this.currentFrameMove.push(new kn("move",h,r,a,d,t));break;case"touchcancel":case"pointercancel":this.currentFrameCancel.push(new kn("cancel",h,r,a,d,t));break}}_handleWheel(t){if(!this._enabled)return;(this.engine.pageScrollPreventionMode===hs.All||this.engine.pageScrollPreventionMode===hs.Canvas&&t.target===this.engine.canvas)&&t.preventDefault();const i=this.engine.screen.pageToScreenCoordinates(B(t.pageX,t.pageY)),r=this.engine.screen.screenToWorldCoordinates(i),a=-1/40,h=t.deltaX||t.wheelDeltaX*a||0,d=t.deltaY||t.wheelDeltaY*a||t.wheelDelta*a||t.detail||0,p=t.deltaZ||0;let m=Xs.Pixel;t.deltaMode&&(t.deltaMode===1?m=Xs.Line:t.deltaMode===2&&(m=Xs.Page));const y=new Bh(r.x,r.y,t.pageX,t.pageY,i.x,i.y,0,h,d,p,m,t);this.currentFrameWheel.push(y)}triggerEvent(t,i){const r=this.engine.screen.worldToPageCoordinates(i);window.PointerEvent?this._handle(new window.PointerEvent("pointer"+t,{pointerId:0,clientX:r.x,clientY:r.y})):this._handle(new window.MouseEvent("mouse"+t,{clientX:r.x,clientY:r.y}));const a=this.engine.currentScene.world.get(oa);a.preupdate(this.engine.currentScene,1),a.update(1)}_nativeButtonToPointerButton(t){switch(t){case $i.NoButton:return Fi.NoButton;case $i.Left:return Fi.Left;case $i.Middle:return Fi.Middle;case $i.Right:return Fi.Right;case $i.Unknown:return Fi.Unknown;default:return Et(t)}}_stringToPointerType(t){switch(t){case"touch":return Bi.Touch;case"mouse":return Bi.Mouse;case"pen":return Bi.Pen;default:return Bi.Unknown}}}class Lh{constructor(t){this._enabled=!0;const{pointerTarget:i,grabWindowFocus:r,engine:a}=t;this.keyboard=new Fh,this.pointers=new Fr(i,a),this.gamepads=new Ir,this.keyboard.init({grabWindowFocus:r}),this.pointers.init({grabWindowFocus:r}),this.gamepads.init(),this.inputMapper=new Uf({keyboard:this.keyboard,pointers:this.pointers,gamepads:this.gamepads})}get enabled(){return this._enabled}toggleEnabled(t){this._enabled=t,this.keyboard.toggleEnabled(this._enabled),this.pointers.toggleEnabled(this._enabled),this.gamepads.toggleEnabled(this._enabled)}update(){this._enabled&&(this.inputMapper.execute(),this.keyboard.update(),this.gamepads.update())}}class oy{}const ay={Initialize:"initialize",Activate:"activate",Deactivate:"deactivate",PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw",PreDebugDraw:"predebugdraw",PostDebugDraw:"postdebugdraw",PreLoad:"preload"};function Mi(u){var t,i;return!!(u!=null&&u.prototype)&&!!(!((i=(t=u==null?void 0:u.prototype)===null||t===void 0?void 0:t.constructor)===null||i===void 0)&&i.name)}class Ke{get actors(){return this.world.entityManager.entities.filter(t=>t instanceof Oe)}get entities(){return this.world.entityManager.entities}get triggers(){return this.world.entityManager.entities.filter(t=>t instanceof Cf)}get tileMaps(){return this.world.entityManager.entities.filter(t=>t instanceof pf)}get timers(){return this._timers}constructor(){this._logger=J.getInstance(),this.events=new v,this.camera=new bf,this.world=new Pf(this),this.physics=new Nf(Pi),this._isInitialized=!1,this._timers=[],this._cancelQueue=[],this.world.add(Mf),this.world.add(new Rf(this.world,this.physics)),this.world.add(new kh(this.world,this.physics)),this.world.add(oa),this.world.add(Lf),this.world.add(Of),this.world.add(Ff),this.world.add(Bf)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}onPreLoad(t){}onTransition(t){}onInitialize(t){}onActivate(t){}onDeactivate(t){}onPreUpdate(t,i){}onPostUpdate(t,i){}onPreDraw(t,i){}onPostDraw(t,i){}_initializeChildren(){for(const t of this.entities)t._initialize(this.engine)}get isInitialized(){return this._isInitialized}async _initialize(t){var i;if(!this.isInitialized){try{this.engine=t,this.physics.config=this.engine.physics,this.input=new Lh({pointerTarget:t.pointerScope===x.Canvas?t.canvas:document,grabWindowFocus:t.grabWindowFocus,engine:t}),this.camera._initialize(t),this.world.systemManager.initialize(),await this.onInitialize(t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.events.emit("initialize",new bn(t,this))}catch(r){throw this._logger.error(`Error during scene initialization for scene ${(i=t.director)===null||i===void 0?void 0:i.getSceneName(this)}!`),r}this._isInitialized=!0}}async _activate(t){var i,r;try{this._logger.debug("Scene.onActivate",this),this.input.toggleEnabled(!0),await this.onActivate(t)}catch(a){throw this._logger.error(`Error during scene activation for scene ${(r=(i=this.engine)===null||i===void 0?void 0:i.director)===null||r===void 0?void 0:r.getSceneName(this)}!`),a}}async _deactivate(t){this._logger.debug("Scene.onDeactivate",this),this.input.toggleEnabled(!1),await this.onDeactivate(t)}_preupdate(t,i){this.emit("preupdate",new rs(t,i,this)),this.onPreUpdate(t,i)}_postupdate(t,i){this.emit("postupdate",new os(t,i,this)),this.onPostUpdate(t,i)}_predraw(t,i){this.emit("predraw",new wn(t,i,this)),this.onPreDraw(t,i)}_postdraw(t,i){this.emit("postdraw",new xn(t,i,this)),this.onPostDraw(t,i)}update(t,i){var r;if(!this.isInitialized){this._logger.warnOnce(`Scene update called before initialize for scene ${(r=t.director)===null||r===void 0?void 0:r.getSceneName(this)}!`);return}this._preupdate(t,i);let a,h;for(a=0,h=this._cancelQueue.length;a<h;a++)this.removeTimer(this._cancelQueue[a]);this._cancelQueue.length=0;for(const d of this._timers)d.update(i);this.world.update(Ne.Update,i),this.camera&&this.camera.update(t,i),this._collectActorStats(t),this._postupdate(t,i),this.input.update()}draw(t,i){var r;if(!this.isInitialized){this._logger.warnOnce("Scene draw called before initialize!");return}this._predraw(t,i),this.world.update(Ne.Draw,i),!((r=this.engine)===null||r===void 0)&&r.isDebug&&this.debugDraw(t),this._postdraw(t,i)}debugDraw(t){this.emit("predebugdraw",new Jl(t,this)),this.emit("postdebugdraw",new th(t,this))}contains(t){return this.actors.indexOf(t)>-1}add(t){if(this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof Gs){dt(this._timers,t)||this.addTimer(t);return}}transfer(t){let i;t instanceof ge&&t.scene&&t.scene!==this&&(i=t.scene,t.scene.world.remove(t,!1)),t instanceof Gs&&t.scene&&(i=t.scene,t.scene.removeTimer(t)),i==null||i.emit("entityremoved",{target:t}),this.add(t)}remove(t){t instanceof ge&&(this.emit("entityremoved",{target:t}),t.active&&t.kill(),this.world.remove(t)),t instanceof Gs&&this.removeTimer(t)}clear(t=!0){for(let i=this.entities.length-1;i>=0;i--)this.world.remove(this.entities[i],t);for(let i=this.timers.length-1;i>=0;i--)this.removeTimer(this.timers[i])}addTimer(t){return this._timers.push(t),t.scene=this,t}removeTimer(t){const i=this._timers.indexOf(t);return i!==-1&&this._timers.splice(i,1),t}cancelTimer(t){return this._cancelQueue.push(t),t}isTimerActive(t){return this._timers.indexOf(t)>-1&&!t.complete}isCurrentScene(){return this.engine?this.engine.currentScene===this:!1}_collectActorStats(t){const i=this.actors.filter(r=>r instanceof Rh);for(const r of i)t.stats.currFrame.actors.ui++;for(const r of this.actors){t.stats.currFrame.actors.alive++;for(const a of r.children)ff(a)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}}}var $s;(function(u){u.Protanope="Protanope",u.Deuteranope="Deuteranope",u.Tritanope="Tritanope"})($s||($s={}));const ly=`#version 300 es\r
precision mediump float;\r
// our texture\r
uniform sampler2D u_image;\r
// the texCoords passed in from the vertex shader.\r
in vec2 v_texcoord;\r
\r
// color blind type\r
uniform int u_type;\r
\r
// simulation?\r
uniform bool u_simulate;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  vec4 o =  texture(u_image, v_texcoord);\r
  // RGB to LMS matrix conversion\r
  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\r
  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\r
  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\r
  // Simulate color blindness\r
  float l;\r
  float m;\r
  float s;\r
  //MODE CODE//\r
  if (u_type == 0) {\r
    // Protanope\r
    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\r
    m = 0.0 * L + 1.0 * M + 0.0 * S;\r
    s = 0.0 * L + 0.0 * M + 1.0 * S;;\r
  } else if (u_type == 1) {\r
    // Deuteranope\r
    l = 1.0 * L + 0.0 * M + 0.0 * S;\r
    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\r
    s = 0.0 * L + 0.0 * M + 1.0 * S;\r
  } else if (u_type == 2) {\r
    // Tritanope\r
    l = 1.0 * L + 0.0 * M + 0.0 * S;\r
    m = 0.0 * L + 1.0 * M + 0.0 * S;\r
    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\r
  }\r
\r
  // LMS to RGB matrix conversion\r
  vec4 error; // simulate the colors\r
  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\r
  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\r
  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\r
  error.a = 1.0;\r
  vec4 diff = o - error;\r
  vec4 correction; // correct the colors\r
  correction.r = 0.0;\r
  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\r
  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\r
  correction = o + correction;\r
  correction.a = o.a;\r
  //SIMULATE//\r
\r
  // sim \r
  if (u_simulate) {\r
    fragColor = error.rgba;\r
  } else {\r
    fragColor = correction.rgba;\r
  }\r
}`;class Hf{constructor(t,i){this._shader=new Qe({gl:t,vertexSource:`#version 300 es
      in vec2 a_position;
      in vec2 a_texcoord;
      out vec2 v_texcoord;

      void main() {
        gl_Position = vec4(a_position, 0.0, 1.0);
        // Pass the texcoord to the fragment shader.
        v_texcoord = a_texcoord;
      }`,fragmentSource:i}),this._shader.compile(),this._buffer=new Wi({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new Vi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}getShader(){return this._shader}getLayout(){return this._layout}}class jf{constructor(t,i=!1){this._colorBlindnessMode=t,this._simulate=!1,this._simulate=i}initialize(t){this._shader=new Hf(t,ly),this.simulate=this._simulate,this.colorBlindnessMode=this._colorBlindnessMode}getShader(){return this._shader.getShader()}getLayout(){return this._shader.getLayout()}set colorBlindnessMode(t){if(this._colorBlindnessMode=t,this._shader){const i=this._shader.getShader();i.use(),this._colorBlindnessMode===$s.Protanope?i.setUniformInt("u_type",0):this._colorBlindnessMode===$s.Deuteranope?i.setUniformInt("u_type",1):this._colorBlindnessMode===$s.Tritanope&&i.setUniformInt("u_type",2)}}get colorBlindnessMode(){return this._colorBlindnessMode}set simulate(t){if(this._simulate=t,this._shader){const i=this._shader.getShader();i.use(),i.setUniformBoolean("u_simulate",t)}}get simulate(){return this._simulate}}class Wf{constructor(t){this._engine=t,this._colorBlindPostProcessor=new jf($s.Protanope)}correct(t){this._engine.graphicsContext instanceof Gi&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!1,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}simulate(t){this._engine.graphicsContext instanceof Gi&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!0,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}clear(){this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor)}}class Vf{constructor(t){this.stats={currFrame:new Br,prevFrame:new Br},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!1,showName:!1},this.transform={showAll:!1,debugZIndex:1e7,showPosition:!1,showPositionLabel:!1,positionColor:G.Yellow,showZIndex:!1,showScale:!1,scaleColor:G.Green,showRotation:!1,rotationColor:G.Blue},this.graphics={showAll:!1,showBounds:!1,boundsColor:G.Yellow},this.collider={showAll:!1,showBounds:!1,boundsColor:G.Blue,showOwner:!1,showGeometry:!0,geometryColor:G.Green,geometryLineWidth:1,geometryPointSize:.5},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:G.Cyan,showCollisionContacts:!0,contactSize:2,collisionContactColor:G.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:G.Yellow,showAcceleration:!1,accelerationColor:G.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:G.Red,showZoom:!1},this.tilemap={showAll:!1,showGrid:!1,gridColor:G.Red,gridWidth:.5,showSolidBounds:!1,solidBoundsColor:G.fromHex("#8080807F"),showColliderGeometry:!0},this.isometric={showAll:!1,showPosition:!1,positionColor:G.Yellow,positionSize:1,showGrid:!1,gridColor:G.Red,gridWidth:1,showColliderGeometry:!0},this._engine=t,this.colorBlindMode=new Wf(this._engine)}useTestClock(){const t=this._engine.clock,i=t.isRunning();t.stop();const r=t.toTestClock();return i&&r.start(),this._engine.clock=r,r}useStandardClock(){const t=this._engine.clock,i=t.isRunning();t.stop();const r=t.toStandardClock();return i&&r.start(),this._engine.clock=r,r}}class Br{constructor(){this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new aa,this._graphicsStats={drawCalls:0,drawnImages:0}}reset(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}clone(){const t=new Br;return t.reset(this),t}get id(){return this._id}set id(t){this._id=t}get delta(){return this._delta}set delta(t){this._delta=t}get fps(){return this._fps}set fps(t){this._fps=t}get actors(){return this._actorStats}get duration(){return this._durationStats}get physics(){return this._physicsStats}get graphics(){return this._graphicsStats}}class aa{constructor(){this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}reset(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}clone(){const t=new aa;return t.reset(this),t}get pairs(){return this._pairs}set pairs(t){this._pairs=t}get collisions(){return this._collisions}set collisions(t){this._collisions=t}get contacts(){return this._contacts}set contacts(t){this._contacts=t}get fastBodies(){return this._fastBodies}set fastBodies(t){this._fastBodies=t}get fastBodyCollisions(){return this._fastBodyCollisions}set fastBodyCollisions(t){this._fastBodyCollisions=t}get broadphase(){return this._broadphase}set broadphase(t){this._broadphase=t}get narrowphase(){return this._narrowphase}set narrowphase(t){this._narrowphase=t}}class Oh{on(t,i){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(i),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}off(t,i){i||(i=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,i),this._nativeHandlers[t]=null}_decorate(t){return i=>{this._paused||t(i)}}pause(){this._paused=!0}resume(){this._paused=!1}clear(){for(const t in this._nativeHandlers)this.off(t)}constructor(t){this.nativeComponent=t,this._paused=!1,this._nativeHandlers={}}}class Gf{constructor(t,i){this._windowGlobal=t,this._documentGlobal=i,this._windowComponent=new Oh(this._windowGlobal),this._documentComponent=new Oh(this._documentGlobal)}get window(){return this._windowComponent}get document(){return this._documentComponent}pause(){this.window.pause(),this.document.pause()}resume(){this.window.resume(),this.document.resume()}clear(){this.window.clear(),this.document.clear()}}const Xf={pixelArtSampler:!1,nativeContextAntialiasing:!1,multiSampleAntialiasing:!0,filtering:qt.Blended,canvasImageRendering:"auto"},$f={pixelArtSampler:!0,nativeContextAntialiasing:!1,multiSampleAntialiasing:!0,filtering:qt.Blended,canvasImageRendering:"auto"};class Yf{constructor(t){var i;this._samplePeriod=100,this._currentFrameTime=0,this._frames=0,this._previousSampleTime=0,this._beginFrameTime=0,this._fps=t.initialFps,this._samplePeriod=(i=t.samplePeriod)!==null&&i!==void 0?i:this._samplePeriod,this._currentFrameTime=1e3/t.initialFps,this._nowFn=t.nowFn,this._previousSampleTime=this._nowFn()}start(){this._beginFrameTime=this._nowFn()}end(){this._frames++;const t=this._nowFn();this._currentFrameTime=t-this._beginFrameTime,t>=this._previousSampleTime+this._samplePeriod&&(this._fps=this._frames*1e3/(t-this._previousSampleTime),this._previousSampleTime=t,this._frames=0)}get fps(){return this._fps}get instant(){return 1e3/this._currentFrameTime}}class Nh{constructor(t){var i,r,a;this._onFatalException=()=>{},this._maxFps=1/0,this._lastTime=0,this._elapsed=1,this._scheduledCbs=[],this._totalElapsed=0,this._options=t,this.tick=t.tick,this._lastTime=(i=this.now())!==null&&i!==void 0?i:0,this._maxFps=(r=t.maxFps)!==null&&r!==void 0?r:this._maxFps,this._onFatalException=(a=t.onFatalException)!==null&&a!==void 0?a:this._onFatalException,this.fpsSampler=new Yf({initialFps:60,nowFn:()=>this.now()})}elapsed(){return this._elapsed}now(){return performance.now()}toTestClock(){return new Qf({...this._options,defaultUpdateMs:16.6})}toStandardClock(){return new Uh({...this._options})}setFatalExceptionHandler(t){this._onFatalException=t}schedule(t,i=0,r="preframe"){const a=this._totalElapsed+i;this._scheduledCbs.push([t,a,r])}__runScheduledCbs(t="preframe"){for(let i=this._scheduledCbs.length-1;i>-1;i--)t===this._scheduledCbs[i][2]&&this._scheduledCbs[i][1]<=this._totalElapsed&&(this._scheduledCbs[i][0](this._elapsed),this._scheduledCbs.splice(i,1))}update(t){try{this.fpsSampler.start();const i=this.now();let r=i-this._lastTime||1;const a=1e3/this._maxFps;if(r>=a){let h=0;a!==0&&(h=r%a,r=r-h),r>200&&(r=1),this._elapsed=t||r,this._totalElapsed+=this._elapsed,this.__runScheduledCbs("preframe"),this.tick(t||r),this.__runScheduledCbs("postframe"),a!==0?this._lastTime=i-h:this._lastTime=i,this.fpsSampler.end()}}catch(i){this._onFatalException(i),this.stop()}}}class Uh extends Nh{constructor(t){super(t),this._running=!1}isRunning(){return this._running}start(){if(this._running)return;this._running=!0;const t=()=>{if(this._running)try{this._requestId=window.requestAnimationFrame(t),this.update()}catch(i){throw window.cancelAnimationFrame(this._requestId),i}};t()}stop(){window.cancelAnimationFrame(this._requestId),this._running=!1}}class Qf extends Nh{constructor(t){super({...t}),this._logger=J.getInstance(),this._running=!1,this._currentTime=0,this._updateMs=t.defaultUpdateMs}now(){var t;return(t=this._currentTime)!==null&&t!==void 0?t:0}isRunning(){return this._running}start(){this._running=!0}stop(){this._running=!1}step(t){const i=t??this._updateMs;this._running?(this.update(i),this._currentTime+=i):this._logger.warn("The clock is not running, no step will be performed")}run(t,i){for(let r=0;r<t;r++)this.step(i??this._updateMs)}}var hy=Dt(4296);class qf{constructor(){this._toasterCss=hy.A.toString(),this._isInitialized=!1}_initialize(){this._isInitialized||(this._container=document.createElement("div"),this._container.id="ex-toast-container",document.body.appendChild(this._container),this._isInitialized=!0,this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._toasterCss,document.head.appendChild(this._styleBlock))}dispose(){this._container.parentElement.removeChild(this._container),this._styleBlock.parentElement.removeChild(this._styleBlock),this._isInitialized=!1}_createFragment(t){const i=document.createElement("span");return i.innerText=t,i}toast(t,i,r){this._initialize();const a=document.createElement("div");a.className="ex-toast-message";const h=t.split("[LINK]").map(w=>this._createFragment(w));if(i){const w=document.createElement("a");w.href=i,r?w.innerText=r:w.innerText=i,h.splice(1,0,w)}const d=document.createElement("div");h.forEach(w=>{d.appendChild(w)}),a.appendChild(d);const p=document.createElement("button");p.innerText="x",p.addEventListener("click",()=>{this._container.removeChild(a)}),a.appendChild(p);const m=w=>{if(w.key==="Escape")try{this._container.removeChild(a)}catch{}document.removeEventListener("keydown",m)};document.addEventListener("keydown",m);const y=this._container.firstChild;this._container.insertBefore(a,y)}}const cy={NavigationStart:"navigationstart",Navigation:"navigation",NavigationEnd:"navigationend"};class Zf{get isTransitioning(){return this._isTransitioning}constructor(t,i){this._engine=t,this.events=new v,this._logger=J.getInstance(),this._initialized=!1,this.scenes={},this._sceneToInstance=new Map,this._sceneToLoader=new Map,this._sceneToTransition=new Map,this._loadedScenes=new Set,this._isTransitioning=!1,this.rootScene=this.currentScene=new Ke,this.add("root",this.rootScene),this.currentScene=this.rootScene,this.currentSceneName="root";for(const r in i){const a=i[r];this.add(r,a),r==="root"&&(this.rootScene=this.getSceneInstance("root"),this.currentScene=this.rootScene)}}async onInitialize(){if(!this._initialized)if(this._initialized=!0,this._deferredGoto){const t=this._deferredGoto,i=this._deferredTransition;this._deferredGoto=null,this._deferredTransition=null,await this.swapScene(t),i&&await this.playTransition(i)}else await this.swapScene("root")}get isInitialized(){return this._initialized}configureStart(t,i){const r=i==null?void 0:i.loader;r instanceof xr?this.mainLoader=r:vh(r)?this.mainLoader=new r:this.mainLoader=new Us;let a;if(i){const{inTransition:h}=i;a=h}this.startScene=t,a?this.swapScene(this.startScene).then(()=>{this.playTransition(a)}):this.swapScene(this.startScene),this.currentSceneName=this.startScene}_getLoader(t){return this._sceneToLoader.get(t)}_getInTransition(t){var i;const r=this.scenes[t];return r instanceof Ke||Mi(r)?null:(i=r==null?void 0:r.transitions)===null||i===void 0?void 0:i.in}_getOutTransition(t){var i;const r=this.scenes[t];return r instanceof Ke||Mi(r)?null:(i=r==null?void 0:r.transitions)===null||i===void 0?void 0:i.out}getDeferredScene(){const t=this.getSceneDefinition(this._deferredGoto);return this._deferredGoto&&t?t:null}getSceneDefinition(t){const i=this.scenes[t];if(i instanceof Ke||Mi(i))return i;if(i)return i.scene}getSceneName(t){for(const[i,r]of Object.entries(this.scenes))if(r instanceof Ke){if(t===r)return i}else if(!Mi(r)&&t===r.scene)return i;for(const[i,r]of Object.entries(this.scenes))if(Mi(r)){if(t.constructor===r)return i}else if(!(r instanceof Ke)&&t.constructor===r.scene)return i;return null}assertAdded(t){return this}assertRemoved(t){return this}add(t,i){if(!(i instanceof Ke)&&!Mi(i)){const{loader:r,transitions:a}=i,{in:h,out:d}=a??{};this._sceneToTransition.set(t,{in:h,out:d}),vh(r)?this._sceneToLoader.set(t,new r):this._sceneToLoader.set(t,r)}return this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=i,this.assertAdded(t)}remove(t){if(t instanceof Ke||Mi(t)){const i=t;for(const r in this.scenes)if(this.scenes.hasOwnProperty(r)){const a=this.scenes[r];let h;if(a instanceof Ke||Mi(a)?h=a:h=a.scene,h===i){if(r===this.currentSceneName)throw new Error(`Cannot remove a currently active scene: ${r}`);this._sceneToInstance.delete(r),this._sceneToTransition.delete(r),this._sceneToLoader.delete(r),delete this.scenes[r]}}}if(typeof t=="string"){if(t===this.currentSceneName)throw new Error(`Cannot remove a currently active scene: ${t}`);this._sceneToInstance.delete(t),this._sceneToTransition.delete(t),this._sceneToLoader.delete(t),delete this.scenes[t]}}async goto(t,i){var r,a,h,d,p,m;const y=this.getSceneInstance(t);if(!y){this._logger.warn(`Scene ${t} does not exist! Check the name, are you sure you added it?`);return}const w=this.currentSceneName,b=(a=(r=this._engine.input)===null||r===void 0?void 0:r.enabled)!==null&&a!==void 0?a:!0;this._isTransitioning=!0;const R=(h=this.getSceneInstance(w))===null||h===void 0?void 0:h.onTransition("out"),k=y==null?void 0:y.onTransition("in");i={sourceOut:(d=this._getOutTransition(this.currentSceneName))!==null&&d!==void 0?d:R,destinationIn:(p=this._getInTransition(t))!==null&&p!==void 0?p:k,...i};const{sourceOut:M,destinationIn:z,sceneActivationData:X}=i,N=M??this._getOutTransition(this.currentSceneName),U=z??this._getInTransition(t),$=(N==null?void 0:N.hideLoader)||(U==null?void 0:U.hideLoader);$&&this.maybeLoadScene(t,$),this._emitEvent("navigationstart",w,t),await this.playTransition(N),await this.maybeLoadScene(t,$),await(U==null?void 0:U.onPreviousSceneDeactivate(this.currentScene)),await this.swapScene(t,X),this._emitEvent("navigation",w,t),await this.playTransition(U),this._emitEvent("navigationend",w,t),(m=this._engine.input)===null||m===void 0||m.toggleEnabled(b),this._isTransitioning=!1}getSceneInstance(t){const i=this.getSceneDefinition(t);if(!i)return;if(this._sceneToInstance.has(t))return this._sceneToInstance.get(t);if(i instanceof Ke)return this._sceneToInstance.set(t,i),i;const r=new i;return this._sceneToInstance.set(t,r),r}async maybeLoadScene(t,i=!1){var r;const a=(r=this._getLoader(t))!==null&&r!==void 0?r:new xr,h=this.getSceneDefinition(t),d=this.getSceneInstance(t);h&&d&&!this._loadedScenes.has(d)&&(d.onPreLoad(a),d.events.emit("preload",{loader:a}),i?this._engine.load(a,i):await this._engine.load(a),this._loadedScenes.add(d))}async playTransition(t){var i,r,a,h,d,p,m;if(!this.isInitialized){this._deferredTransition=t;return}if(t){this.currentTransition=t;const y=this._engine.currentScene,w=(r=(i=y.input)===null||i===void 0?void 0:i.enabled)!==null&&r!==void 0?r:!0;(a=y.input)===null||a===void 0||a.toggleEnabled(!t.blockInput),(h=this._engine.input)===null||h===void 0||h.toggleEnabled(!t.blockInput),await this.currentTransition.play(this._engine),(d=y.input)===null||d===void 0||d.toggleEnabled(w)}(p=this.currentTransition)===null||p===void 0||p.kill(),(m=this.currentTransition)===null||m===void 0||m.reset(),this.currentTransition=null}async swapScene(t,i){const r=this._engine;if(!this.isInitialized){this._deferredGoto=t;return}const a=this.getSceneInstance(t);if(a){const h=this.currentScene,d=a;if(this._logger.debug("Going to scene:",t),this.currentScene.isInitialized){const y={engine:r,previousScene:h,nextScene:d};await this.currentScene._deactivate(y),this.currentScene.events.emit("deactivate",new ch(y,this.currentScene))}const p=this._sceneToLoader.get(t);await(p==null?void 0:p.areResourcesLoaded()),this.currentScene=d,this.currentSceneName=t,r.screen.setCurrentCamera(d.camera),await this.currentScene._initialize(r);const m={engine:r,previousScene:h,nextScene:d,data:i};await this.currentScene._activate(m),this.currentScene.events.emit("activate",new hh(m,this.currentScene))}else this._logger.error("Scene",t,"does not exist!")}_emitEvent(t,i,r){const a=this.getSceneDefinition(i),h=this.getSceneDefinition(r);this.events.emit(t,{sourceScene:a,sourceName:i,destinationScene:h,destinationName:r})}}function uy(){const u={scope:(t,i)=>(u.value=t,i()),value:void 0};return u}function dy(u){return u.value}c();const fy={FallbackGraphicsContext:"fallbackgraphicscontext",Initialize:"initialize",Visible:"visible",Hidden:"hidden",Start:"start",Stop:"stop",PreUpdate:"preupdate",PostUpdate:"postupdate",PreFrame:"preframe",PostFrame:"postframe",PreDraw:"predraw",PostDraw:"postdraw"};var hs;(function(u){u[u.None=0]="None",u[u.Canvas=1]="Canvas",u[u.All=2]="All"})(hs||(hs={}));class Re{static useEngine(){const t=dy(Re.Context);if(!t)throw new Error("Cannot inject engine with `useEngine()`, `useEngine()` was called outside of Engine lifecycle scope.");return t}get canvasWidth(){return this.screen.canvasWidth}get halfCanvasWidth(){return this.screen.halfCanvasWidth}get canvasHeight(){return this.screen.canvasHeight}get halfCanvasHeight(){return this.screen.halfCanvasHeight}get drawWidth(){return this.screen.drawWidth}get halfDrawWidth(){return this.screen.halfDrawWidth}get drawHeight(){return this.screen.drawHeight}get halfDrawHeight(){return this.screen.halfDrawHeight}get isHiDpi(){return this.screen.isHiDpi}get stats(){return this.debug.stats}get currentScene(){return this.director.currentScene}get currentSceneName(){return this.director.currentSceneName}get rootScene(){return this.director.rootScene}get scenes(){return this.director.scenes}get isFullscreen(){return this.screen.isFullScreen}get displayMode(){return this.screen.displayMode}get pixelRatio(){return this.screen.pixelRatio}get isDebug(){return this._isDebug}get snapToPixel(){return this.graphicsContext.snapToPixel}set snapToPixel(t){this.graphicsContext.snapToPixel=t}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}constructor(t){var i,r,a,h,d,p,m,y;this.scope=$=>Re.Context.scope(this,$),this.version=Gh,this.events=new v,this.maxFps=Number.POSITIVE_INFINITY,this._inputEnabled=!0,this._suppressPlayButton=!1,this.pauseAudioWhenHidden=!0,this._isDebug=!1,this.enableCanvasTransparency=!0,this.onFatalException=$=>{J.getInstance().fatal($,$.stack)},this._toaster=new qf,this._timescale=1,this._isInitialized=!1,this._originalOptions={},this._handleWebGLContextLost=$=>{var W;$.preventDefault(),this.clock.stop(),this._logger.fatalOnce("WebGL Graphics Lost",$);const tt=document.createElement("div");tt.id="ex-webgl-graphics-context-lost",tt.style.position="absolute",tt.style.zIndex="99",tt.style.left="50%",tt.style.top="50%",tt.style.display="flex",tt.style.flexDirection="column",tt.style.transform="translate(-50%, -50%)",tt.style.backgroundColor="white",tt.style.padding="10px",tt.style.borderStyle="solid 1px";const pt=document.createElement("div");if(pt.innerHTML=`
      <h1>There was an issue rendering, please refresh the page.</h1>
      <div>
        <p>WebGL Graphics Context Lost</p>

        <button id="ex-webgl-graphics-reload">Refresh Page</button>

        <p>There are a few reasons this might happen:</p>
        <ul>
          <li>Two or more pages are placing a high demand on the GPU</li>
          <li>Another page or operation has stalled the GPU and the browser has decided to reset the GPU</li>
          <li>The computer has multiple GPUs and the user has switched between them</li>
          <li>Graphics driver has crashed or restarted</li>
          <li>Graphics driver was updated</li>
        </ul>
      </div>
    `,tt.appendChild(pt),!((W=this.canvas)===null||W===void 0)&&W.parentElement){this.canvas.parentElement.appendChild(tt);const Q=pt.querySelector("#ex-webgl-graphics-reload");Q==null||Q.addEventListener("click",()=>location.reload())}},this._performanceThresholdTriggered=!1,this._fpsSamples=[],this._disposed=!1,this._isLoading=!1,this._hideLoader=!1,this._isReadyFuture=new _,this.currentFrameElapsedMs=0,this.currentFrameLagMs=0,this._lagMs=0,this._screenShotRequests=[],t={...Re._DEFAULT_ENGINE_OPTIONS,...t},this._originalOptions=t,f.freeze(),this.browser=new Gf(window,document);const w=new Gd;if(!t.suppressMinimumBrowserFeatureDetection&&!(this._compatible=w.test())){const $=document.createElement("div");if($.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild($),w.failedTests.forEach(function(W){const tt=document.createElement("div");tt.innerText="Browser feature missing "+W,document.body.appendChild(tt)}),t.canvasElementId){const W=document.getElementById(t.canvasElementId);W&&W.parentElement.removeChild(W)}return}else this._compatible=!0;if(console.log&&!t.suppressConsoleBootMessage&&(console.log(`%cPowered by Excalibur.js (v${Gh})`,"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log(`
      /| ________________
O|===|* >________________>
      \\|`),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(this._suppressPlayButton=!0),this._logger=J.getInstance(),this._logger.defaultLevel===at.Debug&&w.logBrowserFeatures(),this._logger.debug("Building engine..."),this.canvasElementId=t.canvasElementId,t.canvasElementId){if(this._logger.debug("Using Canvas element specified: "+t.canvasElementId),document.getElementById(t.canvasElementId)===null)throw new Error("Cannot find existing element in the DOM, please ensure element is created prior to engine creation.");this.canvas=document.getElementById(t.canvasElementId)}else t.canvasElement?(this._logger.debug("Using Canvas element specified:",t.canvasElement),this.canvas=t.canvasElement):(this._logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));let b=(i=t.displayMode)!==null&&i!==void 0?i:ee.Fixed;t.width&&t.height||t.viewport?(t.displayMode===void 0&&(b=ee.Fixed),this._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(this._logger.debug("Engine viewport is fit"),b=ee.FitScreen),this._originalDisplayMode=b;let R,k,M,z,X,N;typeof t.antialiasing=="object"?{pixelArtSampler:R,nativeContextAntialiasing:M,multiSampleAntialiasing:N,filtering:X,canvasImageRendering:z}={...t.pixelArt?$f:Xf,...t.antialiasing}:(R=!!t.pixelArt,M=!1,N=t.antialiasing,z=t.antialiasing?"auto":"pixelated",X=t.antialiasing?qt.Blended:qt.Pixel),M&&N&&this._logger.warnOnce("Cannot use antialias setting nativeContextAntialiasing and multiSampleAntialiasing at the same time, they are incompatible settings. If you aren't sure use multiSampleAntialiasing"),t.pixelArt&&(k=.25),(!t.antialiasing||X===qt.Pixel)&&(k=0),k=(a=(r=t.uvPadding)!==null&&r!==void 0?r:k)!==null&&a!==void 0?a:.01;let U=f.isEnabled("use-canvas-context");if(!U)try{this.graphicsContext=new Gi({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,pixelArtSampler:R,antialiasing:M,multiSampleAntialiasing:N,uvPadding:k,powerPreference:t.powerPreference,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting,handleContextLost:(h=t.handleContextLost)!==null&&h!==void 0?h:this._handleWebGLContextLost,handleContextRestored:t.handleContextRestored})}catch($){this._logger.warn(`Excalibur could not load webgl for some reason (${$.message}) and loaded a Canvas 2D fallback. Some features of Excalibur will not work in this mode. 

Read more about this issue at https://excaliburjs.com/docs/performance`),U=!0}U&&(this.graphicsContext=new Lo({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,antialiasing:M,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})),this.screen=new Gl({canvas:this.canvas,context:this.graphicsContext,antialiasing:M,canvasImageRendering:z,browser:this.browser,viewport:(d=t.viewport)!==null&&d!==void 0?d:t.width&&t.height?{width:t.width,height:t.height}:Vl.SVGA,resolution:t.resolution,displayMode:b,pixelRatio:t.suppressHiDPIScaling?1:(p=t.pixelRatio)!==null&&p!==void 0?p:null}),Zt.filtering=X,t.backgroundColor&&(this.backgroundColor=t.backgroundColor.clone()),this.grabWindowFocus=t.grabWindowFocus,this.pointerScope=t.pointerScope,this.maxFps=(m=t.maxFps)!==null&&m!==void 0?m:this.maxFps,this.fixedUpdateFps=(y=t.fixedUpdateFps)!==null&&y!==void 0?y:this.fixedUpdateFps,this.clock=new Uh({maxFps:this.maxFps,tick:this._mainloop.bind(this),onFatalException:$=>this.onFatalException($)}),this.enableCanvasTransparency=t.enableCanvasTransparency,typeof t.physics=="boolean"?this.physics={...Pi,...Sh(),enabled:t.physics}:this.physics={...Pi,...Sh(),...t.physics},this.debug=new Vf(this),this.director=new Zf(this,t.scenes),this._initialize(t),window.___EXCALIBUR_DEVTOOL=this,Re.InstanceCount++}_monitorPerformanceThresholdAndTriggerFallback(){const{allow:t}=this._originalOptions.configurePerformanceCanvas2DFallback;let{threshold:i,showPlayerMessage:r}=this._originalOptions.configurePerformanceCanvas2DFallback;if(i===void 0&&(i=Re._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold),r===void 0&&(r=Re._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage),!f.isEnabled("use-canvas-context")&&t&&this.ready&&!this._performanceThresholdTriggered){this._fpsSamples.length===i.numberOfFrames&&this._fpsSamples.splice(0,1),this._fpsSamples.push(this.clock.fpsSampler.fps);let a=0;for(let d=0;d<this._fpsSamples.length;d++)a+=this._fpsSamples[d];const h=a/this._fpsSamples.length;this._fpsSamples.length===i.numberOfFrames&&h<=i.fps&&(this._performanceThresholdTriggered=!0,this._logger.warn(`Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.
this might mean your browser doesn't have webgl enabled or hardware acceleration is unavailable.

If in Chrome:
  * Visit Settings > Advanced > System, and ensure "Use Hardware Acceleration" is checked.
  * Visit chrome://flags/#ignore-gpu-blocklist and ensure "Override software rendering list" is "enabled"
If in Firefox, visit about:config
  * Ensure webgl.disabled = false
  * Ensure webgl.force-enabled = true
  * Ensure layers.acceleration.force-enabled = true

Read more about this issue at https://excaliburjs.com/docs/performance`),r&&this._toaster.toast("Excalibur is encountering performance issues. It's possible that your browser doesn't have hardware acceleration enabled. Visit [LINK] for more information and potential solutions.","https://excaliburjs.com/docs/performance"),this.useCanvas2DFallback(),this.emit("fallbackgraphicscontext",this.graphicsContext))}}useCanvas2DFallback(){var t,i,r;const a=this.canvas.cloneNode(!1);this.canvas.parentNode.replaceChild(a,this.canvas),this.canvas=a;const h={...this._originalOptions,antialiasing:this.getAntialiasing()},d=this._originalDisplayMode;this.graphicsContext=new Lo({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,antialiasing:h.antialiasing,backgroundColor:h.backgroundColor,snapToPixel:h.snapToPixel,useDrawSorting:h.useDrawSorting}),this.screen&&this.screen.dispose(),this.screen=new Gl({canvas:this.canvas,context:this.graphicsContext,antialiasing:(t=h.antialiasing)!==null&&t!==void 0?t:!0,browser:this.browser,viewport:(i=h.viewport)!==null&&i!==void 0?i:h.width&&h.height?{width:h.width,height:h.height}:Vl.SVGA,resolution:h.resolution,displayMode:d,pixelRatio:h.suppressHiDPIScaling?1:(r=h.pixelRatio)!==null&&r!==void 0?r:null}),this.screen.setCurrentCamera(this.currentScene.camera),this.input.pointers.detach();const p=h&&h.pointerScope===x.Document?document:this.canvas;this.input.pointers=this.input.pointers.recreate(p,this),this.input.pointers.init()}dispose(){this._disposed||(this._disposed=!0,this.stop(),this.input.toggleEnabled(!1),this.canvas.parentNode.removeChild(this.canvas),this.canvas=null,this.screen.dispose(),this.graphicsContext.dispose(),this.graphicsContext=null,Re.InstanceCount--)}isDisposed(){return this._disposed}getWorldBounds(){return this.screen.getWorldBounds()}get timescale(){return this._timescale}set timescale(t){if(t<=0){J.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0.");return}this._timescale=t}addTimer(t){return this.currentScene.addTimer(t)}removeTimer(t){return this.currentScene.removeTimer(t)}addScene(t,i){return this.director.add(t,i),this}removeScene(t){this.director.remove(t)}add(t){if(arguments.length===2){this.director.add(arguments[0],arguments[1]);return}const i=this.director.getDeferredScene();i instanceof Ke?i.add(t):this.currentScene.add(t)}remove(t){t instanceof ge&&this.currentScene.remove(t),(t instanceof Ke||Mi(t))&&this.removeScene(t),typeof t=="string"&&this.removeScene(t)}async goto(t,i){await this.scope(async()=>{await this.director.goto(t,i)})}async goToScene(t,i){await this.scope(async()=>{await this.director.goto(t,i)})}screenToWorldCoordinates(t){return this.screen.screenToWorldCoordinates(t)}worldToScreenCoordinates(t){return this.screen.worldToScreenCoordinates(t)}_initialize(t){var i,r;this.pageScrollPreventionMode=t.scrollPreventionMode;const a=t&&t.pointerScope===x.Document?document:this.canvas,h=(r=(i=this._originalOptions)===null||i===void 0?void 0:i.grabWindowFocus)!==null&&r!==void 0?r:!0;this.input=new Lh({pointerTarget:a,grabWindowFocus:h,engine:this}),this.inputMapper=this.input.inputMapper,this.browser.document.on("visibilitychange",()=>{document.visibilityState==="hidden"?(this.events.emit("hidden",new lh(this)),this._logger.debug("Window hidden")):document.visibilityState==="visible"&&(this.events.emit("visible",new ah(this)),this._logger.debug("Window visible"))}),!this.canvasElementId&&!t.canvasElement&&document.body.appendChild(this.canvas)}toggleInputEnabled(t){this._inputEnabled=t,this.input.toggleEnabled(this._inputEnabled)}onInitialize(t){}setAntialiasing(t){this.screen.antialiasing=t}getAntialiasing(){return this.screen.antialiasing}get isInitialized(){return this._isInitialized}async _overrideInitialize(t){this.isInitialized||(await this.director.onInitialize(),await this.onInitialize(t),this.events.emit("initialize",new bn(t,this)),this._isInitialized=!0)}_update(t){var i;if(this._isLoading){(i=this._loader)===null||i===void 0||i.onUpdate(this,t),this.input.update();return}this.clock.__runScheduledCbs("preupdate"),this._preupdate(t),this.currentScene.update(this,t),this.graphicsContext.updatePostProcessors(t),this.clock.__runScheduledCbs("postupdate"),this._postupdate(t),this.input.update()}_preupdate(t){this.emit("preupdate",new rs(this,t,this)),this.onPreUpdate(this,t)}onPreUpdate(t,i){}_postupdate(t){this.emit("postupdate",new os(this,t,this)),this.onPostUpdate(this,t)}onPostUpdate(t,i){}_draw(t){var i,r;if(this.graphicsContext.beginDrawLifecycle(),this.graphicsContext.clear(),this.clock.__runScheduledCbs("predraw"),this._predraw(this.graphicsContext,t),this._isLoading){this._hideLoader||((i=this._loader)===null||i===void 0||i.canvas.draw(this.graphicsContext,0,0),this.clock.__runScheduledCbs("postdraw"),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle());return}this.graphicsContext.backgroundColor=(r=this.currentScene.backgroundColor)!==null&&r!==void 0?r:this.backgroundColor,this.currentScene.draw(this.graphicsContext,t),this.clock.__runScheduledCbs("postdraw"),this._postdraw(this.graphicsContext,t),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle(),this._checkForScreenShots()}_predraw(t,i){this.emit("predraw",new wn(t,i,this)),this.onPreDraw(t,i)}onPreDraw(t,i){}_postdraw(t,i){this.emit("postdraw",new xn(t,i,this)),this.onPostDraw(t,i)}onPostDraw(t,i){}showDebug(t){this._isDebug=t}toggleDebug(){return this._isDebug=!this._isDebug,this._isDebug}get loadingComplete(){return!this._isLoading}get ready(){return this._isReadyFuture.isCompleted}isReady(){return this._isReadyFuture.promise}async start(t,i){await this.scope(async()=>{if(!this._compatible)throw new Error("Excalibur is incompatible with your browser");this._isLoading=!0;let r;return t instanceof xr?r=t:typeof t=="string"&&(this.director.configureStart(t,i),r=this.director.mainLoader),this._logger.debug("Starting game clock..."),this.browser.resume(),this.clock.start(),this._logger.debug("Game clock started"),await this.load(r??new Us),await this._overrideInitialize(this),this._isReadyFuture.resolve(),this.emit("start",new Ql(this)),this._isReadyFuture.promise})}_mainloop(t){this.scope(()=>{this.emit("preframe",new eh(this,this.stats.prevFrame));const i=t*this.timescale;this.currentFrameElapsedMs=i;const r=this.stats.prevFrame.id+1;this.stats.currFrame.reset(),this.stats.currFrame.id=r,this.stats.currFrame.delta=i,this.stats.currFrame.fps=this.clock.fpsSampler.fps,Bt.clear();const a=this.clock.now(),h=1e3/this.fixedUpdateFps;if(this.fixedUpdateFps)for(this._lagMs+=i;this._lagMs>=h;)this._update(h),this._lagMs-=h;else this._update(i);const d=this.clock.now();this.currentFrameLagMs=this._lagMs,this._draw(i);const p=this.clock.now();this.stats.currFrame.duration.update=d-a,this.stats.currFrame.duration.draw=p-d,this.stats.currFrame.graphics.drawnImages=Bt.DrawnImagesCount,this.stats.currFrame.graphics.drawCalls=Bt.DrawCallCount,this.emit("postframe",new ih(this,this.stats.currFrame)),this.stats.prevFrame.reset(this.stats.currFrame),this._monitorPerformanceThresholdAndTriggerFallback()})}stop(){this.clock.isRunning()&&(this.emit("stop",new ql(this)),this.browser.pause(),this.clock.stop(),this._logger.debug("Game stopped"))}isRunning(){return this.clock.isRunning()}screenshot(t=!1){return new Promise(r=>{this._screenShotRequests.push({preserveHiDPIResolution:t,resolve:r})})}_checkForScreenShots(){for(const t of this._screenShotRequests){const i=t.preserveHiDPIResolution?this.canvas.width:this.screen.resolution.width,r=t.preserveHiDPIResolution?this.canvas.height:this.screen.resolution.height,a=document.createElement("canvas");a.width=i,a.height=r;const h=a.getContext("2d");h.imageSmoothingEnabled=this.screen.antialiasing,h.drawImage(this.canvas,0,0,i,r);const d=new Image,p=a.toDataURL("image/png");d.src=p,t.resolve(d)}this._screenShotRequests.length=0}async load(t,i=!1){await this.scope(async()=>{try{if(t.isLoaded())return;this._loader=t,this._isLoading=!0,this._hideLoader=i,t instanceof Us&&(t.suppressPlayButton=t.suppressPlayButton||this._suppressPlayButton),this._loader.onInitialize(this),await t.load()}catch(r){this._logger.error("Error loading resources, things may not behave properly",r),await Promise.resolve()}finally{this._isLoading=!1,this._hideLoader=!1,this._loader=null}})}}Re.Context=uy(),Re.InstanceCount=0,Re._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,useDrawSorting:!0,configurePerformanceCanvas2DFallback:{allow:!1,showPlayerMessage:!1,threshold:{fps:20,numberOfFrames:100}},canvasElementId:"",canvasElement:void 0,snapToPixel:!1,antialiasing:!0,pixelArt:!1,powerPreference:"high-performance",pointerScope:x.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,grabWindowFocus:!0,scrollPreventionMode:hs.Canvas,backgroundColor:G.fromHex("#2185d0")};class py{constructor(){this._handlers={},this._wiredEventDispatchers=[],this._deferedHandlerRemovals=[]}clear(){this._handlers={},this._wiredEventDispatchers=[]}_processDeferredHandlerRemovals(){for(const t of this._deferedHandlerRemovals)this._removeHandler(t.name,t.handler);this._deferedHandlerRemovals.length=0}emit(t,i){if(this._processDeferredHandlerRemovals(),!t)return;t=t.toLowerCase(),(typeof i>"u"||i===null)&&(i=new mt);let r,a;if(this._handlers[t])for(r=0,a=this._handlers[t].length,r;r<a;r++)this._handlers[t][r](i);for(r=0,a=this._wiredEventDispatchers.length,r;r<a;r++)this._wiredEventDispatchers[r].emit(t,i)}on(t,i){this._processDeferredHandlerRemovals(),t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(i)}off(t,i){this._deferedHandlerRemovals.push({name:t,handler:i})}_removeHandler(t,i){t=t.toLowerCase();const r=this._handlers[t];if(r)if(!i)this._handlers[t].length=0;else{const a=r.indexOf(i);a>-1&&this._handlers[t].splice(a,1)}}once(t,i){this._processDeferredHandlerRemovals();const r=a=>{const h=a||new mt;this.off(t,r),i(h)};this.on(t,r)}wire(t){t._wiredEventDispatchers.push(this)}unwire(t){const i=t._wiredEventDispatchers.indexOf(this);i>-1&&t._wiredEventDispatchers.splice(i,1)}}class gy extends Oe{get font(){return this._font}set font(t){this._font=t,this._text.font=t}get text(){return this._text.text}set text(t){this._text.text=t}get color(){return this._text.color}set color(t){this._text&&(this._text.color=t)}get opacity(){return this._text.opacity}set opacity(t){this._text.opacity=t}get spriteFont(){return this._spriteFont}set spriteFont(t){t&&(this._spriteFont=t,this._text.font=this._spriteFont)}constructor(t){super(t),this._font=new Vs,this._text=new Ar({text:"",font:this._font});const{text:i,pos:r,x:a,y:h,spriteFont:d,font:p,color:m}={text:"",...t};this.pos=r??(a&&h?B(a,h):this.pos),this.text=i??this.text,this.font=p??this.font,this.spriteFont=d??this.spriteFont,this._text.color=m??this.color;const y=this.get(ne);y.anchor=E.Zero,y.use(this._text)}_initialize(t){super._initialize(t)}getTextWidth(){return this._text.width}}class Kf extends ge{getGraphics(){return this._graphics}addGraphic(t,i){this._graphics.push(t),this._gfx.visible=this.map.visible,this._gfx.opacity=this.map.opacity,i!=null&&i.offset&&(this._gfx.offset=i.offset),this._gfx.localBounds=this._recalculateBounds()}_recalculateBounds(){let t=this._tileBounds.clone();for(const i of this._graphics){const r=B(this.map.graphicsOffset.x-this.map.tileWidth/2,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:i.height-this.map.tileHeight));t=t.combine(i.localBounds.translate(r))}return t}removeGraphic(t){const i=this._graphics.indexOf(t);i>-1&&this._graphics.splice(i,1),this._gfx.localBounds=this._recalculateBounds()}clearGraphics(){this._graphics.length=0,this._gfx.visible=!1,this._gfx.localBounds=this._recalculateBounds()}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const i=this._colliders.indexOf(t);i>-1&&this._colliders.splice(i,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}get pos(){return this.map.tileToWorld(B(this.x,this.y))}get center(){return this.pos.add(B(0,this.map.tileHeight/2))}constructor(t,i,r,a){super([new it,new ne({offset:r??E.Zero,onPostDraw:(R,k)=>this.draw(R,k)}),new Rr(a)]),this.solid=!1,this.events=new v,this._tileBounds=new et,this._graphics=[],this._colliders=[],this.data=new Map,this.x=t,this.y=i,this.map=a,this._transform=this.get(it),this._isometricEntityComponent=this.get(Rr);const h=this.map.tileWidth/2,d=this.map.tileHeight/2,p=(this.x-this.y)*h,m=(this.x+this.y)*d;this._transform.pos=B(p,m),this._isometricEntityComponent.elevation=a.elevation,this._gfx=this.get(ne),this._gfx.visible=!1;const y=this.map.tileWidth,w=this.map.tileHeight,b=B(0,this.map.renderFromTopOfGraphic?w:0);this._gfx.localBounds=this._tileBounds=new et({left:-y/2,top:-w,right:y/2,bottom:w}).translate(b)}draw(t,i){const r=this.map.tileWidth/2;t.save(),t.translate(-r,0);for(const a of this._graphics)a.draw(t,this.map.graphicsOffset.x,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:a.height-this.map.tileHeight));t.restore()}}class my extends ge{constructor(t){super([new it,new ht({type:ut.Fixed}),new Wt,new Di,new sa((w,b)=>this.debug(w,b),!1)],t.name),this.elevation=0,this.visible=!0,this.opacity=1,this.renderFromTopOfGraphic=!1,this.graphicsOffset=B(0,0),this._forwardPointerEventToTile=w=>b=>{const R=this.getTileByPoint(b.worldPos);R&&R.events.emit(w,b)},this._collidersDirty=!1,this._originalOffsets=new WeakMap;const{pos:i,tileWidth:r,tileHeight:a,columns:h,rows:d,renderFromTopOfGraphic:p,graphicsOffset:m,elevation:y}=t;this.transform=this.get(it),i&&(this.transform.pos=i),this.collider=this.get(Wt),this.collider&&this.collider.set(this._composite=new de([])),this.pointer=this.get(Di),this.renderFromTopOfGraphic=p??this.renderFromTopOfGraphic,this.graphicsOffset=m??this.graphicsOffset,this.elevation=y??this.elevation,this.tileWidth=r,this.tileHeight=a,this.columns=h,this.rows=d,this.tiles=new Array(h*d);for(let w=0;w<d;w++)for(let b=0;b<h;b++){const R=new Kf(b,w,this.graphicsOffset,this);this.tiles[b+w*h]=R,this.addChild(R)}this.pointer.localBounds=et.fromDimension(r*h*this.transform.scale.x,a*d*this.transform.scale.y,B(.5,0)),this._setupPointerToTile()}_setupPointerToTile(){this.events.on("pointerup",this._forwardPointerEventToTile("pointerup")),this.events.on("pointerdown",this._forwardPointerEventToTile("pointerdown")),this.events.on("pointermove",this._forwardPointerEventToTile("pointermove")),this.events.on("pointercancel",this._forwardPointerEventToTile("pointercancel"))}update(){this._collidersDirty&&(this.updateColliders(),this._collidersDirty=!1)}flagCollidersDirty(){this._collidersDirty=!0}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const i=t.offset;return this._originalOffsets.set(t,i),i}}updateColliders(){this._composite.clearColliders();const t=this.get(it).pos;for(const i of this.tiles)if(i.solid)for(const r of i.getColliders()){const a=this._getOrSetColliderOriginalOffset(r);r.offset=this.tileToWorld(B(i.x,i.y)).sub(t).add(a).sub(B(this.tileWidth/2,this.tileHeight)),r.owner=this,this._composite.addCollider(r)}this.collider.update()}worldToTile(t){t=t.sub(this.transform.globalPos);const i=this.tileWidth/2,r=this.tileHeight/2;return B(~~((t.x/i+t.y/r)/2),~~((t.y/r-t.x/i)/2))}tileToWorld(t){const i=this.tileWidth/2,r=this.tileHeight/2,a=(t.x-t.y)*i,h=(t.x+t.y)*r;return B(a,h).add(this.transform.pos)}getTile(t,i){return t<0||i<0||t>=this.columns||i>=this.rows?null:this.tiles[t+i*this.columns]}getTileByPoint(t){const i=this.worldToTile(t);return this.getTile(i.x,i.y)}_getMaxZIndex(){let t=Number.NEGATIVE_INFINITY;for(const i of this.tiles){const r=i.get(it).z;r>t&&(t=r)}return t}debug(t,i){const{showAll:r,showPosition:a,positionColor:h,positionSize:d,showGrid:p,gridColor:m,gridWidth:y,showColliderGeometry:w}=i.isometric,{geometryColor:b,geometryLineWidth:R,geometryPointSize:k}=i.collider;if(t.save(),t.z=this._getMaxZIndex()+.5,r||p){for(let M=0;M<this.rows+1;M++){const z=this.tileToWorld(B(0,M)),X=this.tileToWorld(B(this.columns,M));t.drawLine(z,X,m,y)}for(let M=0;M<this.columns+1;M++){const z=this.tileToWorld(B(M,0)),X=this.tileToWorld(B(M,this.rows));t.drawLine(z,X,m,y)}}if(r||a)for(const M of this.tiles)t.drawCircle(this.tileToWorld(B(M.x,M.y)),d,h);if(r||w){for(const M of this.tiles)if(M.solid)for(const z of M.getColliders())z.debug(t,b,{lineWidth:R,pointSize:k})}t.restore()}}class zh{constructor(t,i){this._stopped=!1,this._sequenceBuilder=i,this._sequenceContext=new Er(t),this._actionQueue=this._sequenceContext.getQueue(),this._sequenceBuilder(this._sequenceContext)}update(t){this._actionQueue.update(t)}isComplete(){return this._stopped||this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._stopped=!1,this._actionQueue.reset()}clone(t){return new zh(t,this._sequenceBuilder)}}class _y{constructor(t){this._actions=t}update(t){for(let i=0;i<this._actions.length;i++)this._actions[i].update(t)}isComplete(t){return this._actions.every(i=>i.isComplete(t))}reset(){this._actions.forEach(t=>t.reset())}stop(){this._actions.forEach(t=>t.stop())}}class Fn{constructor(t,i){this.bounds=t,this.options=i,this._defaultOptions={maxDepth:10,capacity:10,level:0},this.items=[],this._isDivided=!1,this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null,this.options={...this._defaultOptions,...i},this.halfWidth=t.width/2,this.halfHeight=t.height/2}_split(){this._isDivided=!0;const t={maxDepth:this.options.maxDepth,capacity:this.options.capacity,level:this.options.level+1};this.topLeft=new Fn(new et({left:this.bounds.left,top:this.bounds.top,right:this.bounds.left+this.halfWidth,bottom:this.bounds.top+this.halfHeight}),t),this.topRight=new Fn(new et({left:this.bounds.left+this.halfWidth,top:this.bounds.top,right:this.bounds.right,bottom:this.bounds.top+this.halfHeight}),t),this.bottomLeft=new Fn(new et({left:this.bounds.left,top:this.bounds.top+this.halfHeight,right:this.bounds.left+this.halfWidth,bottom:this.bounds.bottom}),t),this.bottomRight=new Fn(new et({left:this.bounds.left+this.halfWidth,top:this.bounds.top+this.halfHeight,right:this.bounds.right,bottom:this.bounds.bottom}),t)}_insertIntoSubNodes(t){var i,r,a,h;!((i=this.topLeft)===null||i===void 0)&&i.bounds.overlaps(t.bounds)&&this.topLeft.insert(t),!((r=this.topRight)===null||r===void 0)&&r.bounds.overlaps(t.bounds)&&this.topRight.insert(t),!((a=this.bottomLeft)===null||a===void 0)&&a.bounds.overlaps(t.bounds)&&this.bottomLeft.insert(t),!((h=this.bottomRight)===null||h===void 0)&&h.bounds.overlaps(t.bounds)&&this.bottomRight.insert(t)}insert(t){if(this._isDivided){this._insertIntoSubNodes(t);return}if(this.items.push(t),this.items.length>this.options.capacity&&this.options.level<this.options.maxDepth){this._isDivided||this._split();for(const i of this.items)this._insertIntoSubNodes(i);this.items.length=0}}remove(t){var i,r,a,h;if(this.bounds.overlaps(t.bounds)){if(!this._isDivided){const d=this.items.indexOf(t);d>-1&&this.items.splice(d,1);return}!((i=this.topLeft)===null||i===void 0)&&i.bounds.overlaps(t.bounds)&&this.topLeft.remove(t),!((r=this.topRight)===null||r===void 0)&&r.bounds.overlaps(t.bounds)&&this.topRight.remove(t),!((a=this.bottomLeft)===null||a===void 0)&&a.bounds.overlaps(t.bounds)&&this.bottomLeft.remove(t),!((h=this.bottomRight)===null||h===void 0)&&h.bounds.overlaps(t.bounds)&&this.bottomRight.remove(t)}}query(t){let i=this.items;return this._isDivided&&(this.topLeft.bounds.overlaps(t)&&(i=i.concat(this.topLeft.query(t))),this.topRight.bounds.overlaps(t)&&(i=i.concat(this.topRight.query(t))),this.bottomLeft.bounds.overlaps(t)&&(i=i.concat(this.bottomLeft.query(t))),this.bottomRight.bounds.overlaps(t)&&(i=i.concat(this.bottomRight.query(t)))),i=i.filter((r,a)=>i.indexOf(r)>=a),i}clear(){this.items=[],this._isDivided=!1,this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null}getAllItems(){let t=this.items;return this._isDivided&&(t=t.concat(this.topLeft.getAllItems()),t=t.concat(this.topRight.getAllItems()),t=t.concat(this.bottomLeft.getAllItems()),t=t.concat(this.bottomRight.getAllItems())),t=t.filter((i,r)=>t.indexOf(i)>=r),t}getTreeDepth(){return this._isDivided?1+Math.max(this.topLeft.getTreeDepth(),this.topRight.getTreeDepth(),this.bottomLeft.getTreeDepth(),this.bottomRight.getTreeDepth()):0}debug(t){this.bounds.draw(t,G.Yellow),this._isDivided&&(this.topLeft.bounds.draw(t,G.Yellow),this.topRight.bounds.draw(t,G.Yellow),this.bottomLeft.bounds.draw(t,G.Yellow),this.bottomRight.bounds.draw(t,G.Yellow))}}function vy(u){return!!u._initialize}function yy(u){return!!u.onInitialize}function wy(u){return!!u._preupdate}function xy(u){return!!u.onPreUpdate}function by(u){return!!u.onPostUpdate}function Cy(u){return!!u.onPostUpdate}function Sy(u){return!!u.onPreDraw}function Ey(u){return!!u.onPostDraw}class Ay{constructor(t,i=G.Magenta,r=!1){this.path=t,this.color=i,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new Ft(t,"arraybuffer",r),this._transparentColor=i}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){const t=await this._resource.load();this._stream=new Jf(t),this._gif=new tp(this._stream,this._transparentColor);const i=this._gif.images.map(r=>new _n(r.src,!1));return await Promise.all(i.map(r=>r.load())),this.data=this._textures=i}isLoaded(){return!!this.data}toSprite(t=0){return this._textures[t].toSprite()}toSpriteSheet(){const t=this._textures.map(i=>i.toSprite());return new Bs({sprites:t})}toAnimation(t){const i=this.toSpriteSheet(),r=i.sprites.length;return this._animation=Ii.fromSpriteSheet(i,H(0,r),t),this._animation}get readCheckBytes(){return this._gif.checkBytes}}const la=u=>u.reduce(function(t,i){return t*2+i},0),Hh=u=>{const t=[];for(let i=7;i>=0;i--)t.push(!!(u&1<<i));return t};class Jf{constructor(t){if(this.data=null,this.len=0,this.position=0,this.readByte=()=>{if(this.position>=this.data.byteLength)throw new Error("Attempted to read past end of stream.");return this.data[this.position++]},this.readBytes=i=>{const r=[];for(let a=0;a<i;a++)r.push(this.readByte());return r},this.read=i=>{let r="";for(let a=0;a<i;a++)r+=String.fromCharCode(this.readByte());return r},this.readUnsigned=()=>{const i=this.readBytes(2);return(i[1]<<8)+i[0]},this.data=new Uint8Array(t),this.len=this.data.byteLength,this.len===0)throw new Error("No data loaded from file")}}const Ty=function(u,t){let i=0;const r=function(R){let k=0;for(let M=0;M<R;M++)t.charCodeAt(i>>3)&1<<(i&7)&&(k|=1<<M),i++;return k},a=[],h=1<<u,d=h+1;let p=u+1,m=[];const y=function(){m=[],p=u+1;for(let R=0;R<h;R++)m[R]=[R];m[h]=[],m[d]=null};let w,b;for(;;){if(b=w,w=r(p),w===h){y();continue}if(w===d)break;if(w<m.length)b!==h&&m.push(m[b].concat(m[w][0]));else{if(w!==m.length)throw new Error("Invalid LZW code.");m.push(m[b].concat(m[b][0]))}a.push.apply(a,m[w]),m.length===1<<p&&p<12&&p++}return a};class tp{constructor(t,i=G.Magenta){this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=r=>{const a=[];for(let h=0;h<r;h++){const p="#"+this._st.readBytes(3).map(m=>{const y=m.toString(16);return y.length===1?"0"+y:y}).join("");a.push(p)}return a},this.readSubBlocks=()=>{let r,a;a="";do r=this._st.readByte(),a+=this._st.read(r);while(r!==0);return a},this.parseHeader=()=>{const r={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(r.sig=this._st.read(3),r.ver=this._st.read(3),r.sig!=="GIF")throw new Error("Not a GIF file.");r.width=this._st.readUnsigned(),r.height=this._st.readUnsigned();const a=Hh(this._st.readByte());r.gctFlag=a.shift(),r.colorRes=la(a.splice(0,3)),r.sorted=a.shift(),r.globalColorTableSize=la(a.splice(0,3)),r.bgColor=this._st.readByte(),r.pixelAspectRatio=this._st.readByte(),r.gctFlag&&(r.globalColorTable=this.parseColorTable(1<<r.globalColorTableSize+1),this.globalColorTable=r.globalColorTable),this._handler.hdr&&this._handler.hdr(r)&&this.checkBytes.push(this._handler.hdr)},this.parseExt=r=>{const a=y=>{this.checkBytes.push(this._st.readByte());const w=Hh(this._st.readByte());y.reserved=w.splice(0,3),y.disposalMethod=la(w.splice(0,3)),y.userInput=w.shift(),y.transparencyGiven=w.shift(),y.delayTime=this._st.readUnsigned(),y.transparencyIndex=this._st.readByte(),y.terminator=this._st.readByte(),this._handler.gce&&this._handler.gce(y)&&this.checkBytes.push(this._handler.gce)},h=y=>{y.comment=this.readSubBlocks(),this._handler.com&&this._handler.com(y)&&this.checkBytes.push(this._handler.com)},d=y=>{this.checkBytes.push(this._st.readByte()),y.ptHeader=this._st.readBytes(12),y.ptData=this.readSubBlocks(),this._handler.pte&&this._handler.pte(y)&&this.checkBytes.push(this._handler.pte)},p=y=>{const w=R=>{this.checkBytes.push(this._st.readByte()),R.unknown=this._st.readByte(),R.iterations=this._st.readUnsigned(),R.terminator=this._st.readByte(),this._handler.app&&this._handler.app.NETSCAPE&&this._handler.app.NETSCAPE(R)&&this.checkBytes.push(this._handler.app)},b=R=>{R.appData=this.readSubBlocks(),this._handler.app&&this._handler.app[R.identifier]&&this._handler.app[R.identifier](R)&&this.checkBytes.push(this._handler.app[R.identifier])};switch(this.checkBytes.push(this._st.readByte()),y.identifier=this._st.read(8),y.authCode=this._st.read(3),y.identifier){case"NETSCAPE":w(y);break;default:b(y);break}},m=y=>{y.data=this.readSubBlocks(),this._handler.unknown&&this._handler.unknown(y)&&this.checkBytes.push(this._handler.unknown)};switch(r.label=this._st.readByte(),r.label){case 249:r.extType="gce",a(r);break;case 254:r.extType="com",h(r);break;case 1:r.extType="pte",d(r);break;case 255:r.extType="app",p(r);break;default:r.extType="unknown",m(r);break}},this.parseImg=r=>{const a=(p,m)=>{const y=new Array(p.length),w=p.length/m,b=(z,X)=>{const N=p.slice(X*m,(X+1)*m);y.splice.apply(y,[z*m,m].concat(N))},R=[0,4,2,1],k=[8,8,4,2];let M=0;for(let z=0;z<4;z++)for(let X=R[z];X<w;X+=k[z])b(X,M),M++;return y};r.leftPos=this._st.readUnsigned(),r.topPos=this._st.readUnsigned(),r.width=this._st.readUnsigned(),r.height=this._st.readUnsigned();const h=Hh(this._st.readByte());r.lctFlag=h.shift(),r.interlaced=h.shift(),r.sorted=h.shift(),r.reserved=h.splice(0,2),r.lctSize=la(h.splice(0,3)),r.lctFlag&&(r.lct=this.parseColorTable(1<<r.lctSize+1)),r.lzwMinCodeSize=this._st.readByte();const d=this.readSubBlocks();r.pixels=Ty(r.lzwMinCodeSize,d),r.interlaced&&(r.pixels=a(r.pixels,r.width)),this.frames.push(r),this.arrayToImage(r),this._handler.img&&this._handler.img(r)&&this.checkBytes.push(this._handler)},this.parseBlock=()=>{const r={sentinel:this._st.readByte(),type:""};switch(String.fromCharCode(r.sentinel)){case"!":r.type="ext",this.parseExt(r);break;case",":r.type="img",this.parseImg(r);break;case";":r.type="eof",this._handler.eof&&this._handler.eof(r)&&this.checkBytes.push(this._handler.eof);break;default:throw new Error("Unknown block: 0x"+r.sentinel.toString(16))}r.type!=="eof"&&this.parseBlock()},this.arrayToImage=r=>{let a=0;const h=document.createElement("canvas");h.id=a.toString(),h.width=r.width,h.height=r.height,a++;const d=h.getContext("2d"),p=1;let m=0,y=0;for(let b=0;b<r.pixels.length;b++)y%r.width===0&&(m++,y=0),this.globalColorTable[r.pixels[b]]===this._transparentColor.toHex()?d.fillStyle="rgba(0, 0, 0, 0)":d.fillStyle=this.globalColorTable[r.pixels[b]],d.fillRect(y,m,p,p),y++;const w=new Image;w.src=h.toDataURL(),this.images.push(w)},this._st=t,this._handler={},this._transparentColor=i,this.parseHeader(),this.parseBlock()}}class Py{constructor(t,i,{bustCache:r,...a}={}){this.path=t,this.family=i,this._isLoaded=!1,this._resource=new Ft(t,"blob",r),this._options=a}async load(){if(this.isLoaded())return this.data;try{const t=await this._resource.load(),i=URL.createObjectURL(t);this.data||(this.data=new FontFace(this.family,`url(${i})`),document.fonts.add(this.data)),await this.data.load(),this._isLoaded=!0}catch(t){throw`Error loading FontSource from path '${this.path}' with error [${t.message}]`}return this.data}isLoaded(){return this._isLoaded}toFont(t){return new Vs({family:this.family,...this._options,...t})}}const Ry=/^\s*(?:function)?\*/;function ep(u){return typeof u!="function"?!1:Ry.test(Function.prototype.toString.call(u))?!0:Object.getPrototypeOf?Object.getPrototypeOf(u)===Object.getPrototypeOf(new Function("return function * () {}")()):!1}function ip(...u){let t,i,r,a;ep(u[0])&&(i=globalThis,t=u[0],r=u[1]),ep(u[1])&&(i=u[0],t=u[1],r=u[2]),u[1]instanceof Re&&(i=u[0],a=u[1],t=u[2],r=u[3]),u[0]instanceof Re&&(i=globalThis,a=u[0],t=u[1],r=u[2]);const h=r==null?void 0:r.timing;let d;try{d=a??Re.useEngine()}catch{throw Error(`Cannot run coroutine without engine parameter outside of an excalibur lifecycle method.
Pass an engine parameter to ex.coroutine(engine, function * {...})`)}const p=t.bind(i);return new Promise((m,y)=>{const w=p(),b=R=>{try{const{done:k,value:M}=w.next(R);k&&m(),M instanceof Promise?M.then(()=>{d.clock.schedule(b,0,h)}):M===void 0||M===void 0?d.clock.schedule(b,0,h):d.clock.schedule(b,M||0,h)}catch(k){y(k)}};b(d.clock.elapsed())})}class jh extends ge{get progress(){return this._currentProgress}get complete(){return this.direction==="out"?this.progress>=1:this.progress<=0}constructor(t){var i,r,a,h;super(),this._logger=J.getInstance(),this.transform=new it,this.graphics=new ne,this._completeFuture=new _,this.started=!1,this._currentDistance=0,this._currentProgress=0,this.done=this._completeFuture.promise,this.name=`Transition#${this.id}`,this.duration=t.duration,this.easing=(i=t.easing)!==null&&i!==void 0?i:It.Linear,this.direction=(r=t.direction)!==null&&r!==void 0?r:"out",this.hideLoader=(a=t.hideLoader)!==null&&a!==void 0?a:!1,this.blockInput=(h=t.blockInput)!==null&&h!==void 0?h:!1,this.transform.coordPlane=ie.Screen,this.transform.pos=E.Zero,this.transform.z=1/0,this.graphics.anchor=E.Zero,this.addComponent(this.transform),this.addComponent(this.graphics),this.direction==="out"?this._currentProgress=0:this._currentProgress=1}updateTransition(t,i){this.complete||(this._currentDistance+=L(i/this.duration,0,1),this._currentDistance>=1&&(this._currentDistance=1),this.direction==="out"?this._currentProgress=L(this.easing(this._currentDistance,0,1,1),0,1):this._currentProgress=L(this.easing(this._currentDistance,1,0,1),0,1))}async onPreviousSceneDeactivate(t){}onStart(t){}onUpdate(t){}onEnd(t){}onReset(){}reset(){this.started=!1,this._completeFuture=new _,this.done=this._completeFuture.promise,this._currentDistance=0,this.direction==="out"?this._currentProgress=0:this._currentProgress=1,this.onReset()}play(t,i){this.started&&(this.reset(),this._logger.warn(`Attempted to play a transition ${this.name} that is already playing, reset transition.`)),(i??t.currentScene).add(this);const a=this;return ip(t,function*(){for(;!a.complete;){const h=yield;a.updateTransition(t,h),a.execute()}})}execute(){this.isInitialized&&(this.started||(this.started=!0,this.onStart(this.progress)),this.onUpdate(this.progress),this.complete&&!this._completeFuture.isCompleted&&(this.onEnd(this.progress),this._completeFuture.resolve()))}}class Iy extends jh{constructor(t){var i,r;super({...t,duration:(i=t.duration)!==null&&i!==void 0?i:2e3}),this.name=`FadeInOut#${this.id}`,this.color=(r=t.color)!==null&&r!==void 0?r:G.Black}onInitialize(t){this.transform.pos=t.screen.unsafeArea.topLeft,this.screenCover=new Sr({width:t.screen.resolution.width,height:t.screen.resolution.height,color:this.color}),this.graphics.add(this.screenCover),this.graphics.opacity=this.progress}onReset(){this.graphics.opacity=this.progress}onStart(t){this.graphics.opacity=t}onEnd(t){this.graphics.opacity=t}onUpdate(t){this.graphics.opacity=t}}class Dy extends jh{constructor(t){super({direction:"in",...t}),this.name=`CrossFade#${this.id}`}async onPreviousSceneDeactivate(t){this.image=await t.engine.screenshot(!0),await this.image.decode()}onInitialize(t){this.engine=t,this.transform.pos=t.screen.unsafeArea.topLeft,this.screenCover=_n.fromHtmlImageElement(this.image).toSprite(),this.graphics.add(this.screenCover),this.transform.scale=B(1/t.screen.pixelRatio,1/t.screen.pixelRatio),this.graphics.opacity=this.progress}onStart(t){this.graphics.opacity=this.progress}onReset(){this.graphics.opacity=this.progress}onEnd(t){this.graphics.opacity=t}onUpdate(t){this.graphics.opacity=t}}class Wh extends zt{constructor(t){super(),this.color=G.Black,this.thickness=1;const{start:i,end:r,color:a,thickness:h}=t;this.start=i,this.end=r,this.color=a??this.color,this.thickness=h??this.thickness,this._localBounds=this._calculateBounds();const{width:d,height:p}=this._localBounds;this.width=d,this.height=p}get localBounds(){return this._localBounds}_calculateBounds(){const t=this.end.sub(this.start).normal(),i=this.thickness/2,r=[this.start.add(t.scale(i)),this.end.add(t.scale(i)),this.end.add(t.scale(-i)),this.start.add(t.scale(-i))];return et.fromPoints(r)}_drawImage(t,i,r){t.drawLine(this.start,this.end,this.color,this.thickness)}clone(){return new Wh({start:this.start,end:this.end,color:this.color,thickness:this.thickness})}}class Vh extends yn{get points(){return this._points}set points(t){this._points=t;const i=this.minPoint;this.width=this._points.reduce((r,a)=>Math.max(a.x,r),0)-i.x,this.height=this._points.reduce((r,a)=>Math.max(a.y,r),0)-i.y,this.flagDirty()}get minPoint(){const t=this._points.reduce((r,a)=>Math.min(a.x,r),1/0),i=this._points.reduce((r,a)=>Math.min(a.y,r),1/0);return B(t,i)}constructor(t){super(t),this.points=t.points,this.filtering=qt.Blended,this.rasterize()}clone(){return new Vh({points:this.points.map(t=>t.clone()),...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){if(this.points&&this.points.length){t.beginPath();const i=this.minPoint.negate(),r=this.points[0].add(i);t.moveTo(r.x,r.y),this.points.forEach(a=>{t.lineTo(a.x+i.x,a.y+i.y)}),t.lineTo(r.x,r.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}const sp=5,Bn={},ky=()=>{for(const u in Bn)Bn[u]=0},ha=(u,t)=>{const i=f.isEnabled("suppress-obsolete-message");Bn[u]<sp&&!i&&(J.getInstance().warn(u),console.trace&&t.showStackTrace&&console.trace()),Bn[u]++};function Fy(u){return u={message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrace:!1,...u},function(t,i,r){if(r&&!(typeof r.value=="function"||typeof r.get=="function"||typeof r.set=="function"))throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");const h=`${`${t.name||""}${t.name&&i?".":""}${i||""}`} is marked obsolete: ${u.message}`+(u.alternateMethod?` Use ${u.alternateMethod} instead`:"");Bn[h]||(Bn[h]=0);const d=r?{...r}:t;if(!r){class p extends d{constructor(...y){ha(h,u),super(...y)}}return p}return r&&r.value?(d.value=function(){return ha(h,u),r.value.apply(this,arguments)},d):(r&&r.get&&(d.get=function(){return ha(h,u),r.get.apply(this,arguments)}),r&&r.set&&(d.set=function(){return ha(h,u),r.set.apply(this,arguments)}),d)}}class By{constructor(){this._queue=[]}get length(){return this._queue.length}enqueue(){const t=new _;return this._queue.push(t),t.promise}dequeue(t){this._queue.shift().resolve(t)}}class My{constructor(t){this._count=t,this._waitQueue=new By}get count(){return this._count}get waiting(){return this._waitQueue.length}async enter(){return this._count!==0?(this._count--,Promise.resolve()):this._waitQueue.enqueue()}exit(t=1){if(t!==0){for(;t!==0&&this._waitQueue.length!==0;)this._waitQueue.dequeue(null),t--;this._count+=t}}}const Gh="0.29.3";c()})();C.eKr;C.yVm;C.a7j;C.U_w;C.JF2;C.htg;C.HXL;C.mcg;var Cc=C.Agj;C.u6S;C.x7M;C.X55;C.m3M;C.aE5;C.YJU;C.eZi;C.GNv;C.Y56;C._0v;C.vhs;C.Z8b;C.Yfw;C.IcQ;C.Rl2;C.kgJ;C.GTT;C.ypY;C.i7d;C.fQ3;C.HlI;C.jlt;C.VQc;C.zD7;C.I0I;C.AUF;C.JoF;C.MlA;C.PZh;C.qA;C.CrD;C.dQK;C.D3r;C.Qpo;C.D9n;C.b6v;C.mvh;var Sc=C.Bpo,Ec=C.Q1f;C.IKv;C.fcV;C.Glf;C.uAl;C.ElT;C.MPu;C.Z8r;C.QSL;C.sPV;C.nAn;C.zCU;C.QrV;C.fF9;C.xI8;C.yar;C.SP7;C.oRy;C.f5X;C.V1c;C.Mlx;C.ZCo;C.Vy3;C.J5p;C.mL_;C.Guw;C.VKx;C.N5j;C.pgY;C.OP3;C.rl5;C.eod;var S1=C.q5Z;C.YUC;C.saR;C.hvr;C.Qol;C.Wf4;C.JCs;C.gJV;C.fWD;C.Va_;var E1=C.N$8;C._jQ;C.rxj;C.rhv;C.wCu;C.HAp;C.Zy1;C.Qev;C.bkB;C.wfL;C.sVA;C.$Gs;C.CJ0;C.NWh;C.tWi;C.xAj;C.zWh;C.i_4;C.iIx;C.c9e;C.KQV;C.weH;C.jXp;C.zzY;C.yRQ;C.MtE;C.rPj;C.KLc;C.Fir;C.V5f;C.Xj7;C.Wud;C.FVg;C.g5Y;C.YQB;C.KPb;C.nHK;C.TX_;C.r3n;C.vYh;C.hnk;C.D2R;C.n1o;C.RLG;C.fBU;C.Adb;C.bEs;C.wCy;C.CbD;C.x_C;var A1=C.pde;C.pGf;C.ibQ;C.QlN;C.shR;C.Yjk;C._u1;C.OBI;C.klh;C.s3S;C.D$R;C.xth;C.JU7;C.h9x;C.N1A;C.e_k;C.aHM;C.tlv;C.Vi9;C.ieR;C.$bb;C.VyI;C.imn;C.uqu;C.QnL;C.vnc;C.wk_;C.GH0;C._1r;C.l0X;C.HHX;C.tjk;C.rWe;C.j9l;C.NVp;C.cPK;C.XoL;C.RmF;C.DXI;C.tCD;C.oGn;C.J3D;C.vCJ;C.f9l;C.AQx;C.v9m;C.yRJ;C.EU6;C.m3O;C.Ryz;C.OxP;C.LEs;C.Ec;C.Pi5;C.gmH;C.tS;C.XxX;C.bCz;C.nYS;C.yiT;C.NHl;C.mO8;C.PXI;C.bn5;C.Ywr;C.cMd;C.Bs6;C.G0k;C.pyn;C.QeM;C.aPX;C.ITP;C.BY0;C.MFw;C.sBn;C.S3L;C.XKQ;C.ESI;C.uxz;C.o8N;C.u_r;C.RlV;C.gVA;C.M_G;C.GRB;C.kM6;C.dO8;C.jgM;C.FWq;C.s3j;C.hlw;C.B7e;C.H_X;C.S_d;C.U7E;C.Z58;C.yh2;C.ff$;C.cWi;C.NBt;C.oNz;C.QlU;C.Xey;C.jft;C.Mtr;C.ypk;C.mnM;C.bAZ;C.ABN;C.VK6;C.kxk;C.DT1;C.FLG;C.qN_;C.Z37;C.FtL;C.Z6X;C.iQT;C.ziO;C.OEF;C.uuE;C.tiv;C.T$Y;C.EYj;C.nOB;C.Tap;C.FAs;C.B_P;C.aA5;var T1=C.M4G;C.l$l;C.dLy;C.WZP;C.eB6;C.nFK;C.l9z;C.YOF;C.yhB;C.J0N;C.Miz;C.Bj4;C.Rcs;C.vJ4;C.TqC;C.nM0;C.X1u;C.SpZ;C.DX8;C.Yx$;C.HK4;C.SE$;C.qE8;C.Pz7;C.sX_;C.JuI;C.Nl$;C.OwT;C.P$G;C.mHV;C.Fx_;C.WFC;C.aDq;C.jIg;C.UH3;C.K6X;C.C1Y;C.Aw1;C.A8$;C.hsx;C.l9E;C.aSf;C.Zex;C.mXP;C.vt$;C.hCA;C.pjR;C.U43;C.pSZ;C.y17;C.jVr;C._SZ;C.xWn;C.ehJ;C.t6s;C.Eyn;function P1(){const e=Y.useRef(null),s=Y.useRef(null),[n,o]=Y.useState(!1),l=50,c=50,f=()=>{if(e.current){const _=new E1({canvasElement:e.current,displayMode:S1.FillContainer});s.current=_;const v=new Cc({x:_.drawWidth/2,y:_.drawHeight-l/2,width:_.drawWidth+100,height:l,color:Ec.fromHex("333333")});v.body.collisionType=Sc.Fixed,_.add(v);const x=new Cc({x:100,y:_.drawHeight-l,width:50,height:50,color:Ec.fromHex("ff0000")});x.body.collisionType=Sc.Active,x.body.bounciness=0,_.add(x),_.input.keyboard.on("press",D=>{D.key===A1.Keys.Space&&x.vel.y===0&&(x.vel.y=-600)}),_.on("postupdate",()=>{x.pos.y<_.drawHeight-l-c/2?x.vel.y+=20:(x.vel.y=0,x.pos.y=_.drawHeight-l-c/2)});const S=()=>{const D=new Cc({x:_.drawWidth+50,y:_.drawHeight-l,width:50,height:50,color:Ec.fromHex("0000ff")});D.body.collisionType=Sc.Active,D.vel.x=-200,_.add(D),D.on("exitviewport",()=>{D.pos.x+D.width<0&&_.remove(D)})},T=new T1({fcn:()=>S(),repeats:!0,randomRange:[500,1500],interval:1e3});_.currentScene.add(T),T.start(),x.on("collisionstart",D=>{D.other===v?x.vel.y=0:(_.stop(),o(!0))}),_.start()}},g=()=>{o(!1),s.current&&(s.current.stop(),s.current=null),f()};return Y.useEffect(()=>(f(),()=>{s.current&&s.current.stop()}),[]),q.jsx("section",{className:"flex h-full items-center p-3",children:q.jsxs("div",{className:"flex w-full flex-col items-center justify-center",children:[q.jsx("canvas",{ref:e}),n&&q.jsx("div",{style:{textAlign:"center",marginTop:20},children:q.jsx("button",{onClick:g,style:{padding:"10px 20px",fontSize:"16px"},className:"rounded-md bg-secondary px-5 py-2 text-xs",children:"Restart Game"})})]})})}const zg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAABHNCSVQICAgIfAhkiAAAATZJREFUSEtjZCAC/P//nwWoLB6IbYBYFYiVgVgCqvUzkL4CxD+BOIORkHlAwwyBatYAsRIhtUB5N7wGAg2zBCo6AMRsRBgGUoLbQKBh/EAF14FYkkjDQMrccboQaGAtUEETCYaBlHrgM/AukeGGbCd2A4GukwaqeoLHde+BcsVAfBCIHzIyMv6FqcXqQmhkHMNjoBfQkO3Y5HEZ6AxUvAeHgS+AhuGMKFwGugEN24nDwJNAAy1wuR6Xge5ADTtwaDoKNBCUY7CCIWAgMEYdsLjdBCjWjcNXoIIgF2sMMzIeYAQa+J/E3IBL+XNg2EpR08ADQAMdqWngDKCBmdQ0sBBo4ARqGugJNHAHNQ1UAhp4H2QgtZLNIaCB/4ZATsGWSoHBMJwLh1Evg0NgNJbRE8JQr/WonbABL1K4mEmaPHoAAAAASUVORK5CYII=",R1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAsCAYAAAD8WEF4AAAABHNCSVQICAgIfAhkiAAABIxJREFUWEe1mT1oFEEUx+8UURH8AAsFwaSwEAsTFMXGXAqxUTSkE8EEi5Qq+NEIRu1UUNsgehZiIxgsVFAwCoKiaMRGUPAshFj5AaIoeP7/4e3xbnZmdmZ3MjDZze7Me7+Zee/tm7l6u92+VKvVDqGGlm9o2Fuv13mdkwKmSQjeI8Lf4NqgvjpeLMc/06hrIzRPovNQRPvgpuBpovEB6fBdQMlXq/MPGjRweaQkfsJ9y6KhD8+WyfMjAOaqJCvgOAxhF5XAfuiYBe3ACrA2B4KyYddSQ9gInl+TvnzHNrZBRQ/AkM3+o5Dd1IJmZzYr6MBRbJT/L6MxR9pVDHuaQpvBaLK8TK4YV5YmyWJdNROWnV4rWUOAobHrAVFgCzWJOWDwPaIzA70OnSO2CeiCZQN0HsfllDS2ej7a7MX720pgl22FzrQ4N2eUk8TyGKANV/8crABrc7B6vuG101DSHwqZtYOMKdwPyP+dEBULy6UhcLbULnPQIe80gLkqQcUSovqKnNU6szK7OoxYPd8S8gahkLPlLUaI6oqlvo5OWAHWy2T1fOML2EK/XMjTACEhKsoMlE0Ver44CQflDXky+KAQVQpWFGjPpzlwqTtfFQWhQ17OHGJCVGlYgdGJhdXzfSEvNkRVhTXNwer5xhewE/KM54UhqhKszG4DV53s5D4EgKJN0n47IQ/3NCOdRRWGqMqwAqyTHdotbdNMdnTI+402i0R5cIhKBUtz0B8CV7KjQ16mO5dFuaCSwDrMweX5H5XSm1iBfbFwZnvvR8El3PD8FtrZct8reH5QZCTJfUvBygzrZKeJmRs1B4dBveJA5Hnl3LcKbJncNyrZSWIGmRDDHP7i+QbM8HutJFXuS5mlZ1YBa8+fAexqizl0hbwyuW8qWO4qxhXgCcCcM2Y3KOQVRYtKM4sl3gEF91HnKUVJc189gNKwAGVK+BR1iQicwXWVz/Njc98kDgalayDohYJ7gvth1A+o3l1vyHbfZQ7RMwtlnEmCrheh73DdCjv9YXh+aO6b298lgQXMfAi6h0pbZfmCugmgnzMFxiFIdO7rc7KomQXIVQjLvlS/ZEbfagWSaLeUOUTlvklgAXEUgs6LsH+47saM3rUJt+x6bblvD/p6t/um7KCZhfJd6HgHNWs/BtAJ3yyEeL6xJS9MdgphIXAzoOjtiwXuAkCP+UD5TswhNvf1JjtF5wZcKnr+SoHj+dYwYNtFsAJsJjuu3Febg/Pc13cisxQKX6KuE7BnuA4A9E8IaNYmMPc1t/vWc1/XwdwCKHtAOFHKk3AK+BoDqoB17us66Cvc7rtgb0BRtg0h4BaA8utUqsiuN/bcNxfybOezJ0F0Vqi45Fx6mkClYvH8XsvOWJsD9dl/UxCH4Pf9llDRiehM+tC4KvCUMi2XOThz387MYuTbIIiHGAuF6DhAs49AJUhluz2493q+L+RlPy3R45+jrhDBEwAdS0JoCDHMIVTFbMjjj3YE5C6Uo2Z5iLoTL/lJnZNiJDshOlpo1E/YM7jZLj3o+fsB+jNEQtk2stQMVTGl+R/V8GS18NcxwwAAAABJRU5ErkJggg==",I1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAw9JREFUWEetl4910zAQxusJgAlIJyCdgGQCygQ4E1AmoJ0AOgHpBLQTECagTEA6AWWC8P307vwusuTaTfSenu3T6e67v5Kbk8LY7XYzkT9oLmzZnyX2Gm2rBZ+3TdPclRibSDTF34LiKQqf4gXMVwG5jowdACmfa+GH5suKpAez6ClFrL8dYFoLxMrXEwCz/FdQ/g+0mrjufozGEo/kYgzhu8hAXUsutBMHgOUwMn7zLobH5yqugGlFJ7w+ltKxacz6P0bF8tmxlEs2iTzTxOJHfV/q/bPpuhGtBUAkXonI98FDcnHxFxN0L7lnFpKtaC+gi9YAYKN3T5qzsTHXvphoD9qH4G5o/VYf75yALt4z+nIPgDPVzLdw4cJzzbxaSFbK7MYULfQEBNZ2SZd5PAHY5ShLAMTWmktrZerb8Oh7izm85FRXSb2QBwC4cTagPGYwyYoiF4xH3oS90MnyXiVJH7zfjfcqeuCnNuC2vVHoEbj4IhcuvuhyZHRujwKNj7JnjAKwFiPlxEilU/ISNOumG72mLNc4LSQnQCcB+KsNxHJUj8hi/EkA6KjdmOSBjPlOwojf4MgaWy+shwAY3aRCYh8VQDGpSu44JoCZFPg5kdrpiBDEMusl7aQQWGZT017j1DZZXh1SEE9WGhLd8HlJaABaPb0J0VgAUbwjSDl88DOKjW2yBwwEVvvhAwhKC/dubZ1Dh9NvEYztWW+88BT7QDoeS761YxQQsd2WWJ22kqh1RVY8plMnxIrXMNcAGHKa0aXmxwHN3BvboTzJGtUqvw+8Kh0gUaE1GjI9NiWM4P64l3AVDxA+NyIdx7jKe30xbkO+nromfVx+57bvFACtPjzLN7JiOVXoWP6sAlKV+DWJzPYTrJpAYxVVXE8Okf1ufTqoHEDMTPaTbOkme4hS32uWc0F15STrHPnxzyjmAntRvtH0prPVO3PMWBgTVvPuiiFzrPPfkeTm/4YxQ8comsqD5eexk/Yaj7mrFaNXxlQlJX4UYxz/hXthLXY+l2Bg+HSXTgHjIdt6yy5t/g9cxM+6jM9e3QAAAABJRU5ErkJggg==",D1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAuCAYAAABap1twAAAABHNCSVQICAgIfAhkiAAAAvRJREFUWEftmItV2zAUhvEEpRM0maB0gsIEhQlqNmgnwJmgZYLCBA0TECZoO0HTDWCC8H9GShVHL2NRTE/uOYpzrNen+5Lkas/IarU6099aZWLfPdNzrnlnVVX9ZP6KH8F91+P4mYBC054Icl4JrlELtDc2uRXQFMDfIzBrSDmnAK7GpjqHZ7YDHGidnQYHKlD58H8Okhuph2x/qPI2oKorvSefHUTaxLTcW4N/NNpXFbajjyonBgBQQFwBaqLyQ+VSZalSq3xSeZVp+16AMwPHlsjEc7tfxiaTC+2rnj48Fwb0Qs8PGZDZgJeCqTXZQQ5UaGL1Z2F7GmOp/2j0TQIyG/DdEDAfhAAx97cSgL8Ehz8VFWN6tBjzxywNfhYggVFcBIkvEmwhyQKc4jPF6TSgAAkezqKPBnwS87o0iY0iqcFzaY+8tSUaGAevVdAup9/2iG5F9fT7okJ+xE0wp2+chV6+D6gwCdgeu7udnclt1ULtjhw4gooEbeVW9a8DgI3eh070SUCv//muCQJo7zeI6g/1uO4AHakJ2tqQhB/GAd1J3VE9OexKbdeXLpOQuUpYuVM9O8mWBBZj20UBowGigUk9tQpaqQWwsRebRWA+3lO/4aOdBYeuHVHAGw2KqZ5cIpHcD5C9WLT7Pl/KWYUxJ3vxhi8+FvDhXrptOnyNFEKCxfeWMTizKNIIR7PGA4eVugGV5YM0wm9Off7jBAqAtHN9jICw50GiG7CL7kJMBJNPvQGk98k0Y8ds9IekvQ4EJ1HnWJdFrgFNlNtvQbH+2YB2EKspQL07TGA22hP1aNVqNmdhvQFzBi3ZZgc4VJs7Db5YDd6JPOdu3JqY1BH6MjBUA6H+3LFJUynIFrBWw9T1rzToucmLHIZjypnZj+hk+djtqjTgUjvL1Fw9FxHIB0DEnDRQe2hfLA15zNaZgPwLWHr2PuMZSKzY/V4zDkDHil1XGxegcbVGT3vLGx+ggbSZZZyABpKT+2QdxX2c+l+2vQfOkqOdRa6s+AAAAABJRU5ErkJggg==",k1="/ais-telegram-webpages/assets/msw-6jIDzMdt.png",Jv="/ais-telegram-webpages/assets/mgg-jRCbbsf_.png";function F1({task:e}){return q.jsxs("div",{className:"task-card",children:[q.jsx(mn,{src:e.icon}),q.jsx("div",{className:"instruction",children:e.instruction}),q.jsx("div",{className:"reward",children:q.jsx("span",{children:e.reward})}),q.jsx(Ed,{className:"cta-button",children:"Go"})]})}function B1(){const e=[{link:"/msw",icon:Jv,instruction:"Join the MGG Community",reward:"1000000"},{link:"/mgg",icon:k1,instruction:"Join the MSW Community",reward:"1000000"},{link:"/facebook",icon:zg,instruction:"Follow us on Facebook",reward:"1000000"},{link:"/x",icon:R1,instruction:"Follow us on X",reward:"1000000"},{link:"/instagram",icon:I1,instruction:"Follow us on Instagram",reward:"1000000"},{link:"/discord-mgg",icon:D1,instruction:"Join MGG Discord server",reward:"1000000"},{link:"/discord-msw",icon:zg,instruction:"Join MSW Discord server",reward:"1000000"}];return q.jsxs("section",{className:"flex-1 items-center overflow-auto",children:[q.jsx("h1",{className:"py-3 text-center text-4xl font-bold text-white",children:"Tasks"}),q.jsx("div",{className:"flex w-auto flex-col items-center gap-3 p-3",children:e.map((s,n)=>q.jsx(F1,{task:s},n))})]})}/**
 * @remix-run/router v1.19.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function So(){return So=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},So.apply(this,arguments)}var vs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(vs||(vs={}));const Hg="popstate";function M1(e){e===void 0&&(e={});function s(o,l){let{pathname:c,search:f,hash:g}=o.location;return Pu("",{pathname:c,search:f,hash:g},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(o,l){return typeof l=="string"?l:e0(l)}return O1(s,n,null,e)}function ae(e,s){if(e===!1||e===null||typeof e>"u")throw new Error(s)}function t0(e,s){if(!e){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function L1(){return Math.random().toString(36).substr(2,8)}function jg(e,s){return{usr:e.state,key:e.key,idx:s}}function Pu(e,s,n,o){return n===void 0&&(n=null),So({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof s=="string"?fr(s):s,{state:n,key:s&&s.key||o||L1()})}function e0(e){let{pathname:s="/",search:n="",hash:o=""}=e;return n&&n!=="?"&&(s+=n.charAt(0)==="?"?n:"?"+n),o&&o!=="#"&&(s+=o.charAt(0)==="#"?o:"#"+o),s}function fr(e){let s={};if(e){let n=e.indexOf("#");n>=0&&(s.hash=e.substr(n),e=e.substr(0,n));let o=e.indexOf("?");o>=0&&(s.search=e.substr(o),e=e.substr(0,o)),e&&(s.pathname=e)}return s}function O1(e,s,n,o){o===void 0&&(o={});let{window:l=document.defaultView,v5Compat:c=!1}=o,f=l.history,g=vs.Pop,_=null,v=x();v==null&&(v=0,f.replaceState(So({},f.state,{idx:v}),""));function x(){return(f.state||{idx:null}).idx}function S(){g=vs.Pop;let L=x(),P=L==null?null:L-v;v=L,_&&_({action:g,location:O.location,delta:P})}function T(L,P){g=vs.Push;let A=Pu(O.location,L,P);v=x()+1;let I=jg(A,v),H=O.createHref(A);try{f.pushState(I,"",H)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;l.location.assign(H)}c&&_&&_({action:g,location:O.location,delta:1})}function D(L,P){g=vs.Replace;let A=Pu(O.location,L,P);v=x();let I=jg(A,v),H=O.createHref(A);f.replaceState(I,"",H),c&&_&&_({action:g,location:O.location,delta:0})}function F(L){let P=l.location.origin!=="null"?l.location.origin:l.location.href,A=typeof L=="string"?L:e0(L);return A=A.replace(/ $/,"%20"),ae(P,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,P)}let O={get action(){return g},get location(){return e(l,f)},listen(L){if(_)throw new Error("A history only accepts one active listener");return l.addEventListener(Hg,S),_=L,()=>{l.removeEventListener(Hg,S),_=null}},createHref(L){return s(l,L)},createURL:F,encodeLocation(L){let P=F(L);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:T,replace:D,go(L){return f.go(L)}};return O}var Wg;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Wg||(Wg={}));function N1(e,s,n){return n===void 0&&(n="/"),U1(e,s,n,!1)}function U1(e,s,n,o){let l=typeof s=="string"?fr(s):s,c=n0(l.pathname||"/",n);if(c==null)return null;let f=i0(e);z1(f);let g=null;for(let _=0;g==null&&_<f.length;++_){let v=Z1(c);g=Q1(f[_],v,o)}return g}function i0(e,s,n,o){s===void 0&&(s=[]),n===void 0&&(n=[]),o===void 0&&(o="");let l=(c,f,g)=>{let _={relativePath:g===void 0?c.path||"":g,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};_.relativePath.startsWith("/")&&(ae(_.relativePath.startsWith(o),'Absolute route path "'+_.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_.relativePath=_.relativePath.slice(o.length));let v=an([o,_.relativePath]),x=n.concat(_);c.children&&c.children.length>0&&(ae(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),i0(c.children,s,x,v)),!(c.path==null&&!c.index)&&s.push({path:v,score:$1(v,c.index),routesMeta:x})};return e.forEach((c,f)=>{var g;if(c.path===""||!((g=c.path)!=null&&g.includes("?")))l(c,f);else for(let _ of s0(c.path))l(c,f,_)}),s}function s0(e){let s=e.split("/");if(s.length===0)return[];let[n,...o]=s,l=n.endsWith("?"),c=n.replace(/\?$/,"");if(o.length===0)return l?[c,""]:[c];let f=s0(o.join("/")),g=[];return g.push(...f.map(_=>_===""?c:[c,_].join("/"))),l&&g.push(...f),g.map(_=>e.startsWith("/")&&_===""?"/":_)}function z1(e){e.sort((s,n)=>s.score!==n.score?n.score-s.score:Y1(s.routesMeta.map(o=>o.childrenIndex),n.routesMeta.map(o=>o.childrenIndex)))}const H1=/^:[\w-]+$/,j1=3,W1=2,V1=1,G1=10,X1=-2,Vg=e=>e==="*";function $1(e,s){let n=e.split("/"),o=n.length;return n.some(Vg)&&(o+=X1),s&&(o+=W1),n.filter(l=>!Vg(l)).reduce((l,c)=>l+(H1.test(c)?j1:c===""?V1:G1),o)}function Y1(e,s){return e.length===s.length&&e.slice(0,-1).every((o,l)=>o===s[l])?e[e.length-1]-s[s.length-1]:0}function Q1(e,s,n){let{routesMeta:o}=e,l={},c="/",f=[];for(let g=0;g<o.length;++g){let _=o[g],v=g===o.length-1,x=c==="/"?s:s.slice(c.length)||"/",S=Gg({path:_.relativePath,caseSensitive:_.caseSensitive,end:v},x),T=_.route;if(!S&&v&&n&&!o[o.length-1].route.index&&(S=Gg({path:_.relativePath,caseSensitive:_.caseSensitive,end:!1},x)),!S)return null;Object.assign(l,S.params),f.push({params:l,pathname:an([c,S.pathname]),pathnameBase:sS(an([c,S.pathnameBase])),route:T}),S.pathnameBase!=="/"&&(c=an([c,S.pathnameBase]))}return f}function Gg(e,s){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,o]=q1(e.path,e.caseSensitive,e.end),l=s.match(n);if(!l)return null;let c=l[0],f=c.replace(/(.)\/+$/,"$1"),g=l.slice(1);return{params:o.reduce((v,x,S)=>{let{paramName:T,isOptional:D}=x;if(T==="*"){let O=g[S]||"";f=c.slice(0,c.length-O.length).replace(/(.)\/+$/,"$1")}const F=g[S];return D&&!F?v[T]=void 0:v[T]=(F||"").replace(/%2F/g,"/"),v},{}),pathname:c,pathnameBase:f,pattern:e}}function q1(e,s,n){s===void 0&&(s=!1),n===void 0&&(n=!0),t0(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let o=[],l="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,g,_)=>(o.push({paramName:g,isOptional:_!=null}),_?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(o.push({paramName:"*"}),l+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?l+="\\/*$":e!==""&&e!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,s?void 0:"i"),o]}function Z1(e){try{return e.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return t0(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),e}}function n0(e,s){if(s==="/")return e;if(!e.toLowerCase().startsWith(s.toLowerCase()))return null;let n=s.endsWith("/")?s.length-1:s.length,o=e.charAt(n);return o&&o!=="/"?null:e.slice(n)||"/"}function K1(e,s){s===void 0&&(s="/");let{pathname:n,search:o="",hash:l=""}=typeof e=="string"?fr(e):e;return{pathname:n?n.startsWith("/")?n:J1(n,s):s,search:nS(o),hash:rS(l)}}function J1(e,s){let n=s.replace(/\/+$/,"").split("/");return e.split("/").forEach(l=>{l===".."?n.length>1&&n.pop():l!=="."&&n.push(l)}),n.length>1?n.join("/"):"/"}function Ac(e,s,n,o){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function tS(e){return e.filter((s,n)=>n===0||s.route.path&&s.route.path.length>0)}function eS(e,s){let n=tS(e);return s?n.map((o,l)=>l===n.length-1?o.pathname:o.pathnameBase):n.map(o=>o.pathnameBase)}function iS(e,s,n,o){o===void 0&&(o=!1);let l;typeof e=="string"?l=fr(e):(l=So({},e),ae(!l.pathname||!l.pathname.includes("?"),Ac("?","pathname","search",l)),ae(!l.pathname||!l.pathname.includes("#"),Ac("#","pathname","hash",l)),ae(!l.search||!l.search.includes("#"),Ac("#","search","hash",l)));let c=e===""||l.pathname==="",f=c?"/":l.pathname,g;if(f==null)g=n;else{let S=s.length-1;if(!o&&f.startsWith("..")){let T=f.split("/");for(;T[0]==="..";)T.shift(),S-=1;l.pathname=T.join("/")}g=S>=0?s[S]:"/"}let _=K1(l,g),v=f&&f!=="/"&&f.endsWith("/"),x=(c||f===".")&&n.endsWith("/");return!_.pathname.endsWith("/")&&(v||x)&&(_.pathname+="/"),_}const an=e=>e.join("/").replace(/\/\/+/g,"/"),sS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),nS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,rS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function oS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const r0=["post","put","patch","delete"];new Set(r0);const aS=["get",...r0];new Set(aS);/**
 * React Router v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Eo(){return Eo=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Eo.apply(this,arguments)}const kd=Y.createContext(null),lS=Y.createContext(null),Nl=Y.createContext(null),Ul=Y.createContext(null),pr=Y.createContext({outlet:null,matches:[],isDataRoute:!1}),o0=Y.createContext(null);function zl(){return Y.useContext(Ul)!=null}function a0(){return zl()||ae(!1),Y.useContext(Ul).location}function l0(e){Y.useContext(Nl).static||Y.useLayoutEffect(e)}function hS(){let{isDataRoute:e}=Y.useContext(pr);return e?bS():cS()}function cS(){zl()||ae(!1);let e=Y.useContext(kd),{basename:s,future:n,navigator:o}=Y.useContext(Nl),{matches:l}=Y.useContext(pr),{pathname:c}=a0(),f=JSON.stringify(eS(l,n.v7_relativeSplatPath)),g=Y.useRef(!1);return l0(()=>{g.current=!0}),Y.useCallback(function(v,x){if(x===void 0&&(x={}),!g.current)return;if(typeof v=="number"){o.go(v);return}let S=iS(v,JSON.parse(f),c,x.relative==="path");e==null&&s!=="/"&&(S.pathname=S.pathname==="/"?s:an([s,S.pathname])),(x.replace?o.replace:o.push)(S,x.state,x)},[s,o,f,c,e])}function uS(e,s){return dS(e,s)}function dS(e,s,n,o){zl()||ae(!1);let{navigator:l}=Y.useContext(Nl),{matches:c}=Y.useContext(pr),f=c[c.length-1],g=f?f.params:{};f&&f.pathname;let _=f?f.pathnameBase:"/";f&&f.route;let v=a0(),x;if(s){var S;let L=typeof s=="string"?fr(s):s;_==="/"||(S=L.pathname)!=null&&S.startsWith(_)||ae(!1),x=L}else x=v;let T=x.pathname||"/",D=T;if(_!=="/"){let L=_.replace(/^\//,"").split("/");D="/"+T.replace(/^\//,"").split("/").slice(L.length).join("/")}let F=N1(e,{pathname:D}),O=_S(F&&F.map(L=>Object.assign({},L,{params:Object.assign({},g,L.params),pathname:an([_,l.encodeLocation?l.encodeLocation(L.pathname).pathname:L.pathname]),pathnameBase:L.pathnameBase==="/"?_:an([_,l.encodeLocation?l.encodeLocation(L.pathnameBase).pathname:L.pathnameBase])})),c,n,o);return s&&O?Y.createElement(Ul.Provider,{value:{location:Eo({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:vs.Pop}},O):O}function fS(){let e=xS(),s=oS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},s),n?Y.createElement("pre",{style:l},n):null,null)}const pS=Y.createElement(fS,null);class gS extends Y.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,n){return n.location!==s.location||n.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:n.error,location:n.location,revalidation:s.revalidation||n.revalidation}}componentDidCatch(s,n){console.error("React Router caught the following error during render",s,n)}render(){return this.state.error!==void 0?Y.createElement(pr.Provider,{value:this.props.routeContext},Y.createElement(o0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mS(e){let{routeContext:s,match:n,children:o}=e,l=Y.useContext(kd);return l&&l.static&&l.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=n.route.id),Y.createElement(pr.Provider,{value:s},o)}function _S(e,s,n,o){var l;if(s===void 0&&(s=[]),n===void 0&&(n=null),o===void 0&&(o=null),e==null){var c;if(!n)return null;if(n.errors)e=n.matches;else if((c=o)!=null&&c.v7_partialHydration&&s.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let f=e,g=(l=n)==null?void 0:l.errors;if(g!=null){let x=f.findIndex(S=>S.route.id&&(g==null?void 0:g[S.route.id])!==void 0);x>=0||ae(!1),f=f.slice(0,Math.min(f.length,x+1))}let _=!1,v=-1;if(n&&o&&o.v7_partialHydration)for(let x=0;x<f.length;x++){let S=f[x];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(v=x),S.route.id){let{loaderData:T,errors:D}=n,F=S.route.loader&&T[S.route.id]===void 0&&(!D||D[S.route.id]===void 0);if(S.route.lazy||F){_=!0,v>=0?f=f.slice(0,v+1):f=[f[0]];break}}}return f.reduceRight((x,S,T)=>{let D,F=!1,O=null,L=null;n&&(D=g&&S.route.id?g[S.route.id]:void 0,O=S.route.errorElement||pS,_&&(v<0&&T===0?(F=!0,L=null):v===T&&(F=!0,L=S.route.hydrateFallbackElement||null)));let P=s.concat(f.slice(0,T+1)),A=()=>{let I;return D?I=O:F?I=L:S.route.Component?I=Y.createElement(S.route.Component,null):S.route.element?I=S.route.element:I=x,Y.createElement(mS,{match:S,routeContext:{outlet:x,matches:P,isDataRoute:n!=null},children:I})};return n&&(S.route.ErrorBoundary||S.route.errorElement||T===0)?Y.createElement(gS,{location:n.location,revalidation:n.revalidation,component:O,error:D,children:A(),routeContext:{outlet:null,matches:P,isDataRoute:!0}}):A()},null)}var h0=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(h0||{}),ml=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ml||{});function vS(e){let s=Y.useContext(kd);return s||ae(!1),s}function yS(e){let s=Y.useContext(lS);return s||ae(!1),s}function wS(e){let s=Y.useContext(pr);return s||ae(!1),s}function c0(e){let s=wS(),n=s.matches[s.matches.length-1];return n.route.id||ae(!1),n.route.id}function xS(){var e;let s=Y.useContext(o0),n=yS(ml.UseRouteError),o=c0(ml.UseRouteError);return s!==void 0?s:(e=n.errors)==null?void 0:e[o]}function bS(){let{router:e}=vS(h0.UseNavigateStable),s=c0(ml.UseNavigateStable),n=Y.useRef(!1);return l0(()=>{n.current=!0}),Y.useCallback(function(l,c){c===void 0&&(c={}),n.current&&(typeof l=="number"?e.navigate(l):e.navigate(l,Eo({fromRouteId:s},c)))},[e,s])}function Ha(e){ae(!1)}function CS(e){let{basename:s="/",children:n=null,location:o,navigationType:l=vs.Pop,navigator:c,static:f=!1,future:g}=e;zl()&&ae(!1);let _=s.replace(/^\/*/,"/"),v=Y.useMemo(()=>({basename:_,navigator:c,static:f,future:Eo({v7_relativeSplatPath:!1},g)}),[_,g,c,f]);typeof o=="string"&&(o=fr(o));let{pathname:x="/",search:S="",hash:T="",state:D=null,key:F="default"}=o,O=Y.useMemo(()=>{let L=n0(x,_);return L==null?null:{location:{pathname:L,search:S,hash:T,state:D,key:F},navigationType:l}},[_,x,S,T,D,F,l]);return O==null?null:Y.createElement(Nl.Provider,{value:v},Y.createElement(Ul.Provider,{children:n,value:O}))}function SS(e){let{children:s,location:n}=e;return uS(Ru(s),n)}new Promise(()=>{});function Ru(e,s){s===void 0&&(s=[]);let n=[];return Y.Children.forEach(e,(o,l)=>{if(!Y.isValidElement(o))return;let c=[...s,l];if(o.type===Y.Fragment){n.push.apply(n,Ru(o.props.children,c));return}o.type!==Ha&&ae(!1),!o.props.index||!o.props.children||ae(!1);let f={id:o.props.id||c.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(f.children=Ru(o.props.children,c)),n.push(f)}),n}/**
 * React Router DOM v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ES="6";try{window.__reactRouterVersion=ES}catch{}const AS="startTransition",Xg=Jy[AS];function TS(e){let{basename:s,children:n,future:o,window:l}=e,c=Y.useRef();c.current==null&&(c.current=M1({window:l,v5Compat:!0}));let f=c.current,[g,_]=Y.useState({action:f.action,location:f.location}),{v7_startTransition:v}=o||{},x=Y.useCallback(S=>{v&&Xg?Xg(()=>_(S)):_(S)},[_,v]);return Y.useLayoutEffect(()=>f.listen(x),[f,x]),Y.createElement(CS,{basename:s,children:n,location:g.location,navigationType:g.action,navigator:f,future:o})}var $g;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})($g||($g={}));var Yg;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Yg||(Yg={}));const PS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAgCAYAAAB6kdqOAAAABHNCSVQICAgIfAhkiAAAAVlJREFUWEft1m0RwjAMBmDqAAk4YBJACVjAwXCAA0ABEhgOkAAOhgJ4C+tuK2uT9IMf3HbXP3RNH9I2nXrimeR9jkqptT0Fpp3itxPaBv1X068yg3yYMxAFWo22NKicIA7GJKZF5QJJMH3UwJJd8EYVsa1qpH/n2DNmmVzh70MZ2iJgGQH6GtpsYArzwMBFdpAIg9OWFSTF6NRmA4VggkCugtbdOKEYMciaqFfQDCgGIwI5JuqhYjFsEDHRG4V2Q+Md7c7dZdcI1qYG6ICBK09t0igN0neT6/nUGQ9GmqEKA+aBBZOFYYP0i82yhaCcGMQs7Iyxlsw6QRKUD7NH3Lt9TYlAwkxRmDXifd2bYhATxcHoUGlABIqLSQtyoLynaeDbK12GBjb6jKozPwF1MjWjit7PQNxiOYKoTP1Nhqg/mrKfdexTTkjFGkFBGSqpURn7KxRT/TnTPi+ImnZn2O6OawAAAABJRU5ErkJggg==",RS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAXCAYAAACf+8ZRAAAABHNCSVQICAgIfAhkiAAAAmhJREFUWEfFl481BDEQh20FdOBU4FRgVcBVgApQgVUBKuAqQAVOBVwFVgWo4Py+ldzL7uXfsUfey3u7m5nJl8lkMlusRdpsNtvX8IH6QL2MyfY0NpGdWv2+KIqHkM3CNyDYQ32vDGxPPEubAb4S/Lir2YIW7IYEbox3l55lRQr3snss+A9rfw5tgB81MFzR5L8x+yLlPQvuQt9FPEx8oWjbqR7Wf0PxA13ifIReAy0vH5mw8NqScDeMKgme/2DimMqUGFafmN3mebejQJjcWuhXDQ5CFv8AGuDSjVvjTBbggteS2SrkZVIaoRFsfwDdeLALILZS3zhnbhsBjTAp7j+hOWR4tdXExu4TBW4bA93dggcZwPvZTTbIOM/ZCouCIU/7ouAJ6FnHxoWgq2UBPHZSJp6MADFbq++4MR1JwR//AQ3sgQU0IcAFQgq9Uie1EhakVe+dATSr3HTcskpPfwLkyRLLhNfUF9Ncl6x43jTJhftuTrWbipg05xwEz4ts4uHtVExpvIlptuEyJtxjyhvL1pFvLk9CCCGdAU38dNNKS6FH6IUDx0Tm0L1neBmRLXsj3uolmKt7hGZS5jpzDiKVZW6h1uyUhcbbxFSoCCIdzQsmeSZWXOU4DI9be6WeAU81DvFQHLVb5SWv85TVFY+PBExq/K7ybEtVewkoih4OdaiRkXKyg0+/dWMu/G6ZK5kVubk75cRreSEG3OjLNuAnKWPO+JueuYjcWr7taY/XAQl5hxhjcfzH1bkgJltVwKiHzhC7duWr/JjH+2PbgR/onV6a7wBS105yQUNy5pKy9hHDJrajTvgCAZ8NyvA3Y5cAAAAASUVORK5CYII=";function IS(){const[e,s]=Y.useState("/exchange"),n=[{key:"/",icon:Jv,label:"Home"},{key:"/tasks",icon:PS,label:"Tasks"},{key:"/jumping-game",icon:RS,label:"Minigames"}],o=hS(),l=c=>{s(c),o(c)};return q.jsx("nav",{className:"flex flex-row justify-center gap-2 bg-violet-800 px-1 py-2",children:n.map(c=>q.jsx(yg,{className:`nav-card basis-1/6 ${e===c.key?"active":""}`,onClick:()=>l(c.key),children:q.jsxs(yg.Body,{className:"bottomnav-card-body",children:[q.jsx(mn,{src:c.icon,className:"img-fluid",rounded:!0,draggable:"false"}),q.jsx("div",{className:"text-center align-text-bottom text-xs",children:c.label})]})},c.key))})}const DS=e=>new Promise((s,n)=>{const o=document.querySelector(`script[src="${e}"]`);if(o){s(o);return}const l=document.createElement("script");l.src=e,l.async=!0,l.onload=()=>s(l),l.onerror=()=>n(new Error(`Failed to load script: ${e}`)),document.head.appendChild(l)}),kS=({userData:e})=>{const{setData:s}=Co();return Y.useEffect(()=>{const n=()=>{console.log("App is about to close",e),s("coins",Number(e.coins.Value)),Yt.post("https://4ca8-103-200-32-6.ngrok-free.app"+"/test")},o=l=>{n(),l.preventDefault(),l.returnValue=""};return window.addEventListener("beforeunload",o),()=>{window.removeEventListener("beforeunload",o)}},[e,s]),null},Fd=Y.createContext(null);function FS(){const[e,s]=Y.useState(null),[n,o]=Y.useState(!0),[l,c]=Y.useState({isError:!1}),f="https://telegram.org/js/telegram-web-app.js",g="https://4ca8-103-200-32-6.ngrok-free.app",{sessionData:_,setPlayFabId:v,setData:x,setGameData:S}=Co();let T=!1;return Y.useEffect(()=>{const D=async L=>{try{const A=await(await fetch(g+"/playFab/validate/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({initData:L})})).json();A.valid?(console.log(A),v(A.loginData.PlayFabId),x(A.userData,void 0,!1),S(A.gameData)):(console.error("Data validation failed!"),c({isError:!0,error:A.message}))}catch(P){console.error("Error validating data:",P),c({isError:!0,error:String(P)})}finally{o(!1)}};(async()=>{var L,P,A,I;try{await DS(f),console.log("Script loaded");const H=()=>window.Telegram!==void 0&&window.Telegram.WebApp!==void 0&&window.Telegram.WebApp.initData!=="";console.log(window.Telegram!==void 0),console.log((L=window.Telegram)==null?void 0:L.WebApp),console.log((A=(P=window.Telegram)==null?void 0:P.WebApp)==null?void 0:A.initData),console.log(H());let j;H()?(j=(I=window.Telegram)==null?void 0:I.WebApp,j.ready(),D(j.initData),s(j),console.log("Telegram initialized:",JSON.stringify(j)),j.expand(),j.onEvent("mainButtonClicked",()=>{console.log("Main Button Clicked")})):(T=!0,await fb(async()=>{const{mockTelegram:Z}=await import("./mockTelegramAPI-BaXyXYe0.js");return{mockTelegram:Z}},[]).then(({mockTelegram:Z})=>{var E;Z(),j=(E=window.Telegram)==null?void 0:E.WebApp,j&&(s(j),console.log("Using mock data:",JSON.stringify(j)))}))}catch(H){console.error("Error loading Telegram Web App script:",H)}})();const O=()=>{console.log("Viewport changed. App may have been resized, minimized, or put in the background.")};return()=>{var L;T||(L=window==null?void 0:window.Telegram)==null||L.WebApp.offEvent("viewportChanged",O)}},[]),q.jsx(Fd.Provider,{value:{tgData:e,setTgData:s},children:n?q.jsx("div",{className:"flex h-dvh w-dvw grow items-center justify-center font-bold",children:q.jsx("p",{children:"Loading, please wait..."})}):l.isError?q.jsx("div",{className:"flex h-dvh w-dvw grow items-center justify-center font-bold",children:q.jsx("p",{children:"Something went wrong, please try again later."})}):q.jsxs(q.Fragment,{children:[q.jsx(TS,{basename:"/ais-telegram-webpages",children:q.jsxs("main",{className:"flex h-dvh flex-col overflow-hidden bg-violet-900",children:[q.jsx("div",{className:"flex flex-1 flex-col overflow-hidden",children:q.jsxs(SS,{children:[q.jsx(Ha,{path:"/",element:q.jsx(b1,{})}),q.jsx(Ha,{path:"/tasks",element:q.jsx(B1,{})}),q.jsx(Ha,{path:"/jumping-game",element:q.jsx(P1,{})})]})}),q.jsx(IS,{})]})}),q.jsx(kS,{userData:_.userData})]})})}Tc.createRoot(document.getElementById("root")).render(q.jsx(Ki.StrictMode,{children:q.jsxs(d1,{children:[q.jsx(FS,{}),","]})}));
