function mE(e,n){for(var s=0;s<n.length;s++){const a=n[s];if(typeof a!="string"&&!Array.isArray(a)){for(const u in a)if(u!=="default"&&!(u in e)){const d=Object.getOwnPropertyDescriptor(a,u);d&&Object.defineProperty(e,u,d.get?d:{enumerable:!0,get:()=>a[u]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))a(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const _ of d.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&a(_)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();var Kh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function E_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wy={exports:{}},of={},xy={exports:{}},qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ju=Symbol.for("react.element"),vE=Symbol.for("react.portal"),yE=Symbol.for("react.fragment"),wE=Symbol.for("react.strict_mode"),xE=Symbol.for("react.profiler"),bE=Symbol.for("react.provider"),CE=Symbol.for("react.context"),SE=Symbol.for("react.forward_ref"),AE=Symbol.for("react.suspense"),EE=Symbol.for("react.memo"),TE=Symbol.for("react.lazy"),kv=Symbol.iterator;function PE(e){return e===null||typeof e!="object"?null:(e=kv&&e[kv]||e["@@iterator"],typeof e=="function"?e:null)}var by={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Cy=Object.assign,Sy={};function $l(e,n,s){this.props=e,this.context=n,this.refs=Sy,this.updater=s||by}$l.prototype.isReactComponent={};$l.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};$l.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ay(){}Ay.prototype=$l.prototype;function T_(e,n,s){this.props=e,this.context=n,this.refs=Sy,this.updater=s||by}var P_=T_.prototype=new Ay;P_.constructor=T_;Cy(P_,$l.prototype);P_.isPureReactComponent=!0;var Lv=Array.isArray,Ey=Object.prototype.hasOwnProperty,R_={current:null},Ty={key:!0,ref:!0,__self:!0,__source:!0};function Py(e,n,s){var a,u={},d=null,_=null;if(n!=null)for(a in n.ref!==void 0&&(_=n.ref),n.key!==void 0&&(d=""+n.key),n)Ey.call(n,a)&&!Ty.hasOwnProperty(a)&&(u[a]=n[a]);var v=arguments.length-2;if(v===1)u.children=s;else if(1<v){for(var x=Array(v),b=0;b<v;b++)x[b]=arguments[b+2];u.children=x}if(e&&e.defaultProps)for(a in v=e.defaultProps,v)u[a]===void 0&&(u[a]=v[a]);return{$$typeof:ju,type:e,key:d,ref:_,props:u,_owner:R_.current}}function RE(e,n){return{$$typeof:ju,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function I_(e){return typeof e=="object"&&e!==null&&e.$$typeof===ju}function IE(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return n[s]})}var Mv=/\/+/g;function Wp(e,n){return typeof e=="object"&&e!==null&&e.key!=null?IE(""+e.key):n.toString(36)}function pd(e,n,s,a,u){var d=typeof e;(d==="undefined"||d==="boolean")&&(e=null);var _=!1;if(e===null)_=!0;else switch(d){case"string":case"number":_=!0;break;case"object":switch(e.$$typeof){case ju:case vE:_=!0}}if(_)return _=e,u=u(_),e=a===""?"."+Wp(_,0):a,Lv(u)?(s="",e!=null&&(s=e.replace(Mv,"$&/")+"/"),pd(u,n,s,"",function(b){return b})):u!=null&&(I_(u)&&(u=RE(u,s+(!u.key||_&&_.key===u.key?"":(""+u.key).replace(Mv,"$&/")+"/")+e)),n.push(u)),1;if(_=0,a=a===""?".":a+":",Lv(e))for(var v=0;v<e.length;v++){d=e[v];var x=a+Wp(d,v);_+=pd(d,n,s,x,u)}else if(x=PE(e),typeof x=="function")for(e=x.call(e),v=0;!(d=e.next()).done;)d=d.value,x=a+Wp(d,v++),_+=pd(d,n,s,x,u);else if(d==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return _}function Zc(e,n,s){if(e==null)return e;var a=[],u=0;return pd(e,a,"","",function(d){return n.call(s,d,u++)}),a}function DE(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var Ji={current:null},gd={transition:null},FE={ReactCurrentDispatcher:Ji,ReactCurrentBatchConfig:gd,ReactCurrentOwner:R_};function Ry(){throw Error("act(...) is not supported in production builds of React.")}qt.Children={map:Zc,forEach:function(e,n,s){Zc(e,function(){n.apply(this,arguments)},s)},count:function(e){var n=0;return Zc(e,function(){n++}),n},toArray:function(e){return Zc(e,function(n){return n})||[]},only:function(e){if(!I_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qt.Component=$l;qt.Fragment=yE;qt.Profiler=xE;qt.PureComponent=T_;qt.StrictMode=wE;qt.Suspense=AE;qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FE;qt.act=Ry;qt.cloneElement=function(e,n,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=Cy({},e.props),u=e.key,d=e.ref,_=e._owner;if(n!=null){if(n.ref!==void 0&&(d=n.ref,_=R_.current),n.key!==void 0&&(u=""+n.key),e.type&&e.type.defaultProps)var v=e.type.defaultProps;for(x in n)Ey.call(n,x)&&!Ty.hasOwnProperty(x)&&(a[x]=n[x]===void 0&&v!==void 0?v[x]:n[x])}var x=arguments.length-2;if(x===1)a.children=s;else if(1<x){v=Array(x);for(var b=0;b<x;b++)v[b]=arguments[b+2];a.children=v}return{$$typeof:ju,type:e.type,key:u,ref:d,props:a,_owner:_}};qt.createContext=function(e){return e={$$typeof:CE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:bE,_context:e},e.Consumer=e};qt.createElement=Py;qt.createFactory=function(e){var n=Py.bind(null,e);return n.type=e,n};qt.createRef=function(){return{current:null}};qt.forwardRef=function(e){return{$$typeof:SE,render:e}};qt.isValidElement=I_;qt.lazy=function(e){return{$$typeof:TE,_payload:{_status:-1,_result:e},_init:DE}};qt.memo=function(e,n){return{$$typeof:EE,type:e,compare:n===void 0?null:n}};qt.startTransition=function(e){var n=gd.transition;gd.transition={};try{e()}finally{gd.transition=n}};qt.unstable_act=Ry;qt.useCallback=function(e,n){return Ji.current.useCallback(e,n)};qt.useContext=function(e){return Ji.current.useContext(e)};qt.useDebugValue=function(){};qt.useDeferredValue=function(e){return Ji.current.useDeferredValue(e)};qt.useEffect=function(e,n){return Ji.current.useEffect(e,n)};qt.useId=function(){return Ji.current.useId()};qt.useImperativeHandle=function(e,n,s){return Ji.current.useImperativeHandle(e,n,s)};qt.useInsertionEffect=function(e,n){return Ji.current.useInsertionEffect(e,n)};qt.useLayoutEffect=function(e,n){return Ji.current.useLayoutEffect(e,n)};qt.useMemo=function(e,n){return Ji.current.useMemo(e,n)};qt.useReducer=function(e,n,s){return Ji.current.useReducer(e,n,s)};qt.useRef=function(e){return Ji.current.useRef(e)};qt.useState=function(e){return Ji.current.useState(e)};qt.useSyncExternalStore=function(e,n,s){return Ji.current.useSyncExternalStore(e,n,s)};qt.useTransition=function(){return Ji.current.useTransition()};qt.version="18.3.1";xy.exports=qt;var lt=xy.exports;const Cr=E_(lt),BE=mE({__proto__:null,default:Cr},[lt]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kE=lt,LE=Symbol.for("react.element"),ME=Symbol.for("react.fragment"),OE=Object.prototype.hasOwnProperty,NE=kE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UE={key:!0,ref:!0,__self:!0,__source:!0};function Iy(e,n,s){var a,u={},d=null,_=null;s!==void 0&&(d=""+s),n.key!==void 0&&(d=""+n.key),n.ref!==void 0&&(_=n.ref);for(a in n)OE.call(n,a)&&!UE.hasOwnProperty(a)&&(u[a]=n[a]);if(e&&e.defaultProps)for(a in n=e.defaultProps,n)u[a]===void 0&&(u[a]=n[a]);return{$$typeof:LE,type:e,key:d,ref:_,props:u,_owner:NE.current}}of.Fragment=ME;of.jsx=Iy;of.jsxs=Iy;wy.exports=of;var ct=wy.exports,Cg={},Dy={exports:{}},On={},Fy={exports:{}},By={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(vt,Tt){var Ft=vt.length;vt.push(Tt);t:for(;0<Ft;){var Yt=Ft-1>>>1,pe=vt[Yt];if(0<u(pe,Tt))vt[Yt]=Tt,vt[Ft]=pe,Ft=Yt;else break t}}function s(vt){return vt.length===0?null:vt[0]}function a(vt){if(vt.length===0)return null;var Tt=vt[0],Ft=vt.pop();if(Ft!==Tt){vt[0]=Ft;t:for(var Yt=0,pe=vt.length,is=pe>>>1;Yt<is;){var Vi=2*(Yt+1)-1,ge=vt[Vi],Zt=Vi+1,Is=vt[Zt];if(0>u(ge,Ft))Zt<pe&&0>u(Is,ge)?(vt[Yt]=Is,vt[Zt]=Ft,Yt=Zt):(vt[Yt]=ge,vt[Vi]=Ft,Yt=Vi);else if(Zt<pe&&0>u(Is,Ft))vt[Yt]=Is,vt[Zt]=Ft,Yt=Zt;else break t}}return Tt}function u(vt,Tt){var Ft=vt.sortIndex-Tt.sortIndex;return Ft!==0?Ft:vt.id-Tt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var _=Date,v=_.now();e.unstable_now=function(){return _.now()-v}}var x=[],b=[],E=1,R=null,L=3,U=!1,H=!1,$=!1,G=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(vt){for(var Tt=s(b);Tt!==null;){if(Tt.callback===null)a(b);else if(Tt.startTime<=vt)a(b),Tt.sortIndex=Tt.expirationTime,n(x,Tt);else break;Tt=s(b)}}function J(vt){if($=!1,N(vt),!H)if(s(x)!==null)H=!0,mt(K);else{var Tt=s(b);Tt!==null&&Ke(J,Tt.startTime-vt)}}function K(vt,Tt){H=!1,$&&($=!1,k(j),j=-1),U=!0;var Ft=L;try{for(N(Tt),R=s(x);R!==null&&(!(R.expirationTime>Tt)||vt&&!Et());){var Yt=R.callback;if(typeof Yt=="function"){R.callback=null,L=R.priorityLevel;var pe=Yt(R.expirationTime<=Tt);Tt=e.unstable_now(),typeof pe=="function"?R.callback=pe:R===s(x)&&a(x),N(Tt)}else a(x);R=s(x)}if(R!==null)var is=!0;else{var Vi=s(b);Vi!==null&&Ke(J,Vi.startTime-Tt),is=!1}return is}finally{R=null,L=Ft,U=!1}}var ft=!1,D=null,j=-1,nt=5,bt=-1;function Et(){return!(e.unstable_now()-bt<nt)}function gt(){if(D!==null){var vt=e.unstable_now();bt=vt;var Tt=!0;try{Tt=D(!0,vt)}finally{Tt?Pe():(ft=!1,D=null)}}else ft=!1}var Pe;if(typeof B=="function")Pe=function(){B(gt)};else if(typeof MessageChannel<"u"){var Le=new MessageChannel,Xt=Le.port2;Le.port1.onmessage=gt,Pe=function(){Xt.postMessage(null)}}else Pe=function(){G(gt,0)};function mt(vt){D=vt,ft||(ft=!0,Pe())}function Ke(vt,Tt){j=G(function(){vt(e.unstable_now())},Tt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(vt){vt.callback=null},e.unstable_continueExecution=function(){H||U||(H=!0,mt(K))},e.unstable_forceFrameRate=function(vt){0>vt||125<vt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):nt=0<vt?Math.floor(1e3/vt):5},e.unstable_getCurrentPriorityLevel=function(){return L},e.unstable_getFirstCallbackNode=function(){return s(x)},e.unstable_next=function(vt){switch(L){case 1:case 2:case 3:var Tt=3;break;default:Tt=L}var Ft=L;L=Tt;try{return vt()}finally{L=Ft}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(vt,Tt){switch(vt){case 1:case 2:case 3:case 4:case 5:break;default:vt=3}var Ft=L;L=vt;try{return Tt()}finally{L=Ft}},e.unstable_scheduleCallback=function(vt,Tt,Ft){var Yt=e.unstable_now();switch(typeof Ft=="object"&&Ft!==null?(Ft=Ft.delay,Ft=typeof Ft=="number"&&0<Ft?Yt+Ft:Yt):Ft=Yt,vt){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=Ft+pe,vt={id:E++,callback:Tt,priorityLevel:vt,startTime:Ft,expirationTime:pe,sortIndex:-1},Ft>Yt?(vt.sortIndex=Ft,n(b,vt),s(x)===null&&vt===s(b)&&($?(k(j),j=-1):$=!0,Ke(J,Ft-Yt))):(vt.sortIndex=pe,n(x,vt),H||U||(H=!0,mt(K))),vt},e.unstable_shouldYield=Et,e.unstable_wrapCallback=function(vt){var Tt=L;return function(){var Ft=L;L=Tt;try{return vt.apply(this,arguments)}finally{L=Ft}}}})(By);Fy.exports=By;var zE=Fy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HE=lt,Mn=zE;function pt(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ky=new Set,bu={};function wa(e,n){zl(e,n),zl(e+"Capture",n)}function zl(e,n){for(bu[e]=n,e=0;e<n.length;e++)ky.add(n[e])}var Ar=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sg=Object.prototype.hasOwnProperty,WE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ov={},Nv={};function jE(e){return Sg.call(Nv,e)?!0:Sg.call(Ov,e)?!1:WE.test(e)?Nv[e]=!0:(Ov[e]=!0,!1)}function GE(e,n,s,a){if(s!==null&&s.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return a?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function VE(e,n,s,a){if(n===null||typeof n>"u"||GE(e,n,s,a))return!0;if(a)return!1;if(s!==null)switch(s.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function tn(e,n,s,a,u,d,_){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=a,this.attributeNamespace=u,this.mustUseProperty=s,this.propertyName=e,this.type=n,this.sanitizeURL=d,this.removeEmptyString=_}var Mi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Mi[e]=new tn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];Mi[n]=new tn(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Mi[e]=new tn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Mi[e]=new tn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Mi[e]=new tn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Mi[e]=new tn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Mi[e]=new tn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Mi[e]=new tn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Mi[e]=new tn(e,5,!1,e.toLowerCase(),null,!1,!1)});var D_=/[\-:]([a-z])/g;function F_(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(D_,F_);Mi[n]=new tn(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(D_,F_);Mi[n]=new tn(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(D_,F_);Mi[n]=new tn(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Mi[e]=new tn(e,1,!1,e.toLowerCase(),null,!1,!1)});Mi.xlinkHref=new tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Mi[e]=new tn(e,1,!1,e.toLowerCase(),null,!0,!0)});function B_(e,n,s,a){var u=Mi.hasOwnProperty(n)?Mi[n]:null;(u!==null?u.type!==0:a||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(VE(n,s,u,a)&&(s=null),a||u===null?jE(n)&&(s===null?e.removeAttribute(n):e.setAttribute(n,""+s)):u.mustUseProperty?e[u.propertyName]=s===null?u.type===3?!1:"":s:(n=u.attributeName,a=u.attributeNamespace,s===null?e.removeAttribute(n):(u=u.type,s=u===3||u===4&&s===!0?"":""+s,a?e.setAttributeNS(a,n,s):e.setAttribute(n,s))))}var Rr=HE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Kc=Symbol.for("react.element"),bl=Symbol.for("react.portal"),Cl=Symbol.for("react.fragment"),k_=Symbol.for("react.strict_mode"),Ag=Symbol.for("react.profiler"),Ly=Symbol.for("react.provider"),My=Symbol.for("react.context"),L_=Symbol.for("react.forward_ref"),Eg=Symbol.for("react.suspense"),Tg=Symbol.for("react.suspense_list"),M_=Symbol.for("react.memo"),Jr=Symbol.for("react.lazy"),Oy=Symbol.for("react.offscreen"),Uv=Symbol.iterator;function Jh(e){return e===null||typeof e!="object"?null:(e=Uv&&e[Uv]||e["@@iterator"],typeof e=="function"?e:null)}var ke=Object.assign,jp;function hu(e){if(jp===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);jp=n&&n[1]||""}return`
`+jp+e}var Gp=!1;function Vp(e,n){if(!e||Gp)return"";Gp=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(b){var a=b}Reflect.construct(e,[],n)}else{try{n.call()}catch(b){a=b}e.call(n.prototype)}else{try{throw Error()}catch(b){a=b}e()}}catch(b){if(b&&a&&typeof b.stack=="string"){for(var u=b.stack.split(`
`),d=a.stack.split(`
`),_=u.length-1,v=d.length-1;1<=_&&0<=v&&u[_]!==d[v];)v--;for(;1<=_&&0<=v;_--,v--)if(u[_]!==d[v]){if(_!==1||v!==1)do if(_--,v--,0>v||u[_]!==d[v]){var x=`
`+u[_].replace(" at new "," at ");return e.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",e.displayName)),x}while(1<=_&&0<=v);break}}}finally{Gp=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?hu(e):""}function XE(e){switch(e.tag){case 5:return hu(e.type);case 16:return hu("Lazy");case 13:return hu("Suspense");case 19:return hu("SuspenseList");case 0:case 2:case 15:return e=Vp(e.type,!1),e;case 11:return e=Vp(e.type.render,!1),e;case 1:return e=Vp(e.type,!0),e;default:return""}}function Pg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Cl:return"Fragment";case bl:return"Portal";case Ag:return"Profiler";case k_:return"StrictMode";case Eg:return"Suspense";case Tg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case My:return(e.displayName||"Context")+".Consumer";case Ly:return(e._context.displayName||"Context")+".Provider";case L_:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case M_:return n=e.displayName||null,n!==null?n:Pg(e.type)||"Memo";case Jr:n=e._payload,e=e._init;try{return Pg(e(n))}catch{}}return null}function $E(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pg(n);case 8:return n===k_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function go(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ny(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function YE(e){var n=Ny(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),a=""+e[n];if(!e.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var u=s.get,d=s.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return u.call(this)},set:function(_){a=""+_,d.call(this,_)}}),Object.defineProperty(e,n,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(_){a=""+_},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Jc(e){e._valueTracker||(e._valueTracker=YE(e))}function Uy(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var s=n.getValue(),a="";return e&&(a=Ny(e)?e.checked?"true":"false":e.value),e=a,e!==s?(n.setValue(e),!0):!1}function Rd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Rg(e,n){var s=n.checked;return ke({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function zv(e,n){var s=n.defaultValue==null?"":n.defaultValue,a=n.checked!=null?n.checked:n.defaultChecked;s=go(n.value!=null?n.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function zy(e,n){n=n.checked,n!=null&&B_(e,"checked",n,!1)}function Ig(e,n){zy(e,n);var s=go(n.value),a=n.type;if(s!=null)a==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Dg(e,n.type,s):n.hasOwnProperty("defaultValue")&&Dg(e,n.type,go(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function Hv(e,n,s){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var a=n.type;if(!(a!=="submit"&&a!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,s||n===e.value||(e.value=n),e.defaultValue=n}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function Dg(e,n,s){(n!=="number"||Rd(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var uu=Array.isArray;function kl(e,n,s,a){if(e=e.options,n){n={};for(var u=0;u<s.length;u++)n["$"+s[u]]=!0;for(s=0;s<e.length;s++)u=n.hasOwnProperty("$"+e[s].value),e[s].selected!==u&&(e[s].selected=u),u&&a&&(e[s].defaultSelected=!0)}else{for(s=""+go(s),n=null,u=0;u<e.length;u++){if(e[u].value===s){e[u].selected=!0,a&&(e[u].defaultSelected=!0);return}n!==null||e[u].disabled||(n=e[u])}n!==null&&(n.selected=!0)}}function Fg(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(pt(91));return ke({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Wv(e,n){var s=n.value;if(s==null){if(s=n.children,n=n.defaultValue,s!=null){if(n!=null)throw Error(pt(92));if(uu(s)){if(1<s.length)throw Error(pt(93));s=s[0]}n=s}n==null&&(n=""),s=n}e._wrapperState={initialValue:go(s)}}function Hy(e,n){var s=go(n.value),a=go(n.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),n.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),a!=null&&(e.defaultValue=""+a)}function jv(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function Wy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bg(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?Wy(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var td,jy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,s,a,u){MSApp.execUnsafeLocalFunction(function(){return e(n,s,a,u)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(td=td||document.createElement("div"),td.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=td.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Cu(e,n){if(n){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=n;return}}e.textContent=n}var fu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QE=["Webkit","ms","Moz","O"];Object.keys(fu).forEach(function(e){QE.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),fu[n]=fu[e]})});function Gy(e,n,s){return n==null||typeof n=="boolean"||n===""?"":s||typeof n!="number"||n===0||fu.hasOwnProperty(e)&&fu[e]?(""+n).trim():n+"px"}function Vy(e,n){e=e.style;for(var s in n)if(n.hasOwnProperty(s)){var a=s.indexOf("--")===0,u=Gy(s,n[s],a);s==="float"&&(s="cssFloat"),a?e.setProperty(s,u):e[s]=u}}var qE=ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kg(e,n){if(n){if(qE[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(pt(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(pt(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(pt(61))}if(n.style!=null&&typeof n.style!="object")throw Error(pt(62))}}function Lg(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mg=null;function O_(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Og=null,Ll=null,Ml=null;function Gv(e){if(e=Xu(e)){if(typeof Og!="function")throw Error(pt(280));var n=e.stateNode;n&&(n=cf(n),Og(e.stateNode,e.type,n))}}function Xy(e){Ll?Ml?Ml.push(e):Ml=[e]:Ll=e}function $y(){if(Ll){var e=Ll,n=Ml;if(Ml=Ll=null,Gv(e),n)for(e=0;e<n.length;e++)Gv(n[e])}}function Yy(e,n){return e(n)}function Qy(){}var Xp=!1;function qy(e,n,s){if(Xp)return e(n,s);Xp=!0;try{return Yy(e,n,s)}finally{Xp=!1,(Ll!==null||Ml!==null)&&(Qy(),$y())}}function Su(e,n){var s=e.stateNode;if(s===null)return null;var a=cf(s);if(a===null)return null;s=a[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break t;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(pt(231,n,typeof s));return s}var Ng=!1;if(Ar)try{var tu={};Object.defineProperty(tu,"passive",{get:function(){Ng=!0}}),window.addEventListener("test",tu,tu),window.removeEventListener("test",tu,tu)}catch{Ng=!1}function ZE(e,n,s,a,u,d,_,v,x){var b=Array.prototype.slice.call(arguments,3);try{n.apply(s,b)}catch(E){this.onError(E)}}var pu=!1,Id=null,Dd=!1,Ug=null,KE={onError:function(e){pu=!0,Id=e}};function JE(e,n,s,a,u,d,_,v,x){pu=!1,Id=null,ZE.apply(KE,arguments)}function tT(e,n,s,a,u,d,_,v,x){if(JE.apply(this,arguments),pu){if(pu){var b=Id;pu=!1,Id=null}else throw Error(pt(198));Dd||(Dd=!0,Ug=b)}}function xa(e){var n=e,s=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(s=n.return),e=n.return;while(e)}return n.tag===3?s:null}function Zy(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Vv(e){if(xa(e)!==e)throw Error(pt(188))}function eT(e){var n=e.alternate;if(!n){if(n=xa(e),n===null)throw Error(pt(188));return n!==e?null:e}for(var s=e,a=n;;){var u=s.return;if(u===null)break;var d=u.alternate;if(d===null){if(a=u.return,a!==null){s=a;continue}break}if(u.child===d.child){for(d=u.child;d;){if(d===s)return Vv(u),e;if(d===a)return Vv(u),n;d=d.sibling}throw Error(pt(188))}if(s.return!==a.return)s=u,a=d;else{for(var _=!1,v=u.child;v;){if(v===s){_=!0,s=u,a=d;break}if(v===a){_=!0,a=u,s=d;break}v=v.sibling}if(!_){for(v=d.child;v;){if(v===s){_=!0,s=d,a=u;break}if(v===a){_=!0,a=d,s=u;break}v=v.sibling}if(!_)throw Error(pt(189))}}if(s.alternate!==a)throw Error(pt(190))}if(s.tag!==3)throw Error(pt(188));return s.stateNode.current===s?e:n}function Ky(e){return e=eT(e),e!==null?Jy(e):null}function Jy(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Jy(e);if(n!==null)return n;e=e.sibling}return null}var tw=Mn.unstable_scheduleCallback,Xv=Mn.unstable_cancelCallback,iT=Mn.unstable_shouldYield,nT=Mn.unstable_requestPaint,$e=Mn.unstable_now,sT=Mn.unstable_getCurrentPriorityLevel,N_=Mn.unstable_ImmediatePriority,ew=Mn.unstable_UserBlockingPriority,Fd=Mn.unstable_NormalPriority,rT=Mn.unstable_LowPriority,iw=Mn.unstable_IdlePriority,af=null,Zs=null;function oT(e){if(Zs&&typeof Zs.onCommitFiberRoot=="function")try{Zs.onCommitFiberRoot(af,e,void 0,(e.current.flags&128)===128)}catch{}}var Es=Math.clz32?Math.clz32:hT,aT=Math.log,lT=Math.LN2;function hT(e){return e>>>=0,e===0?32:31-(aT(e)/lT|0)|0}var ed=64,id=4194304;function cu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Bd(e,n){var s=e.pendingLanes;if(s===0)return 0;var a=0,u=e.suspendedLanes,d=e.pingedLanes,_=s&268435455;if(_!==0){var v=_&~u;v!==0?a=cu(v):(d&=_,d!==0&&(a=cu(d)))}else _=s&~u,_!==0?a=cu(_):d!==0&&(a=cu(d));if(a===0)return 0;if(n!==0&&n!==a&&!(n&u)&&(u=a&-a,d=n&-n,u>=d||u===16&&(d&4194240)!==0))return n;if(a&4&&(a|=s&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=a;0<n;)s=31-Es(n),u=1<<s,a|=e[s],n&=~u;return a}function uT(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cT(e,n){for(var s=e.suspendedLanes,a=e.pingedLanes,u=e.expirationTimes,d=e.pendingLanes;0<d;){var _=31-Es(d),v=1<<_,x=u[_];x===-1?(!(v&s)||v&a)&&(u[_]=uT(v,n)):x<=n&&(e.expiredLanes|=v),d&=~v}}function zg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function nw(){var e=ed;return ed<<=1,!(ed&4194240)&&(ed=64),e}function $p(e){for(var n=[],s=0;31>s;s++)n.push(e);return n}function Gu(e,n,s){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-Es(n),e[n]=s}function dT(e,n){var s=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var u=31-Es(s),d=1<<u;n[u]=0,a[u]=-1,e[u]=-1,s&=~d}}function U_(e,n){var s=e.entangledLanes|=n;for(e=e.entanglements;s;){var a=31-Es(s),u=1<<a;u&n|e[a]&n&&(e[a]|=n),s&=~u}}var fe=0;function sw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var rw,z_,ow,aw,lw,Hg=!1,nd=[],oo=null,ao=null,lo=null,Au=new Map,Eu=new Map,eo=[],fT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $v(e,n){switch(e){case"focusin":case"focusout":oo=null;break;case"dragenter":case"dragleave":ao=null;break;case"mouseover":case"mouseout":lo=null;break;case"pointerover":case"pointerout":Au.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Eu.delete(n.pointerId)}}function eu(e,n,s,a,u,d){return e===null||e.nativeEvent!==d?(e={blockedOn:n,domEventName:s,eventSystemFlags:a,nativeEvent:d,targetContainers:[u]},n!==null&&(n=Xu(n),n!==null&&z_(n)),e):(e.eventSystemFlags|=a,n=e.targetContainers,u!==null&&n.indexOf(u)===-1&&n.push(u),e)}function pT(e,n,s,a,u){switch(n){case"focusin":return oo=eu(oo,e,n,s,a,u),!0;case"dragenter":return ao=eu(ao,e,n,s,a,u),!0;case"mouseover":return lo=eu(lo,e,n,s,a,u),!0;case"pointerover":var d=u.pointerId;return Au.set(d,eu(Au.get(d)||null,e,n,s,a,u)),!0;case"gotpointercapture":return d=u.pointerId,Eu.set(d,eu(Eu.get(d)||null,e,n,s,a,u)),!0}return!1}function hw(e){var n=oa(e.target);if(n!==null){var s=xa(n);if(s!==null){if(n=s.tag,n===13){if(n=Zy(s),n!==null){e.blockedOn=n,lw(e.priority,function(){ow(s)});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _d(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var s=Wg(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var a=new s.constructor(s.type,s);Mg=a,s.target.dispatchEvent(a),Mg=null}else return n=Xu(s),n!==null&&z_(n),e.blockedOn=s,!1;n.shift()}return!0}function Yv(e,n,s){_d(e)&&s.delete(n)}function gT(){Hg=!1,oo!==null&&_d(oo)&&(oo=null),ao!==null&&_d(ao)&&(ao=null),lo!==null&&_d(lo)&&(lo=null),Au.forEach(Yv),Eu.forEach(Yv)}function iu(e,n){e.blockedOn===n&&(e.blockedOn=null,Hg||(Hg=!0,Mn.unstable_scheduleCallback(Mn.unstable_NormalPriority,gT)))}function Tu(e){function n(u){return iu(u,e)}if(0<nd.length){iu(nd[0],e);for(var s=1;s<nd.length;s++){var a=nd[s];a.blockedOn===e&&(a.blockedOn=null)}}for(oo!==null&&iu(oo,e),ao!==null&&iu(ao,e),lo!==null&&iu(lo,e),Au.forEach(n),Eu.forEach(n),s=0;s<eo.length;s++)a=eo[s],a.blockedOn===e&&(a.blockedOn=null);for(;0<eo.length&&(s=eo[0],s.blockedOn===null);)hw(s),s.blockedOn===null&&eo.shift()}var Ol=Rr.ReactCurrentBatchConfig,kd=!0;function _T(e,n,s,a){var u=fe,d=Ol.transition;Ol.transition=null;try{fe=1,H_(e,n,s,a)}finally{fe=u,Ol.transition=d}}function mT(e,n,s,a){var u=fe,d=Ol.transition;Ol.transition=null;try{fe=4,H_(e,n,s,a)}finally{fe=u,Ol.transition=d}}function H_(e,n,s,a){if(kd){var u=Wg(e,n,s,a);if(u===null)ng(e,n,a,Ld,s),$v(e,a);else if(pT(u,e,n,s,a))a.stopPropagation();else if($v(e,a),n&4&&-1<fT.indexOf(e)){for(;u!==null;){var d=Xu(u);if(d!==null&&rw(d),d=Wg(e,n,s,a),d===null&&ng(e,n,a,Ld,s),d===u)break;u=d}u!==null&&a.stopPropagation()}else ng(e,n,a,null,s)}}var Ld=null;function Wg(e,n,s,a){if(Ld=null,e=O_(a),e=oa(e),e!==null)if(n=xa(e),n===null)e=null;else if(s=n.tag,s===13){if(e=Zy(n),e!==null)return e;e=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Ld=e,null}function uw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sT()){case N_:return 1;case ew:return 4;case Fd:case rT:return 16;case iw:return 536870912;default:return 16}default:return 16}}var no=null,W_=null,md=null;function cw(){if(md)return md;var e,n=W_,s=n.length,a,u="value"in no?no.value:no.textContent,d=u.length;for(e=0;e<s&&n[e]===u[e];e++);var _=s-e;for(a=1;a<=_&&n[s-a]===u[d-a];a++);return md=u.slice(e,1<a?1-a:void 0)}function vd(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function sd(){return!0}function Qv(){return!1}function Nn(e){function n(s,a,u,d,_){this._reactName=s,this._targetInst=u,this.type=a,this.nativeEvent=d,this.target=_,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(s=e[v],this[v]=s?s(d):d[v]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?sd:Qv,this.isPropagationStopped=Qv,this}return ke(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=sd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=sd)},persist:function(){},isPersistent:sd}),n}var Yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},j_=Nn(Yl),Vu=ke({},Yl,{view:0,detail:0}),vT=Nn(Vu),Yp,Qp,nu,lf=ke({},Vu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:G_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==nu&&(nu&&e.type==="mousemove"?(Yp=e.screenX-nu.screenX,Qp=e.screenY-nu.screenY):Qp=Yp=0,nu=e),Yp)},movementY:function(e){return"movementY"in e?e.movementY:Qp}}),qv=Nn(lf),yT=ke({},lf,{dataTransfer:0}),wT=Nn(yT),xT=ke({},Vu,{relatedTarget:0}),qp=Nn(xT),bT=ke({},Yl,{animationName:0,elapsedTime:0,pseudoElement:0}),CT=Nn(bT),ST=ke({},Yl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),AT=Nn(ST),ET=ke({},Yl,{data:0}),Zv=Nn(ET),TT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},PT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function IT(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=RT[e])?!!n[e]:!1}function G_(){return IT}var DT=ke({},Vu,{key:function(e){if(e.key){var n=TT[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=vd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?PT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:G_,charCode:function(e){return e.type==="keypress"?vd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),FT=Nn(DT),BT=ke({},lf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kv=Nn(BT),kT=ke({},Vu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:G_}),LT=Nn(kT),MT=ke({},Yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),OT=Nn(MT),NT=ke({},lf,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),UT=Nn(NT),zT=[9,13,27,32],V_=Ar&&"CompositionEvent"in window,gu=null;Ar&&"documentMode"in document&&(gu=document.documentMode);var HT=Ar&&"TextEvent"in window&&!gu,dw=Ar&&(!V_||gu&&8<gu&&11>=gu),Jv=" ",t0=!1;function fw(e,n){switch(e){case"keyup":return zT.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Sl=!1;function WT(e,n){switch(e){case"compositionend":return pw(n);case"keypress":return n.which!==32?null:(t0=!0,Jv);case"textInput":return e=n.data,e===Jv&&t0?null:e;default:return null}}function jT(e,n){if(Sl)return e==="compositionend"||!V_&&fw(e,n)?(e=cw(),md=W_=no=null,Sl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return dw&&n.locale!=="ko"?null:n.data;default:return null}}var GT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function e0(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!GT[e.type]:n==="textarea"}function gw(e,n,s,a){Xy(a),n=Md(n,"onChange"),0<n.length&&(s=new j_("onChange","change",null,s,a),e.push({event:s,listeners:n}))}var _u=null,Pu=null;function VT(e){Ew(e,0)}function hf(e){var n=Tl(e);if(Uy(n))return e}function XT(e,n){if(e==="change")return n}var _w=!1;if(Ar){var Zp;if(Ar){var Kp="oninput"in document;if(!Kp){var i0=document.createElement("div");i0.setAttribute("oninput","return;"),Kp=typeof i0.oninput=="function"}Zp=Kp}else Zp=!1;_w=Zp&&(!document.documentMode||9<document.documentMode)}function n0(){_u&&(_u.detachEvent("onpropertychange",mw),Pu=_u=null)}function mw(e){if(e.propertyName==="value"&&hf(Pu)){var n=[];gw(n,Pu,e,O_(e)),qy(VT,n)}}function $T(e,n,s){e==="focusin"?(n0(),_u=n,Pu=s,_u.attachEvent("onpropertychange",mw)):e==="focusout"&&n0()}function YT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hf(Pu)}function QT(e,n){if(e==="click")return hf(n)}function qT(e,n){if(e==="input"||e==="change")return hf(n)}function ZT(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Ps=typeof Object.is=="function"?Object.is:ZT;function Ru(e,n){if(Ps(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var s=Object.keys(e),a=Object.keys(n);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var u=s[a];if(!Sg.call(n,u)||!Ps(e[u],n[u]))return!1}return!0}function s0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function r0(e,n){var s=s0(e);e=0;for(var a;s;){if(s.nodeType===3){if(a=e+s.textContent.length,e<=n&&a>=n)return{node:s,offset:n-e};e=a}t:{for(;s;){if(s.nextSibling){s=s.nextSibling;break t}s=s.parentNode}s=void 0}s=s0(s)}}function vw(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?vw(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function yw(){for(var e=window,n=Rd();n instanceof e.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)e=n.contentWindow;else break;n=Rd(e.document)}return n}function X_(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function KT(e){var n=yw(),s=e.focusedElem,a=e.selectionRange;if(n!==s&&s&&s.ownerDocument&&vw(s.ownerDocument.documentElement,s)){if(a!==null&&X_(s)){if(n=a.start,e=a.end,e===void 0&&(e=n),"selectionStart"in s)s.selectionStart=n,s.selectionEnd=Math.min(e,s.value.length);else if(e=(n=s.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var u=s.textContent.length,d=Math.min(a.start,u);a=a.end===void 0?d:Math.min(a.end,u),!e.extend&&d>a&&(u=a,a=d,d=u),u=r0(s,d);var _=r0(s,a);u&&_&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==_.node||e.focusOffset!==_.offset)&&(n=n.createRange(),n.setStart(u.node,u.offset),e.removeAllRanges(),d>a?(e.addRange(n),e.extend(_.node,_.offset)):(n.setEnd(_.node,_.offset),e.addRange(n)))}}for(n=[],e=s;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<n.length;s++)e=n[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var JT=Ar&&"documentMode"in document&&11>=document.documentMode,Al=null,jg=null,mu=null,Gg=!1;function o0(e,n,s){var a=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Gg||Al==null||Al!==Rd(a)||(a=Al,"selectionStart"in a&&X_(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),mu&&Ru(mu,a)||(mu=a,a=Md(jg,"onSelect"),0<a.length&&(n=new j_("onSelect","select",null,n,s),e.push({event:n,listeners:a}),n.target=Al)))}function rd(e,n){var s={};return s[e.toLowerCase()]=n.toLowerCase(),s["Webkit"+e]="webkit"+n,s["Moz"+e]="moz"+n,s}var El={animationend:rd("Animation","AnimationEnd"),animationiteration:rd("Animation","AnimationIteration"),animationstart:rd("Animation","AnimationStart"),transitionend:rd("Transition","TransitionEnd")},Jp={},ww={};Ar&&(ww=document.createElement("div").style,"AnimationEvent"in window||(delete El.animationend.animation,delete El.animationiteration.animation,delete El.animationstart.animation),"TransitionEvent"in window||delete El.transitionend.transition);function uf(e){if(Jp[e])return Jp[e];if(!El[e])return e;var n=El[e],s;for(s in n)if(n.hasOwnProperty(s)&&s in ww)return Jp[e]=n[s];return e}var xw=uf("animationend"),bw=uf("animationiteration"),Cw=uf("animationstart"),Sw=uf("transitionend"),Aw=new Map,a0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mo(e,n){Aw.set(e,n),wa(n,[e])}for(var tg=0;tg<a0.length;tg++){var eg=a0[tg],tP=eg.toLowerCase(),eP=eg[0].toUpperCase()+eg.slice(1);mo(tP,"on"+eP)}mo(xw,"onAnimationEnd");mo(bw,"onAnimationIteration");mo(Cw,"onAnimationStart");mo("dblclick","onDoubleClick");mo("focusin","onFocus");mo("focusout","onBlur");mo(Sw,"onTransitionEnd");zl("onMouseEnter",["mouseout","mouseover"]);zl("onMouseLeave",["mouseout","mouseover"]);zl("onPointerEnter",["pointerout","pointerover"]);zl("onPointerLeave",["pointerout","pointerover"]);wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wa("onBeforeInput",["compositionend","keypress","textInput","paste"]);wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iP=new Set("cancel close invalid load scroll toggle".split(" ").concat(du));function l0(e,n,s){var a=e.type||"unknown-event";e.currentTarget=s,tT(a,n,void 0,e),e.currentTarget=null}function Ew(e,n){n=(n&4)!==0;for(var s=0;s<e.length;s++){var a=e[s],u=a.event;a=a.listeners;t:{var d=void 0;if(n)for(var _=a.length-1;0<=_;_--){var v=a[_],x=v.instance,b=v.currentTarget;if(v=v.listener,x!==d&&u.isPropagationStopped())break t;l0(u,v,b),d=x}else for(_=0;_<a.length;_++){if(v=a[_],x=v.instance,b=v.currentTarget,v=v.listener,x!==d&&u.isPropagationStopped())break t;l0(u,v,b),d=x}}}if(Dd)throw e=Ug,Dd=!1,Ug=null,e}function xe(e,n){var s=n[Qg];s===void 0&&(s=n[Qg]=new Set);var a=e+"__bubble";s.has(a)||(Tw(n,e,2,!1),s.add(a))}function ig(e,n,s){var a=0;n&&(a|=4),Tw(s,e,a,n)}var od="_reactListening"+Math.random().toString(36).slice(2);function Iu(e){if(!e[od]){e[od]=!0,ky.forEach(function(s){s!=="selectionchange"&&(iP.has(s)||ig(s,!1,e),ig(s,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[od]||(n[od]=!0,ig("selectionchange",!1,n))}}function Tw(e,n,s,a){switch(uw(n)){case 1:var u=_T;break;case 4:u=mT;break;default:u=H_}s=u.bind(null,n,s,e),u=void 0,!Ng||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(u=!0),a?u!==void 0?e.addEventListener(n,s,{capture:!0,passive:u}):e.addEventListener(n,s,!0):u!==void 0?e.addEventListener(n,s,{passive:u}):e.addEventListener(n,s,!1)}function ng(e,n,s,a,u){var d=a;if(!(n&1)&&!(n&2)&&a!==null)t:for(;;){if(a===null)return;var _=a.tag;if(_===3||_===4){var v=a.stateNode.containerInfo;if(v===u||v.nodeType===8&&v.parentNode===u)break;if(_===4)for(_=a.return;_!==null;){var x=_.tag;if((x===3||x===4)&&(x=_.stateNode.containerInfo,x===u||x.nodeType===8&&x.parentNode===u))return;_=_.return}for(;v!==null;){if(_=oa(v),_===null)return;if(x=_.tag,x===5||x===6){a=d=_;continue t}v=v.parentNode}}a=a.return}qy(function(){var b=d,E=O_(s),R=[];t:{var L=Aw.get(e);if(L!==void 0){var U=j_,H=e;switch(e){case"keypress":if(vd(s)===0)break t;case"keydown":case"keyup":U=FT;break;case"focusin":H="focus",U=qp;break;case"focusout":H="blur",U=qp;break;case"beforeblur":case"afterblur":U=qp;break;case"click":if(s.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=qv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=wT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=LT;break;case xw:case bw:case Cw:U=CT;break;case Sw:U=OT;break;case"scroll":U=vT;break;case"wheel":U=UT;break;case"copy":case"cut":case"paste":U=AT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=Kv}var $=(n&4)!==0,G=!$&&e==="scroll",k=$?L!==null?L+"Capture":null:L;$=[];for(var B=b,N;B!==null;){N=B;var J=N.stateNode;if(N.tag===5&&J!==null&&(N=J,k!==null&&(J=Su(B,k),J!=null&&$.push(Du(B,J,N)))),G)break;B=B.return}0<$.length&&(L=new U(L,H,null,s,E),R.push({event:L,listeners:$}))}}if(!(n&7)){t:{if(L=e==="mouseover"||e==="pointerover",U=e==="mouseout"||e==="pointerout",L&&s!==Mg&&(H=s.relatedTarget||s.fromElement)&&(oa(H)||H[Er]))break t;if((U||L)&&(L=E.window===E?E:(L=E.ownerDocument)?L.defaultView||L.parentWindow:window,U?(H=s.relatedTarget||s.toElement,U=b,H=H?oa(H):null,H!==null&&(G=xa(H),H!==G||H.tag!==5&&H.tag!==6)&&(H=null)):(U=null,H=b),U!==H)){if($=qv,J="onMouseLeave",k="onMouseEnter",B="mouse",(e==="pointerout"||e==="pointerover")&&($=Kv,J="onPointerLeave",k="onPointerEnter",B="pointer"),G=U==null?L:Tl(U),N=H==null?L:Tl(H),L=new $(J,B+"leave",U,s,E),L.target=G,L.relatedTarget=N,J=null,oa(E)===b&&($=new $(k,B+"enter",H,s,E),$.target=N,$.relatedTarget=G,J=$),G=J,U&&H)e:{for($=U,k=H,B=0,N=$;N;N=xl(N))B++;for(N=0,J=k;J;J=xl(J))N++;for(;0<B-N;)$=xl($),B--;for(;0<N-B;)k=xl(k),N--;for(;B--;){if($===k||k!==null&&$===k.alternate)break e;$=xl($),k=xl(k)}$=null}else $=null;U!==null&&h0(R,L,U,$,!1),H!==null&&G!==null&&h0(R,G,H,$,!0)}}t:{if(L=b?Tl(b):window,U=L.nodeName&&L.nodeName.toLowerCase(),U==="select"||U==="input"&&L.type==="file")var K=XT;else if(e0(L))if(_w)K=qT;else{K=YT;var ft=$T}else(U=L.nodeName)&&U.toLowerCase()==="input"&&(L.type==="checkbox"||L.type==="radio")&&(K=QT);if(K&&(K=K(e,b))){gw(R,K,s,E);break t}ft&&ft(e,L,b),e==="focusout"&&(ft=L._wrapperState)&&ft.controlled&&L.type==="number"&&Dg(L,"number",L.value)}switch(ft=b?Tl(b):window,e){case"focusin":(e0(ft)||ft.contentEditable==="true")&&(Al=ft,jg=b,mu=null);break;case"focusout":mu=jg=Al=null;break;case"mousedown":Gg=!0;break;case"contextmenu":case"mouseup":case"dragend":Gg=!1,o0(R,s,E);break;case"selectionchange":if(JT)break;case"keydown":case"keyup":o0(R,s,E)}var D;if(V_)t:{switch(e){case"compositionstart":var j="onCompositionStart";break t;case"compositionend":j="onCompositionEnd";break t;case"compositionupdate":j="onCompositionUpdate";break t}j=void 0}else Sl?fw(e,s)&&(j="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(j="onCompositionStart");j&&(dw&&s.locale!=="ko"&&(Sl||j!=="onCompositionStart"?j==="onCompositionEnd"&&Sl&&(D=cw()):(no=E,W_="value"in no?no.value:no.textContent,Sl=!0)),ft=Md(b,j),0<ft.length&&(j=new Zv(j,e,null,s,E),R.push({event:j,listeners:ft}),D?j.data=D:(D=pw(s),D!==null&&(j.data=D)))),(D=HT?WT(e,s):jT(e,s))&&(b=Md(b,"onBeforeInput"),0<b.length&&(E=new Zv("onBeforeInput","beforeinput",null,s,E),R.push({event:E,listeners:b}),E.data=D))}Ew(R,n)})}function Du(e,n,s){return{instance:e,listener:n,currentTarget:s}}function Md(e,n){for(var s=n+"Capture",a=[];e!==null;){var u=e,d=u.stateNode;u.tag===5&&d!==null&&(u=d,d=Su(e,s),d!=null&&a.unshift(Du(e,d,u)),d=Su(e,n),d!=null&&a.push(Du(e,d,u))),e=e.return}return a}function xl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function h0(e,n,s,a,u){for(var d=n._reactName,_=[];s!==null&&s!==a;){var v=s,x=v.alternate,b=v.stateNode;if(x!==null&&x===a)break;v.tag===5&&b!==null&&(v=b,u?(x=Su(s,d),x!=null&&_.unshift(Du(s,x,v))):u||(x=Su(s,d),x!=null&&_.push(Du(s,x,v)))),s=s.return}_.length!==0&&e.push({event:n,listeners:_})}var nP=/\r\n?/g,sP=/\u0000|\uFFFD/g;function u0(e){return(typeof e=="string"?e:""+e).replace(nP,`
`).replace(sP,"")}function ad(e,n,s){if(n=u0(n),u0(e)!==n&&s)throw Error(pt(425))}function Od(){}var Vg=null,Xg=null;function $g(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Yg=typeof setTimeout=="function"?setTimeout:void 0,rP=typeof clearTimeout=="function"?clearTimeout:void 0,c0=typeof Promise=="function"?Promise:void 0,oP=typeof queueMicrotask=="function"?queueMicrotask:typeof c0<"u"?function(e){return c0.resolve(null).then(e).catch(aP)}:Yg;function aP(e){setTimeout(function(){throw e})}function sg(e,n){var s=n,a=0;do{var u=s.nextSibling;if(e.removeChild(s),u&&u.nodeType===8)if(s=u.data,s==="/$"){if(a===0){e.removeChild(u),Tu(n);return}a--}else s!=="$"&&s!=="$?"&&s!=="$!"||a++;s=u}while(s);Tu(n)}function ho(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function d0(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return e;n--}else s==="/$"&&n++}e=e.previousSibling}return null}var Ql=Math.random().toString(36).slice(2),qs="__reactFiber$"+Ql,Fu="__reactProps$"+Ql,Er="__reactContainer$"+Ql,Qg="__reactEvents$"+Ql,lP="__reactListeners$"+Ql,hP="__reactHandles$"+Ql;function oa(e){var n=e[qs];if(n)return n;for(var s=e.parentNode;s;){if(n=s[Er]||s[qs]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(e=d0(e);e!==null;){if(s=e[qs])return s;e=d0(e)}return n}e=s,s=e.parentNode}return null}function Xu(e){return e=e[qs]||e[Er],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Tl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pt(33))}function cf(e){return e[Fu]||null}var qg=[],Pl=-1;function vo(e){return{current:e}}function be(e){0>Pl||(e.current=qg[Pl],qg[Pl]=null,Pl--)}function me(e,n){Pl++,qg[Pl]=e.current,e.current=n}var _o={},Gi=vo(_o),pn=vo(!1),pa=_o;function Hl(e,n){var s=e.type.contextTypes;if(!s)return _o;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===n)return a.__reactInternalMemoizedMaskedChildContext;var u={},d;for(d in s)u[d]=n[d];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=u),u}function gn(e){return e=e.childContextTypes,e!=null}function Nd(){be(pn),be(Gi)}function f0(e,n,s){if(Gi.current!==_o)throw Error(pt(168));me(Gi,n),me(pn,s)}function Pw(e,n,s){var a=e.stateNode;if(n=n.childContextTypes,typeof a.getChildContext!="function")return s;a=a.getChildContext();for(var u in a)if(!(u in n))throw Error(pt(108,$E(e)||"Unknown",u));return ke({},s,a)}function Ud(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_o,pa=Gi.current,me(Gi,e),me(pn,pn.current),!0}function p0(e,n,s){var a=e.stateNode;if(!a)throw Error(pt(169));s?(e=Pw(e,n,pa),a.__reactInternalMemoizedMergedChildContext=e,be(pn),be(Gi),me(Gi,e)):be(pn),me(pn,s)}var wr=null,df=!1,rg=!1;function Rw(e){wr===null?wr=[e]:wr.push(e)}function uP(e){df=!0,Rw(e)}function yo(){if(!rg&&wr!==null){rg=!0;var e=0,n=fe;try{var s=wr;for(fe=1;e<s.length;e++){var a=s[e];do a=a(!0);while(a!==null)}wr=null,df=!1}catch(u){throw wr!==null&&(wr=wr.slice(e+1)),tw(N_,yo),u}finally{fe=n,rg=!1}}return null}var Rl=[],Il=0,zd=null,Hd=0,qn=[],Zn=0,ga=null,xr=1,br="";function sa(e,n){Rl[Il++]=Hd,Rl[Il++]=zd,zd=e,Hd=n}function Iw(e,n,s){qn[Zn++]=xr,qn[Zn++]=br,qn[Zn++]=ga,ga=e;var a=xr;e=br;var u=32-Es(a)-1;a&=~(1<<u),s+=1;var d=32-Es(n)+u;if(30<d){var _=u-u%5;d=(a&(1<<_)-1).toString(32),a>>=_,u-=_,xr=1<<32-Es(n)+u|s<<u|a,br=d+e}else xr=1<<d|s<<u|a,br=e}function $_(e){e.return!==null&&(sa(e,1),Iw(e,1,0))}function Y_(e){for(;e===zd;)zd=Rl[--Il],Rl[Il]=null,Hd=Rl[--Il],Rl[Il]=null;for(;e===ga;)ga=qn[--Zn],qn[Zn]=null,br=qn[--Zn],qn[Zn]=null,xr=qn[--Zn],qn[Zn]=null}var Bn=null,Fn=null,Te=!1,As=null;function Dw(e,n){var s=Kn(5,null,null,0);s.elementType="DELETED",s.stateNode=n,s.return=e,n=e.deletions,n===null?(e.deletions=[s],e.flags|=16):n.push(s)}function g0(e,n){switch(e.tag){case 5:var s=e.type;return n=n.nodeType!==1||s.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Bn=e,Fn=ho(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Bn=e,Fn=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(s=ga!==null?{id:xr,overflow:br}:null,e.memoizedState={dehydrated:n,treeContext:s,retryLane:1073741824},s=Kn(18,null,null,0),s.stateNode=n,s.return=e,e.child=s,Bn=e,Fn=null,!0):!1;default:return!1}}function Zg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Kg(e){if(Te){var n=Fn;if(n){var s=n;if(!g0(e,n)){if(Zg(e))throw Error(pt(418));n=ho(s.nextSibling);var a=Bn;n&&g0(e,n)?Dw(a,s):(e.flags=e.flags&-4097|2,Te=!1,Bn=e)}}else{if(Zg(e))throw Error(pt(418));e.flags=e.flags&-4097|2,Te=!1,Bn=e}}}function _0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Bn=e}function ld(e){if(e!==Bn)return!1;if(!Te)return _0(e),Te=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!$g(e.type,e.memoizedProps)),n&&(n=Fn)){if(Zg(e))throw Fw(),Error(pt(418));for(;n;)Dw(e,n),n=ho(n.nextSibling)}if(_0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pt(317));t:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(n===0){Fn=ho(e.nextSibling);break t}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++}e=e.nextSibling}Fn=null}}else Fn=Bn?ho(e.stateNode.nextSibling):null;return!0}function Fw(){for(var e=Fn;e;)e=ho(e.nextSibling)}function Wl(){Fn=Bn=null,Te=!1}function Q_(e){As===null?As=[e]:As.push(e)}var cP=Rr.ReactCurrentBatchConfig;function su(e,n,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(pt(309));var a=s.stateNode}if(!a)throw Error(pt(147,e));var u=a,d=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===d?n.ref:(n=function(_){var v=u.refs;_===null?delete v[d]:v[d]=_},n._stringRef=d,n)}if(typeof e!="string")throw Error(pt(284));if(!s._owner)throw Error(pt(290,e))}return e}function hd(e,n){throw e=Object.prototype.toString.call(n),Error(pt(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function m0(e){var n=e._init;return n(e._payload)}function Bw(e){function n(k,B){if(e){var N=k.deletions;N===null?(k.deletions=[B],k.flags|=16):N.push(B)}}function s(k,B){if(!e)return null;for(;B!==null;)n(k,B),B=B.sibling;return null}function a(k,B){for(k=new Map;B!==null;)B.key!==null?k.set(B.key,B):k.set(B.index,B),B=B.sibling;return k}function u(k,B){return k=po(k,B),k.index=0,k.sibling=null,k}function d(k,B,N){return k.index=N,e?(N=k.alternate,N!==null?(N=N.index,N<B?(k.flags|=2,B):N):(k.flags|=2,B)):(k.flags|=1048576,B)}function _(k){return e&&k.alternate===null&&(k.flags|=2),k}function v(k,B,N,J){return B===null||B.tag!==6?(B=dg(N,k.mode,J),B.return=k,B):(B=u(B,N),B.return=k,B)}function x(k,B,N,J){var K=N.type;return K===Cl?E(k,B,N.props.children,J,N.key):B!==null&&(B.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Jr&&m0(K)===B.type)?(J=u(B,N.props),J.ref=su(k,B,N),J.return=k,J):(J=Ad(N.type,N.key,N.props,null,k.mode,J),J.ref=su(k,B,N),J.return=k,J)}function b(k,B,N,J){return B===null||B.tag!==4||B.stateNode.containerInfo!==N.containerInfo||B.stateNode.implementation!==N.implementation?(B=fg(N,k.mode,J),B.return=k,B):(B=u(B,N.children||[]),B.return=k,B)}function E(k,B,N,J,K){return B===null||B.tag!==7?(B=ca(N,k.mode,J,K),B.return=k,B):(B=u(B,N),B.return=k,B)}function R(k,B,N){if(typeof B=="string"&&B!==""||typeof B=="number")return B=dg(""+B,k.mode,N),B.return=k,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Kc:return N=Ad(B.type,B.key,B.props,null,k.mode,N),N.ref=su(k,null,B),N.return=k,N;case bl:return B=fg(B,k.mode,N),B.return=k,B;case Jr:var J=B._init;return R(k,J(B._payload),N)}if(uu(B)||Jh(B))return B=ca(B,k.mode,N,null),B.return=k,B;hd(k,B)}return null}function L(k,B,N,J){var K=B!==null?B.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return K!==null?null:v(k,B,""+N,J);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Kc:return N.key===K?x(k,B,N,J):null;case bl:return N.key===K?b(k,B,N,J):null;case Jr:return K=N._init,L(k,B,K(N._payload),J)}if(uu(N)||Jh(N))return K!==null?null:E(k,B,N,J,null);hd(k,N)}return null}function U(k,B,N,J,K){if(typeof J=="string"&&J!==""||typeof J=="number")return k=k.get(N)||null,v(B,k,""+J,K);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case Kc:return k=k.get(J.key===null?N:J.key)||null,x(B,k,J,K);case bl:return k=k.get(J.key===null?N:J.key)||null,b(B,k,J,K);case Jr:var ft=J._init;return U(k,B,N,ft(J._payload),K)}if(uu(J)||Jh(J))return k=k.get(N)||null,E(B,k,J,K,null);hd(B,J)}return null}function H(k,B,N,J){for(var K=null,ft=null,D=B,j=B=0,nt=null;D!==null&&j<N.length;j++){D.index>j?(nt=D,D=null):nt=D.sibling;var bt=L(k,D,N[j],J);if(bt===null){D===null&&(D=nt);break}e&&D&&bt.alternate===null&&n(k,D),B=d(bt,B,j),ft===null?K=bt:ft.sibling=bt,ft=bt,D=nt}if(j===N.length)return s(k,D),Te&&sa(k,j),K;if(D===null){for(;j<N.length;j++)D=R(k,N[j],J),D!==null&&(B=d(D,B,j),ft===null?K=D:ft.sibling=D,ft=D);return Te&&sa(k,j),K}for(D=a(k,D);j<N.length;j++)nt=U(D,k,j,N[j],J),nt!==null&&(e&&nt.alternate!==null&&D.delete(nt.key===null?j:nt.key),B=d(nt,B,j),ft===null?K=nt:ft.sibling=nt,ft=nt);return e&&D.forEach(function(Et){return n(k,Et)}),Te&&sa(k,j),K}function $(k,B,N,J){var K=Jh(N);if(typeof K!="function")throw Error(pt(150));if(N=K.call(N),N==null)throw Error(pt(151));for(var ft=K=null,D=B,j=B=0,nt=null,bt=N.next();D!==null&&!bt.done;j++,bt=N.next()){D.index>j?(nt=D,D=null):nt=D.sibling;var Et=L(k,D,bt.value,J);if(Et===null){D===null&&(D=nt);break}e&&D&&Et.alternate===null&&n(k,D),B=d(Et,B,j),ft===null?K=Et:ft.sibling=Et,ft=Et,D=nt}if(bt.done)return s(k,D),Te&&sa(k,j),K;if(D===null){for(;!bt.done;j++,bt=N.next())bt=R(k,bt.value,J),bt!==null&&(B=d(bt,B,j),ft===null?K=bt:ft.sibling=bt,ft=bt);return Te&&sa(k,j),K}for(D=a(k,D);!bt.done;j++,bt=N.next())bt=U(D,k,j,bt.value,J),bt!==null&&(e&&bt.alternate!==null&&D.delete(bt.key===null?j:bt.key),B=d(bt,B,j),ft===null?K=bt:ft.sibling=bt,ft=bt);return e&&D.forEach(function(gt){return n(k,gt)}),Te&&sa(k,j),K}function G(k,B,N,J){if(typeof N=="object"&&N!==null&&N.type===Cl&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case Kc:t:{for(var K=N.key,ft=B;ft!==null;){if(ft.key===K){if(K=N.type,K===Cl){if(ft.tag===7){s(k,ft.sibling),B=u(ft,N.props.children),B.return=k,k=B;break t}}else if(ft.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Jr&&m0(K)===ft.type){s(k,ft.sibling),B=u(ft,N.props),B.ref=su(k,ft,N),B.return=k,k=B;break t}s(k,ft);break}else n(k,ft);ft=ft.sibling}N.type===Cl?(B=ca(N.props.children,k.mode,J,N.key),B.return=k,k=B):(J=Ad(N.type,N.key,N.props,null,k.mode,J),J.ref=su(k,B,N),J.return=k,k=J)}return _(k);case bl:t:{for(ft=N.key;B!==null;){if(B.key===ft)if(B.tag===4&&B.stateNode.containerInfo===N.containerInfo&&B.stateNode.implementation===N.implementation){s(k,B.sibling),B=u(B,N.children||[]),B.return=k,k=B;break t}else{s(k,B);break}else n(k,B);B=B.sibling}B=fg(N,k.mode,J),B.return=k,k=B}return _(k);case Jr:return ft=N._init,G(k,B,ft(N._payload),J)}if(uu(N))return H(k,B,N,J);if(Jh(N))return $(k,B,N,J);hd(k,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,B!==null&&B.tag===6?(s(k,B.sibling),B=u(B,N),B.return=k,k=B):(s(k,B),B=dg(N,k.mode,J),B.return=k,k=B),_(k)):s(k,B)}return G}var jl=Bw(!0),kw=Bw(!1),Wd=vo(null),jd=null,Dl=null,q_=null;function Z_(){q_=Dl=jd=null}function K_(e){var n=Wd.current;be(Wd),e._currentValue=n}function Jg(e,n,s){for(;e!==null;){var a=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,a!==null&&(a.childLanes|=n)):a!==null&&(a.childLanes&n)!==n&&(a.childLanes|=n),e===s)break;e=e.return}}function Nl(e,n){jd=e,q_=Dl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(fn=!0),e.firstContext=null)}function ts(e){var n=e._currentValue;if(q_!==e)if(e={context:e,memoizedValue:n,next:null},Dl===null){if(jd===null)throw Error(pt(308));Dl=e,jd.dependencies={lanes:0,firstContext:e}}else Dl=Dl.next=e;return n}var aa=null;function J_(e){aa===null?aa=[e]:aa.push(e)}function Lw(e,n,s,a){var u=n.interleaved;return u===null?(s.next=s,J_(n)):(s.next=u.next,u.next=s),n.interleaved=s,Tr(e,a)}function Tr(e,n){e.lanes|=n;var s=e.alternate;for(s!==null&&(s.lanes|=n),s=e,e=e.return;e!==null;)e.childLanes|=n,s=e.alternate,s!==null&&(s.childLanes|=n),s=e,e=e.return;return s.tag===3?s.stateNode:null}var to=!1;function tm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mw(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sr(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function uo(e,n,s){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,ee&2){var u=a.pending;return u===null?n.next=n:(n.next=u.next,u.next=n),a.pending=n,Tr(e,s)}return u=a.interleaved,u===null?(n.next=n,J_(a)):(n.next=u.next,u.next=n),a.interleaved=n,Tr(e,s)}function yd(e,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194240)!==0)){var a=n.lanes;a&=e.pendingLanes,s|=a,n.lanes=s,U_(e,s)}}function v0(e,n){var s=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,s===a)){var u=null,d=null;if(s=s.firstBaseUpdate,s!==null){do{var _={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};d===null?u=d=_:d=d.next=_,s=s.next}while(s!==null);d===null?u=d=n:d=d.next=n}else u=d=n;s={baseState:a.baseState,firstBaseUpdate:u,lastBaseUpdate:d,shared:a.shared,effects:a.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=n:e.next=n,s.lastBaseUpdate=n}function Gd(e,n,s,a){var u=e.updateQueue;to=!1;var d=u.firstBaseUpdate,_=u.lastBaseUpdate,v=u.shared.pending;if(v!==null){u.shared.pending=null;var x=v,b=x.next;x.next=null,_===null?d=b:_.next=b,_=x;var E=e.alternate;E!==null&&(E=E.updateQueue,v=E.lastBaseUpdate,v!==_&&(v===null?E.firstBaseUpdate=b:v.next=b,E.lastBaseUpdate=x))}if(d!==null){var R=u.baseState;_=0,E=b=x=null,v=d;do{var L=v.lane,U=v.eventTime;if((a&L)===L){E!==null&&(E=E.next={eventTime:U,lane:0,tag:v.tag,payload:v.payload,callback:v.callback,next:null});t:{var H=e,$=v;switch(L=n,U=s,$.tag){case 1:if(H=$.payload,typeof H=="function"){R=H.call(U,R,L);break t}R=H;break t;case 3:H.flags=H.flags&-65537|128;case 0:if(H=$.payload,L=typeof H=="function"?H.call(U,R,L):H,L==null)break t;R=ke({},R,L);break t;case 2:to=!0}}v.callback!==null&&v.lane!==0&&(e.flags|=64,L=u.effects,L===null?u.effects=[v]:L.push(v))}else U={eventTime:U,lane:L,tag:v.tag,payload:v.payload,callback:v.callback,next:null},E===null?(b=E=U,x=R):E=E.next=U,_|=L;if(v=v.next,v===null){if(v=u.shared.pending,v===null)break;L=v,v=L.next,L.next=null,u.lastBaseUpdate=L,u.shared.pending=null}}while(!0);if(E===null&&(x=R),u.baseState=x,u.firstBaseUpdate=b,u.lastBaseUpdate=E,n=u.shared.interleaved,n!==null){u=n;do _|=u.lane,u=u.next;while(u!==n)}else d===null&&(u.shared.lanes=0);ma|=_,e.lanes=_,e.memoizedState=R}}function y0(e,n,s){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var a=e[n],u=a.callback;if(u!==null){if(a.callback=null,a=s,typeof u!="function")throw Error(pt(191,u));u.call(a)}}}var $u={},Ks=vo($u),Bu=vo($u),ku=vo($u);function la(e){if(e===$u)throw Error(pt(174));return e}function em(e,n){switch(me(ku,n),me(Bu,e),me(Ks,$u),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:Bg(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=Bg(n,e)}be(Ks),me(Ks,n)}function Gl(){be(Ks),be(Bu),be(ku)}function Ow(e){la(ku.current);var n=la(Ks.current),s=Bg(n,e.type);n!==s&&(me(Bu,e),me(Ks,s))}function im(e){Bu.current===e&&(be(Ks),be(Bu))}var Fe=vo(0);function Vd(e){for(var n=e;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var og=[];function nm(){for(var e=0;e<og.length;e++)og[e]._workInProgressVersionPrimary=null;og.length=0}var wd=Rr.ReactCurrentDispatcher,ag=Rr.ReactCurrentBatchConfig,_a=0,Be=null,ci=null,wi=null,Xd=!1,vu=!1,Lu=0,dP=0;function Hi(){throw Error(pt(321))}function sm(e,n){if(n===null)return!1;for(var s=0;s<n.length&&s<e.length;s++)if(!Ps(e[s],n[s]))return!1;return!0}function rm(e,n,s,a,u,d){if(_a=d,Be=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,wd.current=e===null||e.memoizedState===null?_P:mP,e=s(a,u),vu){d=0;do{if(vu=!1,Lu=0,25<=d)throw Error(pt(301));d+=1,wi=ci=null,n.updateQueue=null,wd.current=vP,e=s(a,u)}while(vu)}if(wd.current=$d,n=ci!==null&&ci.next!==null,_a=0,wi=ci=Be=null,Xd=!1,n)throw Error(pt(300));return e}function om(){var e=Lu!==0;return Lu=0,e}function Qs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wi===null?Be.memoizedState=wi=e:wi=wi.next=e,wi}function es(){if(ci===null){var e=Be.alternate;e=e!==null?e.memoizedState:null}else e=ci.next;var n=wi===null?Be.memoizedState:wi.next;if(n!==null)wi=n,ci=e;else{if(e===null)throw Error(pt(310));ci=e,e={memoizedState:ci.memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},wi===null?Be.memoizedState=wi=e:wi=wi.next=e}return wi}function Mu(e,n){return typeof n=="function"?n(e):n}function lg(e){var n=es(),s=n.queue;if(s===null)throw Error(pt(311));s.lastRenderedReducer=e;var a=ci,u=a.baseQueue,d=s.pending;if(d!==null){if(u!==null){var _=u.next;u.next=d.next,d.next=_}a.baseQueue=u=d,s.pending=null}if(u!==null){d=u.next,a=a.baseState;var v=_=null,x=null,b=d;do{var E=b.lane;if((_a&E)===E)x!==null&&(x=x.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),a=b.hasEagerState?b.eagerState:e(a,b.action);else{var R={lane:E,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};x===null?(v=x=R,_=a):x=x.next=R,Be.lanes|=E,ma|=E}b=b.next}while(b!==null&&b!==d);x===null?_=a:x.next=v,Ps(a,n.memoizedState)||(fn=!0),n.memoizedState=a,n.baseState=_,n.baseQueue=x,s.lastRenderedState=a}if(e=s.interleaved,e!==null){u=e;do d=u.lane,Be.lanes|=d,ma|=d,u=u.next;while(u!==e)}else u===null&&(s.lanes=0);return[n.memoizedState,s.dispatch]}function hg(e){var n=es(),s=n.queue;if(s===null)throw Error(pt(311));s.lastRenderedReducer=e;var a=s.dispatch,u=s.pending,d=n.memoizedState;if(u!==null){s.pending=null;var _=u=u.next;do d=e(d,_.action),_=_.next;while(_!==u);Ps(d,n.memoizedState)||(fn=!0),n.memoizedState=d,n.baseQueue===null&&(n.baseState=d),s.lastRenderedState=d}return[d,a]}function Nw(){}function Uw(e,n){var s=Be,a=es(),u=n(),d=!Ps(a.memoizedState,u);if(d&&(a.memoizedState=u,fn=!0),a=a.queue,am(Ww.bind(null,s,a,e),[e]),a.getSnapshot!==n||d||wi!==null&&wi.memoizedState.tag&1){if(s.flags|=2048,Ou(9,Hw.bind(null,s,a,u,n),void 0,null),xi===null)throw Error(pt(349));_a&30||zw(s,n,u)}return u}function zw(e,n,s){e.flags|=16384,e={getSnapshot:n,value:s},n=Be.updateQueue,n===null?(n={lastEffect:null,stores:null},Be.updateQueue=n,n.stores=[e]):(s=n.stores,s===null?n.stores=[e]:s.push(e))}function Hw(e,n,s,a){n.value=s,n.getSnapshot=a,jw(n)&&Gw(e)}function Ww(e,n,s){return s(function(){jw(n)&&Gw(e)})}function jw(e){var n=e.getSnapshot;e=e.value;try{var s=n();return!Ps(e,s)}catch{return!0}}function Gw(e){var n=Tr(e,1);n!==null&&Ts(n,e,1,-1)}function w0(e){var n=Qs();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mu,lastRenderedState:e},n.queue=e,e=e.dispatch=gP.bind(null,Be,e),[n.memoizedState,e]}function Ou(e,n,s,a){return e={tag:e,create:n,destroy:s,deps:a,next:null},n=Be.updateQueue,n===null?(n={lastEffect:null,stores:null},Be.updateQueue=n,n.lastEffect=e.next=e):(s=n.lastEffect,s===null?n.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,n.lastEffect=e)),e}function Vw(){return es().memoizedState}function xd(e,n,s,a){var u=Qs();Be.flags|=e,u.memoizedState=Ou(1|n,s,void 0,a===void 0?null:a)}function ff(e,n,s,a){var u=es();a=a===void 0?null:a;var d=void 0;if(ci!==null){var _=ci.memoizedState;if(d=_.destroy,a!==null&&sm(a,_.deps)){u.memoizedState=Ou(n,s,d,a);return}}Be.flags|=e,u.memoizedState=Ou(1|n,s,d,a)}function x0(e,n){return xd(8390656,8,e,n)}function am(e,n){return ff(2048,8,e,n)}function Xw(e,n){return ff(4,2,e,n)}function $w(e,n){return ff(4,4,e,n)}function Yw(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Qw(e,n,s){return s=s!=null?s.concat([e]):null,ff(4,4,Yw.bind(null,n,e),s)}function lm(){}function qw(e,n){var s=es();n=n===void 0?null:n;var a=s.memoizedState;return a!==null&&n!==null&&sm(n,a[1])?a[0]:(s.memoizedState=[e,n],e)}function Zw(e,n){var s=es();n=n===void 0?null:n;var a=s.memoizedState;return a!==null&&n!==null&&sm(n,a[1])?a[0]:(e=e(),s.memoizedState=[e,n],e)}function Kw(e,n,s){return _a&21?(Ps(s,n)||(s=nw(),Be.lanes|=s,ma|=s,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,fn=!0),e.memoizedState=s)}function fP(e,n){var s=fe;fe=s!==0&&4>s?s:4,e(!0);var a=ag.transition;ag.transition={};try{e(!1),n()}finally{fe=s,ag.transition=a}}function Jw(){return es().memoizedState}function pP(e,n,s){var a=fo(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},tx(e))ex(n,s);else if(s=Lw(e,n,s,a),s!==null){var u=Ki();Ts(s,e,a,u),ix(s,n,a)}}function gP(e,n,s){var a=fo(e),u={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(tx(e))ex(n,u);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=n.lastRenderedReducer,d!==null))try{var _=n.lastRenderedState,v=d(_,s);if(u.hasEagerState=!0,u.eagerState=v,Ps(v,_)){var x=n.interleaved;x===null?(u.next=u,J_(n)):(u.next=x.next,x.next=u),n.interleaved=u;return}}catch{}finally{}s=Lw(e,n,u,a),s!==null&&(u=Ki(),Ts(s,e,a,u),ix(s,n,a))}}function tx(e){var n=e.alternate;return e===Be||n!==null&&n===Be}function ex(e,n){vu=Xd=!0;var s=e.pending;s===null?n.next=n:(n.next=s.next,s.next=n),e.pending=n}function ix(e,n,s){if(s&4194240){var a=n.lanes;a&=e.pendingLanes,s|=a,n.lanes=s,U_(e,s)}}var $d={readContext:ts,useCallback:Hi,useContext:Hi,useEffect:Hi,useImperativeHandle:Hi,useInsertionEffect:Hi,useLayoutEffect:Hi,useMemo:Hi,useReducer:Hi,useRef:Hi,useState:Hi,useDebugValue:Hi,useDeferredValue:Hi,useTransition:Hi,useMutableSource:Hi,useSyncExternalStore:Hi,useId:Hi,unstable_isNewReconciler:!1},_P={readContext:ts,useCallback:function(e,n){return Qs().memoizedState=[e,n===void 0?null:n],e},useContext:ts,useEffect:x0,useImperativeHandle:function(e,n,s){return s=s!=null?s.concat([e]):null,xd(4194308,4,Yw.bind(null,n,e),s)},useLayoutEffect:function(e,n){return xd(4194308,4,e,n)},useInsertionEffect:function(e,n){return xd(4,2,e,n)},useMemo:function(e,n){var s=Qs();return n=n===void 0?null:n,e=e(),s.memoizedState=[e,n],e},useReducer:function(e,n,s){var a=Qs();return n=s!==void 0?s(n):n,a.memoizedState=a.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},a.queue=e,e=e.dispatch=pP.bind(null,Be,e),[a.memoizedState,e]},useRef:function(e){var n=Qs();return e={current:e},n.memoizedState=e},useState:w0,useDebugValue:lm,useDeferredValue:function(e){return Qs().memoizedState=e},useTransition:function(){var e=w0(!1),n=e[0];return e=fP.bind(null,e[1]),Qs().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,s){var a=Be,u=Qs();if(Te){if(s===void 0)throw Error(pt(407));s=s()}else{if(s=n(),xi===null)throw Error(pt(349));_a&30||zw(a,n,s)}u.memoizedState=s;var d={value:s,getSnapshot:n};return u.queue=d,x0(Ww.bind(null,a,d,e),[e]),a.flags|=2048,Ou(9,Hw.bind(null,a,d,s,n),void 0,null),s},useId:function(){var e=Qs(),n=xi.identifierPrefix;if(Te){var s=br,a=xr;s=(a&~(1<<32-Es(a)-1)).toString(32)+s,n=":"+n+"R"+s,s=Lu++,0<s&&(n+="H"+s.toString(32)),n+=":"}else s=dP++,n=":"+n+"r"+s.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},mP={readContext:ts,useCallback:qw,useContext:ts,useEffect:am,useImperativeHandle:Qw,useInsertionEffect:Xw,useLayoutEffect:$w,useMemo:Zw,useReducer:lg,useRef:Vw,useState:function(){return lg(Mu)},useDebugValue:lm,useDeferredValue:function(e){var n=es();return Kw(n,ci.memoizedState,e)},useTransition:function(){var e=lg(Mu)[0],n=es().memoizedState;return[e,n]},useMutableSource:Nw,useSyncExternalStore:Uw,useId:Jw,unstable_isNewReconciler:!1},vP={readContext:ts,useCallback:qw,useContext:ts,useEffect:am,useImperativeHandle:Qw,useInsertionEffect:Xw,useLayoutEffect:$w,useMemo:Zw,useReducer:hg,useRef:Vw,useState:function(){return hg(Mu)},useDebugValue:lm,useDeferredValue:function(e){var n=es();return ci===null?n.memoizedState=e:Kw(n,ci.memoizedState,e)},useTransition:function(){var e=hg(Mu)[0],n=es().memoizedState;return[e,n]},useMutableSource:Nw,useSyncExternalStore:Uw,useId:Jw,unstable_isNewReconciler:!1};function Cs(e,n){if(e&&e.defaultProps){n=ke({},n),e=e.defaultProps;for(var s in e)n[s]===void 0&&(n[s]=e[s]);return n}return n}function t_(e,n,s,a){n=e.memoizedState,s=s(a,n),s=s==null?n:ke({},n,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var pf={isMounted:function(e){return(e=e._reactInternals)?xa(e)===e:!1},enqueueSetState:function(e,n,s){e=e._reactInternals;var a=Ki(),u=fo(e),d=Sr(a,u);d.payload=n,s!=null&&(d.callback=s),n=uo(e,d,u),n!==null&&(Ts(n,e,u,a),yd(n,e,u))},enqueueReplaceState:function(e,n,s){e=e._reactInternals;var a=Ki(),u=fo(e),d=Sr(a,u);d.tag=1,d.payload=n,s!=null&&(d.callback=s),n=uo(e,d,u),n!==null&&(Ts(n,e,u,a),yd(n,e,u))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var s=Ki(),a=fo(e),u=Sr(s,a);u.tag=2,n!=null&&(u.callback=n),n=uo(e,u,a),n!==null&&(Ts(n,e,a,s),yd(n,e,a))}};function b0(e,n,s,a,u,d,_){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,d,_):n.prototype&&n.prototype.isPureReactComponent?!Ru(s,a)||!Ru(u,d):!0}function nx(e,n,s){var a=!1,u=_o,d=n.contextType;return typeof d=="object"&&d!==null?d=ts(d):(u=gn(n)?pa:Gi.current,a=n.contextTypes,d=(a=a!=null)?Hl(e,u):_o),n=new n(s,d),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=pf,e.stateNode=n,n._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=d),n}function C0(e,n,s,a){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,a),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,a),n.state!==e&&pf.enqueueReplaceState(n,n.state,null)}function e_(e,n,s,a){var u=e.stateNode;u.props=s,u.state=e.memoizedState,u.refs={},tm(e);var d=n.contextType;typeof d=="object"&&d!==null?u.context=ts(d):(d=gn(n)?pa:Gi.current,u.context=Hl(e,d)),u.state=e.memoizedState,d=n.getDerivedStateFromProps,typeof d=="function"&&(t_(e,n,d,s),u.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(n=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),n!==u.state&&pf.enqueueReplaceState(u,u.state,null),Gd(e,s,u,a),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}function Vl(e,n){try{var s="",a=n;do s+=XE(a),a=a.return;while(a);var u=s}catch(d){u=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:n,stack:u,digest:null}}function ug(e,n,s){return{value:e,source:null,stack:s??null,digest:n??null}}function i_(e,n){try{console.error(n.value)}catch(s){setTimeout(function(){throw s})}}var yP=typeof WeakMap=="function"?WeakMap:Map;function sx(e,n,s){s=Sr(-1,s),s.tag=3,s.payload={element:null};var a=n.value;return s.callback=function(){Qd||(Qd=!0,d_=a),i_(e,n)},s}function rx(e,n,s){s=Sr(-1,s),s.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var u=n.value;s.payload=function(){return a(u)},s.callback=function(){i_(e,n)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(s.callback=function(){i_(e,n),typeof a!="function"&&(co===null?co=new Set([this]):co.add(this));var _=n.stack;this.componentDidCatch(n.value,{componentStack:_!==null?_:""})}),s}function S0(e,n,s){var a=e.pingCache;if(a===null){a=e.pingCache=new yP;var u=new Set;a.set(n,u)}else u=a.get(n),u===void 0&&(u=new Set,a.set(n,u));u.has(s)||(u.add(s),e=BP.bind(null,e,n,s),n.then(e,e))}function A0(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function E0(e,n,s,a,u){return e.mode&1?(e.flags|=65536,e.lanes=u,e):(e===n?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(n=Sr(-1,1),n.tag=2,uo(s,n,1))),s.lanes|=1),e)}var wP=Rr.ReactCurrentOwner,fn=!1;function Zi(e,n,s,a){n.child=e===null?kw(n,null,s,a):jl(n,e.child,s,a)}function T0(e,n,s,a,u){s=s.render;var d=n.ref;return Nl(n,u),a=rm(e,n,s,a,d,u),s=om(),e!==null&&!fn?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,Pr(e,n,u)):(Te&&s&&$_(n),n.flags|=1,Zi(e,n,a,u),n.child)}function P0(e,n,s,a,u){if(e===null){var d=s.type;return typeof d=="function"&&!_m(d)&&d.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(n.tag=15,n.type=d,ox(e,n,d,a,u)):(e=Ad(s.type,null,a,n,n.mode,u),e.ref=n.ref,e.return=n,n.child=e)}if(d=e.child,!(e.lanes&u)){var _=d.memoizedProps;if(s=s.compare,s=s!==null?s:Ru,s(_,a)&&e.ref===n.ref)return Pr(e,n,u)}return n.flags|=1,e=po(d,a),e.ref=n.ref,e.return=n,n.child=e}function ox(e,n,s,a,u){if(e!==null){var d=e.memoizedProps;if(Ru(d,a)&&e.ref===n.ref)if(fn=!1,n.pendingProps=a=d,(e.lanes&u)!==0)e.flags&131072&&(fn=!0);else return n.lanes=e.lanes,Pr(e,n,u)}return n_(e,n,s,a,u)}function ax(e,n,s){var a=n.pendingProps,u=a.children,d=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},me(Bl,Dn),Dn|=s;else{if(!(s&1073741824))return e=d!==null?d.baseLanes|s:s,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,me(Bl,Dn),Dn|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=d!==null?d.baseLanes:s,me(Bl,Dn),Dn|=a}else d!==null?(a=d.baseLanes|s,n.memoizedState=null):a=s,me(Bl,Dn),Dn|=a;return Zi(e,n,u,s),n.child}function lx(e,n){var s=n.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(n.flags|=512,n.flags|=2097152)}function n_(e,n,s,a,u){var d=gn(s)?pa:Gi.current;return d=Hl(n,d),Nl(n,u),s=rm(e,n,s,a,d,u),a=om(),e!==null&&!fn?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,Pr(e,n,u)):(Te&&a&&$_(n),n.flags|=1,Zi(e,n,s,u),n.child)}function R0(e,n,s,a,u){if(gn(s)){var d=!0;Ud(n)}else d=!1;if(Nl(n,u),n.stateNode===null)bd(e,n),nx(n,s,a),e_(n,s,a,u),a=!0;else if(e===null){var _=n.stateNode,v=n.memoizedProps;_.props=v;var x=_.context,b=s.contextType;typeof b=="object"&&b!==null?b=ts(b):(b=gn(s)?pa:Gi.current,b=Hl(n,b));var E=s.getDerivedStateFromProps,R=typeof E=="function"||typeof _.getSnapshotBeforeUpdate=="function";R||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(v!==a||x!==b)&&C0(n,_,a,b),to=!1;var L=n.memoizedState;_.state=L,Gd(n,a,_,u),x=n.memoizedState,v!==a||L!==x||pn.current||to?(typeof E=="function"&&(t_(n,s,E,a),x=n.memoizedState),(v=to||b0(n,s,v,a,L,x,b))?(R||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(n.flags|=4194308)):(typeof _.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=a,n.memoizedState=x),_.props=a,_.state=x,_.context=b,a=v):(typeof _.componentDidMount=="function"&&(n.flags|=4194308),a=!1)}else{_=n.stateNode,Mw(e,n),v=n.memoizedProps,b=n.type===n.elementType?v:Cs(n.type,v),_.props=b,R=n.pendingProps,L=_.context,x=s.contextType,typeof x=="object"&&x!==null?x=ts(x):(x=gn(s)?pa:Gi.current,x=Hl(n,x));var U=s.getDerivedStateFromProps;(E=typeof U=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(v!==R||L!==x)&&C0(n,_,a,x),to=!1,L=n.memoizedState,_.state=L,Gd(n,a,_,u);var H=n.memoizedState;v!==R||L!==H||pn.current||to?(typeof U=="function"&&(t_(n,s,U,a),H=n.memoizedState),(b=to||b0(n,s,b,a,L,H,x)||!1)?(E||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(a,H,x),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(a,H,x)),typeof _.componentDidUpdate=="function"&&(n.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof _.componentDidUpdate!="function"||v===e.memoizedProps&&L===e.memoizedState||(n.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&L===e.memoizedState||(n.flags|=1024),n.memoizedProps=a,n.memoizedState=H),_.props=a,_.state=H,_.context=x,a=b):(typeof _.componentDidUpdate!="function"||v===e.memoizedProps&&L===e.memoizedState||(n.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&L===e.memoizedState||(n.flags|=1024),a=!1)}return s_(e,n,s,a,d,u)}function s_(e,n,s,a,u,d){lx(e,n);var _=(n.flags&128)!==0;if(!a&&!_)return u&&p0(n,s,!1),Pr(e,n,d);a=n.stateNode,wP.current=n;var v=_&&typeof s.getDerivedStateFromError!="function"?null:a.render();return n.flags|=1,e!==null&&_?(n.child=jl(n,e.child,null,d),n.child=jl(n,null,v,d)):Zi(e,n,v,d),n.memoizedState=a.state,u&&p0(n,s,!0),n.child}function hx(e){var n=e.stateNode;n.pendingContext?f0(e,n.pendingContext,n.pendingContext!==n.context):n.context&&f0(e,n.context,!1),em(e,n.containerInfo)}function I0(e,n,s,a,u){return Wl(),Q_(u),n.flags|=256,Zi(e,n,s,a),n.child}var r_={dehydrated:null,treeContext:null,retryLane:0};function o_(e){return{baseLanes:e,cachePool:null,transitions:null}}function ux(e,n,s){var a=n.pendingProps,u=Fe.current,d=!1,_=(n.flags&128)!==0,v;if((v=_)||(v=e!==null&&e.memoizedState===null?!1:(u&2)!==0),v?(d=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),me(Fe,u&1),e===null)return Kg(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(_=a.children,e=a.fallback,d?(a=n.mode,d=n.child,_={mode:"hidden",children:_},!(a&1)&&d!==null?(d.childLanes=0,d.pendingProps=_):d=mf(_,a,0,null),e=ca(e,a,s,null),d.return=n,e.return=n,d.sibling=e,n.child=d,n.child.memoizedState=o_(s),n.memoizedState=r_,e):hm(n,_));if(u=e.memoizedState,u!==null&&(v=u.dehydrated,v!==null))return xP(e,n,_,a,v,u,s);if(d){d=a.fallback,_=n.mode,u=e.child,v=u.sibling;var x={mode:"hidden",children:a.children};return!(_&1)&&n.child!==u?(a=n.child,a.childLanes=0,a.pendingProps=x,n.deletions=null):(a=po(u,x),a.subtreeFlags=u.subtreeFlags&14680064),v!==null?d=po(v,d):(d=ca(d,_,s,null),d.flags|=2),d.return=n,a.return=n,a.sibling=d,n.child=a,a=d,d=n.child,_=e.child.memoizedState,_=_===null?o_(s):{baseLanes:_.baseLanes|s,cachePool:null,transitions:_.transitions},d.memoizedState=_,d.childLanes=e.childLanes&~s,n.memoizedState=r_,a}return d=e.child,e=d.sibling,a=po(d,{mode:"visible",children:a.children}),!(n.mode&1)&&(a.lanes=s),a.return=n,a.sibling=null,e!==null&&(s=n.deletions,s===null?(n.deletions=[e],n.flags|=16):s.push(e)),n.child=a,n.memoizedState=null,a}function hm(e,n){return n=mf({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function ud(e,n,s,a){return a!==null&&Q_(a),jl(n,e.child,null,s),e=hm(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function xP(e,n,s,a,u,d,_){if(s)return n.flags&256?(n.flags&=-257,a=ug(Error(pt(422))),ud(e,n,_,a)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(d=a.fallback,u=n.mode,a=mf({mode:"visible",children:a.children},u,0,null),d=ca(d,u,_,null),d.flags|=2,a.return=n,d.return=n,a.sibling=d,n.child=a,n.mode&1&&jl(n,e.child,null,_),n.child.memoizedState=o_(_),n.memoizedState=r_,d);if(!(n.mode&1))return ud(e,n,_,null);if(u.data==="$!"){if(a=u.nextSibling&&u.nextSibling.dataset,a)var v=a.dgst;return a=v,d=Error(pt(419)),a=ug(d,a,void 0),ud(e,n,_,a)}if(v=(_&e.childLanes)!==0,fn||v){if(a=xi,a!==null){switch(_&-_){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=u&(a.suspendedLanes|_)?0:u,u!==0&&u!==d.retryLane&&(d.retryLane=u,Tr(e,u),Ts(a,e,u,-1))}return gm(),a=ug(Error(pt(421))),ud(e,n,_,a)}return u.data==="$?"?(n.flags|=128,n.child=e.child,n=kP.bind(null,e),u._reactRetry=n,null):(e=d.treeContext,Fn=ho(u.nextSibling),Bn=n,Te=!0,As=null,e!==null&&(qn[Zn++]=xr,qn[Zn++]=br,qn[Zn++]=ga,xr=e.id,br=e.overflow,ga=n),n=hm(n,a.children),n.flags|=4096,n)}function D0(e,n,s){e.lanes|=n;var a=e.alternate;a!==null&&(a.lanes|=n),Jg(e.return,n,s)}function cg(e,n,s,a,u){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:u}:(d.isBackwards=n,d.rendering=null,d.renderingStartTime=0,d.last=a,d.tail=s,d.tailMode=u)}function cx(e,n,s){var a=n.pendingProps,u=a.revealOrder,d=a.tail;if(Zi(e,n,a.children,s),a=Fe.current,a&2)a=a&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&D0(e,s,n);else if(e.tag===19)D0(e,s,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(me(Fe,a),!(n.mode&1))n.memoizedState=null;else switch(u){case"forwards":for(s=n.child,u=null;s!==null;)e=s.alternate,e!==null&&Vd(e)===null&&(u=s),s=s.sibling;s=u,s===null?(u=n.child,n.child=null):(u=s.sibling,s.sibling=null),cg(n,!1,u,s,d);break;case"backwards":for(s=null,u=n.child,n.child=null;u!==null;){if(e=u.alternate,e!==null&&Vd(e)===null){n.child=u;break}e=u.sibling,u.sibling=s,s=u,u=e}cg(n,!0,s,null,d);break;case"together":cg(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function bd(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function Pr(e,n,s){if(e!==null&&(n.dependencies=e.dependencies),ma|=n.lanes,!(s&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(pt(153));if(n.child!==null){for(e=n.child,s=po(e,e.pendingProps),n.child=s,s.return=n;e.sibling!==null;)e=e.sibling,s=s.sibling=po(e,e.pendingProps),s.return=n;s.sibling=null}return n.child}function bP(e,n,s){switch(n.tag){case 3:hx(n),Wl();break;case 5:Ow(n);break;case 1:gn(n.type)&&Ud(n);break;case 4:em(n,n.stateNode.containerInfo);break;case 10:var a=n.type._context,u=n.memoizedProps.value;me(Wd,a._currentValue),a._currentValue=u;break;case 13:if(a=n.memoizedState,a!==null)return a.dehydrated!==null?(me(Fe,Fe.current&1),n.flags|=128,null):s&n.child.childLanes?ux(e,n,s):(me(Fe,Fe.current&1),e=Pr(e,n,s),e!==null?e.sibling:null);me(Fe,Fe.current&1);break;case 19:if(a=(s&n.childLanes)!==0,e.flags&128){if(a)return cx(e,n,s);n.flags|=128}if(u=n.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),me(Fe,Fe.current),a)break;return null;case 22:case 23:return n.lanes=0,ax(e,n,s)}return Pr(e,n,s)}var dx,a_,fx,px;dx=function(e,n){for(var s=n.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};a_=function(){};fx=function(e,n,s,a){var u=e.memoizedProps;if(u!==a){e=n.stateNode,la(Ks.current);var d=null;switch(s){case"input":u=Rg(e,u),a=Rg(e,a),d=[];break;case"select":u=ke({},u,{value:void 0}),a=ke({},a,{value:void 0}),d=[];break;case"textarea":u=Fg(e,u),a=Fg(e,a),d=[];break;default:typeof u.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Od)}kg(s,a);var _;s=null;for(b in u)if(!a.hasOwnProperty(b)&&u.hasOwnProperty(b)&&u[b]!=null)if(b==="style"){var v=u[b];for(_ in v)v.hasOwnProperty(_)&&(s||(s={}),s[_]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(bu.hasOwnProperty(b)?d||(d=[]):(d=d||[]).push(b,null));for(b in a){var x=a[b];if(v=u!=null?u[b]:void 0,a.hasOwnProperty(b)&&x!==v&&(x!=null||v!=null))if(b==="style")if(v){for(_ in v)!v.hasOwnProperty(_)||x&&x.hasOwnProperty(_)||(s||(s={}),s[_]="");for(_ in x)x.hasOwnProperty(_)&&v[_]!==x[_]&&(s||(s={}),s[_]=x[_])}else s||(d||(d=[]),d.push(b,s)),s=x;else b==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,v=v?v.__html:void 0,x!=null&&v!==x&&(d=d||[]).push(b,x)):b==="children"?typeof x!="string"&&typeof x!="number"||(d=d||[]).push(b,""+x):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(bu.hasOwnProperty(b)?(x!=null&&b==="onScroll"&&xe("scroll",e),d||v===x||(d=[])):(d=d||[]).push(b,x))}s&&(d=d||[]).push("style",s);var b=d;(n.updateQueue=b)&&(n.flags|=4)}};px=function(e,n,s,a){s!==a&&(n.flags|=4)};function ru(e,n){if(!Te)switch(e.tailMode){case"hidden":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Wi(e){var n=e.alternate!==null&&e.alternate.child===e.child,s=0,a=0;if(n)for(var u=e.child;u!==null;)s|=u.lanes|u.childLanes,a|=u.subtreeFlags&14680064,a|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)s|=u.lanes|u.childLanes,a|=u.subtreeFlags,a|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=a,e.childLanes=s,n}function CP(e,n,s){var a=n.pendingProps;switch(Y_(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wi(n),null;case 1:return gn(n.type)&&Nd(),Wi(n),null;case 3:return a=n.stateNode,Gl(),be(pn),be(Gi),nm(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(ld(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,As!==null&&(g_(As),As=null))),a_(e,n),Wi(n),null;case 5:im(n);var u=la(ku.current);if(s=n.type,e!==null&&n.stateNode!=null)fx(e,n,s,a,u),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!a){if(n.stateNode===null)throw Error(pt(166));return Wi(n),null}if(e=la(Ks.current),ld(n)){a=n.stateNode,s=n.type;var d=n.memoizedProps;switch(a[qs]=n,a[Fu]=d,e=(n.mode&1)!==0,s){case"dialog":xe("cancel",a),xe("close",a);break;case"iframe":case"object":case"embed":xe("load",a);break;case"video":case"audio":for(u=0;u<du.length;u++)xe(du[u],a);break;case"source":xe("error",a);break;case"img":case"image":case"link":xe("error",a),xe("load",a);break;case"details":xe("toggle",a);break;case"input":zv(a,d),xe("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!d.multiple},xe("invalid",a);break;case"textarea":Wv(a,d),xe("invalid",a)}kg(s,d),u=null;for(var _ in d)if(d.hasOwnProperty(_)){var v=d[_];_==="children"?typeof v=="string"?a.textContent!==v&&(d.suppressHydrationWarning!==!0&&ad(a.textContent,v,e),u=["children",v]):typeof v=="number"&&a.textContent!==""+v&&(d.suppressHydrationWarning!==!0&&ad(a.textContent,v,e),u=["children",""+v]):bu.hasOwnProperty(_)&&v!=null&&_==="onScroll"&&xe("scroll",a)}switch(s){case"input":Jc(a),Hv(a,d,!0);break;case"textarea":Jc(a),jv(a);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(a.onclick=Od)}a=u,n.updateQueue=a,a!==null&&(n.flags|=4)}else{_=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Wy(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=_.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=_.createElement(s,{is:a.is}):(e=_.createElement(s),s==="select"&&(_=e,a.multiple?_.multiple=!0:a.size&&(_.size=a.size))):e=_.createElementNS(e,s),e[qs]=n,e[Fu]=a,dx(e,n,!1,!1),n.stateNode=e;t:{switch(_=Lg(s,a),s){case"dialog":xe("cancel",e),xe("close",e),u=a;break;case"iframe":case"object":case"embed":xe("load",e),u=a;break;case"video":case"audio":for(u=0;u<du.length;u++)xe(du[u],e);u=a;break;case"source":xe("error",e),u=a;break;case"img":case"image":case"link":xe("error",e),xe("load",e),u=a;break;case"details":xe("toggle",e),u=a;break;case"input":zv(e,a),u=Rg(e,a),xe("invalid",e);break;case"option":u=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},u=ke({},a,{value:void 0}),xe("invalid",e);break;case"textarea":Wv(e,a),u=Fg(e,a),xe("invalid",e);break;default:u=a}kg(s,u),v=u;for(d in v)if(v.hasOwnProperty(d)){var x=v[d];d==="style"?Vy(e,x):d==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,x!=null&&jy(e,x)):d==="children"?typeof x=="string"?(s!=="textarea"||x!=="")&&Cu(e,x):typeof x=="number"&&Cu(e,""+x):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(bu.hasOwnProperty(d)?x!=null&&d==="onScroll"&&xe("scroll",e):x!=null&&B_(e,d,x,_))}switch(s){case"input":Jc(e),Hv(e,a,!1);break;case"textarea":Jc(e),jv(e);break;case"option":a.value!=null&&e.setAttribute("value",""+go(a.value));break;case"select":e.multiple=!!a.multiple,d=a.value,d!=null?kl(e,!!a.multiple,d,!1):a.defaultValue!=null&&kl(e,!!a.multiple,a.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=Od)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break t;case"img":a=!0;break t;default:a=!1}}a&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Wi(n),null;case 6:if(e&&n.stateNode!=null)px(e,n,e.memoizedProps,a);else{if(typeof a!="string"&&n.stateNode===null)throw Error(pt(166));if(s=la(ku.current),la(Ks.current),ld(n)){if(a=n.stateNode,s=n.memoizedProps,a[qs]=n,(d=a.nodeValue!==s)&&(e=Bn,e!==null))switch(e.tag){case 3:ad(a.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ad(a.nodeValue,s,(e.mode&1)!==0)}d&&(n.flags|=4)}else a=(s.nodeType===9?s:s.ownerDocument).createTextNode(a),a[qs]=n,n.stateNode=a}return Wi(n),null;case 13:if(be(Fe),a=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Te&&Fn!==null&&n.mode&1&&!(n.flags&128))Fw(),Wl(),n.flags|=98560,d=!1;else if(d=ld(n),a!==null&&a.dehydrated!==null){if(e===null){if(!d)throw Error(pt(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(pt(317));d[qs]=n}else Wl(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Wi(n),d=!1}else As!==null&&(g_(As),As=null),d=!0;if(!d)return n.flags&65536?n:null}return n.flags&128?(n.lanes=s,n):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(n.child.flags|=8192,n.mode&1&&(e===null||Fe.current&1?di===0&&(di=3):gm())),n.updateQueue!==null&&(n.flags|=4),Wi(n),null);case 4:return Gl(),a_(e,n),e===null&&Iu(n.stateNode.containerInfo),Wi(n),null;case 10:return K_(n.type._context),Wi(n),null;case 17:return gn(n.type)&&Nd(),Wi(n),null;case 19:if(be(Fe),d=n.memoizedState,d===null)return Wi(n),null;if(a=(n.flags&128)!==0,_=d.rendering,_===null)if(a)ru(d,!1);else{if(di!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(_=Vd(e),_!==null){for(n.flags|=128,ru(d,!1),a=_.updateQueue,a!==null&&(n.updateQueue=a,n.flags|=4),n.subtreeFlags=0,a=s,s=n.child;s!==null;)d=s,e=a,d.flags&=14680066,_=d.alternate,_===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=_.childLanes,d.lanes=_.lanes,d.child=_.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=_.memoizedProps,d.memoizedState=_.memoizedState,d.updateQueue=_.updateQueue,d.type=_.type,e=_.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return me(Fe,Fe.current&1|2),n.child}e=e.sibling}d.tail!==null&&$e()>Xl&&(n.flags|=128,a=!0,ru(d,!1),n.lanes=4194304)}else{if(!a)if(e=Vd(_),e!==null){if(n.flags|=128,a=!0,s=e.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),ru(d,!0),d.tail===null&&d.tailMode==="hidden"&&!_.alternate&&!Te)return Wi(n),null}else 2*$e()-d.renderingStartTime>Xl&&s!==1073741824&&(n.flags|=128,a=!0,ru(d,!1),n.lanes=4194304);d.isBackwards?(_.sibling=n.child,n.child=_):(s=d.last,s!==null?s.sibling=_:n.child=_,d.last=_)}return d.tail!==null?(n=d.tail,d.rendering=n,d.tail=n.sibling,d.renderingStartTime=$e(),n.sibling=null,s=Fe.current,me(Fe,a?s&1|2:s&1),n):(Wi(n),null);case 22:case 23:return pm(),a=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(n.flags|=8192),a&&n.mode&1?Dn&1073741824&&(Wi(n),n.subtreeFlags&6&&(n.flags|=8192)):Wi(n),null;case 24:return null;case 25:return null}throw Error(pt(156,n.tag))}function SP(e,n){switch(Y_(n),n.tag){case 1:return gn(n.type)&&Nd(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Gl(),be(pn),be(Gi),nm(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return im(n),null;case 13:if(be(Fe),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(pt(340));Wl()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return be(Fe),null;case 4:return Gl(),null;case 10:return K_(n.type._context),null;case 22:case 23:return pm(),null;case 24:return null;default:return null}}var cd=!1,ji=!1,AP=typeof WeakSet=="function"?WeakSet:Set,Ct=null;function Fl(e,n){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(a){Ue(e,n,a)}else s.current=null}function l_(e,n,s){try{s()}catch(a){Ue(e,n,a)}}var F0=!1;function EP(e,n){if(Vg=kd,e=yw(),X_(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else t:{s=(s=e.ownerDocument)&&s.defaultView||window;var a=s.getSelection&&s.getSelection();if(a&&a.rangeCount!==0){s=a.anchorNode;var u=a.anchorOffset,d=a.focusNode;a=a.focusOffset;try{s.nodeType,d.nodeType}catch{s=null;break t}var _=0,v=-1,x=-1,b=0,E=0,R=e,L=null;e:for(;;){for(var U;R!==s||u!==0&&R.nodeType!==3||(v=_+u),R!==d||a!==0&&R.nodeType!==3||(x=_+a),R.nodeType===3&&(_+=R.nodeValue.length),(U=R.firstChild)!==null;)L=R,R=U;for(;;){if(R===e)break e;if(L===s&&++b===u&&(v=_),L===d&&++E===a&&(x=_),(U=R.nextSibling)!==null)break;R=L,L=R.parentNode}R=U}s=v===-1||x===-1?null:{start:v,end:x}}else s=null}s=s||{start:0,end:0}}else s=null;for(Xg={focusedElem:e,selectionRange:s},kd=!1,Ct=n;Ct!==null;)if(n=Ct,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,Ct=e;else for(;Ct!==null;){n=Ct;try{var H=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(H!==null){var $=H.memoizedProps,G=H.memoizedState,k=n.stateNode,B=k.getSnapshotBeforeUpdate(n.elementType===n.type?$:Cs(n.type,$),G);k.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var N=n.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pt(163))}}catch(J){Ue(n,n.return,J)}if(e=n.sibling,e!==null){e.return=n.return,Ct=e;break}Ct=n.return}return H=F0,F0=!1,H}function yu(e,n,s){var a=n.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var u=a=a.next;do{if((u.tag&e)===e){var d=u.destroy;u.destroy=void 0,d!==void 0&&l_(n,s,d)}u=u.next}while(u!==a)}}function gf(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==n)}}function h_(e){var n=e.ref;if(n!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof n=="function"?n(e):n.current=e}}function gx(e){var n=e.alternate;n!==null&&(e.alternate=null,gx(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[qs],delete n[Fu],delete n[Qg],delete n[lP],delete n[hP])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _x(e){return e.tag===5||e.tag===3||e.tag===4}function B0(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||_x(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function u_(e,n,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,n?s.nodeType===8?s.parentNode.insertBefore(e,n):s.insertBefore(e,n):(s.nodeType===8?(n=s.parentNode,n.insertBefore(e,s)):(n=s,n.appendChild(e)),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=Od));else if(a!==4&&(e=e.child,e!==null))for(u_(e,n,s),e=e.sibling;e!==null;)u_(e,n,s),e=e.sibling}function c_(e,n,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,n?s.insertBefore(e,n):s.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(c_(e,n,s),e=e.sibling;e!==null;)c_(e,n,s),e=e.sibling}var ki=null,Ss=!1;function Zr(e,n,s){for(s=s.child;s!==null;)mx(e,n,s),s=s.sibling}function mx(e,n,s){if(Zs&&typeof Zs.onCommitFiberUnmount=="function")try{Zs.onCommitFiberUnmount(af,s)}catch{}switch(s.tag){case 5:ji||Fl(s,n);case 6:var a=ki,u=Ss;ki=null,Zr(e,n,s),ki=a,Ss=u,ki!==null&&(Ss?(e=ki,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):ki.removeChild(s.stateNode));break;case 18:ki!==null&&(Ss?(e=ki,s=s.stateNode,e.nodeType===8?sg(e.parentNode,s):e.nodeType===1&&sg(e,s),Tu(e)):sg(ki,s.stateNode));break;case 4:a=ki,u=Ss,ki=s.stateNode.containerInfo,Ss=!0,Zr(e,n,s),ki=a,Ss=u;break;case 0:case 11:case 14:case 15:if(!ji&&(a=s.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){u=a=a.next;do{var d=u,_=d.destroy;d=d.tag,_!==void 0&&(d&2||d&4)&&l_(s,n,_),u=u.next}while(u!==a)}Zr(e,n,s);break;case 1:if(!ji&&(Fl(s,n),a=s.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(v){Ue(s,n,v)}Zr(e,n,s);break;case 21:Zr(e,n,s);break;case 22:s.mode&1?(ji=(a=ji)||s.memoizedState!==null,Zr(e,n,s),ji=a):Zr(e,n,s);break;default:Zr(e,n,s)}}function k0(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new AP),n.forEach(function(a){var u=LP.bind(null,e,a);s.has(a)||(s.add(a),a.then(u,u))})}}function bs(e,n){var s=n.deletions;if(s!==null)for(var a=0;a<s.length;a++){var u=s[a];try{var d=e,_=n,v=_;t:for(;v!==null;){switch(v.tag){case 5:ki=v.stateNode,Ss=!1;break t;case 3:ki=v.stateNode.containerInfo,Ss=!0;break t;case 4:ki=v.stateNode.containerInfo,Ss=!0;break t}v=v.return}if(ki===null)throw Error(pt(160));mx(d,_,u),ki=null,Ss=!1;var x=u.alternate;x!==null&&(x.return=null),u.return=null}catch(b){Ue(u,n,b)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)vx(n,e),n=n.sibling}function vx(e,n){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bs(n,e),Ys(e),a&4){try{yu(3,e,e.return),gf(3,e)}catch($){Ue(e,e.return,$)}try{yu(5,e,e.return)}catch($){Ue(e,e.return,$)}}break;case 1:bs(n,e),Ys(e),a&512&&s!==null&&Fl(s,s.return);break;case 5:if(bs(n,e),Ys(e),a&512&&s!==null&&Fl(s,s.return),e.flags&32){var u=e.stateNode;try{Cu(u,"")}catch($){Ue(e,e.return,$)}}if(a&4&&(u=e.stateNode,u!=null)){var d=e.memoizedProps,_=s!==null?s.memoizedProps:d,v=e.type,x=e.updateQueue;if(e.updateQueue=null,x!==null)try{v==="input"&&d.type==="radio"&&d.name!=null&&zy(u,d),Lg(v,_);var b=Lg(v,d);for(_=0;_<x.length;_+=2){var E=x[_],R=x[_+1];E==="style"?Vy(u,R):E==="dangerouslySetInnerHTML"?jy(u,R):E==="children"?Cu(u,R):B_(u,E,R,b)}switch(v){case"input":Ig(u,d);break;case"textarea":Hy(u,d);break;case"select":var L=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!d.multiple;var U=d.value;U!=null?kl(u,!!d.multiple,U,!1):L!==!!d.multiple&&(d.defaultValue!=null?kl(u,!!d.multiple,d.defaultValue,!0):kl(u,!!d.multiple,d.multiple?[]:"",!1))}u[Fu]=d}catch($){Ue(e,e.return,$)}}break;case 6:if(bs(n,e),Ys(e),a&4){if(e.stateNode===null)throw Error(pt(162));u=e.stateNode,d=e.memoizedProps;try{u.nodeValue=d}catch($){Ue(e,e.return,$)}}break;case 3:if(bs(n,e),Ys(e),a&4&&s!==null&&s.memoizedState.isDehydrated)try{Tu(n.containerInfo)}catch($){Ue(e,e.return,$)}break;case 4:bs(n,e),Ys(e);break;case 13:bs(n,e),Ys(e),u=e.child,u.flags&8192&&(d=u.memoizedState!==null,u.stateNode.isHidden=d,!d||u.alternate!==null&&u.alternate.memoizedState!==null||(dm=$e())),a&4&&k0(e);break;case 22:if(E=s!==null&&s.memoizedState!==null,e.mode&1?(ji=(b=ji)||E,bs(n,e),ji=b):bs(n,e),Ys(e),a&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!E&&e.mode&1)for(Ct=e,E=e.child;E!==null;){for(R=Ct=E;Ct!==null;){switch(L=Ct,U=L.child,L.tag){case 0:case 11:case 14:case 15:yu(4,L,L.return);break;case 1:Fl(L,L.return);var H=L.stateNode;if(typeof H.componentWillUnmount=="function"){a=L,s=L.return;try{n=a,H.props=n.memoizedProps,H.state=n.memoizedState,H.componentWillUnmount()}catch($){Ue(a,s,$)}}break;case 5:Fl(L,L.return);break;case 22:if(L.memoizedState!==null){M0(R);continue}}U!==null?(U.return=L,Ct=U):M0(R)}E=E.sibling}t:for(E=null,R=e;;){if(R.tag===5){if(E===null){E=R;try{u=R.stateNode,b?(d=u.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(v=R.stateNode,x=R.memoizedProps.style,_=x!=null&&x.hasOwnProperty("display")?x.display:null,v.style.display=Gy("display",_))}catch($){Ue(e,e.return,$)}}}else if(R.tag===6){if(E===null)try{R.stateNode.nodeValue=b?"":R.memoizedProps}catch($){Ue(e,e.return,$)}}else if((R.tag!==22&&R.tag!==23||R.memoizedState===null||R===e)&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===e)break t;for(;R.sibling===null;){if(R.return===null||R.return===e)break t;E===R&&(E=null),R=R.return}E===R&&(E=null),R.sibling.return=R.return,R=R.sibling}}break;case 19:bs(n,e),Ys(e),a&4&&k0(e);break;case 21:break;default:bs(n,e),Ys(e)}}function Ys(e){var n=e.flags;if(n&2){try{t:{for(var s=e.return;s!==null;){if(_x(s)){var a=s;break t}s=s.return}throw Error(pt(160))}switch(a.tag){case 5:var u=a.stateNode;a.flags&32&&(Cu(u,""),a.flags&=-33);var d=B0(e);c_(e,d,u);break;case 3:case 4:var _=a.stateNode.containerInfo,v=B0(e);u_(e,v,_);break;default:throw Error(pt(161))}}catch(x){Ue(e,e.return,x)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function TP(e,n,s){Ct=e,yx(e)}function yx(e,n,s){for(var a=(e.mode&1)!==0;Ct!==null;){var u=Ct,d=u.child;if(u.tag===22&&a){var _=u.memoizedState!==null||cd;if(!_){var v=u.alternate,x=v!==null&&v.memoizedState!==null||ji;v=cd;var b=ji;if(cd=_,(ji=x)&&!b)for(Ct=u;Ct!==null;)_=Ct,x=_.child,_.tag===22&&_.memoizedState!==null?O0(u):x!==null?(x.return=_,Ct=x):O0(u);for(;d!==null;)Ct=d,yx(d),d=d.sibling;Ct=u,cd=v,ji=b}L0(e)}else u.subtreeFlags&8772&&d!==null?(d.return=u,Ct=d):L0(e)}}function L0(e){for(;Ct!==null;){var n=Ct;if(n.flags&8772){var s=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:ji||gf(5,n);break;case 1:var a=n.stateNode;if(n.flags&4&&!ji)if(s===null)a.componentDidMount();else{var u=n.elementType===n.type?s.memoizedProps:Cs(n.type,s.memoizedProps);a.componentDidUpdate(u,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var d=n.updateQueue;d!==null&&y0(n,d,a);break;case 3:var _=n.updateQueue;if(_!==null){if(s=null,n.child!==null)switch(n.child.tag){case 5:s=n.child.stateNode;break;case 1:s=n.child.stateNode}y0(n,_,s)}break;case 5:var v=n.stateNode;if(s===null&&n.flags&4){s=v;var x=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":x.autoFocus&&s.focus();break;case"img":x.src&&(s.src=x.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var b=n.alternate;if(b!==null){var E=b.memoizedState;if(E!==null){var R=E.dehydrated;R!==null&&Tu(R)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pt(163))}ji||n.flags&512&&h_(n)}catch(L){Ue(n,n.return,L)}}if(n===e){Ct=null;break}if(s=n.sibling,s!==null){s.return=n.return,Ct=s;break}Ct=n.return}}function M0(e){for(;Ct!==null;){var n=Ct;if(n===e){Ct=null;break}var s=n.sibling;if(s!==null){s.return=n.return,Ct=s;break}Ct=n.return}}function O0(e){for(;Ct!==null;){var n=Ct;try{switch(n.tag){case 0:case 11:case 15:var s=n.return;try{gf(4,n)}catch(x){Ue(n,s,x)}break;case 1:var a=n.stateNode;if(typeof a.componentDidMount=="function"){var u=n.return;try{a.componentDidMount()}catch(x){Ue(n,u,x)}}var d=n.return;try{h_(n)}catch(x){Ue(n,d,x)}break;case 5:var _=n.return;try{h_(n)}catch(x){Ue(n,_,x)}}}catch(x){Ue(n,n.return,x)}if(n===e){Ct=null;break}var v=n.sibling;if(v!==null){v.return=n.return,Ct=v;break}Ct=n.return}}var PP=Math.ceil,Yd=Rr.ReactCurrentDispatcher,um=Rr.ReactCurrentOwner,Jn=Rr.ReactCurrentBatchConfig,ee=0,xi=null,Ze=null,Li=0,Dn=0,Bl=vo(0),di=0,Nu=null,ma=0,_f=0,cm=0,wu=null,dn=null,dm=0,Xl=1/0,yr=null,Qd=!1,d_=null,co=null,dd=!1,so=null,qd=0,xu=0,f_=null,Cd=-1,Sd=0;function Ki(){return ee&6?$e():Cd!==-1?Cd:Cd=$e()}function fo(e){return e.mode&1?ee&2&&Li!==0?Li&-Li:cP.transition!==null?(Sd===0&&(Sd=nw()),Sd):(e=fe,e!==0||(e=window.event,e=e===void 0?16:uw(e.type)),e):1}function Ts(e,n,s,a){if(50<xu)throw xu=0,f_=null,Error(pt(185));Gu(e,s,a),(!(ee&2)||e!==xi)&&(e===xi&&(!(ee&2)&&(_f|=s),di===4&&io(e,Li)),_n(e,a),s===1&&ee===0&&!(n.mode&1)&&(Xl=$e()+500,df&&yo()))}function _n(e,n){var s=e.callbackNode;cT(e,n);var a=Bd(e,e===xi?Li:0);if(a===0)s!==null&&Xv(s),e.callbackNode=null,e.callbackPriority=0;else if(n=a&-a,e.callbackPriority!==n){if(s!=null&&Xv(s),n===1)e.tag===0?uP(N0.bind(null,e)):Rw(N0.bind(null,e)),oP(function(){!(ee&6)&&yo()}),s=null;else{switch(sw(a)){case 1:s=N_;break;case 4:s=ew;break;case 16:s=Fd;break;case 536870912:s=iw;break;default:s=Fd}s=Tx(s,wx.bind(null,e))}e.callbackPriority=n,e.callbackNode=s}}function wx(e,n){if(Cd=-1,Sd=0,ee&6)throw Error(pt(327));var s=e.callbackNode;if(Ul()&&e.callbackNode!==s)return null;var a=Bd(e,e===xi?Li:0);if(a===0)return null;if(a&30||a&e.expiredLanes||n)n=Zd(e,a);else{n=a;var u=ee;ee|=2;var d=bx();(xi!==e||Li!==n)&&(yr=null,Xl=$e()+500,ua(e,n));do try{DP();break}catch(v){xx(e,v)}while(!0);Z_(),Yd.current=d,ee=u,Ze!==null?n=0:(xi=null,Li=0,n=di)}if(n!==0){if(n===2&&(u=zg(e),u!==0&&(a=u,n=p_(e,u))),n===1)throw s=Nu,ua(e,0),io(e,a),_n(e,$e()),s;if(n===6)io(e,a);else{if(u=e.current.alternate,!(a&30)&&!RP(u)&&(n=Zd(e,a),n===2&&(d=zg(e),d!==0&&(a=d,n=p_(e,d))),n===1))throw s=Nu,ua(e,0),io(e,a),_n(e,$e()),s;switch(e.finishedWork=u,e.finishedLanes=a,n){case 0:case 1:throw Error(pt(345));case 2:ra(e,dn,yr);break;case 3:if(io(e,a),(a&130023424)===a&&(n=dm+500-$e(),10<n)){if(Bd(e,0)!==0)break;if(u=e.suspendedLanes,(u&a)!==a){Ki(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=Yg(ra.bind(null,e,dn,yr),n);break}ra(e,dn,yr);break;case 4:if(io(e,a),(a&4194240)===a)break;for(n=e.eventTimes,u=-1;0<a;){var _=31-Es(a);d=1<<_,_=n[_],_>u&&(u=_),a&=~d}if(a=u,a=$e()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*PP(a/1960))-a,10<a){e.timeoutHandle=Yg(ra.bind(null,e,dn,yr),a);break}ra(e,dn,yr);break;case 5:ra(e,dn,yr);break;default:throw Error(pt(329))}}}return _n(e,$e()),e.callbackNode===s?wx.bind(null,e):null}function p_(e,n){var s=wu;return e.current.memoizedState.isDehydrated&&(ua(e,n).flags|=256),e=Zd(e,n),e!==2&&(n=dn,dn=s,n!==null&&g_(n)),e}function g_(e){dn===null?dn=e:dn.push.apply(dn,e)}function RP(e){for(var n=e;;){if(n.flags&16384){var s=n.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var a=0;a<s.length;a++){var u=s[a],d=u.getSnapshot;u=u.value;try{if(!Ps(d(),u))return!1}catch{return!1}}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function io(e,n){for(n&=~cm,n&=~_f,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var s=31-Es(n),a=1<<s;e[s]=-1,n&=~a}}function N0(e){if(ee&6)throw Error(pt(327));Ul();var n=Bd(e,0);if(!(n&1))return _n(e,$e()),null;var s=Zd(e,n);if(e.tag!==0&&s===2){var a=zg(e);a!==0&&(n=a,s=p_(e,a))}if(s===1)throw s=Nu,ua(e,0),io(e,n),_n(e,$e()),s;if(s===6)throw Error(pt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,ra(e,dn,yr),_n(e,$e()),null}function fm(e,n){var s=ee;ee|=1;try{return e(n)}finally{ee=s,ee===0&&(Xl=$e()+500,df&&yo())}}function va(e){so!==null&&so.tag===0&&!(ee&6)&&Ul();var n=ee;ee|=1;var s=Jn.transition,a=fe;try{if(Jn.transition=null,fe=1,e)return e()}finally{fe=a,Jn.transition=s,ee=n,!(ee&6)&&yo()}}function pm(){Dn=Bl.current,be(Bl)}function ua(e,n){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,rP(s)),Ze!==null)for(s=Ze.return;s!==null;){var a=s;switch(Y_(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&Nd();break;case 3:Gl(),be(pn),be(Gi),nm();break;case 5:im(a);break;case 4:Gl();break;case 13:be(Fe);break;case 19:be(Fe);break;case 10:K_(a.type._context);break;case 22:case 23:pm()}s=s.return}if(xi=e,Ze=e=po(e.current,null),Li=Dn=n,di=0,Nu=null,cm=_f=ma=0,dn=wu=null,aa!==null){for(n=0;n<aa.length;n++)if(s=aa[n],a=s.interleaved,a!==null){s.interleaved=null;var u=a.next,d=s.pending;if(d!==null){var _=d.next;d.next=u,a.next=_}s.pending=a}aa=null}return e}function xx(e,n){do{var s=Ze;try{if(Z_(),wd.current=$d,Xd){for(var a=Be.memoizedState;a!==null;){var u=a.queue;u!==null&&(u.pending=null),a=a.next}Xd=!1}if(_a=0,wi=ci=Be=null,vu=!1,Lu=0,um.current=null,s===null||s.return===null){di=1,Nu=n,Ze=null;break}t:{var d=e,_=s.return,v=s,x=n;if(n=Li,v.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){var b=x,E=v,R=E.tag;if(!(E.mode&1)&&(R===0||R===11||R===15)){var L=E.alternate;L?(E.updateQueue=L.updateQueue,E.memoizedState=L.memoizedState,E.lanes=L.lanes):(E.updateQueue=null,E.memoizedState=null)}var U=A0(_);if(U!==null){U.flags&=-257,E0(U,_,v,d,n),U.mode&1&&S0(d,b,n),n=U,x=b;var H=n.updateQueue;if(H===null){var $=new Set;$.add(x),n.updateQueue=$}else H.add(x);break t}else{if(!(n&1)){S0(d,b,n),gm();break t}x=Error(pt(426))}}else if(Te&&v.mode&1){var G=A0(_);if(G!==null){!(G.flags&65536)&&(G.flags|=256),E0(G,_,v,d,n),Q_(Vl(x,v));break t}}d=x=Vl(x,v),di!==4&&(di=2),wu===null?wu=[d]:wu.push(d),d=_;do{switch(d.tag){case 3:d.flags|=65536,n&=-n,d.lanes|=n;var k=sx(d,x,n);v0(d,k);break t;case 1:v=x;var B=d.type,N=d.stateNode;if(!(d.flags&128)&&(typeof B.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(co===null||!co.has(N)))){d.flags|=65536,n&=-n,d.lanes|=n;var J=rx(d,v,n);v0(d,J);break t}}d=d.return}while(d!==null)}Sx(s)}catch(K){n=K,Ze===s&&s!==null&&(Ze=s=s.return);continue}break}while(!0)}function bx(){var e=Yd.current;return Yd.current=$d,e===null?$d:e}function gm(){(di===0||di===3||di===2)&&(di=4),xi===null||!(ma&268435455)&&!(_f&268435455)||io(xi,Li)}function Zd(e,n){var s=ee;ee|=2;var a=bx();(xi!==e||Li!==n)&&(yr=null,ua(e,n));do try{IP();break}catch(u){xx(e,u)}while(!0);if(Z_(),ee=s,Yd.current=a,Ze!==null)throw Error(pt(261));return xi=null,Li=0,di}function IP(){for(;Ze!==null;)Cx(Ze)}function DP(){for(;Ze!==null&&!iT();)Cx(Ze)}function Cx(e){var n=Ex(e.alternate,e,Dn);e.memoizedProps=e.pendingProps,n===null?Sx(e):Ze=n,um.current=null}function Sx(e){var n=e;do{var s=n.alternate;if(e=n.return,n.flags&32768){if(s=SP(s,n),s!==null){s.flags&=32767,Ze=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{di=6,Ze=null;return}}else if(s=CP(s,n,Dn),s!==null){Ze=s;return}if(n=n.sibling,n!==null){Ze=n;return}Ze=n=e}while(n!==null);di===0&&(di=5)}function ra(e,n,s){var a=fe,u=Jn.transition;try{Jn.transition=null,fe=1,FP(e,n,s,a)}finally{Jn.transition=u,fe=a}return null}function FP(e,n,s,a){do Ul();while(so!==null);if(ee&6)throw Error(pt(327));s=e.finishedWork;var u=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(pt(177));e.callbackNode=null,e.callbackPriority=0;var d=s.lanes|s.childLanes;if(dT(e,d),e===xi&&(Ze=xi=null,Li=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||dd||(dd=!0,Tx(Fd,function(){return Ul(),null})),d=(s.flags&15990)!==0,s.subtreeFlags&15990||d){d=Jn.transition,Jn.transition=null;var _=fe;fe=1;var v=ee;ee|=4,um.current=null,EP(e,s),vx(s,e),KT(Xg),kd=!!Vg,Xg=Vg=null,e.current=s,TP(s),nT(),ee=v,fe=_,Jn.transition=d}else e.current=s;if(dd&&(dd=!1,so=e,qd=u),d=e.pendingLanes,d===0&&(co=null),oT(s.stateNode),_n(e,$e()),n!==null)for(a=e.onRecoverableError,s=0;s<n.length;s++)u=n[s],a(u.value,{componentStack:u.stack,digest:u.digest});if(Qd)throw Qd=!1,e=d_,d_=null,e;return qd&1&&e.tag!==0&&Ul(),d=e.pendingLanes,d&1?e===f_?xu++:(xu=0,f_=e):xu=0,yo(),null}function Ul(){if(so!==null){var e=sw(qd),n=Jn.transition,s=fe;try{if(Jn.transition=null,fe=16>e?16:e,so===null)var a=!1;else{if(e=so,so=null,qd=0,ee&6)throw Error(pt(331));var u=ee;for(ee|=4,Ct=e.current;Ct!==null;){var d=Ct,_=d.child;if(Ct.flags&16){var v=d.deletions;if(v!==null){for(var x=0;x<v.length;x++){var b=v[x];for(Ct=b;Ct!==null;){var E=Ct;switch(E.tag){case 0:case 11:case 15:yu(8,E,d)}var R=E.child;if(R!==null)R.return=E,Ct=R;else for(;Ct!==null;){E=Ct;var L=E.sibling,U=E.return;if(gx(E),E===b){Ct=null;break}if(L!==null){L.return=U,Ct=L;break}Ct=U}}}var H=d.alternate;if(H!==null){var $=H.child;if($!==null){H.child=null;do{var G=$.sibling;$.sibling=null,$=G}while($!==null)}}Ct=d}}if(d.subtreeFlags&2064&&_!==null)_.return=d,Ct=_;else t:for(;Ct!==null;){if(d=Ct,d.flags&2048)switch(d.tag){case 0:case 11:case 15:yu(9,d,d.return)}var k=d.sibling;if(k!==null){k.return=d.return,Ct=k;break t}Ct=d.return}}var B=e.current;for(Ct=B;Ct!==null;){_=Ct;var N=_.child;if(_.subtreeFlags&2064&&N!==null)N.return=_,Ct=N;else t:for(_=B;Ct!==null;){if(v=Ct,v.flags&2048)try{switch(v.tag){case 0:case 11:case 15:gf(9,v)}}catch(K){Ue(v,v.return,K)}if(v===_){Ct=null;break t}var J=v.sibling;if(J!==null){J.return=v.return,Ct=J;break t}Ct=v.return}}if(ee=u,yo(),Zs&&typeof Zs.onPostCommitFiberRoot=="function")try{Zs.onPostCommitFiberRoot(af,e)}catch{}a=!0}return a}finally{fe=s,Jn.transition=n}}return!1}function U0(e,n,s){n=Vl(s,n),n=sx(e,n,1),e=uo(e,n,1),n=Ki(),e!==null&&(Gu(e,1,n),_n(e,n))}function Ue(e,n,s){if(e.tag===3)U0(e,e,s);else for(;n!==null;){if(n.tag===3){U0(n,e,s);break}else if(n.tag===1){var a=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(co===null||!co.has(a))){e=Vl(s,e),e=rx(n,e,1),n=uo(n,e,1),e=Ki(),n!==null&&(Gu(n,1,e),_n(n,e));break}}n=n.return}}function BP(e,n,s){var a=e.pingCache;a!==null&&a.delete(n),n=Ki(),e.pingedLanes|=e.suspendedLanes&s,xi===e&&(Li&s)===s&&(di===4||di===3&&(Li&130023424)===Li&&500>$e()-dm?ua(e,0):cm|=s),_n(e,n)}function Ax(e,n){n===0&&(e.mode&1?(n=id,id<<=1,!(id&130023424)&&(id=4194304)):n=1);var s=Ki();e=Tr(e,n),e!==null&&(Gu(e,n,s),_n(e,s))}function kP(e){var n=e.memoizedState,s=0;n!==null&&(s=n.retryLane),Ax(e,s)}function LP(e,n){var s=0;switch(e.tag){case 13:var a=e.stateNode,u=e.memoizedState;u!==null&&(s=u.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(pt(314))}a!==null&&a.delete(n),Ax(e,s)}var Ex;Ex=function(e,n,s){if(e!==null)if(e.memoizedProps!==n.pendingProps||pn.current)fn=!0;else{if(!(e.lanes&s)&&!(n.flags&128))return fn=!1,bP(e,n,s);fn=!!(e.flags&131072)}else fn=!1,Te&&n.flags&1048576&&Iw(n,Hd,n.index);switch(n.lanes=0,n.tag){case 2:var a=n.type;bd(e,n),e=n.pendingProps;var u=Hl(n,Gi.current);Nl(n,s),u=rm(null,n,a,e,u,s);var d=om();return n.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,gn(a)?(d=!0,Ud(n)):d=!1,n.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,tm(n),u.updater=pf,n.stateNode=u,u._reactInternals=n,e_(n,a,e,s),n=s_(null,n,a,!0,d,s)):(n.tag=0,Te&&d&&$_(n),Zi(null,n,u,s),n=n.child),n;case 16:a=n.elementType;t:{switch(bd(e,n),e=n.pendingProps,u=a._init,a=u(a._payload),n.type=a,u=n.tag=OP(a),e=Cs(a,e),u){case 0:n=n_(null,n,a,e,s);break t;case 1:n=R0(null,n,a,e,s);break t;case 11:n=T0(null,n,a,e,s);break t;case 14:n=P0(null,n,a,Cs(a.type,e),s);break t}throw Error(pt(306,a,""))}return n;case 0:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:Cs(a,u),n_(e,n,a,u,s);case 1:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:Cs(a,u),R0(e,n,a,u,s);case 3:t:{if(hx(n),e===null)throw Error(pt(387));a=n.pendingProps,d=n.memoizedState,u=d.element,Mw(e,n),Gd(n,a,null,s);var _=n.memoizedState;if(a=_.element,d.isDehydrated)if(d={element:a,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},n.updateQueue.baseState=d,n.memoizedState=d,n.flags&256){u=Vl(Error(pt(423)),n),n=I0(e,n,a,s,u);break t}else if(a!==u){u=Vl(Error(pt(424)),n),n=I0(e,n,a,s,u);break t}else for(Fn=ho(n.stateNode.containerInfo.firstChild),Bn=n,Te=!0,As=null,s=kw(n,null,a,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Wl(),a===u){n=Pr(e,n,s);break t}Zi(e,n,a,s)}n=n.child}return n;case 5:return Ow(n),e===null&&Kg(n),a=n.type,u=n.pendingProps,d=e!==null?e.memoizedProps:null,_=u.children,$g(a,u)?_=null:d!==null&&$g(a,d)&&(n.flags|=32),lx(e,n),Zi(e,n,_,s),n.child;case 6:return e===null&&Kg(n),null;case 13:return ux(e,n,s);case 4:return em(n,n.stateNode.containerInfo),a=n.pendingProps,e===null?n.child=jl(n,null,a,s):Zi(e,n,a,s),n.child;case 11:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:Cs(a,u),T0(e,n,a,u,s);case 7:return Zi(e,n,n.pendingProps,s),n.child;case 8:return Zi(e,n,n.pendingProps.children,s),n.child;case 12:return Zi(e,n,n.pendingProps.children,s),n.child;case 10:t:{if(a=n.type._context,u=n.pendingProps,d=n.memoizedProps,_=u.value,me(Wd,a._currentValue),a._currentValue=_,d!==null)if(Ps(d.value,_)){if(d.children===u.children&&!pn.current){n=Pr(e,n,s);break t}}else for(d=n.child,d!==null&&(d.return=n);d!==null;){var v=d.dependencies;if(v!==null){_=d.child;for(var x=v.firstContext;x!==null;){if(x.context===a){if(d.tag===1){x=Sr(-1,s&-s),x.tag=2;var b=d.updateQueue;if(b!==null){b=b.shared;var E=b.pending;E===null?x.next=x:(x.next=E.next,E.next=x),b.pending=x}}d.lanes|=s,x=d.alternate,x!==null&&(x.lanes|=s),Jg(d.return,s,n),v.lanes|=s;break}x=x.next}}else if(d.tag===10)_=d.type===n.type?null:d.child;else if(d.tag===18){if(_=d.return,_===null)throw Error(pt(341));_.lanes|=s,v=_.alternate,v!==null&&(v.lanes|=s),Jg(_,s,n),_=d.sibling}else _=d.child;if(_!==null)_.return=d;else for(_=d;_!==null;){if(_===n){_=null;break}if(d=_.sibling,d!==null){d.return=_.return,_=d;break}_=_.return}d=_}Zi(e,n,u.children,s),n=n.child}return n;case 9:return u=n.type,a=n.pendingProps.children,Nl(n,s),u=ts(u),a=a(u),n.flags|=1,Zi(e,n,a,s),n.child;case 14:return a=n.type,u=Cs(a,n.pendingProps),u=Cs(a.type,u),P0(e,n,a,u,s);case 15:return ox(e,n,n.type,n.pendingProps,s);case 17:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:Cs(a,u),bd(e,n),n.tag=1,gn(a)?(e=!0,Ud(n)):e=!1,Nl(n,s),nx(n,a,u),e_(n,a,u,s),s_(null,n,a,!0,e,s);case 19:return cx(e,n,s);case 22:return ax(e,n,s)}throw Error(pt(156,n.tag))};function Tx(e,n){return tw(e,n)}function MP(e,n,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kn(e,n,s,a){return new MP(e,n,s,a)}function _m(e){return e=e.prototype,!(!e||!e.isReactComponent)}function OP(e){if(typeof e=="function")return _m(e)?1:0;if(e!=null){if(e=e.$$typeof,e===L_)return 11;if(e===M_)return 14}return 2}function po(e,n){var s=e.alternate;return s===null?(s=Kn(e.tag,n,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=n,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,n=e.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Ad(e,n,s,a,u,d){var _=2;if(a=e,typeof e=="function")_m(e)&&(_=1);else if(typeof e=="string")_=5;else t:switch(e){case Cl:return ca(s.children,u,d,n);case k_:_=8,u|=8;break;case Ag:return e=Kn(12,s,n,u|2),e.elementType=Ag,e.lanes=d,e;case Eg:return e=Kn(13,s,n,u),e.elementType=Eg,e.lanes=d,e;case Tg:return e=Kn(19,s,n,u),e.elementType=Tg,e.lanes=d,e;case Oy:return mf(s,u,d,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ly:_=10;break t;case My:_=9;break t;case L_:_=11;break t;case M_:_=14;break t;case Jr:_=16,a=null;break t}throw Error(pt(130,e==null?e:typeof e,""))}return n=Kn(_,s,n,u),n.elementType=e,n.type=a,n.lanes=d,n}function ca(e,n,s,a){return e=Kn(7,e,a,n),e.lanes=s,e}function mf(e,n,s,a){return e=Kn(22,e,a,n),e.elementType=Oy,e.lanes=s,e.stateNode={isHidden:!1},e}function dg(e,n,s){return e=Kn(6,e,null,n),e.lanes=s,e}function fg(e,n,s){return n=Kn(4,e.children!==null?e.children:[],e.key,n),n.lanes=s,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function NP(e,n,s,a,u){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$p(0),this.expirationTimes=$p(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$p(0),this.identifierPrefix=a,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function mm(e,n,s,a,u,d,_,v,x){return e=new NP(e,n,s,v,x),n===1?(n=1,d===!0&&(n|=8)):n=0,d=Kn(3,null,null,n),e.current=d,d.stateNode=e,d.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},tm(d),e}function UP(e,n,s){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bl,key:a==null?null:""+a,children:e,containerInfo:n,implementation:s}}function Px(e){if(!e)return _o;e=e._reactInternals;t:{if(xa(e)!==e||e.tag!==1)throw Error(pt(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break t;case 1:if(gn(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break t}}n=n.return}while(n!==null);throw Error(pt(171))}if(e.tag===1){var s=e.type;if(gn(s))return Pw(e,s,n)}return n}function Rx(e,n,s,a,u,d,_,v,x){return e=mm(s,a,!0,e,u,d,_,v,x),e.context=Px(null),s=e.current,a=Ki(),u=fo(s),d=Sr(a,u),d.callback=n??null,uo(s,d,u),e.current.lanes=u,Gu(e,u,a),_n(e,a),e}function vf(e,n,s,a){var u=n.current,d=Ki(),_=fo(u);return s=Px(s),n.context===null?n.context=s:n.pendingContext=s,n=Sr(d,_),n.payload={element:e},a=a===void 0?null:a,a!==null&&(n.callback=a),e=uo(u,n,_),e!==null&&(Ts(e,u,_,d),yd(e,u,_)),_}function Kd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function z0(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<n?s:n}}function vm(e,n){z0(e,n),(e=e.alternate)&&z0(e,n)}function zP(){return null}var Ix=typeof reportError=="function"?reportError:function(e){console.error(e)};function ym(e){this._internalRoot=e}yf.prototype.render=ym.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(pt(409));vf(e,n,null,null)};yf.prototype.unmount=ym.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;va(function(){vf(null,e,null,null)}),n[Er]=null}};function yf(e){this._internalRoot=e}yf.prototype.unstable_scheduleHydration=function(e){if(e){var n=aw();e={blockedOn:null,target:e,priority:n};for(var s=0;s<eo.length&&n!==0&&n<eo[s].priority;s++);eo.splice(s,0,e),s===0&&hw(e)}};function wm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function wf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function H0(){}function HP(e,n,s,a,u){if(u){if(typeof a=="function"){var d=a;a=function(){var b=Kd(_);d.call(b)}}var _=Rx(n,a,e,0,null,!1,!1,"",H0);return e._reactRootContainer=_,e[Er]=_.current,Iu(e.nodeType===8?e.parentNode:e),va(),_}for(;u=e.lastChild;)e.removeChild(u);if(typeof a=="function"){var v=a;a=function(){var b=Kd(x);v.call(b)}}var x=mm(e,0,!1,null,null,!1,!1,"",H0);return e._reactRootContainer=x,e[Er]=x.current,Iu(e.nodeType===8?e.parentNode:e),va(function(){vf(n,x,s,a)}),x}function xf(e,n,s,a,u){var d=s._reactRootContainer;if(d){var _=d;if(typeof u=="function"){var v=u;u=function(){var x=Kd(_);v.call(x)}}vf(n,_,e,u)}else _=HP(s,n,e,u,a);return Kd(_)}rw=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var s=cu(n.pendingLanes);s!==0&&(U_(n,s|1),_n(n,$e()),!(ee&6)&&(Xl=$e()+500,yo()))}break;case 13:va(function(){var a=Tr(e,1);if(a!==null){var u=Ki();Ts(a,e,1,u)}}),vm(e,1)}};z_=function(e){if(e.tag===13){var n=Tr(e,134217728);if(n!==null){var s=Ki();Ts(n,e,134217728,s)}vm(e,134217728)}};ow=function(e){if(e.tag===13){var n=fo(e),s=Tr(e,n);if(s!==null){var a=Ki();Ts(s,e,n,a)}vm(e,n)}};aw=function(){return fe};lw=function(e,n){var s=fe;try{return fe=e,n()}finally{fe=s}};Og=function(e,n,s){switch(n){case"input":if(Ig(e,s),n=s.name,s.type==="radio"&&n!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<s.length;n++){var a=s[n];if(a!==e&&a.form===e.form){var u=cf(a);if(!u)throw Error(pt(90));Uy(a),Ig(a,u)}}}break;case"textarea":Hy(e,s);break;case"select":n=s.value,n!=null&&kl(e,!!s.multiple,n,!1)}};Yy=fm;Qy=va;var WP={usingClientEntryPoint:!1,Events:[Xu,Tl,cf,Xy,$y,fm]},ou={findFiberByHostInstance:oa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jP={bundleType:ou.bundleType,version:ou.version,rendererPackageName:ou.rendererPackageName,rendererConfig:ou.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ky(e),e===null?null:e.stateNode},findFiberByHostInstance:ou.findFiberByHostInstance||zP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fd.isDisabled&&fd.supportsFiber)try{af=fd.inject(jP),Zs=fd}catch{}}On.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WP;On.createPortal=function(e,n){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wm(n))throw Error(pt(200));return UP(e,n,null,s)};On.createRoot=function(e,n){if(!wm(e))throw Error(pt(299));var s=!1,a="",u=Ix;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),n=mm(e,1,!1,null,null,s,!1,a,u),e[Er]=n.current,Iu(e.nodeType===8?e.parentNode:e),new ym(n)};On.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(pt(188)):(e=Object.keys(e).join(","),Error(pt(268,e)));return e=Ky(n),e=e===null?null:e.stateNode,e};On.flushSync=function(e){return va(e)};On.hydrate=function(e,n,s){if(!wf(n))throw Error(pt(200));return xf(null,e,n,!0,s)};On.hydrateRoot=function(e,n,s){if(!wm(e))throw Error(pt(405));var a=s!=null&&s.hydratedSources||null,u=!1,d="",_=Ix;if(s!=null&&(s.unstable_strictMode===!0&&(u=!0),s.identifierPrefix!==void 0&&(d=s.identifierPrefix),s.onRecoverableError!==void 0&&(_=s.onRecoverableError)),n=Rx(n,null,e,1,s??null,u,!1,d,_),e[Er]=n.current,Iu(e),a)for(e=0;e<a.length;e++)s=a[e],u=s._getVersion,u=u(s._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[s,u]:n.mutableSourceEagerHydrationData.push(s,u);return new yf(n)};On.render=function(e,n,s){if(!wf(n))throw Error(pt(200));return xf(null,e,n,!1,s)};On.unmountComponentAtNode=function(e){if(!wf(e))throw Error(pt(40));return e._reactRootContainer?(va(function(){xf(null,null,e,!1,function(){e._reactRootContainer=null,e[Er]=null})}),!0):!1};On.unstable_batchedUpdates=fm;On.unstable_renderSubtreeIntoContainer=function(e,n,s,a){if(!wf(s))throw Error(pt(200));if(e==null||e._reactInternals===void 0)throw Error(pt(38));return xf(e,n,s,!1,a)};On.version="18.3.1-next-f1338f8080-20240426";function Dx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Dx)}catch(e){console.error(e)}}Dx(),Dy.exports=On;var GP=Dy.exports,W0=GP;Cg.createRoot=W0.createRoot,Cg.hydrateRoot=W0.hydrateRoot;const VP="modulepreload",XP=function(e){return"/ais-telegram-webpages/"+e},j0={},$P=function(n,s,a){let u=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const _=document.querySelector("meta[property=csp-nonce]"),v=(_==null?void 0:_.nonce)||(_==null?void 0:_.getAttribute("nonce"));u=Promise.allSettled(s.map(x=>{if(x=XP(x),x in j0)return;j0[x]=!0;const b=x.endsWith(".css"),E=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${E}`))return;const R=document.createElement("link");if(R.rel=b?"stylesheet":VP,b||(R.as="script"),R.crossOrigin="",R.href=x,v&&R.setAttribute("nonce",v),document.head.appendChild(R),b)return new Promise((L,U)=>{R.addEventListener("load",L),R.addEventListener("error",()=>U(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(_){const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=_,window.dispatchEvent(v),!v.defaultPrevented)throw _}return u.then(_=>{for(const v of _||[])v.status==="rejected"&&d(v.reason);return n().catch(d)})};var Fx={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var n={}.hasOwnProperty;function s(){for(var d="",_=0;_<arguments.length;_++){var v=arguments[_];v&&(d=u(d,a(v)))}return d}function a(d){if(typeof d=="string"||typeof d=="number")return d;if(typeof d!="object")return"";if(Array.isArray(d))return s.apply(null,d);if(d.toString!==Object.prototype.toString&&!d.toString.toString().includes("[native code]"))return d.toString();var _="";for(var v in d)n.call(d,v)&&d[v]&&(_=u(_,v));return _}function u(d,_){return _?d?d+" "+_:d+_:d}e.exports?(s.default=s,e.exports=s):window.classNames=s})()})(Fx);var YP=Fx.exports;const en=E_(YP),QP=["xxl","xl","lg","md","sm","xs"],qP="xs",ZP=lt.createContext({prefixes:{},breakpoints:QP,minBreakpoint:qP});function Un(e,n){const{prefixes:s}=lt.useContext(ZP);return e||s[n]||n}var Bx={exports:{}},KP="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",JP=KP,tR=JP;function kx(){}function Lx(){}Lx.resetWarningCache=kx;var eR=function(){function e(a,u,d,_,v,x){if(x!==tR){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}e.isRequired=e;function n(){return e}var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:Lx,resetWarningCache:kx};return s.PropTypes=s,s};Bx.exports=eR();var iR=Bx.exports;const au=E_(iR),Mx=e=>lt.forwardRef((n,s)=>ct.jsx("div",{...n,ref:s,className:en(n.className,e)})),nR=["as","disabled"];function sR(e,n){if(e==null)return{};var s={},a=Object.keys(e),u,d;for(d=0;d<a.length;d++)u=a[d],!(n.indexOf(u)>=0)&&(s[u]=e[u]);return s}function rR(e){return!e||e.trim()==="#"}function Ox({tagName:e,disabled:n,href:s,target:a,rel:u,role:d,onClick:_,tabIndex:v=0,type:x}){e||(s!=null||a!=null||u!=null?e="a":e="button");const b={tagName:e};if(e==="button")return[{type:x||"button",disabled:n},b];const E=L=>{if((n||e==="a"&&rR(s))&&L.preventDefault(),n){L.stopPropagation();return}_==null||_(L)},R=L=>{L.key===" "&&(L.preventDefault(),E(L))};return e==="a"&&(s||(s="#"),n&&(s=void 0)),[{role:d??"button",disabled:void 0,tabIndex:n?void 0:v,href:s,target:e==="a"?a:void 0,"aria-disabled":n||void 0,rel:e==="a"?u:void 0,onClick:E,onKeyDown:R},b]}const oR=lt.forwardRef((e,n)=>{let{as:s,disabled:a}=e,u=sR(e,nR);const[d,{tagName:_}]=Ox(Object.assign({tagName:s,disabled:a},u));return ct.jsx(_,Object.assign({},u,d,{ref:n}))});oR.displayName="Button";const xm=lt.forwardRef(({as:e,bsPrefix:n,variant:s="primary",size:a,active:u=!1,disabled:d=!1,className:_,...v},x)=>{const b=Un(n,"btn"),[E,{tagName:R}]=Ox({tagName:e,disabled:d,...v}),L=R;return ct.jsx(L,{...E,...v,ref:x,disabled:d,className:en(_,b,u&&"active",s&&`${b}-${s}`,a&&`${b}-${a}`,v.href&&d&&"disabled")})});xm.displayName="Button";const bm=lt.forwardRef(({className:e,bsPrefix:n,as:s="div",...a},u)=>(n=Un(n,"card-body"),ct.jsx(s,{ref:u,className:en(e,n),...a})));bm.displayName="CardBody";const Nx=lt.forwardRef(({className:e,bsPrefix:n,as:s="div",...a},u)=>(n=Un(n,"card-footer"),ct.jsx(s,{ref:u,className:en(e,n),...a})));Nx.displayName="CardFooter";const Ux=lt.createContext(null);Ux.displayName="CardHeaderContext";const zx=lt.forwardRef(({bsPrefix:e,className:n,as:s="div",...a},u)=>{const d=Un(e,"card-header"),_=lt.useMemo(()=>({cardHeaderBsPrefix:d}),[d]);return ct.jsx(Ux.Provider,{value:_,children:ct.jsx(s,{ref:u,...a,className:en(n,d)})})});zx.displayName="CardHeader";const Hx=lt.forwardRef(({bsPrefix:e,className:n,variant:s,as:a="img",...u},d)=>{const _=Un(e,"card-img");return ct.jsx(a,{ref:d,className:en(s?`${_}-${s}`:_,n),...u})});Hx.displayName="CardImg";const Wx=lt.forwardRef(({className:e,bsPrefix:n,as:s="div",...a},u)=>(n=Un(n,"card-img-overlay"),ct.jsx(s,{ref:u,className:en(e,n),...a})));Wx.displayName="CardImgOverlay";const jx=lt.forwardRef(({className:e,bsPrefix:n,as:s="a",...a},u)=>(n=Un(n,"card-link"),ct.jsx(s,{ref:u,className:en(e,n),...a})));jx.displayName="CardLink";const aR=Mx("h6"),Gx=lt.forwardRef(({className:e,bsPrefix:n,as:s=aR,...a},u)=>(n=Un(n,"card-subtitle"),ct.jsx(s,{ref:u,className:en(e,n),...a})));Gx.displayName="CardSubtitle";const Vx=lt.forwardRef(({className:e,bsPrefix:n,as:s="p",...a},u)=>(n=Un(n,"card-text"),ct.jsx(s,{ref:u,className:en(e,n),...a})));Vx.displayName="CardText";const lR=Mx("h5"),Xx=lt.forwardRef(({className:e,bsPrefix:n,as:s=lR,...a},u)=>(n=Un(n,"card-title"),ct.jsx(s,{ref:u,className:en(e,n),...a})));Xx.displayName="CardTitle";const $x=lt.forwardRef(({bsPrefix:e,className:n,bg:s,text:a,border:u,body:d=!1,children:_,as:v="div",...x},b)=>{const E=Un(e,"card");return ct.jsx(v,{ref:b,...x,className:en(n,E,s&&`bg-${s}`,a&&`text-${a}`,u&&`border-${u}`),children:d?ct.jsx(bm,{children:_}):_})});$x.displayName="Card";const G0=Object.assign($x,{Img:Hx,Title:Xx,Subtitle:Gx,Body:bm,Link:jx,Text:Vx,Header:zx,Footer:Nx,ImgOverlay:Wx});function hR(e,n){let s=0;return lt.Children.map(e,a=>lt.isValidElement(a)?n(a,s++):a)}au.string,au.bool,au.bool,au.bool,au.bool;const ba=lt.forwardRef(({bsPrefix:e,className:n,fluid:s=!1,rounded:a=!1,roundedCircle:u=!1,thumbnail:d=!1,..._},v)=>(e=Un(e,"img"),ct.jsx("img",{ref:v,..._,className:en(n,s&&`${e}-fluid`,a&&"rounded",u&&"rounded-circle",d&&`${e}-thumbnail`)})));ba.displayName="Image";const V0=1e3;function uR(e,n,s){const a=(e-n)/(s-n)*100;return Math.round(a*V0)/V0}function X0({min:e,now:n,max:s,label:a,visuallyHidden:u,striped:d,animated:_,className:v,style:x,variant:b,bsPrefix:E,...R},L){return ct.jsx("div",{ref:L,...R,role:"progressbar",className:en(v,`${E}-bar`,{[`bg-${b}`]:b,[`${E}-bar-animated`]:_,[`${E}-bar-striped`]:_||d}),style:{width:`${uR(n,e,s)}%`,...x},"aria-valuenow":n,"aria-valuemin":e,"aria-valuemax":s,children:u?ct.jsx("span",{className:"visually-hidden",children:a}):a})}const Yx=lt.forwardRef(({isChild:e=!1,...n},s)=>{const a={min:0,max:100,animated:!1,visuallyHidden:!1,striped:!1,...n};if(a.bsPrefix=Un(a.bsPrefix,"progress"),e)return X0(a,s);const{min:u,now:d,max:_,label:v,visuallyHidden:x,striped:b,animated:E,bsPrefix:R,variant:L,className:U,children:H,...$}=a;return ct.jsx("div",{ref:s,...$,className:en(U,R),children:H?hR(H,G=>lt.cloneElement(G,{isChild:!0})):X0({min:u,now:d,max:_,label:v,visuallyHidden:x,striped:b,animated:E,bsPrefix:R,variant:L},s)})});Yx.displayName="ProgressBar";const cR="/ais-telegram-webpages/assets/DiggerButton-CiwoLz5n.png";function dR({onTap:e,children:n}){const s=lt.useRef(null),[a,u]=lt.useState(!1);lt.useContext(Rm),lt.useEffect(()=>{if(a){const x=setTimeout(()=>u(!1),100);return()=>clearTimeout(x)}},[a]);const d=(x,b)=>{const E=s.current;if(E){const R=E.getBoundingClientRect();return[x-R.left,b-R.top]}return[x,b]},_=x=>{u(!0);const b=x.touches;for(let E=0;E<b.length;E++){const R=b[E],[L,U]=d(R.clientX,R.clientY);e(L,U)}},v=x=>{if(!a){const[b,E]=d(x.clientX,x.clientY);e(b,E)}};return lt.useEffect(()=>{const x=E=>{E.touches.length===1&&E.changedTouches[0].clientY>0&&E.preventDefault()},b=s.current;return b&&(b.addEventListener("touchstart",x,{passive:!1}),b.addEventListener("touchmove",x,{passive:!1})),()=>{b&&(b.removeEventListener("touchstart",x),b.removeEventListener("touchmove",x))}},[]),ct.jsxs("div",{ref:s,className:"relative flex h-72 justify-center",onTouchStart:_,onMouseDown:v,children:[ct.jsx(ba,{src:cR,className:"tap-button w-100 h-auto object-contain",rounded:!0,draggable:"false"}),n]})}const Qx="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAABHNCSVQICAgIfAhkiAAABHFJREFUWEfVWVFO20AQnbWd/paegPxWVQn8VW0Q4QTQE5AbEE5AOAHhBA0naDhBjaBV/0ioqv7CCQq/je3pm107cRw7sZNg2pWiRIl39+3szJs3E0UrGny7vUMcVMlSVWJq6GUZnxVVU7dg7uO3B/z2gPc+nu2T7d+rN9/6WZDUolj5prFGlneAjQBM7S+6ztQ81uB7OLiral/P478XBqtB2v4pFmmuDGDWQgLc4o56e30ijxQCyz/fb5Jnf8GstScHGt9AXCZwdouBHWz/Lh3oGPRFbrDaqr59U6pFJ6xLj7nB6uC+rSNSVe1ZADOfFQOrg8vrAfBOqYAFaO26VQhsBBCcCibgVglWPifFXbCBW5gNktY07KAapIRnV2BtpkfNsUQuVYauev39bimenXX9/OtdlTynSkGYwZSq4gbwShmMrCXZixhciuzlOX215UpGmxo8+HBAZLUXcoMy/FUf/I+zhxtrRSn7nwE70hbK2iRmca3NpFFyg9UnHVbWR2IlzbyB5HUtSB5nCZJwrTZcYB2Wa+S9qUywOngCa08rKMYpF0qxjCgGeASM2ri6iIMKhVAbhzvMCfZ8AqxewPEOKVDNTGmXc+XpKAnVVGV4Eo9yQ4P0ac6yF8iezRFYPYnpdDELFj5BB5Y+imYh2hFElii5xOBL4GlP8CyAysnkhOWNSEmFdDVO5QDI3KMXfm+KZ7NPVQZu7qmN64+yk7hgJs/+qCNu6FjxoH6TRhNlQNV7+ParNJAmAId7wIYbN4wBsNtSRrwsDVxyI9vfimgO7ghwDJ7VpZIGGB8KD3TxBdLZMwzme6iparQzsPAsFMrUVJ5bgoKaxCGixfEb8eQxB6zh2bAIFAsjF5cxeEB20ExmuWywYAjf2Z9MCibq2iuRe2lnxrUjYNrgWDHM1JgCm3he2OAQfnMWn2l0qiVZTBx9uTLGbAg3I9DUlWjV0WAxjhU8xAIMPgurM/SsE3STlpcAkwdcADuJMsXEgiYFQydEGjV8Hz8kZflYh0Y6VQSNb7uptGRE0THmwSC8m7ZvmuVDsKN4dJE9uslOyKq8WFuSlTBPc7Tm4mDDJXQLB9Y213E5S+7NOogR0PYO8r7EAjRqSt9rabDpwRE20tQdDnKXCpIVXEKT+lrurFgQrDh9SZSVOCK4VtWucreioqTwHL2Ae7jYfhEXS+hZFuWOUuMJh2Qu4g4abZ0slZW1+1RZoyM2IOm37q8MeKwfkJUQ8pgH1FX/TBXvKCl0ZXJY5qRzrKnLYmoNKXHEgGFPQLi2MuzPWFvqr8tFeLaLqvSsiA/lsUbymbARcoA6T/oBYI2Fk4KYk0BN4Fe0ycnhwbLgw7JbUja4NqUfsBTYdAJ1zde4VoV2T3xIr8BKdMLHf4DML+ELgv3veBaWW1JdFXXgFPE9b4kxzw7q7bAJ9rT1WERjvt1anmdNh0SEB3h2RYWkAWiCNqh0i4KMLD6zMRf+6YF/DCFOdFePJY/jleEyWmiDTTRJA5wyoicvj85zg7/ODzdd40KoLAAAAABJRU5ErkJggg==";function fR({score:e}){return ct.jsxs("section",{className:"flex items-center justify-center gap-3 pb-2 pt-3",children:[ct.jsx("div",{className:"score-icon",children:ct.jsx(ba,{src:Qx})}),ct.jsx("span",{className:"text-5xl font-bold",children:e.toLocaleString()})]})}const pR=({number:e,x:n,y:s,onAnimationEnd:a})=>{const u=lt.useRef(null),[d,_]=lt.useState({x:n,y:s});return lt.useLayoutEffect(()=>{if(u.current){const v=n-u.current.clientWidth/2,x=s-u.current.clientHeight/2;_({x:v,y:x})}},[n,s]),lt.useEffect(()=>{const v=setTimeout(()=>{a()},1e3);return()=>clearTimeout(v)},[a]),ct.jsxs("div",{ref:u,className:"floating-number",style:{left:`${d.x}px`,top:`${d.y}px`},children:["+",e]})};function gR({size:e=1,className:n=""}){return ct.jsx("span",{className:`absolute top-[-3px] right-[-3px] bg-red-500 
                 rounded-full p-${e} ${n}`})}function pg({addClass:e,caption:n,onClick:s,disabled:a,children:u}){return ct.jsxs("div",{className:`captioned-button ${e??""}`,children:[ct.jsxs(xm,{className:"button group",onClick:s,disabled:a,children:[u,ct.jsx(gR,{className:"group-disabled:hidden"})]}),ct.jsx("div",{className:"text",children:n})]})}const _R="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAcCAYAAABlL09dAAAABHNCSVQICAgIfAhkiAAAAiBJREFUSEullU1OAkEQhatA3MoNHJfGKLgzOkQ8gXgC9QTqCdQTiCcQTyCeQAho3OFgjEvxBOJWA2X1AP033STOzGpoqr9+XfWqBiHjQ1FlCAhLEkPwjaVOEbNwqV+p8f47i3GMG51GVnCToftKLX1iqRuI3wkwvW8F8FtYdt2ElbRn69O4DyvugGPEYQ5wP2zx8m4STG3c6FYlONo5BcxdqTjzf0OxR8Vkb+F3BVefBwocDgBR3QxpD9e7LGrymOAovODgc0cabvmKRxL6tl2GUb6ncgtDyFFdQte7lzbYVCEi2T4wzge42RpKcL/S4PdDhwCxdM8iahJMr2EVCB8SwUSXXOkLfT3hXXmiEqHALhUOtfbBFBm5Nl1BvWoRcqMPznjR2hib3XNlIDPXRh1ixdxBojA3BoCU2b3g2S05FsYLZb0OU7DDuwRcSBooKH6LojhzbVlNxOBc7xqU8RmWHqWl5C2Jrrm4p/atkJPv864eG1vIOKdfaQJR2U7BLAbjk4kCuQmxzO/aYHH4eDJPuNhmt+kHJ4eQUKKDAaSFpF3FnAAs2v72gmPb5UdfWkAiBVMXNe3UJHJsVlmbWJ7miA9f/Alw7enFZ8PYFWZBQg7G0nQtkYJ5IK9iq4ucKUgHjsI6j8wT1zT7D1DaTVVafm0zpcAAy6+tp4tSK2bw3C5KBZbendNF6cCTLgpcgyQNUJ8VTf4wHumzNAtwtvcPuoUeLFmI7gkAAAAASUVORK5CYII=";function mR({energy:e,limit:n}){return ct.jsxs("section",{className:"flex w-auto items-center justify-center gap-1",children:[ct.jsx(ba,{src:_R}),ct.jsxs("span",{children:[e>=0?e:0," / ",n]})]})}function vR({token:e}){const n=s=>s>=1e9?`+${(s/1e9).toFixed(2)}K`:s>=1e6?`+${(s/1e6).toFixed(2)}K`:s>=1e3?`+${(s/1e3).toFixed(2)}K`:`+${s}`;return ct.jsxs("div",{className:"flex flex-col items-end justify-between",children:[ct.jsx("div",{className:"label",children:"Token Per Hour"}),ct.jsxs("div",{className:"flex flex-row items-center justify-end gap-2",children:[ct.jsx(ba,{src:Qx,className:"h-6"}),ct.jsx("span",{className:"text-3xl",children:n(e)})]})]})}function qx(e,n){return function(){return e.apply(n,arguments)}}const{toString:yR}=Object.prototype,{getPrototypeOf:Cm}=Object,bf=(e=>n=>{const s=yR.call(n);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Rs=e=>(e=e.toLowerCase(),n=>bf(n)===e),Cf=e=>n=>typeof n===e,{isArray:ql}=Array,Uu=Cf("undefined");function wR(e){return e!==null&&!Uu(e)&&e.constructor!==null&&!Uu(e.constructor)&&kn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Zx=Rs("ArrayBuffer");function xR(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&Zx(e.buffer),n}const bR=Cf("string"),kn=Cf("function"),Kx=Cf("number"),Sf=e=>e!==null&&typeof e=="object",CR=e=>e===!0||e===!1,Ed=e=>{if(bf(e)!=="object")return!1;const n=Cm(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},SR=Rs("Date"),AR=Rs("File"),ER=Rs("Blob"),TR=Rs("FileList"),PR=e=>Sf(e)&&kn(e.pipe),RR=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||kn(e.append)&&((n=bf(e))==="formdata"||n==="object"&&kn(e.toString)&&e.toString()==="[object FormData]"))},IR=Rs("URLSearchParams"),[DR,FR,BR,kR]=["ReadableStream","Request","Response","Headers"].map(Rs),LR=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Yu(e,n,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let a,u;if(typeof e!="object"&&(e=[e]),ql(e))for(a=0,u=e.length;a<u;a++)n.call(null,e[a],a,e);else{const d=s?Object.getOwnPropertyNames(e):Object.keys(e),_=d.length;let v;for(a=0;a<_;a++)v=d[a],n.call(null,e[v],v,e)}}function Jx(e,n){n=n.toLowerCase();const s=Object.keys(e);let a=s.length,u;for(;a-- >0;)if(u=s[a],n===u.toLowerCase())return u;return null}const ha=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,t1=e=>!Uu(e)&&e!==ha;function __(){const{caseless:e}=t1(this)&&this||{},n={},s=(a,u)=>{const d=e&&Jx(n,u)||u;Ed(n[d])&&Ed(a)?n[d]=__(n[d],a):Ed(a)?n[d]=__({},a):ql(a)?n[d]=a.slice():n[d]=a};for(let a=0,u=arguments.length;a<u;a++)arguments[a]&&Yu(arguments[a],s);return n}const MR=(e,n,s,{allOwnKeys:a}={})=>(Yu(n,(u,d)=>{s&&kn(u)?e[d]=qx(u,s):e[d]=u},{allOwnKeys:a}),e),OR=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),NR=(e,n,s,a)=>{e.prototype=Object.create(n.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),s&&Object.assign(e.prototype,s)},UR=(e,n,s,a)=>{let u,d,_;const v={};if(n=n||{},e==null)return n;do{for(u=Object.getOwnPropertyNames(e),d=u.length;d-- >0;)_=u[d],(!a||a(_,e,n))&&!v[_]&&(n[_]=e[_],v[_]=!0);e=s!==!1&&Cm(e)}while(e&&(!s||s(e,n))&&e!==Object.prototype);return n},zR=(e,n,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=n.length;const a=e.indexOf(n,s);return a!==-1&&a===s},HR=e=>{if(!e)return null;if(ql(e))return e;let n=e.length;if(!Kx(n))return null;const s=new Array(n);for(;n-- >0;)s[n]=e[n];return s},WR=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&Cm(Uint8Array)),jR=(e,n)=>{const a=(e&&e[Symbol.iterator]).call(e);let u;for(;(u=a.next())&&!u.done;){const d=u.value;n.call(e,d[0],d[1])}},GR=(e,n)=>{let s;const a=[];for(;(s=e.exec(n))!==null;)a.push(s);return a},VR=Rs("HTMLFormElement"),XR=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,a,u){return a.toUpperCase()+u}),$0=(({hasOwnProperty:e})=>(n,s)=>e.call(n,s))(Object.prototype),$R=Rs("RegExp"),e1=(e,n)=>{const s=Object.getOwnPropertyDescriptors(e),a={};Yu(s,(u,d)=>{let _;(_=n(u,d,e))!==!1&&(a[d]=_||u)}),Object.defineProperties(e,a)},YR=e=>{e1(e,(n,s)=>{if(kn(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const a=e[s];if(kn(a)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},QR=(e,n)=>{const s={},a=u=>{u.forEach(d=>{s[d]=!0})};return ql(e)?a(e):a(String(e).split(n)),s},qR=()=>{},ZR=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n,gg="abcdefghijklmnopqrstuvwxyz",Y0="0123456789",i1={DIGIT:Y0,ALPHA:gg,ALPHA_DIGIT:gg+gg.toUpperCase()+Y0},KR=(e=16,n=i1.ALPHA_DIGIT)=>{let s="";const{length:a}=n;for(;e--;)s+=n[Math.random()*a|0];return s};function JR(e){return!!(e&&kn(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const tI=e=>{const n=new Array(10),s=(a,u)=>{if(Sf(a)){if(n.indexOf(a)>=0)return;if(!("toJSON"in a)){n[u]=a;const d=ql(a)?[]:{};return Yu(a,(_,v)=>{const x=s(_,u+1);!Uu(x)&&(d[v]=x)}),n[u]=void 0,d}}return a};return s(e,0)},eI=Rs("AsyncFunction"),iI=e=>e&&(Sf(e)||kn(e))&&kn(e.then)&&kn(e.catch),n1=((e,n)=>e?setImmediate:n?((s,a)=>(ha.addEventListener("message",({source:u,data:d})=>{u===ha&&d===s&&a.length&&a.shift()()},!1),u=>{a.push(u),ha.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",kn(ha.postMessage)),nI=typeof queueMicrotask<"u"?queueMicrotask.bind(ha):typeof process<"u"&&process.nextTick||n1,it={isArray:ql,isArrayBuffer:Zx,isBuffer:wR,isFormData:RR,isArrayBufferView:xR,isString:bR,isNumber:Kx,isBoolean:CR,isObject:Sf,isPlainObject:Ed,isReadableStream:DR,isRequest:FR,isResponse:BR,isHeaders:kR,isUndefined:Uu,isDate:SR,isFile:AR,isBlob:ER,isRegExp:$R,isFunction:kn,isStream:PR,isURLSearchParams:IR,isTypedArray:WR,isFileList:TR,forEach:Yu,merge:__,extend:MR,trim:LR,stripBOM:OR,inherits:NR,toFlatObject:UR,kindOf:bf,kindOfTest:Rs,endsWith:zR,toArray:HR,forEachEntry:jR,matchAll:GR,isHTMLForm:VR,hasOwnProperty:$0,hasOwnProp:$0,reduceDescriptors:e1,freezeMethods:YR,toObjectSet:QR,toCamelCase:XR,noop:qR,toFiniteNumber:ZR,findKey:Jx,global:ha,isContextDefined:t1,ALPHABET:i1,generateString:KR,isSpecCompliantForm:JR,toJSONObject:tI,isAsyncFn:eI,isThenable:iI,setImmediate:n1,asap:nI};function Ht(e,n,s,a,u){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),s&&(this.config=s),a&&(this.request=a),u&&(this.response=u,this.status=u.status?u.status:null)}it.inherits(Ht,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:it.toJSONObject(this.config),code:this.code,status:this.status}}});const s1=Ht.prototype,r1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{r1[e]={value:e}});Object.defineProperties(Ht,r1);Object.defineProperty(s1,"isAxiosError",{value:!0});Ht.from=(e,n,s,a,u,d)=>{const _=Object.create(s1);return it.toFlatObject(e,_,function(x){return x!==Error.prototype},v=>v!=="isAxiosError"),Ht.call(_,e.message,n,s,a,u),_.cause=e,_.name=e.name,d&&Object.assign(_,d),_};const sI=null;function m_(e){return it.isPlainObject(e)||it.isArray(e)}function o1(e){return it.endsWith(e,"[]")?e.slice(0,-2):e}function Q0(e,n,s){return e?e.concat(n).map(function(u,d){return u=o1(u),!s&&d?"["+u+"]":u}).join(s?".":""):n}function rI(e){return it.isArray(e)&&!e.some(m_)}const oI=it.toFlatObject(it,{},null,function(n){return/^is[A-Z]/.test(n)});function Af(e,n,s){if(!it.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,s=it.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function($,G){return!it.isUndefined(G[$])});const a=s.metaTokens,u=s.visitor||E,d=s.dots,_=s.indexes,x=(s.Blob||typeof Blob<"u"&&Blob)&&it.isSpecCompliantForm(n);if(!it.isFunction(u))throw new TypeError("visitor must be a function");function b(H){if(H===null)return"";if(it.isDate(H))return H.toISOString();if(!x&&it.isBlob(H))throw new Ht("Blob is not supported. Use a Buffer instead.");return it.isArrayBuffer(H)||it.isTypedArray(H)?x&&typeof Blob=="function"?new Blob([H]):Buffer.from(H):H}function E(H,$,G){let k=H;if(H&&!G&&typeof H=="object"){if(it.endsWith($,"{}"))$=a?$:$.slice(0,-2),H=JSON.stringify(H);else if(it.isArray(H)&&rI(H)||(it.isFileList(H)||it.endsWith($,"[]"))&&(k=it.toArray(H)))return $=o1($),k.forEach(function(N,J){!(it.isUndefined(N)||N===null)&&n.append(_===!0?Q0([$],J,d):_===null?$:$+"[]",b(N))}),!1}return m_(H)?!0:(n.append(Q0(G,$,d),b(H)),!1)}const R=[],L=Object.assign(oI,{defaultVisitor:E,convertValue:b,isVisitable:m_});function U(H,$){if(!it.isUndefined(H)){if(R.indexOf(H)!==-1)throw Error("Circular reference detected in "+$.join("."));R.push(H),it.forEach(H,function(k,B){(!(it.isUndefined(k)||k===null)&&u.call(n,k,it.isString(B)?B.trim():B,$,L))===!0&&U(k,$?$.concat(B):[B])}),R.pop()}}if(!it.isObject(e))throw new TypeError("data must be an object");return U(e),n}function q0(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return n[a]})}function Sm(e,n){this._pairs=[],e&&Af(e,this,n)}const a1=Sm.prototype;a1.append=function(n,s){this._pairs.push([n,s])};a1.toString=function(n){const s=n?function(a){return n.call(this,a,q0)}:q0;return this._pairs.map(function(u){return s(u[0])+"="+s(u[1])},"").join("&")};function aI(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function l1(e,n,s){if(!n)return e;const a=s&&s.encode||aI,u=s&&s.serialize;let d;if(u?d=u(n,s):d=it.isURLSearchParams(n)?n.toString():new Sm(n,s).toString(a),d){const _=e.indexOf("#");_!==-1&&(e=e.slice(0,_)),e+=(e.indexOf("?")===-1?"?":"&")+d}return e}class Z0{constructor(){this.handlers=[]}use(n,s,a){return this.handlers.push({fulfilled:n,rejected:s,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){it.forEach(this.handlers,function(a){a!==null&&n(a)})}}const h1={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},lI=typeof URLSearchParams<"u"?URLSearchParams:Sm,hI=typeof FormData<"u"?FormData:null,uI=typeof Blob<"u"?Blob:null,cI={isBrowser:!0,classes:{URLSearchParams:lI,FormData:hI,Blob:uI},protocols:["http","https","file","blob","url","data"]},Am=typeof window<"u"&&typeof document<"u",v_=typeof navigator=="object"&&navigator||void 0,dI=Am&&(!v_||["ReactNative","NativeScript","NS"].indexOf(v_.product)<0),fI=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",pI=Am&&window.location.href||"http://localhost",gI=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Am,hasStandardBrowserEnv:dI,hasStandardBrowserWebWorkerEnv:fI,navigator:v_,origin:pI},Symbol.toStringTag,{value:"Module"})),Ln={...gI,...cI};function _I(e,n){return Af(e,new Ln.classes.URLSearchParams,Object.assign({visitor:function(s,a,u,d){return Ln.isNode&&it.isBuffer(s)?(this.append(a,s.toString("base64")),!1):d.defaultVisitor.apply(this,arguments)}},n))}function mI(e){return it.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function vI(e){const n={},s=Object.keys(e);let a;const u=s.length;let d;for(a=0;a<u;a++)d=s[a],n[d]=e[d];return n}function u1(e){function n(s,a,u,d){let _=s[d++];if(_==="__proto__")return!0;const v=Number.isFinite(+_),x=d>=s.length;return _=!_&&it.isArray(u)?u.length:_,x?(it.hasOwnProp(u,_)?u[_]=[u[_],a]:u[_]=a,!v):((!u[_]||!it.isObject(u[_]))&&(u[_]=[]),n(s,a,u[_],d)&&it.isArray(u[_])&&(u[_]=vI(u[_])),!v)}if(it.isFormData(e)&&it.isFunction(e.entries)){const s={};return it.forEachEntry(e,(a,u)=>{n(mI(a),u,s,0)}),s}return null}function yI(e,n,s){if(it.isString(e))try{return(n||JSON.parse)(e),it.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(0,JSON.stringify)(e)}const Qu={transitional:h1,adapter:["xhr","http","fetch"],transformRequest:[function(n,s){const a=s.getContentType()||"",u=a.indexOf("application/json")>-1,d=it.isObject(n);if(d&&it.isHTMLForm(n)&&(n=new FormData(n)),it.isFormData(n))return u?JSON.stringify(u1(n)):n;if(it.isArrayBuffer(n)||it.isBuffer(n)||it.isStream(n)||it.isFile(n)||it.isBlob(n)||it.isReadableStream(n))return n;if(it.isArrayBufferView(n))return n.buffer;if(it.isURLSearchParams(n))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let v;if(d){if(a.indexOf("application/x-www-form-urlencoded")>-1)return _I(n,this.formSerializer).toString();if((v=it.isFileList(n))||a.indexOf("multipart/form-data")>-1){const x=this.env&&this.env.FormData;return Af(v?{"files[]":n}:n,x&&new x,this.formSerializer)}}return d||u?(s.setContentType("application/json",!1),yI(n)):n}],transformResponse:[function(n){const s=this.transitional||Qu.transitional,a=s&&s.forcedJSONParsing,u=this.responseType==="json";if(it.isResponse(n)||it.isReadableStream(n))return n;if(n&&it.isString(n)&&(a&&!this.responseType||u)){const _=!(s&&s.silentJSONParsing)&&u;try{return JSON.parse(n)}catch(v){if(_)throw v.name==="SyntaxError"?Ht.from(v,Ht.ERR_BAD_RESPONSE,this,null,this.response):v}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ln.classes.FormData,Blob:Ln.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};it.forEach(["delete","get","head","post","put","patch"],e=>{Qu.headers[e]={}});const wI=it.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),xI=e=>{const n={};let s,a,u;return e&&e.split(`
`).forEach(function(_){u=_.indexOf(":"),s=_.substring(0,u).trim().toLowerCase(),a=_.substring(u+1).trim(),!(!s||n[s]&&wI[s])&&(s==="set-cookie"?n[s]?n[s].push(a):n[s]=[a]:n[s]=n[s]?n[s]+", "+a:a)}),n},K0=Symbol("internals");function lu(e){return e&&String(e).trim().toLowerCase()}function Td(e){return e===!1||e==null?e:it.isArray(e)?e.map(Td):String(e)}function bI(e){const n=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=s.exec(e);)n[a[1]]=a[2];return n}const CI=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function _g(e,n,s,a,u){if(it.isFunction(a))return a.call(this,n,s);if(u&&(n=s),!!it.isString(n)){if(it.isString(a))return n.indexOf(a)!==-1;if(it.isRegExp(a))return a.test(n)}}function SI(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,s,a)=>s.toUpperCase()+a)}function AI(e,n){const s=it.toCamelCase(" "+n);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+s,{value:function(u,d,_){return this[a].call(this,n,u,d,_)},configurable:!0})})}class mn{constructor(n){n&&this.set(n)}set(n,s,a){const u=this;function d(v,x,b){const E=lu(x);if(!E)throw new Error("header name must be a non-empty string");const R=it.findKey(u,E);(!R||u[R]===void 0||b===!0||b===void 0&&u[R]!==!1)&&(u[R||x]=Td(v))}const _=(v,x)=>it.forEach(v,(b,E)=>d(b,E,x));if(it.isPlainObject(n)||n instanceof this.constructor)_(n,s);else if(it.isString(n)&&(n=n.trim())&&!CI(n))_(xI(n),s);else if(it.isHeaders(n))for(const[v,x]of n.entries())d(x,v,a);else n!=null&&d(s,n,a);return this}get(n,s){if(n=lu(n),n){const a=it.findKey(this,n);if(a){const u=this[a];if(!s)return u;if(s===!0)return bI(u);if(it.isFunction(s))return s.call(this,u,a);if(it.isRegExp(s))return s.exec(u);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,s){if(n=lu(n),n){const a=it.findKey(this,n);return!!(a&&this[a]!==void 0&&(!s||_g(this,this[a],a,s)))}return!1}delete(n,s){const a=this;let u=!1;function d(_){if(_=lu(_),_){const v=it.findKey(a,_);v&&(!s||_g(a,a[v],v,s))&&(delete a[v],u=!0)}}return it.isArray(n)?n.forEach(d):d(n),u}clear(n){const s=Object.keys(this);let a=s.length,u=!1;for(;a--;){const d=s[a];(!n||_g(this,this[d],d,n,!0))&&(delete this[d],u=!0)}return u}normalize(n){const s=this,a={};return it.forEach(this,(u,d)=>{const _=it.findKey(a,d);if(_){s[_]=Td(u),delete s[d];return}const v=n?SI(d):String(d).trim();v!==d&&delete s[d],s[v]=Td(u),a[v]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const s=Object.create(null);return it.forEach(this,(a,u)=>{a!=null&&a!==!1&&(s[u]=n&&it.isArray(a)?a.join(", "):a)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,s])=>n+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...s){const a=new this(n);return s.forEach(u=>a.set(u)),a}static accessor(n){const a=(this[K0]=this[K0]={accessors:{}}).accessors,u=this.prototype;function d(_){const v=lu(_);a[v]||(AI(u,_),a[v]=!0)}return it.isArray(n)?n.forEach(d):d(n),this}}mn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);it.reduceDescriptors(mn.prototype,({value:e},n)=>{let s=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(a){this[s]=a}}});it.freezeMethods(mn);function mg(e,n){const s=this||Qu,a=n||s,u=mn.from(a.headers);let d=a.data;return it.forEach(e,function(v){d=v.call(s,d,u.normalize(),n?n.status:void 0)}),u.normalize(),d}function c1(e){return!!(e&&e.__CANCEL__)}function Zl(e,n,s){Ht.call(this,e??"canceled",Ht.ERR_CANCELED,n,s),this.name="CanceledError"}it.inherits(Zl,Ht,{__CANCEL__:!0});function d1(e,n,s){const a=s.config.validateStatus;!s.status||!a||a(s.status)?e(s):n(new Ht("Request failed with status code "+s.status,[Ht.ERR_BAD_REQUEST,Ht.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function EI(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function TI(e,n){e=e||10;const s=new Array(e),a=new Array(e);let u=0,d=0,_;return n=n!==void 0?n:1e3,function(x){const b=Date.now(),E=a[d];_||(_=b),s[u]=x,a[u]=b;let R=d,L=0;for(;R!==u;)L+=s[R++],R=R%e;if(u=(u+1)%e,u===d&&(d=(d+1)%e),b-_<n)return;const U=E&&b-E;return U?Math.round(L*1e3/U):void 0}}function PI(e,n){let s=0,a=1e3/n,u,d;const _=(b,E=Date.now())=>{s=E,u=null,d&&(clearTimeout(d),d=null),e.apply(null,b)};return[(...b)=>{const E=Date.now(),R=E-s;R>=a?_(b,E):(u=b,d||(d=setTimeout(()=>{d=null,_(u)},a-R)))},()=>u&&_(u)]}const Jd=(e,n,s=3)=>{let a=0;const u=TI(50,250);return PI(d=>{const _=d.loaded,v=d.lengthComputable?d.total:void 0,x=_-a,b=u(x),E=_<=v;a=_;const R={loaded:_,total:v,progress:v?_/v:void 0,bytes:x,rate:b||void 0,estimated:b&&v&&E?(v-_)/b:void 0,event:d,lengthComputable:v!=null,[n?"download":"upload"]:!0};e(R)},s)},J0=(e,n)=>{const s=e!=null;return[a=>n[0]({lengthComputable:s,total:e,loaded:a}),n[1]]},ty=e=>(...n)=>it.asap(()=>e(...n)),RI=Ln.hasStandardBrowserEnv?function(){const n=Ln.navigator&&/(msie|trident)/i.test(Ln.navigator.userAgent),s=document.createElement("a");let a;function u(d){let _=d;return n&&(s.setAttribute("href",_),_=s.href),s.setAttribute("href",_),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return a=u(window.location.href),function(_){const v=it.isString(_)?u(_):_;return v.protocol===a.protocol&&v.host===a.host}}():function(){return function(){return!0}}(),II=Ln.hasStandardBrowserEnv?{write(e,n,s,a,u,d){const _=[e+"="+encodeURIComponent(n)];it.isNumber(s)&&_.push("expires="+new Date(s).toGMTString()),it.isString(a)&&_.push("path="+a),it.isString(u)&&_.push("domain="+u),d===!0&&_.push("secure"),document.cookie=_.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function DI(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function FI(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function f1(e,n){return e&&!DI(n)?FI(e,n):n}const ey=e=>e instanceof mn?{...e}:e;function ya(e,n){n=n||{};const s={};function a(b,E,R){return it.isPlainObject(b)&&it.isPlainObject(E)?it.merge.call({caseless:R},b,E):it.isPlainObject(E)?it.merge({},E):it.isArray(E)?E.slice():E}function u(b,E,R){if(it.isUndefined(E)){if(!it.isUndefined(b))return a(void 0,b,R)}else return a(b,E,R)}function d(b,E){if(!it.isUndefined(E))return a(void 0,E)}function _(b,E){if(it.isUndefined(E)){if(!it.isUndefined(b))return a(void 0,b)}else return a(void 0,E)}function v(b,E,R){if(R in n)return a(b,E);if(R in e)return a(void 0,b)}const x={url:d,method:d,data:d,baseURL:_,transformRequest:_,transformResponse:_,paramsSerializer:_,timeout:_,timeoutMessage:_,withCredentials:_,withXSRFToken:_,adapter:_,responseType:_,xsrfCookieName:_,xsrfHeaderName:_,onUploadProgress:_,onDownloadProgress:_,decompress:_,maxContentLength:_,maxBodyLength:_,beforeRedirect:_,transport:_,httpAgent:_,httpsAgent:_,cancelToken:_,socketPath:_,responseEncoding:_,validateStatus:v,headers:(b,E)=>u(ey(b),ey(E),!0)};return it.forEach(Object.keys(Object.assign({},e,n)),function(E){const R=x[E]||u,L=R(e[E],n[E],E);it.isUndefined(L)&&R!==v||(s[E]=L)}),s}const p1=e=>{const n=ya({},e);let{data:s,withXSRFToken:a,xsrfHeaderName:u,xsrfCookieName:d,headers:_,auth:v}=n;n.headers=_=mn.from(_),n.url=l1(f1(n.baseURL,n.url),e.params,e.paramsSerializer),v&&_.set("Authorization","Basic "+btoa((v.username||"")+":"+(v.password?unescape(encodeURIComponent(v.password)):"")));let x;if(it.isFormData(s)){if(Ln.hasStandardBrowserEnv||Ln.hasStandardBrowserWebWorkerEnv)_.setContentType(void 0);else if((x=_.getContentType())!==!1){const[b,...E]=x?x.split(";").map(R=>R.trim()).filter(Boolean):[];_.setContentType([b||"multipart/form-data",...E].join("; "))}}if(Ln.hasStandardBrowserEnv&&(a&&it.isFunction(a)&&(a=a(n)),a||a!==!1&&RI(n.url))){const b=u&&d&&II.read(d);b&&_.set(u,b)}return n},BI=typeof XMLHttpRequest<"u",kI=BI&&function(e){return new Promise(function(s,a){const u=p1(e);let d=u.data;const _=mn.from(u.headers).normalize();let{responseType:v,onUploadProgress:x,onDownloadProgress:b}=u,E,R,L,U,H;function $(){U&&U(),H&&H(),u.cancelToken&&u.cancelToken.unsubscribe(E),u.signal&&u.signal.removeEventListener("abort",E)}let G=new XMLHttpRequest;G.open(u.method.toUpperCase(),u.url,!0),G.timeout=u.timeout;function k(){if(!G)return;const N=mn.from("getAllResponseHeaders"in G&&G.getAllResponseHeaders()),K={data:!v||v==="text"||v==="json"?G.responseText:G.response,status:G.status,statusText:G.statusText,headers:N,config:e,request:G};d1(function(D){s(D),$()},function(D){a(D),$()},K),G=null}"onloadend"in G?G.onloadend=k:G.onreadystatechange=function(){!G||G.readyState!==4||G.status===0&&!(G.responseURL&&G.responseURL.indexOf("file:")===0)||setTimeout(k)},G.onabort=function(){G&&(a(new Ht("Request aborted",Ht.ECONNABORTED,e,G)),G=null)},G.onerror=function(){a(new Ht("Network Error",Ht.ERR_NETWORK,e,G)),G=null},G.ontimeout=function(){let J=u.timeout?"timeout of "+u.timeout+"ms exceeded":"timeout exceeded";const K=u.transitional||h1;u.timeoutErrorMessage&&(J=u.timeoutErrorMessage),a(new Ht(J,K.clarifyTimeoutError?Ht.ETIMEDOUT:Ht.ECONNABORTED,e,G)),G=null},d===void 0&&_.setContentType(null),"setRequestHeader"in G&&it.forEach(_.toJSON(),function(J,K){G.setRequestHeader(K,J)}),it.isUndefined(u.withCredentials)||(G.withCredentials=!!u.withCredentials),v&&v!=="json"&&(G.responseType=u.responseType),b&&([L,H]=Jd(b,!0),G.addEventListener("progress",L)),x&&G.upload&&([R,U]=Jd(x),G.upload.addEventListener("progress",R),G.upload.addEventListener("loadend",U)),(u.cancelToken||u.signal)&&(E=N=>{G&&(a(!N||N.type?new Zl(null,e,G):N),G.abort(),G=null)},u.cancelToken&&u.cancelToken.subscribe(E),u.signal&&(u.signal.aborted?E():u.signal.addEventListener("abort",E)));const B=EI(u.url);if(B&&Ln.protocols.indexOf(B)===-1){a(new Ht("Unsupported protocol "+B+":",Ht.ERR_BAD_REQUEST,e));return}G.send(d||null)})},LI=(e,n)=>{let s=new AbortController,a;const u=function(x){if(!a){a=!0,_();const b=x instanceof Error?x:this.reason;s.abort(b instanceof Ht?b:new Zl(b instanceof Error?b.message:b))}};let d=n&&setTimeout(()=>{u(new Ht(`timeout ${n} of ms exceeded`,Ht.ETIMEDOUT))},n);const _=()=>{e&&(d&&clearTimeout(d),d=null,e.forEach(x=>{x&&(x.removeEventListener?x.removeEventListener("abort",u):x.unsubscribe(u))}),e=null)};e.forEach(x=>x&&x.addEventListener&&x.addEventListener("abort",u));const{signal:v}=s;return v.unsubscribe=_,[v,()=>{d&&clearTimeout(d),d=null}]},MI=function*(e,n){let s=e.byteLength;if(s<n){yield e;return}let a=0,u;for(;a<s;)u=a+n,yield e.slice(a,u),a=u},OI=async function*(e,n,s){for await(const a of e)yield*MI(ArrayBuffer.isView(a)?a:await s(String(a)),n)},iy=(e,n,s,a,u)=>{const d=OI(e,n,u);let _=0,v,x=b=>{v||(v=!0,a&&a(b))};return new ReadableStream({async pull(b){try{const{done:E,value:R}=await d.next();if(E){x(),b.close();return}let L=R.byteLength;if(s){let U=_+=L;s(U)}b.enqueue(new Uint8Array(R))}catch(E){throw x(E),E}},cancel(b){return x(b),d.return()}},{highWaterMark:2})},Ef=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",g1=Ef&&typeof ReadableStream=="function",y_=Ef&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),_1=(e,...n)=>{try{return!!e(...n)}catch{return!1}},NI=g1&&_1(()=>{let e=!1;const n=new Request(Ln.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),ny=64*1024,w_=g1&&_1(()=>it.isReadableStream(new Response("").body)),tf={stream:w_&&(e=>e.body)};Ef&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!tf[n]&&(tf[n]=it.isFunction(e[n])?s=>s[n]():(s,a)=>{throw new Ht(`Response type '${n}' is not supported`,Ht.ERR_NOT_SUPPORT,a)})})})(new Response);const UI=async e=>{if(e==null)return 0;if(it.isBlob(e))return e.size;if(it.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(it.isArrayBufferView(e)||it.isArrayBuffer(e))return e.byteLength;if(it.isURLSearchParams(e)&&(e=e+""),it.isString(e))return(await y_(e)).byteLength},zI=async(e,n)=>{const s=it.toFiniteNumber(e.getContentLength());return s??UI(n)},HI=Ef&&(async e=>{let{url:n,method:s,data:a,signal:u,cancelToken:d,timeout:_,onDownloadProgress:v,onUploadProgress:x,responseType:b,headers:E,withCredentials:R="same-origin",fetchOptions:L}=p1(e);b=b?(b+"").toLowerCase():"text";let[U,H]=u||d||_?LI([u,d],_):[],$,G;const k=()=>{!$&&setTimeout(()=>{U&&U.unsubscribe()}),$=!0};let B;try{if(x&&NI&&s!=="get"&&s!=="head"&&(B=await zI(E,a))!==0){let D=new Request(n,{method:"POST",body:a,duplex:"half"}),j;if(it.isFormData(a)&&(j=D.headers.get("content-type"))&&E.setContentType(j),D.body){const[nt,bt]=J0(B,Jd(ty(x)));a=iy(D.body,ny,nt,bt,y_)}}it.isString(R)||(R=R?"include":"omit");const N="credentials"in Request.prototype;G=new Request(n,{...L,signal:U,method:s.toUpperCase(),headers:E.normalize().toJSON(),body:a,duplex:"half",credentials:N?R:void 0});let J=await fetch(G);const K=w_&&(b==="stream"||b==="response");if(w_&&(v||K)){const D={};["status","statusText","headers"].forEach(Et=>{D[Et]=J[Et]});const j=it.toFiniteNumber(J.headers.get("content-length")),[nt,bt]=v&&J0(j,Jd(ty(v),!0))||[];J=new Response(iy(J.body,ny,nt,()=>{bt&&bt(),K&&k()},y_),D)}b=b||"text";let ft=await tf[it.findKey(tf,b)||"text"](J,e);return!K&&k(),H&&H(),await new Promise((D,j)=>{d1(D,j,{data:ft,headers:mn.from(J.headers),status:J.status,statusText:J.statusText,config:e,request:G})})}catch(N){throw k(),N&&N.name==="TypeError"&&/fetch/i.test(N.message)?Object.assign(new Ht("Network Error",Ht.ERR_NETWORK,e,G),{cause:N.cause||N}):Ht.from(N,N&&N.code,e,G)}}),x_={http:sI,xhr:kI,fetch:HI};it.forEach(x_,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const sy=e=>`- ${e}`,WI=e=>it.isFunction(e)||e===null||e===!1,m1={getAdapter:e=>{e=it.isArray(e)?e:[e];const{length:n}=e;let s,a;const u={};for(let d=0;d<n;d++){s=e[d];let _;if(a=s,!WI(s)&&(a=x_[(_=String(s)).toLowerCase()],a===void 0))throw new Ht(`Unknown adapter '${_}'`);if(a)break;u[_||"#"+d]=a}if(!a){const d=Object.entries(u).map(([v,x])=>`adapter ${v} `+(x===!1?"is not supported by the environment":"is not available in the build"));let _=n?d.length>1?`since :
`+d.map(sy).join(`
`):" "+sy(d[0]):"as no adapter specified";throw new Ht("There is no suitable adapter to dispatch the request "+_,"ERR_NOT_SUPPORT")}return a},adapters:x_};function vg(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Zl(null,e)}function ry(e){return vg(e),e.headers=mn.from(e.headers),e.data=mg.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),m1.getAdapter(e.adapter||Qu.adapter)(e).then(function(a){return vg(e),a.data=mg.call(e,e.transformResponse,a),a.headers=mn.from(a.headers),a},function(a){return c1(a)||(vg(e),a&&a.response&&(a.response.data=mg.call(e,e.transformResponse,a.response),a.response.headers=mn.from(a.response.headers))),Promise.reject(a)})}const v1="1.7.5",Em={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Em[e]=function(a){return typeof a===e||"a"+(n<1?"n ":" ")+e}});const oy={};Em.transitional=function(n,s,a){function u(d,_){return"[Axios v"+v1+"] Transitional option '"+d+"'"+_+(a?". "+a:"")}return(d,_,v)=>{if(n===!1)throw new Ht(u(_," has been removed"+(s?" in "+s:"")),Ht.ERR_DEPRECATED);return s&&!oy[_]&&(oy[_]=!0,console.warn(u(_," has been deprecated since v"+s+" and will be removed in the near future"))),n?n(d,_,v):!0}};function jI(e,n,s){if(typeof e!="object")throw new Ht("options must be an object",Ht.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let u=a.length;for(;u-- >0;){const d=a[u],_=n[d];if(_){const v=e[d],x=v===void 0||_(v,d,e);if(x!==!0)throw new Ht("option "+d+" must be "+x,Ht.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new Ht("Unknown option "+d,Ht.ERR_BAD_OPTION)}}const b_={assertOptions:jI,validators:Em},Kr=b_.validators;class da{constructor(n){this.defaults=n,this.interceptors={request:new Z0,response:new Z0}}async request(n,s){try{return await this._request(n,s)}catch(a){if(a instanceof Error){let u;Error.captureStackTrace?Error.captureStackTrace(u={}):u=new Error;const d=u.stack?u.stack.replace(/^.+\n/,""):"";try{a.stack?d&&!String(a.stack).endsWith(d.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+d):a.stack=d}catch{}}throw a}}_request(n,s){typeof n=="string"?(s=s||{},s.url=n):s=n||{},s=ya(this.defaults,s);const{transitional:a,paramsSerializer:u,headers:d}=s;a!==void 0&&b_.assertOptions(a,{silentJSONParsing:Kr.transitional(Kr.boolean),forcedJSONParsing:Kr.transitional(Kr.boolean),clarifyTimeoutError:Kr.transitional(Kr.boolean)},!1),u!=null&&(it.isFunction(u)?s.paramsSerializer={serialize:u}:b_.assertOptions(u,{encode:Kr.function,serialize:Kr.function},!0)),s.method=(s.method||this.defaults.method||"get").toLowerCase();let _=d&&it.merge(d.common,d[s.method]);d&&it.forEach(["delete","get","head","post","put","patch","common"],H=>{delete d[H]}),s.headers=mn.concat(_,d);const v=[];let x=!0;this.interceptors.request.forEach(function($){typeof $.runWhen=="function"&&$.runWhen(s)===!1||(x=x&&$.synchronous,v.unshift($.fulfilled,$.rejected))});const b=[];this.interceptors.response.forEach(function($){b.push($.fulfilled,$.rejected)});let E,R=0,L;if(!x){const H=[ry.bind(this),void 0];for(H.unshift.apply(H,v),H.push.apply(H,b),L=H.length,E=Promise.resolve(s);R<L;)E=E.then(H[R++],H[R++]);return E}L=v.length;let U=s;for(R=0;R<L;){const H=v[R++],$=v[R++];try{U=H(U)}catch(G){$.call(this,G);break}}try{E=ry.call(this,U)}catch(H){return Promise.reject(H)}for(R=0,L=b.length;R<L;)E=E.then(b[R++],b[R++]);return E}getUri(n){n=ya(this.defaults,n);const s=f1(n.baseURL,n.url);return l1(s,n.params,n.paramsSerializer)}}it.forEach(["delete","get","head","options"],function(n){da.prototype[n]=function(s,a){return this.request(ya(a||{},{method:n,url:s,data:(a||{}).data}))}});it.forEach(["post","put","patch"],function(n){function s(a){return function(d,_,v){return this.request(ya(v||{},{method:n,headers:a?{"Content-Type":"multipart/form-data"}:{},url:d,data:_}))}}da.prototype[n]=s(),da.prototype[n+"Form"]=s(!0)});class Tm{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(d){s=d});const a=this;this.promise.then(u=>{if(!a._listeners)return;let d=a._listeners.length;for(;d-- >0;)a._listeners[d](u);a._listeners=null}),this.promise.then=u=>{let d;const _=new Promise(v=>{a.subscribe(v),d=v}).then(u);return _.cancel=function(){a.unsubscribe(d)},_},n(function(d,_,v){a.reason||(a.reason=new Zl(d,_,v),s(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const s=this._listeners.indexOf(n);s!==-1&&this._listeners.splice(s,1)}static source(){let n;return{token:new Tm(function(u){n=u}),cancel:n}}}function GI(e){return function(s){return e.apply(null,s)}}function VI(e){return it.isObject(e)&&e.isAxiosError===!0}const C_={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(C_).forEach(([e,n])=>{C_[n]=e});function y1(e){const n=new da(e),s=qx(da.prototype.request,n);return it.extend(s,da.prototype,n,{allOwnKeys:!0}),it.extend(s,n,null,{allOwnKeys:!0}),s.create=function(u){return y1(ya(e,u))},s}const ze=y1(Qu);ze.Axios=da;ze.CanceledError=Zl;ze.CancelToken=Tm;ze.isCancel=c1;ze.VERSION=v1;ze.toFormData=Af;ze.AxiosError=Ht;ze.Cancel=ze.CanceledError;ze.all=function(n){return Promise.all(n)};ze.spread=GI;ze.isAxiosError=VI;ze.mergeConfig=ya;ze.AxiosHeaders=mn;ze.formToJSON=e=>u1(it.isHTMLForm(e)?new FormData(e):e);ze.getAdapter=m1.getAdapter;ze.HttpStatusCode=C_;ze.default=ze;const w1=lt.createContext(void 0),zu=()=>{const e=lt.useContext(w1);if(!e)throw new Error("useSession must be used within a SessionProvider");return e},XI=({children:e})=>{const[n,s]=lt.useState({playFabId:null,userData:{},gameData:{}}),a=v=>{s(x=>({...x,playFabId:v}))},u=(v,x,b)=>{s(E=>{const R=typeof v=="object"?{...v}:{[v]:x},L={playFabId:E.playFabId,data:R};return(b??!0)&&_(L),{...E,userData:{...E.userData,...R}}})},d=(v,x)=>{s(b=>{const E=typeof v=="object"?{...v}:{[v]:x};return{...b,gameData:{...b.gameData,...E}}})},_=async v=>{try{const b=await ze.put("https://molesmash-cqcqevedheceb6bd.southeastasia-01.azurewebsites.net"+"/playFab/update/userData",v);console.log("Payload:",v),console.log("Data successfully sent to server:",b.data)}catch(x){console.error("Error sending data to the server:",x)}};return ct.jsx(w1.Provider,{value:{sessionData:n,setPlayFabId:a,setData:u,setGameData:d},children:e})};function $I({coins:e}){const{sessionData:n}=zu(),[s,a]=lt.useState(0),u=n.gameData.levelNames||[],d=n.gameData.levelThresholds||[],_=()=>{if(s>=u.length-1)return 100;const v=d[s],x=d[s+1],b=(e-v)/(x-v)*100;return Math.min(b,100)};return lt.useEffect(()=>{const v=d[s+1];e>=v&&s<u.length-1&&a(s+1)},[e,s,d,u.length]),ct.jsxs("section",{className:"mt-1 flex flex-col justify-between",children:[ct.jsxs("div",{className:"level",children:[u[s]," ",s," / ",d.length]}),ct.jsx(Yx,{now:_(),className:"progress-gradient h-2"})]})}var x1={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ay=Cr.createContext&&Cr.createContext(x1),YI=["attr","size","title"];function QI(e,n){if(e==null)return{};var s=qI(e,n),a,u;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(u=0;u<d.length;u++)a=d[u],!(n.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function qI(e,n){if(e==null)return{};var s={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(n.indexOf(a)>=0)continue;s[a]=e[a]}return s}function ef(){return ef=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},ef.apply(this,arguments)}function ly(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),s.push.apply(s,a)}return s}function nf(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?ly(Object(s),!0).forEach(function(a){ZI(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ly(Object(s)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function ZI(e,n,s){return n=KI(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function KI(e){var n=JI(e,"string");return typeof n=="symbol"?n:n+""}function JI(e,n){if(typeof e!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var a=s.call(e,n||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function b1(e){return e&&e.map((n,s)=>Cr.createElement(n.tag,nf({key:s},n.attr),b1(n.child)))}function C1(e){return n=>Cr.createElement(tD,ef({attr:nf({},e.attr)},n),b1(e.child))}function tD(e){var n=s=>{var{attr:a,size:u,title:d}=e,_=QI(e,YI),v=u||s.size||"1em",x;return s.className&&(x=s.className),e.className&&(x=(x?x+" ":"")+e.className),Cr.createElement("svg",ef({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,a,_,{className:x,style:nf(nf({color:e.color||s.color},s.style),e.style),height:v,width:v,xmlns:"http://www.w3.org/2000/svg"}),d&&Cr.createElement("title",null,d),e.children)};return ay!==void 0?Cr.createElement(ay.Consumer,null,s=>n(s)):n(x1)}function hy(e){return C1({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"},child:[]}]})(e)}function eD(e){return C1({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9 11.24V7.5a2.5 2.5 0 0 1 5 0v3.74c1.21-.81 2-2.18 2-3.74C16 5.01 13.99 3 11.5 3S7 5.01 7 7.5c0 1.56.79 2.93 2 3.74zm9.84 4.63-4.54-2.26c-.17-.07-.35-.11-.54-.11H13v-6c0-.83-.67-1.5-1.5-1.5S10 6.67 10 7.5v10.74c-3.6-.76-3.54-.75-3.67-.75-.31 0-.59.13-.79.33l-.79.8 4.94 4.94c.27.27.65.44 1.06.44h6.79c.75 0 1.33-.55 1.44-1.28l.75-5.27c.01-.07.02-.14.02-.2 0-.62-.38-1.16-.91-1.38z"},child:[]}]})(e)}var sf={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */sf.exports;(function(e,n){(function(){var s,a="4.17.21",u=200,d="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",_="Expected a function",v="Invalid `variable` option passed into `_.template`",x="__lodash_hash_undefined__",b=500,E="__lodash_placeholder__",R=1,L=2,U=4,H=1,$=2,G=1,k=2,B=4,N=8,J=16,K=32,ft=64,D=128,j=256,nt=512,bt=30,Et="...",gt=800,Pe=16,Le=1,Xt=2,mt=3,Ke=1/0,vt=9007199254740991,Tt=17976931348623157e292,Ft=NaN,Yt=4294967295,pe=Yt-1,is=Yt>>>1,Vi=[["ary",D],["bind",G],["bindKey",k],["curry",N],["curryRight",J],["flip",nt],["partial",K],["partialRight",ft],["rearg",j]],ge="[object Arguments]",Zt="[object Array]",Is="[object AsyncFunction]",ns="[object Boolean]",Ds="[object Date]",$t="[object DOMException]",ie="[object Error]",Je="[object Function]",ss="[object GeneratorFunction]",Oi="[object Map]",oe="[object Number]",Js="[object Null]",ae="[object Object]",wo="[object Promise]",Ce="[object Proxy]",vn="[object RegExp]",ne="[object Set]",ve="[object String]",rs="[object Symbol]",Ca="[object Undefined]",yn="[object WeakMap]",If="[object WeakSet]",tr="[object ArrayBuffer]",Ir="[object DataView]",Dr="[object Float32Array]",th="[object Float64Array]",eh="[object Int8Array]",xo="[object Int16Array]",Sa="[object Int32Array]",Aa="[object Uint8Array]",Ea="[object Uint8ClampedArray]",Ta="[object Uint16Array]",bi="[object Uint32Array]",os=/\b__p \+= '';/g,as=/\b(__p \+=) '' \+/g,ye=/(__e\(.*?\)|\b__t\)) \+\n'';/g,qu=/&(?:amp|lt|gt|quot|#39);/g,Zu=/[&<>"']/g,Df=RegExp(qu.source),Ff=RegExp(Zu.source),Bf=/<%-([\s\S]+?)%>/g,kf=/<%([\s\S]+?)%>/g,Ku=/<%=([\s\S]+?)%>/g,bo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Lf=/^\w*$/,Mf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ih=/[\\^$.*+?()[\]{}|]/g,Of=RegExp(ih.source),nh=/^\s+/,Nf=/\s/,Uf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,zf=/\{\n\/\* \[wrapped with (.+)\] \*/,Hf=/,? & /,Ju=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Wf=/[()=,{}\[\]\/\s]/,jf=/\\(\\)?/g,tc=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,sh=/\w*$/,Wt=/^[-+]0x[0-9a-f]+$/i,Gf=/^0b[01]+$/i,ls=/^\[object .+?Constructor\]$/,Se=/^0o[0-7]+$/i,Vf=/^(?:0|[1-9]\d*)$/,Pa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ae=/($^)/,rh=/['\n\r\u2028\u2029\\]/g,Ra="\\ud800-\\udfff",oh="\\u0300-\\u036f",Fr="\\ufe20-\\ufe2f",Xf="\\u20d0-\\u20ff",Fs=oh+Fr+Xf,er="\\u2700-\\u27bf",Co="a-z\\xdf-\\xf6\\xf8-\\xff",ah="\\xac\\xb1\\xd7\\xf7",Ia="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ec="\\u2000-\\u206f",Da=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ut="A-Z\\xc0-\\xd6\\xd8-\\xde",So="\\ufe0e\\ufe0f",Fa=ah+Ia+ec+Da,Ao="[']",lh="["+Ra+"]",Ba="["+Fa+"]",hs="["+Fs+"]",ir="\\d+",hh="["+er+"]",ka="["+Co+"]",La="[^"+Ra+Fa+ir+er+Co+Ut+"]",Eo="\\ud83c[\\udffb-\\udfff]",Bs="(?:"+hs+"|"+Eo+")",us="[^"+Ra+"]",To="(?:\\ud83c[\\udde6-\\uddff]){2}",Po="[\\ud800-\\udbff][\\udc00-\\udfff]",ks="["+Ut+"]",Ma="\\u200d",Oa="(?:"+ka+"|"+La+")",uh="(?:"+ks+"|"+La+")",Na="(?:"+Ao+"(?:d|ll|m|re|s|t|ve))?",Ua="(?:"+Ao+"(?:D|LL|M|RE|S|T|VE))?",Ls=Bs+"?",Ms="["+So+"]?",za="(?:"+Ma+"(?:"+[us,To,Po].join("|")+")"+Ms+Ls+")*",Ha="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Wa="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ro=Ms+Ls+za,Io="(?:"+[hh,To,Po].join("|")+")"+Ro,Do="(?:"+[us+hs+"?",hs,To,Po,lh].join("|")+")",Br=RegExp(Ao,"g"),ch=RegExp(hs,"g"),Fo=RegExp(Eo+"(?="+Eo+")|"+Do+Ro,"g"),dh=RegExp([ks+"?"+ka+"+"+Na+"(?="+[Ba,ks,"$"].join("|")+")",uh+"+"+Ua+"(?="+[Ba,ks+Oa,"$"].join("|")+")",ks+"?"+Oa+"+"+Na,ks+"+"+Ua,Wa,Ha,ir,Io].join("|"),"g"),fh=RegExp("["+Ma+Ra+Fs+So+"]"),ph=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,gh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],_h=-1,ce={};ce[Dr]=ce[th]=ce[eh]=ce[xo]=ce[Sa]=ce[Aa]=ce[Ea]=ce[Ta]=ce[bi]=!0,ce[ge]=ce[Zt]=ce[tr]=ce[ns]=ce[Ir]=ce[Ds]=ce[ie]=ce[Je]=ce[Oi]=ce[oe]=ce[ae]=ce[vn]=ce[ne]=ce[ve]=ce[yn]=!1;var le={};le[ge]=le[Zt]=le[tr]=le[Ir]=le[ns]=le[Ds]=le[Dr]=le[th]=le[eh]=le[xo]=le[Sa]=le[Oi]=le[oe]=le[ae]=le[vn]=le[ne]=le[ve]=le[rs]=le[Aa]=le[Ea]=le[Ta]=le[bi]=!0,le[ie]=le[Je]=le[yn]=!1;var nr={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},ic={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$f={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Yf={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},nc=parseFloat,Qf=parseInt,ja=typeof Kh=="object"&&Kh&&Kh.Object===Object&&Kh,Bo=typeof self=="object"&&self&&self.Object===Object&&self,He=ja||Bo||Function("return this")(),mh=n&&!n.nodeType&&n,sr=mh&&!0&&e&&!e.nodeType&&e,Ga=sr&&sr.exports===mh,vh=Ga&&ja.process,nn=function(){try{var V=sr&&sr.require&&sr.require("util").types;return V||vh&&vh.binding&&vh.binding("util")}catch{}}(),sc=nn&&nn.isArrayBuffer,Os=nn&&nn.isDate,yh=nn&&nn.isMap,wh=nn&&nn.isRegExp,Mt=nn&&nn.isSet,Me=nn&&nn.isTypedArray;function Ci(V,rt,tt){switch(tt.length){case 0:return V.call(rt);case 1:return V.call(rt,tt[0]);case 2:return V.call(rt,tt[0],tt[1]);case 3:return V.call(rt,tt[0],tt[1],tt[2])}return V.apply(rt,tt)}function Va(V,rt,tt,xt){for(var Ot=-1,Jt=V==null?0:V.length;++Ot<Jt;){var te=V[Ot];rt(xt,te,tt(te),V)}return xt}function Ye(V,rt){for(var tt=-1,xt=V==null?0:V.length;++tt<xt&&rt(V[tt],tt,V)!==!1;);return V}function rc(V,rt){for(var tt=V==null?0:V.length;tt--&&rt(V[tt],tt,V)!==!1;);return V}function oc(V,rt){for(var tt=-1,xt=V==null?0:V.length;++tt<xt;)if(!rt(V[tt],tt,V))return!1;return!0}function Qe(V,rt){for(var tt=-1,xt=V==null?0:V.length,Ot=0,Jt=[];++tt<xt;){var te=V[tt];rt(te,tt,V)&&(Jt[Ot++]=te)}return Jt}function We(V,rt){var tt=V==null?0:V.length;return!!tt&&$i(V,rt,0)>-1}function yt(V,rt,tt){for(var xt=-1,Ot=V==null?0:V.length;++xt<Ot;)if(tt(rt,V[xt]))return!0;return!1}function Bt(V,rt){for(var tt=-1,xt=V==null?0:V.length,Ot=Array(xt);++tt<xt;)Ot[tt]=rt(V[tt],tt,V);return Ot}function ti(V,rt){for(var tt=-1,xt=rt.length,Ot=V.length;++tt<xt;)V[Ot+tt]=rt[tt];return V}function cs(V,rt,tt,xt){var Ot=-1,Jt=V==null?0:V.length;for(xt&&Jt&&(tt=V[++Ot]);++Ot<Jt;)tt=rt(tt,V[Ot],Ot,V);return tt}function Xi(V,rt,tt,xt){var Ot=V==null?0:V.length;for(xt&&Ot&&(tt=V[--Ot]);Ot--;)tt=rt(tt,V[Ot],Ot,V);return tt}function rr(V,rt){for(var tt=-1,xt=V==null?0:V.length;++tt<xt;)if(rt(V[tt],tt,V))return!0;return!1}var xh=fs("length");function bh(V){return V.split("")}function ds(V){return V.match(Ju)||[]}function ko(V,rt,tt){var xt;return tt(V,function(Ot,Jt,te){if(rt(Ot,Jt,te))return xt=Jt,!1}),xt}function wn(V,rt,tt,xt){for(var Ot=V.length,Jt=tt+(xt?1:-1);xt?Jt--:++Jt<Ot;)if(rt(V[Jt],Jt,V))return Jt;return-1}function $i(V,rt,tt){return rt===rt?ni(V,rt,tt):wn(V,Lo,tt)}function Xa(V,rt,tt,xt){for(var Ot=tt-1,Jt=V.length;++Ot<Jt;)if(xt(V[Ot],rt))return Ot;return-1}function Lo(V){return V!==V}function kt(V,rt){var tt=V==null?0:V.length;return tt?sn(V,rt)/tt:Ft}function fs(V){return function(rt){return rt==null?s:rt[V]}}function $a(V){return function(rt){return V==null?s:V[rt]}}function Ch(V,rt,tt,xt,Ot){return Ot(V,function(Jt,te,he){tt=xt?(xt=!1,Jt):rt(tt,Jt,te,he)}),tt}function ac(V,rt){var tt=V.length;for(V.sort(rt);tt--;)V[tt]=V[tt].value;return V}function sn(V,rt){for(var tt,xt=-1,Ot=V.length;++xt<Ot;){var Jt=rt(V[xt]);Jt!==s&&(tt=tt===s?Jt:tt+Jt)}return tt}function Mo(V,rt){for(var tt=-1,xt=Array(V);++tt<V;)xt[tt]=rt(tt);return xt}function ei(V,rt){return Bt(rt,function(tt){return[tt,V[tt]]})}function pi(V){return V&&V.slice(0,Cn(V)+1).replace(nh,"")}function gi(V){return function(rt){return V(rt)}}function rn(V,rt){return Bt(rt,function(tt){return V[tt]})}function Re(V,rt){return V.has(rt)}function Ns(V,rt){for(var tt=-1,xt=V.length;++tt<xt&&$i(rt,V[tt],0)>-1;);return tt}function Ya(V,rt){for(var tt=V.length;tt--&&$i(rt,V[tt],0)>-1;);return tt}function xn(V,rt){for(var tt=V.length,xt=0;tt--;)V[tt]===rt&&++xt;return xt}var Ni=$a(nr),je=$a(ic);function qe(V){return"\\"+Yf[V]}function ii(V,rt){return V==null?s:V[rt]}function de(V){return fh.test(V)}function Si(V){return ph.test(V)}function Lt(V){for(var rt,tt=[];!(rt=V.next()).done;)tt.push(rt.value);return tt}function Sh(V){var rt=-1,tt=Array(V.size);return V.forEach(function(xt,Ot){tt[++rt]=[Ot,xt]}),tt}function lc(V,rt){return function(tt){return V(rt(tt))}}function Us(V,rt){for(var tt=-1,xt=V.length,Ot=0,Jt=[];++tt<xt;){var te=V[tt];(te===rt||te===E)&&(V[tt]=E,Jt[Ot++]=tt)}return Jt}function Qa(V){var rt=-1,tt=Array(V.size);return V.forEach(function(xt){tt[++rt]=xt}),tt}function qf(V){var rt=-1,tt=Array(V.size);return V.forEach(function(xt){tt[++rt]=[xt,xt]}),tt}function ni(V,rt,tt){for(var xt=tt-1,Ot=V.length;++xt<Ot;)if(V[xt]===rt)return xt;return-1}function Oo(V,rt,tt){for(var xt=tt+1;xt--;)if(V[xt]===rt)return xt;return xt}function _i(V){return de(V)?Ah(V):xh(V)}function bn(V){return de(V)?Ge(V):bh(V)}function Cn(V){for(var rt=V.length;rt--&&Nf.test(V.charAt(rt)););return rt}var kr=$a($f);function Ah(V){for(var rt=Fo.lastIndex=0;Fo.test(V);)++rt;return rt}function Ge(V){return V.match(Fo)||[]}function No(V){return V.match(dh)||[]}var qa=function V(rt){rt=rt==null?He:Ai.defaults(He.Object(),rt,Ai.pick(He,gh));var tt=rt.Array,xt=rt.Date,Ot=rt.Error,Jt=rt.Function,te=rt.Math,he=rt.Object,Za=rt.RegExp,hc=rt.String,Yi=rt.TypeError,Uo=tt.prototype,uc=Jt.prototype,or=he.prototype,zo=rt["__core-js_shared__"],Ho=uc.toString,se=or.hasOwnProperty,cc=0,Ka=function(){var o=/[^.]+$/.exec(zo&&zo.keys&&zo.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Lr=or.toString,Wo=Ho.call(he),Mr=He._,Ja=Za("^"+Ho.call(se).replace(ih,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ar=Ga?rt.Buffer:s,Sn=rt.Symbol,lr=rt.Uint8Array,jo=ar?ar.allocUnsafe:s,ps=lc(he.getPrototypeOf,he),re=he.create,zs=or.propertyIsEnumerable,Hs=Uo.splice,Ei=Sn?Sn.isConcatSpreadable:s,Or=Sn?Sn.iterator:s,gs=Sn?Sn.toStringTag:s,zn=function(){try{var o=ea(he,"defineProperty");return o({},"",{}),o}catch{}}(),tl=rt.clearTimeout!==He.clearTimeout&&rt.clearTimeout,el=xt&&xt.now!==He.Date.now&&xt.now,Zf=rt.setTimeout!==He.setTimeout&&rt.setTimeout,Go=te.ceil,Vo=te.floor,il=he.getOwnPropertySymbols,nl=ar?ar.isBuffer:s,Eh=rt.isFinite,dc=Uo.join,fc=lc(he.keys,he),Oe=te.max,si=te.min,Kf=xt.now,pc=rt.parseInt,gc=te.random,Jf=Uo.reverse,sl=ea(rt,"DataView"),Ui=ea(rt,"Map"),mi=ea(rt,"Promise"),ri=ea(rt,"Set"),Nr=ea(rt,"WeakMap"),_s=ea(he,"create"),Ws=Nr&&new Nr,hr={},_c=ia(sl),mc=ia(Ui),vc=ia(mi),Ti=ia(ri),yc=ia(Nr),Ur=Sn?Sn.prototype:s,zr=Ur?Ur.valueOf:s,rl=Ur?Ur.toString:s;function P(o){if(Ne(o)&&!zt(o)&&!(o instanceof jt)){if(o instanceof on)return o;if(se.call(o,"__wrapped__"))return Jm(o)}return new on(o)}var ur=function(){function o(){}return function(h){if(!De(h))return{};if(re)return re(h);o.prototype=h;var p=new o;return o.prototype=s,p}}();function ms(){}function on(o,h){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=s}P.templateSettings={escape:Bf,evaluate:kf,interpolate:Ku,variable:"",imports:{_:P}},P.prototype=ms.prototype,P.prototype.constructor=P,on.prototype=ur(ms.prototype),on.prototype.constructor=on;function jt(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Yt,this.__views__=[]}function Hr(){var o=new jt(this.__wrapped__);return o.__actions__=Bi(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Bi(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Bi(this.__views__),o}function wc(){if(this.__filtered__){var o=new jt(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function tp(){var o=this.__wrapped__.value(),h=this.__dir__,p=zt(o),y=h<0,S=p?o.length:0,F=G1(0,S,this.__views__),O=F.start,X=F.end,Y=X-O,ht=y?X:O-1,ut=this.__iteratees__,dt=ut.length,wt=0,St=si(Y,this.__takeCount__);if(!p||!y&&S==Y&&St==Y)return ot(o,this.__actions__);var It=[];t:for(;Y--&&wt<St;){ht+=h;for(var Vt=-1,Dt=o[ht];++Vt<dt;){var Qt=ut[Vt],Kt=Qt.iteratee,Rn=Qt.type,qi=Kt(Dt);if(Rn==Xt)Dt=qi;else if(!qi){if(Rn==Le)continue t;break t}}It[wt++]=Dt}return It}jt.prototype=ur(ms.prototype),jt.prototype.constructor=jt;function js(o){var h=-1,p=o==null?0:o.length;for(this.clear();++h<p;){var y=o[h];this.set(y[0],y[1])}}function xc(){this.__data__=_s?_s(null):{},this.size=0}function ol(o){var h=this.has(o)&&delete this.__data__[o];return this.size-=h?1:0,h}function bc(o){var h=this.__data__;if(_s){var p=h[o];return p===x?s:p}return se.call(h,o)?h[o]:s}function Xo(o){var h=this.__data__;return _s?h[o]!==s:se.call(h,o)}function Cc(o,h){var p=this.__data__;return this.size+=this.has(o)?0:1,p[o]=_s&&h===s?x:h,this}js.prototype.clear=xc,js.prototype.delete=ol,js.prototype.get=bc,js.prototype.has=Xo,js.prototype.set=Cc;function Hn(o){var h=-1,p=o==null?0:o.length;for(this.clear();++h<p;){var y=o[h];this.set(y[0],y[1])}}function Sc(){this.__data__=[],this.size=0}function $o(o){var h=this.__data__,p=Vn(h,o);if(p<0)return!1;var y=h.length-1;return p==y?h.pop():Hs.call(h,p,1),--this.size,!0}function Yo(o){var h=this.__data__,p=Vn(h,o);return p<0?s:h[p][1]}function Wr(o){return Vn(this.__data__,o)>-1}function jr(o,h){var p=this.__data__,y=Vn(p,o);return y<0?(++this.size,p.push([o,h])):p[y][1]=h,this}Hn.prototype.clear=Sc,Hn.prototype.delete=$o,Hn.prototype.get=Yo,Hn.prototype.has=Wr,Hn.prototype.set=jr;function Wn(o){var h=-1,p=o==null?0:o.length;for(this.clear();++h<p;){var y=o[h];this.set(y[0],y[1])}}function Ac(){this.size=0,this.__data__={hash:new js,map:new(Ui||Hn),string:new js}}function Gr(o){var h=Hc(this,o).delete(o);return this.size-=h?1:0,h}function Vr(o){return Hc(this,o).get(o)}function Th(o){return Hc(this,o).has(o)}function Qo(o,h){var p=Hc(this,o),y=p.size;return p.set(o,h),this.size+=p.size==y?0:1,this}Wn.prototype.clear=Ac,Wn.prototype.delete=Gr,Wn.prototype.get=Vr,Wn.prototype.has=Th,Wn.prototype.set=Qo;function an(o){var h=-1,p=o==null?0:o.length;for(this.__data__=new Wn;++h<p;)this.add(o[h])}function Ph(o){return this.__data__.set(o,x),this}function Rh(o){return this.__data__.has(o)}an.prototype.add=an.prototype.push=Ph,an.prototype.has=Rh;function oi(o){var h=this.__data__=new Hn(o);this.size=h.size}function vs(){this.__data__=new Hn,this.size=0}function jn(o){var h=this.__data__,p=h.delete(o);return this.size=h.size,p}function Gn(o){return this.__data__.get(o)}function ep(o){return this.__data__.has(o)}function ip(o,h){var p=this.__data__;if(p instanceof Hn){var y=p.__data__;if(!Ui||y.length<u-1)return y.push([o,h]),this.size=++p.size,this;p=this.__data__=new Wn(y)}return p.set(o,h),this.size=p.size,this}oi.prototype.clear=vs,oi.prototype.delete=jn,oi.prototype.get=Gn,oi.prototype.has=ep,oi.prototype.set=ip;function Xr(o,h){var p=zt(o),y=!p&&na(o),S=!p&&!y&&qr(o),F=!p&&!y&&!S&&yl(o),O=p||y||S||F,X=O?Mo(o.length,hc):[],Y=X.length;for(var ht in o)(h||se.call(o,ht))&&!(O&&(ht=="length"||S&&(ht=="offset"||ht=="parent")||F&&(ht=="buffer"||ht=="byteLength"||ht=="byteOffset")||gr(ht,Y)))&&X.push(ht);return X}function al(o){var h=o.length;return h?o[Xh(0,h-1)]:s}function np(o,h){return Wc(Bi(o),An(h,0,o.length))}function sp(o){return Wc(Bi(o))}function ln(o,h,p){(p!==s&&!ws(o[h],p)||p===s&&!(h in o))&&Xn(o,h,p)}function ai(o,h,p){var y=o[h];(!(se.call(o,h)&&ws(y,p))||p===s&&!(h in o))&&Xn(o,h,p)}function Vn(o,h){for(var p=o.length;p--;)if(ws(o[p][0],h))return p;return-1}function rp(o,h,p,y){return ys(o,function(S,F,O){h(y,S,p(S),O)}),y}function Ih(o,h){return o&&Tn(h,yi(h),o)}function Ec(o,h){return o&&Tn(h,un(h),o)}function Xn(o,h,p){h=="__proto__"&&zn?zn(o,h,{configurable:!0,enumerable:!0,value:p,writable:!0}):o[h]=p}function ll(o,h){for(var p=-1,y=h.length,S=tt(y),F=o==null;++p<y;)S[p]=F?s:Bp(o,h[p]);return S}function An(o,h,p){return o===o&&(p!==s&&(o=o<=p?o:p),h!==s&&(o=o>=h?o:h)),o}function Pi(o,h,p,y,S,F){var O,X=h&R,Y=h&L,ht=h&U;if(p&&(O=S?p(o,y,S,F):p(o)),O!==s)return O;if(!De(o))return o;var ut=zt(o);if(ut){if(O=X1(o),!X)return Bi(o,O)}else{var dt=zi(o),wt=dt==Je||dt==ss;if(qr(o))return Di(o,X);if(dt==ae||dt==ge||wt&&!S){if(O=Y||wt?{}:Gm(o),!X)return Y?Lc(o,Ec(O,o)):kc(o,Ih(O,o))}else{if(!le[dt])return S?o:{};O=$1(o,dt,X)}}F||(F=new oi);var St=F.get(o);if(St)return St;F.set(o,O),yv(o)?o.forEach(function(Dt){O.add(Pi(Dt,h,p,Dt,o,F))}):mv(o)&&o.forEach(function(Dt,Qt){O.set(Qt,Pi(Dt,h,p,Qt,o,F))});var It=ht?Y?yp:vp:Y?un:yi,Vt=ut?s:It(o);return Ye(Vt||o,function(Dt,Qt){Vt&&(Qt=Dt,Dt=o[Qt]),ai(O,Qt,Pi(Dt,h,p,Qt,o,F))}),O}function Dh(o){var h=yi(o);return function(p){return Fh(p,o,h)}}function Fh(o,h,p){var y=p.length;if(o==null)return!y;for(o=he(o);y--;){var S=p[y],F=h[S],O=o[S];if(O===s&&!(S in o)||!F(O))return!1}return!0}function Bh(o,h,p){if(typeof o!="function")throw new Yi(_);return qh(function(){o.apply(s,p)},h)}function $r(o,h,p,y){var S=-1,F=We,O=!0,X=o.length,Y=[],ht=h.length;if(!X)return Y;p&&(h=Bt(h,gi(p))),y?(F=yt,O=!1):h.length>=u&&(F=Re,O=!1,h=new an(h));t:for(;++S<X;){var ut=o[S],dt=p==null?ut:p(ut);if(ut=y||ut!==0?ut:0,O&&dt===dt){for(var wt=ht;wt--;)if(h[wt]===dt)continue t;Y.push(ut)}else F(h,dt,y)||Y.push(ut)}return Y}var ys=Im($n),hl=Im(Mh,!0);function kh(o,h){var p=!0;return ys(o,function(y,S,F){return p=!!h(y,S,F),p}),p}function qo(o,h,p){for(var y=-1,S=o.length;++y<S;){var F=o[y],O=h(F);if(O!=null&&(X===s?O===O&&!Pn(O):p(O,X)))var X=O,Y=F}return Y}function op(o,h,p,y){var S=o.length;for(p=Gt(p),p<0&&(p=-p>S?0:S+p),y=y===s||y>S?S:Gt(y),y<0&&(y+=S),y=p>y?0:xv(y);p<y;)o[p++]=h;return o}function Lh(o,h){var p=[];return ys(o,function(y,S,F){h(y,S,F)&&p.push(y)}),p}function li(o,h,p,y,S){var F=-1,O=o.length;for(p||(p=Q1),S||(S=[]);++F<O;){var X=o[F];h>0&&p(X)?h>1?li(X,h-1,p,y,S):ti(S,X):y||(S[S.length]=X)}return S}var ul=Dm(),Tc=Dm(!0);function $n(o,h){return o&&ul(o,h,yi)}function Mh(o,h){return o&&Tc(o,h,yi)}function En(o,h){return Qe(h,function(p){return _r(o[p])})}function Ie(o,h){h=Rt(h,o);for(var p=0,y=h.length;o!=null&&p<y;)o=o[$s(h[p++])];return p&&p==y?o:s}function Pc(o,h,p){var y=h(o);return zt(o)?y:ti(y,p(o))}function Ri(o){return o==null?o===s?Ca:Js:gs&&gs in he(o)?j1(o):ib(o)}function cl(o,h){return o>h}function ap(o,h){return o!=null&&se.call(o,h)}function Oh(o,h){return o!=null&&h in he(o)}function lp(o,h,p){return o>=si(h,p)&&o<Oe(h,p)}function Gs(o,h,p){for(var y=p?yt:We,S=o[0].length,F=o.length,O=F,X=tt(F),Y=1/0,ht=[];O--;){var ut=o[O];O&&h&&(ut=Bt(ut,gi(h))),Y=si(ut.length,Y),X[O]=!p&&(h||S>=120&&ut.length>=120)?new an(O&&ut):s}ut=o[0];var dt=-1,wt=X[0];t:for(;++dt<S&&ht.length<Y;){var St=ut[dt],It=h?h(St):St;if(St=p||St!==0?St:0,!(wt?Re(wt,It):y(ht,It,p))){for(O=F;--O;){var Vt=X[O];if(!(Vt?Re(Vt,It):y(o[O],It,p)))continue t}wt&&wt.push(It),ht.push(St)}}return ht}function hp(o,h,p,y){return $n(o,function(S,F,O){h(y,p(S),F,O)}),y}function Zo(o,h,p){h=Rt(h,o),o=Ym(o,h);var y=o==null?o:o[$s(Yn(h))];return y==null?s:Ci(y,o,p)}function Rc(o){return Ne(o)&&Ri(o)==ge}function up(o){return Ne(o)&&Ri(o)==tr}function cp(o){return Ne(o)&&Ri(o)==Ds}function Ko(o,h,p,y,S){return o===h?!0:o==null||h==null||!Ne(o)&&!Ne(h)?o!==o&&h!==h:dp(o,h,p,y,Ko,S)}function dp(o,h,p,y,S,F){var O=zt(o),X=zt(h),Y=O?Zt:zi(o),ht=X?Zt:zi(h);Y=Y==ge?ae:Y,ht=ht==ge?ae:ht;var ut=Y==ae,dt=ht==ae,wt=Y==ht;if(wt&&qr(o)){if(!qr(h))return!1;O=!0,ut=!1}if(wt&&!ut)return F||(F=new oi),O||yl(o)?Hm(o,h,p,y,S,F):H1(o,h,Y,p,y,S,F);if(!(p&H)){var St=ut&&se.call(o,"__wrapped__"),It=dt&&se.call(h,"__wrapped__");if(St||It){var Vt=St?o.value():o,Dt=It?h.value():h;return F||(F=new oi),S(Vt,Dt,p,y,F)}}return wt?(F||(F=new oi),W1(o,h,p,y,S,F)):!1}function fp(o){return Ne(o)&&zi(o)==Oi}function Nh(o,h,p,y){var S=p.length,F=S,O=!y;if(o==null)return!F;for(o=he(o);S--;){var X=p[S];if(O&&X[2]?X[1]!==o[X[0]]:!(X[0]in o))return!1}for(;++S<F;){X=p[S];var Y=X[0],ht=o[Y],ut=X[1];if(O&&X[2]){if(ht===s&&!(Y in o))return!1}else{var dt=new oi;if(y)var wt=y(ht,ut,Y,o,h,dt);if(!(wt===s?Ko(ut,ht,H|$,y,dt):wt))return!1}}return!0}function Jo(o){if(!De(o)||Z1(o))return!1;var h=_r(o)?Ja:ls;return h.test(ia(o))}function Uh(o){return Ne(o)&&Ri(o)==vn}function Ic(o){return Ne(o)&&zi(o)==ne}function pp(o){return Ne(o)&&Yc(o.length)&&!!ce[Ri(o)]}function zh(o){return typeof o=="function"?o:o==null?cn:typeof o=="object"?zt(o)?Dc(o[0],o[1]):fl(o):Fv(o)}function Hh(o){if(!Qh(o))return fc(o);var h=[];for(var p in he(o))se.call(o,p)&&p!="constructor"&&h.push(p);return h}function gp(o){if(!De(o))return eb(o);var h=Qh(o),p=[];for(var y in o)y=="constructor"&&(h||!se.call(o,y))||p.push(y);return p}function dl(o,h){return o<h}function Wh(o,h){var p=-1,y=hn(o)?tt(o.length):[];return ys(o,function(S,F,O){y[++p]=h(S,F,O)}),y}function fl(o){var h=xp(o);return h.length==1&&h[0][2]?Xm(h[0][0],h[0][1]):function(p){return p===o||Nh(p,o,h)}}function Dc(o,h){return Cp(o)&&Vm(h)?Xm($s(o),h):function(p){var y=Bp(p,o);return y===s&&y===h?kp(p,o):Ko(h,y,H|$)}}function pl(o,h,p,y,S){o!==h&&ul(h,function(F,O){if(S||(S=new oi),De(F))jh(o,h,O,p,pl,y,S);else{var X=y?y(Ap(o,O),F,O+"",o,h,S):s;X===s&&(X=F),ln(o,O,X)}},un)}function jh(o,h,p,y,S,F,O){var X=Ap(o,p),Y=Ap(h,p),ht=O.get(Y);if(ht){ln(o,p,ht);return}var ut=F?F(X,Y,p+"",o,h,O):s,dt=ut===s;if(dt){var wt=zt(Y),St=!wt&&qr(Y),It=!wt&&!St&&yl(Y);ut=Y,wt||St||It?zt(X)?ut=X:Ve(X)?ut=Bi(X):St?(dt=!1,ut=Di(Y,!0)):It?(dt=!1,ut=At(Y,!0)):ut=[]:Zh(Y)||na(Y)?(ut=X,na(X)?ut=bv(X):(!De(X)||_r(X))&&(ut=Gm(Y))):dt=!1}dt&&(O.set(Y,ut),S(ut,Y,y,F,O),O.delete(Y)),ln(o,p,ut)}function gl(o,h){var p=o.length;if(p)return h+=h<0?p:0,gr(h,p)?o[h]:s}function Gh(o,h,p){h.length?h=Bt(h,function(F){return zt(F)?function(O){return Ie(O,F.length===1?F[0]:F)}:F}):h=[cn];var y=-1;h=Bt(h,gi(Pt()));var S=Wh(o,function(F,O,X){var Y=Bt(h,function(ht){return ht(F)});return{criteria:Y,index:++y,value:F}});return ac(S,function(F,O){return cr(F,O,p)})}function Yr(o,h){return Fc(o,h,function(p,y){return kp(o,y)})}function Fc(o,h,p){for(var y=-1,S=h.length,F={};++y<S;){var O=h[y],X=Ie(o,O);p(X,O)&&l(F,Rt(O,o),X)}return F}function _l(o){return function(h){return Ie(h,o)}}function Vh(o,h,p,y){var S=y?Xa:$i,F=-1,O=h.length,X=o;for(o===h&&(h=Bi(h)),p&&(X=Bt(o,gi(p)));++F<O;)for(var Y=0,ht=h[F],ut=p?p(ht):ht;(Y=S(X,ut,Y,y))>-1;)X!==o&&Hs.call(X,Y,1),Hs.call(o,Y,1);return o}function Bc(o,h){for(var p=o?h.length:0,y=p-1;p--;){var S=h[p];if(p==y||S!==F){var F=S;gr(S)?Hs.call(o,S,1):st(o,S)}}return o}function Xh(o,h){return o+Vo(gc()*(h-o+1))}function $h(o,h,p,y){for(var S=-1,F=Oe(Go((h-o)/(p||1)),0),O=tt(F);F--;)O[y?F:++S]=o,o+=p;return O}function f(o,h){var p="";if(!o||h<1||h>vt)return p;do h%2&&(p+=o),h=Vo(h/2),h&&(o+=o);while(h);return p}function t(o,h){return Ep($m(o,h,cn),o+"")}function i(o){return al(wl(o))}function r(o,h){var p=wl(o);return Wc(p,An(h,0,p.length))}function l(o,h,p,y){if(!De(o))return o;h=Rt(h,o);for(var S=-1,F=h.length,O=F-1,X=o;X!=null&&++S<F;){var Y=$s(h[S]),ht=p;if(Y==="__proto__"||Y==="constructor"||Y==="prototype")return o;if(S!=O){var ut=X[Y];ht=y?y(ut,Y,X):s,ht===s&&(ht=De(ut)?ut:gr(h[S+1])?[]:{})}ai(X,Y,ht),X=X[Y]}return o}var c=Ws?function(o,h){return Ws.set(o,h),o}:cn,g=zn?function(o,h){return zn(o,"toString",{configurable:!0,enumerable:!1,value:Mp(h),writable:!0})}:cn;function m(o){return Wc(wl(o))}function w(o,h,p){var y=-1,S=o.length;h<0&&(h=-h>S?0:S+h),p=p>S?S:p,p<0&&(p+=S),S=h>p?0:p-h>>>0,h>>>=0;for(var F=tt(S);++y<S;)F[y]=o[y+h];return F}function C(o,h){var p;return ys(o,function(y,S,F){return p=h(y,S,F),!p}),!!p}function A(o,h,p){var y=0,S=o==null?y:o.length;if(typeof h=="number"&&h===h&&S<=is){for(;y<S;){var F=y+S>>>1,O=o[F];O!==null&&!Pn(O)&&(p?O<=h:O<h)?y=F+1:S=F}return S}return T(o,h,cn,p)}function T(o,h,p,y){var S=0,F=o==null?0:o.length;if(F===0)return 0;h=p(h);for(var O=h!==h,X=h===null,Y=Pn(h),ht=h===s;S<F;){var ut=Vo((S+F)/2),dt=p(o[ut]),wt=dt!==s,St=dt===null,It=dt===dt,Vt=Pn(dt);if(O)var Dt=y||It;else ht?Dt=It&&(y||wt):X?Dt=It&&wt&&(y||!St):Y?Dt=It&&wt&&!St&&(y||!Vt):St||Vt?Dt=!1:Dt=y?dt<=h:dt<h;Dt?S=ut+1:F=ut}return si(F,pe)}function M(o,h){for(var p=-1,y=o.length,S=0,F=[];++p<y;){var O=o[p],X=h?h(O):O;if(!p||!ws(X,Y)){var Y=X;F[S++]=O===0?0:O}}return F}function z(o){return typeof o=="number"?o:Pn(o)?Ft:+o}function W(o){if(typeof o=="string")return o;if(zt(o))return Bt(o,W)+"";if(Pn(o))return rl?rl.call(o):"";var h=o+"";return h=="0"&&1/o==-Ke?"-0":h}function Z(o,h,p){var y=-1,S=We,F=o.length,O=!0,X=[],Y=X;if(p)O=!1,S=yt;else if(F>=u){var ht=h?null:U1(o);if(ht)return Qa(ht);O=!1,S=Re,Y=new an}else Y=h?[]:X;t:for(;++y<F;){var ut=o[y],dt=h?h(ut):ut;if(ut=p||ut!==0?ut:0,O&&dt===dt){for(var wt=Y.length;wt--;)if(Y[wt]===dt)continue t;h&&Y.push(dt),X.push(ut)}else S(Y,dt,p)||(Y!==X&&Y.push(dt),X.push(ut))}return X}function st(o,h){return h=Rt(h,o),o=Ym(o,h),o==null||delete o[$s(Yn(h))]}function q(o,h,p,y){return l(o,h,p(Ie(o,h)),y)}function Q(o,h,p,y){for(var S=o.length,F=y?S:-1;(y?F--:++F<S)&&h(o[F],F,o););return p?w(o,y?0:F,y?F+1:S):w(o,y?F+1:0,y?S:F)}function ot(o,h){var p=o;return p instanceof jt&&(p=p.value()),cs(h,function(y,S){return S.func.apply(S.thisArg,ti([y],S.args))},p)}function et(o,h,p){var y=o.length;if(y<2)return y?Z(o[0]):[];for(var S=-1,F=tt(y);++S<y;)for(var O=o[S],X=-1;++X<y;)X!=S&&(F[S]=$r(F[S]||O,o[X],h,p));return Z(li(F,1),h,p)}function _t(o,h,p){for(var y=-1,S=o.length,F=h.length,O={};++y<S;){var X=y<F?h[y]:s;p(O,o[y],X)}return O}function Nt(o){return Ve(o)?o:[]}function at(o){return typeof o=="function"?o:cn}function Rt(o,h){return zt(o)?o:Cp(o,h)?[o]:Km(ue(o))}var we=t;function _e(o,h,p){var y=o.length;return p=p===s?y:p,!h&&p>=y?o:w(o,h,p)}var Ii=tl||function(o){return He.clearTimeout(o)};function Di(o,h){if(h)return o.slice();var p=o.length,y=jo?jo(p):new o.constructor(p);return o.copy(y),y}function vi(o){var h=new o.constructor(o.byteLength);return new lr(h).set(new lr(o)),h}function Fi(o,h){var p=h?vi(o.buffer):o.buffer;return new o.constructor(p,o.byteOffset,o.byteLength)}function hi(o){var h=new o.constructor(o.source,sh.exec(o));return h.lastIndex=o.lastIndex,h}function ui(o){return zr?he(zr.call(o)):{}}function At(o,h){var p=h?vi(o.buffer):o.buffer;return new o.constructor(p,o.byteOffset,o.length)}function Vs(o,h){if(o!==h){var p=o!==s,y=o===null,S=o===o,F=Pn(o),O=h!==s,X=h===null,Y=h===h,ht=Pn(h);if(!X&&!ht&&!F&&o>h||F&&O&&Y&&!X&&!ht||y&&O&&Y||!p&&Y||!S)return 1;if(!y&&!F&&!ht&&o<h||ht&&p&&S&&!y&&!F||X&&p&&S||!O&&S||!Y)return-1}return 0}function cr(o,h,p){for(var y=-1,S=o.criteria,F=h.criteria,O=S.length,X=p.length;++y<O;){var Y=Vs(S[y],F[y]);if(Y){if(y>=X)return Y;var ht=p[y];return Y*(ht=="desc"?-1:1)}}return o.index-h.index}function Xs(o,h,p,y){for(var S=-1,F=o.length,O=p.length,X=-1,Y=h.length,ht=Oe(F-O,0),ut=tt(Y+ht),dt=!y;++X<Y;)ut[X]=h[X];for(;++S<O;)(dt||S<F)&&(ut[p[S]]=o[S]);for(;ht--;)ut[X++]=o[S++];return ut}function dr(o,h,p,y){for(var S=-1,F=o.length,O=-1,X=p.length,Y=-1,ht=h.length,ut=Oe(F-X,0),dt=tt(ut+ht),wt=!y;++S<ut;)dt[S]=o[S];for(var St=S;++Y<ht;)dt[St+Y]=h[Y];for(;++O<X;)(wt||S<F)&&(dt[St+p[O]]=o[S++]);return dt}function Bi(o,h){var p=-1,y=o.length;for(h||(h=tt(y));++p<y;)h[p]=o[p];return h}function Tn(o,h,p,y){var S=!p;p||(p={});for(var F=-1,O=h.length;++F<O;){var X=h[F],Y=y?y(p[X],o[X],X,p,o):s;Y===s&&(Y=o[X]),S?Xn(p,X,Y):ai(p,X,Y)}return p}function kc(o,h){return Tn(o,bp(o),h)}function Lc(o,h){return Tn(o,Wm(o),h)}function ta(o,h){return function(p,y){var S=zt(p)?Va:rp,F=h?h():{};return S(p,o,Pt(y,2),F)}}function Qr(o){return t(function(h,p){var y=-1,S=p.length,F=S>1?p[S-1]:s,O=S>2?p[2]:s;for(F=o.length>3&&typeof F=="function"?(S--,F):s,O&&Qi(p[0],p[1],O)&&(F=S<3?s:F,S=1),h=he(h);++y<S;){var X=p[y];X&&o(h,X,y,F)}return h})}function Im(o,h){return function(p,y){if(p==null)return p;if(!hn(p))return o(p,y);for(var S=p.length,F=h?S:-1,O=he(p);(h?F--:++F<S)&&y(O[F],F,O)!==!1;);return p}}function Dm(o){return function(h,p,y){for(var S=-1,F=he(h),O=y(h),X=O.length;X--;){var Y=O[o?X:++S];if(p(F[Y],Y,F)===!1)break}return h}}function M1(o,h,p){var y=h&G,S=Yh(o);function F(){var O=this&&this!==He&&this instanceof F?S:o;return O.apply(y?p:this,arguments)}return F}function Fm(o){return function(h){h=ue(h);var p=de(h)?bn(h):s,y=p?p[0]:h.charAt(0),S=p?_e(p,1).join(""):h.slice(1);return y[o]()+S}}function ml(o){return function(h){return cs(Iv(Rv(h).replace(Br,"")),o,"")}}function Yh(o){return function(){var h=arguments;switch(h.length){case 0:return new o;case 1:return new o(h[0]);case 2:return new o(h[0],h[1]);case 3:return new o(h[0],h[1],h[2]);case 4:return new o(h[0],h[1],h[2],h[3]);case 5:return new o(h[0],h[1],h[2],h[3],h[4]);case 6:return new o(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new o(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var p=ur(o.prototype),y=o.apply(p,h);return De(y)?y:p}}function O1(o,h,p){var y=Yh(o);function S(){for(var F=arguments.length,O=tt(F),X=F,Y=vl(S);X--;)O[X]=arguments[X];var ht=F<3&&O[0]!==Y&&O[F-1]!==Y?[]:Us(O,Y);if(F-=ht.length,F<p)return Om(o,h,Mc,S.placeholder,s,O,ht,s,s,p-F);var ut=this&&this!==He&&this instanceof S?y:o;return Ci(ut,this,O)}return S}function Bm(o){return function(h,p,y){var S=he(h);if(!hn(h)){var F=Pt(p,3);h=yi(h),p=function(X){return F(S[X],X,S)}}var O=o(h,p,y);return O>-1?S[F?h[O]:O]:s}}function km(o){return pr(function(h){var p=h.length,y=p,S=on.prototype.thru;for(o&&h.reverse();y--;){var F=h[y];if(typeof F!="function")throw new Yi(_);if(S&&!O&&zc(F)=="wrapper")var O=new on([],!0)}for(y=O?y:p;++y<p;){F=h[y];var X=zc(F),Y=X=="wrapper"?wp(F):s;Y&&Sp(Y[0])&&Y[1]==(D|N|K|j)&&!Y[4].length&&Y[9]==1?O=O[zc(Y[0])].apply(O,Y[3]):O=F.length==1&&Sp(F)?O[X]():O.thru(F)}return function(){var ht=arguments,ut=ht[0];if(O&&ht.length==1&&zt(ut))return O.plant(ut).value();for(var dt=0,wt=p?h[dt].apply(this,ht):ut;++dt<p;)wt=h[dt].call(this,wt);return wt}})}function Mc(o,h,p,y,S,F,O,X,Y,ht){var ut=h&D,dt=h&G,wt=h&k,St=h&(N|J),It=h&nt,Vt=wt?s:Yh(o);function Dt(){for(var Qt=arguments.length,Kt=tt(Qt),Rn=Qt;Rn--;)Kt[Rn]=arguments[Rn];if(St)var qi=vl(Dt),In=xn(Kt,qi);if(y&&(Kt=Xs(Kt,y,S,St)),F&&(Kt=dr(Kt,F,O,St)),Qt-=In,St&&Qt<ht){var Xe=Us(Kt,qi);return Om(o,h,Mc,Dt.placeholder,p,Kt,Xe,X,Y,ht-Qt)}var xs=dt?p:this,vr=wt?xs[o]:o;return Qt=Kt.length,X?Kt=nb(Kt,X):It&&Qt>1&&Kt.reverse(),ut&&Y<Qt&&(Kt.length=Y),this&&this!==He&&this instanceof Dt&&(vr=Vt||Yh(vr)),vr.apply(xs,Kt)}return Dt}function Lm(o,h){return function(p,y){return hp(p,o,h(y),{})}}function Oc(o,h){return function(p,y){var S;if(p===s&&y===s)return h;if(p!==s&&(S=p),y!==s){if(S===s)return y;typeof p=="string"||typeof y=="string"?(p=W(p),y=W(y)):(p=z(p),y=z(y)),S=o(p,y)}return S}}function _p(o){return pr(function(h){return h=Bt(h,gi(Pt())),t(function(p){var y=this;return o(h,function(S){return Ci(S,y,p)})})})}function Nc(o,h){h=h===s?" ":W(h);var p=h.length;if(p<2)return p?f(h,o):h;var y=f(h,Go(o/_i(h)));return de(h)?_e(bn(y),0,o).join(""):y.slice(0,o)}function N1(o,h,p,y){var S=h&G,F=Yh(o);function O(){for(var X=-1,Y=arguments.length,ht=-1,ut=y.length,dt=tt(ut+Y),wt=this&&this!==He&&this instanceof O?F:o;++ht<ut;)dt[ht]=y[ht];for(;Y--;)dt[ht++]=arguments[++X];return Ci(wt,S?p:this,dt)}return O}function Mm(o){return function(h,p,y){return y&&typeof y!="number"&&Qi(h,p,y)&&(p=y=s),h=mr(h),p===s?(p=h,h=0):p=mr(p),y=y===s?h<p?1:-1:mr(y),$h(h,p,y,o)}}function Uc(o){return function(h,p){return typeof h=="string"&&typeof p=="string"||(h=Qn(h),p=Qn(p)),o(h,p)}}function Om(o,h,p,y,S,F,O,X,Y,ht){var ut=h&N,dt=ut?O:s,wt=ut?s:O,St=ut?F:s,It=ut?s:F;h|=ut?K:ft,h&=~(ut?ft:K),h&B||(h&=~(G|k));var Vt=[o,h,S,St,dt,It,wt,X,Y,ht],Dt=p.apply(s,Vt);return Sp(o)&&Qm(Dt,Vt),Dt.placeholder=y,qm(Dt,o,h)}function mp(o){var h=te[o];return function(p,y){if(p=Qn(p),y=y==null?0:si(Gt(y),292),y&&Eh(p)){var S=(ue(p)+"e").split("e"),F=h(S[0]+"e"+(+S[1]+y));return S=(ue(F)+"e").split("e"),+(S[0]+"e"+(+S[1]-y))}return h(p)}}var U1=ri&&1/Qa(new ri([,-0]))[1]==Ke?function(o){return new ri(o)}:Up;function Nm(o){return function(h){var p=zi(h);return p==Oi?Sh(h):p==ne?qf(h):ei(h,o(h))}}function fr(o,h,p,y,S,F,O,X){var Y=h&k;if(!Y&&typeof o!="function")throw new Yi(_);var ht=y?y.length:0;if(ht||(h&=~(K|ft),y=S=s),O=O===s?O:Oe(Gt(O),0),X=X===s?X:Gt(X),ht-=S?S.length:0,h&ft){var ut=y,dt=S;y=S=s}var wt=Y?s:wp(o),St=[o,h,p,y,S,ut,dt,F,O,X];if(wt&&tb(St,wt),o=St[0],h=St[1],p=St[2],y=St[3],S=St[4],X=St[9]=St[9]===s?Y?0:o.length:Oe(St[9]-ht,0),!X&&h&(N|J)&&(h&=~(N|J)),!h||h==G)var It=M1(o,h,p);else h==N||h==J?It=O1(o,h,X):(h==K||h==(G|K))&&!S.length?It=N1(o,h,p,y):It=Mc.apply(s,St);var Vt=wt?c:Qm;return qm(Vt(It,St),o,h)}function Um(o,h,p,y){return o===s||ws(o,or[p])&&!se.call(y,p)?h:o}function zm(o,h,p,y,S,F){return De(o)&&De(h)&&(F.set(h,o),pl(o,h,s,zm,F),F.delete(h)),o}function z1(o){return Zh(o)?s:o}function Hm(o,h,p,y,S,F){var O=p&H,X=o.length,Y=h.length;if(X!=Y&&!(O&&Y>X))return!1;var ht=F.get(o),ut=F.get(h);if(ht&&ut)return ht==h&&ut==o;var dt=-1,wt=!0,St=p&$?new an:s;for(F.set(o,h),F.set(h,o);++dt<X;){var It=o[dt],Vt=h[dt];if(y)var Dt=O?y(Vt,It,dt,h,o,F):y(It,Vt,dt,o,h,F);if(Dt!==s){if(Dt)continue;wt=!1;break}if(St){if(!rr(h,function(Qt,Kt){if(!Re(St,Kt)&&(It===Qt||S(It,Qt,p,y,F)))return St.push(Kt)})){wt=!1;break}}else if(!(It===Vt||S(It,Vt,p,y,F))){wt=!1;break}}return F.delete(o),F.delete(h),wt}function H1(o,h,p,y,S,F,O){switch(p){case Ir:if(o.byteLength!=h.byteLength||o.byteOffset!=h.byteOffset)return!1;o=o.buffer,h=h.buffer;case tr:return!(o.byteLength!=h.byteLength||!F(new lr(o),new lr(h)));case ns:case Ds:case oe:return ws(+o,+h);case ie:return o.name==h.name&&o.message==h.message;case vn:case ve:return o==h+"";case Oi:var X=Sh;case ne:var Y=y&H;if(X||(X=Qa),o.size!=h.size&&!Y)return!1;var ht=O.get(o);if(ht)return ht==h;y|=$,O.set(o,h);var ut=Hm(X(o),X(h),y,S,F,O);return O.delete(o),ut;case rs:if(zr)return zr.call(o)==zr.call(h)}return!1}function W1(o,h,p,y,S,F){var O=p&H,X=vp(o),Y=X.length,ht=vp(h),ut=ht.length;if(Y!=ut&&!O)return!1;for(var dt=Y;dt--;){var wt=X[dt];if(!(O?wt in h:se.call(h,wt)))return!1}var St=F.get(o),It=F.get(h);if(St&&It)return St==h&&It==o;var Vt=!0;F.set(o,h),F.set(h,o);for(var Dt=O;++dt<Y;){wt=X[dt];var Qt=o[wt],Kt=h[wt];if(y)var Rn=O?y(Kt,Qt,wt,h,o,F):y(Qt,Kt,wt,o,h,F);if(!(Rn===s?Qt===Kt||S(Qt,Kt,p,y,F):Rn)){Vt=!1;break}Dt||(Dt=wt=="constructor")}if(Vt&&!Dt){var qi=o.constructor,In=h.constructor;qi!=In&&"constructor"in o&&"constructor"in h&&!(typeof qi=="function"&&qi instanceof qi&&typeof In=="function"&&In instanceof In)&&(Vt=!1)}return F.delete(o),F.delete(h),Vt}function pr(o){return Ep($m(o,s,iv),o+"")}function vp(o){return Pc(o,yi,bp)}function yp(o){return Pc(o,un,Wm)}var wp=Ws?function(o){return Ws.get(o)}:Up;function zc(o){for(var h=o.name+"",p=hr[h],y=se.call(hr,h)?p.length:0;y--;){var S=p[y],F=S.func;if(F==null||F==o)return S.name}return h}function vl(o){var h=se.call(P,"placeholder")?P:o;return h.placeholder}function Pt(){var o=P.iteratee||Op;return o=o===Op?zh:o,arguments.length?o(arguments[0],arguments[1]):o}function Hc(o,h){var p=o.__data__;return q1(h)?p[typeof h=="string"?"string":"hash"]:p.map}function xp(o){for(var h=yi(o),p=h.length;p--;){var y=h[p],S=o[y];h[p]=[y,S,Vm(S)]}return h}function ea(o,h){var p=ii(o,h);return Jo(p)?p:s}function j1(o){var h=se.call(o,gs),p=o[gs];try{o[gs]=s;var y=!0}catch{}var S=Lr.call(o);return y&&(h?o[gs]=p:delete o[gs]),S}var bp=il?function(o){return o==null?[]:(o=he(o),Qe(il(o),function(h){return zs.call(o,h)}))}:zp,Wm=il?function(o){for(var h=[];o;)ti(h,bp(o)),o=ps(o);return h}:zp,zi=Ri;(sl&&zi(new sl(new ArrayBuffer(1)))!=Ir||Ui&&zi(new Ui)!=Oi||mi&&zi(mi.resolve())!=wo||ri&&zi(new ri)!=ne||Nr&&zi(new Nr)!=yn)&&(zi=function(o){var h=Ri(o),p=h==ae?o.constructor:s,y=p?ia(p):"";if(y)switch(y){case _c:return Ir;case mc:return Oi;case vc:return wo;case Ti:return ne;case yc:return yn}return h});function G1(o,h,p){for(var y=-1,S=p.length;++y<S;){var F=p[y],O=F.size;switch(F.type){case"drop":o+=O;break;case"dropRight":h-=O;break;case"take":h=si(h,o+O);break;case"takeRight":o=Oe(o,h-O);break}}return{start:o,end:h}}function V1(o){var h=o.match(zf);return h?h[1].split(Hf):[]}function jm(o,h,p){h=Rt(h,o);for(var y=-1,S=h.length,F=!1;++y<S;){var O=$s(h[y]);if(!(F=o!=null&&p(o,O)))break;o=o[O]}return F||++y!=S?F:(S=o==null?0:o.length,!!S&&Yc(S)&&gr(O,S)&&(zt(o)||na(o)))}function X1(o){var h=o.length,p=new o.constructor(h);return h&&typeof o[0]=="string"&&se.call(o,"index")&&(p.index=o.index,p.input=o.input),p}function Gm(o){return typeof o.constructor=="function"&&!Qh(o)?ur(ps(o)):{}}function $1(o,h,p){var y=o.constructor;switch(h){case tr:return vi(o);case ns:case Ds:return new y(+o);case Ir:return Fi(o,p);case Dr:case th:case eh:case xo:case Sa:case Aa:case Ea:case Ta:case bi:return At(o,p);case Oi:return new y;case oe:case ve:return new y(o);case vn:return hi(o);case ne:return new y;case rs:return ui(o)}}function Y1(o,h){var p=h.length;if(!p)return o;var y=p-1;return h[y]=(p>1?"& ":"")+h[y],h=h.join(p>2?", ":" "),o.replace(Uf,`{
/* [wrapped with `+h+`] */
`)}function Q1(o){return zt(o)||na(o)||!!(Ei&&o&&o[Ei])}function gr(o,h){var p=typeof o;return h=h??vt,!!h&&(p=="number"||p!="symbol"&&Vf.test(o))&&o>-1&&o%1==0&&o<h}function Qi(o,h,p){if(!De(p))return!1;var y=typeof h;return(y=="number"?hn(p)&&gr(h,p.length):y=="string"&&h in p)?ws(p[h],o):!1}function Cp(o,h){if(zt(o))return!1;var p=typeof o;return p=="number"||p=="symbol"||p=="boolean"||o==null||Pn(o)?!0:Lf.test(o)||!bo.test(o)||h!=null&&o in he(h)}function q1(o){var h=typeof o;return h=="string"||h=="number"||h=="symbol"||h=="boolean"?o!=="__proto__":o===null}function Sp(o){var h=zc(o),p=P[h];if(typeof p!="function"||!(h in jt.prototype))return!1;if(o===p)return!0;var y=wp(p);return!!y&&o===y[0]}function Z1(o){return!!Ka&&Ka in o}var K1=zo?_r:Hp;function Qh(o){var h=o&&o.constructor,p=typeof h=="function"&&h.prototype||or;return o===p}function Vm(o){return o===o&&!De(o)}function Xm(o,h){return function(p){return p==null?!1:p[o]===h&&(h!==s||o in he(p))}}function J1(o){var h=Xc(o,function(y){return p.size===b&&p.clear(),y}),p=h.cache;return h}function tb(o,h){var p=o[1],y=h[1],S=p|y,F=S<(G|k|D),O=y==D&&p==N||y==D&&p==j&&o[7].length<=h[8]||y==(D|j)&&h[7].length<=h[8]&&p==N;if(!(F||O))return o;y&G&&(o[2]=h[2],S|=p&G?0:B);var X=h[3];if(X){var Y=o[3];o[3]=Y?Xs(Y,X,h[4]):X,o[4]=Y?Us(o[3],E):h[4]}return X=h[5],X&&(Y=o[5],o[5]=Y?dr(Y,X,h[6]):X,o[6]=Y?Us(o[5],E):h[6]),X=h[7],X&&(o[7]=X),y&D&&(o[8]=o[8]==null?h[8]:si(o[8],h[8])),o[9]==null&&(o[9]=h[9]),o[0]=h[0],o[1]=S,o}function eb(o){var h=[];if(o!=null)for(var p in he(o))h.push(p);return h}function ib(o){return Lr.call(o)}function $m(o,h,p){return h=Oe(h===s?o.length-1:h,0),function(){for(var y=arguments,S=-1,F=Oe(y.length-h,0),O=tt(F);++S<F;)O[S]=y[h+S];S=-1;for(var X=tt(h+1);++S<h;)X[S]=y[S];return X[h]=p(O),Ci(o,this,X)}}function Ym(o,h){return h.length<2?o:Ie(o,w(h,0,-1))}function nb(o,h){for(var p=o.length,y=si(h.length,p),S=Bi(o);y--;){var F=h[y];o[y]=gr(F,p)?S[F]:s}return o}function Ap(o,h){if(!(h==="constructor"&&typeof o[h]=="function")&&h!="__proto__")return o[h]}var Qm=Zm(c),qh=Zf||function(o,h){return He.setTimeout(o,h)},Ep=Zm(g);function qm(o,h,p){var y=h+"";return Ep(o,Y1(y,sb(V1(y),p)))}function Zm(o){var h=0,p=0;return function(){var y=Kf(),S=Pe-(y-p);if(p=y,S>0){if(++h>=gt)return arguments[0]}else h=0;return o.apply(s,arguments)}}function Wc(o,h){var p=-1,y=o.length,S=y-1;for(h=h===s?y:h;++p<h;){var F=Xh(p,S),O=o[F];o[F]=o[p],o[p]=O}return o.length=h,o}var Km=J1(function(o){var h=[];return o.charCodeAt(0)===46&&h.push(""),o.replace(Mf,function(p,y,S,F){h.push(S?F.replace(jf,"$1"):y||p)}),h});function $s(o){if(typeof o=="string"||Pn(o))return o;var h=o+"";return h=="0"&&1/o==-Ke?"-0":h}function ia(o){if(o!=null){try{return Ho.call(o)}catch{}try{return o+""}catch{}}return""}function sb(o,h){return Ye(Vi,function(p){var y="_."+p[0];h&p[1]&&!We(o,y)&&o.push(y)}),o.sort()}function Jm(o){if(o instanceof jt)return o.clone();var h=new on(o.__wrapped__,o.__chain__);return h.__actions__=Bi(o.__actions__),h.__index__=o.__index__,h.__values__=o.__values__,h}function rb(o,h,p){(p?Qi(o,h,p):h===s)?h=1:h=Oe(Gt(h),0);var y=o==null?0:o.length;if(!y||h<1)return[];for(var S=0,F=0,O=tt(Go(y/h));S<y;)O[F++]=w(o,S,S+=h);return O}function ob(o){for(var h=-1,p=o==null?0:o.length,y=0,S=[];++h<p;){var F=o[h];F&&(S[y++]=F)}return S}function ab(){var o=arguments.length;if(!o)return[];for(var h=tt(o-1),p=arguments[0],y=o;y--;)h[y-1]=arguments[y];return ti(zt(p)?Bi(p):[p],li(h,1))}var lb=t(function(o,h){return Ve(o)?$r(o,li(h,1,Ve,!0)):[]}),hb=t(function(o,h){var p=Yn(h);return Ve(p)&&(p=s),Ve(o)?$r(o,li(h,1,Ve,!0),Pt(p,2)):[]}),ub=t(function(o,h){var p=Yn(h);return Ve(p)&&(p=s),Ve(o)?$r(o,li(h,1,Ve,!0),s,p):[]});function cb(o,h,p){var y=o==null?0:o.length;return y?(h=p||h===s?1:Gt(h),w(o,h<0?0:h,y)):[]}function db(o,h,p){var y=o==null?0:o.length;return y?(h=p||h===s?1:Gt(h),h=y-h,w(o,0,h<0?0:h)):[]}function fb(o,h){return o&&o.length?Q(o,Pt(h,3),!0,!0):[]}function pb(o,h){return o&&o.length?Q(o,Pt(h,3),!0):[]}function gb(o,h,p,y){var S=o==null?0:o.length;return S?(p&&typeof p!="number"&&Qi(o,h,p)&&(p=0,y=S),op(o,h,p,y)):[]}function tv(o,h,p){var y=o==null?0:o.length;if(!y)return-1;var S=p==null?0:Gt(p);return S<0&&(S=Oe(y+S,0)),wn(o,Pt(h,3),S)}function ev(o,h,p){var y=o==null?0:o.length;if(!y)return-1;var S=y-1;return p!==s&&(S=Gt(p),S=p<0?Oe(y+S,0):si(S,y-1)),wn(o,Pt(h,3),S,!0)}function iv(o){var h=o==null?0:o.length;return h?li(o,1):[]}function _b(o){var h=o==null?0:o.length;return h?li(o,Ke):[]}function mb(o,h){var p=o==null?0:o.length;return p?(h=h===s?1:Gt(h),li(o,h)):[]}function vb(o){for(var h=-1,p=o==null?0:o.length,y={};++h<p;){var S=o[h];y[S[0]]=S[1]}return y}function nv(o){return o&&o.length?o[0]:s}function yb(o,h,p){var y=o==null?0:o.length;if(!y)return-1;var S=p==null?0:Gt(p);return S<0&&(S=Oe(y+S,0)),$i(o,h,S)}function wb(o){var h=o==null?0:o.length;return h?w(o,0,-1):[]}var xb=t(function(o){var h=Bt(o,Nt);return h.length&&h[0]===o[0]?Gs(h):[]}),bb=t(function(o){var h=Yn(o),p=Bt(o,Nt);return h===Yn(p)?h=s:p.pop(),p.length&&p[0]===o[0]?Gs(p,Pt(h,2)):[]}),Cb=t(function(o){var h=Yn(o),p=Bt(o,Nt);return h=typeof h=="function"?h:s,h&&p.pop(),p.length&&p[0]===o[0]?Gs(p,s,h):[]});function Sb(o,h){return o==null?"":dc.call(o,h)}function Yn(o){var h=o==null?0:o.length;return h?o[h-1]:s}function Ab(o,h,p){var y=o==null?0:o.length;if(!y)return-1;var S=y;return p!==s&&(S=Gt(p),S=S<0?Oe(y+S,0):si(S,y-1)),h===h?Oo(o,h,S):wn(o,Lo,S,!0)}function Eb(o,h){return o&&o.length?gl(o,Gt(h)):s}var Tb=t(sv);function sv(o,h){return o&&o.length&&h&&h.length?Vh(o,h):o}function Pb(o,h,p){return o&&o.length&&h&&h.length?Vh(o,h,Pt(p,2)):o}function Rb(o,h,p){return o&&o.length&&h&&h.length?Vh(o,h,s,p):o}var Ib=pr(function(o,h){var p=o==null?0:o.length,y=ll(o,h);return Bc(o,Bt(h,function(S){return gr(S,p)?+S:S}).sort(Vs)),y});function Db(o,h){var p=[];if(!(o&&o.length))return p;var y=-1,S=[],F=o.length;for(h=Pt(h,3);++y<F;){var O=o[y];h(O,y,o)&&(p.push(O),S.push(y))}return Bc(o,S),p}function Tp(o){return o==null?o:Jf.call(o)}function Fb(o,h,p){var y=o==null?0:o.length;return y?(p&&typeof p!="number"&&Qi(o,h,p)?(h=0,p=y):(h=h==null?0:Gt(h),p=p===s?y:Gt(p)),w(o,h,p)):[]}function Bb(o,h){return A(o,h)}function kb(o,h,p){return T(o,h,Pt(p,2))}function Lb(o,h){var p=o==null?0:o.length;if(p){var y=A(o,h);if(y<p&&ws(o[y],h))return y}return-1}function Mb(o,h){return A(o,h,!0)}function Ob(o,h,p){return T(o,h,Pt(p,2),!0)}function Nb(o,h){var p=o==null?0:o.length;if(p){var y=A(o,h,!0)-1;if(ws(o[y],h))return y}return-1}function Ub(o){return o&&o.length?M(o):[]}function zb(o,h){return o&&o.length?M(o,Pt(h,2)):[]}function Hb(o){var h=o==null?0:o.length;return h?w(o,1,h):[]}function Wb(o,h,p){return o&&o.length?(h=p||h===s?1:Gt(h),w(o,0,h<0?0:h)):[]}function jb(o,h,p){var y=o==null?0:o.length;return y?(h=p||h===s?1:Gt(h),h=y-h,w(o,h<0?0:h,y)):[]}function Gb(o,h){return o&&o.length?Q(o,Pt(h,3),!1,!0):[]}function Vb(o,h){return o&&o.length?Q(o,Pt(h,3)):[]}var Xb=t(function(o){return Z(li(o,1,Ve,!0))}),$b=t(function(o){var h=Yn(o);return Ve(h)&&(h=s),Z(li(o,1,Ve,!0),Pt(h,2))}),Yb=t(function(o){var h=Yn(o);return h=typeof h=="function"?h:s,Z(li(o,1,Ve,!0),s,h)});function Qb(o){return o&&o.length?Z(o):[]}function qb(o,h){return o&&o.length?Z(o,Pt(h,2)):[]}function Zb(o,h){return h=typeof h=="function"?h:s,o&&o.length?Z(o,s,h):[]}function Pp(o){if(!(o&&o.length))return[];var h=0;return o=Qe(o,function(p){if(Ve(p))return h=Oe(p.length,h),!0}),Mo(h,function(p){return Bt(o,fs(p))})}function rv(o,h){if(!(o&&o.length))return[];var p=Pp(o);return h==null?p:Bt(p,function(y){return Ci(h,s,y)})}var Kb=t(function(o,h){return Ve(o)?$r(o,h):[]}),Jb=t(function(o){return et(Qe(o,Ve))}),tC=t(function(o){var h=Yn(o);return Ve(h)&&(h=s),et(Qe(o,Ve),Pt(h,2))}),eC=t(function(o){var h=Yn(o);return h=typeof h=="function"?h:s,et(Qe(o,Ve),s,h)}),iC=t(Pp);function nC(o,h){return _t(o||[],h||[],ai)}function sC(o,h){return _t(o||[],h||[],l)}var rC=t(function(o){var h=o.length,p=h>1?o[h-1]:s;return p=typeof p=="function"?(o.pop(),p):s,rv(o,p)});function ov(o){var h=P(o);return h.__chain__=!0,h}function oC(o,h){return h(o),o}function jc(o,h){return h(o)}var aC=pr(function(o){var h=o.length,p=h?o[0]:0,y=this.__wrapped__,S=function(F){return ll(F,o)};return h>1||this.__actions__.length||!(y instanceof jt)||!gr(p)?this.thru(S):(y=y.slice(p,+p+(h?1:0)),y.__actions__.push({func:jc,args:[S],thisArg:s}),new on(y,this.__chain__).thru(function(F){return h&&!F.length&&F.push(s),F}))});function lC(){return ov(this)}function hC(){return new on(this.value(),this.__chain__)}function uC(){this.__values__===s&&(this.__values__=wv(this.value()));var o=this.__index__>=this.__values__.length,h=o?s:this.__values__[this.__index__++];return{done:o,value:h}}function cC(){return this}function dC(o){for(var h,p=this;p instanceof ms;){var y=Jm(p);y.__index__=0,y.__values__=s,h?S.__wrapped__=y:h=y;var S=y;p=p.__wrapped__}return S.__wrapped__=o,h}function fC(){var o=this.__wrapped__;if(o instanceof jt){var h=o;return this.__actions__.length&&(h=new jt(this)),h=h.reverse(),h.__actions__.push({func:jc,args:[Tp],thisArg:s}),new on(h,this.__chain__)}return this.thru(Tp)}function pC(){return ot(this.__wrapped__,this.__actions__)}var gC=ta(function(o,h,p){se.call(o,p)?++o[p]:Xn(o,p,1)});function _C(o,h,p){var y=zt(o)?oc:kh;return p&&Qi(o,h,p)&&(h=s),y(o,Pt(h,3))}function mC(o,h){var p=zt(o)?Qe:Lh;return p(o,Pt(h,3))}var vC=Bm(tv),yC=Bm(ev);function wC(o,h){return li(Gc(o,h),1)}function xC(o,h){return li(Gc(o,h),Ke)}function bC(o,h,p){return p=p===s?1:Gt(p),li(Gc(o,h),p)}function av(o,h){var p=zt(o)?Ye:ys;return p(o,Pt(h,3))}function lv(o,h){var p=zt(o)?rc:hl;return p(o,Pt(h,3))}var CC=ta(function(o,h,p){se.call(o,p)?o[p].push(h):Xn(o,p,[h])});function SC(o,h,p,y){o=hn(o)?o:wl(o),p=p&&!y?Gt(p):0;var S=o.length;return p<0&&(p=Oe(S+p,0)),Qc(o)?p<=S&&o.indexOf(h,p)>-1:!!S&&$i(o,h,p)>-1}var AC=t(function(o,h,p){var y=-1,S=typeof h=="function",F=hn(o)?tt(o.length):[];return ys(o,function(O){F[++y]=S?Ci(h,O,p):Zo(O,h,p)}),F}),EC=ta(function(o,h,p){Xn(o,p,h)});function Gc(o,h){var p=zt(o)?Bt:Wh;return p(o,Pt(h,3))}function TC(o,h,p,y){return o==null?[]:(zt(h)||(h=h==null?[]:[h]),p=y?s:p,zt(p)||(p=p==null?[]:[p]),Gh(o,h,p))}var PC=ta(function(o,h,p){o[p?0:1].push(h)},function(){return[[],[]]});function RC(o,h,p){var y=zt(o)?cs:Ch,S=arguments.length<3;return y(o,Pt(h,4),p,S,ys)}function IC(o,h,p){var y=zt(o)?Xi:Ch,S=arguments.length<3;return y(o,Pt(h,4),p,S,hl)}function DC(o,h){var p=zt(o)?Qe:Lh;return p(o,$c(Pt(h,3)))}function FC(o){var h=zt(o)?al:i;return h(o)}function BC(o,h,p){(p?Qi(o,h,p):h===s)?h=1:h=Gt(h);var y=zt(o)?np:r;return y(o,h)}function kC(o){var h=zt(o)?sp:m;return h(o)}function LC(o){if(o==null)return 0;if(hn(o))return Qc(o)?_i(o):o.length;var h=zi(o);return h==Oi||h==ne?o.size:Hh(o).length}function MC(o,h,p){var y=zt(o)?rr:C;return p&&Qi(o,h,p)&&(h=s),y(o,Pt(h,3))}var OC=t(function(o,h){if(o==null)return[];var p=h.length;return p>1&&Qi(o,h[0],h[1])?h=[]:p>2&&Qi(h[0],h[1],h[2])&&(h=[h[0]]),Gh(o,li(h,1),[])}),Vc=el||function(){return He.Date.now()};function NC(o,h){if(typeof h!="function")throw new Yi(_);return o=Gt(o),function(){if(--o<1)return h.apply(this,arguments)}}function hv(o,h,p){return h=p?s:h,h=o&&h==null?o.length:h,fr(o,D,s,s,s,s,h)}function uv(o,h){var p;if(typeof h!="function")throw new Yi(_);return o=Gt(o),function(){return--o>0&&(p=h.apply(this,arguments)),o<=1&&(h=s),p}}var Rp=t(function(o,h,p){var y=G;if(p.length){var S=Us(p,vl(Rp));y|=K}return fr(o,y,h,p,S)}),cv=t(function(o,h,p){var y=G|k;if(p.length){var S=Us(p,vl(cv));y|=K}return fr(h,y,o,p,S)});function dv(o,h,p){h=p?s:h;var y=fr(o,N,s,s,s,s,s,h);return y.placeholder=dv.placeholder,y}function fv(o,h,p){h=p?s:h;var y=fr(o,J,s,s,s,s,s,h);return y.placeholder=fv.placeholder,y}function pv(o,h,p){var y,S,F,O,X,Y,ht=0,ut=!1,dt=!1,wt=!0;if(typeof o!="function")throw new Yi(_);h=Qn(h)||0,De(p)&&(ut=!!p.leading,dt="maxWait"in p,F=dt?Oe(Qn(p.maxWait)||0,h):F,wt="trailing"in p?!!p.trailing:wt);function St(Xe){var xs=y,vr=S;return y=S=s,ht=Xe,O=o.apply(vr,xs),O}function It(Xe){return ht=Xe,X=qh(Qt,h),ut?St(Xe):O}function Vt(Xe){var xs=Xe-Y,vr=Xe-ht,Bv=h-xs;return dt?si(Bv,F-vr):Bv}function Dt(Xe){var xs=Xe-Y,vr=Xe-ht;return Y===s||xs>=h||xs<0||dt&&vr>=F}function Qt(){var Xe=Vc();if(Dt(Xe))return Kt(Xe);X=qh(Qt,Vt(Xe))}function Kt(Xe){return X=s,wt&&y?St(Xe):(y=S=s,O)}function Rn(){X!==s&&Ii(X),ht=0,y=Y=S=X=s}function qi(){return X===s?O:Kt(Vc())}function In(){var Xe=Vc(),xs=Dt(Xe);if(y=arguments,S=this,Y=Xe,xs){if(X===s)return It(Y);if(dt)return Ii(X),X=qh(Qt,h),St(Y)}return X===s&&(X=qh(Qt,h)),O}return In.cancel=Rn,In.flush=qi,In}var UC=t(function(o,h){return Bh(o,1,h)}),zC=t(function(o,h,p){return Bh(o,Qn(h)||0,p)});function HC(o){return fr(o,nt)}function Xc(o,h){if(typeof o!="function"||h!=null&&typeof h!="function")throw new Yi(_);var p=function(){var y=arguments,S=h?h.apply(this,y):y[0],F=p.cache;if(F.has(S))return F.get(S);var O=o.apply(this,y);return p.cache=F.set(S,O)||F,O};return p.cache=new(Xc.Cache||Wn),p}Xc.Cache=Wn;function $c(o){if(typeof o!="function")throw new Yi(_);return function(){var h=arguments;switch(h.length){case 0:return!o.call(this);case 1:return!o.call(this,h[0]);case 2:return!o.call(this,h[0],h[1]);case 3:return!o.call(this,h[0],h[1],h[2])}return!o.apply(this,h)}}function WC(o){return uv(2,o)}var jC=we(function(o,h){h=h.length==1&&zt(h[0])?Bt(h[0],gi(Pt())):Bt(li(h,1),gi(Pt()));var p=h.length;return t(function(y){for(var S=-1,F=si(y.length,p);++S<F;)y[S]=h[S].call(this,y[S]);return Ci(o,this,y)})}),Ip=t(function(o,h){var p=Us(h,vl(Ip));return fr(o,K,s,h,p)}),gv=t(function(o,h){var p=Us(h,vl(gv));return fr(o,ft,s,h,p)}),GC=pr(function(o,h){return fr(o,j,s,s,s,h)});function VC(o,h){if(typeof o!="function")throw new Yi(_);return h=h===s?h:Gt(h),t(o,h)}function XC(o,h){if(typeof o!="function")throw new Yi(_);return h=h==null?0:Oe(Gt(h),0),t(function(p){var y=p[h],S=_e(p,0,h);return y&&ti(S,y),Ci(o,this,S)})}function $C(o,h,p){var y=!0,S=!0;if(typeof o!="function")throw new Yi(_);return De(p)&&(y="leading"in p?!!p.leading:y,S="trailing"in p?!!p.trailing:S),pv(o,h,{leading:y,maxWait:h,trailing:S})}function YC(o){return hv(o,1)}function QC(o,h){return Ip(at(h),o)}function qC(){if(!arguments.length)return[];var o=arguments[0];return zt(o)?o:[o]}function ZC(o){return Pi(o,U)}function KC(o,h){return h=typeof h=="function"?h:s,Pi(o,U,h)}function JC(o){return Pi(o,R|U)}function tS(o,h){return h=typeof h=="function"?h:s,Pi(o,R|U,h)}function eS(o,h){return h==null||Fh(o,h,yi(h))}function ws(o,h){return o===h||o!==o&&h!==h}var iS=Uc(cl),nS=Uc(function(o,h){return o>=h}),na=Rc(function(){return arguments}())?Rc:function(o){return Ne(o)&&se.call(o,"callee")&&!zs.call(o,"callee")},zt=tt.isArray,sS=sc?gi(sc):up;function hn(o){return o!=null&&Yc(o.length)&&!_r(o)}function Ve(o){return Ne(o)&&hn(o)}function rS(o){return o===!0||o===!1||Ne(o)&&Ri(o)==ns}var qr=nl||Hp,oS=Os?gi(Os):cp;function aS(o){return Ne(o)&&o.nodeType===1&&!Zh(o)}function lS(o){if(o==null)return!0;if(hn(o)&&(zt(o)||typeof o=="string"||typeof o.splice=="function"||qr(o)||yl(o)||na(o)))return!o.length;var h=zi(o);if(h==Oi||h==ne)return!o.size;if(Qh(o))return!Hh(o).length;for(var p in o)if(se.call(o,p))return!1;return!0}function hS(o,h){return Ko(o,h)}function uS(o,h,p){p=typeof p=="function"?p:s;var y=p?p(o,h):s;return y===s?Ko(o,h,s,p):!!y}function Dp(o){if(!Ne(o))return!1;var h=Ri(o);return h==ie||h==$t||typeof o.message=="string"&&typeof o.name=="string"&&!Zh(o)}function cS(o){return typeof o=="number"&&Eh(o)}function _r(o){if(!De(o))return!1;var h=Ri(o);return h==Je||h==ss||h==Is||h==Ce}function _v(o){return typeof o=="number"&&o==Gt(o)}function Yc(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=vt}function De(o){var h=typeof o;return o!=null&&(h=="object"||h=="function")}function Ne(o){return o!=null&&typeof o=="object"}var mv=yh?gi(yh):fp;function dS(o,h){return o===h||Nh(o,h,xp(h))}function fS(o,h,p){return p=typeof p=="function"?p:s,Nh(o,h,xp(h),p)}function pS(o){return vv(o)&&o!=+o}function gS(o){if(K1(o))throw new Ot(d);return Jo(o)}function _S(o){return o===null}function mS(o){return o==null}function vv(o){return typeof o=="number"||Ne(o)&&Ri(o)==oe}function Zh(o){if(!Ne(o)||Ri(o)!=ae)return!1;var h=ps(o);if(h===null)return!0;var p=se.call(h,"constructor")&&h.constructor;return typeof p=="function"&&p instanceof p&&Ho.call(p)==Wo}var Fp=wh?gi(wh):Uh;function vS(o){return _v(o)&&o>=-vt&&o<=vt}var yv=Mt?gi(Mt):Ic;function Qc(o){return typeof o=="string"||!zt(o)&&Ne(o)&&Ri(o)==ve}function Pn(o){return typeof o=="symbol"||Ne(o)&&Ri(o)==rs}var yl=Me?gi(Me):pp;function yS(o){return o===s}function wS(o){return Ne(o)&&zi(o)==yn}function xS(o){return Ne(o)&&Ri(o)==If}var bS=Uc(dl),CS=Uc(function(o,h){return o<=h});function wv(o){if(!o)return[];if(hn(o))return Qc(o)?bn(o):Bi(o);if(Or&&o[Or])return Lt(o[Or]());var h=zi(o),p=h==Oi?Sh:h==ne?Qa:wl;return p(o)}function mr(o){if(!o)return o===0?o:0;if(o=Qn(o),o===Ke||o===-Ke){var h=o<0?-1:1;return h*Tt}return o===o?o:0}function Gt(o){var h=mr(o),p=h%1;return h===h?p?h-p:h:0}function xv(o){return o?An(Gt(o),0,Yt):0}function Qn(o){if(typeof o=="number")return o;if(Pn(o))return Ft;if(De(o)){var h=typeof o.valueOf=="function"?o.valueOf():o;o=De(h)?h+"":h}if(typeof o!="string")return o===0?o:+o;o=pi(o);var p=Gf.test(o);return p||Se.test(o)?Qf(o.slice(2),p?2:8):Wt.test(o)?Ft:+o}function bv(o){return Tn(o,un(o))}function SS(o){return o?An(Gt(o),-vt,vt):o===0?o:0}function ue(o){return o==null?"":W(o)}var AS=Qr(function(o,h){if(Qh(h)||hn(h)){Tn(h,yi(h),o);return}for(var p in h)se.call(h,p)&&ai(o,p,h[p])}),Cv=Qr(function(o,h){Tn(h,un(h),o)}),qc=Qr(function(o,h,p,y){Tn(h,un(h),o,y)}),ES=Qr(function(o,h,p,y){Tn(h,yi(h),o,y)}),TS=pr(ll);function PS(o,h){var p=ur(o);return h==null?p:Ih(p,h)}var RS=t(function(o,h){o=he(o);var p=-1,y=h.length,S=y>2?h[2]:s;for(S&&Qi(h[0],h[1],S)&&(y=1);++p<y;)for(var F=h[p],O=un(F),X=-1,Y=O.length;++X<Y;){var ht=O[X],ut=o[ht];(ut===s||ws(ut,or[ht])&&!se.call(o,ht))&&(o[ht]=F[ht])}return o}),IS=t(function(o){return o.push(s,zm),Ci(Sv,s,o)});function DS(o,h){return ko(o,Pt(h,3),$n)}function FS(o,h){return ko(o,Pt(h,3),Mh)}function BS(o,h){return o==null?o:ul(o,Pt(h,3),un)}function kS(o,h){return o==null?o:Tc(o,Pt(h,3),un)}function LS(o,h){return o&&$n(o,Pt(h,3))}function MS(o,h){return o&&Mh(o,Pt(h,3))}function OS(o){return o==null?[]:En(o,yi(o))}function NS(o){return o==null?[]:En(o,un(o))}function Bp(o,h,p){var y=o==null?s:Ie(o,h);return y===s?p:y}function US(o,h){return o!=null&&jm(o,h,ap)}function kp(o,h){return o!=null&&jm(o,h,Oh)}var zS=Lm(function(o,h,p){h!=null&&typeof h.toString!="function"&&(h=Lr.call(h)),o[h]=p},Mp(cn)),HS=Lm(function(o,h,p){h!=null&&typeof h.toString!="function"&&(h=Lr.call(h)),se.call(o,h)?o[h].push(p):o[h]=[p]},Pt),WS=t(Zo);function yi(o){return hn(o)?Xr(o):Hh(o)}function un(o){return hn(o)?Xr(o,!0):gp(o)}function jS(o,h){var p={};return h=Pt(h,3),$n(o,function(y,S,F){Xn(p,h(y,S,F),y)}),p}function GS(o,h){var p={};return h=Pt(h,3),$n(o,function(y,S,F){Xn(p,S,h(y,S,F))}),p}var VS=Qr(function(o,h,p){pl(o,h,p)}),Sv=Qr(function(o,h,p,y){pl(o,h,p,y)}),XS=pr(function(o,h){var p={};if(o==null)return p;var y=!1;h=Bt(h,function(F){return F=Rt(F,o),y||(y=F.length>1),F}),Tn(o,yp(o),p),y&&(p=Pi(p,R|L|U,z1));for(var S=h.length;S--;)st(p,h[S]);return p});function $S(o,h){return Av(o,$c(Pt(h)))}var YS=pr(function(o,h){return o==null?{}:Yr(o,h)});function Av(o,h){if(o==null)return{};var p=Bt(yp(o),function(y){return[y]});return h=Pt(h),Fc(o,p,function(y,S){return h(y,S[0])})}function QS(o,h,p){h=Rt(h,o);var y=-1,S=h.length;for(S||(S=1,o=s);++y<S;){var F=o==null?s:o[$s(h[y])];F===s&&(y=S,F=p),o=_r(F)?F.call(o):F}return o}function qS(o,h,p){return o==null?o:l(o,h,p)}function ZS(o,h,p,y){return y=typeof y=="function"?y:s,o==null?o:l(o,h,p,y)}var Ev=Nm(yi),Tv=Nm(un);function KS(o,h,p){var y=zt(o),S=y||qr(o)||yl(o);if(h=Pt(h,4),p==null){var F=o&&o.constructor;S?p=y?new F:[]:De(o)?p=_r(F)?ur(ps(o)):{}:p={}}return(S?Ye:$n)(o,function(O,X,Y){return h(p,O,X,Y)}),p}function JS(o,h){return o==null?!0:st(o,h)}function tA(o,h,p){return o==null?o:q(o,h,at(p))}function eA(o,h,p,y){return y=typeof y=="function"?y:s,o==null?o:q(o,h,at(p),y)}function wl(o){return o==null?[]:rn(o,yi(o))}function iA(o){return o==null?[]:rn(o,un(o))}function nA(o,h,p){return p===s&&(p=h,h=s),p!==s&&(p=Qn(p),p=p===p?p:0),h!==s&&(h=Qn(h),h=h===h?h:0),An(Qn(o),h,p)}function sA(o,h,p){return h=mr(h),p===s?(p=h,h=0):p=mr(p),o=Qn(o),lp(o,h,p)}function rA(o,h,p){if(p&&typeof p!="boolean"&&Qi(o,h,p)&&(h=p=s),p===s&&(typeof h=="boolean"?(p=h,h=s):typeof o=="boolean"&&(p=o,o=s)),o===s&&h===s?(o=0,h=1):(o=mr(o),h===s?(h=o,o=0):h=mr(h)),o>h){var y=o;o=h,h=y}if(p||o%1||h%1){var S=gc();return si(o+S*(h-o+nc("1e-"+((S+"").length-1))),h)}return Xh(o,h)}var oA=ml(function(o,h,p){return h=h.toLowerCase(),o+(p?Pv(h):h)});function Pv(o){return Lp(ue(o).toLowerCase())}function Rv(o){return o=ue(o),o&&o.replace(Pa,Ni).replace(ch,"")}function aA(o,h,p){o=ue(o),h=W(h);var y=o.length;p=p===s?y:An(Gt(p),0,y);var S=p;return p-=h.length,p>=0&&o.slice(p,S)==h}function lA(o){return o=ue(o),o&&Ff.test(o)?o.replace(Zu,je):o}function hA(o){return o=ue(o),o&&Of.test(o)?o.replace(ih,"\\$&"):o}var uA=ml(function(o,h,p){return o+(p?"-":"")+h.toLowerCase()}),cA=ml(function(o,h,p){return o+(p?" ":"")+h.toLowerCase()}),dA=Fm("toLowerCase");function fA(o,h,p){o=ue(o),h=Gt(h);var y=h?_i(o):0;if(!h||y>=h)return o;var S=(h-y)/2;return Nc(Vo(S),p)+o+Nc(Go(S),p)}function pA(o,h,p){o=ue(o),h=Gt(h);var y=h?_i(o):0;return h&&y<h?o+Nc(h-y,p):o}function gA(o,h,p){o=ue(o),h=Gt(h);var y=h?_i(o):0;return h&&y<h?Nc(h-y,p)+o:o}function _A(o,h,p){return p||h==null?h=0:h&&(h=+h),pc(ue(o).replace(nh,""),h||0)}function mA(o,h,p){return(p?Qi(o,h,p):h===s)?h=1:h=Gt(h),f(ue(o),h)}function vA(){var o=arguments,h=ue(o[0]);return o.length<3?h:h.replace(o[1],o[2])}var yA=ml(function(o,h,p){return o+(p?"_":"")+h.toLowerCase()});function wA(o,h,p){return p&&typeof p!="number"&&Qi(o,h,p)&&(h=p=s),p=p===s?Yt:p>>>0,p?(o=ue(o),o&&(typeof h=="string"||h!=null&&!Fp(h))&&(h=W(h),!h&&de(o))?_e(bn(o),0,p):o.split(h,p)):[]}var xA=ml(function(o,h,p){return o+(p?" ":"")+Lp(h)});function bA(o,h,p){return o=ue(o),p=p==null?0:An(Gt(p),0,o.length),h=W(h),o.slice(p,p+h.length)==h}function CA(o,h,p){var y=P.templateSettings;p&&Qi(o,h,p)&&(h=s),o=ue(o),h=qc({},h,y,Um);var S=qc({},h.imports,y.imports,Um),F=yi(S),O=rn(S,F),X,Y,ht=0,ut=h.interpolate||Ae,dt="__p += '",wt=Za((h.escape||Ae).source+"|"+ut.source+"|"+(ut===Ku?tc:Ae).source+"|"+(h.evaluate||Ae).source+"|$","g"),St="//# sourceURL="+(se.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++_h+"]")+`
`;o.replace(wt,function(Dt,Qt,Kt,Rn,qi,In){return Kt||(Kt=Rn),dt+=o.slice(ht,In).replace(rh,qe),Qt&&(X=!0,dt+=`' +
__e(`+Qt+`) +
'`),qi&&(Y=!0,dt+=`';
`+qi+`;
__p += '`),Kt&&(dt+=`' +
((__t = (`+Kt+`)) == null ? '' : __t) +
'`),ht=In+Dt.length,Dt}),dt+=`';
`;var It=se.call(h,"variable")&&h.variable;if(!It)dt=`with (obj) {
`+dt+`
}
`;else if(Wf.test(It))throw new Ot(v);dt=(Y?dt.replace(os,""):dt).replace(as,"$1").replace(ye,"$1;"),dt="function("+(It||"obj")+`) {
`+(It?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(X?", __e = _.escape":"")+(Y?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+dt+`return __p
}`;var Vt=Dv(function(){return Jt(F,St+"return "+dt).apply(s,O)});if(Vt.source=dt,Dp(Vt))throw Vt;return Vt}function SA(o){return ue(o).toLowerCase()}function AA(o){return ue(o).toUpperCase()}function EA(o,h,p){if(o=ue(o),o&&(p||h===s))return pi(o);if(!o||!(h=W(h)))return o;var y=bn(o),S=bn(h),F=Ns(y,S),O=Ya(y,S)+1;return _e(y,F,O).join("")}function TA(o,h,p){if(o=ue(o),o&&(p||h===s))return o.slice(0,Cn(o)+1);if(!o||!(h=W(h)))return o;var y=bn(o),S=Ya(y,bn(h))+1;return _e(y,0,S).join("")}function PA(o,h,p){if(o=ue(o),o&&(p||h===s))return o.replace(nh,"");if(!o||!(h=W(h)))return o;var y=bn(o),S=Ns(y,bn(h));return _e(y,S).join("")}function RA(o,h){var p=bt,y=Et;if(De(h)){var S="separator"in h?h.separator:S;p="length"in h?Gt(h.length):p,y="omission"in h?W(h.omission):y}o=ue(o);var F=o.length;if(de(o)){var O=bn(o);F=O.length}if(p>=F)return o;var X=p-_i(y);if(X<1)return y;var Y=O?_e(O,0,X).join(""):o.slice(0,X);if(S===s)return Y+y;if(O&&(X+=Y.length-X),Fp(S)){if(o.slice(X).search(S)){var ht,ut=Y;for(S.global||(S=Za(S.source,ue(sh.exec(S))+"g")),S.lastIndex=0;ht=S.exec(ut);)var dt=ht.index;Y=Y.slice(0,dt===s?X:dt)}}else if(o.indexOf(W(S),X)!=X){var wt=Y.lastIndexOf(S);wt>-1&&(Y=Y.slice(0,wt))}return Y+y}function IA(o){return o=ue(o),o&&Df.test(o)?o.replace(qu,kr):o}var DA=ml(function(o,h,p){return o+(p?" ":"")+h.toUpperCase()}),Lp=Fm("toUpperCase");function Iv(o,h,p){return o=ue(o),h=p?s:h,h===s?Si(o)?No(o):ds(o):o.match(h)||[]}var Dv=t(function(o,h){try{return Ci(o,s,h)}catch(p){return Dp(p)?p:new Ot(p)}}),FA=pr(function(o,h){return Ye(h,function(p){p=$s(p),Xn(o,p,Rp(o[p],o))}),o});function BA(o){var h=o==null?0:o.length,p=Pt();return o=h?Bt(o,function(y){if(typeof y[1]!="function")throw new Yi(_);return[p(y[0]),y[1]]}):[],t(function(y){for(var S=-1;++S<h;){var F=o[S];if(Ci(F[0],this,y))return Ci(F[1],this,y)}})}function kA(o){return Dh(Pi(o,R))}function Mp(o){return function(){return o}}function LA(o,h){return o==null||o!==o?h:o}var MA=km(),OA=km(!0);function cn(o){return o}function Op(o){return zh(typeof o=="function"?o:Pi(o,R))}function NA(o){return fl(Pi(o,R))}function UA(o,h){return Dc(o,Pi(h,R))}var zA=t(function(o,h){return function(p){return Zo(p,o,h)}}),HA=t(function(o,h){return function(p){return Zo(o,p,h)}});function Np(o,h,p){var y=yi(h),S=En(h,y);p==null&&!(De(h)&&(S.length||!y.length))&&(p=h,h=o,o=this,S=En(h,yi(h)));var F=!(De(p)&&"chain"in p)||!!p.chain,O=_r(o);return Ye(S,function(X){var Y=h[X];o[X]=Y,O&&(o.prototype[X]=function(){var ht=this.__chain__;if(F||ht){var ut=o(this.__wrapped__),dt=ut.__actions__=Bi(this.__actions__);return dt.push({func:Y,args:arguments,thisArg:o}),ut.__chain__=ht,ut}return Y.apply(o,ti([this.value()],arguments))})}),o}function WA(){return He._===this&&(He._=Mr),this}function Up(){}function jA(o){return o=Gt(o),t(function(h){return gl(h,o)})}var GA=_p(Bt),VA=_p(oc),XA=_p(rr);function Fv(o){return Cp(o)?fs($s(o)):_l(o)}function $A(o){return function(h){return o==null?s:Ie(o,h)}}var YA=Mm(),QA=Mm(!0);function zp(){return[]}function Hp(){return!1}function qA(){return{}}function ZA(){return""}function KA(){return!0}function JA(o,h){if(o=Gt(o),o<1||o>vt)return[];var p=Yt,y=si(o,Yt);h=Pt(h),o-=Yt;for(var S=Mo(y,h);++p<o;)h(p);return S}function tE(o){return zt(o)?Bt(o,$s):Pn(o)?[o]:Bi(Km(ue(o)))}function eE(o){var h=++cc;return ue(o)+h}var iE=Oc(function(o,h){return o+h},0),nE=mp("ceil"),sE=Oc(function(o,h){return o/h},1),rE=mp("floor");function oE(o){return o&&o.length?qo(o,cn,cl):s}function aE(o,h){return o&&o.length?qo(o,Pt(h,2),cl):s}function lE(o){return kt(o,cn)}function hE(o,h){return kt(o,Pt(h,2))}function uE(o){return o&&o.length?qo(o,cn,dl):s}function cE(o,h){return o&&o.length?qo(o,Pt(h,2),dl):s}var dE=Oc(function(o,h){return o*h},1),fE=mp("round"),pE=Oc(function(o,h){return o-h},0);function gE(o){return o&&o.length?sn(o,cn):0}function _E(o,h){return o&&o.length?sn(o,Pt(h,2)):0}return P.after=NC,P.ary=hv,P.assign=AS,P.assignIn=Cv,P.assignInWith=qc,P.assignWith=ES,P.at=TS,P.before=uv,P.bind=Rp,P.bindAll=FA,P.bindKey=cv,P.castArray=qC,P.chain=ov,P.chunk=rb,P.compact=ob,P.concat=ab,P.cond=BA,P.conforms=kA,P.constant=Mp,P.countBy=gC,P.create=PS,P.curry=dv,P.curryRight=fv,P.debounce=pv,P.defaults=RS,P.defaultsDeep=IS,P.defer=UC,P.delay=zC,P.difference=lb,P.differenceBy=hb,P.differenceWith=ub,P.drop=cb,P.dropRight=db,P.dropRightWhile=fb,P.dropWhile=pb,P.fill=gb,P.filter=mC,P.flatMap=wC,P.flatMapDeep=xC,P.flatMapDepth=bC,P.flatten=iv,P.flattenDeep=_b,P.flattenDepth=mb,P.flip=HC,P.flow=MA,P.flowRight=OA,P.fromPairs=vb,P.functions=OS,P.functionsIn=NS,P.groupBy=CC,P.initial=wb,P.intersection=xb,P.intersectionBy=bb,P.intersectionWith=Cb,P.invert=zS,P.invertBy=HS,P.invokeMap=AC,P.iteratee=Op,P.keyBy=EC,P.keys=yi,P.keysIn=un,P.map=Gc,P.mapKeys=jS,P.mapValues=GS,P.matches=NA,P.matchesProperty=UA,P.memoize=Xc,P.merge=VS,P.mergeWith=Sv,P.method=zA,P.methodOf=HA,P.mixin=Np,P.negate=$c,P.nthArg=jA,P.omit=XS,P.omitBy=$S,P.once=WC,P.orderBy=TC,P.over=GA,P.overArgs=jC,P.overEvery=VA,P.overSome=XA,P.partial=Ip,P.partialRight=gv,P.partition=PC,P.pick=YS,P.pickBy=Av,P.property=Fv,P.propertyOf=$A,P.pull=Tb,P.pullAll=sv,P.pullAllBy=Pb,P.pullAllWith=Rb,P.pullAt=Ib,P.range=YA,P.rangeRight=QA,P.rearg=GC,P.reject=DC,P.remove=Db,P.rest=VC,P.reverse=Tp,P.sampleSize=BC,P.set=qS,P.setWith=ZS,P.shuffle=kC,P.slice=Fb,P.sortBy=OC,P.sortedUniq=Ub,P.sortedUniqBy=zb,P.split=wA,P.spread=XC,P.tail=Hb,P.take=Wb,P.takeRight=jb,P.takeRightWhile=Gb,P.takeWhile=Vb,P.tap=oC,P.throttle=$C,P.thru=jc,P.toArray=wv,P.toPairs=Ev,P.toPairsIn=Tv,P.toPath=tE,P.toPlainObject=bv,P.transform=KS,P.unary=YC,P.union=Xb,P.unionBy=$b,P.unionWith=Yb,P.uniq=Qb,P.uniqBy=qb,P.uniqWith=Zb,P.unset=JS,P.unzip=Pp,P.unzipWith=rv,P.update=tA,P.updateWith=eA,P.values=wl,P.valuesIn=iA,P.without=Kb,P.words=Iv,P.wrap=QC,P.xor=Jb,P.xorBy=tC,P.xorWith=eC,P.zip=iC,P.zipObject=nC,P.zipObjectDeep=sC,P.zipWith=rC,P.entries=Ev,P.entriesIn=Tv,P.extend=Cv,P.extendWith=qc,Np(P,P),P.add=iE,P.attempt=Dv,P.camelCase=oA,P.capitalize=Pv,P.ceil=nE,P.clamp=nA,P.clone=ZC,P.cloneDeep=JC,P.cloneDeepWith=tS,P.cloneWith=KC,P.conformsTo=eS,P.deburr=Rv,P.defaultTo=LA,P.divide=sE,P.endsWith=aA,P.eq=ws,P.escape=lA,P.escapeRegExp=hA,P.every=_C,P.find=vC,P.findIndex=tv,P.findKey=DS,P.findLast=yC,P.findLastIndex=ev,P.findLastKey=FS,P.floor=rE,P.forEach=av,P.forEachRight=lv,P.forIn=BS,P.forInRight=kS,P.forOwn=LS,P.forOwnRight=MS,P.get=Bp,P.gt=iS,P.gte=nS,P.has=US,P.hasIn=kp,P.head=nv,P.identity=cn,P.includes=SC,P.indexOf=yb,P.inRange=sA,P.invoke=WS,P.isArguments=na,P.isArray=zt,P.isArrayBuffer=sS,P.isArrayLike=hn,P.isArrayLikeObject=Ve,P.isBoolean=rS,P.isBuffer=qr,P.isDate=oS,P.isElement=aS,P.isEmpty=lS,P.isEqual=hS,P.isEqualWith=uS,P.isError=Dp,P.isFinite=cS,P.isFunction=_r,P.isInteger=_v,P.isLength=Yc,P.isMap=mv,P.isMatch=dS,P.isMatchWith=fS,P.isNaN=pS,P.isNative=gS,P.isNil=mS,P.isNull=_S,P.isNumber=vv,P.isObject=De,P.isObjectLike=Ne,P.isPlainObject=Zh,P.isRegExp=Fp,P.isSafeInteger=vS,P.isSet=yv,P.isString=Qc,P.isSymbol=Pn,P.isTypedArray=yl,P.isUndefined=yS,P.isWeakMap=wS,P.isWeakSet=xS,P.join=Sb,P.kebabCase=uA,P.last=Yn,P.lastIndexOf=Ab,P.lowerCase=cA,P.lowerFirst=dA,P.lt=bS,P.lte=CS,P.max=oE,P.maxBy=aE,P.mean=lE,P.meanBy=hE,P.min=uE,P.minBy=cE,P.stubArray=zp,P.stubFalse=Hp,P.stubObject=qA,P.stubString=ZA,P.stubTrue=KA,P.multiply=dE,P.nth=Eb,P.noConflict=WA,P.noop=Up,P.now=Vc,P.pad=fA,P.padEnd=pA,P.padStart=gA,P.parseInt=_A,P.random=rA,P.reduce=RC,P.reduceRight=IC,P.repeat=mA,P.replace=vA,P.result=QS,P.round=fE,P.runInContext=V,P.sample=FC,P.size=LC,P.snakeCase=yA,P.some=MC,P.sortedIndex=Bb,P.sortedIndexBy=kb,P.sortedIndexOf=Lb,P.sortedLastIndex=Mb,P.sortedLastIndexBy=Ob,P.sortedLastIndexOf=Nb,P.startCase=xA,P.startsWith=bA,P.subtract=pE,P.sum=gE,P.sumBy=_E,P.template=CA,P.times=JA,P.toFinite=mr,P.toInteger=Gt,P.toLength=xv,P.toLower=SA,P.toNumber=Qn,P.toSafeInteger=SS,P.toString=ue,P.toUpper=AA,P.trim=EA,P.trimEnd=TA,P.trimStart=PA,P.truncate=RA,P.unescape=IA,P.uniqueId=eE,P.upperCase=DA,P.upperFirst=Lp,P.each=av,P.eachRight=lv,P.first=nv,Np(P,function(){var o={};return $n(P,function(h,p){se.call(P.prototype,p)||(o[p]=h)}),o}(),{chain:!1}),P.VERSION=a,Ye(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){P[o].placeholder=P}),Ye(["drop","take"],function(o,h){jt.prototype[o]=function(p){p=p===s?1:Oe(Gt(p),0);var y=this.__filtered__&&!h?new jt(this):this.clone();return y.__filtered__?y.__takeCount__=si(p,y.__takeCount__):y.__views__.push({size:si(p,Yt),type:o+(y.__dir__<0?"Right":"")}),y},jt.prototype[o+"Right"]=function(p){return this.reverse()[o](p).reverse()}}),Ye(["filter","map","takeWhile"],function(o,h){var p=h+1,y=p==Le||p==mt;jt.prototype[o]=function(S){var F=this.clone();return F.__iteratees__.push({iteratee:Pt(S,3),type:p}),F.__filtered__=F.__filtered__||y,F}}),Ye(["head","last"],function(o,h){var p="take"+(h?"Right":"");jt.prototype[o]=function(){return this[p](1).value()[0]}}),Ye(["initial","tail"],function(o,h){var p="drop"+(h?"":"Right");jt.prototype[o]=function(){return this.__filtered__?new jt(this):this[p](1)}}),jt.prototype.compact=function(){return this.filter(cn)},jt.prototype.find=function(o){return this.filter(o).head()},jt.prototype.findLast=function(o){return this.reverse().find(o)},jt.prototype.invokeMap=t(function(o,h){return typeof o=="function"?new jt(this):this.map(function(p){return Zo(p,o,h)})}),jt.prototype.reject=function(o){return this.filter($c(Pt(o)))},jt.prototype.slice=function(o,h){o=Gt(o);var p=this;return p.__filtered__&&(o>0||h<0)?new jt(p):(o<0?p=p.takeRight(-o):o&&(p=p.drop(o)),h!==s&&(h=Gt(h),p=h<0?p.dropRight(-h):p.take(h-o)),p)},jt.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},jt.prototype.toArray=function(){return this.take(Yt)},$n(jt.prototype,function(o,h){var p=/^(?:filter|find|map|reject)|While$/.test(h),y=/^(?:head|last)$/.test(h),S=P[y?"take"+(h=="last"?"Right":""):h],F=y||/^find/.test(h);S&&(P.prototype[h]=function(){var O=this.__wrapped__,X=y?[1]:arguments,Y=O instanceof jt,ht=X[0],ut=Y||zt(O),dt=function(Qt){var Kt=S.apply(P,ti([Qt],X));return y&&wt?Kt[0]:Kt};ut&&p&&typeof ht=="function"&&ht.length!=1&&(Y=ut=!1);var wt=this.__chain__,St=!!this.__actions__.length,It=F&&!wt,Vt=Y&&!St;if(!F&&ut){O=Vt?O:new jt(this);var Dt=o.apply(O,X);return Dt.__actions__.push({func:jc,args:[dt],thisArg:s}),new on(Dt,wt)}return It&&Vt?o.apply(this,X):(Dt=this.thru(dt),It?y?Dt.value()[0]:Dt.value():Dt)})}),Ye(["pop","push","shift","sort","splice","unshift"],function(o){var h=Uo[o],p=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",y=/^(?:pop|shift)$/.test(o);P.prototype[o]=function(){var S=arguments;if(y&&!this.__chain__){var F=this.value();return h.apply(zt(F)?F:[],S)}return this[p](function(O){return h.apply(zt(O)?O:[],S)})}}),$n(jt.prototype,function(o,h){var p=P[h];if(p){var y=p.name+"";se.call(hr,y)||(hr[y]=[]),hr[y].push({name:h,func:p})}}),hr[Mc(s,k).name]=[{name:"wrapper",func:s}],jt.prototype.clone=Hr,jt.prototype.reverse=wc,jt.prototype.value=tp,P.prototype.at=aC,P.prototype.chain=lC,P.prototype.commit=hC,P.prototype.next=uC,P.prototype.plant=dC,P.prototype.reverse=fC,P.prototype.toJSON=P.prototype.valueOf=P.prototype.value=pC,P.prototype.first=P.prototype.head,Or&&(P.prototype[Or]=cC),P},Ai=qa();sr?((sr.exports=Ai)._=Ai,mh._=Ai):He._=Ai}).call(Kh)})(sf,sf.exports);var iD=sf.exports;function nD(){var ns,Ds;const{sessionData:e}=zu(),n=Number(e.userData.energyLimit.Value),s=Number(e.userData.tapValue.Value),a=Number(e.userData.refill.Value),u=Number(e.userData.tapUpgradeCost.Value),d=Number(e.userData.energyLimitUpgradeCost.Value),_=6e3,v=lt.useContext(Rm),{setData:x}=zu(),[b,E]=lt.useState(!1),[R,L]=lt.useState(!1),[U]=lt.useState(_),[H,$]=lt.useState(Number(e.userData.coins.Value)),[G,k]=lt.useState(s),[B,N]=lt.useState(n),[J,K]=lt.useState(B),[ft,D]=lt.useState(B),[j,nt]=lt.useState(a),[bt,Et]=lt.useState(u),[gt,Pe]=lt.useState(d),[Le,Xt]=lt.useState([]),mt=H<bt,Ke=H<gt,vt=ft==0||J>=B,Tt=vt?j==6||J>=B?"Energy Full":`${j}/6`:`${j}/6`,Ft=lt.useCallback(iD.debounce($t=>{console.log("Sending request with updated coins:",$t),x("coins",$t)},2e3),[]),Yt=()=>{E($t=>!$t)},pe=()=>{L($t=>!$t)},is=$t=>{Xt(ie=>ie.filter(Je=>Je.id!==$t))},Vi=($t,ie)=>{J>=G&&($(Je=>{const ss=Je+G;return Ft(ss),ss}),K(Je=>Je-G),Xt(Je=>[...Je,{id:Date.now(),value:G,x:$t,y:ie}]))},ge=()=>{J<B&&(nt($t=>{const ie=$t-1;return x("refill",ie),ie}),K($t=>$t+B),D($t=>$t-1))},Zt=()=>{H>=gt&&(N($t=>{const ie=$t+1e3;return x("energyLimit",ie),ie}),Pe($t=>{const ie=$t*2;return x("energyUpgradeCost",ie),ie}))},Is=()=>{H>=bt&&k($t=>{const ie=$t+1;return $(Je=>{const ss=Je-bt;return localStorage.setItem("coins",JSON.stringify(ss)),Et(Oi=>{const oe=Oi*2;return x({tapUpgradeCost:oe,tapValue:ie,coins:ss}),oe}),ss}),ie})};return lt.useEffect(()=>{const $t=Math.floor(_/3600),ie=setInterval(()=>{$(Je=>Je+$t)},1e3);return()=>clearInterval(ie)},[_]),ct.jsxs("div",{className:"flex flex-1 grow flex-col justify-between text-white",children:[ct.jsx(fR,{score:H}),ct.jsxs("section",{className:"align-center mb-2 flex justify-center gap-3 px-2",children:[ct.jsxs("div",{className:"flip-container flex grow-[5] rounded-md bg-violet-200 px-2",children:[ct.jsxs("div",{className:`flip-card-inner flex grow justify-end ${b?"flipped":""}`,children:[ct.jsx("div",{className:"flip-card-front w-100 flex grow items-center justify-center",children:ct.jsx(mR,{energy:J,limit:B})}),ct.jsxs("div",{className:"flip-card-back flex grow justify-around py-1 pr-2",children:[ct.jsx(pg,{addClass:"flex-1",caption:Tt,onClick:ge,disabled:vt,children:"Refill"}),ct.jsx(pg,{caption:`${gt} pts to Upgrade`,onClick:Zt,disabled:Ke,children:"Upgrade Limit"})]})]}),ct.jsx("button",{onClick:Yt,children:ct.jsx(hy,{})})]}),ct.jsxs("div",{className:"flip-container flex grow-[3] rounded-md bg-violet-200 px-2",children:[ct.jsxs("div",{className:`flip-card-inner flex grow items-center justify-end ${R?"flipped":""}`,children:[ct.jsxs("div",{className:"flip-card-front flex grow items-center justify-center",children:[ct.jsx(eD,{})," +",G]}),ct.jsx("div",{className:"flip-card-back flex grow justify-around py-1 pr-2",children:ct.jsx(pg,{caption:`${bt} pts to Upgrade`,onClick:Is,disabled:mt,children:"Upgrade Tap"})})]}),ct.jsx("button",{onClick:pe,children:ct.jsx(hy,{})})]})]}),ct.jsx(dR,{onTap:Vi,children:Le.map($t=>ct.jsx(pR,{number:$t.value,x:$t.x,y:$t.y,onAnimationEnd:()=>is($t.id)},$t.id))}),ct.jsxs("section",{className:"flex flex-row justify-between px-3 pb-3",children:[ct.jsxs("div",{className:"level-progress",children:[ct.jsx("div",{className:"text-md font-bold",children:((Ds=(ns=v==null?void 0:v.tgData)==null?void 0:ns.initDataUnsafe)==null?void 0:Ds.user.username)??"Guest"}),ct.jsx($I,{coins:H})]}),ct.jsx(vR,{token:U})]})]})}/*!
 * excalibur - 0.29.3 - 2024-5-5
 * https://github.com/excaliburjs/Excalibur
 * Copyright (c) 2024 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>
 * Licensed BSD-2-Clause
 * @preserve
 */var sD={8851:(e,n,s)=>{s.d(n,{A:()=>x});var a=s(2001),u=s.n(a),d=s(935),_=s.n(d),v=_()(u());v.push([e.id,`/* Buttons styles start */

button#excalibur-play {
  display: inline-block;
  position: relative;
  z-index: 999;
  border-radius: 6px;
  border: none;
  /*border: 3px solid;
    border-color: white;
    box-shadow: 0 0 10px #ccc;*/
  padding: 1rem 1.5rem 1rem 4rem;
  margin: 0;
  text-decoration: none;
  background: #00b233;
  color: #ffffff;
  font-family: sans-serif;
  font-size: 2rem;
  white-space: nowrap;
  line-height: 1;
  cursor: pointer;
  text-align: center;
  transition: background 250ms ease-in-out, transform 150ms ease;
  -webkit-appearance: none;
  -moz-appearance: none;

  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */
  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */
  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */
  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */
  animation: excalibur-button-fadein 200ms;
}

/*
button#excalibur-play {
  display: none;
}*/

button#excalibur-play:after {
  position: absolute;
  content: '';
  border: 8px solid;
  border-color: transparent transparent transparent white;
  left: 35px;
  top: 24px;
  width: 0;
  height: 0;
}

button#excalibur-play:before {
  position: absolute;
  content: '';
  border: 3px solid;
  left: 19px;
  top: 14px;
  border-radius: 20px;
  width: 30px;
  height: 30px;
}

button#excalibur-play:hover,
button#excalibur-play:focus {
  background: #00982c;
}

button#excalibur-play:focus {
  outline: 1px solid #fff;
  outline-offset: -4px;
}

button#excalibur-play:active {
  transform: scale(0.99);
}

@keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Firefox < 16 */
@-moz-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Safari, Chrome and Opera > 12.1 */
@-webkit-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Internet Explorer */
@-ms-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Opera < 12.1 */
@-o-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
`,"",{version:3,sources:["webpack://./Director/Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:[`/* Buttons styles start */\r
\r
button#excalibur-play {\r
  display: inline-block;\r
  position: relative;\r
  z-index: 999;\r
  border-radius: 6px;\r
  border: none;\r
  /*border: 3px solid;\r
    border-color: white;\r
    box-shadow: 0 0 10px #ccc;*/\r
  padding: 1rem 1.5rem 1rem 4rem;\r
  margin: 0;\r
  text-decoration: none;\r
  background: #00b233;\r
  color: #ffffff;\r
  font-family: sans-serif;\r
  font-size: 2rem;\r
  white-space: nowrap;\r
  line-height: 1;\r
  cursor: pointer;\r
  text-align: center;\r
  transition: background 250ms ease-in-out, transform 150ms ease;\r
  -webkit-appearance: none;\r
  -moz-appearance: none;\r
\r
  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r
  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r
  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r
  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r
  animation: excalibur-button-fadein 200ms;\r
}\r
\r
/*\r
button#excalibur-play {\r
  display: none;\r
}*/\r
\r
button#excalibur-play:after {\r
  position: absolute;\r
  content: '';\r
  border: 8px solid;\r
  border-color: transparent transparent transparent white;\r
  left: 35px;\r
  top: 24px;\r
  width: 0;\r
  height: 0;\r
}\r
\r
button#excalibur-play:before {\r
  position: absolute;\r
  content: '';\r
  border: 3px solid;\r
  left: 19px;\r
  top: 14px;\r
  border-radius: 20px;\r
  width: 30px;\r
  height: 30px;\r
}\r
\r
button#excalibur-play:hover,\r
button#excalibur-play:focus {\r
  background: #00982c;\r
}\r
\r
button#excalibur-play:focus {\r
  outline: 1px solid #fff;\r
  outline-offset: -4px;\r
}\r
\r
button#excalibur-play:active {\r
  transform: scale(0.99);\r
}\r
\r
@keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Firefox < 16 */\r
@-moz-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Safari, Chrome and Opera > 12.1 */\r
@-webkit-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Internet Explorer */\r
@-ms-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Opera < 12.1 */\r
@-o-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
`],sourceRoot:""}]);const x=v},4296:(e,n,s)=>{s.d(n,{A:()=>x});var a=s(2001),u=s.n(a),d=s(935),_=s.n(d),v=_()(u());v.push([e.id,`
#ex-toast-container {
  position: absolute;
  height: 0;
  min-width: 50%;
  left: 50%;
  top: 0;
}

.ex-toast-message {
  left: -50%;
  position: relative;
  display: flex;
  justify-content: space-between;


  padding: 10px;
  margin-top: 5px;
  font-size: 18px;
  font-family: sans-serif;
  border-radius: 6px;
  border: 3px solid #b7b779;
  background-color: rgb(253, 253, 192);
}


.ex-toast-message button {
  align-self: flex-start;
}`,"",{version:3,sources:["webpack://./Util/Toaster.css"],names:[],mappings:";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB",sourcesContent:[`\r
#ex-toast-container {\r
  position: absolute;\r
  height: 0;\r
  min-width: 50%;\r
  left: 50%;\r
  top: 0;\r
}\r
\r
.ex-toast-message {\r
  left: -50%;\r
  position: relative;\r
  display: flex;\r
  justify-content: space-between;\r
\r
\r
  padding: 10px;\r
  margin-top: 5px;\r
  font-size: 18px;\r
  font-family: sans-serif;\r
  border-radius: 6px;\r
  border: 3px solid #b7b779;\r
  background-color: rgb(253, 253, 192);\r
}\r
\r
\r
.ex-toast-message button {\r
  align-self: flex-start;\r
}`],sourceRoot:""}]);const x=v},935:e=>{e.exports=function(n){var s=[];return s.toString=function(){return this.map(function(u){var d="",_=typeof u[5]<"u";return u[4]&&(d+="@supports (".concat(u[4],") {")),u[2]&&(d+="@media ".concat(u[2]," {")),_&&(d+="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {")),d+=n(u),_&&(d+="}"),u[2]&&(d+="}"),u[4]&&(d+="}"),d}).join("")},s.i=function(u,d,_,v,x){typeof u=="string"&&(u=[[null,u,void 0]]);var b={};if(_)for(var E=0;E<this.length;E++){var R=this[E][0];R!=null&&(b[R]=!0)}for(var L=0;L<u.length;L++){var U=[].concat(u[L]);_&&b[U[0]]||(typeof x<"u"&&(typeof U[5]>"u"||(U[1]="@layer".concat(U[5].length>0?" ".concat(U[5]):""," {").concat(U[1],"}")),U[5]=x),d&&(U[2]&&(U[1]="@media ".concat(U[2]," {").concat(U[1],"}")),U[2]=d),v&&(U[4]?(U[1]="@supports (".concat(U[4],") {").concat(U[1],"}"),U[4]=v):U[4]="".concat(v)),s.push(U))}},s}},2001:e=>{e.exports=function(n){var s=n[1],a=n[3];if(!a)return s;if(typeof btoa=="function"){var u=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),d="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(u),_="/*# ".concat(d," */");return[s].concat([_]).join(`
`)}return[s].join(`
`)}},9493:(e,n,s)=>{s(3975);var a=s(2564);e.exports=a("Array","sort")},311:(e,n,s)=>{s(8291);var a=s(9120);e.exports=a.Object.keys},4977:(e,n,s)=>{var a=s(4188),u=s(3174),d=TypeError;e.exports=function(_){if(a(_))return _;throw new d(u(_)+" is not a function")}},3770:(e,n,s)=>{var a=s(831),u=String,d=TypeError;e.exports=function(_){if(a(_))return _;throw new d(u(_)+" is not an object")}},1458:(e,n,s)=>{var a=s(380),u=s(675),d=s(9389),_=function(v){return function(x,b,E){var R=a(x),L=d(R);if(L===0)return!v&&-1;var U=u(E,L),H;if(v&&b!==b){for(;L>U;)if(H=R[U++],H!==H)return!0}else for(;L>U;U++)if((v||U in R)&&R[U]===b)return v||U||0;return!v&&-1}};e.exports={includes:_(!0),indexOf:_(!1)}},5397:(e,n,s)=>{var a=s(5234);e.exports=function(u,d){var _=[][u];return!!_&&a(function(){_.call(null,d||function(){return 1},1)})}},7825:(e,n,s)=>{var a=s(6881);e.exports=a([].slice)},9295:(e,n,s)=>{var a=s(7825),u=Math.floor,d=function(_,v){var x=_.length;if(x<8)for(var b=1,E,R;b<x;){for(R=b,E=_[b];R&&v(_[R-1],E)>0;)_[R]=_[--R];R!==b++&&(_[R]=E)}else for(var L=u(x/2),U=d(a(_,0,L),v),H=d(a(_,L),v),$=U.length,G=H.length,k=0,B=0;k<$||B<G;)_[k+B]=k<$&&B<G?v(U[k],H[B])<=0?U[k++]:H[B++]:k<$?U[k++]:H[B++];return _};e.exports=d},8689:(e,n,s)=>{var a=s(6881),u=a({}.toString),d=a("".slice);e.exports=function(_){return d(u(_),8,-1)}},5438:(e,n,s)=>{var a=s(9345),u=s(4188),d=s(8689),_=s(4282),v=_("toStringTag"),x=Object,b=d(function(){return arguments}())==="Arguments",E=function(R,L){try{return R[L]}catch{}};e.exports=a?d:function(R){var L,U,H;return R===void 0?"Undefined":R===null?"Null":typeof(U=E(L=x(R),v))=="string"?U:b?d(L):(H=d(L))==="Object"&&u(L.callee)?"Arguments":H}},8657:(e,n,s)=>{var a=s(4418),u=s(3168),d=s(9304),_=s(4466);e.exports=function(v,x,b){for(var E=u(x),R=_.f,L=d.f,U=0;U<E.length;U++){var H=E[U];!a(v,H)&&!(b&&a(b,H))&&R(v,H,L(x,H))}}},8088:(e,n,s)=>{var a=s(6893),u=s(4466),d=s(9123);e.exports=a?function(_,v,x){return u.f(_,v,d(1,x))}:function(_,v,x){return _[v]=x,_}},9123:e=>{e.exports=function(n,s){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:s}}},7509:(e,n,s)=>{var a=s(4188),u=s(4466),d=s(4530),_=s(4798);e.exports=function(v,x,b,E){E||(E={});var R=E.enumerable,L=E.name!==void 0?E.name:x;if(a(b)&&d(b,L,E),E.global)R?v[x]=b:_(x,b);else{try{E.unsafe?v[x]&&(R=!0):delete v[x]}catch{}R?v[x]=b:u.f(v,x,{value:b,enumerable:!1,configurable:!E.nonConfigurable,writable:!E.nonWritable})}return v}},4798:(e,n,s)=>{var a=s(1488),u=Object.defineProperty;e.exports=function(d,_){try{u(a,d,{value:_,configurable:!0,writable:!0})}catch{a[d]=_}return _}},1305:(e,n,s)=>{var a=s(3174),u=TypeError;e.exports=function(d,_){if(!delete d[_])throw new u("Cannot delete property "+a(_)+" of "+a(d))}},6893:(e,n,s)=>{var a=s(5234);e.exports=!a(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},5926:(e,n,s)=>{var a=s(1488),u=s(831),d=a.document,_=u(d)&&u(d.createElement);e.exports=function(v){return _?d.createElement(v):{}}},8807:(e,n,s)=>{var a=s(4109),u=a.match(/firefox\/(\d+)/i);e.exports=!!u&&+u[1]},5661:(e,n,s)=>{var a=s(4109);e.exports=/MSIE|Trident/.test(a)},4109:e=>{e.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},3749:(e,n,s)=>{var a=s(1488),u=s(4109),d=a.process,_=a.Deno,v=d&&d.versions||_&&_.version,x=v&&v.v8,b,E;x&&(b=x.split("."),E=b[0]>0&&b[0]<4?1:+(b[0]+b[1])),!E&&u&&(b=u.match(/Edge\/(\d+)/),(!b||b[1]>=74)&&(b=u.match(/Chrome\/(\d+)/),b&&(E=+b[1]))),e.exports=E},3589:(e,n,s)=>{var a=s(4109),u=a.match(/AppleWebKit\/(\d+)\./);e.exports=!!u&&+u[1]},2564:(e,n,s)=>{var a=s(1488),u=s(6881);e.exports=function(d,_){return u(a[d].prototype[_])}},1274:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},5613:(e,n,s)=>{var a=s(1488),u=s(9304).f,d=s(8088),_=s(7509),v=s(4798),x=s(8657),b=s(8489);e.exports=function(E,R){var L=E.target,U=E.global,H=E.stat,$,G,k,B,N,J;if(U?G=a:H?G=a[L]||v(L,{}):G=a[L]&&a[L].prototype,G)for(k in R){if(N=R[k],E.dontCallGetSet?(J=u(G,k),B=J&&J.value):B=G[k],$=b(U?k:L+(H?".":"#")+k,E.forced),!$&&B!==void 0){if(typeof N==typeof B)continue;x(N,B)}(E.sham||B&&B.sham)&&d(N,"sham",!0),_(G,k,N,E)}}},5234:e=>{e.exports=function(n){try{return!!n()}catch{return!0}}},9055:(e,n,s)=>{var a=s(5234);e.exports=!a(function(){var u=(function(){}).bind();return typeof u!="function"||u.hasOwnProperty("prototype")})},9944:(e,n,s)=>{var a=s(9055),u=Function.prototype.call;e.exports=a?u.bind(u):function(){return u.apply(u,arguments)}},2735:(e,n,s)=>{var a=s(6893),u=s(4418),d=Function.prototype,_=a&&Object.getOwnPropertyDescriptor,v=u(d,"name"),x=v&&(function(){}).name==="something",b=v&&(!a||a&&_(d,"name").configurable);e.exports={EXISTS:v,PROPER:x,CONFIGURABLE:b}},6881:(e,n,s)=>{var a=s(9055),u=Function.prototype,d=u.call,_=a&&u.bind.bind(d,d);e.exports=a?_:function(v){return function(){return d.apply(v,arguments)}}},5604:(e,n,s)=>{var a=s(1488),u=s(4188),d=function(_){return u(_)?_:void 0};e.exports=function(_,v){return arguments.length<2?d(a[_]):a[_]&&a[_][v]}},2913:(e,n,s)=>{var a=s(4977),u=s(4318);e.exports=function(d,_){var v=d[_];return u(v)?void 0:a(v)}},1488:function(e,n,s){var a=function(u){return u&&u.Math===Math&&u};e.exports=a(typeof globalThis=="object"&&globalThis)||a(typeof window=="object"&&window)||a(typeof self=="object"&&self)||a(typeof s.g=="object"&&s.g)||a(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},4418:(e,n,s)=>{var a=s(6881),u=s(3628),d=a({}.hasOwnProperty);e.exports=Object.hasOwn||function(v,x){return d(u(v),x)}},7588:e=>{e.exports={}},9622:(e,n,s)=>{var a=s(6893),u=s(5234),d=s(5926);e.exports=!a&&!u(function(){return Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a!==7})},7568:(e,n,s)=>{var a=s(6881),u=s(5234),d=s(8689),_=Object,v=a("".split);e.exports=u(function(){return!_("z").propertyIsEnumerable(0)})?function(x){return d(x)==="String"?v(x,""):_(x)}:_},3029:(e,n,s)=>{var a=s(6881),u=s(4188),d=s(2694),_=a(Function.toString);u(d.inspectSource)||(d.inspectSource=function(v){return _(v)}),e.exports=d.inspectSource},3086:(e,n,s)=>{var a=s(5945),u=s(1488),d=s(831),_=s(8088),v=s(4418),x=s(2694),b=s(168),E=s(7588),R="Object already initialized",L=u.TypeError,U=u.WeakMap,H,$,G,k=function(K){return G(K)?$(K):H(K,{})},B=function(K){return function(ft){var D;if(!d(ft)||(D=$(ft)).type!==K)throw new L("Incompatible receiver, "+K+" required");return D}};if(a||x.state){var N=x.state||(x.state=new U);N.get=N.get,N.has=N.has,N.set=N.set,H=function(K,ft){if(N.has(K))throw new L(R);return ft.facade=K,N.set(K,ft),ft},$=function(K){return N.get(K)||{}},G=function(K){return N.has(K)}}else{var J=b("state");E[J]=!0,H=function(K,ft){if(v(K,J))throw new L(R);return ft.facade=K,_(K,J,ft),ft},$=function(K){return v(K,J)?K[J]:{}},G=function(K){return v(K,J)}}e.exports={set:H,get:$,has:G,enforce:k,getterFor:B}},4188:e=>{var n=typeof document=="object"&&document.all;e.exports=typeof n>"u"&&n!==void 0?function(s){return typeof s=="function"||s===n}:function(s){return typeof s=="function"}},8489:(e,n,s)=>{var a=s(5234),u=s(4188),d=/#|\.prototype\./,_=function(R,L){var U=x[v(R)];return U===E?!0:U===b?!1:u(L)?a(L):!!L},v=_.normalize=function(R){return String(R).replace(d,".").toLowerCase()},x=_.data={},b=_.NATIVE="N",E=_.POLYFILL="P";e.exports=_},4318:e=>{e.exports=function(n){return n==null}},831:(e,n,s)=>{var a=s(4188);e.exports=function(u){return typeof u=="object"?u!==null:a(u)}},1942:e=>{e.exports=!1},6032:(e,n,s)=>{var a=s(5604),u=s(4188),d=s(4578),_=s(9809),v=Object;e.exports=_?function(x){return typeof x=="symbol"}:function(x){var b=a("Symbol");return u(b)&&d(b.prototype,v(x))}},9389:(e,n,s)=>{var a=s(7611);e.exports=function(u){return a(u.length)}},4530:(e,n,s)=>{var a=s(6881),u=s(5234),d=s(4188),_=s(4418),v=s(6893),x=s(2735).CONFIGURABLE,b=s(3029),E=s(3086),R=E.enforce,L=E.get,U=String,H=Object.defineProperty,$=a("".slice),G=a("".replace),k=a([].join),B=v&&!u(function(){return H(function(){},"length",{value:8}).length!==8}),N=String(String).split("String"),J=e.exports=function(K,ft,D){$(U(ft),0,7)==="Symbol("&&(ft="["+G(U(ft),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),D&&D.getter&&(ft="get "+ft),D&&D.setter&&(ft="set "+ft),(!_(K,"name")||x&&K.name!==ft)&&(v?H(K,"name",{value:ft,configurable:!0}):K.name=ft),B&&D&&_(D,"arity")&&K.length!==D.arity&&H(K,"length",{value:D.arity});try{D&&_(D,"constructor")&&D.constructor?v&&H(K,"prototype",{writable:!1}):K.prototype&&(K.prototype=void 0)}catch{}var j=R(K);return _(j,"source")||(j.source=k(N,typeof ft=="string"?ft:"")),K};Function.prototype.toString=J(function(){return d(this)&&L(this).source||b(this)},"toString")},142:e=>{var n=Math.ceil,s=Math.floor;e.exports=Math.trunc||function(u){var d=+u;return(d>0?s:n)(d)}},4466:(e,n,s)=>{var a=s(6893),u=s(9622),d=s(3315),_=s(3770),v=s(2344),x=TypeError,b=Object.defineProperty,E=Object.getOwnPropertyDescriptor,R="enumerable",L="configurable",U="writable";n.f=a?d?function($,G,k){if(_($),G=v(G),_(k),typeof $=="function"&&G==="prototype"&&"value"in k&&U in k&&!k[U]){var B=E($,G);B&&B[U]&&($[G]=k.value,k={configurable:L in k?k[L]:B[L],enumerable:R in k?k[R]:B[R],writable:!1})}return b($,G,k)}:b:function($,G,k){if(_($),G=v(G),_(k),u)try{return b($,G,k)}catch{}if("get"in k||"set"in k)throw new x("Accessors not supported");return"value"in k&&($[G]=k.value),$}},9304:(e,n,s)=>{var a=s(6893),u=s(9944),d=s(4416),_=s(9123),v=s(380),x=s(2344),b=s(4418),E=s(9622),R=Object.getOwnPropertyDescriptor;n.f=a?R:function(U,H){if(U=v(U),H=x(H),E)try{return R(U,H)}catch{}if(b(U,H))return _(!u(d.f,U,H),U[H])}},5629:(e,n,s)=>{var a=s(1843),u=s(1274),d=u.concat("length","prototype");n.f=Object.getOwnPropertyNames||function(v){return a(v,d)}},156:(e,n)=>{n.f=Object.getOwnPropertySymbols},4578:(e,n,s)=>{var a=s(6881);e.exports=a({}.isPrototypeOf)},1843:(e,n,s)=>{var a=s(6881),u=s(4418),d=s(380),_=s(1458).indexOf,v=s(7588),x=a([].push);e.exports=function(b,E){var R=d(b),L=0,U=[],H;for(H in R)!u(v,H)&&u(R,H)&&x(U,H);for(;E.length>L;)u(R,H=E[L++])&&(~_(U,H)||x(U,H));return U}},7137:(e,n,s)=>{var a=s(1843),u=s(1274);e.exports=Object.keys||function(_){return a(_,u)}},4416:(e,n)=>{var s={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,u=a&&!s.call({1:2},1);n.f=u?function(_){var v=a(this,_);return!!v&&v.enumerable}:s},2287:(e,n,s)=>{var a=s(9944),u=s(4188),d=s(831),_=TypeError;e.exports=function(v,x){var b,E;if(x==="string"&&u(b=v.toString)&&!d(E=a(b,v))||u(b=v.valueOf)&&!d(E=a(b,v))||x!=="string"&&u(b=v.toString)&&!d(E=a(b,v)))return E;throw new _("Can't convert object to primitive value")}},3168:(e,n,s)=>{var a=s(5604),u=s(6881),d=s(5629),_=s(156),v=s(3770),x=u([].concat);e.exports=a("Reflect","ownKeys")||function(E){var R=d.f(v(E)),L=_.f;return L?x(R,L(E)):R}},9120:(e,n,s)=>{var a=s(1488);e.exports=a},9509:(e,n,s)=>{var a=s(4318),u=TypeError;e.exports=function(d){if(a(d))throw new u("Can't call method on "+d);return d}},168:(e,n,s)=>{var a=s(746),u=s(6209),d=a("keys");e.exports=function(_){return d[_]||(d[_]=u(_))}},2694:(e,n,s)=>{var a=s(1942),u=s(1488),d=s(4798),_="__core-js_shared__",v=e.exports=u[_]||d(_,{});(v.versions||(v.versions=[])).push({version:"3.36.1",mode:a?"pure":"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE",source:"https://github.com/zloirock/core-js"})},746:(e,n,s)=>{var a=s(2694);e.exports=function(u,d){return a[u]||(a[u]=d||{})}},8944:(e,n,s)=>{var a=s(3749),u=s(5234),d=s(1488),_=d.String;e.exports=!!Object.getOwnPropertySymbols&&!u(function(){var v=Symbol("symbol detection");return!_(v)||!(Object(v)instanceof Symbol)||!Symbol.sham&&a&&a<41})},675:(e,n,s)=>{var a=s(6744),u=Math.max,d=Math.min;e.exports=function(_,v){var x=a(_);return x<0?u(x+v,0):d(x,v)}},380:(e,n,s)=>{var a=s(7568),u=s(9509);e.exports=function(d){return a(u(d))}},6744:(e,n,s)=>{var a=s(142);e.exports=function(u){var d=+u;return d!==d||d===0?0:a(d)}},7611:(e,n,s)=>{var a=s(6744),u=Math.min;e.exports=function(d){var _=a(d);return _>0?u(_,9007199254740991):0}},3628:(e,n,s)=>{var a=s(9509),u=Object;e.exports=function(d){return u(a(d))}},290:(e,n,s)=>{var a=s(9944),u=s(831),d=s(6032),_=s(2913),v=s(2287),x=s(4282),b=TypeError,E=x("toPrimitive");e.exports=function(R,L){if(!u(R)||d(R))return R;var U=_(R,E),H;if(U){if(L===void 0&&(L="default"),H=a(U,R,L),!u(H)||d(H))return H;throw new b("Can't convert object to primitive value")}return L===void 0&&(L="number"),v(R,L)}},2344:(e,n,s)=>{var a=s(290),u=s(6032);e.exports=function(d){var _=a(d,"string");return u(_)?_:_+""}},9345:(e,n,s)=>{var a=s(4282),u=a("toStringTag"),d={};d[u]="z",e.exports=String(d)==="[object z]"},2618:(e,n,s)=>{var a=s(5438),u=String;e.exports=function(d){if(a(d)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return u(d)}},3174:e=>{var n=String;e.exports=function(s){try{return n(s)}catch{return"Object"}}},6209:(e,n,s)=>{var a=s(6881),u=0,d=Math.random(),_=a(1 .toString);e.exports=function(v){return"Symbol("+(v===void 0?"":v)+")_"+_(++u+d,36)}},9809:(e,n,s)=>{var a=s(8944);e.exports=a&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3315:(e,n,s)=>{var a=s(6893),u=s(5234);e.exports=a&&u(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},5945:(e,n,s)=>{var a=s(1488),u=s(4188),d=a.WeakMap;e.exports=u(d)&&/native code/.test(String(d))},4282:(e,n,s)=>{var a=s(1488),u=s(746),d=s(4418),_=s(6209),v=s(8944),x=s(9809),b=a.Symbol,E=u("wks"),R=x?b.for||b:b&&b.withoutSetter||_;e.exports=function(L){return d(E,L)||(E[L]=v&&d(b,L)?b[L]:R("Symbol."+L)),E[L]}},3975:(e,n,s)=>{var a=s(5613),u=s(6881),d=s(4977),_=s(3628),v=s(9389),x=s(1305),b=s(2618),E=s(5234),R=s(9295),L=s(5397),U=s(8807),H=s(5661),$=s(3749),G=s(3589),k=[],B=u(k.sort),N=u(k.push),J=E(function(){k.sort(void 0)}),K=E(function(){k.sort(null)}),ft=L("sort"),D=!E(function(){if($)return $<70;if(!(U&&U>3)){if(H)return!0;if(G)return G<603;var bt="",Et,gt,Pe,Le;for(Et=65;Et<76;Et++){switch(gt=String.fromCharCode(Et),Et){case 66:case 69:case 70:case 72:Pe=3;break;case 68:case 71:Pe=4;break;default:Pe=2}for(Le=0;Le<47;Le++)k.push({k:gt+Le,v:Pe})}for(k.sort(function(Xt,mt){return mt.v-Xt.v}),Le=0;Le<k.length;Le++)gt=k[Le].k.charAt(0),bt.charAt(bt.length-1)!==gt&&(bt+=gt);return bt!=="DGBEFHACIJK"}}),j=J||!K||!ft||!D,nt=function(bt){return function(Et,gt){return gt===void 0?-1:Et===void 0?1:bt!==void 0?+bt(Et,gt)||0:b(Et)>b(gt)?1:-1}};a({target:"Array",proto:!0,forced:j},{sort:function(Et){Et!==void 0&&d(Et);var gt=_(this);if(D)return Et===void 0?B(gt):B(gt,Et);var Pe=[],Le=v(gt),Xt,mt;for(mt=0;mt<Le;mt++)mt in gt&&N(Pe,gt[mt]);for(R(Pe,nt(Et)),Xt=v(Pe),mt=0;mt<Xt;)gt[mt]=Pe[mt++];for(;mt<Le;)x(gt,mt++);return gt}})},8291:(e,n,s)=>{var a=s(5613),u=s(3628),d=s(7137),_=s(5234),v=_(function(){d(1)});a({target:"Object",stat:!0,forced:v},{keys:function(b){return d(u(b))}})}},uy={};function Ee(e){var n=uy[e];if(n!==void 0)return n.exports;var s=uy[e]={id:e,exports:{}};return sD[e].call(s.exports,s,s.exports,Ee),s.exports}Ee.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return Ee.d(n,{a:n}),n};Ee.d=(e,n)=>{for(var s in n)Ee.o(n,s)&&!Ee.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:n[s]})};Ee.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();Ee.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n);Ee.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var I={};(()=>{Ee.d(I,{eKr:()=>ce,yVm:()=>Wo,a7j:()=>rt,U_w:()=>Oh,JF2:()=>_h,htg:()=>Mr,HXL:()=>bc,mcg:()=>ch,Agj:()=>Ei,u6S:()=>Sh,x7M:()=>Zt,X55:()=>Cn,m3M:()=>Oo,aE5:()=>bn,YJU:()=>_i,eZi:()=>Ur,GNv:()=>Fr,Y56:()=>jr,_0v:()=>nl,vhs:()=>Sn,Z8b:()=>zo,Yfw:()=>Lt,IcQ:()=>mt,Rl2:()=>Xa,kgJ:()=>Dh,GTT:()=>Fh,ypY:()=>Wr,i7d:()=>pc,fQ3:()=>Kf,HlI:()=>Co,jlt:()=>qa,VQc:()=>Re,zD7:()=>hl,I0I:()=>gi,AUF:()=>rn,JoF:()=>wn,MlA:()=>de,PZh:()=>Ns,qA:()=>Do,CrD:()=>cs,dQK:()=>ti,D3r:()=>xn,Qpo:()=>Ro,D9n:()=>Wa,b6v:()=>Io,mvh:()=>P,Bpo:()=>Mt,Q1f:()=>nt,IKv:()=>Xn,fcV:()=>Vn,Glf:()=>Ec,uAl:()=>Qe,ElT:()=>ei,MPu:()=>ur,Z8r:()=>Pe,QSL:()=>zr,sPV:()=>Ha,nAn:()=>fs,zCU:()=>za,QrV:()=>Me,fF9:()=>pl,xI8:()=>Fo,yar:()=>je,SP7:()=>ll,oRy:()=>el,f5X:()=>xc,V1c:()=>tr,Mlx:()=>Bh,ZCo:()=>Bo,Vy3:()=>sn,J5p:()=>$r,mL_:()=>Si,Guw:()=>se,VKx:()=>Mo,N5j:()=>wh,pgY:()=>cc,OP3:()=>jo,rl5:()=>ul,eod:()=>li,q5Z:()=>Ae,YUC:()=>bh,saR:()=>ko,hvr:()=>$h,Qol:()=>or,Wf4:()=>uc,JCs:()=>V,gJV:()=>Ni,fWD:()=>fc,Va_:()=>ms,N$8:()=>Ie,_jQ:()=>Mh,rxj:()=>ph,rhv:()=>fh,wCu:()=>ni,HAp:()=>qf,Zy1:()=>Nr,Qev:()=>Pc,bkB:()=>b,wfL:()=>Da,sVA:()=>n,$Gs:()=>ah,CJ0:()=>Pa,NWh:()=>ls,tWi:()=>gh,xAj:()=>dh,zWh:()=>Ho,i_4:()=>Dc,iIx:()=>_,c9e:()=>Ka,KQV:()=>zs,weH:()=>re,jXp:()=>Hh,zzY:()=>lr,yRQ:()=>Ja,MtE:()=>ys,rPj:()=>An,KLc:()=>x,Fir:()=>Ut,V5f:()=>lh,Xj7:()=>Ba,Wud:()=>Yo,FVg:()=>uh,g5Y:()=>Oa,YQB:()=>ks,KPb:()=>Ma,nHK:()=>$o,TX_:()=>Nh,r3n:()=>Qo,vYh:()=>oe,hnk:()=>Ge,D2R:()=>kr,n1o:()=>js,RLG:()=>Ua,fBU:()=>Ch,Adb:()=>ae,bEs:()=>rs,wCy:()=>ve,CbD:()=>Ce,x_C:()=>Br,pde:()=>a,pGf:()=>al,ibQ:()=>Wn,QlN:()=>Lo,shR:()=>Xo,Yjk:()=>Cc,_u1:()=>ap,OBI:()=>cl,klh:()=>Vr,s3S:()=>Th,D$R:()=>Gr,xth:()=>So,JU7:()=>Ri,h9x:()=>si,N1A:()=>jh,e_k:()=>pi,aHM:()=>Os,tlv:()=>Qf,Vi9:()=>dc,ieR:()=>Eh,$bb:()=>Et,VyI:()=>gt,imn:()=>tc,uqu:()=>ge,QnL:()=>Vi,vnc:()=>le,wk_:()=>Lr,GH0:()=>Bt,_1r:()=>yc,l0X:()=>Ot,HHX:()=>Jt,tjk:()=>vs,rWe:()=>nr,j9l:()=>ic,NVp:()=>ac,cPK:()=>We,XoL:()=>Hn,RmF:()=>Xi,DXI:()=>tl,tCD:()=>lp,oGn:()=>zh,J3D:()=>jt,vCJ:()=>wc,f9l:()=>Hr,AQx:()=>kt,v9m:()=>Pi,yRJ:()=>Sc,EU6:()=>Rh,m3O:()=>jn,Ryz:()=>Ai,OxP:()=>an,LEs:()=>Xr,Ec:()=>E,Pi5:()=>ol,gmH:()=>Gn,tS:()=>gl,XxX:()=>qe,bCz:()=>Ju,nYS:()=>Ms,yiT:()=>Eo,NHl:()=>ir,mO8:()=>Po,PXI:()=>Ao,bn5:()=>ka,Ywr:()=>us,cMd:()=>Ls,Bs6:()=>La,G0k:()=>hs,pyn:()=>To,QeM:()=>Fa,aPX:()=>np,ITP:()=>hh,BY0:()=>Bs,MFw:()=>rr,sBn:()=>bo,S3L:()=>Gs,XKQ:()=>_s,ESI:()=>hr,uxz:()=>Oe,o8N:()=>L,u_r:()=>er,RlV:()=>ds,gVA:()=>rl,M_G:()=>No,GRB:()=>Us,kM6:()=>tt,dO8:()=>xt,jgM:()=>rh,FWq:()=>$t,s3j:()=>Ds,hlw:()=>Za,B7e:()=>he,H_X:()=>te,S_d:()=>Yi,U7E:()=>hc,Z58:()=>ai,yh2:()=>sp,ff$:()=>oh,cWi:()=>Le,NBt:()=>gs,oNz:()=>Ra,QlU:()=>Ih,Xey:()=>En,jft:()=>Xh,Mtr:()=>bi,ypk:()=>ii,mnM:()=>Xt,bAZ:()=>$i,ABN:()=>nc,VK6:()=>Yf,kxk:()=>Js,DT1:()=>Ca,FLG:()=>yn,qN_:()=>kh,Z37:()=>Ia,FtL:()=>il,Z6X:()=>Ic,iQT:()=>ri,ziO:()=>mc,OEF:()=>Ui,uuE:()=>mi,tiv:()=>Ws,T$Y:()=>qo,EYj:()=>Hs,nOB:()=>ar,Tap:()=>ne,FAs:()=>Vo,B_P:()=>Go,aA5:()=>Zf,M4G:()=>zn,l$l:()=>Lh,dLy:()=>Ye,WZP:()=>yt,eB6:()=>fl,nFK:()=>xh,l9z:()=>sl,YOF:()=>gc,yhB:()=>U,J0N:()=>u,Miz:()=>D,Bj4:()=>Ci,Rcs:()=>os,vJ4:()=>as,TqC:()=>$a,nM0:()=>Na,X1u:()=>Fs,SpZ:()=>ec,DX8:()=>oi,Yx$:()=>Ph,HK4:()=>vc,SE$:()=>k,qE8:()=>G,Pz7:()=>Wh,sX_:()=>v,JuI:()=>H,Nl$:()=>Ah,OwT:()=>Zo,P$G:()=>Ko,mHV:()=>up,Fx_:()=>fp,WFC:()=>dp,aDq:()=>hp,jIg:()=>cp,UH3:()=>Rc,K6X:()=>lc,C1Y:()=>rc,Aw1:()=>ja,A8$:()=>Qa,hsx:()=>ln,l9E:()=>Or,aSf:()=>_c,Zex:()=>Gh,mXP:()=>Vh,vt$:()=>wo,hCA:()=>vn,pjR:()=>Wt,U43:()=>K,pSZ:()=>ft,y17:()=>J,jVr:()=>Fc,_SZ:()=>$,xWn:()=>B,ehJ:()=>N,t6s:()=>j,Eyn:()=>e});var e={};Ee.r(e),Ee.d(e,{getAttributeComponentSize:()=>Ea,getAttributePointerType:()=>Ta,getGLTypeFromSource:()=>Aa,getGlTypeSizeBytes:()=>xo,isAttributeInSource:()=>Sa});var n={};Ee.r(n),Ee.d(n,{ActionCompleteEvent:()=>ce,ActionStartEvent:()=>_h,ActivateEvent:()=>ch,CollisionEndEvent:()=>Do,CollisionPostSolveEvent:()=>Ro,CollisionPreSolveEvent:()=>Wa,CollisionStartEvent:()=>Io,ContactEndEvent:()=>Ha,ContactStartEvent:()=>za,DeactivateEvent:()=>Fo,EnterTriggerEvent:()=>ph,EnterViewPortEvent:()=>fh,EventTypes:()=>Da,ExitTriggerEvent:()=>gh,ExitViewPortEvent:()=>dh,GameEvent:()=>Ut,GameStartEvent:()=>lh,GameStopEvent:()=>Ba,GamepadAxisEvent:()=>uh,GamepadButtonEvent:()=>Oa,GamepadConnectEvent:()=>ks,GamepadDisconnectEvent:()=>Ma,HiddenEvent:()=>Ua,InitializeEvent:()=>Br,KillEvent:()=>So,PostCollisionEvent:()=>Ms,PostDebugDrawEvent:()=>Eo,PostDrawEvent:()=>ir,PostFrameEvent:()=>Po,PostKillEvent:()=>Ao,PostTransformDrawEvent:()=>ka,PostUpdateEvent:()=>us,PreCollisionEvent:()=>Ls,PreDebugDrawEvent:()=>La,PreDrawEvent:()=>hs,PreFrameEvent:()=>To,PreKillEvent:()=>Fa,PreTransformDrawEvent:()=>hh,PreUpdateEvent:()=>Bs,VisibleEvent:()=>Na});var s={};Ee.r(s),Ee.d(s,{circle:()=>vh,line:()=>He,point:()=>mh,roundRect:()=>Ga,vector:()=>sr});var a={};Ee.r(a),Ee.d(a,{Axes:()=>jr,Buttons:()=>Wr,Gamepad:()=>Yo,Gamepads:()=>$o,KeyEvent:()=>Vr,Keyboard:()=>Th,Keys:()=>Gr,NativePointerButton:()=>vs,PointerButton:()=>jn,PointerComponent:()=>Ai,PointerEvent:()=>an,PointerEventReceiver:()=>Xr,PointerScope:()=>E,PointerSystem:()=>ol,PointerType:()=>Gn,WheelDeltaMode:()=>oi,WheelEvent:()=>Ph});var u={};Ee.r(u),Ee.d(u,{ConsoleAppender:()=>Pe,DrawUtil:()=>s,EasingFunctions:()=>V,LogLevel:()=>Et,Logger:()=>gt,Observable:()=>We,ScreenAppender:()=>Le,addItemToArray:()=>vt,contains:()=>Ft,delay:()=>pe,fail:()=>Yt,getPosition:()=>Ke,omit:()=>is,removeItemFromArray:()=>Tt}),Ee(9493),Ee(311);function d(){if(typeof window>"u"&&(window={audioContext:function(){}}),typeof window<"u"&&!window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(f){window.setInterval(f,1e3/60)}),typeof window<"u"&&!window.cancelAnimationFrame&&(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),typeof window<"u"&&!window.AudioContext){if(window.webkitAudioContext){const t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(i){return new Promise((r,l)=>{t.call(this,i,r,l)})}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}typeof window<"u"&&!window.devicePixelRatio&&(window.devicePixelRatio=window.devicePixelRatio||1)}class _{static useCanvasGraphicsContext(){_.enable("use-canvas-context")}static freeze(){_._FROZEN=!0}static _reset(){_._FROZEN=!1,_._FLAGS={}}static enable(t){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");_._FLAGS[t]=!0}static disable(t){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");_._FLAGS[t]=!1}static isEnabled(t){return!!_._FLAGS[t]}static show(){return Object.keys(_._FLAGS)}}_._FROZEN=!1,_._FLAGS={};function v(f,t){return{type:f,value:t}}class x{constructor(){this._isCompleted=!1,this.promise=new Promise((t,i)=>{this._resolver=t,this._rejecter=i})}get isCompleted(){return this._isCompleted}resolve(t){this._isCompleted||(this._isCompleted=!0,this._resolver(t))}reject(t){this._isCompleted||(this._isCompleted=!0,this._rejecter(t))}}class b{constructor(){this._paused=!1,this._listeners={},this._listenersOnce={},this._pipes=[]}clear(){this._listeners={},this._listenersOnce={},this._pipes.length=0}on(t,i){var r;return this._listeners[t]=(r=this._listeners[t])!==null&&r!==void 0?r:[],this._listeners[t].push(i),{close:()=>this.off(t,i)}}once(t,i){var r;return this._listenersOnce[t]=(r=this._listenersOnce[t])!==null&&r!==void 0?r:[],this._listenersOnce[t].push(i),{close:()=>this.off(t,i)}}off(t,i){var r,l;if(i){const c=(r=this._listeners[t])===null||r===void 0?void 0:r.filter(m=>m!==i);this._listeners[t]=c;const g=(l=this._listenersOnce[t])===null||l===void 0?void 0:l.filter(m=>m!==i);this._listenersOnce[t]=g}else delete this._listeners[t]}emit(t,i){var r;if(this._paused)return;(r=this._listeners[t])===null||r===void 0||r.forEach(c=>c(i));const l=this._listenersOnce[t];this._listenersOnce[t]=[],l&&l.forEach(c=>c(i)),this._pipes.forEach(c=>{c.emit(t,i)})}pipe(t){if(this===t)throw Error("Cannot pipe to self");return this._pipes.push(t),{close:()=>{const i=this._pipes.indexOf(t);i>-1&&this._pipes.splice(i,1)}}}unpipe(t){const i=this._pipes.indexOf(t);i>-1&&this._pipes.splice(i,1)}pause(){this._paused=!0}unpause(){this._paused=!1}}var E;(function(f){f.Canvas="Canvas",f.Document="Document"})(E||(E={}));const R=4294967295;class L{constructor(t){this.seed=t,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(t||Date.now())>>>0;for(let i=1;i<this._n;i++){const r=this._mt[i-1]^this._mt[i-1]>>>this._w-2;this._mt[i]=(this._f*((r&4294901760)>>>16)<<16)+this._f*(r&65535)+i>>>0}this._index=this._n}_twist(){const t=[0,this._a];let i=0,r=0;for(;r<this._n-this._m;r++)i=this._mt[r]&this._upperMask|this._mt[r+1]&this._lowerMask,this._mt[r]=this._mt[r+this._m]^i>>>1^t[i&1]&R;for(;r<this._n-1;r++)i=this._mt[r]&this._upperMask|this._mt[r+1]&this._lowerMask,this._mt[r]=this._mt[r+(this._m-this._n)]^i>>>1^t[i&1]&R;i=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^i>>>1^t[i&1]&R,this._index=0}nextInt(){this._index>=this._n&&this._twist();let t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,t^=t>>>this._l,t>>>0}next(){return this.nextInt()*(1/4294967296)}floating(t,i){return(i-t)*this.next()+t}integer(t,i){return Math.floor((i-t+1)*this.next()+t)}bool(t=.5){return this.next()<=t}pickOne(t){return t[this.integer(0,t.length-1)]}pickSet(t,i,r=!1){return r?this._pickSetWithDuplicates(t,i):this._pickSetWithoutDuplicates(t,i)}_pickSetWithoutDuplicates(t,i){if(i>t.length||i<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(i===t.length)return t;const r=new Array(i);let l=0;const c=t.slice(0);for(;l<i;){const g=this.integer(0,c.length-1);r[l++]=c[g],c.splice(g,1)}return r}_pickSetWithDuplicates(t,i){if(i<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");const r=new Array(i);for(let l=0;l<i;l++)r[l]=this.pickOne(t);return r}shuffle(t){const i=t.slice(0);let r=null;for(let l=0;l<i.length-2;l++){const c=this.integer(l,i.length-1);r=i[l],i[l]=i[c],i[c]=r}return i}range(t,i,r){const l=new Array(t);for(let c=0;c<t;c++)l[c]=this.integer(i,r);return l}d4(){return this.integer(1,4)}d6(){return this.integer(1,6)}d8(){return this.integer(1,8)}d10(){return this.integer(1,10)}d12(){return this.integer(1,12)}d20(){return this.integer(1,20)}}const U=Math.PI*2;function H(f){return f>=0?f-Math.floor(f):f-Math.ceil(f)}function $(f){return f===0?0:f<0?-1:1}function G(f,t,i){return Math.min(Math.max(t,f),i)}function k(f){let t=f;if(f>U)for(;t>U;)t-=U;if(f<0)for(;t<0;)t+=U;return t}function B(f){return 180/Math.PI*f}function N(f){return f/180*Math.PI}const J=(f,t)=>Array.from(new Array(t-f+1),(i,r)=>r+f);function K(f,t,i=new L){return i?i.floating(f,t):f+Math.random()*(t-f)}function ft(f,t,i=new L){return i?i.integer(f,t):Math.round(K(f,t))}class D{static get Zero(){return new D(0,0)}static get One(){return new D(1,1)}static get Half(){return new D(.5,.5)}static get Up(){return new D(0,-1)}static get Down(){return new D(0,1)}static get Left(){return new D(-1,0)}static get Right(){return new D(1,0)}static fromAngle(t){return new D(Math.cos(t),Math.sin(t))}static isValid(t){return!(t==null||isNaN(t.x)||isNaN(t.y)||t.x===1/0||t.y===1/0||t.x===-1/0||t.y===-1/0)}static distance(t,i){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}static min(t,i){return new D(Math.min(t.x,i.x),Math.min(t.y,i.y))}static max(t,i){return new D(Math.max(t.x,i.x),Math.max(t.y,i.y))}constructor(t,i){this._x=0,this._y=0,this._x=t,this._y=i}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}setTo(t,i){this.x=t,this.y=i}equals(t,i=D.EQUALS_EPSILON){return Math.abs(this.x-t.x)<=i&&Math.abs(this.y-t.y)<=i}distance(t){if(!t)return Math.sqrt(this.x*this.x+this.y*this.y);const i=this.x-t.x,r=this.y-t.y;return Math.sqrt(i*i+r*r)}squareDistance(t){t||(t=D.Zero);const i=this.x-t.x,r=this.y-t.y;return i*i+r*r}clampMagnitude(t){const i=this.size,r=G(i,0,t);return this.size=r,this}get size(){return this.distance()}set size(t){const i=this.normalize().scale(t);this.setTo(i.x,i.y)}normalize(){const t=this.distance();return t>0?new D(this.x/t,this.y/t):new D(0,1)}average(t){return this.add(t).scale(.5)}scale(t,i){const r=i||new D(0,0);return t instanceof D?(r.x=this.x*t.x,r.y=this.y*t.y):(r.x=this.x*t,r.y=this.y*t),r}add(t,i){return i?(i.x=this.x+t.x,i.y=this.y+t.y,i):new D(this.x+t.x,this.y+t.y)}sub(t){return new D(this.x-t.x,this.y-t.y)}addEqual(t){return this.setTo(this.x+t.x,this.y+t.y),this}subEqual(t){return this.setTo(this.x-t.x,this.y-t.y),this}scaleEqual(t){return this.setTo(this.x*t,this.y*t),this}dot(t){return this.x*t.x+this.y*t.y}cross(t){if(t instanceof D)return this.x*t.y-this.y*t.x;if(typeof t=="number")return new D(t*this.y,-t*this.x)}static cross(t,i){return new D(-t*i.y,t*i.x)}perpendicular(){return new D(this.y,-this.x)}normal(){return this.perpendicular().normalize()}negate(){return this.scale(-1)}toAngle(){return k(Math.atan2(this.y,this.x))}rotate(t,i){i||(i=new D(0,0));const r=Math.sin(t),l=Math.cos(t),c=l*(this.x-i.x)-r*(this.y-i.y)+i.x,g=r*(this.x-i.x)+l*(this.y-i.y)+i.y;return new D(c,g)}clone(t){const i=t??new D(0,0);return i.x=this.x,i.y=this.y,i}toString(t){return t?`(${this.x.toFixed(t)}, ${this.y.toFixed(t)})`:`(${this.x}, ${this.y})`}}D.EQUALS_EPSILON=.001;function j(f,t){return new D(f,t)}class nt{constructor(t,i,r,l){this.r=t,this.g=i,this.b=r,this.a=l??1}static fromRGB(t,i,r,l){return new nt(t,i,r,l)}static fromRGBString(t){const i=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i;let r=null;if(r=t.match(i)){const l=parseInt(r[1],10),c=parseInt(r[2],10),g=parseInt(r[3],10);let m=1;return r[4]&&(m=parseFloat(r[4])),new nt(l,c,g,m)}else throw new Error("Invalid rgb/a string: "+t)}static fromHex(t){const i=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;let r=null;if(r=t.match(i)){const l=parseInt(r[1],16),c=parseInt(r[2],16),g=parseInt(r[3],16);let m=1;return r[4]&&(m=parseInt(r[4],16)/255),new nt(l,c,g,m)}else throw new Error("Invalid hex string: "+t)}static fromHSL(t,i,r,l=1){return new bt(t,i,r,l).toRGBA()}lighten(t=.1){const i=bt.fromRGBA(this.r,this.g,this.b,this.a);return i.l+=(1-i.l)*t,i.toRGBA()}darken(t=.1){const i=bt.fromRGBA(this.r,this.g,this.b,this.a);return i.l-=i.l*t,i.toRGBA()}saturate(t=.1){const i=bt.fromRGBA(this.r,this.g,this.b,this.a);return i.s+=i.s*t,i.toRGBA()}desaturate(t=.1){const i=bt.fromRGBA(this.r,this.g,this.b,this.a);return i.s-=i.s*t,i.toRGBA()}multiply(t){const i=t.r/255*this.r/255*255,r=t.g/255*this.g/255*255,l=t.b/255*this.b/255*255,c=t.a*this.a;return new nt(i,r,l,c)}screen(t){const i=t.invert(),r=t.invert();return i.multiply(r).invert()}invert(){return new nt(255-this.r,255-this.g,255-this.b,1-this.a)}average(t){const i=(t.r+this.r)/2,r=(t.g+this.g)/2,l=(t.b+this.b)/2,c=(t.a+this.a)/2;return new nt(i,r,l,c)}equal(t){return this.toString()===t.toString()}toString(t="rgb"){switch(t){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}_componentToHex(t){const i=Math.max(Math.round(t),0).toString(16);return i.length===1?"0"+i:i}toHex(){let t="#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b);return this.a!==1&&(t+=this._componentToHex(this.a*255)),t}toRGBA(){const t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return this.a!==void 0||this.a!==null?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}toHSLA(){return bt.fromRGBA(this.r,this.g,this.b,this.a).toString()}fillStyle(){return this.toString()}clone(){return new nt(this.r,this.g,this.b,this.a)}static get Black(){return nt.fromHex("#000000")}static get White(){return nt.fromHex("#FFFFFF")}static get Gray(){return nt.fromHex("#808080")}static get LightGray(){return nt.fromHex("#D3D3D3")}static get DarkGray(){return nt.fromHex("#A9A9A9")}static get Yellow(){return nt.fromHex("#FFFF00")}static get Orange(){return nt.fromHex("#FFA500")}static get Red(){return nt.fromHex("#FF0000")}static get Vermilion(){return nt.fromHex("#FF5B31")}static get Rose(){return nt.fromHex("#FF007F")}static get Magenta(){return nt.fromHex("#FF00FF")}static get Violet(){return nt.fromHex("#7F00FF")}static get Blue(){return nt.fromHex("#0000FF")}static get Azure(){return nt.fromHex("#007FFF")}static get Cyan(){return nt.fromHex("#00FFFF")}static get Viridian(){return nt.fromHex("#59978F")}static get Green(){return nt.fromHex("#00FF00")}static get Chartreuse(){return nt.fromHex("#7FFF00")}static get Transparent(){return nt.fromHex("#FFFFFF00")}static get ExcaliburBlue(){return nt.fromHex("#176BAA")}}class bt{constructor(t,i,r,l){this.h=t,this.s=i,this.l=r,this.a=l}static hue2rgb(t,i,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(i-t)*6*r:r<1/2?i:r<2/3?t+(i-t)*(2/3-r)*6:t}static fromRGBA(t,i,r,l){t/=255,i/=255,r/=255;const c=Math.max(t,i,r),g=Math.min(t,i,r);let m,w;const C=(c+g)/2;if(c===g)m=w=0;else{const A=c-g;switch(w=C>.5?A/(2-c-g):A/(c+g),c){case t:m=(i-r)/A+(i<r?6:0);break;case i:m=(r-t)/A+2;break;case r:m=(t-i)/A+4;break}m/=6}return new bt(m,w,C,l)}toRGBA(){let t,i,r;if(this.s===0)t=i=r=this.l;else{const l=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,c=2*this.l-l;t=bt.hue2rgb(c,l,this.h+1/3),i=bt.hue2rgb(c,l,this.h),r=bt.hue2rgb(c,l,this.h-1/3)}return new nt(t*255,i*255,r*255,this.a)}toString(){const t=this.h.toFixed(0),i=this.s.toFixed(0),r=this.l.toFixed(0),l=this.a.toFixed(0);return`hsla(${t}, ${i}, ${r}, ${l})`}}var Et;(function(f){f[f.Debug=0]="Debug",f[f.Info=1]="Info",f[f.Warn=2]="Warn",f[f.Error=3]="Error",f[f.Fatal=4]="Fatal"})(Et||(Et={}));class gt{constructor(){if(this._appenders=[],this.defaultLevel=Et.Info,this._logOnceSet=new Set,gt._INSTANCE)throw new Error("Logger is a singleton");return gt._INSTANCE=this,gt._INSTANCE.addAppender(new Pe),gt._INSTANCE}static getInstance(){return gt._INSTANCE==null&&(gt._INSTANCE=new gt),gt._INSTANCE}addAppender(t){this._appenders.push(t)}clearAppenders(){this._appenders.length=0}_log(t,i){t==null&&(t=this.defaultLevel);const r=this._appenders.length;for(let l=0;l<r;l++)t>=this.defaultLevel&&this._appenders[l].log(t,i)}_logOnce(t,i){const r=t+i.join("+");this._logOnceSet.has(r)||(this._logOnceSet.add(r),this._log(t,i))}debug(...t){this._log(Et.Debug,t)}debugOnce(...t){this._logOnce(Et.Debug,t)}info(...t){this._log(Et.Info,t)}infoOnce(...t){this._logOnce(Et.Info,t)}warn(...t){this._log(Et.Warn,t)}warnOnce(...t){this._logOnce(Et.Warn,t)}error(...t){this._log(Et.Error,t)}errorOnce(...t){this._logOnce(Et.Error,t)}fatal(...t){this._log(Et.Fatal,t)}fatalOnce(...t){this._logOnce(Et.Fatal,t)}}gt._INSTANCE=null;class Pe{log(t,i){if(!console&&!console.log&&console.warn&&console.error)return;const r=[];r.unshift.apply(r,i),r.unshift("["+Et[t]+"] : "),t<Et.Warn?console.log.apply?console.log.apply(console,r):console.log(r.join(" ")):t<Et.Error?console.warn.apply?console.warn.apply(console,r):console.warn(r.join(" ")):console.error.apply?console.error.apply(console,r):console.error(r.join(" "))}}class Le{constructor(t){var i,r;this._messages=[],this._pos=10,this._color=nt.Black,this._options=t,this.canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.zIndex=(r=(i=t.zIndex)===null||i===void 0?void 0:i.toString())!==null&&r!==void 0?r:"99",document.body.appendChild(this.canvas),this._positionScreenAppenderCanvas(),t.engine.screen.events.on("resize",()=>{this._positionScreenAppenderCanvas()})}_positionScreenAppenderCanvas(){var t,i,r,l;const c=this._options;this.canvas.width=(t=c.width)!==null&&t!==void 0?t:c.engine.screen.resolution.width,this.canvas.height=(i=c.height)!==null&&i!==void 0?i:c.engine.screen.resolution.height,this.canvas.style.position="absolute";const g=c.engine.screen.screenToPageCoordinates(j(0,0));this.canvas.style.left=g.x+"px",this.canvas.style.top=g.y+"px",this._pos=(r=c.xPos)!==null&&r!==void 0?r:this._pos,this._color=(l=c.color)!==null&&l!==void 0?l:this._color}log(t,i){const r=i.join(",");this._ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this._messages.unshift("["+Et[t]+"] : "+r);let l=10;this._messages=this._messages.slice(0,1e3);for(let c=0;c<this._messages.length;c++)this._ctx.fillStyle=this._color.toRGBA(),this._ctx.fillText(this._messages[c],this._pos,l),l+=10}}var Xt;(function(f){f.None="None",f.Top="Top",f.Bottom="Bottom",f.Left="Left",f.Right="Right"})(Xt||(Xt={})),function(f){function t(r){return r===f.Top?f.Bottom:r===f.Bottom?f.Top:r===f.Left?f.Right:r===f.Right?f.Left:f.None}f.getOpposite=t;function i(r){const l=[D.Left,D.Right,D.Up,D.Down],c=[f.Left,f.Right,f.Top,f.Bottom];let g=-Number.MAX_VALUE,m=-1;for(let w=0;w<l.length;w++)l[w].dot(r)>g&&(g=l[w].dot(r),m=w);return c[m]}f.fromDirection=i}(Xt||(Xt={}));class mt{constructor(t=0,i=0,r=0,l=0){this._points=[],typeof t=="object"?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):typeof t=="number"&&(this.left=t,this.top=i,this.right=r,this.bottom=l)}clone(){return new mt(this.left,this.top,this.right,this.bottom)}static getSideFromIntersection(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?Xt.Right:Xt.Left:t.y<0?Xt.Bottom:Xt.Top:Xt.None}static fromPoints(t){let i=1/0,r=1/0,l=-1/0,c=-1/0;for(let g=0;g<t.length;g++)t[g].x<i&&(i=t[g].x),t[g].x>l&&(l=t[g].x),t[g].y<r&&(r=t[g].y),t[g].y>c&&(c=t[g].y);return new mt(i,r,l,c)}static fromDimension(t,i,r=D.Half,l=D.Zero){return new mt(-t*r.x+l.x,-i*r.y+l.y,t-t*r.x+l.x,i-i*r.y+l.y)}get width(){return this.right-this.left}get height(){return this.bottom-this.top}hasZeroDimensions(){return this.width===0||this.height===0}get center(){return new D((this.left+this.right)/2,(this.top+this.bottom)/2)}get topLeft(){return new D(this.left,this.top)}get bottomRight(){return new D(this.right,this.bottom)}get topRight(){return new D(this.right,this.top)}get bottomLeft(){return new D(this.left,this.bottom)}translate(t){return new mt(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)}rotate(t,i=D.Zero){const r=this.getPoints().map(l=>l.rotate(t,i));return mt.fromPoints(r)}scale(t,i=D.Zero){const r=this.translate(i);return new mt(r.left*t.x,r.top*t.y,r.right*t.x,r.bottom*t.y)}transform(t){const i=t.data[0]*this.left,r=t.data[1]*this.left,l=t.data[0]*this.right,c=t.data[1]*this.right,g=t.data[2]*this.top,m=t.data[3]*this.top,w=t.data[2]*this.bottom,C=t.data[3]*this.bottom,A=t.getPosition(),T=Math.min(i,l)+Math.min(g,w)+A.x,M=Math.min(r,c)+Math.min(m,C)+A.y,z=Math.max(i,l)+Math.max(g,w)+A.x,W=Math.max(r,c)+Math.max(m,C)+A.y;return new mt({left:T,top:M,right:z,bottom:W})}getPerimeter(){const t=this.width,i=this.height;return 2*(t+i)}getPoints(){return(this._left!==this.left||this._right!==this.right||this._top!==this.top||this._bottom!==this.bottom)&&(this._points.length=0,this._points.push(new D(this.left,this.top)),this._points.push(new D(this.right,this.top)),this._points.push(new D(this.right,this.bottom)),this._points.push(new D(this.left,this.bottom)),this._left=this.left,this._right=this.right,this._top=this.top,this._bottom=this.bottom),this._points}rayCast(t,i=1/0){let r=-1/0,l=1/0;const c=t.dir.x===0?Number.MAX_VALUE:1/t.dir.x,g=t.dir.y===0?Number.MAX_VALUE:1/t.dir.y,m=(this.left-t.pos.x)*c,w=(this.right-t.pos.x)*c;r=Math.min(m,w),l=Math.max(m,w);const C=(this.top-t.pos.y)*g,A=(this.bottom-t.pos.y)*g;return r=Math.max(r,Math.min(C,A)),l=Math.min(l,Math.max(C,A)),l>=Math.max(0,r)&&r<i}rayCastTime(t,i=1/0){let r=-1/0,l=1/0;const c=t.dir.x===0?Number.MAX_VALUE:1/t.dir.x,g=t.dir.y===0?Number.MAX_VALUE:1/t.dir.y,m=(this.left-t.pos.x)*c,w=(this.right-t.pos.x)*c;r=Math.min(m,w),l=Math.max(m,w);const C=(this.top-t.pos.y)*g,A=(this.bottom-t.pos.y)*g;return r=Math.max(r,Math.min(C,A)),l=Math.min(l,Math.max(C,A)),l>=Math.max(0,r)&&r<i?r:-1}contains(t){return t instanceof D?this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x:t instanceof mt?this.left<=t.left&&this.top<=t.top&&t.bottom<=this.bottom&&t.right<=this.right:!1}combine(t){return new mt(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom))}get dimensions(){return new D(this.width,this.height)}overlaps(t,i){const r=i||0;if(t.hasZeroDimensions())return this.contains(t);if(this.hasZeroDimensions())return t.contains(this);const l=this.combine(t);return l.width+r<t.width+this.width&&l.height+r<t.height+this.height}intersect(t){const i=this.combine(t);if(i.width<t.width+this.width&&i.height<t.height+this.height&&!i.dimensions.equals(t.dimensions)&&!i.dimensions.equals(this.dimensions)){let r=0;this.right>=t.left&&this.right<=t.right?r=t.left-this.right:r=t.right-this.left;let l=0;return this.top<=t.bottom&&this.top>=t.top?l=t.bottom-this.top:l=t.top-this.bottom,Math.abs(r)<Math.abs(l)?new D(r,0):new D(0,l)}else if(i.dimensions.equals(t.dimensions)||i.dimensions.equals(this.dimensions)){let r=0;this.width-t.width>=0?this.right-t.right<=t.left-this.left?r=t.left-this.right:r=t.right-this.left:t.right-this.right<=this.left-t.left?r=this.left-t.right:r=this.right-t.left;let l=0;return this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?l=t.top-this.bottom:l=t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?l=this.top-t.bottom:l=this.bottom-t.top,Math.abs(r)<Math.abs(l)?new D(r,0):new D(0,l)}else return null}intersectWithSide(t){const i=this.intersect(t);return mt.getSideFromIntersection(i)}draw(t,i=nt.Yellow){t.debug.drawRect(this.left,this.top,this.width,this.height,{color:i})}}function Ke(f){if(f){const t=f.getBoundingClientRect();return j(t.x+window.scrollX,t.y+window.scrollY)}return D.Zero}function vt(f,t){return t.indexOf(f)===-1?(t.push(f),!0):!1}function Tt(f,t){let i=-1;return(i=t.indexOf(f))>-1?(t.splice(i,1),!0):!1}function Ft(f,t){for(let i=0;i<f.length;i++)if(f[i]===t)return!0;return!1}function Yt(f){throw new Error(f)}function pe(f,t){var i;const r=new x;return((i=t==null?void 0:t.schedule.bind(t))!==null&&i!==void 0?i:setTimeout)(()=>{r.resolve()},f),r.promise}function is(f,t){const i={};for(const r in f)t.includes(r)||(i[r]=f[r]);return i}var Vi;(function(f){f[f.X=12]="X",f[f.Y=13]="Y"})(Vi||(Vi={}));class ge{constructor(){this.data=new Float32Array(16),this._scaleX=1,this._scaleSignX=1,this._scaleY=1,this._scaleSignY=1}static ortho(t,i,r,l,c,g){const m=new ge;return m.data[0]=2/(i-t),m.data[1]=0,m.data[2]=0,m.data[3]=0,m.data[4]=0,m.data[5]=2/(l-r),m.data[6]=0,m.data[7]=0,m.data[8]=0,m.data[9]=0,m.data[10]=-2/(g-c),m.data[11]=0,m.data[12]=-(i+t)/(i-t),m.data[13]=-(l+r)/(l-r),m.data[14]=-(g+c)/(g-c),m.data[15]=1,m}clone(t){const i=t||new ge;return i.data[0]=this.data[0],i.data[1]=this.data[1],i.data[2]=this.data[2],i.data[3]=this.data[3],i.data[4]=this.data[4],i.data[5]=this.data[5],i.data[6]=this.data[6],i.data[7]=this.data[7],i.data[8]=this.data[8],i.data[9]=this.data[9],i.data[10]=this.data[10],i.data[11]=this.data[11],i.data[12]=this.data[12],i.data[13]=this.data[13],i.data[14]=this.data[14],i.data[15]=this.data[15],i}toDOMMatrix(){return new DOMMatrix([...this.data])}static fromFloat32Array(t){const i=new ge;return i.data=t,i}static identity(){const t=new ge;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}static translation(t,i){const r=ge.identity();return r.data[12]=t,r.data[13]=i,r}static scale(t,i){const r=ge.identity();return r.data[0]=t,r.data[5]=i,r.data[10]=1,r.data[15]=1,r}static rotation(t){const i=ge.identity();return i.data[0]=Math.cos(t),i.data[4]=-Math.sin(t),i.data[1]=Math.sin(t),i.data[5]=Math.cos(t),i}multiply(t,i){if(t instanceof D){const r=i||new D(0,0),l=t,c=l.x*this.data[0]+l.y*this.data[4]+this.data[12],g=l.x*this.data[1]+l.y*this.data[5]+this.data[13];return r.x=c,r.y=g,r}else{const r=i||new ge,l=t,c=this.data[0],g=this.data[1],m=this.data[2],w=this.data[3],C=this.data[4],A=this.data[5],T=this.data[6],M=this.data[7],z=this.data[8],W=this.data[9],Z=this.data[10],st=this.data[11],q=this.data[12],Q=this.data[13],ot=this.data[14],et=this.data[15],_t=l.data[0],Nt=l.data[1],at=l.data[2],Rt=l.data[3],we=l.data[4],_e=l.data[5],Ii=l.data[6],Di=l.data[7],vi=l.data[8],Fi=l.data[9],hi=l.data[10],ui=l.data[11],At=l.data[12],Vs=l.data[13],cr=l.data[14],Xs=l.data[15];r.data[0]=c*_t+C*Nt+z*at+q*Rt,r.data[1]=g*_t+A*Nt+W*at+Q*Rt,r.data[2]=m*_t+T*Nt+Z*at+ot*Rt,r.data[3]=w*_t+M*Nt+st*at+et*Rt,r.data[4]=c*we+C*_e+z*Ii+q*Di,r.data[5]=g*we+A*_e+W*Ii+Q*Di,r.data[6]=m*we+T*_e+Z*Ii+ot*Di,r.data[7]=w*we+M*_e+st*Ii+et*Di,r.data[8]=c*vi+C*Fi+z*hi+q*ui,r.data[9]=g*vi+A*Fi+W*hi+Q*ui,r.data[10]=m*vi+T*Fi+Z*hi+ot*ui,r.data[11]=w*vi+M*Fi+st*hi+et*ui,r.data[12]=c*At+C*Vs+z*cr+q*Xs,r.data[13]=g*At+A*Vs+W*cr+Q*Xs,r.data[14]=m*At+T*Vs+Z*cr+ot*Xs,r.data[15]=w*At+M*Vs+st*cr+et*Xs;const dr=this.getScale();return r._scaleSignX=$(dr.x)*$(r._scaleSignX),r._scaleSignY=$(dr.y)*$(r._scaleSignY),r}}translate(t,i){const r=this.data[0],l=this.data[1],c=this.data[2],g=this.data[3],m=this.data[4],w=this.data[5],C=this.data[6],A=this.data[7],T=this.data[8],M=this.data[9],z=this.data[10],W=this.data[11],Z=this.data[12],st=this.data[13],q=this.data[14],Q=this.data[15],ot=0,et=1;return this.data[12]=r*t+m*i+T*ot+Z*et,this.data[13]=l*t+w*i+M*ot+st*et,this.data[14]=c*t+C*i+z*ot+q*et,this.data[15]=g*t+A*i+W*ot+Q*et,this}setPosition(t,i){this.data[12]=t,this.data[13]=i}getPosition(){return j(this.data[12],this.data[13])}rotate(t){const i=this.data[0],r=this.data[1],l=this.data[2],c=this.data[3],g=this.data[4],m=this.data[5],w=this.data[6],C=this.data[7],A=Math.sin(t),T=Math.cos(t);return this.data[0]=T*i+A*g,this.data[1]=T*r+A*m,this.data[2]=T*l+A*w,this.data[3]=T*c+A*C,this.data[4]=T*g-A*i,this.data[5]=T*m-A*r,this.data[6]=T*w-A*l,this.data[7]=T*C-A*c,this}scale(t,i){const r=this.data[0],l=this.data[1],c=this.data[2],g=this.data[3],m=this.data[4],w=this.data[5],C=this.data[6],A=this.data[7];return this.data[0]=r*t,this.data[1]=l*t,this.data[2]=c*t,this.data[3]=g*t,this.data[4]=m*i,this.data[5]=w*i,this.data[6]=C*i,this.data[7]=A*i,this}setRotation(t){const i=this.getScale(),r=Math.sin(t),l=Math.cos(t);this.data[0]=l*i.x,this.data[1]=r*i.y,this.data[4]=-r*i.x,this.data[5]=l*i.y}getRotation(){const t=Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX());return k(t)}getScaleX(){const t=j(this.data[0],this.data[4]).size;return this._scaleSignX*t}getScaleY(){const t=j(this.data[1],this.data[5]).size;return this._scaleSignY*t}getScale(){return j(this.getScaleX(),this.getScaleY())}setScaleX(t){if(this._scaleX===t)return;this._scaleSignX=$(t);const i=j(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=i.x*t,this.data[4]=i.y*t,this._scaleX=t}setScaleY(t){if(this._scaleY===t)return;this._scaleSignY=$(t);const i=j(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=i.x*t,this.data[5]=i.y*t,this._scaleY=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}getBasisDeterminant(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}getAffineInverse(t){const r=1/this.getBasisDeterminant(),l=this.data[0],c=this.data[4],g=this.data[1],m=this.data[5],w=t||ge.identity();w.data[0]=m*r,w.data[1]=-g*r,w.data[4]=-c*r,w.data[5]=l*r;const C=this.data[12],A=this.data[13];return w.data[12]=-(C*w.data[0]+A*w.data[4]),w.data[13]=-(C*w.data[1]+A*w.data[5]),w}isIdentity(){return this.data[0]===1&&this.data[1]===0&&this.data[2]===0&&this.data[3]===0&&this.data[4]===0&&this.data[5]===1&&this.data[6]===0&&this.data[7]===0&&this.data[8]===0&&this.data[9]===0&&this.data[10]===1&&this.data[11]===0&&this.data[12]===0&&this.data[13]===0&&this.data[14]===0&&this.data[15]===1}toString(){return`
[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]
[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]
[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]
[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]
`}}class Zt{constructor(){this.data=new Float64Array(6),this._scale=new Float64Array([1,1]),this._scaleSignX=1,this._scaleSignY=1}toDOMMatrix(){return new DOMMatrix([...this.data])}static identity(){const t=new Zt;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}static translation(t,i){const r=Zt.identity();return r.data[4]=t,r.data[5]=i,r}static scale(t,i){const r=Zt.identity();return r.data[0]=t,r.data[3]=i,r._scale[0]=t,r._scale[1]=i,r}static rotation(t){const i=Zt.identity();return i.data[0]=Math.cos(t),i.data[1]=Math.sin(t),i.data[2]=-Math.sin(t),i.data[3]=Math.cos(t),i}setPosition(t,i){this.data[4]=t,this.data[5]=i}getPosition(){return j(this.data[4],this.data[5])}rotate(t){const i=this.data[0],r=this.data[1],l=this.data[2],c=this.data[3],g=Math.sin(t),m=Math.cos(t);return this.data[0]=m*i+g*l,this.data[1]=m*r+g*c,this.data[2]=m*l-g*i,this.data[3]=m*c-g*r,this}translate(t,i){const r=this.data[0],l=this.data[1],c=this.data[2],g=this.data[3],m=this.data[4],w=this.data[5];return this.data[4]=r*t+c*i+m,this.data[5]=l*t+g*i+w,this}scale(t,i){const r=this.data[0],l=this.data[1],c=this.data[2],g=this.data[3];return this.data[0]=r*t,this.data[1]=l*t,this.data[2]=c*i,this.data[3]=g*i,this._scale[0]=t,this._scale[1]=i,this}determinant(){return this.data[0]*this.data[3]-this.data[1]*this.data[2]}inverse(t){const r=1/this.determinant(),l=this.data[0],c=this.data[2],g=this.data[1],m=this.data[3],w=t||Zt.identity();w.data[0]=m*r,w.data[1]=-g*r,w.data[2]=-c*r,w.data[3]=l*r;const C=this.data[4],A=this.data[5];return w.data[4]=-(C*w.data[0]+A*w.data[2]),w.data[5]=-(C*w.data[1]+A*w.data[3]),w}multiply(t,i){if(t instanceof D){const r=i||new D(0,0),l=t,c=l.x*this.data[0]+l.y*this.data[2]+this.data[4],g=l.x*this.data[1]+l.y*this.data[3]+this.data[5];return r.x=c,r.y=g,r}else{const r=i||new Zt,l=t,c=this.data[0],g=this.data[1],m=this.data[2],w=this.data[3],C=this.data[4],A=this.data[5],T=l.data[0],M=l.data[1],z=l.data[2],W=l.data[3],Z=l.data[4],st=l.data[5];r.data[0]=c*T+m*M,r.data[1]=g*T+w*M,r.data[2]=c*z+m*W,r.data[3]=g*z+w*W,r.data[4]=c*Z+m*st+C,r.data[5]=g*Z+w*st+A;const q=this.getScale();return r._scaleSignX=$(q.x)*$(r._scaleSignX),r._scaleSignY=$(q.y)*$(r._scaleSignY),r}}multiplyQuadInPlace(t){const i=t[0]*this.data[0]+t[1]*this.data[2]+this.data[4],r=t[0]*this.data[1]+t[1]*this.data[3]+this.data[5];t[0]=i,t[1]=r;const l=t[2]*this.data[0]+t[3]*this.data[2]+this.data[4],c=t[2]*this.data[1]+t[3]*this.data[3]+this.data[5];t[2]=l,t[3]=c;const g=t[4]*this.data[0]+t[5]*this.data[2]+this.data[4],m=t[4]*this.data[1]+t[5]*this.data[3]+this.data[5];t[4]=g,t[5]=m;const w=t[6]*this.data[0]+t[7]*this.data[2]+this.data[4],C=t[6]*this.data[1]+t[7]*this.data[3]+this.data[5];t[6]=w,t[7]=C}to4x4(){const t=new ge;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=0,t.data[3]=0,t.data[4]=this.data[2],t.data[5]=this.data[3],t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=this.data[4],t.data[13]=this.data[5],t.data[14]=0,t.data[15]=1,t}setRotation(t){const i=this.getScale(),r=Math.sin(t),l=Math.cos(t);this.data[0]=l*i.x,this.data[1]=r*i.y,this.data[2]=-r*i.x,this.data[3]=l*i.y}getRotation(){const t=Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX());return k(t)}getScaleX(){const t=j(this.data[0],this.data[2]).distance();return this._scaleSignX*t}getScaleY(){const t=j(this.data[1],this.data[3]).distance();return this._scaleSignY*t}getScale(){return j(this.getScaleX(),this.getScaleY())}setScaleX(t){if(t===this._scale[0])return;this._scaleSignX=$(t);const i=j(this.data[0]*this._scaleSignX,this.data[2]*this._scaleSignX).normalize();this.data[0]=i.x*t,this.data[2]=i.y*t,this._scale[0]=t}setScaleY(t){if(t===this._scale[1])return;this._scaleSignY=$(t);const i=j(this.data[1]*this._scaleSignY,this.data[3]*this._scaleSignY).normalize();this.data[1]=i.x*t,this.data[3]=i.y*t,this._scale[1]=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}isIdentity(){return this.data[0]===1&&this.data[1]===0&&this.data[2]===0&&this.data[3]===1&&this.data[4]===0&&this.data[5]===0}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}clone(t){const i=t||new Zt;return i.data.set(this.data),i}toString(){return`
[${this.data[0]} ${this.data[2]} ${this.data[4]}]
[${this.data[1]} ${this.data[3]} ${this.data[5]}]
[0 0 1]
`}}class Is{constructor(){this._transforms=[],this._currentTransform=Zt.identity()}save(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}restore(){this._currentTransform=this._transforms.pop()}translate(t,i){return this._currentTransform.translate(t,i)}rotate(t){return this._currentTransform.rotate(t)}scale(t,i){return this._currentTransform.scale(t,i)}set current(t){this._currentTransform=t}get current(){return this._currentTransform}}class ns{constructor(){this.current=this._getDefaultState(),this._states=[]}_getDefaultState(){return{opacity:1,z:0,tint:nt.White,material:null}}_cloneState(){return{opacity:this.current.opacity,z:this.current.z,tint:this.current.tint.clone(),material:this.current.material}}save(){this._states.push(this.current),this.current=this._cloneState()}restore(){this.current=this._states.pop()}}const Ds={Complete:"complete",Load:"load",LoadStart:"loadstart",Progress:"progress",Error:"error"};class $t{constructor(t,i,r=!1){this.path=t,this.responseType=i,this.bustCache=r,this.data=null,this.logger=gt.getInstance(),this.events=new b}isLoaded(){return this.data!==null}_cacheBust(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}load(){return new Promise((t,i)=>{if(this.data!==null){this.logger.debug("Already have data for resource",this.path),this.events.emit("complete",this.data),t(this.data);return}const r=new XMLHttpRequest;r.open("GET",this.bustCache?this._cacheBust(this.path):this.path,!0),r.responseType=this.responseType,r.addEventListener("loadstart",l=>this.events.emit("loadstart",l)),r.addEventListener("progress",l=>this.events.emit("progress",l)),r.addEventListener("error",l=>this.events.emit("error",l)),r.addEventListener("load",l=>this.events.emit("load",l)),r.addEventListener("load",()=>{if(r.status!==0&&r.status!==200){this.logger.error("Failed to load resource ",this.path," server responded with error code",r.status),this.events.emit("error",r.response),i(new Error(r.statusText));return}this.data=r.response,this.events.emit("complete",this.data),this.logger.debug("Completed loading resource",this.path),t(this.data)}),r.send()})}}function ie(f,t){return f&&(f.__isProxy===void 0?new Proxy(f,{set:(i,r,l)=>(i[r]!==l&&(i[r]=l,typeof r=="string"&&r[0]!=="_"&&t(i)),!0),get:(i,r)=>r!=="__isProxy"?i[r]:!0}):f)}const Je=(f=[],t,i)=>({get:(r,l)=>l==="__isProxy"?!0:typeof r[l]=="object"&&r[l]!=null?new Proxy(r[l],Je([...f,l],t,i)):r[l],set:(r,l,c)=>(typeof l=="string"&&l[0]!=="_"&&t(i),r[l]=c,!0)});function ss(f,t){return f&&(f.__isProxy===void 0?new Proxy(f,Je([],t,f)):f)}function Oi(f,t){return f&&(f.__isProxy===void 0?new Proxy(f,{set:(i,r,l)=>(i[r]=l,typeof r=="string"&&r[0]!=="_"&&t(i),!0),get:(i,r)=>r!=="__isProxy"?i[r]:!0}):f)}class oe{isStale(){return this._transformStale}get flipHorizontal(){return this._flipHorizontal}set flipHorizontal(t){this._flipHorizontal=t,this._transformStale=!0}get flipVertical(){return this._flipVertical}set flipVertical(t){this._flipVertical=t,this._transformStale=!0}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._transformStale=!0}get scale(){return this._scale}set scale(t){this._scale=ie(t,()=>{this._transformStale=!0}),this._transformStale=!0}get origin(){return this._origin}set origin(t){this._origin=ie(t,()=>{this._transformStale=!0}),this._transformStale=!0}constructor(t){var i,r,l,c,g,m,w;this.id=oe._ID++,this.transform=Zt.identity(),this.tint=null,this._transformStale=!0,this.showDebug=!1,this._flipHorizontal=!1,this._flipVertical=!1,this._rotation=0,this.opacity=1,this._scale=D.One,this._origin=null,this._width=0,this._height=0,t&&(this.origin=(i=t.origin)!==null&&i!==void 0?i:this.origin,this.flipHorizontal=(r=t.flipHorizontal)!==null&&r!==void 0?r:this.flipHorizontal,this.flipVertical=(l=t.flipVertical)!==null&&l!==void 0?l:this.flipVertical,this.rotation=(c=t.rotation)!==null&&c!==void 0?c:this.rotation,this.opacity=(g=t.opacity)!==null&&g!==void 0?g:this.opacity,this.scale=(m=t.scale)!==null&&m!==void 0?m:this.scale,this.tint=(w=t.tint)!==null&&w!==void 0?w:this.tint)}cloneGraphicOptions(){return{width:this.width/this.scale.x,height:this.height/this.scale.y,origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null,tint:this.tint?this.tint.clone():null}}get width(){return Math.abs(this._width*this.scale.x)}get height(){return Math.abs(this._height*this.scale.y)}set width(t){this._width=t,this._transformStale=!0}set height(t){this._height=t,this._transformStale=!0}get localBounds(){return mt.fromDimension(this.width,this.height,D.Zero)}draw(t,i,r){this._preDraw(t,i,r),this._drawImage(t,0,0),this._postDraw(t)}_preDraw(t,i,r){t.save(),t.translate(i,r),this._transformStale&&(this.transform.reset(),this.transform.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(this.transform),this._flip(this.transform),this._transformStale=!1),t.multiply(this.transform),t.opacity=t.opacity*this.opacity,this.tint&&(t.tint=this.tint)}_rotate(t){var i;const r=this.scale.x>0?1:-1,l=this.scale.y>0?1:-1,c=(i=this.origin)!==null&&i!==void 0?i:j(this.width/2,this.height/2);t.translate(c.x,c.y),t.rotate(this.rotation),t.scale(r,l),t.translate(-c.x,-c.y)}_flip(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}_postDraw(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}oe._ID=0;class Js extends oe{static from(t){return new Js({image:t})}constructor(t){var i,r;super(t),this._logger=gt.getInstance(),this._dirty=!0,this.image=t.image;const{width:l,height:c}=t;this.sourceView=(i=t.sourceView)!==null&&i!==void 0?i:{x:0,y:0,width:l??0,height:c??0},this.destSize=(r=t.destSize)!==null&&r!==void 0?r:{width:l??0,height:c??0},this._updateSpriteDimensions(),this.image.ready.then(()=>{this._updateSpriteDimensions()})}get width(){return Math.abs(this.destSize.width*this.scale.x)}get height(){return Math.abs(this.destSize.height*this.scale.y)}set width(t){t/=Math.abs(this.scale.x),this.destSize.width=t,super.width=Math.ceil(this.destSize.width)}set height(t){t/=Math.abs(this.scale.y),this.destSize.height=t,super.height=Math.ceil(this.destSize.height)}_updateSpriteDimensions(){var t,i,r,l,c,g;const{width:m,height:w}=this.image;this.sourceView.width=((t=this.sourceView)===null||t===void 0?void 0:t.width)||m,this.sourceView.height=((i=this.sourceView)===null||i===void 0?void 0:i.height)||w,this.destSize.width=((r=this.destSize)===null||r===void 0?void 0:r.width)||((l=this.sourceView)===null||l===void 0?void 0:l.width)||m,this.destSize.height=((c=this.destSize)===null||c===void 0?void 0:c.height)||((g=this.sourceView)===null||g===void 0?void 0:g.height)||w,this.width=Math.ceil(this.destSize.width)*this.scale.x,this.height=Math.ceil(this.destSize.height)*this.scale.y}_preDraw(t,i,r){this.image.isLoaded()&&this._dirty&&(this._dirty=!1,this._updateSpriteDimensions()),super._preDraw(t,i,r)}_drawImage(t,i,r){this.image.isLoaded()?t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,i,r,this.destSize.width,this.destSize.height):this._logger.warnOnce(`ImageSource ${this.image.path} is not yet loaded and won't be drawn. Please call .load() or include in a Loader.

Read https://excaliburjs.com/docs/imagesource for more information.`)}clone(){return new Js({image:this.image,sourceView:{...this.sourceView},destSize:{...this.destSize},...this.cloneGraphicOptions()})}}var ae;(function(f){f.Pixel="Pixel",f.Blended="Blended"})(ae||(ae={}));function wo(f){switch(f){case ae.Pixel:return ae.Pixel;case ae.Blended:return ae.Blended;default:return null}}var Ce;(function(f){f.Clamp="Clamp",f.Repeat="Repeat",f.Mirror="Mirror"})(Ce||(Ce={}));function vn(f){switch(f){case Ce.Clamp:return Ce.Clamp;case Ce.Repeat:return Ce.Repeat;case Ce.Mirror:return Ce.Mirror;default:return Ce.Clamp}}class ne{constructor(t){this._textureMap=new Map,this._gl=t,ne._MAX_TEXTURE_SIZE=t.getParameter(t.MAX_TEXTURE_SIZE)}dispose(){for(const[t]of this._textureMap)this.delete(t);this._textureMap.clear(),this._gl=null}get(t){return this._textureMap.get(t)}has(t){return this._textureMap.has(t)}load(t,i,r=!1){const l=this._gl;if(!l)return null;const{filtering:c,wrapping:g}={...i};let m=null;if(this.has(t)&&(m=this.get(t)),m)return r&&(l.bindTexture(l.TEXTURE_2D,m),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,t)),m;m=l.createTexture(),ne.checkImageSizeSupportedAndLog(t),l.bindTexture(l.TEXTURE_2D,m),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);let w;g&&(typeof g=="string"?w={x:g,y:g}:w={x:g.x,y:g.y});const{x:C,y:A}=w??ne.wrapping;switch(C){case Ce.Clamp:l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE);break;case Ce.Repeat:l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT);break;case Ce.Mirror:l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.MIRRORED_REPEAT);break;default:l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE)}switch(A){case Ce.Clamp:l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);break;case Ce.Repeat:l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT);break;case Ce.Mirror:l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.MIRRORED_REPEAT);break;default:l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE)}const T=c??ne.filtering;return l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,T===ae.Pixel?l.NEAREST:l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,T===ae.Pixel?l.NEAREST:l.LINEAR),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,t),this._textureMap.set(t,m),m}delete(t){const i=this._gl;if(!i)return null;let r=null;this.has(t)&&(r=this.get(t),i.deleteTexture(r))}static checkImageSizeSupportedAndLog(t){var i;const r=(i=t.dataset.originalSrc)!==null&&i!==void 0?i:"internal canvas bitmap";return t.width>ne._MAX_TEXTURE_SIZE||t.height>ne._MAX_TEXTURE_SIZE?(ne._LOGGER.error(`The image [${r}] provided to Excalibur is too large for the device's maximum texture size of (${ne._MAX_TEXTURE_SIZE}x${ne._MAX_TEXTURE_SIZE}) please resize to an image for excalibur to render properly.

Images will likely render as black rectangles.

Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!1):((t.width>4096||t.height>4096)&&ne._LOGGER.warn(`The image [${r}] provided to excalibur is too large may not work on all mobile devices, it is recommended you resize images to a maximum (4096x4096).

Images will likely render as black rectangles on some mobile platforms.

Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!0)}}ne._LOGGER=gt.getInstance(),ne.filtering=ae.Blended,ne.wrapping={x:Ce.Clamp,y:Ce.Clamp},ne._MAX_TEXTURE_SIZE=4096;const ve={Filtering:"filtering",WrappingX:"wrapping-x",WrappingY:"wrapping-y"};class rs{get width(){return this.image.naturalWidth}get height(){return this.image.naturalHeight}isLoaded(){return this._src||(this._src=this.data.src),!!this._src}get image(){return this.data}constructor(t,i,r){this._logger=gt.getInstance(),this.data=new Image,this._readyFuture=new x,this.ready=this._readyFuture.promise,this.path=t;let l=!1,c;typeof i=="boolean"?l=i:{filtering:r,wrapping:c,bustCache:l}={...i},this._resource=new $t(t,"blob",l),this.filtering=r??this.filtering,typeof c=="string"?this.wrapping={x:c,y:c}:this.wrapping=c??this.wrapping,(t.endsWith(".svg")||t.endsWith(".gif"))&&this._logger.warn(`Image type is not fully supported, you may have mixed results ${t}. Fully supported: jpg, bmp, and png`)}static fromHtmlImageElement(t,i){const r=new rs("");if(r._src="image-element",r.data=t,r.data.setAttribute("data-original-src","image-element"),i!=null&&i.filtering?r.data.setAttribute(ve.Filtering,i==null?void 0:i.filtering):r.data.setAttribute(ve.Filtering,ae.Blended),i!=null&&i.wrapping){let l;typeof i.wrapping=="string"?l={x:i.wrapping,y:i.wrapping}:l={x:i.wrapping.x,y:i.wrapping.y},r.data.setAttribute(ve.WrappingX,l.x),r.data.setAttribute(ve.WrappingY,l.y)}else r.data.setAttribute(ve.WrappingX,Ce.Clamp),r.data.setAttribute(ve.WrappingY,Ce.Clamp);return ne.checkImageSizeSupportedAndLog(t),r._readyFuture.resolve(t),r}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){var t,i,r,l;if(this.isLoaded())return this.data;try{let c;if(this.path.includes("data:image/"))c=this.path;else{const w=await this._resource.load();c=URL.createObjectURL(w)}const g=new Image,m=new x;g.onload=()=>m.resolve(),g.src=c,g.setAttribute("data-original-src",this.path),await m.promise,this.data=g,ne.checkImageSizeSupportedAndLog(this.data)}catch(c){throw`Error loading ImageSource from path '${this.path}' with error [${c.message}]`}return this.data.setAttribute(ve.Filtering,this.filtering),this.data.setAttribute(ve.WrappingX,(i=(t=this.wrapping)===null||t===void 0?void 0:t.x)!==null&&i!==void 0?i:Ce.Clamp),this.data.setAttribute(ve.WrappingY,(l=(r=this.wrapping)===null||r===void 0?void 0:r.y)!==null&&l!==void 0?l:Ce.Clamp),this._readyFuture.resolve(this.data),this.data}toSprite(){return Js.from(this)}unload(){this.data=new Image}}class Ca extends oe{constructor(t){super(t),this._text="",this.alphabet="",this.shadow=null,this.caseInsensitive=!1,this.spacing=0,this.lineHeight=void 0,this._logger=gt.getInstance();const{alphabet:i,spriteSheet:r,caseInsensitive:l,spacing:c,shadow:g,lineHeight:m}=t;this.alphabet=i,this.spriteSheet=r,this.caseInsensitive=l??this.caseInsensitive,this.spacing=c??this.spacing,this.shadow=g??this.shadow,this.lineHeight=m??this.lineHeight}_getCharacterSprites(t){const i=[],r=this.caseInsensitive?t.toLocaleLowerCase():t,l=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet;for(let c=0;c<r.length;c++){const g=r[c];let m=l.indexOf(g);m===-1&&(m=0,this._logger.warnOnce(`SpriteFont - Cannot find letter '${g}' in configured alphabet '${l}'.`),this._logger.warnOnce("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."));const w=this.spriteSheet.sprites[m];w?i.push(w):(this._logger.warnOnce(`SpriteFont - Cannot find sprite for '${g}' at index '${m}' in configured SpriteSheet`),this._logger.warnOnce("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."))}return i}measureText(t,i){const r=this._getLinesFromText(t,i),l=r.reduce((w,C)=>w.length>C.length?w:C),c=this._getCharacterSprites(l);let g=0,m=0;for(const w of c)g+=w.width+this.spacing,m=Math.max(m,w.height);return mt.fromDimension(g,m*r.length,D.Zero)}_drawImage(t,i,r,l){var c;let g=0,m=0,w=0;const C=this._getLinesFromText(this._text,l);for(const A of C){for(const T of this._getCharacterSprites(A))T.draw(t,i+g,r+m),g+=T.width+this.spacing,w=Math.max(w,T.height);g=0,m+=(c=this.lineHeight)!==null&&c!==void 0?c:w}}render(t,i,r,l,c,g){this._text=i;const m=this.measureText(i,g);this.width=m.width,this.height=m.height,this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this._preDraw(t,l,c),this._drawImage(t,0,0,g),this._postDraw(t),t.restore()),this._preDraw(t,l,c),this._drawImage(t,0,0,g),this._postDraw(t)}clone(){return new Ca({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}_getLinesFromText(t,i){if(this._cachedText===t&&this._cachedRenderWidth===i)return this._cachedLines;const r=t.split(`
`);if(i==null)return r;for(let l=0;l<r.length;l++){let c=r[l],g="";if(this.measureText(c).width>i){for(;this.measureText(c).width>i;)g=c[c.length-1]+g,c=c.slice(0,-1);r[l]=c,r[l+1]=g}}return this._cachedText=t,this._cachedLines=r,this._cachedRenderWidth=i,r}}class yn{constructor(t){this.sprites=[];const{sprites:i,rows:r,columns:l}=t;this.sprites=i,this.rows=r??1,this.columns=l??this.sprites.length}getSprite(t,i,r){var l,c,g,m,w,C,A,T,M;if(t>=this.columns||t<0)throw Error(`No sprite exists in the SpriteSheet at (${t}, ${i}), x: ${t} should be between 0 and ${this.columns-1}`);if(i>=this.rows||i<0)throw Error(`No sprite exists in the SpriteSheet at (${t}, ${i}), y: ${i} should be between 0 and ${this.rows-1}`);const z=t+i*this.columns,W=this.sprites[z];if(W){if(r){const Z=W.clone();return Z.flipHorizontal=(l=r.flipHorizontal)!==null&&l!==void 0?l:Z.flipHorizontal,Z.flipVertical=(c=r.flipVertical)!==null&&c!==void 0?c:Z.flipVertical,Z.width=(g=r.width)!==null&&g!==void 0?g:Z.width,Z.height=(m=r.height)!==null&&m!==void 0?m:Z.height,Z.rotation=(w=r.rotation)!==null&&w!==void 0?w:Z.rotation,Z.scale=(C=r.scale)!==null&&C!==void 0?C:Z.scale,Z.opacity=(A=r.opacity)!==null&&A!==void 0?A:Z.opacity,Z.tint=(T=r.tint)!==null&&T!==void 0?T:Z.tint,Z.origin=(M=r.origin)!==null&&M!==void 0?M:Z.origin,Z}return W}throw Error(`Invalid sprite coordinates (${t}, ${i}`)}static fromImageSourceWithSourceViews(t){const i=t.sourceViews.map(r=>new Js({image:t.image,sourceView:r}));return new yn({sprites:i})}static fromImageSource(t){var i;const r=[];t.spacing=(i=t.spacing)!==null&&i!==void 0?i:{};const{image:l,grid:{rows:c,columns:g,spriteWidth:m,spriteHeight:w},spacing:{originOffset:C,margin:A}}=t,T={x:0,y:0,...C},M={x:0,y:0,...A};for(let z=0;z<g;z++)for(let W=0;W<c;W++)r[z+W*g]=new Js({image:l,sourceView:{x:z*m+M.x*z+T.x,y:W*w+M.y*W+T.y,width:m,height:w},destSize:{height:w,width:m}});return new yn({sprites:r,rows:c,columns:g})}clone(){return new yn({sprites:this.sprites.map(t=>t.clone()),rows:this.rows,columns:this.columns})}}const If="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAYAAAD1Xam+AAAAAXNSR0IArs4c6QAABlFJREFUeJztndmy4yoMRcWt/v9fdr8EWoDAaDD4JntVpeqcxBrMIGQDNhEAAAAAAAAAAAAAAOCrSbMfr+u6yoEpTY+906GV57YtPkjyXj9WZZ+wHWHfo2N3/bU6Tte9Rv6ptruqRyMvKvvIX/zY3I/vjLeqsg6l/CWdp0KHKO/1Y1H2EdsR9j06Ntdfp+N03SvkH2u7i3pu5XkQ+DNTkgNJSok+/183xpcdWZHjgUzpQ2pGD67vaf//KRAGAq3tdhCy2tcMQKPyXyz7iPqrdBjbX5h9g7xbtvWf4ZJvM4D/BKG24Sd+IkQ0TC9aW5NM5FbO2HgrPVzW2vmN50DZNv/QWtl5bfPy85SBtdy9dFmjsf2F2SehTBVE+u+tkE5+lAGcJlFwGuodwRRU2Qe3rx0FhPNflc3HWC7BEh8EDGVR5IMCiLnDONtPp87qhxVH/S/LvzUAuDs/kyGimA5oSONKR1w8vsLpv+v+S9vhmS71JRiX1xB5CWZNw7m6rMrllMag/RJyWb67BEgpDVMWSydc+K47pr35w05kWd7ReEq6116KaG4CsbJ7OmV9PdZLEKkONiC1/7ZONVgDsajLIJPYp2OUAXRpnPcGmnIE6eSK4nv5YQqqSYO52JqnYfYj/PdQXQIY7XszuMofMgZRT/1LdeC5h2I5/0EdWDMY2Yb05WDE1RodVdpSA5r85slArAVnSf+89iP896St0f5bZKVA7Gk/3ja8q+152/+wrLqBWZTem3IBADbRBoDuHgAA4HdAAADgh0EAAOCHQQAA4IdBAADgh0EAAOCHuVsKbJ3P9M7jjuxHzGfv8j9iDt47Dx7hP8cjq5F/o/0T62Aer//ZOgDrajBp6aNlOWTEajKLjgj/Pcs/vfZD/a++3Pc8hNfZ966EVeh5vP75luDRJUAl0KzJfnopaqbaTuzZiulc2BS5lltFXntu3dcQsXadl59Wn1H+dfYNtrt2d6D/LDF9HkCQw6eXFbr8P9X5W/un5Ol8gz1t39p5pWOPn0vLynbgdnfe8maEQw+UIPJdfxdOd/4oTtVD0IYg8wDywGas0I04T5O3P8/qf2UWwPpkn1PbOT1bN2tFe59EM7TvKf+TRFw+erZ2ey4hpS3hp9qBkqq/tjsSU1OYqucBWB1yynt5QxC42Mdk30pAEIio//zRG3feBzLUX+TTjCKwlH83aI/KbpQBVEHgUGF0j/SitcLofHem8q6AyH0wBhFv4WszuOjy0yK2vc/oRWQoP2X9ve78jfaLnpncbBqQSC6s0HnIRT0a2yNZjfxT8+ir8t+yDsDTWaS6X70GP33+d77stp+I5HtBdwEAAPBl8ECApcAA/DBvfSowAGAB7/05ZAAA/DAIAADMMU3fOuS2ggAAwBjrorKoxWiPBxHMAgAg490Ts0VeePdA+ZfJDKcCh7sBqY88mmjklZeOt9iXPrvx2I2QPRnN2/qzyJ84h4gNcbtfasq5mM1rZr+bBWh2A+bIIX13Z9wqL+nQvFno7v3oq4tJItCed7isUT6C/I7BUn9KP95wDicYBYpcjncrO2c/dmW4tBtw4RiRld1IDxDyYsoXMHxF1w3dyz0Nne8033AOFsT6VgRCafl89fenTZUfbm8CGhrgdDcS7anAsvnkkP0IeCfQ+JzYunky6jhNYj5bl7++4fJvN9WDSKS/292A0wyANyKDI91bfkm3kcH7ckaP/SKW/VHKRZAcI14pP3beu0fPyn/DuZQbWMogNnsc16sziE96f7H/iai7uTf0/3N8lwFz/e13T00Djt4OrInCnkeChXT+qOcKOLA21tJpsv/G8/COnGnw97J9QwbTvd6djYSv7fxEVTuV/LzNhj7nOawv6bfbAGCYEpQ6HxFtuxs6sq9tzOYHobQ6Nje+6vo5BwFrPZ4OgMayS4PPt1NlzdLfbRCYBoBc+NaO4JWPwLEf33oN3unY3InKPQBW6Z7nEZzEmrl4iZjC804lqgePPEOguQcwWghUphxm343wyt/pWpWR0OrR+jvyxavHajfb9pTjbt9bH07Z5/expM4TLWfwb7QQqMoC+UDWXZo/4RgA38LOgUvLJAAQ1Td9y9//0ylxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB+g79apuVUsS5ZmwAAAABJRU5ErkJggg==";class tr{constructor(){this.fontSheet=If,this.size=16,this.load()}load(){return this._imageSource=new rs(this.fontSheet),this._imageSource.load().then(()=>{this._spriteSheet=yn.fromImageSource({image:this._imageSource,grid:{rows:4,columns:16,spriteWidth:16,spriteHeight:16}}),this._spriteFont=new Ca({alphabet:`0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&."?-()+# `,caseInsensitive:!0,spriteSheet:this._spriteSheet,spacing:-6})})}write(t,i,r){this._imageSource.isLoaded()&&this._spriteFont.render(t,i,null,r.x,r.y)}}class Ir{constructor(t,i){this._gl=t,this._texture=i}use(){const t=this._gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._texture)}disable(){const t=this._gl;t.bindTexture(t.TEXTURE_2D,null)}}class Dr{constructor(t){var i,r;this.antialias=!1,this.samples=1,this._gl=t.gl,this.width=t.width,this.height=t.height,this.transparency=t.transparency,this.antialias=(i=t.antialias)!==null&&i!==void 0?i:this.antialias,this.samples=(r=t.samples)!==null&&r!==void 0?r:this._gl.getParameter(this._gl.MAX_SAMPLES);const l=this._gl;l.drawingBufferFormat?this.bufferFormat=l.drawingBufferFormat:this.transparency?this.bufferFormat=l.RGBA8:this.bufferFormat=l.RGB8,this._setupRenderBuffer(),this._setupFramebuffer()}setResolution(t,i){const r=this._gl;this.width=t,this.height=i,r.bindTexture(r.TEXTURE_2D,this._frameTexture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),this._renderBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,this._renderBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,Math.min(this.samples,r.getParameter(r.MAX_SAMPLES)),this.bufferFormat,this.width,this.height))}get renderBuffer(){return this._renderBuffer}get renderFrameBuffer(){return this._renderFrameBuffer}get frameBuffer(){return this._frameBuffer}get frameTexture(){return this._frameTexture}_setupRenderBuffer(){if(this.antialias){const t=this._gl;this._renderBuffer=t.createRenderbuffer(),this._renderFrameBuffer=t.createFramebuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this._renderBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,Math.min(this.samples,t.getParameter(t.MAX_SAMPLES)),this.bufferFormat,this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,this._renderFrameBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,this._renderBuffer)}}_setupFramebuffer(){const t=this._gl;this._frameTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._frameTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const i=t.COLOR_ATTACHMENT0;this._frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,i,t.TEXTURE_2D,this._frameTexture,0),this.disable()}toRenderSource(){return this.renderBuffer&&this.blitRenderBufferToFrameBuffer(),new Ir(this._gl,this._frameTexture)}blitToScreen(){const t=this._gl;this._renderBuffer?(t.bindFramebuffer(t.READ_FRAMEBUFFER,this.renderFrameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.clearBufferfv(t.COLOR,0,[0,0,1,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.LINEAR)):(t.bindFramebuffer(t.READ_FRAMEBUFFER,this.frameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.clearBufferfv(t.COLOR,0,[0,0,1,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.LINEAR))}blitRenderBufferToFrameBuffer(){if(this._renderBuffer){const t=this._gl;t.bindFramebuffer(t.READ_FRAMEBUFFER,this.renderFrameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.frameBuffer),t.clearBufferfv(t.COLOR,0,[0,0,1,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.LINEAR)}}copyToTexture(t){const i=this._gl;this._renderBuffer&&this.blitRenderBufferToFrameBuffer(),i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.bindTexture(i.TEXTURE_2D,t),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,this.width,this.height,0)}use(){const t=this._gl;this.antialias?t.bindFramebuffer(t.FRAMEBUFFER,this._renderFrameBuffer):t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.viewport(0,0,this.width,this.height)}disable(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null)}}const th=`#version 300 es\r
in vec2 a_position;\r
in vec4 a_color;\r
\r
out lowp vec4 v_color;\r
\r
uniform mat4 u_matrix;\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Passthrough the color\r
   v_color = a_color;\r
}`,eh=`#version 300 es\r
precision mediump float;\r
\r
// Color\r
in lowp vec4 v_color;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  fragColor = v_color;\r
}`;function xo(f,t){switch(t){case f.FLOAT:return 4;case f.SHORT:return 2;case f.UNSIGNED_SHORT:return 2;case f.BYTE:return 1;case f.UNSIGNED_BYTE:return 1;default:return 1}}function Sa(f,t){const i=`(?<type>[a-z0-9]+)\\s+${t};`,l=new RegExp(i,"g").exec(f);return(l==null?void 0:l.length)>0}function Aa(f,t,i){var r;const l=`(?<type>[a-z0-9]+)\\s+${i};`,g=new RegExp(l,"g").exec(t);switch((r=g==null?void 0:g.groups)===null||r===void 0?void 0:r.type){case"float":case"vec2":case"vec3":case"vec4":return f.FLOAT;case"int":case"ivec2":case"ivec3":case"ivec4":return f.INT;case"uint":case"uvec2":case"uvec3":case"uvec4":return f.UNSIGNED_INT;case"bool":case"bvec2":case"bvec3":case"bvec4":return f.BOOL;case"short":return f.SHORT;case"ushort":return f.UNSIGNED_SHORT;case"ubyte":return f.UNSIGNED_BYTE;case"byte":return f.BYTE;default:return f.FLOAT}}function Ea(f,t){switch(t){case f.LOW_FLOAT:case f.HIGH_FLOAT:case f.FLOAT:return 1;case f.FLOAT_VEC2:return 2;case f.FLOAT_VEC3:return 3;case f.FLOAT_VEC4:return 4;case f.BYTE:return 1;case f.UNSIGNED_BYTE:return 1;case f.UNSIGNED_SHORT:case f.SHORT:return 1;default:return 1}}function Ta(f,t){switch(t){case f.LOW_FLOAT:case f.HIGH_FLOAT:case f.FLOAT:case f.FLOAT_VEC2:case f.FLOAT_VEC3:case f.FLOAT_VEC4:return f.FLOAT;case f.BYTE:return f.BYTE;case f.UNSIGNED_BYTE:return f.UNSIGNED_BYTE;case f.SHORT:return f.SHORT;case f.UNSIGNED_SHORT:return f.UNSIGNED_SHORT;default:return f.FLOAT}}class bi{get compiled(){return this._compiled}constructor(t){this._logger=gt.getInstance(),this.uniforms={},this.attributes={},this._compiled=!1;const{gl:i,vertexSource:r,fragmentSource:l}=t;this._gl=i,this.vertexSource=r,this.fragmentSource=l}dispose(){this._gl.deleteProgram(this.program),this._gl=null}use(){this._gl.useProgram(this.program),bi._ACTIVE_SHADER_INSTANCE=this}isCurrentlyBound(){return bi._ACTIVE_SHADER_INSTANCE===this}compile(){const t=this._gl,i=this._compileShader(t,this.vertexSource,t.VERTEX_SHADER),r=this._compileShader(t,this.fragmentSource,t.FRAGMENT_SHADER);this.program=this._createProgram(t,i,r);const l=this.getAttributes();for(const g of l)this.attributes[g.name]=g;const c=this.getUniforms();for(const g of c)this.uniforms[g.name]=g;return this._compiled=!0,this.program}getUniforms(){const t=this._gl,i=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),r=[];for(let l=0;l<i;l++){const c=t.getActiveUniform(this.program,l),g=t.getUniformLocation(this.program,c.name);r.push({name:c.name,glType:c.type,location:g})}return r}getAttributes(){const t=this._gl,i=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),r=[];for(let l=0;l<i;l++){const c=t.getActiveAttrib(this.program,l),g=t.getAttribLocation(this.program,c.name);r.push({name:c.name,glType:Ta(t,c.type),size:Ea(t,c.type),location:g,normalized:!1})}return r}setTexture(t,i){const r=this._gl;r.activeTexture(r.TEXTURE0+t),r.bindTexture(r.TEXTURE_2D,i)}setUniformInt(t,i){this.setUniform("uniform1i",t,~~i)}trySetUniformInt(t,i){return this.trySetUniform("uniform1i",t,~~i)}setUniformIntArray(t,i){this.setUniform("uniform1iv",t,i)}trySetUniformIntArray(t,i){return this.trySetUniform("uniform1iv",t,i)}setUniformBoolean(t,i){this.setUniform("uniform1i",t,i?1:0)}trySetUniformBoolean(t,i){return this.trySetUniform("uniform1i",t,i?1:0)}setUniformFloat(t,i){this.setUniform("uniform1f",t,i)}trySetUniformFloat(t,i){return this.trySetUniform("uniform1f",t,i)}setUniformFloatArray(t,i){this.setUniform("uniform1fv",t,i)}trySetUniformFloatArray(t,i){return this.trySetUniform("uniform1fv",t,i)}setUniformFloatVector(t,i){this.setUniform("uniform2f",t,i.x,i.y)}trySetUniformFloatVector(t,i){return this.trySetUniform("uniform2f",t,i.x,i.y)}setUniformFloatColor(t,i){this.setUniform("uniform4f",t,i.r/255,i.g/255,i.b/255,i.a)}trySetUniformFloatColor(t,i){return this.trySetUniform("uniform4f",t,i.r/255,i.g/255,i.b/255,i.a)}setUniformMatrix(t,i){this.setUniform("uniformMatrix4fv",t,!1,i.data)}trySetUniformMatrix(t,i){return this.trySetUniform("uniformMatrix4fv",t,!1,i.data)}setUniform(t,i,...r){if(!this._compiled)throw Error(`Must compile shader before setting a uniform ${t}:${i}`);if(!this.isCurrentlyBound())throw Error("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms");const c=this._gl.getUniformLocation(this.program,i);if(c){const g=[c,...r];this._gl[t].apply(this._gl,g)}else throw Error(`Uniform ${t}:${i} doesn't exist or is not used in the shader source code, unused uniforms are optimized away by most browsers`)}trySetUniform(t,i,...r){if(!this._compiled)return this._logger.warn(`Must compile shader before setting a uniform ${t}:${i}`),!1;if(!this.isCurrentlyBound())return this._logger.warn("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms"),!1;const c=this._gl.getUniformLocation(this.program,i);if(c){const g=[c,...r];this._gl[t].apply(this._gl,g)}else return!1;return!0}_createProgram(t,i,r){const l=t.createProgram();if(l===null)throw Error("Could not create graphics shader program");if(t.attachShader(l,i),t.attachShader(l,r),t.linkProgram(l),!t.getProgramParameter(l,t.LINK_STATUS))throw Error(`Could not link the program: [${t.getProgramInfoLog(l)}]`);return l}_compileShader(t,i,r){const l=t.VERTEX_SHADER===r?"vertex":"fragment",c=t.createShader(r);if(c===null)throw Error(`Could not build shader: [${i}]`);if(t.shaderSource(c,i),t.compileShader(c),!t.getShaderParameter(c,t.COMPILE_STATUS)){const m=t.getShaderInfoLog(c);throw Error(`Could not compile ${l} shader:

${m}${this._processSourceForError(i,m)}`)}return c}_processSourceForError(t,i){if(!t)return i;const r=t.split(`
`),l=i.search(/\d:\d/),c=i.indexOf(" ",l),[g,m]=i.slice(l,c).split(":").map(w=>Number(w));for(let w=0;w<r.length;w++)r[w]=`${w+1}: ${r[w]}${m===w+1?" <----- ERROR!":""}`;return`

Source:
`+r.join(`
`)}}bi._ACTIVE_SHADER_INSTANCE=null;class os{constructor(t){this.type="dynamic";const{gl:i,size:r,type:l,data:c}=t;if(this._gl=i,this.buffer=this._gl.createBuffer(),!c&&!r)throw Error("Must either provide data or a size to the VertexBuffer");c?this.bufferData=c:this.bufferData=new Float32Array(r),this.type=l??this.type,i.bindBuffer(i.ARRAY_BUFFER,this.buffer),i.bufferData(i.ARRAY_BUFFER,this.bufferData,this.type==="static"?i.STATIC_DRAW:i.DYNAMIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}unbind(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,null)}upload(t){const i=this._gl;i.bindBuffer(i.ARRAY_BUFFER,this.buffer),t?i.bufferSubData(i.ARRAY_BUFFER,0,this.bufferData,0,t):i.bufferData(i.ARRAY_BUFFER,this.bufferData,this.type==="static"?i.STATIC_DRAW:i.DYNAMIC_DRAW)}dispose(){this._gl.deleteBuffer(this.buffer),this._gl=null}}class as{get vertexBuffer(){return this._vertexBuffer}get attributes(){return this._attributes}constructor(t){this._logger=gt.getInstance(),this._suppressWarnings=!1,this._layout=[],this._attributes=[],this._vertexTotalSizeBytes=0,this._initialized=!1;const{gl:i,shader:r,vertexBuffer:l,attributes:c,suppressWarnings:g}=t;this._gl=i,this._vertexBuffer=l,this._attributes=c,this._shader=r,this._suppressWarnings=g,r&&this.initialize()}get totalVertexSizeBytes(){return this._vertexTotalSizeBytes}set shader(t){t&&this._shader!==t&&(this._shader=t,this.initialize())}get shader(){return this._shader}initialize(){if(this._initialized||!this._shader)return;if(!this._shader.compiled)throw Error("Shader not compiled, shader must be compiled before defining a vertex layout");this._vertexTotalSizeBytes=0,this._layout.length=0;const t=this._shader.attributes;for(const c of this._attributes){const g=t[c[0]];if(!g){if(!Sa(this._shader.vertexSource,c[0]))throw Error(`The attribute named: ${c[0]} size ${c[1]} not found in the shader source code:
 ${this._shader.vertexSource}`);this._suppressWarnings||this._logger.warn(`The attribute named: ${c[0]} size ${c[1]} not found in the compiled shader. This is possibly a bug:
 1. Not a bug, but should remove unused code - attribute "${c[0]}" is unused in vertex/fragment and has been automatically removed by glsl compiler.
 2. Definitely a bug, attribute "${c[0]}" in layout has been mistyped or is missing in shader, check vertex/fragment source.`);const m=Aa(this._gl,this._shader.vertexSource,c[0]);this._layout.push({name:c[0],glType:m,size:c[1],location:-1,normalized:!1})}if(g){if(g.size!==c[1])throw Error(`VertexLayout size definition for attribute: [${c[0]}, ${c[1]}], doesn't match shader source size ${g.size}:
 ${this._shader.vertexSource}`);this._layout.push(g)}}let i=0;for(const c of this._layout){const g=xo(this._gl,c.glType);this._vertexTotalSizeBytes+=g*c.size,i+=c.size}this._vertexBuffer.bufferData.length%i!==0&&this._logger.warn(`The vertex component size (${i})  does NOT divide evenly into the specified vertex buffer (${this._vertexBuffer.bufferData.length})`);const r=this._gl;this._vao=r.createVertexArray(),r.bindVertexArray(this._vao),this._vertexBuffer.bind();let l=0;for(const c of this._layout)c.location!==-1&&(r.vertexAttribPointer(c.location,c.size,c.glType,c.normalized,this.totalVertexSizeBytes,l),r.enableVertexAttribArray(c.location)),l+=xo(r,c.glType)*c.size;r.bindVertexArray(null),this._vertexBuffer.unbind(),this._initialized=!0}use(t=!1,i){if(!this._shader)throw Error("No shader is associated with this vertex layout, a shader must be set");const r=this._gl;if(!this._shader.isCurrentlyBound())throw Error("Shader associated with this vertex layout is not active! Call shader.use() before layout.use()");this._vertexBuffer.bind(),t&&this._vertexBuffer.upload(i),r.bindVertexArray(this._vao)}}class ye{static clear(){ye.DrawCallCount=0,ye.DrawnImagesCount=0}}ye.DrawCallCount=0,ye.DrawnImagesCount=0;class qu{constructor(){this.type="ex.line",this.priority=0,this._maxLines=10922,this._vertexIndex=0,this._lineCount=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new bi({gl:t,vertexSource:th,fragmentSource:eh}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._vertexBuffer=new os({gl:t,size:6*2*this._maxLines,type:"dynamic"}),this._layout=new as({gl:t,vertexBuffer:this._vertexBuffer,shader:this._shader,attributes:[["a_position",2],["a_color",4]]})}dispose(){this._vertexBuffer.dispose(),this._shader.dispose(),this._context=null,this._gl=null}draw(t,i,r){this._isFull()&&this.flush(),this._lineCount++;const l=this._context.getTransform(),c=l.multiply(t),g=l.multiply(i),m=this._vertexBuffer.bufferData;m[this._vertexIndex++]=c.x,m[this._vertexIndex++]=c.y,m[this._vertexIndex++]=r.r/255,m[this._vertexIndex++]=r.g/255,m[this._vertexIndex++]=r.b/255,m[this._vertexIndex++]=r.a,m[this._vertexIndex++]=g.x,m[this._vertexIndex++]=g.y,m[this._vertexIndex++]=r.r/255,m[this._vertexIndex++]=r.g/255,m[this._vertexIndex++]=r.b/255,m[this._vertexIndex++]=r.a}_isFull(){return this._lineCount>=this._maxLines}hasPendingDraws(){return this._lineCount!==0}flush(){if(this._lineCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.LINES,0,this._lineCount*2),ye.DrawnImagesCount+=this._lineCount,ye.DrawCallCount++,this._vertexIndex=0,this._lineCount=0}}const Zu=`#version 300 es\r
in vec2 a_position;\r
in vec4 a_color;\r
in float a_size;\r
out lowp vec4 v_color;\r
uniform mat4 u_matrix;\r
\r
void main() {\r
  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
  gl_PointSize = a_size * 2.0;\r
  v_color = a_color;\r
}`,Df=`#version 300 es\r
\r
precision mediump float;\r
in lowp vec4 v_color;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  float r = 0.0, delta = 0.0, alpha = 1.0;\r
  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r
  r = dot(cxy, cxy);\r
\r
  delta = fwidth(r);\r
  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r
  // "premultiply" the color by alpha\r
  vec4 color = v_color;\r
  color.a = color.a * alpha;\r
  color.rgb = color.rgb * color.a;\r
  fragColor = color;\r
}`;class Ff{constructor(){this.type="ex.point",this.priority=0,this._maxPoints=10922,this._pointCount=0,this._vertexIndex=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new bi({gl:t,vertexSource:Zu,fragmentSource:Df}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._buffer=new os({gl:t,size:7*this._maxPoints,type:"dynamic"}),this._layout=new as({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_color",4],["a_size",1]]})}dispose(){this._buffer.dispose(),this._shader.dispose(),this._context=null,this._gl=null}draw(t,i,r){this._isFull()&&this.flush(),this._pointCount++;const l=this._context.getTransform(),c=this._context.opacity,g=this._context.snapToPixel,m=l.multiply(t);g&&(m.x=~~(m.x+Wt),m.y=~~(m.y+Wt));const w=this._buffer.bufferData;w[this._vertexIndex++]=m.x,w[this._vertexIndex++]=m.y,w[this._vertexIndex++]=i.r/255,w[this._vertexIndex++]=i.g/255,w[this._vertexIndex++]=i.b/255,w[this._vertexIndex++]=i.a*c,w[this._vertexIndex++]=r*Math.max(l.getScaleX(),l.getScaleY())}_isFull(){return this._pointCount>=this._maxPoints}hasPendingDraws(){return this._pointCount!==0}flush(){if(this._pointCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.POINTS,0,this._pointCount),ye.DrawnImagesCount+=this._pointCount,ye.DrawCallCount++,this._pointCount=0,this._vertexIndex=0}}const Bf=`#version 300 es\r
in vec2 a_position;\r
\r
in vec2 a_texcoord;\r
out vec2 v_texcoord;\r
\r
void main() {\r
  gl_Position = vec4(a_position, 0.0, 1.0);\r
\r
  // Pass the texcoord to the fragment shader.\r
  v_texcoord = a_texcoord;\r
}`,kf=`#version 300 es\r
precision mediump float;\r
\r
// Passed in from the vertex shader.\r
in vec2 v_texcoord;\r
\r
// The texture.\r
uniform sampler2D u_texture;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
   fragColor = texture(u_texture, v_texcoord);\r
}`;class Ku{constructor(t){this._gl=t,this._shader=new bi({gl:t,vertexSource:Bf,fragmentSource:kf}),this._shader.compile(),this._buffer=new os({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new as({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}renderWithPostProcessor(t){const i=this._gl;t.getShader().use(),t.getLayout().use(),i.drawArrays(i.TRIANGLES,0,6)}renderToScreen(){const t=this._gl;this._shader.use(),this._layout.use(),t.drawArrays(t.TRIANGLES,0,6)}}class bo{constructor(t,i,r){this._logger=gt.getInstance(),this._gl=t,this.buffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer);const l=i*6;if(!r)this.bufferData=new Uint32Array(l);else{const m=Math.floor(16383.5);this.bufferGlType=t.UNSIGNED_SHORT,this.bufferData=new Uint16Array(l),i>m&&this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${m}) requested quads(${i})`)}let c=0;for(let g=0;g<l;g+=6)this.bufferData[g+0]=c+0,this.bufferData[g+1]=c+1,this.bufferData[g+2]=c+2,this.bufferData[g+3]=c+2,this.bufferData[g+4]=c+1,this.bufferData[g+5]=c+3,c+=4;t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}get size(){return this.bufferData.length}upload(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer)}dispose(){this._gl.deleteBuffer(this.buffer),this._gl=null}}const Lf=`#version 300 es\r
precision mediump float;\r
\r
// UV coord\r
in vec2 v_texcoord;\r
\r
// Texture index\r
in lowp float v_textureIndex;\r
\r
// Textures in the current draw\r
uniform sampler2D u_textures[%%count%%];\r
\r
uniform bool u_pixelart;\r
\r
// Opacity\r
in float v_opacity;\r
\r
in vec4 v_tint;\r
\r
in vec2 v_res;\r
\r
out vec4 fragColor;\r
\r
// Inigo Quilez pixel art filter https://jorenjoestar.github.io/post/pixel_art_filtering/\r
vec2 uv_iq(in vec2 uv, in vec2 texture_size) {\r
  vec2 pixel = uv * texture_size;\r
  \r
  vec2 seam=floor(pixel+.5);\r
  vec2 dudv=fwidth(pixel);\r
  pixel=seam+clamp((pixel-seam)/dudv,-.5,.5);\r
  \r
  return pixel/texture_size;\r
}\r
\r
void main(){\r
  // In order to support the most efficient sprite batching, we have multiple\r
  // textures loaded into the gpu (usually 8) this picker logic skips over textures\r
  // that do not apply to a particular sprite.\r
  \r
  vec4 color=vec4(1.,0,0,1.);\r
  \r
  // GLSL is templated out to pick the right texture and set the vec4 color\r
  %%texture_picker%%\r
  \r
  color.rgb=color.rgb*v_opacity;\r
  color.a=color.a*v_opacity;\r
  fragColor=color*v_tint;\r
}`,Mf=`#version 300 es\r
in vec2 a_position;\r
\r
// Opacity\r
in float a_opacity;\r
out float v_opacity;\r
\r
// UV coordinate\r
in vec2 a_texcoord;\r
out vec2 v_texcoord;\r
\r
// Texture res\r
in vec2 a_res;\r
out vec2 v_res;\r
\r
// Texture number\r
in lowp float a_textureIndex;\r
out lowp float v_textureIndex;\r
\r
in vec4 a_tint;\r
out vec4 v_tint;\r
\r
uniform mat4 u_matrix;\r
\r
void main(){\r
  // Set the vertex position using the ortho transform matrix\r
  gl_Position=u_matrix*vec4(a_position,0.,1.);\r
  \r
  // Pass through the Opacity to the fragment shader\r
  v_opacity=a_opacity;\r
  // Pass through the UV coord to the fragment shader\r
  v_texcoord=a_texcoord;\r
\r
  v_res = a_res;\r
\r
  // Pass through the texture number to the fragment shader\r
  v_textureIndex=a_textureIndex;\r
  // Pass through the tint\r
  v_tint=a_tint;\r
}`;class ih{constructor(t){this.type="ex.image",this.priority=0,this._maxImages=10922,this._maxTextures=0,this._imageCount=0,this._textures=[],this._textureIndex=0,this._textureToIndex=new Map,this._images=new Set,this._vertexIndex=0,this._imageToWidth=new Map,this._imageToHeight=new Map,this._view=[0,0,0,0],this._dest=[0,0],this._quad=[0,0,0,0,0,0,0,0],this.pixelArtSampler=t.pixelArtSampler,this.uvPadding=t.uvPadding}initialize(t,i){this._gl=t,this._context=i,this._maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),125);const r=this._transformFragmentSource(Lf,this._maxTextures);this._shader=new bi({gl:t,fragmentSource:r,vertexSource:Mf}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",i.ortho),this._shader.setUniformIntArray("u_textures",[...Array(this._maxTextures)].map((l,c)=>c)),this._buffer=new os({gl:t,size:12*4*this._maxImages,type:"dynamic"}),this._layout=new as({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_opacity",1],["a_res",2],["a_texcoord",2],["a_textureIndex",1],["a_tint",4]]}),this._quads=new bo(t,this._maxImages,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._shader.dispose(),this._textures.length=0,this._context=null,this._gl=null}_transformFragmentSource(t,i){let r=t.replace("%%count%%",i.toString()),l="";for(let c=0;c<i;c++)c===0?l+=`if (v_textureIndex <= ${c}.5) {
`:l+=`   else if (v_textureIndex <= ${c}.5) {
`,l+=`      vec2 uv = u_pixelart ? uv_iq(v_texcoord, v_res) : v_texcoord;
`,l+=`      color = texture(u_textures[${c}], uv);
`,l+=`   }
`;return r=r.replace("%%texture_picker%%",l),r}_addImageAsTexture(t){if(this._images.has(t))return;const i=t.getAttribute(ve.Filtering),r=i?wo(i):null,l=vn(t.getAttribute(ve.WrappingX)),c=vn(t.getAttribute(ve.WrappingY)),g=t.getAttribute("forceUpload")==="true",m=this._context.textureLoader.load(t,{filtering:r,wrapping:{x:l,y:c}},g);t.removeAttribute("forceUpload"),this._textures.indexOf(m)===-1&&(this._textures.push(m),this._textureToIndex.set(m,this._textureIndex++),this._images.add(t))}_bindTextures(t){for(let i=0;i<this._maxTextures;i++)t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,this._textures[i]||this._textures[0])}_getTextureIdForImage(t){var i;if(t){const r=this._context.textureLoader.get(t);return(i=this._textureToIndex.get(r))!==null&&i!==void 0?i:-1}return-1}_isFull(){return this._imageCount>=this._maxImages||this._textures.length>=this._maxTextures}_getImageWidth(t){let i=this._imageToWidth.get(t);return i===void 0&&(i=t.width,this._imageToWidth.set(t,i)),i}_getImageHeight(t){let i=this._imageToHeight.get(t);return i===void 0&&(i=t.height,this._imageToHeight.set(t,i)),i}draw(t,i,r,l,c,g,m,w,C){var A,T,M,z;this._isFull()&&this.flush(),this._imageCount++,this._addImageAsTexture(t);const W=this._getImageWidth(t),Z=this._getImageHeight(t);let st=W||l||0,q=Z||c||0;this._view[0]=0,this._view[1]=0,this._view[2]=(A=l??W)!==null&&A!==void 0?A:0,this._view[3]=(T=c??Z)!==null&&T!==void 0?T:0,this._dest[0]=i??1,this._dest[1]=r??1,g!==void 0&&m!==void 0&&w!==void 0&&C!==void 0&&(this._view[0]=i??1,this._view[1]=r??1,this._view[2]=(M=l??W)!==null&&M!==void 0?M:0,this._view[3]=(z=c??Z)!==null&&z!==void 0?z:0,this._dest[0]=g,this._dest[1]=m,st=w,q=C),i=this._view[0],r=this._view[1];const Q=this._view[2],ot=this._view[3],et=this._context.getTransform(),_t=this._context.opacity,Nt=this._context.snapToPixel;this._quad[0]=this._dest[0],this._quad[1]=this._dest[1],this._quad[2]=this._dest[0]+st,this._quad[3]=this._dest[1],this._quad[4]=this._dest[0],this._quad[5]=this._dest[1]+q,this._quad[6]=this._dest[0]+st,this._quad[7]=this._dest[1]+q,et.multiplyQuadInPlace(this._quad),Nt&&(this._quad[0]=~~(this._quad[0]+$(this._quad[0])*Wt),this._quad[1]=~~(this._quad[1]+$(this._quad[1])*Wt),this._quad[2]=~~(this._quad[2]+$(this._quad[2])*Wt),this._quad[3]=~~(this._quad[3]+$(this._quad[3])*Wt),this._quad[4]=~~(this._quad[4]+$(this._quad[4])*Wt),this._quad[5]=~~(this._quad[5]+$(this._quad[5])*Wt),this._quad[6]=~~(this._quad[6]+$(this._quad[6])*Wt),this._quad[7]=~~(this._quad[7]+$(this._quad[7])*Wt));const at=this._context.tint,Rt=this._getTextureIdForImage(t),we=W||st,_e=Z||q,Ii=(i+this.uvPadding)/we,Di=(r+this.uvPadding)/_e,vi=(i+Q-this.uvPadding)/we,Fi=(r+ot-this.uvPadding)/_e,hi=W,ui=Z,At=this._layout.vertexBuffer.bufferData;At[this._vertexIndex++]=this._quad[0],At[this._vertexIndex++]=this._quad[1],At[this._vertexIndex++]=_t,At[this._vertexIndex++]=hi,At[this._vertexIndex++]=ui,At[this._vertexIndex++]=Ii,At[this._vertexIndex++]=Di,At[this._vertexIndex++]=Rt,At[this._vertexIndex++]=at.r/255,At[this._vertexIndex++]=at.g/255,At[this._vertexIndex++]=at.b/255,At[this._vertexIndex++]=at.a,At[this._vertexIndex++]=this._quad[4],At[this._vertexIndex++]=this._quad[5],At[this._vertexIndex++]=_t,At[this._vertexIndex++]=hi,At[this._vertexIndex++]=ui,At[this._vertexIndex++]=Ii,At[this._vertexIndex++]=Fi,At[this._vertexIndex++]=Rt,At[this._vertexIndex++]=at.r/255,At[this._vertexIndex++]=at.g/255,At[this._vertexIndex++]=at.b/255,At[this._vertexIndex++]=at.a,At[this._vertexIndex++]=this._quad[2],At[this._vertexIndex++]=this._quad[3],At[this._vertexIndex++]=_t,At[this._vertexIndex++]=hi,At[this._vertexIndex++]=ui,At[this._vertexIndex++]=vi,At[this._vertexIndex++]=Di,At[this._vertexIndex++]=Rt,At[this._vertexIndex++]=at.r/255,At[this._vertexIndex++]=at.g/255,At[this._vertexIndex++]=at.b/255,At[this._vertexIndex++]=at.a,At[this._vertexIndex++]=this._quad[6],At[this._vertexIndex++]=this._quad[7],At[this._vertexIndex++]=_t,At[this._vertexIndex++]=hi,At[this._vertexIndex++]=ui,At[this._vertexIndex++]=vi,At[this._vertexIndex++]=Fi,At[this._vertexIndex++]=Rt,At[this._vertexIndex++]=at.r/255,At[this._vertexIndex++]=at.g/255,At[this._vertexIndex++]=at.b/255,At[this._vertexIndex++]=at.a}hasPendingDraws(){return this._imageCount!==0}flush(){if(this._imageCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0,4*12*this._imageCount),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._shader.setUniformBoolean("u_pixelart",this.pixelArtSampler),this._bindTextures(t),this._quads.bind(),t.drawElements(t.TRIANGLES,this._imageCount*6,this._quads.bufferGlType,0),ye.DrawnImagesCount+=this._imageCount,ye.DrawCallCount++,this._imageCount=0,this._vertexIndex=0,this._textures.length=0,this._textureIndex=0,this._textureToIndex.clear(),this._images.clear(),this._imageToWidth.clear(),this._imageToHeight.clear()}}const Of=`#version 300 es\r
\r
precision mediump float;\r
\r
// UV coord\r
in vec2 v_uv;\r
\r
in vec2 v_size; // in pixels\r
\r
// Color coord to blend with image\r
in lowp vec4 v_color;\r
\r
// Stroke color if used\r
in lowp vec4 v_strokeColor;\r
\r
// Stroke thickness if used\r
in lowp float v_strokeThickness; // in pixels\r
\r
// Opacity\r
in float v_opacity;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r
    vec2 uv = v_uv;\r
    vec2 fragCoord = uv * v_size;\r
    float maxX = v_size.x - v_strokeThickness;\r
    float minX = v_strokeThickness;\r
    float maxY = v_size.y - v_strokeThickness;\r
    float minY = v_strokeThickness;\r
\r
    if (fragCoord.x < maxX && fragCoord.x > minX &&\r
        fragCoord.y < maxY && fragCoord.y > minY) {\r
      fragColor = v_color;\r
    } else {\r
      fragColor = v_strokeColor;\r
    }\r
    fragColor.a *= v_opacity;\r
    fragColor.rgb *= fragColor.a;\r
\r
    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\r
    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\r
\r
    // float fHalfBorderDist      = 0.0;\r
    // float fHalfBorderThickness = 0.0;\r
\r
    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \r
    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\r
    // {\r
    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\r
    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r
    // }\r
    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \r
    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\r
    // {\r
    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\r
    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r
    // }\r
    // else\r
    // {\r
    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\r
    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\r
    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\r
        \r
    //     float ellipse_ab    = v_radius-v_strokeThickness;\r
    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\r
    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \r
            \r
    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\r
    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\r
    // }\r
\r
    // vec4 v4FromColor = v_strokeColor;\r
    // v4FromColor.rgb *= v4FromColor.a;\r
    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\r
    // if (fHalfBorderDist < 0.0) {\r
    //     v4ToColor = v_color;\r
    //     v4ToColor.rgb *= v4ToColor.a;\r
    // }\r
\r
    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\r
\r
    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\r
    // gl_FragColor = finalColor;\r
}`,nh=`#version 300 es\r
in vec2 a_position;\r
\r
// UV coordinate\r
in vec2 a_uv;\r
out vec2 v_uv;\r
\r
in vec2 a_size;\r
out vec2 v_size;\r
\r
// Opacity \r
in float a_opacity;\r
out float v_opacity;\r
\r
in vec4 a_color;\r
out vec4 v_color;\r
\r
in vec4 a_strokeColor;\r
out vec4 v_strokeColor;\r
\r
in float a_strokeThickness;\r
out float v_strokeThickness;\r
\r
uniform mat4 u_matrix;\r
\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Pass through UV coords\r
   v_uv = a_uv;\r
   // Pass through size\r
   v_size = a_size;\r
   // Pass through the Opacity to the fragment shader\r
   v_opacity = a_opacity;\r
   // Pass through the color to the fragment shader\r
   v_color = a_color;\r
   // Pass through the stroke color to the fragment shader\r
   v_strokeColor = a_strokeColor;\r
   // Pass through the stroke thickenss to the fragment shader\r
   v_strokeThickness = a_strokeThickness;\r
}`;class Nf{constructor(){this.type="ex.rectangle",this.priority=0,this._maxRectangles=10922,this._rectangleCount=0,this._vertexIndex=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new bi({gl:t,fragmentSource:Of,vertexSource:nh}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",i.ortho),this._buffer=new os({gl:t,size:16*4*this._maxRectangles,type:"dynamic"}),this._layout=new as({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_size",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new bo(t,this._maxRectangles,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._shader.dispose(),this._context=null,this._gl=null}_isFull(){return this._rectangleCount>=this._maxRectangles}draw(...t){t[0]instanceof D&&t[1]instanceof D?this.drawLine.apply(this,t):this.drawRectangle.apply(this,t)}drawLine(t,i,r,l=1){this._isFull()&&this.flush(),this._rectangleCount++;const c=this._context.getTransform(),g=this._context.opacity,m=this._context.snapToPixel,w=i.sub(t),C=w.size,A=w.normalize().perpendicular(),T=l/2,M=c.multiply(A.scale(T).add(t)),z=c.multiply(A.scale(-T).add(t)),W=c.multiply(A.scale(T).add(i)),Z=c.multiply(A.scale(-T).add(i));m&&(M.x=~~(M.x+Wt),M.y=~~(M.y+Wt),W.x=~~(W.x+Wt),W.y=~~(W.y+Wt),z.x=~~(z.x+Wt),z.y=~~(z.y+Wt),Z.x=~~(Z.x+Wt),Z.y=~~(Z.y+Wt));const st=0,q=0,Q=1,ot=1,et=nt.Transparent,_t=0,Nt=1,at=this._layout.vertexBuffer.bufferData;at[this._vertexIndex++]=M.x,at[this._vertexIndex++]=M.y,at[this._vertexIndex++]=st,at[this._vertexIndex++]=q,at[this._vertexIndex++]=C,at[this._vertexIndex++]=l,at[this._vertexIndex++]=g,at[this._vertexIndex++]=r.r/255,at[this._vertexIndex++]=r.g/255,at[this._vertexIndex++]=r.b/255,at[this._vertexIndex++]=r.a,at[this._vertexIndex++]=et.r/255,at[this._vertexIndex++]=et.g/255,at[this._vertexIndex++]=et.b/255,at[this._vertexIndex++]=et.a,at[this._vertexIndex++]=_t/Nt,at[this._vertexIndex++]=z.x,at[this._vertexIndex++]=z.y,at[this._vertexIndex++]=st,at[this._vertexIndex++]=ot,at[this._vertexIndex++]=C,at[this._vertexIndex++]=l,at[this._vertexIndex++]=g,at[this._vertexIndex++]=r.r/255,at[this._vertexIndex++]=r.g/255,at[this._vertexIndex++]=r.b/255,at[this._vertexIndex++]=r.a,at[this._vertexIndex++]=et.r/255,at[this._vertexIndex++]=et.g/255,at[this._vertexIndex++]=et.b/255,at[this._vertexIndex++]=et.a,at[this._vertexIndex++]=_t/Nt,at[this._vertexIndex++]=W.x,at[this._vertexIndex++]=W.y,at[this._vertexIndex++]=Q,at[this._vertexIndex++]=q,at[this._vertexIndex++]=C,at[this._vertexIndex++]=l,at[this._vertexIndex++]=g,at[this._vertexIndex++]=r.r/255,at[this._vertexIndex++]=r.g/255,at[this._vertexIndex++]=r.b/255,at[this._vertexIndex++]=r.a,at[this._vertexIndex++]=et.r/255,at[this._vertexIndex++]=et.g/255,at[this._vertexIndex++]=et.b/255,at[this._vertexIndex++]=et.a,at[this._vertexIndex++]=_t/Nt,at[this._vertexIndex++]=Z.x,at[this._vertexIndex++]=Z.y,at[this._vertexIndex++]=Q,at[this._vertexIndex++]=ot,at[this._vertexIndex++]=C,at[this._vertexIndex++]=l,at[this._vertexIndex++]=g,at[this._vertexIndex++]=r.r/255,at[this._vertexIndex++]=r.g/255,at[this._vertexIndex++]=r.b/255,at[this._vertexIndex++]=r.a,at[this._vertexIndex++]=et.r/255,at[this._vertexIndex++]=et.g/255,at[this._vertexIndex++]=et.b/255,at[this._vertexIndex++]=et.a,at[this._vertexIndex++]=_t/Nt}drawRectangle(t,i,r,l,c=nt.Transparent,g=0){this._isFull()&&this.flush(),this._rectangleCount++;const m=this._context.getTransform(),w=this._context.opacity,C=this._context.snapToPixel,A=m.multiply(t.add(j(0,0))),T=m.multiply(t.add(j(i,0))),M=m.multiply(t.add(j(i,r))),z=m.multiply(t.add(j(0,r)));C&&(A.x=~~(A.x+Wt),A.y=~~(A.y+Wt),T.x=~~(T.x+Wt),T.y=~~(T.y+Wt),z.x=~~(z.x+Wt),z.y=~~(z.y+Wt),M.x=~~(M.x+Wt),M.y=~~(M.y+Wt));const W=0,Z=0,st=1,q=1,Q=this._layout.vertexBuffer.bufferData;Q[this._vertexIndex++]=A.x,Q[this._vertexIndex++]=A.y,Q[this._vertexIndex++]=W,Q[this._vertexIndex++]=Z,Q[this._vertexIndex++]=i,Q[this._vertexIndex++]=r,Q[this._vertexIndex++]=w,Q[this._vertexIndex++]=l.r/255,Q[this._vertexIndex++]=l.g/255,Q[this._vertexIndex++]=l.b/255,Q[this._vertexIndex++]=l.a,Q[this._vertexIndex++]=c.r/255,Q[this._vertexIndex++]=c.g/255,Q[this._vertexIndex++]=c.b/255,Q[this._vertexIndex++]=c.a,Q[this._vertexIndex++]=g,Q[this._vertexIndex++]=z.x,Q[this._vertexIndex++]=z.y,Q[this._vertexIndex++]=W,Q[this._vertexIndex++]=q,Q[this._vertexIndex++]=i,Q[this._vertexIndex++]=r,Q[this._vertexIndex++]=w,Q[this._vertexIndex++]=l.r/255,Q[this._vertexIndex++]=l.g/255,Q[this._vertexIndex++]=l.b/255,Q[this._vertexIndex++]=l.a,Q[this._vertexIndex++]=c.r/255,Q[this._vertexIndex++]=c.g/255,Q[this._vertexIndex++]=c.b/255,Q[this._vertexIndex++]=c.a,Q[this._vertexIndex++]=g,Q[this._vertexIndex++]=T.x,Q[this._vertexIndex++]=T.y,Q[this._vertexIndex++]=st,Q[this._vertexIndex++]=Z,Q[this._vertexIndex++]=i,Q[this._vertexIndex++]=r,Q[this._vertexIndex++]=w,Q[this._vertexIndex++]=l.r/255,Q[this._vertexIndex++]=l.g/255,Q[this._vertexIndex++]=l.b/255,Q[this._vertexIndex++]=l.a,Q[this._vertexIndex++]=c.r/255,Q[this._vertexIndex++]=c.g/255,Q[this._vertexIndex++]=c.b/255,Q[this._vertexIndex++]=c.a,Q[this._vertexIndex++]=g,Q[this._vertexIndex++]=M.x,Q[this._vertexIndex++]=M.y,Q[this._vertexIndex++]=st,Q[this._vertexIndex++]=q,Q[this._vertexIndex++]=i,Q[this._vertexIndex++]=r,Q[this._vertexIndex++]=w,Q[this._vertexIndex++]=l.r/255,Q[this._vertexIndex++]=l.g/255,Q[this._vertexIndex++]=l.b/255,Q[this._vertexIndex++]=l.a,Q[this._vertexIndex++]=c.r/255,Q[this._vertexIndex++]=c.g/255,Q[this._vertexIndex++]=c.b/255,Q[this._vertexIndex++]=c.a,Q[this._vertexIndex++]=g}hasPendingDraws(){return this._rectangleCount!==0}flush(){if(this._rectangleCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,this._rectangleCount*6,this._quads.bufferGlType,0),ye.DrawnImagesCount+=this._rectangleCount,ye.DrawCallCount++,this._rectangleCount=0,this._vertexIndex=0}}const Uf=`#version 300 es\r
precision highp float;\r
\r
// UV coord\r
in vec2 v_uv;\r
\r
// Color coord to blend with image\r
in lowp vec4 v_color;\r
\r
// Stroke color if used\r
in lowp vec4 v_strokeColor;\r
\r
// Stroke thickness if used\r
in lowp float v_strokeThickness;\r
\r
// Opacity\r
in float v_opacity;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  // make (0, 0) the center the uv \r
  vec2 uv = v_uv * 2.0 - 1.0;\r
\r
  vec4 color = v_color;\r
  vec4 strokeColor = v_strokeColor;\r
\r
  // circle border is at radius 1.0 \r
  // dist is > 0 when inside the circle \r
  float d = length(uv);\r
  float dist = 1.0 - length(uv);\r
\r
  // Fade based on fwidth\r
  float fade = fwidth(dot(uv, uv));\r
\r
  // if dist is greater than 0 step to 1;\r
  // when we cross this 0 threshold add a smooth fade\r
  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\r
\r
  // if dist is greater than the stroke thickness step to 1\r
  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\r
\r
  strokeColor.a *= fill * stroke;\r
  strokeColor.rgb *= strokeColor.a;\r
\r
  color.a *= fill * (1.0 - stroke);\r
  color.rgb *= color.a;\r
\r
  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\r
  finalColor.rgb = finalColor.rgb * v_opacity;\r
  finalColor.a = finalColor.a * v_opacity;\r
  fragColor = finalColor;\r
}`,zf=`#version 300 es\r
in vec2 a_position;\r
\r
// UV coordinate\r
in vec2 a_uv;\r
out vec2 v_uv;\r
\r
// Opacity \r
in float a_opacity;\r
out float v_opacity;\r
\r
in vec4 a_color;\r
out vec4 v_color;\r
\r
in vec4 a_strokeColor;\r
out vec4 v_strokeColor;\r
\r
in float a_strokeThickness;\r
out float v_strokeThickness;\r
\r
uniform mat4 u_matrix;\r
\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Pass through UV coords\r
   v_uv = a_uv;\r
   // Pass through the Opacity to the fragment shader\r
   v_opacity = a_opacity;\r
   // Pass through the color to the fragment shader\r
   v_color = a_color;\r
   // Pass through the stroke color to the fragment shader\r
   v_strokeColor = a_strokeColor;\r
   // Pass through the stroke thickenss to the fragment shader\r
   v_strokeThickness = a_strokeThickness;\r
}`;class Hf{constructor(){this.type="ex.circle",this.priority=0,this._maxCircles=10922,this._circleCount=0,this._vertexIndex=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new bi({gl:t,fragmentSource:Uf,vertexSource:zf}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",i.ortho),this._buffer=new os({gl:t,size:14*4*this._maxCircles,type:"dynamic"}),this._layout=new as({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new bo(t,this._maxCircles,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._shader.dispose(),this._context=null,this._gl=null}_isFull(){return this._circleCount>=this._maxCircles}draw(t,i,r,l=nt.Transparent,c=0){this._isFull()&&this.flush(),this._circleCount++;const g=this._context.getTransform(),m=this._context.opacity,w=this._context.snapToPixel,C=g.multiply(t.add(j(-i,-i))),A=g.multiply(t.add(j(i,-i))),T=g.multiply(t.add(j(i,i))),M=g.multiply(t.add(j(-i,i)));w&&(C.x=~~(C.x+Wt),C.y=~~(C.y+Wt),A.x=~~(A.x+Wt),A.y=~~(A.y+Wt),M.x=~~(M.x+Wt),M.y=~~(M.y+Wt),T.x=~~(T.x+Wt),T.y=~~(T.y+Wt));const z=0,W=0,Z=1,st=1,q=this._layout.vertexBuffer.bufferData;q[this._vertexIndex++]=C.x,q[this._vertexIndex++]=C.y,q[this._vertexIndex++]=z,q[this._vertexIndex++]=W,q[this._vertexIndex++]=m,q[this._vertexIndex++]=r.r/255,q[this._vertexIndex++]=r.g/255,q[this._vertexIndex++]=r.b/255,q[this._vertexIndex++]=r.a,q[this._vertexIndex++]=l.r/255,q[this._vertexIndex++]=l.g/255,q[this._vertexIndex++]=l.b/255,q[this._vertexIndex++]=l.a,q[this._vertexIndex++]=c/i,q[this._vertexIndex++]=M.x,q[this._vertexIndex++]=M.y,q[this._vertexIndex++]=z,q[this._vertexIndex++]=st,q[this._vertexIndex++]=m,q[this._vertexIndex++]=r.r/255,q[this._vertexIndex++]=r.g/255,q[this._vertexIndex++]=r.b/255,q[this._vertexIndex++]=r.a,q[this._vertexIndex++]=l.r/255,q[this._vertexIndex++]=l.g/255,q[this._vertexIndex++]=l.b/255,q[this._vertexIndex++]=l.a,q[this._vertexIndex++]=c/i,q[this._vertexIndex++]=A.x,q[this._vertexIndex++]=A.y,q[this._vertexIndex++]=Z,q[this._vertexIndex++]=W,q[this._vertexIndex++]=m,q[this._vertexIndex++]=r.r/255,q[this._vertexIndex++]=r.g/255,q[this._vertexIndex++]=r.b/255,q[this._vertexIndex++]=r.a,q[this._vertexIndex++]=l.r/255,q[this._vertexIndex++]=l.g/255,q[this._vertexIndex++]=l.b/255,q[this._vertexIndex++]=l.a,q[this._vertexIndex++]=c/i,q[this._vertexIndex++]=T.x,q[this._vertexIndex++]=T.y,q[this._vertexIndex++]=Z,q[this._vertexIndex++]=st,q[this._vertexIndex++]=m,q[this._vertexIndex++]=r.r/255,q[this._vertexIndex++]=r.g/255,q[this._vertexIndex++]=r.b/255,q[this._vertexIndex++]=r.a,q[this._vertexIndex++]=l.r/255,q[this._vertexIndex++]=l.g/255,q[this._vertexIndex++]=l.b/255,q[this._vertexIndex++]=l.a,q[this._vertexIndex++]=c/i}hasPendingDraws(){return this._circleCount!==0}flush(){if(this._circleCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,this._circleCount*6,this._quads.bufferGlType,0),ye.DrawnImagesCount+=this._circleCount,ye.DrawCallCount++,this._circleCount=0,this._vertexIndex=0}}class Ju{constructor(t,i,r=100){this.builder=t,this.recycler=i,this.maxObjects=r,this.totalAllocations=0,this.index=0,this.objects=[],this.disableWarnings=!1,this._logger=gt.getInstance()}dispose(){this.objects.length=0}preallocate(){for(let t=0;t<this.maxObjects;t++)this.objects[t]=this.builder()}using(t){const i=t(this);return i?this.done(...i):this.done()}borrow(t){const i=this.get();t(i),this.index--}get(){return this.index===this.maxObjects&&(this.disableWarnings||this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=this.maxObjects*2),this.objects[this.index]?this.recycler(this.objects[this.index++]):(this.totalAllocations++,this.objects[this.index++]=this.builder())}done(...t){this.index=0;for(const i of t){const r=this.objects.indexOf(i);this.objects[r]=this.builder(),this.totalAllocations++}return t}}class Wf{constructor(){this.z=0,this.priority=0,this.transform=Zt.identity(),this.state={z:0,opacity:1,tint:nt.White,material:null}}}const jf=`#version 300 es
in vec2 a_position;

in vec2 a_uv;
out vec2 v_uv;

in vec2 a_screenuv;
out vec2 v_screenuv;

uniform mat4 u_matrix;
uniform mat4 u_transform;

void main() {
  // Set the vertex position using the ortho & transform matrix
  gl_Position = u_matrix * u_transform * vec4(a_position, 0.0, 1.0);

  // Pass through the UV coord to the fragment shader
  v_uv = a_uv;
  v_screenuv = a_screenuv;
}
`;class tc{constructor(t){this._logger=gt.getInstance(),this._color=nt.Transparent,this._initialized=!1,this._images=new Map,this._textures=new Map;const{color:i,name:r,vertexSource:l,fragmentSource:c,graphicsContext:g,images:m}=t;if(this._name=r??"anonymous material",this._vertexSource=l??jf,this._fragmentSource=c,this._color=i??this._color,!g)throw Error(`Material ${r} must be provided an excalibur webgl graphics context`);if(g instanceof ls?(this._graphicsContext=g,this._initialize(g)):this._logger.warn(`Material ${r} was created in 2D Canvas mode, currently only WebGL is supported`),m)for(const w in m)this.addImageSource(w,m[w])}_initialize(t){if(this._initialized)return;const i=t.__gl;this._maxTextureSlots=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS)-2,this._shader=t.createShader({vertexSource:this._vertexSource,fragmentSource:this._fragmentSource}),this._shader.compile(),this._initialized=!0}get name(){var t;return(t=this._name)!==null&&t!==void 0?t:"anonymous material"}get isUsingScreenTexture(){return this._fragmentSource.includes("u_screen_texture")}update(t){this._shader&&(this._shader.use(),t(this._shader))}getShader(){return this._shader}addImageSource(t,i){this._images.size<this._maxTextureSlots?this._images.set(t,i):this._logger.warn(`Max number texture slots ${this._maxTextureSlots} have been reached for material "${this.name}", no more textures will be uploaded due to hardware constraints.`)}removeImageSource(t){const i=this._images.get(t);this._graphicsContext.textureLoader.delete(i.image),this._images.delete(t)}_loadImageSource(t){const i=t.image,r=i.getAttribute(ve.Filtering),l=r?wo(r):null,c=vn(i.getAttribute(ve.WrappingX)),g=vn(i.getAttribute(ve.WrappingY)),m=i.getAttribute("forceUpload")==="true",w=this._graphicsContext.textureLoader.load(i,{filtering:l,wrapping:{x:c,y:g}},m);return i.removeAttribute("forceUpload"),this._textures.has(t)||this._textures.set(t,w),w}uploadAndBind(t,i=2){let r=i;for(const[l,c]of this._images.entries()){if(!c.isLoaded()){this._logger.warnOnce(`Image named ${l} in material ${this.name} not loaded, nothing will be uploaded to the shader. Did you forget to add this to a loader? https://excaliburjs.com/docs/loaders/`);continue}const g=this._loadImageSource(c);t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,g),this._shader.trySetUniformInt(l,r),r++}}use(){if(this._initialized)this._shader.use(),this._shader.trySetUniformFloatColor("u_color",this._color);else throw Error(`Material ${this.name} not yet initialized, use the ExcaliburGraphicsContext.createMaterial() to work around this.`)}}class sh{constructor(){this.type="ex.material",this.priority=0,this._textures=[]}initialize(t,i){this._gl=t,this._context=i,this._buffer=new os({gl:t,size:6*4,type:"dynamic"}),this._layout=new as({gl:t,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_screenuv",2]],suppressWarnings:!0}),this._quads=new bo(t,1,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._textures.length=0,this._context=null,this._gl=null}draw(t,i,r,l,c,g,m,w,C){var A,T,M,z;const W=this._gl,Z=this._context.material,st=this._context.getTransform(),q=this._context.opacity,Q=Z.getShader(),ot=this._layout.vertexBuffer.bufferData;let et=0,_t=(t==null?void 0:t.width)||l||0,Nt=(t==null?void 0:t.height)||c||0,at=[0,0,(A=l??(t==null?void 0:t.width))!==null&&A!==void 0?A:0,(T=c??(t==null?void 0:t.height))!==null&&T!==void 0?T:0],Rt=[i??1,r??1];g!==void 0&&m!==void 0&&w!==void 0&&C!==void 0&&(at=[i??1,r??1,(M=l??(t==null?void 0:t.width))!==null&&M!==void 0?M:0,(z=c??(t==null?void 0:t.height))!==null&&z!==void 0?z:0],Rt=[g,m],_t=w,Nt=C),i=at[0],r=at[1];const we=at[2],_e=at[3],Ii=j(Rt[0],Rt[1]),Di=j(Rt[0]+_t,Rt[1]),vi=j(Rt[0],Rt[1]+Nt),Fi=j(Rt[0]+_t,Rt[1]+Nt),hi=t.width||_t,ui=t.height||Nt,At=i/hi,Vs=r/ui,cr=(i+we-.01)/hi,Xs=(r+_e-.01)/ui,dr=st.getPosition(),Bi=dr.add(Fi),Tn=dr.x/this._context.width,kc=dr.y/this._context.height,Lc=Bi.x/this._context.width,ta=Bi.y/this._context.height;ot[et++]=Ii.x,ot[et++]=Ii.y,ot[et++]=At,ot[et++]=Vs,ot[et++]=Tn,ot[et++]=kc,ot[et++]=vi.x,ot[et++]=vi.y,ot[et++]=At,ot[et++]=Xs,ot[et++]=Tn,ot[et++]=ta,ot[et++]=Di.x,ot[et++]=Di.y,ot[et++]=cr,ot[et++]=Vs,ot[et++]=Lc,ot[et++]=kc,ot[et++]=Fi.x,ot[et++]=Fi.y,ot[et++]=cr,ot[et++]=Xs,ot[et++]=Lc,ot[et++]=ta;const Qr=this._addImageAsTexture(t);Z.use(),this._layout.shader=Q,this._layout.use(!0),Q.trySetUniformFloat("u_time_ms",performance.now()),Q.trySetUniformFloat("u_opacity",q),Q.trySetUniformFloatVector("u_resolution",j(this._context.width,this._context.height)),Q.trySetUniformFloatVector("u_graphic_resolution",j(hi,ui)),Q.trySetUniformFloatVector("u_size",j(we,_e)),Q.trySetUniformMatrix("u_matrix",this._context.ortho),Q.trySetUniformMatrix("u_transform",st.to4x4()),W.activeTexture(W.TEXTURE0+0),W.bindTexture(W.TEXTURE_2D,Qr),Q.trySetUniformInt("u_graphic",0),W.activeTexture(W.TEXTURE0+1),W.bindTexture(W.TEXTURE_2D,this._context.materialScreenTexture),Q.trySetUniformInt("u_screen_texture",1),Z.uploadAndBind(W),this._quads.bind(),W.drawElements(W.TRIANGLES,6,this._quads.bufferGlType,0),ye.DrawnImagesCount++,ye.DrawCallCount++}_addImageAsTexture(t){const i=t.getAttribute(ve.Filtering),r=i?wo(i):null,l=vn(t.getAttribute(ve.WrappingX)),c=vn(t.getAttribute(ve.WrappingY)),g=t.getAttribute("forceUpload")==="true",m=this._context.textureLoader.load(t,{filtering:r,wrapping:{x:l,y:c}},g);return t.removeAttribute("forceUpload"),this._textures.indexOf(m)===-1&&this._textures.push(m),m}hasPendingDraws(){return!1}flush(){}}const Wt=1e-4;class Gf{constructor(t){this._webglCtx=t,this._debugText=new tr}drawRect(t,i,r,l,c={color:nt.Black}){this.drawLine(j(t,i),j(t+r,i),{...c}),this.drawLine(j(t+r,i),j(t+r,i+l),{...c}),this.drawLine(j(t+r,i+l),j(t,i+l),{...c}),this.drawLine(j(t,i+l),j(t,i),{...c})}drawLine(t,i,r={color:nt.Black}){this._webglCtx.draw("ex.line",t,i,r.color)}drawPoint(t,i={color:nt.Black,size:5}){this._webglCtx.draw("ex.point",t,i.color,i.size)}drawText(t,i){this._debugText.write(this._webglCtx,t,i)}}class ls{get z(){return this._state.current.z}set z(t){this._state.current.z=t}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get width(){return this.__gl.canvas.width}get height(){return this.__gl.canvas.height}get ortho(){return this._ortho}checkIfResolutionSupported(t){let i=!0;return(t.width>4096||t.height>4096)&&(i=!1),i}constructor(t){this._logger=gt.getInstance(),this._renderers=new Map,this._isDrawLifecycle=!1,this.useDrawSorting=!0,this._drawCallPool=new Ju(()=>new Wf,Z=>(Z.priority=0,Z.z=0,Z.renderer=void 0,Z.args=void 0,Z),4e3),this._drawCallIndex=0,this._drawCalls=new Array(4e3).fill(null),this._postProcessTargets=[],this._postprocessors=[],this._transform=new Is,this._state=new ns,this.snapToPixel=!1,this.smoothing=!1,this.pixelArtSampler=!1,this.uvPadding=.01,this.backgroundColor=nt.ExcaliburBlue,this.multiSampleAntialiasing=!0,this.transparency=!0,this._isContextLost=!1,this._disposed=!1,this._imageToWidth=new Map,this._imageToHeight=new Map,this.debug=new Gf(this),this._totalPostProcessorTime=0;const{canvasElement:i,context:r,enableTransparency:l,antialiasing:c,uvPadding:g,multiSampleAntialiasing:m,pixelArtSampler:w,powerPreference:C,snapToPixel:A,backgroundColor:T,useDrawSorting:M,handleContextLost:z,handleContextRestored:W}=t;if(this.__gl=r??i.getContext("webgl2",{antialias:c??this.smoothing,premultipliedAlpha:!1,alpha:l??this.transparency,depth:!1,powerPreference:C??"high-performance"}),!this.__gl)throw Error("Failed to retrieve webgl context from browser");z&&this.__gl.canvas.addEventListener("webglcontextlost",z,!1),W&&this.__gl.canvas.addEventListener("webglcontextrestored",W,!1),this.__gl.canvas.addEventListener("webglcontextlost",()=>{this._isContextLost=!0}),this.__gl.canvas.addEventListener("webglcontextrestored",()=>{this._isContextLost=!1}),this.textureLoader=new ne(this.__gl),this.snapToPixel=A??this.snapToPixel,this.smoothing=c??this.smoothing,this.transparency=l??this.transparency,this.pixelArtSampler=w??this.pixelArtSampler,this.uvPadding=g??this.uvPadding,this.multiSampleAntialiasing=typeof m=="boolean"?m:this.multiSampleAntialiasing,this.samples=typeof m=="object"?m.samples:void 0,this.backgroundColor=T??this.backgroundColor,this.useDrawSorting=M??this.useDrawSorting,this._drawCallPool.disableWarnings=!0,this._drawCallPool.preallocate(),this._init()}dispose(){if(!this._disposed){this._disposed=!0,this.textureLoader.dispose();for(const t of this._renderers.values())t.dispose();this._renderers.clear(),this._drawCallPool.dispose(),this._drawCalls.length=0,this.__gl=null}}_init(){const t=this.__gl;this._ortho=ge.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.register(new ih({uvPadding:this.uvPadding,pixelArtSampler:this.pixelArtSampler})),this.register(new sh),this.register(new Nf),this.register(new Hf),this.register(new Ff),this.register(new qu),this.materialScreenTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.materialScreenTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.bindTexture(t.TEXTURE_2D,null),this._screenRenderer=new Ku(t),this._renderTarget=new Dr({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height}),this._postProcessTargets=[new Dr({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height}),new Dr({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height})],this._msaaTarget=new Dr({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height,antialias:this.multiSampleAntialiasing,samples:this.samples})}register(t){this._renderers.set(t.type,t),t.initialize(this.__gl,this)}get(t){return this._renderers.get(t)}_isCurrentRenderer(t){return!this._currentRenderer||this._currentRenderer===t}beginDrawLifecycle(){this._isDrawLifecycle=!0}endDrawLifecycle(){this._isDrawLifecycle=!1}draw(t,...i){if(this._isDrawLifecycle||this._logger.warnOnce(`Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.
If you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler.`),this._isContextLost){this._logger.errorOnce(`Unable to draw ${t}, the webgl context is lost`);return}const r=this._renderers.get(t);if(r)if(this.useDrawSorting){const l=this._drawCallPool.get();l.z=this._state.current.z,l.priority=r.priority,l.renderer=t,this.getTransform().clone(l.transform),l.state.z=this._state.current.z,l.state.opacity=this._state.current.opacity,l.state.tint=this._state.current.tint,l.state.material=this._state.current.material,l.args=i,this._drawCalls[this._drawCallIndex++]=l}else this._currentRenderer||(this._currentRenderer=r),this._isCurrentRenderer(r)||this._currentRenderer.flush(),r.draw(...i),this._currentRenderer=r;else throw Error(`No renderer with name ${t} has been registered`)}resetTransform(){this._transform.current=Zt.identity()}updateViewport(t){const i=this.__gl;this._ortho=this._ortho=ge.ortho(0,t.width,t.height,0,400,-400),this._renderTarget.setResolution(i.canvas.width,i.canvas.height),this._msaaTarget.setResolution(i.canvas.width,i.canvas.height),this._postProcessTargets[0].setResolution(i.canvas.width,i.canvas.height),this._postProcessTargets[1].setResolution(i.canvas.width,i.canvas.height)}_getImageWidth(t){let i=this._imageToWidth.get(t);return i===void 0&&(i=t.width,this._imageToWidth.set(t,i)),i}_getImageHeight(t){let i=this._imageToHeight.get(t);return i===void 0&&(i=t.height,this._imageToHeight.set(t,i)),i}drawImage(t,i,r,l,c,g,m,w,C){if(!(l===0||c===0)){{if(w===0||C===0)return;if(this._getImageWidth(t)===0||this._getImageHeight(t)===0)return}if(!t){gt.getInstance().warn("Cannot draw a null or undefined image"),console.trace&&console.trace();return}this._state.current.material?this.draw("ex.material",t,i,r,l,c,g,m,w,C):this.draw("ex.image",t,i,r,l,c,g,m,w,C)}}drawLine(t,i,r,l=1){this.draw("ex.rectangle",t,i,r,l)}drawRectangle(t,i,r,l,c,g){this.draw("ex.rectangle",t,i,r,l,c,g)}drawCircle(t,i,r,l,c){this.draw("ex.circle",t,i,r,l,c)}save(){this._transform.save(),this._state.save()}restore(){this._transform.restore(),this._state.restore()}translate(t,i){this._transform.translate(this.snapToPixel?~~(t+Wt):t,this.snapToPixel?~~(i+Wt):i)}rotate(t){this._transform.rotate(t)}scale(t,i){this._transform.scale(t,i)}transform(t){this._transform.current=t}getTransform(){return this._transform.current}multiply(t){this._transform.current.multiply(t,this._transform.current)}addPostProcessor(t){this._postprocessors.push(t),t.initialize(this.__gl)}removePostProcessor(t){const i=this._postprocessors.indexOf(t);i!==-1&&this._postprocessors.splice(i,1)}clearPostProcessors(){this._postprocessors.length=0}updatePostProcessors(t){for(const i of this._postprocessors){const r=i.getShader();r.use();const l=r.getUniforms();this._totalPostProcessorTime+=t,l.find(c=>c.name==="u_time_ms")&&r.setUniformFloat("u_time_ms",this._totalPostProcessorTime),l.find(c=>c.name==="u_elapsed_ms")&&r.setUniformFloat("u_elapsed_ms",t),l.find(c=>c.name==="u_resolution")&&r.setUniformFloatVector("u_resolution",j(this.width,this.height)),i.onUpdate&&i.onUpdate(t)}}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){return new tc({...t,graphicsContext:this})}createShader(t){const i=this.__gl,{vertexSource:r,fragmentSource:l}=t,c=new bi({gl:i,vertexSource:r,fragmentSource:l});return c.compile(),c}clear(){const t=this.__gl;(this.multiSampleAntialiasing?this._msaaTarget:this._renderTarget).use(),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT)}flush(){if(this._isContextLost){this._logger.errorOnce("Unable to flush the webgl context is lost");return}let t=this.multiSampleAntialiasing?this._msaaTarget:this._renderTarget;if(t.use(),this.useDrawSorting){for(let c=this._drawCallIndex;c<this._drawCalls.length;c++)this._drawCalls[c]=null;const i=new Map;for(const[c]of this._renderers){let g=0;for(g=0;g<this._drawCallIndex&&this._drawCalls[g].renderer!==c;g++);i.set(c,g)}this._drawCalls.sort((c,g)=>{if(c===null||g===null)return 0;const m=c.z-g.z,w=i.get(c.renderer)-i.get(g.renderer),C=c.priority-g.priority;return m===0?C===0?w:C:m});const r=this._transform.current,l=this._state.current;if(this._drawCalls.length&&this._drawCallIndex){let c=this._drawCalls[0].renderer,g=this._renderers.get(c);for(let m=0;m<this._drawCallIndex;m++)this._transform.current=this._drawCalls[m].transform,this._state.current=this._drawCalls[m].state,this._drawCalls[m].renderer!==c&&(g.flush(),c=this._drawCalls[m].renderer,g=this._renderers.get(c)),g instanceof sh&&this.material.isUsingScreenTexture&&(t.copyToTexture(this.materialScreenTexture),t.use()),g.draw(...this._drawCalls[m].args);g.hasPendingDraws()&&g.flush()}this._transform.current=r,this._state.current=l,this._drawCallPool.done(),this._drawCallIndex=0,this._imageToHeight.clear(),this._imageToWidth.clear()}else for(const i of this._renderers.values())i.hasPendingDraws()&&i.flush();t.disable(),this._postprocessors.length>0&&t.toRenderSource().use();for(let i=0;i<this._postprocessors.length;i++)t=this._postProcessTargets[i%2],this._postProcessTargets[i%2].use(),this._screenRenderer.renderWithPostProcessor(this._postprocessors[i]),this._postProcessTargets[i%2].toRenderSource().use();t.blitToScreen()}}const Se=1e-4;class Vf{constructor(t){this._ex=t,this._debugText=new tr}drawRect(t,i,r,l){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~(t+Se):t,this._ex.snapToPixel?~~(i+Se):i,this._ex.snapToPixel?~~(r+Se):r,this._ex.snapToPixel?~~(l+Se):l),this._ex.__ctx.restore()}drawLine(t,i,r={color:nt.Black}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=r.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~(t.x+Se):t.x,this._ex.snapToPixel?~~(t.y+Se):t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~(i.x+Se):i.x,this._ex.snapToPixel?~~(i.y+Se):i.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawPoint(t,i={color:nt.Black,size:5}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=i.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~(t.x+Se):t.x,this._ex.snapToPixel?~~(t.y+Se):t.y,i.size,0,Math.PI*2),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawText(t,i){this._debugText.write(this._ex,t,i)}}class Pa{get width(){return this.__ctx.canvas.width}get height(){return this.__ctx.canvas.height}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get smoothing(){return this.__ctx.imageSmoothingEnabled}set smoothing(t){this.__ctx.imageSmoothingEnabled=t}constructor(t){this.useDrawSorting=!1,this.z=0,this.backgroundColor=nt.ExcaliburBlue,this._state=new ns,this.snapToPixel=!1,this.debug=new Vf(this);const{canvasElement:i,context:r,enableTransparency:l,snapToPixel:c,antialiasing:g,backgroundColor:m}=t;if(this.__ctx=r??i.getContext("2d",{alpha:l??!0}),!this.__ctx)throw new Error("Cannot build new ExcaliburGraphicsContext2D for some reason!");this.backgroundColor=m??this.backgroundColor,this.snapToPixel=c??this.snapToPixel,this.smoothing=g??this.smoothing}resetTransform(){this.__ctx.resetTransform()}updateViewport(t){}drawImage(t,i,r,l,c,g,m,w,C){if(l===0||c===0)return;if(w===0||C===0)return;if(t.width===0||t.height===0)return;this.__ctx.globalAlpha=this.opacity;const A=[t,i,r,l,c,g,m,w,C].filter(T=>T!==void 0).map(T=>typeof T=="number"&&this.snapToPixel?~~T:T);this.__ctx.drawImage.apply(this.__ctx,A),ye.DrawCallCount++,ye.DrawnImagesCount=1}drawLine(t,i,r,l=1){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=r.toString(),this.__ctx.moveTo(this.snapToPixel?~~(t.x+Se):t.x,this.snapToPixel?~~(t.y+Se):t.y),this.__ctx.lineTo(this.snapToPixel?~~(i.x+Se):i.x,this.snapToPixel?~~(i.y+Se):i.y),this.__ctx.lineWidth=l,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}drawRectangle(t,i,r,l){this.__ctx.save(),this.__ctx.fillStyle=l.toString(),this.__ctx.fillRect(this.snapToPixel?~~(t.x+Se):t.x,this.snapToPixel?~~(t.y+Se):t.y,this.snapToPixel?~~(i+Se):i,this.snapToPixel?~~(r+Se):r),this.__ctx.restore()}drawCircle(t,i,r,l,c){this.__ctx.save(),this.__ctx.beginPath(),l&&(this.__ctx.strokeStyle=l.toString()),c&&(this.__ctx.lineWidth=c),this.__ctx.fillStyle=r.toString(),this.__ctx.arc(this.snapToPixel?~~(t.x+Se):t.x,this.snapToPixel?~~(t.y+Se):t.y,i,0,Math.PI*2),this.__ctx.fill(),l&&this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}save(){this.__ctx.save(),this._state.save()}restore(){this.__ctx.restore(),this._state.restore()}translate(t,i){this.__ctx.translate(this.snapToPixel?~~(t+Se):t,this.snapToPixel?~~(i+Se):i)}rotate(t){this.__ctx.rotate(t)}scale(t,i){this.__ctx.scale(t,i)}getTransform(){throw new Error("Not implemented")}multiply(t){this.__ctx.setTransform(this.__ctx.getTransform().multiply(t.toDOMMatrix()))}addPostProcessor(t){}removePostProcessor(t){}clearPostProcessors(){}updatePostProcessors(t){}beginDrawLifecycle(){}endDrawLifecycle(){}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){return null}clear(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),ye.clear()}flush(){}dispose(){this.__ctx=null}}var Ae;(function(f){f.Fixed="Fixed",f.FitContainerAndFill="FitContainerAndFill",f.FitScreenAndFill="FitScreenAndFill",f.FitContainerAndZoom="FitContainerAndZoom",f.FitScreenAndZoom="FitScreenAndZoom",f.FitScreen="FitScreen",f.FillScreen="FillScreen",f.FitContainer="FitContainer",f.FillContainer="FillContainer"})(Ae||(Ae={}));class rh{static get SVGA(){return{width:800,height:600}}static get Standard(){return{width:1920,height:1080}}static get Atari2600(){return{width:160,height:192}}static get GameBoy(){return{width:160,height:144}}static get GameBoyAdvance(){return{width:240,height:160}}static get NintendoDS(){return{width:256,height:192}}static get NES(){return{width:256,height:224}}static get SNES(){return{width:256,height:244}}}const Ra={ScreenResize:"resize",PixelRatioChange:"pixelratio",FullScreenChange:"fullscreen"};class oh{constructor(t){var i,r,l,c;this.events=new b,this._antialiasing=!0,this._canvasImageRendering="auto",this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=gt.getInstance(),this._fullscreenChangeHandler=()=>{this._isDisposed||(this._isFullScreen=!this._isFullScreen,this._logger.debug("Fullscreen Change",this._isFullScreen),this.events.emit("fullscreen",{fullscreen:this.isFullScreen}))},this._pixelRatioChangeHandler=()=>{this._isDisposed||(this._logger.debug("Pixel Ratio Change",window.devicePixelRatio),this._listenForPixelRatio(),this._devicePixelRatio=this._calculateDevicePixelRatio(),this.applyResolutionAndViewport(),this.events.emit("pixelratio",{pixelRatio:this.pixelRatio}))},this._resizeHandler=()=>{if(this._isDisposed)return;const g=this.parent;this._logger.debug("View port resized"),this._setResolutionAndViewportByDisplayMode(g),this.applyResolutionAndViewport(),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._contentArea=new mt,this._unsafeArea=new mt,this.viewport=t.viewport,this.resolution=(i=t.resolution)!==null&&i!==void 0?i:{...this.viewport},this._contentResolution=this.resolution,this._displayMode=(r=t.displayMode)!==null&&r!==void 0?r:Ae.Fixed,this._canvas=t.canvas,this.graphicsContext=t.context,this._antialiasing=(l=t.antialiasing)!==null&&l!==void 0?l:this._antialiasing,this._canvasImageRendering=(c=t.canvasImageRendering)!==null&&c!==void 0?c:this._canvasImageRendering,this._browser=t.browser,this._pixelRatioOverride=t.pixelRatio,this._applyDisplayMode(),this._listenForPixelRatio(),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}_listenForPixelRatio(){this._mediaQueryList&&!this._mediaQueryList.addEventListener&&this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler,{once:!0}):this._mediaQueryList.addListener(this._pixelRatioChangeHandler)}dispose(){this._isDisposed||(this._isDisposed=!0,this.events.clear(),this._browser.window.off("resize",this._resizeHandler),this._browser.window.clear(),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler):this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler),this._canvas=null)}_calculateDevicePixelRatio(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}get pixelRatio(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}get pixelRatioOverride(){return this._pixelRatioOverride}set pixelRatioOverride(t){this._pixelRatioOverride=t}get isHiDpi(){return this.pixelRatio!==1}get displayMode(){return this._displayMode}get canvas(){return this._canvas}get parent(){switch(this.displayMode){case Ae.FillContainer:case Ae.FitContainer:case Ae.FitContainerAndFill:case Ae.FitContainerAndZoom:return this.canvas.parentElement||document.body;default:return window}}get resolution(){return this._resolution}set resolution(t){this._resolution=t}get viewport(){return this._viewport?this._viewport:this._resolution}set viewport(t){this._viewport=t}get aspectRatio(){return this._resolution.width/this._resolution.height}get scaledWidth(){return this._resolution.width*this.pixelRatio}get scaledHeight(){return this._resolution.height*this.pixelRatio}setCurrentCamera(t){this._camera=t}pushResolutionAndViewport(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution={...this.resolution},this.viewport={...this.viewport}}peekViewport(){return this._viewportStack[this._viewportStack.length-1]}peekResolution(){return this._resolutionStack[this._resolutionStack.length-1]}popResolutionAndViewport(){this._resolutionStack.length&&this._viewportStack.length&&(this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop())}applyResolutionAndViewport(){if(this.graphicsContext instanceof ls&&!this.graphicsContext.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})&&(this._logger.warnOnce(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) and pixel ratio (${this.pixelRatio}) are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`),!this.pixelRatioOverride)){let l=Math.max(1,this.pixelRatio-.5),c=!1;for(;l>1&&!c;){l=Math.max(1,l-.5);const g=this._resolution.width*l,m=this._resolution.height*l;c=this.graphicsContext.checkIfResolutionSupported({width:g,height:m})}this.pixelRatioOverride=l,this._logger.warnOnce(`Scaled resolution too big attempted recovery! Pixel ratio was automatically reduced to (${this.pixelRatio}) to avoid 4k texture limit. Setting \`ex.Engine({pixelRatio: ...}) will override any automatic recalculation, do so at your own risk.\`  (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`)}this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this._canvasImageRendering==="auto"?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",this._canvas.style.imageRendering===""&&(this._canvas.style.imageRendering="crisp-edges"));const t=this.viewport.widthUnit==="percent"?"%":"px",i=this.viewport.heightUnit==="percent"?"%":"px";this._canvas.style.width=this.viewport.width+t,this._canvas.style.height=this.viewport.height+i,this.graphicsContext.updateViewport(this.resolution),this.graphicsContext.resetTransform(),this.graphicsContext.smoothing=this._antialiasing,this.graphicsContext instanceof Pa&&this.graphicsContext.scale(this.pixelRatio,this.pixelRatio)}get antialiasing(){return this._antialiasing}set antialiasing(t){this._antialiasing=t,this.graphicsContext.smoothing=this._antialiasing}get isFullScreen(){return this._isFullScreen}goFullScreen(t){if(t){const i=document.getElementById(t);if(i)return i.getAttribute("ex-fullscreen-listener")||(i.setAttribute("ex-fullscreen-listener","true"),i.addEventListener("fullscreenchange",this._fullscreenChangeHandler)),i.requestFullscreen()}return this._canvas.requestFullscreen()}exitFullScreen(){return document.exitFullscreen()}_viewportToPixels(t){return{width:t.widthUnit==="percent"?this.canvas.offsetWidth:t.width,height:t.heightUnit==="percent"?this.canvas.offsetHeight:t.height}}pageToScreenCoordinates(t){let i=t.x,r=t.y;this._isFullScreen||(i-=Ke(this._canvas).x,r-=Ke(this._canvas).y);const l=this._viewportToPixels(this.viewport);if(this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const c=window.innerWidth/this.aspectRatio,g=(window.innerHeight-c)/2;r=(r-g)/c*l.height,i=i/window.innerWidth*l.width}else{const c=window.innerHeight*this.aspectRatio,g=(window.innerWidth-c)/2;i=(i-g)/c*l.width,r=r/window.innerHeight*l.height}return i=i/l.width*this.resolution.width,r=r/l.height*this.resolution.height,i=i-this.contentArea.left,r=r-this.contentArea.top,new D(i,r)}screenToPageCoordinates(t){let i=t.x,r=t.y;const l=this._viewportToPixels(this.viewport);if(i=i/this.resolution.width*l.width,r=r/this.resolution.height*l.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const c=window.innerWidth/this.aspectRatio,g=(window.innerHeight-c)/2;r=r/l.height*c+g,i=i/l.width*window.innerWidth}else{const c=window.innerHeight*this.aspectRatio,g=(window.innerWidth-c)/2;i=i/l.width*c+g,r=r/l.height*window.innerHeight}return this._isFullScreen||(i+=Ke(this._canvas).x,r+=Ke(this._canvas).y),new D(i,r)}screenToWorldCoordinates(t){return t=t.add(j(this.contentArea.left,this.contentArea.top)),this._camera?this._camera.inverse.multiply(t):t.sub(j(this.resolution.width/2,this.resolution.height/2))}worldToScreenCoordinates(t){return this._camera?this._camera.transform.multiply(t):t.add(j(this.resolution.width/2,this.resolution.height/2))}pageToWorldCoordinates(t){const i=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(i)}worldToPageCoordinates(t){const i=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(i)}getWorldBounds(){return mt.fromDimension(this.resolution.width,this.resolution.height,D.Half).scale(j(1/this._camera.zoom,1/this._camera.zoom)).rotate(this._camera.rotation).translate(this._camera.drawPos)}getScreenBounds(){return mt.fromDimension(this.resolution.width,this.resolution.height,D.Zero,D.Zero)}get canvasWidth(){return this.canvas.width}get halfCanvasWidth(){return this.canvas.width/2}get canvasHeight(){return this.canvas.height}get halfCanvasHeight(){return this.canvas.height/2}get drawWidth(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}get halfDrawWidth(){return this.drawWidth/2}get drawHeight(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}get halfDrawHeight(){return this.drawHeight/2}get center(){return j(this.halfDrawWidth,this.halfDrawHeight)}get contentArea(){return this._contentArea}get unsafeArea(){return this._unsafeArea}_computeFit(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.aspectRatio;let i=0,r=0;window.innerWidth/t<window.innerHeight?(i=window.innerWidth,r=window.innerWidth/t):(i=window.innerHeight*t,r=window.innerHeight),this.viewport={width:i,height:r},this._contentArea=mt.fromDimension(this.resolution.width,this.resolution.height,D.Zero),this._unsafeArea=mt.fromDimension(this.resolution.width,this.resolution.height,D.Zero),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitScreenAndFill(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=window.innerWidth,i=window.innerHeight;this._computeFitAndFill(t,i),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitContainerAndFill(){this.canvas.style.width="100%",this.canvas.style.height="100%",this._computeFitAndFill(this.canvas.offsetWidth,this.canvas.offsetHeight,{width:100,widthUnit:"percent",height:100,heightUnit:"percent"}),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitAndFill(t,i,r){if(this.viewport=r??{width:t,height:i},t/i<=this._contentResolution.width/this._contentResolution.height){this.resolution={width:t*this._contentResolution.width/t,height:t*this._contentResolution.width/t*i/t};const l=(this.resolution.height-this._contentResolution.height)/2;this._contentArea=new mt({top:l,left:0,right:this._contentResolution.width,bottom:this.resolution.height-l}),this._unsafeArea=new mt({top:-l,left:0,right:this._contentResolution.width,bottom:this.resolution.height+l})}else{this.resolution={width:i*this._contentResolution.height/i*t/i,height:i*this._contentResolution.height/i};const l=(this.resolution.width-this._contentResolution.width)/2;this._contentArea=new mt({top:0,left:l,right:this.resolution.width-l,bottom:this._contentResolution.height}),this._unsafeArea=new mt({top:0,left:-l,right:this.resolution.width+l,bottom:this._contentResolution.height})}}_computeFitScreenAndZoom(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";const t=window.innerWidth,i=window.innerHeight;this._computeFitAndZoom(t,i),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitContainerAndZoom(){this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="relative";const t=this.canvas.parentElement;t.style.overflow="hidden";const{offsetWidth:i,offsetHeight:r}=this.canvas;this._computeFitAndZoom(i,r),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitAndZoom(t,i){const r=this.aspectRatio;let l=0,c=0;t/r<i?(l=t,c=t/r):(l=i*r,c=i);const g=t/l,m=i/c,w=Math.max(g,m),C=l*w,A=c*w;C>t?this.canvas.style.left=-(C-t)/2+"px":this.canvas.style.left="",A>i?this.canvas.style.top=-(A-i)/2+"px":this.canvas.style.top="",this.viewport={width:C,height:A};const T=mt.fromDimension(this.viewport.width,this.viewport.height,D.Zero);if(this.viewport.width>t){const M=(this.viewport.width-t)/this.viewport.width*this.resolution.width;T.top=0,T.left=M/2,T.right=this.resolution.width-M/2,T.bottom=this.resolution.height}if(this.viewport.height>i){const M=(this.viewport.height-i)/this.viewport.height*this.resolution.height;T.top=M/2,T.left=0,T.bottom=this.resolution.height-M/2,T.right=this.resolution.width}this._contentArea=T}_computeFitContainer(){const t=this.aspectRatio;let i=0,r=0,l="pixel",c="pixel";const g=this.canvas.parentElement;g.clientWidth/t<g.clientHeight?(this.canvas.style.width="100%",i=100,l="percent",r=this.canvas.offsetWidth/t):(this.canvas.style.height="100%",r=100,c="percent",i=this.canvas.offsetHeight*t),this.viewport={width:i,widthUnit:l,height:r,heightUnit:c},this._contentArea=mt.fromDimension(this.resolution.width,this.resolution.height,D.Zero),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_applyDisplayMode(){this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver(()=>{this._resizeHandler()}),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler)}_setResolutionAndViewportByDisplayMode(t){this.displayMode===Ae.FillContainer&&(this.canvas.style.width="100%",this.canvas.style.height="100%",this.viewport={width:100,widthUnit:"percent",height:100,heightUnit:"percent"},this.resolution={width:this.canvas.offsetWidth,height:this.canvas.offsetHeight}),this.displayMode===Ae.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this._contentArea=mt.fromDimension(this.resolution.width,this.resolution.height,D.Zero),this.displayMode===Ae.FitScreen&&this._computeFit(),this.displayMode===Ae.FitContainer&&this._computeFitContainer(),this.displayMode===Ae.FitScreenAndFill&&this._computeFitScreenAndFill(),this.displayMode===Ae.FitContainerAndFill&&this._computeFitContainerAndFill(),this.displayMode===Ae.FitScreenAndZoom&&this._computeFitScreenAndZoom(),this.displayMode===Ae.FitContainerAndZoom&&this._computeFitContainerAndZoom()}}class Fr{static create(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}Fr._INSTANCE=null;function Xf(f){return!!f.playbackState}class Fs{static unlock(){return new Promise((i,r)=>{if(Fs._UNLOCKED||!Fr.create())return i(!0);const l=setTimeout(()=>{gt.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),i(!1)},200),c=Fr.create();c.resume().then(()=>{const g=c.createBuffer(1,1,22050),m=c.createBufferSource();let w=!1;m.buffer=g,m.connect(c.destination),m.onended=()=>w=!0,m.start(0),setTimeout(()=>{Xf(m)?(m.playbackState===m.PLAYING_STATE||m.playbackState===m.FINISHED_STATE)&&(Fs._UNLOCKED=!0):(c.currentTime>0||w)&&(Fs._UNLOCKED=!0)},0),clearTimeout(l),i(!0)},()=>{r()})})}static isUnlocked(){return this._UNLOCKED}}Fs._UNLOCKED=!1;class er extends oe{constructor(t){var i,r,l,c,g,m,w,C,A,T;super(is(t,["width","height"])),this.filtering=null,this.lineCap="butt",this.quality=1,this._dirty=!0,this._smoothing=!1,this._color=ie(nt.Black,()=>this.flagDirty()),this._lineWidth=1,this._lineDash=[],this._padding=0,t&&(this.quality=(i=t.quality)!==null&&i!==void 0?i:this.quality,this.color=(r=t.color)!==null&&r!==void 0?r:nt.Black,this.strokeColor=t==null?void 0:t.strokeColor,this.smoothing=(l=t.smoothing)!==null&&l!==void 0?l:this.smoothing,this.lineWidth=(c=t.lineWidth)!==null&&c!==void 0?c:this.lineWidth,this.lineDash=(g=t.lineDash)!==null&&g!==void 0?g:this.lineDash,this.lineCap=(m=t.lineCap)!==null&&m!==void 0?m:this.lineCap,this.padding=(w=t.padding)!==null&&w!==void 0?w:this.padding,this.filtering=(C=t.filtering)!==null&&C!==void 0?C:this.filtering),this._bitmap=document.createElement("canvas");const M=(A=t==null?void 0:t.width)!==null&&A!==void 0?A:this._bitmap.width,z=(T=t==null?void 0:t.height)!==null&&T!==void 0?T:this._bitmap.height;this.width=M,this.height=z;const W=this._bitmap.getContext("2d");if(W)this._ctx=W;else throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic")}cloneRasterOptions(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,lineCap:this.lineCap,quality:this.quality,padding:this.padding}}get dirty(){return this._dirty}flagDirty(){this._dirty=!0}get width(){return Math.abs(this._getTotalWidth()*this.scale.x)}set width(t){t/=Math.abs(this.scale.x),this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}get height(){return Math.abs(this._getTotalHeight()*this.scale.y)}set height(t){t/=Math.abs(this.scale.y),this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}_getTotalWidth(){var t;return(((t=this._originalWidth)!==null&&t!==void 0?t:this._bitmap.width)+this.padding*2)*1}_getTotalHeight(){var t;return(((t=this._originalHeight)!==null&&t!==void 0?t:this._bitmap.height)+this.padding*2)*1}get localBounds(){return mt.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,D.Zero)}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this.flagDirty()}get color(){return this._color}set color(t){this.flagDirty(),this._color=ie(t,()=>this.flagDirty())}get strokeColor(){return this._strokeColor}set strokeColor(t){this.flagDirty(),this._strokeColor=ie(t,()=>this.flagDirty())}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this.flagDirty()}get lineDash(){return this._lineDash}set lineDash(t){this._lineDash=t,this.flagDirty()}get padding(){return this._padding}set padding(t){this._padding=t,this.flagDirty()}rasterize(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperties(this._ctx),this.execute(this._ctx),this._ctx.restore()}_applyRasterProperties(t){var i,r,l;this._bitmap.width=this._getTotalWidth()*this.quality,this._bitmap.height=this._getTotalHeight()*this.quality,this._bitmap.setAttribute("filtering",this.filtering),this._bitmap.setAttribute("forceUpload","true"),t.scale(this.quality,this.quality),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash((i=this.lineDash)!==null&&i!==void 0?i:t.getLineDash()),t.lineCap=this.lineCap,t.strokeStyle=(r=this.strokeColor)===null||r===void 0?void 0:r.toString(),t.fillStyle=(l=this.color)===null||l===void 0?void 0:l.toString()}_drawImage(t,i,r){this._dirty&&this.rasterize(),t.scale(1/this.quality,1/this.quality),t.drawImage(this._bitmap,i,r)}}class Co extends er{get ctx(){return this._ctx}constructor(t){super(t),this._options=t}clone(){return new Co({...this._options,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){var i,r;!((i=this._options)===null||i===void 0)&&i.draw&&((r=this._options)===null||r===void 0||r.draw(t)),this._options.cache||this.flagDirty()}}class ah{}ah.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};class Ia{constructor(){this.states=new Map}get currentState(){return this._currentState}set currentState(t){this._currentState=t}static create(t,i){const r=new Ia;r.data=i;for(const l in t.states)r.states.set(l,{name:l,...t.states[l]});for(const l of r.states.values())for(const c of l.transitions)if(c!=="*"&&!r.states.has(c))throw Error(`Invalid state machine, state [${l.name}] has a transition to another state that doesn't exist [${c}]`);return r.currentState=r.startState=r.states.get(t.start),r}in(t){return this.currentState.name===t}go(t,i){var r,l;if(this.currentState.transitions.includes(t)||this.currentState.transitions.includes("*")){const c=this.states.get(t);return this.currentState.onExit&&((r=this.currentState)===null||r===void 0?void 0:r.onExit({to:c.name,data:this.data}))===!1||c!=null&&c.onEnter&&(c==null?void 0:c.onEnter({from:this.currentState.name,eventData:i,data:this.data}))===!1?!1:(this.currentState=c,!((l=this.currentState)===null||l===void 0)&&l.onState&&this.currentState.onState(),!0)}return!1}update(t){this.currentState.onUpdate&&this.currentState.onUpdate(this.data,t)}save(t){localStorage.setItem(t,JSON.stringify({currentState:this.currentState.name,data:this.data}))}restore(t){const i=JSON.parse(localStorage.getItem(t));this.currentState=this.states.get(i.currentState),this.data=i.data}}class ec{_createNewBufferSource(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.value=this._playbackRate,this._instance.connect(this._volumeNode),this._volumeNode.connect(this._audioContext.destination)}_handleEnd(){this.loop||(this._instance.onended=()=>{this._playingFuture.resolve(!0)})}set loop(t){this._loop=t,this._instance&&(this._instance.loop=t,this.loop||(this._instance.onended=()=>{this._playingFuture.resolve(!0)}))}get loop(){return this._loop}set volume(t){t=G(t,0,1),this._volume=t,this._stateMachine.in("PLAYING")&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}get volume(){return this._volume}get duration(){var t;return(t=this._duration)!==null&&t!==void 0?t:this.getTotalPlaybackDuration()}set duration(t){this._duration=t}constructor(t){this._src=t,this._audioContext=Fr.create(),this._volumeNode=this._audioContext.createGain(),this._playingFuture=new x,this._stateMachine=Ia.create({start:"STOPPED",states:{PLAYING:{onEnter:({data:i})=>{this._createNewBufferSource(),this._handleEnd(),this.loop?this._instance.start(0,i.pausedAt*this._playbackRate):this._instance.start(0,i.pausedAt*this._playbackRate,this.duration),i.startedAt=this._audioContext.currentTime-i.pausedAt,i.pausedAt=0},onState:()=>this._playStarted(),onExit:({to:i})=>{i==="STOPPED"&&this._playingFuture.resolve(!0),this._instance.onended=null,this._instance.disconnect(),this._instance.stop(0),this._instance=null},transitions:["STOPPED","PAUSED","SEEK"]},SEEK:{onEnter:({eventData:i,data:r})=>{r.pausedAt=(i??0)/this._playbackRate,r.startedAt=0},transitions:["*"]},STOPPED:{onEnter:({data:i})=>{i.pausedAt=0,i.startedAt=0,this._playingFuture.resolve(!0)},transitions:["PLAYING","PAUSED","SEEK"]},PAUSED:{onEnter:({data:i})=>{i.pausedAt=this._audioContext.currentTime-i.startedAt},transitions:["PLAYING","STOPPED","SEEK"]}}},{startedAt:0,pausedAt:0}),this._volume=1,this._loop=!1,this._playStarted=()=>{},this._playbackRate=1,this._createNewBufferSource()}isPlaying(){return this._stateMachine.in("PLAYING")}isPaused(){return this._stateMachine.in("PAUSED")||this._stateMachine.in("SEEK")}isStopped(){return this._stateMachine.in("STOPPED")}play(t=()=>{}){return this._playStarted=t,this._stateMachine.go("PLAYING"),this._playingFuture.promise}pause(){this._stateMachine.go("PAUSED")}stop(){this._stateMachine.go("STOPPED")}seek(t){this._stateMachine.go("PAUSED"),this._stateMachine.go("SEEK",t)}getTotalPlaybackDuration(){return this._src.duration}getPlaybackPosition(){const{pausedAt:t,startedAt:i}=this._stateMachine.data;return t?t*this._playbackRate:i?(this._audioContext.currentTime-i)*this._playbackRate:0}set playbackRate(t){this._instance.playbackRate.value=this._playbackRate=t}get playbackRate(){return this._instance.playbackRate.value}}var Da;(function(f){f.Kill="kill",f.PreKill="prekill",f.PostKill="postkill",f.PreDraw="predraw",f.PostDraw="postdraw",f.PreDebugDraw="predebugdraw",f.PostDebugDraw="postdebugdraw",f.PreUpdate="preupdate",f.PostUpdate="postupdate",f.PreFrame="preframe",f.PostFrame="postframe",f.PreCollision="precollision",f.CollisionStart="collisionstart",f.CollisionEnd="collisionend",f.PostCollision="postcollision",f.Initialize="initialize",f.Activate="activate",f.Deactivate="deactivate",f.ExitViewport="exitviewport",f.EnterViewport="enterviewport",f.ExitTrigger="exit",f.EnterTrigger="enter",f.Connect="connect",f.Disconnect="disconnect",f.Button="button",f.Axis="axis",f.Visible="visible",f.Hidden="hidden",f.Start="start",f.Stop="stop",f.PointerUp="pointerup",f.PointerDown="pointerdown",f.PointerMove="pointermove",f.PointerEnter="pointerenter",f.PointerLeave="pointerleave",f.PointerCancel="pointercancel",f.PointerWheel="pointerwheel",f.Up="up",f.Down="down",f.Move="move",f.Enter="enter",f.Leave="leave",f.Cancel="cancel",f.Wheel="wheel",f.Press="press",f.Release="release",f.Hold="hold",f.PointerDragStart="pointerdragstart",f.PointerDragEnd="pointerdragend",f.PointerDragEnter="pointerdragenter",f.PointerDragLeave="pointerdragleave",f.PointerDragMove="pointerdragmove",f.ActionStart="actionstart",f.ActionComplete="actioncomplete"})(Da||(Da={}));class Ut{constructor(){this._bubbles=!0}get bubbles(){return this._bubbles}set bubbles(t){this._bubbles=t}stopPropagation(){this.bubbles=!1}}class So extends Ut{constructor(t){super(),this.target=t}}class Fa extends Ut{constructor(t){super(),this.target=t}}class Ao extends Ut{constructor(t){super(),this.target=t}}class lh extends Ut{constructor(t){super(),this.target=t}}class Ba extends Ut{constructor(t){super(),this.target=t}}class hs extends Ut{constructor(t,i,r){super(),this.ctx=t,this.delta=i,this.target=r}}class ir extends Ut{constructor(t,i,r){super(),this.ctx=t,this.delta=i,this.target=r}}class hh extends Ut{constructor(t,i,r){super(),this.ctx=t,this.delta=i,this.target=r}}class ka extends Ut{constructor(t,i,r){super(),this.ctx=t,this.delta=i,this.target=r}}class La extends Ut{constructor(t,i){super(),this.ctx=t,this.target=i}}class Eo extends Ut{constructor(t,i){super(),this.ctx=t,this.target=i}}class Bs extends Ut{constructor(t,i,r){super(),this.engine=t,this.delta=i,this.target=r}}class us extends Ut{constructor(t,i,r){super(),this.engine=t,this.delta=i,this.target=r}}class To extends Ut{constructor(t,i){super(),this.engine=t,this.prevStats=i,this.target=t}}class Po extends Ut{constructor(t,i){super(),this.engine=t,this.stats=i,this.target=t}}class ks extends Ut{constructor(t,i){super(),this.index=t,this.gamepad=i,this.target=i}}class Ma extends Ut{constructor(t,i){super(),this.index=t,this.gamepad=i,this.target=i}}class Oa extends Ut{constructor(t,i,r){super(),this.button=t,this.value=i,this.target=r}}class uh extends Ut{constructor(t,i,r){super(),this.axis=t,this.value=i,this.target=r}}class Na extends Ut{constructor(t){super(),this.target=t}}class Ua extends Ut{constructor(t){super(),this.target=t}}class Ls extends Ut{constructor(t,i,r,l,c){super(),this.other=i,this.side=r,this.intersection=l,this.contact=c,this.target=t}}class Ms extends Ut{constructor(t,i,r,l,c){super(),this.other=i,this.side=r,this.intersection=l,this.contact=c,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class za{constructor(t,i,r,l){this.target=t,this.other=i,this.side=r,this.contact=l}}class Ha{constructor(t,i,r,l){this.target=t,this.other=i,this.side=r,this.lastContact=l}}class Wa{constructor(t,i,r,l,c){this.target=t,this.other=i,this.side=r,this.intersection=l,this.contact=c}}class Ro{constructor(t,i,r,l,c){this.target=t,this.other=i,this.side=r,this.intersection=l,this.contact=c}}class Io extends Ut{constructor(t,i,r,l){super(),this.other=i,this.side=r,this.contact=l,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class Do extends Ut{constructor(t,i,r,l){super(),this.other=i,this.side=r,this.lastContact=l,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class Br extends Ut{constructor(t,i){super(),this.engine=t,this.target=i}}class ch extends Ut{constructor(t,i){super(),this.context=t,this.target=i}}class Fo extends Ut{constructor(t,i){super(),this.context=t,this.target=i}}class dh extends Ut{constructor(t){super(),this.target=t}}class fh extends Ut{constructor(t){super(),this.target=t}}class ph extends Ut{constructor(t,i){super(),this.target=t,this.actor=i}}class gh extends Ut{constructor(t,i){super(),this.target=t,this.actor=i}}class _h extends Ut{constructor(t,i){super(),this.action=t,this.target=i}}class ce extends Ut{constructor(t,i){super(),this.action=t,this.target=i}}class le extends Ut{set bubbles(t){}get bubbles(){return!1}get _path(){return null}set _path(t){}constructor(t,i="MediaEvent"){super(),this.target=t,this._name=i}stopPropagation(){}action(){}propagate(){}layPath(t){}}class nr extends le{constructor(t,i){super(t,"NativeSoundEvent"),this.track=i}}class ic extends le{constructor(t,i){super(t,"NativeSoundProcessedEvent"),this._processedData=i,this.data=this._processedData}}function $f(f){try{const t=new Audio,i=/.*\.([A-Za-z0-9]+)(?:(?:\?|\#).*)*$/,r=f.match(i)[1];return!!t.canPlayType("audio/"+r)}catch(t){return gt.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",t),!1}}const Yf={VolumeChange:"volumechange",Processed:"processed",Pause:"pause",Stop:"stop",PlaybackEnd:"playbackend",Resume:"resume",PlaybackStart:"playbackstart"};class nc{set loop(t){this._loop=t;for(const i of this._tracks)i.loop=this._loop;this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}get loop(){return this._loop}set volume(t){this._volume=t;for(const i of this._tracks)i.volume=this._volume;this.events.emit("volumechange",new nr(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}get volume(){return this._volume}get duration(){return this._duration}set duration(t){this._duration=t}get instances(){return this._tracks}get path(){return this._resource.path}set path(t){this._resource.path=t}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}constructor(...t){this.events=new b,this.logger=gt.getInstance(),this._loop=!1,this._volume=1,this._isStopped=!1,this._tracks=[],this._wasPlayingOnHidden=!1,this._playbackRate=1,this._audioContext=Fr.create(),this._resource=new $t("",ah.type.arraybuffer);for(const i of t)if($f(i)){this.path=i;break}this.path||(this.logger.warn("This browser does not support any of the audio files specified:",t.join(", ")),this.logger.warn("Attempting to use",t[0]),this.path=t[0])}isLoaded(){return!!this.data}async load(){var t,i;if(this.data)return this.data;const r=await this._resource.load(),l=await this.decodeAudio(r.slice(0));return this._duration=(i=(t=this._duration)!==null&&t!==void 0?t:l==null?void 0:l.duration)!==null&&i!==void 0?i:void 0,this.events.emit("processed",new ic(this,l)),this.data=l}async decodeAudio(t){try{return await this._audioContext.decodeAudioData(t.slice(0))}catch{return this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),await Promise.reject()}}wireEngine(t){t&&(this._engine=t,this._engine.on("hidden",()=>{t.pauseAudioWhenHidden&&this.isPlaying()&&(this._wasPlayingOnHidden=!0,this.pause())}),this._engine.on("visible",()=>{t.pauseAudioWhenHidden&&this._wasPlayingOnHidden&&(this.play(),this._wasPlayingOnHidden=!1)}),this._engine.on("start",()=>{this._isStopped=!1}),this._engine.on("stop",()=>{this.stop(),this._isStopped=!0}))}instanceCount(){return this._tracks.length}isPlaying(){return this._tracks.some(t=>t.isPlaying())}isPaused(){return this._tracks.some(t=>t.isPaused())}isStopped(){return this._tracks.some(t=>t.isStopped())}play(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this.isPaused()?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}pause(){if(this.isPlaying()){for(const t of this._tracks)t.pause();this.events.emit("pause",new nr(this)),this.logger.debug("Paused all instances of sound",this.path)}}stop(){for(const t of this._tracks)t.stop();this.events.emit("stop",new nr(this)),this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._tracks.forEach(i=>{i.playbackRate=this._playbackRate})}seek(t,i=0){this._tracks.length===0&&this._getTrackInstance(this.data),this._tracks[i].seek(t)}getTotalPlaybackDuration(){return this.isLoaded()?this.data.duration:(this.logger.warnOnce(`Sound from ${this.path} is not loaded, cannot return total playback duration.Did you forget to add Sound to a loader? https://excaliburjs.com/docs/loaders/`),0)}getPlaybackPosition(t=0){return this._tracks.length?this._tracks[t].getPlaybackPosition():0}getTrackId(t){return this._tracks.indexOf(t)}async _resumePlayback(){if(this.isPaused){const t=[];for(const i of this._tracks)t.push(i.play().then(()=>(this._tracks.splice(this.getTrackId(i),1),!0)));this.events.emit("resume",new nr(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),await Promise.all(t)}return!0}async _startPlayback(){const t=this._getTrackInstance(this.data),i=await t.play(()=>{this.events.emit("playbackstart",new nr(this,t)),this.logger.debug("Playing new instance for sound",this.path)});this.events.emit("playbackend",new nr(this,t));const r=this.getTrackId(t);return r!==-1&&this._tracks.splice(r,1),i}_getTrackInstance(t){const i=new ec(t);return i.loop=this.loop,i.volume=this.volume,i.duration=this.duration,i.playbackRate=this._playbackRate,this._tracks.push(i),i}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}const Qf={BeforeLoad:"beforeload",AfterLoad:"afterload",UserAction:"useraction",LoadResourceStart:"loadresourcestart",LoadResourceEnd:"loadresourceend"};function ja(f){var t,i;return!!(f!=null&&f.prototype)&&!!(!((i=(t=f==null?void 0:f.prototype)===null||t===void 0?void 0:t.constructor)===null||i===void 0)&&i.name)}class Bo{get resources(){return this._resources}constructor(t){var i;this.events=new b,this.canvas=new Co({filtering:ae.Blended,smoothing:!0,cache:!1,draw:this.onDraw.bind(this)}),this._resources=[],this._numLoaded=0,this._totalTimeMs=0,this._loadingFuture=new x,t&&(!((i=t.loadables)===null||i===void 0)&&i.length)&&this.addResources(t.loadables)}onInitialize(t){this.engine=t,this.canvas.width=this.engine.screen.resolution.width,this.canvas.height=this.engine.screen.resolution.height}async onUserAction(){return await Promise.resolve()}async onBeforeLoad(){}async onAfterLoad(){await pe(500,this.engine.clock)}addResource(t){this._resources.push(t)}addResources(t){let i=0;const r=t.length;for(i;i<r;i++)this.addResource(t[i])}markResourceComplete(){this._numLoaded++}get progress(){const t=this._resources.length;return t>0?G(this._numLoaded,0,t)/t:1}isLoaded(){return this._numLoaded===this._resources.length}onUpdate(t,i){this._totalTimeMs+=i}onDraw(t){const i=this._totalTimeMs/1e3;t.fillStyle=nt.Black.toRGBA(),t.fillRect(0,0,this.engine.screen.resolution.width,this.engine.screen.resolution.height),t.save(),t.translate(this.engine.screen.resolution.width/2,this.engine.screen.resolution.height/2);const r=i*10;t.strokeStyle="white",t.lineWidth=10,t.lineCap="round",t.arc(0,0,40,r,r+Math.PI*3/2),t.stroke(),t.fillStyle="white",t.font="16px sans-serif";const l=(this.progress*100).toFixed(0)+"%",c=t.measureText(l),g=Math.abs(c.actualBoundingBoxLeft)+Math.abs(c.actualBoundingBoxRight),m=Math.abs(c.actualBoundingBoxAscent)+Math.abs(c.actualBoundingBoxDescent);t.fillText(l,-g/2,m/2),t.restore()}areResourcesLoaded(){return this._loadingFuture.promise}async load(){await this.onBeforeLoad(),this.events.emit("beforeload"),this.canvas.flagDirty(),await Promise.all(this._resources.map(async t=>{this.events.emit("loadresourcestart",t),await t.load().finally(()=>{this._numLoaded++,this.canvas.flagDirty(),this.events.emit("loadresourceend",t)})}));for(const t of this._resources)t instanceof nc&&t.wireEngine(this.engine);return this._loadingFuture.resolve(),this.canvas.flagDirty(),await this.onUserAction(),this.events.emit("useraction"),await Fs.unlock(),await this.onAfterLoad(),this.events.emit("afterload"),this.data=this._resources}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}function He(f,t=nt.Red,i,r,l,c,g=1,m="butt"){f.save(),f.beginPath(),f.lineWidth=g,f.lineCap=m,f.strokeStyle=t.toString(),f.moveTo(i,r),f.lineTo(l,c),f.closePath(),f.stroke(),f.restore()}function mh(f,t=nt.Red,i){f.beginPath(),f.strokeStyle=t.toString(),f.arc(i.x,i.y,5,0,Math.PI*2),f.closePath(),f.stroke()}function sr(f,t,i,r,l=1){const c=t?t.toString():"blue",g=r.scale(l);f.beginPath(),f.strokeStyle=c,f.moveTo(i.x,i.y),f.lineTo(i.x+g.x,i.y+g.y),f.closePath(),f.stroke()}function Ga(f,t,i,r,l,c=5,g=nt.White,m=null){let w;if(typeof c=="number")w={tl:c,tr:c,br:c,bl:c};else{const C={tl:0,tr:0,br:0,bl:0};for(const A in C)if(C.hasOwnProperty(A)){const T=A;w[T]=c[T]||C[T]}}f.beginPath(),f.moveTo(t+w.tl,i),f.lineTo(t+r-w.tr,i),f.quadraticCurveTo(t+r,i,t+r,i+w.tr),f.lineTo(t+r,i+l-w.br),f.quadraticCurveTo(t+r,i+l,t+r-w.br,i+l),f.lineTo(t+w.bl,i+l),f.quadraticCurveTo(t,i+l,t,i+l-w.bl),f.lineTo(t,i+w.tl),f.quadraticCurveTo(t,i,t+w.tl,i),f.closePath(),m&&(f.fillStyle=m.toString(),f.fill()),g&&(f.strokeStyle=g.toString(),f.stroke())}function vh(f,t,i,r,l=nt.White,c=null){f.beginPath(),f.arc(t,i,r,0,Math.PI*2),f.closePath(),c&&(f.fillStyle=c.toString(),f.fill()),l&&(f.strokeStyle=l.toString(),f.stroke())}const nn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=";var sc=Ee(8851);class Os extends Bo{get _image(){return this._imageElement||(this._imageElement=new Image,this._imageElement.onload=()=>this._imageLoaded.resolve(),this._imageElement.src=this.logo),this._imageElement}get playButtonRootElement(){return this._playButtonRootElement}get playButtonElement(){return this._playButtonElement}get _playButton(){const t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}constructor(t){const i=Array.isArray(t)?{loadables:t}:t;super(i),this._logger=gt.getInstance(),this._originalOptions={loadables:[]},this.events=new b,this._playButtonShown=!1,this.logo=nn,this.logoWidth=468,this.logoHeight=118,this.loadingBarColor=nt.White,this.backgroundColor="#176BAA",this._imageLoaded=new x,this.suppressPlayButton=!1,this._playButtonStyles=sc.A.toString(),this.playButtonText="Play game",this.startButtonFactory=()=>{let r=document.getElementById("excalibur-play");return r||(r=document.createElement("button")),r.id="excalibur-play",r.textContent=this.playButtonText,r.style.display="none",r},this._configuredPixelRatio=null,this._originalOptions={...Os._DEFAULT_LOADER_OPTIONS,...i}}onInitialize(t){this.engine=t,this.screen=t.screen,this.canvas.width=this.engine.canvas.width,this.canvas.height=this.engine.canvas.height,this.screen.events.on("resize",()=>{this.canvas.width=this.engine.canvas.width,this.canvas.height=this.engine.canvas.height})}async showPlayButton(){var t,i;if(this.suppressPlayButton)this.hidePlayButton(),await pe(500,(t=this.engine)===null||t===void 0?void 0:t.clock);else{const r=()=>{try{this._positionPlayButton()}catch{}};return!((i=this.engine)===null||i===void 0)&&i.browser&&this.engine.browser.window.on("resize",r),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",c=>{c.key==="Enter"&&this._playButton.click()}),this._positionPlayButton(),await new Promise(c=>{const g=m=>{var w;if(m.stopPropagation(),this.hidePlayButton(),!((w=this.engine)===null||w===void 0)&&w.browser&&this.engine.browser.window.off("resize",r),this._originalOptions.fullscreenAfterLoad)try{this._logger.info("requesting fullscreen"),this._originalOptions.fullscreenContainer instanceof HTMLElement?this._originalOptions.fullscreenContainer.requestFullscreen():this.engine.screen.goFullScreen(this._originalOptions.fullscreenContainer)}catch(C){this._logger.error("could not go fullscreen",C)}c()};this._playButton.addEventListener("click",g),this._playButton.addEventListener("touchend",g),this._playButton.addEventListener("pointerup",g)})}}hidePlayButton(){this._playButtonShown=!1,this._playButton.style.display="none"}dispose(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}async onUserAction(){var t;await pe(200,(t=this.engine)===null||t===void 0?void 0:t.clock),this.canvas.flagDirty(),await this.showPlayButton()}async onBeforeLoad(){const t=this._image;await this._imageLoaded.promise,await(t==null?void 0:t.decode())}async onAfterLoad(){this.screen.pixelRatioOverride=this._configuredPixelRatio,this.screen.popResolutionAndViewport(),this.screen.applyResolutionAndViewport(),this.dispose()}_positionPlayButton(){if(this.engine){const{x:t,y:i,width:r,height:l}=this.engine.canvas.getBoundingClientRect();if(this._playButtonRootElement){const c=this._playButton.clientWidth,g=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left=`${this.playButtonPosition.x}px`,this._playButtonRootElement.style.top=`${this.playButtonPosition.y}px`):(this._playButtonRootElement.style.left=`${t+r/2-c/2}px`,this._playButtonRootElement.style.top=`${i+l/2-g/2+100}px`)}}}onDraw(t){const i=this.engine.canvasHeight/this.engine.pixelRatio,r=this.engine.canvasWidth/this.engine.pixelRatio;this._positionPlayButton(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,r,i);let l=i/2;const c=Math.min(this.logoWidth,r*.75);let g=r/2-c/2;this.logoPosition&&(g=this.logoPosition.x,l=this.logoPosition.y);const m=Math.floor(c*(this.logoHeight/this.logoWidth)),w=this.engine.getAntialiasing();if(this.engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,g,l,c,m):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,g,l-m-20,c,m),!this.suppressPlayButton&&this._playButtonShown){this.engine.setAntialiasing(w);return}let C=g,A=l;this.loadingBarPosition&&(C=this.loadingBarPosition.x,A=this.loadingBarPosition.y),t.lineWidth=2,Ga(t,C,A,c,20,10,this.loadingBarColor);const T=c*this.progress,M=5,z=T-M*2,W=20-M*2;Ga(t,C+M,A+M,z>10?z:10,W,5,null,this.loadingBarColor),this.engine.setAntialiasing(w)}}Os._DEFAULT_LOADER_OPTIONS={loadables:[],fullscreenAfterLoad:!1,fullscreenContainer:void 0};const yh={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"};class wh{constructor(){this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){const t=document.createElement("canvas");return!!(t.getContext&&t.getContext("2d"))},arrayBufferSupport:function(){const t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch{return!1}return t.responseType==="arraybuffer"},dataUrlSupport:function(){return document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")===0},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){const t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){const t=document.createElement("canvas");return!!(t.getContext&&t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}getBrowserFeatures(){return this._features===null&&(this._features=this._loadBrowserFeatures()),this._features}logBrowserFeatures(){let t=`%cSUPPORTED BROWSER FEATURES
==========================%c
`;const i=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],r=this.getBrowserFeatures();for(const l of Object.keys(yh))r[l]?(t+="(%c%c)",i.push("font-weight: bold; color: green"),i.push("font-weight: normal; color: inherit")):(t+="(%c%c)",i.push("font-weight: bold; color: red"),i.push("font-weight: normal; color: inherit")),t+=" "+yh[l]+`
`;i.unshift(t),console.log.apply(console,i)}_loadBrowserFeatures(){return{canvas:this._criticalTests.canvasSupport(),arraybuffer:this._criticalTests.arrayBufferSupport(),dataurl:this._criticalTests.dataUrlSupport(),objecturl:this._criticalTests.objectUrlSupport(),rgba:this._criticalTests.rgbaSupport(),webaudio:this._warningTest.webAudioSupport(),webgl:this._warningTest.webglSupport(),gamepadapi:!!navigator.getGamepads}}test(){let t=!1;for(const i in this._criticalTests)this._criticalTests[i].call(this)||(this.failedTests.push(i),gt.getInstance().error("Critical browser feature missing, Excalibur requires:",i),t=!0);if(t)return!1;for(const i in this._warningTest)this._warningTest[i]()||gt.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",i);return!0}}var Mt;(function(f){f.PreventCollision="PreventCollision",f.Passive="Passive",f.Active="Active",f.Fixed="Fixed"})(Mt||(Mt={}));var Me;(function(f){f.World="world",f.Screen="screen"})(Me||(Me={}));class Ci extends D{constructor(t){super(0,0),this._getX=t.getX,this._getY=t.getY,this._setX=t.setX,this._setY=t.setY}get x(){return this._x=this._getX()}set x(t){this._setX(t),this._x=t}get y(){return this._y=this._getY()}set y(t){this._setY(t),this._y=t}}class Va extends D{constructor(t,i){super(t.x,t.y),this.original=t,this.change=i}get x(){return this._x=this.original.x}set x(t){this.change(t,this._y),this._x=this.original.x=t}get y(){return this._y=this.original.y}set y(t){this.change(this._x,t),this._y=this.original.y=t}}class Ye{constructor(){this._parent=null,this._children=[],this._pos=j(0,0),this._rotation=0,this._scale=j(1,1),this._isDirty=!1,this._isInverseDirty=!1,this._matrix=Zt.identity(),this._inverse=Zt.identity()}get parent(){return this._parent}set parent(t){if(this._parent){const i=this._parent._children.indexOf(this);i>-1&&this._parent._children.splice(i,1)}this._parent=t,this._parent&&this._parent._children.push(this),this.flagDirty()}get children(){return this._children}set pos(t){t.equals(this._pos)||(this._pos.x=t.x,this._pos.y=t.y,this.flagDirty())}get pos(){return new Va(this._pos,(t,i)=>{(t!==this._pos.x||i!==this._pos.y)&&this.flagDirty()})}set globalPos(t){let i=t.clone();this.parent&&(i=this.parent.inverse.multiply(t)),i.equals(this._pos)||(this._pos=i,this.flagDirty())}get globalPos(){return new Ci({getX:()=>this.matrix.data[4],getY:()=>this.matrix.data[5],setX:t=>{if(this.parent){const{x:i}=this.parent.inverse.multiply(j(t,this.pos.y));this.pos.x=i}else this.pos.x=t;t!==this.matrix.data[4]&&this.flagDirty()},setY:t=>{if(this.parent){const{y:i}=this.parent.inverse.multiply(j(this.pos.x,t));this.pos.y=i}else this.pos.y=t;t!==this.matrix.data[5]&&this.flagDirty()}})}set rotation(t){const i=k(t);i!==this._rotation&&this.flagDirty(),this._rotation=i}get rotation(){return this._rotation}set globalRotation(t){let i=0;this.parent&&(i=this.parent.globalRotation);const r=k(t+i);r!==this._rotation&&this.flagDirty(),this._rotation=r}get globalRotation(){return this.parent?this.matrix.getRotation():this.rotation}set scale(t){(t.x!==this._scale.x||t.y!==this._scale.y)&&(this._scale.x=t.x,this._scale.y=t.y,this.flagDirty())}get scale(){return new Va(this._scale,(t,i)=>{(t!==this._scale.x||i!==this._scale.y)&&this.flagDirty()})}set globalScale(t){let i=j(1,1);this.parent&&(i=this.parent.globalScale),this.scale=t.scale(j(1/i.x,1/i.y))}get globalScale(){return new Ci({getX:()=>this.parent?this.matrix.getScaleX():this.scale.x,getY:()=>this.parent?this.matrix.getScaleY():this.scale.y,setX:t=>{if(this.parent){const i=this.parent.globalScale.x;this.scale.x=t/i}else this.scale.x=t},setY:t=>{if(this.parent){const i=this.parent.globalScale.y;this.scale.y=t/i}else this.scale.y=t}})}get matrix(){return this._isDirty&&(this.parent===null?this._matrix=this._calculateMatrix():this._matrix=this.parent.matrix.multiply(this._calculateMatrix()),this._isDirty=!1),this._matrix}get inverse(){return this._isInverseDirty&&(this._inverse=this.matrix.inverse(),this._isInverseDirty=!1),this._inverse}_calculateMatrix(){return Zt.identity().translate(this.pos.x,this.pos.y).rotate(this.rotation).scale(this.scale.x,this.scale.y)}flagDirty(){this._isDirty=!0,this._isInverseDirty=!0;for(let t=0;t<this._children.length;t++)this._children[t].flagDirty()}apply(t){return this.matrix.multiply(t)}applyInverse(t){return this.inverse.multiply(t)}setTransform(t,i,r){this._pos.x=t.x,this._pos.y=t.y,this._rotation=k(i),this._scale.x=r.x,this._scale.y=r.y,this.flagDirty()}clone(t){const i=t??new Ye;return this._pos.clone(i._pos),i._rotation=this._rotation,this._scale.clone(i._scale),i.flagDirty(),i}}function rc(f){return!!f&&!!f.prototype&&!!f.prototype.constructor}function oc(f){return!!(f!=null&&f.clone)}class Qe{constructor(){this.owner=void 0}clone(){const t=new this.constructor;for(const i in this)if(this.hasOwnProperty(i)){const r=this[i];oc(r)&&i!=="owner"&&i!=="clone"?t[i]=r.clone():t[i]=r}return t}}class We{constructor(){this.observers=[],this.subscriptions=[]}register(t){this.observers.push(t)}subscribe(t){this.subscriptions.push(t)}unregister(t){const i=this.observers.indexOf(t);i!==-1&&this.observers.splice(i,1)}unsubscribe(t){const i=this.subscriptions.indexOf(t);i!==-1&&this.subscriptions.splice(i,1)}notifyAll(t){const i=this.observers.length;for(let l=0;l<i;l++)this.observers[l].notify(t);const r=this.subscriptions.length;for(let l=0;l<r;l++)this.subscriptions[l](t)}clear(){this.observers.length=0,this.subscriptions.length=0}}class yt extends Qe{constructor(){super(...arguments),this._logger=gt.getInstance(),this._parentComponent=null,this._transform=new Ye,this._addChildTransform=t=>{const i=t.get(yt);i&&(i._transform.parent=this._transform,i._parentComponent=this)},this.zIndexChanged$=new We,this._z=0,this._coordPlane=Me.World}get(){return this._transform}onAdd(t){for(const i of t.children)this._addChildTransform(i);t.childrenAdded$.subscribe(i=>this._addChildTransform(i)),t.childrenRemoved$.subscribe(i=>{const r=i.get(yt);r&&(r._transform.parent=null,r._parentComponent=null)})}onRemove(t){this._transform.parent=null,this._parentComponent=null}get z(){return this._z}set z(t){const i=this._z;this._z=t,i!==t&&this.zIndexChanged$.notifyAll(t)}get coordPlane(){return this._parentComponent?this._parentComponent.coordPlane:this._coordPlane}set coordPlane(t){var i;this._parentComponent?this._logger.warn(`Cannot set coordinate plane on child entity ${(i=this.owner)===null||i===void 0?void 0:i.name}, children inherit their coordinate plane from their parents.`):this._coordPlane=t}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get globalPos(){return this._transform.globalPos}set globalPos(t){this._transform.globalPos=t}get rotation(){return this._transform.rotation}set rotation(t){this._transform.rotation=t}get globalRotation(){return this._transform.globalRotation}set globalRotation(t){this._transform.globalRotation=t}get scale(){return this._transform.scale}set scale(t){this._transform.scale=t}get globalScale(){return this._transform.globalScale}set globalScale(t){this._transform.globalScale=t}applyInverse(t){return this._transform.applyInverse(t)}apply(t){return this._transform.apply(t)}clone(){const t=new yt;return t._transform=this._transform.clone(),t._z=this._z,t}}class Bt extends Qe{constructor(){super(...arguments),this.vel=D.Zero,this.acc=D.Zero,this.scaleFactor=D.Zero,this.angularVelocity=0,this.torque=0,this.inertia=1}}class ti{static create(t,i){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);if(this._GROUPS.get(t)){const l=this._GROUPS.get(t);if(l.mask===i)return l;throw new Error(`Collision group ${t} already exists with a different mask!`)}const r=new cs(t,this._CURRENT_BIT,i!==void 0?i:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,r),r}static get groups(){return Array.from(this._GROUPS.values())}static groupByName(t){return this._GROUPS.get(t)}static reset(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}ti._STARTING_BIT=1,ti._MAX_GROUPS=32,ti._CURRENT_GROUP=1,ti._CURRENT_BIT=ti._STARTING_BIT,ti._GROUPS=new Map;class cs{constructor(t,i,r){this._name=t,this._category=i,this._mask=r}get name(){return this._name}get category(){return this._category}get mask(){return this._mask}canCollide(t){const i=this.category&t.mask,r=this.mask&t.category;return i!==0&&r!==0}invert(){const t=ti.create("~("+this.name+")",~this.mask|0);return t._category=~this.category,t}static combine(t){const i=t.map(c=>c.name).join("+"),l=~t.reduce((c,g)=>g.category|c,0);return ti.create(i,l)}static collidesWith(t){const i=`collidesWith(${t.map(l=>l.name).join("+")})`,r=t.reduce((l,c)=>c.category|l,0);return ti.create(i,r)}toString(){return`
category: ${this.category.toString(2).padStart(32,"0")}
mask:     ${(this.mask>>>0).toString(2).padStart(32,"0")}
    `}}cs.All=new cs("Collide with all groups",-1,-1);class Xi{constructor(t,i){this.colliderA=t,this.colliderB=i,this.id=null,this.id=Xi.calculatePairHash(t.id,i.id)}static canCollide(t,i){var r,l;const c=(r=t==null?void 0:t.owner)===null||r===void 0?void 0:r.get(Lt),g=(l=i==null?void 0:i.owner)===null||l===void 0?void 0:l.get(Lt);return!(t.id===i.id||t.owner&&i.owner&&t.owner.id===i.owner.id||t.localBounds.hasZeroDimensions()||i.localBounds.hasZeroDimensions()||!c||!g||!c.group.canCollide(g.group)||c.collisionType===Mt.Fixed&&g.collisionType===Mt.Fixed||g.collisionType===Mt.PreventCollision||c.collisionType===Mt.PreventCollision||!c.active||!g.active)}get canCollide(){const t=this.colliderA,i=this.colliderB;return Xi.canCollide(t,i)}collide(){return this.colliderA.collide(this.colliderB)}hasCollider(t){return t===this.colliderA||t===this.colliderB}static calculatePairHash(t,i){return t.value<i.value?`#${t.value}+${i.value}`:`#${i.value}+${t.value}`}}class rr{constructor(t,i){this.min=t,this.max=i}overlaps(t){return this.max>t.min&&t.max>this.min}getOverlap(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}class xh{constructor(t){this.parent=t,this.parent=t||null,this.data=null,this.bounds=new mt,this.left=null,this.right=null,this.height=0}isLeaf(){return!this.left&&!this.right}}class bh{constructor(t,i=new mt(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)){this._config=t,this.worldBounds=i,this.root=null,this.nodes={}}_insert(t){if(this.root===null){this.root=t,this.root.parent=null;return}const i=t.bounds;let r=this.root;for(;!r.isLeaf();){const m=r.left,w=r.right,C=r.bounds.getPerimeter(),T=r.bounds.combine(i).getPerimeter(),M=2*T,z=2*(T-C);let W=0;const Z=i.combine(m.bounds);let st,q;m.isLeaf()?W=Z.getPerimeter()+z:(q=m.bounds.getPerimeter(),st=Z.getPerimeter(),W=st-q+z);let Q=0;const ot=i.combine(w.bounds);if(w.isLeaf()?Q=ot.getPerimeter()+z:(q=w.bounds.getPerimeter(),st=ot.getPerimeter(),Q=st-q+z),M<W&&M<Q)break;W<Q?r=m:r=w}const l=r.parent,c=new xh(l);c.bounds=i.combine(r.bounds),c.height=r.height+1,l!==null?(l.left===r?l.left=c:l.right=c,c.left=r,c.right=t,r.parent=c,t.parent=c):(c.left=r,c.right=t,r.parent=c,t.parent=c,this.root=c);let g=t.parent;for(;g;){if(g=this._balance(g),!g.left)throw new Error("Parent of current leaf cannot have a null left child"+g);if(!g.right)throw new Error("Parent of current leaf cannot have a null right child"+g);g.height=1+Math.max(g.left.height,g.right.height),g.bounds=g.left.bounds.combine(g.right.bounds),g=g.parent}}_remove(t){if(t===this.root){this.root=null;return}const i=t.parent,r=i.parent;let l;if(i.left===t?l=i.right:l=i.left,r){r.left===i?r.left=l:r.right=l,l.parent=r;let c=r;for(;c;)c=this._balance(c),c.bounds=c.left.bounds.combine(c.right.bounds),c.height=1+Math.max(c.left.height,c.right.height),c=c.parent}else this.root=l,l.parent=null}trackCollider(t){const i=new xh;i.data=t,i.bounds=t.bounds,i.bounds.left-=2,i.bounds.top-=2,i.bounds.right+=2,i.bounds.bottom+=2,this.nodes[t.id.value]=i,this._insert(i)}updateCollider(t){var i;const r=this.nodes[t.id.value];if(!r)return!1;const l=t.bounds;if(!this.worldBounds.contains(l))return gt.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(r.bounds.contains(l))return!1;if(this._remove(r),l.left-=this._config.boundsPadding,l.top-=this._config.boundsPadding,l.right+=this._config.boundsPadding,l.bottom+=this._config.boundsPadding,t.owner){const c=(i=t.owner)===null||i===void 0?void 0:i.get(Lt);if(c){const g=c.vel.x*32/1e3*this._config.velocityMultiplier,m=c.vel.y*32/1e3*this._config.velocityMultiplier;g<0?l.left+=g:l.right+=g,m<0?l.top+=m:l.bottom+=m}}return r.bounds=l,this._insert(r),!0}untrackCollider(t){const i=this.nodes[t.id.value];i&&(this._remove(i),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}_balance(t){if(t===null)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;const i=t.left,r=t.right,l=t,c=i,g=r,m=i.left,w=i.right,C=r.left,A=r.right,T=g.height-c.height;if(T>1)return g.left=l,g.parent=l.parent,l.parent=g,g.parent?g.parent.left===l?g.parent.left=g:g.parent.right=g:this.root=g,C.height>A.height?(g.right=C,l.right=A,A.parent=l,l.bounds=c.bounds.combine(A.bounds),g.bounds=l.bounds.combine(C.bounds),l.height=1+Math.max(c.height,A.height),g.height=1+Math.max(l.height,C.height)):(g.right=A,l.right=C,C.parent=l,l.bounds=c.bounds.combine(C.bounds),g.bounds=l.bounds.combine(A.bounds),l.height=1+Math.max(c.height,C.height),g.height=1+Math.max(l.height,A.height)),g;if(T<-1){if(c.left=l,c.parent=l.parent,l.parent=c,c.parent)if(c.parent.left===l)c.parent.left=c;else{if(c.parent.right!==l)throw"Error rotating Dynamic Tree";c.parent.right=c}else this.root=c;return m.height>w.height?(c.right=m,l.left=w,w.parent=l,l.bounds=g.bounds.combine(w.bounds),c.bounds=l.bounds.combine(m.bounds),l.height=1+Math.max(g.height,w.height),c.height=1+Math.max(l.height,m.height)):(c.right=w,l.left=m,m.parent=l,l.bounds=g.bounds.combine(m.bounds),c.bounds=l.bounds.combine(w.bounds),l.height=1+Math.max(g.height,m.height),c.height=1+Math.max(l.height,w.height)),c}return t}getHeight(){return this.root===null?0:this.root.height}query(t,i){const r=t.bounds,l=c=>{if(c&&c.bounds.overlaps(r))if(c.isLeaf()&&c.data!==t){if(i.call(t,c.data))return!0}else return l(c.left)||l(c.right);return!1};l(this.root)}rayCastQuery(t,i=1/0,r){const l=c=>{if(c&&c.bounds.rayCast(t,i))if(c.isLeaf()){if(r.call(t,c.data))return!0}else return l(c.left)||l(c.right);return!1};l(this.root)}getNodes(){const t=i=>i?[i].concat(t(i.left),t(i.right)):[];return t(this.root)}debug(t){const i=r=>{r&&(r.isLeaf()?r.bounds.draw(t,nt.Green):r.bounds.draw(t,nt.White),r.left&&i(r.left),r.right&&i(r.right))};i(this.root)}}class ds{constructor(t,i){this.pos=t,this.dir=i.normalize()}intersect(t){const i=t.begin.sub(this.pos);if(this.dir.cross(t.getSlope())===0&&i.cross(this.dir)!==0)return-1;const r=this.dir.cross(t.getSlope());if(r===0)return-1;const l=i.cross(t.getSlope())/r;if(l>=0){const c=i.cross(this.dir)/r/t.getLength();if(c>=0&&c<=1)return l}return-1}intersectPoint(t){const i=this.intersect(t);return i<0?null:this.getPoint(i)}getPoint(t){return this.pos.add(this.dir.scale(t))}}class ko{constructor(t){this._config=t,this._pairs=new Set,this._collisionPairCache=[],this._colliders=[],this._dynamicCollisionTree=new bh(t.dynamicTree)}getColliders(){return this._colliders}rayCast(t,i){var r,l,c;const g=[],m=(r=i==null?void 0:i.maxDistance)!==null&&r!==void 0?r:1/0,w=i==null?void 0:i.collisionGroup,C=w?w.category:(l=i==null?void 0:i.collisionMask)!==null&&l!==void 0?l:cs.All.category,A=(c=i==null?void 0:i.searchAllColliders)!==null&&c!==void 0?c:!1;return this._dynamicCollisionTree.rayCastQuery(t,m,T=>{const z=T.owner.get(Lt);if(i!=null&&i.ignoreCollisionGroupAll&&z.group===cs.All)return!1;const W=(C&z.group.category)!==0;if(z!=null&&z.group&&!W)return!1;const Z=T.rayCast(t,m);if(Z){if(i!=null&&i.filter){if(i.filter(Z)&&(g.push(Z),!A))return!0}else if(g.push(Z),!A)return!0}return!1}),g}track(t){if(!t){gt.getInstance().warn("Cannot track null collider");return}if(t instanceof ei){const i=t.getColliders();for(const r of i)r.owner=t.owner,this._colliders.push(r),this._dynamicCollisionTree.trackCollider(r)}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t)}untrack(t){if(!t){gt.getInstance().warn("Cannot untrack a null collider");return}if(t instanceof ei){const i=t.getColliders();for(const r of i){const l=this._colliders.indexOf(r);l!==-1&&this._colliders.splice(l,1),this._dynamicCollisionTree.untrackCollider(r)}}else{const i=this._colliders.indexOf(t);i!==-1&&this._colliders.splice(i,1),this._dynamicCollisionTree.untrackCollider(t)}}_pairExists(t,i){const r=Xi.calculatePairHash(t.id,i.id);return this._pairs.has(r)}broadphase(t,i,r){const l=i/1e3,c=t.filter(m=>{var w,C;const A=(w=m.owner)===null||w===void 0?void 0:w.get(Lt);return((C=m.owner)===null||C===void 0?void 0:C.active)&&A.collisionType!==Mt.PreventCollision});this._collisionPairCache=[],this._pairs.clear();let g;for(let m=0,w=c.length;m<w;m++)g=c[m],this._dynamicCollisionTree.query(g,C=>{if(!this._pairExists(g,C)&&Xi.canCollide(g,C)){const A=new Xi(g,C);this._pairs.add(A.id),this._collisionPairCache.push(A)}return!1});if(r&&(r.physics.pairs=this._collisionPairCache.length),this._config.continuous.checkForFastBodies)for(const m of c){const w=m.owner.get(Lt);if(w.collisionType!==Mt.Active)continue;const C=w.vel.size*l+w.acc.size*.5*l*l,A=Math.min(m.bounds.height,m.bounds.width);if(this._config.continuous.disableMinimumSpeedForFastBody||C>A/2){r&&r.physics.fastBodies++;const T=w.globalPos.sub(w.oldPos),M=m.center,z=m.getFurthestPoint(w.vel),W=z.sub(T),Z=new ds(W,w.vel);Z.pos=Z.pos.add(Z.dir.scale(-2*this._config.continuous.surfaceEpsilon));let st,q=new D(1/0,1/0);if(this._dynamicCollisionTree.rayCastQuery(Z,C+this._config.continuous.surfaceEpsilon*2,Q=>{if(!this._pairExists(m,Q)&&Xi.canCollide(m,Q)){const ot=Q.rayCast(Z,C+this._config.continuous.surfaceEpsilon*10);if(ot){const et=ot.point.sub(W);et.size<q.size&&(q=et,st=Q)}}return!1}),st&&D.isValid(q)){const Q=new Xi(m,st);this._pairs.has(Q.id)||(this._pairs.add(Q.id),this._collisionPairCache.push(Q));const ot=M.sub(z);w.globalPos=W.add(ot).add(q).add(Z.dir.scale(10*this._config.continuous.surfaceEpsilon)),m.update(w.transform.get()),r&&r.physics.fastBodyCollisions++}}}return this._collisionPairCache}narrowphase(t,i){let r=[];for(let l=0;l<t.length;l++){const c=t[l].collide();if(r=r.concat(c),i&&c.length>0)for(const g of c)i.physics.contacts.set(g.id,g)}return i&&(i.physics.collisions+=r.length),r}update(t){let i=0;const r=t.length;for(let l=0;l<r;l++)this._dynamicCollisionTree.updateCollider(t[l])&&i++;return i}debug(t){this._dynamicCollisionTree.debug(t)}}class wn{constructor(){this.id=v("collider",wn._ID++),this.composite=null,this.events=new b,this.offset=D.Zero}touching(t){return!!this.collide(t)}}wn._ID=0;var $i;(function(f){f.Arcade="arcade",f.Realistic="realistic"})($i||($i={}));var Xa;(function(f){f[f.DynamicAABBTree=0]="DynamicAABBTree"})(Xa||(Xa={}));var Lo;(function(f){f[f.Euler=0]="Euler"})(Lo||(Lo={}));class kt{static get gravity(){return kt.acc}static set gravity(t){kt.acc=t}static useArcadePhysics(){kt.collisionResolutionStrategy=$i.Arcade}static useRealisticPhysics(){kt.collisionResolutionStrategy=$i.Realistic}}kt.acc=new D(0,0),kt.enabled=!0,kt.broadphaseStrategy=Xa.DynamicAABBTree,kt.collisionResolutionStrategy=$i.Arcade,kt.defaultMass=10,kt.integrator=Lo.Euler,kt.dynamicTreeVelocityMultiplier=2,kt.boundsPadding=5,kt.positionIterations=3,kt.velocityIterations=8,kt.slop=1,kt.steeringFactor=.2,kt.warmStart=!0,kt.bodiesCanSleepByDefault=!1,kt.surfaceEpsilon=.1,kt.sleepEpsilon=.07,kt.wakeThreshold=kt.sleepEpsilon*3,kt.sleepBias=.9,kt.checkForFastBodies=!0,kt.disableMinimumSpeedForFastBody=!1;var fs;(function(f){f.None="none",f.VerticalFirst="vertical-first",f.HorizontalFirst="horizontal-first"})(fs||(fs={}));const $a={vertical:1,horizontal:2},Ch={horizontal:1,vertical:2},ac={horizontal:0,vertical:0},sn={enabled:!0,gravity:j(0,0),solver:$i.Arcade,colliders:{compositeStrategy:"together"},continuous:{checkForFastBodies:!0,disableMinimumSpeedForFastBody:!1,surfaceEpsilon:.1},bodies:{canSleepByDefault:!1,sleepEpsilon:.07,wakeThreshold:.07*3,sleepBias:.9,defaultMass:10},dynamicTree:{boundsPadding:5,velocityMultiplier:2},arcade:{contactSolveBias:fs.None},realistic:{positionIterations:3,velocityIterations:8,slop:1,steeringFactor:.2,warmStart:!0}};function Mo(){return{enabled:kt.enabled,gravity:kt.gravity,solver:kt.collisionResolutionStrategy,continuous:{checkForFastBodies:kt.checkForFastBodies,disableMinimumSpeedForFastBody:kt.disableMinimumSpeedForFastBody,surfaceEpsilon:kt.surfaceEpsilon},colliders:{compositeStrategy:"together"},bodies:{canSleepByDefault:kt.bodiesCanSleepByDefault,sleepEpsilon:kt.sleepEpsilon,wakeThreshold:kt.wakeThreshold,sleepBias:kt.sleepBias,defaultMass:kt.defaultMass},dynamicTree:{boundsPadding:kt.boundsPadding,velocityMultiplier:kt.dynamicTreeVelocityMultiplier},arcade:{contactSolveBias:fs.None},realistic:{positionIterations:kt.positionIterations,velocityIterations:kt.velocityIterations,slop:kt.slop,steeringFactor:kt.steeringFactor,warmStart:kt.warmStart}}}class ei extends wn{set compositeStrategy(t){this._compositeStrategy=t}get compositeStrategy(){return this._compositeStrategy}constructor(t){super(),this._collisionProcessor=new ko(sn),this._dynamicAABBTree=new bh(sn.dynamicTree),this._colliders=[];for(const i of t)this.addCollider(i)}clearColliders(){this._colliders=[]}addCollider(t){let i;t instanceof ei?(i=t.getColliders(),i.forEach(r=>r.offset.addEqual(t.offset))):i=[t];for(const r of i)r.events.pipe(this.events),r.composite=this,this._colliders.push(r),this._collisionProcessor.track(r),this._dynamicAABBTree.trackCollider(r)}removeCollider(t){t.events.pipe(this.events),t.composite=null,Tt(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}getColliders(){return this._colliders}get worldPos(){var t,i;return((i=(t=this._transform)===null||t===void 0?void 0:t.pos)!==null&&i!==void 0?i:D.Zero).add(this.offset)}get center(){var t,i;return((i=(t=this._transform)===null||t===void 0?void 0:t.pos)!==null&&i!==void 0?i:D.Zero).add(this.offset)}get bounds(){var t,i;const r=this.getColliders();return r.reduce((c,g)=>c.combine(g.bounds),(i=(t=r[0])===null||t===void 0?void 0:t.bounds)!==null&&i!==void 0?i:new mt().translate(this.worldPos)).translate(this.offset)}get localBounds(){var t,i;const r=this.getColliders();return r.reduce((c,g)=>c.combine(g.localBounds),(i=(t=r[0])===null||t===void 0?void 0:t.localBounds)!==null&&i!==void 0?i:new mt)}get axes(){const t=this.getColliders();let i=[];for(const r of t)i=i.concat(r.axes);return i}getFurthestPoint(t){const i=this.getColliders(),r=[];for(const g of i)r.push(g.getFurthestPoint(t));let l=r[0],c=-Number.MAX_VALUE;for(const g of r){const m=g.dot(t);m>c&&(l=g,c=m)}return l}getInertia(t){const i=this.getColliders();let r=0;for(const l of i)r+=l.getInertia(t);return r}collide(t){let i=[t];t instanceof ei&&(i=t.getColliders());const r=[];for(const c of i)this._dynamicAABBTree.query(c,g=>(r.push(new Xi(c,g)),!1));let l=[];for(const c of r)l=l.concat(c.collide());return l}getClosestLineBetween(t){const i=this.getColliders(),r=[];if(t instanceof ei){const l=t.getColliders();for(const c of i)for(const g of l){const m=c.getClosestLineBetween(g);m&&r.push(m)}}else for(const l of i){const c=t.getClosestLineBetween(l);c&&r.push(c)}if(r.length){let l=r[0].getLength(),c=r[0];for(const g of r){const m=g.getLength();m<l&&(l=m,c=g)}return c}return null}contains(t){const i=this.getColliders();for(const r of i)if(r.contains(t))return!0;return!1}rayCast(t,i){const r=this.getColliders(),l=[];for(const c of r){const g=c.rayCast(t,i);g&&l.push(g)}if(l.length){let c=l[0],g=c.point.dot(t.dir);for(const m of l){const w=t.dir.dot(m.point);w<g&&(c=m,g=w)}return c}return null}project(t){const i=this.getColliders(),r=[];for(const l of i){const c=l.project(t);c&&r.push(c)}if(r.length){const l=new rr(r[0].min,r[0].max);for(const c of r)l.min=Math.min(c.min,l.min),l.max=Math.max(c.max,l.max);return l}return null}update(t){if(t){const i=this.getColliders();for(const r of i)r.owner=this.owner,r.update(t)}}debug(t,i,r){const l=this.getColliders();t.save(),t.translate(this.offset.x,this.offset.y);for(const c of l)c.debug(t,i,r);t.restore()}clone(){const t=new ei(this._colliders.map(i=>i.clone()));return t.offset=this.offset.clone(),t}}class pi{constructor(t,i){this.begin=t,this.end=i}get slope(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}get intercept(){return this.begin.y-this.slope*this.begin.x}normal(){return this._normal?this._normal:this._normal=this.end.sub(this.begin).normal()}dir(){return this._dir?this._dir:this._dir=this.end.sub(this.begin)}getPoints(){return[this.begin,this.end]}getSlope(){if(this._slope)return this._slope;const t=this.begin,i=this.end,r=t.distance(i);return this._slope=i.sub(t).scale(1/r)}getEdge(){const t=this.begin;return this.end.sub(t)}getLength(){if(this._length)return this._length;const t=this.begin,i=this.end,r=t.distance(i);return this._length=r}get midpoint(){return this.begin.add(this.end).scale(.5)}flip(){return new pi(this.end,this.begin)}below(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}clip(t,i){let r=t;r=r.normalize();const l=r.dot(this.begin)-i,c=r.dot(this.end)-i,g=[];if(l<=0&&g.push(this.begin),c<=0&&g.push(this.end),l*c<0){const m=l/(l-c);g.push(this.begin.add(this.end.sub(this.begin).scale(m)))}return g.length!==2?null:new pi(g[0],g[1])}distanceToPoint(t,i=!1){const r=t.x,l=t.y,c=this.getLength(),g=this.end.y-this.begin.y,m=this.end.x-this.begin.x,w=(g*r-m*l+this.end.x*this.begin.y-this.end.y*this.begin.x)/c;return i?w:Math.abs(w)}findVectorToPoint(t){const i=this.begin.sub(t),r=this.getSlope();return i.sub(r.scale(i.dot(r)))}findPoint(t=null,i=null){const r=this.slope,l=this.intercept;if(t!==null)return new D(t,r*t+l);if(i!==null)return new D((i-l)/r,i);throw new Error("You must provide an X or a Y value")}hasPoint(){let t,i=0;if(typeof arguments[0]=="number"&&typeof arguments[1]=="number")t=new D(arguments[0],arguments[1]),i=arguments[2]||0;else if(arguments[0]instanceof D)t=arguments[0],i=arguments[1]||0;else throw"Could not determine the arguments for Vector.hasPoint";const r=t.x-this.begin.x,l=t.y-this.begin.y,c=this.end.x-this.begin.x,g=this.end.y-this.begin.y,m=r*g-l*c;return Math.abs(m)>i?!1:Math.abs(c)>=Math.abs(g)?c>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:g>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y}}function gi(f,t,i,r){const l=f.sub(i),c=t.dot(t),g=t.dot(r),m=r.dot(r),w=t.dot(l),C=r.dot(l),A=c*m-g*g;let T=A,M=A;if(A===0||A<=.01){const Z=w/g;return new pi(f,i.add(r.scale(Z)))}let z=g*C-m*w,W=c*C-g*w;return z<0?(z=0,W=C,M=m):z>T&&(z=T,W=C+g,M=m),W<0?(W=0,-w<0?z=0:-w>c?z=T:(z=-w,T=c)):W>M&&(W=M,-w+g<0?z=0:-w+g>c?z=T:(z=-w+g,T=c)),z=Math.abs(z)<.001?0:z/T,W=Math.abs(W)<.001?0:W/M,new pi(f.add(t.scale(z)),i.add(r.scale(W)))}const rn={PolygonPolygonClosestLine(f,t){const i=t.worldPos,r=i.sub(f.worldPos),l=r.negate(),c=new ds(f.worldPos,r),g=new ds(i,l),m=f.rayCast(c).point.add(c.dir.scale(.1)),w=t.rayCast(g).point.add(g.dir.scale(.1)),C=f.getClosestFace(m),A=t.getClosestFace(w),T=C.face.begin,M=C.face.getEdge(),z=A.face.begin,W=A.face.getEdge();return gi(T,M,z,W)},PolygonEdgeClosestLine(f,t){const r=t.worldPos.sub(f.worldPos),l=new ds(f.worldPos,r),c=f.rayCast(l).point.add(l.dir.scale(.1)),g=f.getClosestFace(c),m=g.face.begin,w=g.face.getEdge(),C=t.asLine(),A=C.begin,T=C.getEdge();return gi(m,w,A,T)},PolygonCircleClosestLine(f,t){const i=t.worldPos,r=i.sub(f.worldPos),l=new ds(f.worldPos,r.normalize()),c=f.rayCast(l).point.add(l.dir.scale(.1)),g=f.getClosestFace(c),m=g.face.begin,w=g.face.getEdge();let C=(w.x*(i.x-m.x)+w.y*(i.y-m.y))/(w.x*w.x+w.y*w.y);C>1?C=1:C<0&&(C=0);const A=Math.sqrt(Math.pow(m.x+w.x*C-i.x,2)+Math.pow(m.y+w.y*C-i.y,2))-t.radius,T=(m.x+w.x*C-i.x)*t.radius/(t.radius+A),M=(m.y+w.y*C-i.y)*t.radius/(t.radius+A);return new pi(w.scale(C).add(m),new D(i.x+T,i.y+M))},CircleCircleClosestLine(f,t){const r=t.worldPos.sub(f.worldPos),c=f.worldPos.sub(t.worldPos),g=new ds(f.worldPos,r),m=new ds(t.worldPos,c),w=f.rayCast(g),C=t.rayCast(m);return new pi(w.point,C.point)},CircleEdgeClosestLine(f,t){const i=f.worldPos,r=t.asLine(),l=r.begin,c=r.getEdge(),g=l,m=c;let w=(m.x*(i.x-g.x)+m.y*(i.y-g.y))/(m.x*m.x+m.y*m.y);w>1?w=1:w<0&&(w=0);const C=Math.sqrt(Math.pow(g.x+m.x*w-i.x,2)+Math.pow(g.y+m.y*w-i.y,2))-f.radius,A=(g.x+m.x*w-i.x)*f.radius/(f.radius+C),T=(g.y+m.y*w-i.y)*f.radius/(f.radius+C);return new pi(m.scale(w).add(g),new D(i.x+A,i.y+T))},EdgeEdgeClosestLine(f,t){const i=f.asLine(),r=i.begin,l=i.getEdge(),c=r,g=l,m=t.asLine(),w=m.begin,C=m.getEdge();return gi(c,g,w,C)}};class Re extends wn{get worldPos(){return this._globalMatrix.getPosition()}get radius(){var t;const i=this._transform,r=(t=i==null?void 0:i.globalScale)!==null&&t!==void 0?t:D.One;return this._naturalRadius*Math.min(r.x,r.y)}set radius(t){var i;const r=this._transform,l=(i=r==null?void 0:r.globalScale)!==null&&i!==void 0?i:D.One;this._naturalRadius=t/Math.min(l.x,l.y)}constructor(t){super(),this.offset=D.Zero,this._globalMatrix=Zt.identity(),this.offset=t.offset||D.Zero,this.radius=t.radius||0,this._globalMatrix.translate(this.offset.x,this.offset.y)}clone(){return new Re({offset:this.offset.clone(),radius:this.radius})}get center(){return this._globalMatrix.getPosition()}contains(t){var i,r;return((r=(i=this._transform)===null||i===void 0?void 0:i.pos)!==null&&r!==void 0?r:this.offset).distance(t)<=this.radius}rayCast(t,i=1/0){var r,l;const c=this.center,g=t.dir,m=t.pos,w=Math.sqrt(Math.pow(g.dot(m.sub(c)),2)-Math.pow(m.sub(c).distance(),2)+Math.pow(this.radius,2));if(w<0)return null;{let C=0;if(w===0){if(C=-g.dot(m.sub(c)),C>0&&C<i){const A=t.getPoint(C);return{point:A,normal:A.sub(c).normalize(),collider:this,body:(r=this.owner)===null||r===void 0?void 0:r.get(Lt),distance:C}}return null}else{const A=-g.dot(m.sub(c))+w,T=-g.dot(m.sub(c))-w,M=[];A>=0&&M.push(A),T>=0&&M.push(T);const z=Math.min(...M);if(z<=i){const W=t.getPoint(z);return{point:W,normal:W.sub(c).normalize(),collider:this,body:(l=this.owner)===null||l===void 0?void 0:l.get(Lt),distance:z}}return null}}}getClosestLineBetween(t){if(t instanceof Re)return rn.CircleCircleClosestLine(this,t);if(t instanceof qe)return rn.PolygonCircleClosestLine(t,this).flip();if(t instanceof Ni)return rn.CircleEdgeClosestLine(this,t).flip();throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof Re)return xn.CollideCircleCircle(this,t);if(t instanceof qe)return xn.CollideCirclePolygon(this,t);if(t instanceof Ni)return xn.CollideCircleEdge(this,t);throw new Error(`Circle could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){return this.center.add(t.normalize().scale(this.radius))}getFurthestLocalPoint(t){return t.normalize().scale(this.radius)}get bounds(){var t,i,r;const l=this._transform,c=(t=l==null?void 0:l.globalScale)!==null&&t!==void 0?t:D.One,g=(i=l==null?void 0:l.globalRotation)!==null&&i!==void 0?i:0,m=(r=l==null?void 0:l.globalPos)!==null&&r!==void 0?r:D.Zero;return new mt(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius).rotate(g).scale(c).translate(m)}get localBounds(){return new mt(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius)}get axes(){return[]}getInertia(t){return t*this.radius*this.radius/2}update(t){var i;this._transform=t,((i=t.matrix)!==null&&i!==void 0?i:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const i=[],l=this.center.dot(t);return i.push(l),i.push(l+this.radius),i.push(l-this.radius),new rr(Math.min.apply(Math,i),Math.max.apply(Math,i))}debug(t,i,r){var l,c,g,m;const{lineWidth:w}={lineWidth:1,...r},C=this._transform,A=(l=C==null?void 0:C.globalScale)!==null&&l!==void 0?l:D.One,T=(c=C==null?void 0:C.globalRotation)!==null&&c!==void 0?c:0,M=(g=C==null?void 0:C.globalPos)!==null&&g!==void 0?g:D.Zero;t.save(),t.translate(M.x,M.y),t.rotate(T),t.scale(A.x,A.y),t.drawCircle((m=this.offset)!==null&&m!==void 0?m:D.Zero,this._naturalRadius,nt.Transparent,i,w),t.restore()}}class Ns{constructor(t,i,r,l,c,g,m,w){var C,A,T,M,z,W;if(this._canceled=!1,this.colliderA=t,this.colliderB=i,this.mtv=r,this.normal=l,this.tangent=c,this.points=g,this.localPoints=m,this.info=w,this.id=Xi.calculatePairHash(t.id,i.id),t.composite||i.composite){const Z=((C=t.composite)===null||C===void 0?void 0:C.compositeStrategy)==="separate"?t.id:(T=(A=t.composite)===null||A===void 0?void 0:A.id)!==null&&T!==void 0?T:t.id,st=((M=i.composite)===null||M===void 0?void 0:M.compositeStrategy)==="separate"?i.id:(W=(z=i.composite)===null||z===void 0?void 0:z.id)!==null&&W!==void 0?W:i.id;this.id+="|"+Xi.calculatePairHash(Z,st)}}matchAwake(){const t=this.colliderA.owner.get(Lt),i=this.colliderB.owner.get(Lt);t&&i&&t.sleeping!==i.sleeping&&(t.sleeping&&t.collisionType!==Mt.Fixed&&i.sleepMotion>=t.wakeThreshold&&t.setSleeping(!1),i.sleeping&&i.collisionType!==Mt.Fixed&&t.sleepMotion>=i.wakeThreshold&&i.setSleeping(!1))}isCanceled(){return this._canceled}cancel(){this._canceled=!0}}class Ya{static findPolygonPolygonSeparation(t,i){let r=-Number.MAX_VALUE,l=null,c=null,g=-1,m=null;const w=t.getSides(),C=t.getLocalSides();for(let A=0;A<w.length;A++){const T=w[A],M=T.normal(),z=i.getFurthestPoint(M.negate()),W=T.distanceToPoint(z,!0);W>r&&(r=W,l=T,c=M,g=A,m=z)}return{collider:t,separation:c?r:99,axis:c,side:l,localSide:C[g],sideId:g,point:m,localPoint:c?i.getFurthestLocalPoint(c.negate()):null}}static findCirclePolygonSeparation(t,i){const r=i.axes,c=i.center.sub(t.worldPos),g=i.getFurthestPoint(c.negate());r.push(g.sub(t.worldPos).normalize());let m=Number.MAX_VALUE,w=null,C=-1;for(let A=0;A<r.length;A++){const T=i.project(r[A]),M=t.project(r[A]),z=T.getOverlap(M);if(z<=0)return null;z<m&&(m=z,w=r[A],C=A)}return C<0?null:w.normalize().scale(m)}}const xn={CollideCircleCircle(f,t){const i=f.worldPos,r=t.worldPos,l=f.radius+t.radius,c=i.distance(r);if(c>l)return[];const g=l-c,m=r.sub(i).normalize(),w=m.perpendicular(),C=m.scale(g),A=f.getFurthestPoint(m),T=f.getFurthestLocalPoint(m),M={collider:f,separation:g,axis:m,point:A};return[new Ns(f,t,C,m,w,[A],[T],M)]},CollideCirclePolygon(f,t){var i,r;let l=Ya.findCirclePolygonSeparation(f,t);if(!l)return[];l=l.dot(t.center.sub(f.center))<0?l.negate():l;const g=f.getFurthestPoint(l),w=((r=(i=f.owner)===null||i===void 0?void 0:i.get(yt))!==null&&r!==void 0?r:new yt).applyInverse(g),C=l.normalize(),A={collider:f,separation:-l.size,axis:C,point:g,localPoint:w,side:t.findSide(C.negate()),localSide:t.findLocalSide(C.negate())};return[new Ns(f,t,l,C,C.perpendicular(),[g],[w],A)]},CollideCircleEdge(f,t){const i=f.center,r=t.asLine(),l=r.end.sub(r.begin),c=l.dot(r.end.sub(i)),g=l.dot(i.sub(r.begin)),m=t.asLine(),w=t.asLocalLine();if(g<=0){const q=r.begin.sub(i),Q=q.dot(q);if(Q>f.radius*f.radius)return[];const ot=q.normalize(),et=f.radius-Math.sqrt(Q),_t={collider:f,separation:et,axis:ot,point:m.begin,side:m,localSide:w};return[new Ns(f,t,ot.scale(et),ot,ot.perpendicular(),[m.begin],[w.begin],_t)]}if(c<=0){const q=r.end.sub(i),Q=q.dot(q);if(Q>f.radius*f.radius)return[];const ot=q.normalize(),et=f.radius-Math.sqrt(Q),_t={collider:f,separation:et,axis:ot,point:m.end,side:m,localSide:w};return[new Ns(f,t,ot.scale(et),ot,ot.perpendicular(),[m.end],[w.end],_t)]}const C=l.dot(l),A=r.begin.scale(c).add(r.end.scale(g)).scale(1/C),T=i.sub(A),M=T.dot(T);if(M>f.radius*f.radius)return[];let z=l.perpendicular();z.dot(i.sub(r.begin))<0&&(z.x=-z.x,z.y=-z.y),z=z.normalize();const W=f.radius-Math.sqrt(M),Z=z.scale(W),st={collider:f,separation:W,axis:z,point:A,side:m,localSide:w};return[new Ns(f,t,Z,z.negate(),z.negate().perpendicular(),[A],[A.sub(t.worldPos)],st)]},CollideEdgeEdge(){return[]},CollidePolygonEdge(f,t){var i;const r=f.center,c=t.center.sub(r).normalize(),g=new qe({points:[t.begin,t.end,t.end.add(c.scale(100)),t.begin.add(c.scale(100))],offset:t.offset});g.owner=t.owner,((i=t.owner)===null||i===void 0?void 0:i.get(yt))&&g.update(t.owner.get(yt).get());const w=this.CollidePolygonPolygon(f,g);return w.length&&(w[0].colliderB=t,w[0].id=Xi.calculatePairHash(f.id,t.id)),w},CollidePolygonPolygon(f,t){var i,r,l,c;const g=Ya.findPolygonPolygonSeparation(f,t);if(g.separation>0)return[];const m=Ya.findPolygonPolygonSeparation(t,f);if(m.separation>0)return[];const w=g.separation>m.separation?g:m,A=(w.collider===f?t:f).findSide(w.axis.negate()),T=w.side,M=T.dir().normalize(),z=A.clip(M.negate(),-M.dot(T.begin));let W=null;if(z&&(W=z.clip(M,M.dot(T.end))),W){const Z=W.getPoints().filter(ot=>T.below(ot));let st=w.axis,q=st.perpendicular();t.center.sub(f.center).dot(st)<0&&(st=st.negate(),q=st.perpendicular());let Q=[];if(w.collider===f){const ot=(r=(i=t.owner)===null||i===void 0?void 0:i.get(yt))!==null&&r!==void 0?r:new yt;Q=Z.map(et=>ot.applyInverse(et))}else{const ot=(c=(l=f.owner)===null||l===void 0?void 0:l.get(yt))!==null&&c!==void 0?c:new yt;Q=Z.map(et=>ot.applyInverse(et))}return[new Ns(f,t,st.scale(-w.separation),st,q,Z,Q,w)]}return[]},FindContactSeparation(f,t){var i,r,l,c;const g=f.colliderA,m=(r=(i=f.colliderA.owner)===null||i===void 0?void 0:i.get(yt))!==null&&r!==void 0?r:new yt,w=f.colliderB,C=(c=(l=f.colliderB.owner)===null||l===void 0?void 0:l.get(yt))!==null&&c!==void 0?c:new yt;if(g instanceof Re&&w instanceof Re){const A=g.radius+w.radius,T=m.pos.distance(C.pos);return-(A-T)}if(g instanceof qe&&w instanceof qe&&f.info.localSide){let A,T;return f.info.collider===g?(A=new pi(m.apply(f.info.localSide.begin),m.apply(f.info.localSide.end)),T=C.apply(t)):(A=new pi(C.apply(f.info.localSide.begin),C.apply(f.info.localSide.end)),T=m.apply(t)),A.distanceToPoint(T,!0)}if(g instanceof qe&&w instanceof Re||w instanceof qe&&g instanceof Re){const A=m.apply(t);if(f.info.side)return f.info.side.distanceToPoint(A,!0)}if(g instanceof Ni&&w instanceof qe||w instanceof Ni&&g instanceof qe){let A;if(f.info.collider===g?A=C.apply(t):A=m.apply(t),f.info.side)return f.info.side.distanceToPoint(A,!0)}if(g instanceof Re&&w instanceof Ni||w instanceof Re&&g instanceof Ni){const A=C.apply(t);let T;g instanceof Re&&(T=g.getFurthestPoint(f.normal));const M=A.distance(T);if(f.info.side)return M>0?-M:0}return 0}};class Ni extends wn{constructor(t){var i;super(),this._globalMatrix=Zt.identity(),this.begin=t.begin||D.Zero,this.end=t.end||D.Zero,this.offset=(i=t.offset)!==null&&i!==void 0?i:D.Zero}clone(){return new Ni({begin:this.begin.clone(),end:this.end.clone()})}get worldPos(){var t;const i=this._transform;return(t=i==null?void 0:i.globalPos.add(this.offset))!==null&&t!==void 0?t:this.offset}get center(){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return t.average(i)}_getTransformedBegin(){return this._globalMatrix.multiply(this.begin)}_getTransformedEnd(){return this._globalMatrix.multiply(this.end)}getSlope(){const t=this._getTransformedBegin(),i=this._getTransformedEnd(),r=t.distance(i);return i.sub(t).scale(1/r)}getLength(){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return t.distance(i)}contains(){return!1}rayCast(t,i=1/0){var r;const l=this._getTransformedBegin().sub(t.pos);if(t.dir.cross(this.getSlope())===0&&l.cross(t.dir)!==0)return null;const c=t.dir.cross(this.getSlope());if(c===0)return null;const g=l.cross(this.getSlope())/c;if(g>=0&&g<=i){const m=l.cross(t.dir)/c/this.getLength();if(m>=0&&m<=1)return{distance:g,normal:this.asLine().normal(),collider:this,body:(r=this.owner)===null||r===void 0?void 0:r.get(Lt),point:t.getPoint(g)}}return null}getClosestLineBetween(t){if(t instanceof Re)return rn.CircleEdgeClosestLine(t,this);if(t instanceof qe)return rn.PolygonEdgeClosestLine(t,this).flip();if(t instanceof Ni)return rn.EdgeEdgeClosestLine(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof Re)return xn.CollideCircleEdge(t,this);if(t instanceof qe)return xn.CollidePolygonEdge(t,this);if(t instanceof Ni)return xn.CollideEdgeEdge();throw new Error(`Edge could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){const i=this._getTransformedBegin(),r=this._getTransformedEnd();return t.dot(i)>0?i:r}_boundsFromBeginEnd(t,i,r=10){return new mt(Math.min(t.x,i.x)-r,Math.min(t.y,i.y)-r,Math.max(t.x,i.x)+r,Math.max(t.y,i.y)+r)}get bounds(){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return this._boundsFromBeginEnd(t,i)}get localBounds(){return this._boundsFromBeginEnd(this.begin,this.end)}asLine(){return new pi(this._getTransformedBegin(),this._getTransformedEnd())}asLocalLine(){return new pi(this.begin,this.end)}get axes(){const i=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),r=[];return r.push(i),r.push(i.negate()),r.push(i.normal()),r.push(i.normal().negate()),r}getInertia(t){const i=this.end.sub(this.begin).distance()/2;return t*i*i}update(t){var i;this._transform=t,((i=t.matrix)!==null&&i!==void 0?i:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const i=[],r=[this._getTransformedBegin(),this._getTransformedEnd()],l=r.length;for(let c=0;c<l;c++)i.push(r[c].dot(t));return new rr(Math.min.apply(Math,i),Math.max.apply(Math,i))}debug(t,i){const r=this._getTransformedBegin(),l=this._getTransformedEnd();t.drawLine(r,l,i,2),t.drawCircle(r,2,i),t.drawCircle(l,2,i)}}class je{static registerGraphicsContext(t){je._ctx=t}static draw(t){this._drawCalls.push(t)}static drawPoint(t,i){je.draw(r=>{r.debug.drawPoint(t,i)})}static drawLine(t,i,r){je.draw(l=>{l.debug.drawLine(t,i,r)})}static drawLines(t,i){t.length>1&&je.draw(r=>{for(let l=0;l<t.length-1;l++)r.debug.drawLine(t[l],t[l+1],i)})}static drawText(t,i){je.draw(r=>{r.debug.drawText(t,i)})}static drawPolygon(t,i){t.length>1&&je.draw(r=>{const l=t[0],c=[...t,l];for(let g=0;g<c.length-1;g++)r.debug.drawLine(c[g],c[g+1],i)})}static drawCircle(t,i,r){const{color:l,strokeColor:c,width:g}={color:nt.Black,strokeColor:void 0,width:void 0,...r};je.draw(m=>{m.drawCircle(t,i,l,c,g)})}static drawBounds(t,i){je.draw(r=>{r.debug.drawRect(t.left,t.top,t.width,t.height,i)})}static drawRay(t,i){const{distance:r,color:l}={color:nt.Blue,distance:10,...i};je.draw(c=>{const g=t.pos,m=t.pos.add(t.dir.scale(r));c.debug.drawLine(g,m,{color:l})})}static flush(t){t.save(),t.z=je.z;for(const i of je._drawCalls)i(t);t.restore(),je.clear()}static clear(){je._drawCalls.length=0}}je._drawCalls=[],je.z=1/0;class qe extends wn{flagDirty(){this._localBoundsDirty=!0,this._localSidesDirty=!0,this._transformedPointsDirty=!0,this._sidesDirty=!0}set points(t){this._points=t,this.flagDirty()}get points(){return this._points}constructor(t){var i,r;super(),this._logger=gt.getInstance(),this._transformedPoints=[],this._sides=[],this._localSides=[],this._globalMatrix=Zt.identity(),this._transformedPointsDirty=!0,this._sidesDirty=!0,this._localSidesDirty=!0,this._localBoundsDirty=!0,this.offset=(i=t.offset)!==null&&i!==void 0?i:D.Zero,this._globalMatrix.translate(this.offset.x,this.offset.y),this.points=(r=t.points)!==null&&r!==void 0?r:[],this._isCounterClockwiseWinding(this.points)||this.points.reverse(),this.isConvex()||t.suppressConvexWarning||this._logger.warn("Excalibur only supports convex polygon colliders and will not behave properly.Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles"),this._calculateTransformation()}_isCounterClockwiseWinding(t){let i=0;for(let r=0;r<t.length;r++)i+=(t[(r+1)%t.length].x-t[r].x)*(t[(r+1)%t.length].y+t[r].y);return i<0}isConvex(){if(this.points.length<3)return!1;let t=this.points[this.points.length-2],i=this.points[this.points.length-1],r=Math.atan2(i.y-t.y,i.x-t.x),l=0,c=0,g=0;for(const[m,w]of this.points.entries()){if(t=i,l=r,i=w,r=Math.atan2(i.y-t.y,i.x-t.x),t.equals(i))return!1;let C=r-l;if(C<=-Math.PI?C+=Math.PI*2:C>Math.PI&&(C-=Math.PI*2),m===0){if(C===0)return!1;c=C>0?1:-1}else if(c*C<=0)return!1;g+=C}return Math.abs(Math.round(g/(Math.PI*2)))===1}tessellate(){const t=[];for(let i=1;i<this.points.length-2;i++)t.push([this.points[0],this.points[i+1],this.points[i+2]]);return t.push([this.points[0],this.points[1],this.points[2]]),new ei(t.map(i=>ii.Polygon(i)))}triangulate(){if(this.points.length<3)throw Error("Invalid polygon");const t=[],i=[...this.points].reverse();let r=i.length;function l(T){return T===0?r-1:T-1}function c(T){return T===r-1?0:T+1}function g(T){const M=l(T),z=c(T),W=i[M],Z=i[T],st=i[z],q=W.sub(Z),Q=st.sub(Z);return!(q.cross(Q)<0)}const m=i.map((T,M)=>g(M));function w(T,M,z,W){const Z=z.sub(M),st=W.sub(z),q=M.sub(W),Q=T.sub(M),ot=T.sub(z),et=T.sub(W),_t=Z.cross(Q),Nt=st.cross(ot),at=q.cross(et);return!(_t>0||Nt>0||at>0)}function C(){for(let T=0;T<r;T++)if(m[T]){const M=l(T),z=c(T),W=i[M],Z=i[T],st=i[z];let q=!0;for(let Q=0;Q<r;Q++){if(Q===T||Q===M||Q===z)continue;const ot=i[Q];if(w(ot,W,Z,st)){q=!1;break}}if(q)return T}for(let T=0;T<r;T++)if(m[T])return T;return 0}function A(T){const M=l(T),z=c(T),W=i[M],Z=i[T],st=i[z];t.push([W,Z,st]),i.splice(T,1),m.splice(T,1),r--}for(;r>3;){const T=C();A(T);for(let M=0;M<r;M++)m[M]=g(M)}return t.push([i[0],i[1],i[2]]),new ei(t.map(T=>ii.Polygon(T,D.Zero,!0)))}clone(){return new qe({offset:this.offset.clone(),points:this.points.map(t=>t.clone())})}get worldPos(){return this._transform?this._transform.pos.add(this.offset):this.offset}get center(){return this.bounds.center}_calculateTransformation(){const t=this.points,i=t.length;this._transformedPoints.length=0;for(let r=0;r<i;r++)this._transformedPoints[r]=this._globalMatrix.multiply(t[r].clone())}getTransformedPoints(){return this._transformedPointsDirty&&(this._calculateTransformation(),this._transformedPointsDirty=!1),this._transformedPoints}getSides(){if(this._sidesDirty){const t=[],i=this.getTransformedPoints(),r=i.length;for(let l=0;l<r;l++)t.push(new pi(i[l],i[(l+1)%r]));this._sides=t,this._sidesDirty=!1}return this._sides}getLocalSides(){if(this._localSidesDirty){const t=[],i=this.points,r=i.length;for(let l=0;l<r;l++)t.push(new pi(i[l],i[(l+1)%r]));this._localSides=t,this._localSidesDirty=!1}return this._localSides}findSide(t){const i=this.getSides();let r=i[0],l=-Number.MAX_VALUE;for(let c=0;c<i.length;c++){const g=i[c],w=g.normal().dot(t);w>l&&(r=g,l=w)}return r}findLocalSide(t){const i=this.getLocalSides();let r=i[0],l=-Number.MAX_VALUE;for(let c=0;c<i.length;c++){const g=i[c],w=g.normal().dot(t);w>l&&(r=g,l=w)}return r}get axes(){const t=[],i=this.getSides();for(let r=0;r<i.length;r++)t.push(i[r].normal());return t}update(t){var i;t&&(this._transform=t,this._transformedPointsDirty=!0,this._sidesDirty=!0,((i=t.matrix)!==null&&i!==void 0?i:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y))}contains(t){const i=new ds(t,new D(1,0));return this.getSides().reduce(function(l,c){return i.intersect(c)>=0?l+1:l},0)%2!==0}getClosestLineBetween(t){if(t instanceof Re)return rn.PolygonCircleClosestLine(this,t);if(t instanceof qe)return rn.PolygonPolygonClosestLine(this,t);if(t instanceof Ni)return rn.PolygonEdgeClosestLine(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof Re)return xn.CollideCirclePolygon(t,this);if(t instanceof qe)return xn.CollidePolygonPolygon(this,t);if(t instanceof Ni)return xn.CollidePolygonEdge(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){const i=this.getTransformedPoints();let r=null,l=-Number.MAX_VALUE;for(let c=0;c<i.length;c++){const g=t.dot(i[c]);g>l&&(l=g,r=i[c])}return r}getFurthestLocalPoint(t){const i=this.points;let r=i[0],l=-Number.MAX_VALUE;for(let c=0;c<i.length;c++){const g=t.dot(i[c]);g>l&&(l=g,r=i[c])}return r}getClosestFace(t){const i=this.getSides();let r=Number.POSITIVE_INFINITY,l=-1,c=-1;for(let g=0;g<i.length;g++){const m=i[g].distanceToPoint(t);m<r&&(r=m,l=g,c=m)}return l!==-1?{distance:i[l].normal().scale(c),face:i[l]}:null}get bounds(){return this.localBounds.transform(this._globalMatrix)}get localBounds(){return this._localBoundsDirty&&(this._localBounds=mt.fromPoints(this.points),this._localBoundsDirty=!1),this._localBounds}getInertia(t){if(this._cachedMass===t&&this._cachedInertia)return this._cachedInertia;let i=0,r=0;const l=this.points;for(let c=0;c<l.length;c++){const g=(c+1)%l.length,m=l[g].cross(l[c]);i+=m*(l[c].dot(l[c])+l[c].dot(l[g])+l[g].dot(l[g])),r+=m}return this._cachedMass=t,this._cachedInertia=t/6*(i/r)}rayCast(t,i=1/0){var r;const l=this.getSides(),c=l.length;let g=Number.MAX_VALUE,m,w=-1;for(let C=0;C<c;C++){const A=t.intersect(l[C]);A>=0&&A<g&&A<=i&&(g=A,m=l[C],w=C)}return w>=0?{collider:this,distance:g,body:(r=this.owner)===null||r===void 0?void 0:r.get(Lt),point:t.getPoint(g),normal:m.normal()}:null}project(t){const i=this.getTransformedPoints(),r=i.length;let l=Number.MAX_VALUE,c=-Number.MAX_VALUE;for(let g=0;g<r;g++){const m=i[g].dot(t);l=Math.min(l,m),c=Math.max(c,m)}return new rr(l,c)}debug(t,i,r){const l=this.getTransformedPoints();je.drawPolygon(l,{color:i})}}class ii{static Box(t,i,r=D.Half,l=D.Zero){return new qe({points:new mt(-t*r.x,-i*r.y,t-t*r.x,i-i*r.y).getPoints(),offset:l})}static Polygon(t,i=D.Zero,r=!1){return new qe({points:t,offset:i,suppressConvexWarning:r})}static Circle(t,i=D.Zero){return new Re({radius:t,offset:i})}static Edge(t,i){return new Ni({begin:t,end:i})}static Capsule(t,i,r=D.Zero){const l=gt.getInstance();return t===i&&l.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider"),i>=t?new ei([ii.Circle(t/2,j(0,-i/2+t/2).add(r)),ii.Box(t,i-t,D.Half,r),ii.Circle(t/2,j(0,i/2-t/2).add(r))]):new ei([ii.Circle(i/2,j(-t/2+i/2,0).add(r)),ii.Box(t-i,i,D.Half,r),ii.Circle(i/2,j(t/2-i/2,0).add(r))])}}class de extends Qe{constructor(t){super(),this.events=new b,this.$colliderAdded=new We,this.$colliderRemoved=new We,this._collidersToRemove=[],this.set(t)}get(){return this._collider}set(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,t.events.pipe(this.events),this.$colliderAdded.notifyAll(t),this.update()),t}clear(){this._collider&&(this._collidersToRemove.push(this._collider),this._collider=null)}processColliderRemoval(){for(const t of this._collidersToRemove)t.events.unpipe(this.events),this.$colliderRemoved.notifyAll(t),t.owner=null}clone(){return new de(this._collider.clone())}get bounds(){var t,i;return(i=(t=this._collider)===null||t===void 0?void 0:t.bounds)!==null&&i!==void 0?i:new mt}get localBounds(){var t,i;return(i=(t=this._collider)===null||t===void 0?void 0:t.localBounds)!==null&&i!==void 0?i:new mt}update(){var t;const i=(t=this.owner)===null||t===void 0?void 0:t.get(yt);this._collider&&(this._collider.owner=this.owner,i&&this._collider.update(i.get()))}collide(t){let i=this._collider,r=t._collider;if(!i||!r)return[];let l=!1;if(r instanceof ei&&(i=r,r=this._collider,l=!0),this._collider){const c=i.collide(r);return c?(l&&c.forEach(g=>{g.mtv=g.mtv.negate(),g.normal=g.normal.negate(),g.tangent=g.normal.perpendicular(),g.colliderA=this._collider,g.colliderB=t._collider}),c):[]}return[]}onAdd(t){this._collider&&this.update(),this.events.on("precollision",i=>{const r=i;t.events.emit("precollision",new Ls(r.target.owner,r.other.owner,r.side,r.intersection,r.contact)),t instanceof Ei&&t.onPreCollisionResolve(r.target,r.other,r.side,r.contact)}),this.events.on("postcollision",i=>{const r=i;t.events.emit("postcollision",new Ms(r.target.owner,r.other.owner,r.side,r.intersection,r.contact)),t instanceof Ei&&t.onPostCollisionResolve(r.target,r.other,r.side,r.contact)}),this.events.on("collisionstart",i=>{const r=i;t.events.emit("collisionstart",new Io(r.target.owner,r.other.owner,r.side,r.contact)),t instanceof Ei&&t.onCollisionStart(r.target,r.other,r.side,r.contact)}),this.events.on("collisionend",i=>{const r=i;t.events.emit("collisionend",new Do(r.target.owner,r.other.owner,r.side,r.lastContact)),t instanceof Ei&&t.onCollisionEnd(r.target,r.other,r.side,r.lastContact)})}onRemove(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}useBoxCollider(t,i,r=D.Half,l=D.Zero){const c=ii.Box(t,i,r,l);return this.set(c)}usePolygonCollider(t,i=D.Zero){const r=ii.Polygon(t,i);return this.set(r)}useCircleCollider(t,i=D.Zero){const r=ii.Circle(t,i);return this.set(r)}useEdgeCollider(t,i){const r=ii.Edge(t,i);return this.set(r)}useCompositeCollider(t){return this.set(new ei(t))}}var Si;(function(f){f.Rotation="rotation",f.X="x",f.Y="y"})(Si||(Si={}));class Lt extends Qe{constructor(t){var i,r,l;super(),this.dependencies=[yt,Bt],this.id=v("body",Lt._ID++),this.events=new b,this.oldTransform=new Ye,this.__oldTransformCaptured=!1,this.enableFixedUpdateInterpolate=!0,this.collisionType=Mt.PreventCollision,this.group=cs.All,this._sleeping=!1,this.bounciness=.2,this.friction=.99,this.useGravity=!0,this.limitDegreeOfFreedom=[],this.oldVel=new D(0,0),this.oldAcc=D.Zero,t?(this.collisionType=(i=t.type)!==null&&i!==void 0?i:this.collisionType,this.group=(r=t.group)!==null&&r!==void 0?r:this.group,this.useGravity=(l=t.useGravity)!==null&&l!==void 0?l:this.useGravity,this._bodyConfig={...sn.bodies,...t.config}):this._bodyConfig={...sn.bodies},this.updatePhysicsConfig(this._bodyConfig),this._mass=Lt._DEFAULT_CONFIG.defaultMass}get matrix(){return this.transform.get().matrix}updatePhysicsConfig(t){this._bodyConfig={...sn.bodies,...t},this.canSleep=this._bodyConfig.canSleepByDefault,this.sleepMotion=this._bodyConfig.sleepEpsilon*5,this.wakeThreshold=this._bodyConfig.wakeThreshold}static updateDefaultPhysicsConfig(t){Lt._DEFAULT_CONFIG=t}get mass(){return this._mass}set mass(t){this._mass=t,this._cachedInertia=void 0,this._cachedInverseInertia=void 0}get inverseMass(){return this.collisionType===Mt.Fixed?0:1/this.mass}get sleeping(){return this._sleeping}setSleeping(t){this._sleeping=t,t?(this.vel=D.Zero,this.acc=D.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=this._bodyConfig.sleepEpsilon*5}updateMotion(){this._sleeping&&this.setSleeping(!0);const t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),i=this._bodyConfig.sleepBias;this.sleepMotion=i*this.sleepMotion+(1-i)*t,this.sleepMotion=G(this.sleepMotion,0,10*this._bodyConfig.sleepEpsilon),this.canSleep&&this.sleepMotion<this._bodyConfig.sleepEpsilon&&this.setSleeping(!0)}get inertia(){if(this._cachedInertia)return this._cachedInertia;const t=this.owner.get(de);if(t){t.$colliderAdded.subscribe(()=>{this._cachedInertia=null}),t.$colliderRemoved.subscribe(()=>{this._cachedInertia=null});const i=t.get();if(i)return this._cachedInertia=i.getInertia(this.mass)}return 0}get inverseInertia(){return this._cachedInverseInertia?this._cachedInverseInertia:this._cachedInverseInertia=this.collisionType===Mt.Fixed?0:1/this.inertia}get active(){var t;return!!(!((t=this.owner)===null||t===void 0)&&t.active)}get center(){return this.globalPos}get transform(){var t;return(t=this.owner)===null||t===void 0?void 0:t.get(yt)}get motion(){var t;return(t=this.owner)===null||t===void 0?void 0:t.get(Bt)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t}get globalPos(){return this.transform.globalPos}set globalPos(t){this.transform.globalPos=t}get oldPos(){return this.oldTransform.pos}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t}get torque(){return this.motion.torque}set torque(t){this.motion.torque=t}get oldRotation(){return this.oldTransform.rotation}get rotation(){return this.transform.globalRotation}set rotation(t){this.transform.globalRotation=t}get scale(){return this.transform.globalScale}set scale(t){this.transform.globalScale=t}get oldScale(){return this.oldTransform.scale}get scaleFactor(){return this.motion.scaleFactor}set scaleFactor(t){this.motion.scaleFactor=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}applyImpulse(t,i){if(this.collisionType!==Mt.Active)return;const r=i.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(Si.X)&&(r.x=0),this.limitDegreeOfFreedom.includes(Si.Y)&&(r.y=0),this.vel.addEqual(r),!this.limitDegreeOfFreedom.includes(Si.Rotation)){const l=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*l.cross(i)}}applyLinearImpulse(t){if(this.collisionType!==Mt.Active)return;const i=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(Si.X)&&(i.x=0),this.limitDegreeOfFreedom.includes(Si.Y)&&(i.y=0),this.vel=this.vel.add(i)}applyAngularImpulse(t,i){if(this.collisionType===Mt.Active&&!this.limitDegreeOfFreedom.includes(Si.Rotation)){const r=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*r.cross(i)}}captureOldTransform(){this.__oldTransformCaptured=!0;const t=this.transform.get();t.clone(this.oldTransform),this.oldTransform.parent=t.parent,this.oldVel.setTo(this.vel.x,this.vel.y),this.oldAcc.setTo(this.acc.x,this.acc.y)}clone(){return super.clone()}}Lt._ID=0,Lt._DEFAULT_CONFIG={...sn.bodies};class Sh{constructor(t){this.data=t,this.type="Component Added"}}function lc(f){return!!f&&f.type==="Component Added"}class Us{constructor(t){this.data=t,this.type="Component Removed"}}function Qa(f){return!!f&&f.type==="Component Removed"}const qf={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate",Kill:"kill"};class ni{constructor(t,i){this.id=ni._ID++,this.name=`Entity#${this.id}`,this.events=new b,this._tags=new Set,this.componentAdded$=new We,this.componentRemoved$=new We,this.tagAdded$=new We,this.tagRemoved$=new We,this.components=new Map,this._componentsToRemove=[],this._instanceOfComponentCacheDirty=!0,this._instanceOfComponentCache=new Map,this.scene=null,this.active=!0,this._parent=null,this.childrenAdded$=new We,this.childrenRemoved$=new We,this._children=[],this._isInitialized=!1;let r,l;if(Array.isArray(t))r=t,l=i;else if(t&&typeof t=="object"){const{components:c,name:g}=t;r=c??[],l=g}if(l&&(this.name=l),r)for(const c of r)this.addComponent(c)}kill(){this.active&&(this.active=!1,this.unparent()),this.emit("kill",new So(this))}isKilled(){return!this.active}get tags(){return this._tags}hasTag(t){return this._tags.has(t)}addTag(t){return this._tags.add(t),this.tagAdded$.notifyAll(t),this}removeTag(t){return this._tags.delete(t),this.tagRemoved$.notifyAll(t),this}get types(){return Array.from(this.components.keys())}getComponents(){return Array.from(this.components.values())}hasAll(t){for(let i=0;i<t.length;i++)if(!this.components.has(t[i]))return!1;return!0}hasAllTags(t){for(let i=0;i<t.length;i++)if(!this.tags.has(t[i]))return!1;return!0}_getCachedInstanceOfType(t){if(this._instanceOfComponentCacheDirty&&(this._instanceOfComponentCacheDirty=!1,this._instanceOfComponentCache.clear()),this._instanceOfComponentCache.has(t))return this._instanceOfComponentCache.get(t);for(const i of this.components.values())if(i instanceof t)return this._instanceOfComponentCache.set(t,i),i}get(t){const i=this._getCachedInstanceOfType(t);return i??this.components.get(t)}get parent(){return this._parent}get children(){return this._children}unparent(){this._parent&&(this._parent.removeChild(this),this._parent=null)}addChild(t){if(t.parent===null){if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t)}else throw new Error("Entity already has a parent, cannot add without unparenting");return this}removeChild(t){return t.parent===this&&(Tt(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}removeAllChildren(){for(let t=this.children.length-1;t>=0;t--)this.removeChild(this.children[t]);return this}getAncestors(){const t=[this];let i=this.parent;for(;i;)t.push(i),i=i.parent;return t.reverse()}getDescendants(){let t=[this],i=[this];for(;i.length>0;){const r=i.pop();r&&(i=i.concat(r.children),t=t.concat(r.children))}return t}clone(){const t=new ni;for(const i of this.types){const r=this.get(i);r&&t.addComponent(r.clone())}for(const i of this.children)t.addChild(i.clone());return t}addTemplate(t,i=!1){for(const r of t.getComponents())this.addComponent(r.clone(),i);for(const r of t.children)this.addChild(r.clone().addTemplate(r));return this}addComponent(t,i=!1){if(this._instanceOfComponentCacheDirty=!0,this.has(t.constructor))if(i)this.removeComponent(t.constructor,!0);else return this;if(t.dependencies&&t.dependencies.length)for(const r of t.dependencies)this.addComponent(new r);return t.owner=this,this.components.set(t.constructor,t),t.onAdd&&t.onAdd(this),this.componentAdded$.notifyAll(t),this}removeComponent(t,i=!1){let r;if(rc(t)?r=t:r=t.constructor,i){const l=this.components.get(r);l&&(this.componentRemoved$.notifyAll(l),l.owner=void 0,l.onRemove&&l.onRemove(this)),this.components.delete(r),this._instanceOfComponentCacheDirty=!0}else this._componentsToRemove.push(r);return this}clearComponents(){const t=this.types;for(const i of t)this.removeComponent(i)}processComponentRemoval(){for(const t of this._componentsToRemove)this.removeComponent(t,!0);this._componentsToRemove.length=0}has(t){return this.components.has(t)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.onInitialize(t),this.events.emit("initialize",new Br(t,this)),this._isInitialized=!0)}_preupdate(t,i){this.events.emit("preupdate",new Bs(t,i,this)),this.onPreUpdate(t,i)}_postupdate(t,i){this.events.emit("postupdate",new us(t,i,this)),this.onPostUpdate(t,i)}onInitialize(t){}onPreUpdate(t,i){}onPostUpdate(t,i){}update(t,i){this._initialize(t),this._preupdate(t,i);for(const r of this.children)r.update(t,i);this._postupdate(t,i)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){i?this.events.off(t,i):this.events.off(t)}}ni._ID=0;var Oo;(function(f){f.Forward="forward",f.Backward="backward"})(Oo||(Oo={}));var _i;(function(f){f.End="end",f.Loop="loop",f.PingPong="pingpong",f.Freeze="freeze"})(_i||(_i={}));const bn={Frame:"frame",Loop:"loop",End:"end"};class Cn extends oe{constructor(t){var i,r,l;super(t),this.events=new b,this.frames=[],this.strategy=_i.Loop,this.frameDuration=100,this._idempotencyToken=-1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=0,this._pingPongDirection=1,this._done=!1,this._playing=!0,this._speed=1,this._reversed=!1,this.frames=t.frames,this.speed=(i=t.speed)!==null&&i!==void 0?i:this.speed,this.strategy=(r=t.strategy)!==null&&r!==void 0?r:this.strategy,this.frameDuration=t.totalDuration?t.totalDuration/this.frames.length:(l=t.frameDuration)!==null&&l!==void 0?l:this.frameDuration,t.reverse&&this.reverse(),this.goToFrame(0)}clone(){return new Cn({frames:this.frames.map(t=>({...t})),frameDuration:this.frameDuration,speed:this.speed,reverse:this._reversed,strategy:this.strategy,...this.cloneGraphicOptions()})}get width(){const t=this.currentFrame;return t?Math.abs(t.graphic.width*this.scale.x):0}get height(){const t=this.currentFrame;return t?Math.abs(t.graphic.height*this.scale.y):0}static fromSpriteSheet(t,i,r,l=_i.Loop){const c=t.sprites.length-1,g=i.filter(m=>m<0||m>c);return g.length&&Cn._LOGGER.warn(`Indices into SpriteSheet were provided that don't exist: ${g.join(",")} no frame will be shown`),new Cn({frames:t.sprites.filter((m,w)=>i.indexOf(w)>-1).map(m=>({graphic:m,duration:r})),strategy:l})}static fromSpriteSheetCoordinates(t){const{spriteSheet:i,frameCoordinates:r,durationPerFrameMs:l,speed:c,strategy:g,reverse:m}=t,w=l??100,C=[];for(const A of r){const{x:T,y:M,duration:z,options:W}=A,Z=i.getSprite(T,M,W);Z?C.push({graphic:Z,duration:z??w}):Cn._LOGGER.warn(`Skipping frame! SpriteSheet does not have coordinate (${T}, ${M}), please check your SpriteSheet to confirm that sprite exists`)}return new Cn({frames:C,strategy:g,speed:c,reverse:m})}get speed(){return this._speed}set speed(t){this._speed=G(Math.abs(t),0,1/0)}get currentFrame(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}get currentFrameIndex(){return this._currentFrame}get currentFrameTimeLeft(){return this._timeLeftInFrame}get isPlaying(){return this._playing}reverse(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}get direction(){return!!(this._reversed&&this._pingPongDirection===1)?Oo.Backward:Oo.Forward}play(){this._playing=!0}pause(){this._playing=!1,this._firstTick=!0}reset(){this._done=!1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=this.frameDuration;const t=this.frames[this._currentFrame];t&&(this._timeLeftInFrame=(t==null?void 0:t.duration)||this.frameDuration)}get canFinish(){switch(this.strategy){case _i.End:case _i.Freeze:return!0;default:return!1}}get done(){return this._done}goToFrame(t,i){this._currentFrame=t,this._timeLeftInFrame=i??this.frameDuration;const r=this.frames[this._currentFrame];r&&!this._done&&(this._timeLeftInFrame=i??((r==null?void 0:r.duration)||this.frameDuration),this.events.emit("frame",{...r,frameIndex:this.currentFrameIndex}))}_nextFrame(){const t=this._currentFrame;if(this._done)return t;let i=-1;switch(this.strategy){case _i.Loop:{i=(t+1)%this.frames.length,i===0&&this.events.emit("loop",this);break}case _i.End:{i=t+1,i>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break}case _i.Freeze:{i=G(t+1,0,this.frames.length-1),i>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break}case _i.PingPong:{t+this._pingPongDirection>=this.frames.length&&(this._pingPongDirection=-1,this.events.emit("loop",this)),t+this._pingPongDirection<0&&(this._pingPongDirection=1,this.events.emit("loop",this)),i=t+this._pingPongDirection%this.frames.length;break}}return i}tick(t,i=0){this._idempotencyToken!==i&&(this._idempotencyToken=i,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",{...this.currentFrame,frameIndex:this.currentFrameIndex})),this._timeLeftInFrame-=t*this._speed,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame())))}_drawImage(t,i,r){this.currentFrame&&this.currentFrame.graphic.draw(t,i,r)}}Cn._LOGGER=gt.getInstance();class kr extends oe{constructor(t){var i;super(t),this._logger=gt.getInstance(),this.useAnchor=!0,this.members=[],this.members=t.members,this.useAnchor=(i=t.useAnchor)!==null&&i!==void 0?i:this.useAnchor,this._updateDimensions()}clone(){return new kr({members:[...this.members],...this.cloneGraphicOptions()})}_updateDimensions(){const t=this.localBounds;return this.width=t.width,this.height=t.height,t}get localBounds(){let t=new mt;for(const i of this.members)if(i instanceof oe)t=i.localBounds.combine(t);else{const{graphic:r,offset:l,useBounds:c}=i;r?(c===void 0?!0:c)&&(t=r.localBounds.translate(l).combine(t)):this._logger.warnOnce(`Graphics group member has an null or undefined graphic, member definition: ${JSON.stringify(i)}.`)}return t}_isAnimationOrGroup(t){return t instanceof Cn||t instanceof kr}tick(t,i){for(const r of this.members){let l;r instanceof oe?l=r:l=r.graphic,this._isAnimationOrGroup(l)&&l.tick(t,i)}}reset(){for(const t of this.members){let i;t instanceof oe?i=t:i=t.graphic,this._isAnimationOrGroup(i)&&i.reset()}}_preDraw(t,i,r){this._updateDimensions(),super._preDraw(t,this.useAnchor?i:0,this.useAnchor?r:0)}_drawImage(t,i,r){const l=D.Zero;for(const c of this.members){let g;c instanceof oe?g=c:(g=c.graphic,c.offset.clone(l)),g&&(t.save(),t.translate(i,r),g.draw(t,l.x,l.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore())}}}function Ah(f){return!!f.tick}class Ge extends Qe{get offset(){return new Va(this._offset,()=>{this.recalculateBounds()})}set offset(t){this._offset=t,this.recalculateBounds()}get anchor(){return new Va(this._anchor,()=>{this.recalculateBounds()})}set anchor(t){this._anchor=t,this.recalculateBounds()}constructor(t){super(),this._logger=gt.getInstance(),this._current="default",this._graphics={},this._options={},this.material=null,this.visible=!0,this.opacity=1,this._offset=D.Zero,this._anchor=D.Half,this.flipHorizontal=!1,this.flipVertical=!1,this.copyGraphics=!1,this._localBounds=null,t={visible:this.visible,graphics:{},...t};const{current:i,anchor:r,opacity:l,visible:c,graphics:g,offset:m,copyGraphics:w,onPreDraw:C,onPostDraw:A,onPreTransformDraw:T,onPostTransformDraw:M}=t;for(const[z,W]of Object.entries(g))W instanceof oe?this._graphics[z]=W:(this._graphics[z]=W.graphic,this._options[z]=W.options);this.offset=m??this.offset,this.opacity=l??this.opacity,this.anchor=r??this.anchor,this.copyGraphics=w??this.copyGraphics,this.onPreDraw=C??this.onPreDraw,this.onPostDraw=A??this.onPostDraw,this.onPreDraw=T??this.onPreTransformDraw,this.onPostTransformDraw=M??this.onPostTransformDraw,this.visible=!!c,this._current=i??this._current,i&&this._graphics[i]&&this.use(i)}getGraphic(t){return this._graphics[t]}getOptions(t){return this._options[t]}getNames(){return Object.keys(this._graphics)}get current(){return this._graphics[this._current]}get currentOptions(){return this._options[this._current]}get graphics(){return this._graphics}get options(){return this._options}add(t,i,r){let l="default",c=null,g;return typeof t=="string"&&i instanceof oe&&(l=t,c=i,g=r),t instanceof oe&&!(i instanceof oe)&&(c=t,g=i),this._graphics[l]=this.copyGraphics?c.clone():c,this._options[l]=this.copyGraphics?{...g}:g,l==="default"&&this.use("default"),c}remove(t){delete this._graphics[t],delete this._options[t],this._current===t&&(this._current="default",this.recalculateBounds())}show(t,i){return this.use(t,i)}use(t,i){var r;if(t instanceof oe){let l=t;this.copyGraphics&&(l=t.clone()),this._current="default",this._graphics[this._current]=l,this._options[this._current]=i}else this._current=t,this._options[this._current]=i,this._current in this._graphics||this._logger.warn(`Graphic ${this._current} is not registered with the graphics component owned by ${(r=this.owner)===null||r===void 0?void 0:r.name}. Nothing will be drawn.`);return this.recalculateBounds(),this.current}hide(){this._current="ex.none"}set localBounds(t){this._localBounds=t}recalculateBounds(){let t=new mt;const i=this._graphics[this._current],r=this._options[this._current];if(!i){this._localBounds=t;return}let l=this.anchor,c=this.offset;r!=null&&r.anchor&&(l=r.anchor),r!=null&&r.offset&&(c=r.offset);const g=i.localBounds,m=-g.width*l.x+c.x,w=-g.height*l.y+c.y;i instanceof kr&&!i.useAnchor?t=i==null?void 0:i.localBounds.combine(t):t=i==null?void 0:i.localBounds.translate(j(m,w)).combine(t),this._localBounds=t}get localBounds(){return(!this._localBounds||this._localBounds.hasZeroDimensions())&&this.recalculateBounds(),this._localBounds}get bounds(){let t=this.localBounds;if(this.owner){const i=this.owner.get(yt);i&&(t=t.transform(i.get().matrix))}return t}update(t,i=0){const r=this.current;r&&Ah(r)&&r.tick(t,i)}clone(){const t=new Ge;return t._graphics={...this._graphics},t._options={...this._options},t.offset=this.offset.clone(),t.opacity=this.opacity,t.anchor=this.anchor.clone(),t.copyGraphics=this.copyGraphics,t.onPreDraw=this.onPreDraw,t.onPostDraw=this.onPostDraw,t.visible=this.visible,t}}class No extends er{constructor(t){super(t),this.width=t.width,this.height=t.height,this.rasterize()}clone(){return new No({width:this.width,height:this.height,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}class qa extends er{get radius(){return this._radius}set radius(t){this._radius=t,this.width=this._radius*2,this.height=this._radius*2,this.flagDirty()}constructor(t){var i,r,l;super(t),this._radius=0;const c=(i=t.lineWidth)!==null&&i!==void 0?i:t.strokeColor?1:0;this.padding=(r=t.padding)!==null&&r!==void 0?r:2+c/2,this.radius=t.radius,this.filtering=(l=t.filtering)!==null&&l!==void 0?l:ae.Blended,this.rasterize()}clone(){return new qa({radius:this.radius,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,Math.PI*2),this.color&&t.fill(),this.strokeColor&&t.stroke())}}class Ai extends Qe{constructor(t){var i,r;super(),this.useColliderShape=!0,this.useGraphicsBounds=!0,this.useColliderShape=(i=t==null?void 0:t.useColliderShape)!==null&&i!==void 0?i:this.useColliderShape,this.useGraphicsBounds=(r=t==null?void 0:t.useGraphicsBounds)!==null&&r!==void 0?r:this.useGraphicsBounds,this.localBounds=t==null?void 0:t.localBounds}}class V{static CreateReversibleEasingFunction(t){return(i,r,l,c)=>l<r?r-(t(i,l,r,c)-l):t(i,r,l,c)}static CreateVectorEasingFunction(t){return(i,r,l,c)=>new D(t(i,r.x,l.x,c),t(i,r.y,l.y,c))}}V.Linear=V.CreateReversibleEasingFunction((f,t,i,r)=>(i=i-t,i*f/r+t)),V.EaseInQuad=V.CreateReversibleEasingFunction((f,t,i,r)=>(i=i-t,f/=r,i*f*f+t)),V.EaseOutQuad=V.CreateReversibleEasingFunction((f,t,i,r)=>(i=i-t,f/=r,-i*f*(f-2)+t)),V.EaseInOutQuad=V.CreateReversibleEasingFunction((f,t,i,r)=>(i=i-t,f/=r/2,f<1?i/2*f*f+t:(f--,-i/2*(f*(f-2)-1)+t))),V.EaseInCubic=V.CreateReversibleEasingFunction((f,t,i,r)=>(i=i-t,f/=r,i*f*f*f+t)),V.EaseOutCubic=V.CreateReversibleEasingFunction((f,t,i,r)=>(i=i-t,f/=r,f--,i*(f*f*f+1)+t)),V.EaseInOutCubic=V.CreateReversibleEasingFunction((f,t,i,r)=>(i=i-t,f/=r/2,f<1?i/2*f*f*f+t:(f-=2,i/2*(f*f*f+2)+t)));class rt{constructor(t){this._actions=[],this._currentAction=null,this._completedActions=[],this._entity=t}add(t){this._actions.push(t)}remove(t){const i=this._actions.indexOf(t);this._actions.splice(i,1)}clearActions(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}getActions(){return this._actions.concat(this._completedActions)}hasNext(){return this._actions.length>0}isComplete(){return this._actions.length===0}reset(){this._actions=this.getActions();const t=this._actions.length;for(let i=0;i<t;i++)this._actions[i].reset();this._completedActions=[]}update(t){if(this._actions.length>0&&(this._currentAction!==this._actions[0]&&(this._currentAction=this._actions[0],this._entity.emit("actionstart",new _h(this._currentAction,this._entity))),this._currentAction.update(t),this._currentAction.isComplete(this._entity))){this._entity.emit("actioncomplete",new ce(this._currentAction,this._entity));const i=this._actions.shift();i&&this._completedActions.push(i)}}}class tt{constructor(t,i,r){this._stopped=!1,this._repeatBuilder=i,this._repeatContext=new Wo(t),this._actionQueue=this._repeatContext.getQueue(),this._repeat=r,this._originalRepeat=r,this._repeatBuilder(this._repeatContext),this._repeat--}update(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}isComplete(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._repeat=this._originalRepeat}}class xt{constructor(t,i){this._stopped=!1,this._repeatBuilder=i,this._repeatContext=new Wo(t),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}update(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}isComplete(){return this._stopped}stop(){this._stopped=!0,this._actionQueue.clearActions()}reset(){}}class Ot{constructor(t,i,r,l){if(this._started=!1,this._stopped=!1,this._entity=t,this._tx=t.get(yt),this._motion=t.get(Bt),this._speed=l,this._offset=new D(i,r),l<=0)throw gt.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+l),new Error("Speed must be greater than 0 pixels per second")}update(t){this._started||(this._started=!0,this._start=new D(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=j(this._end.x,this._end.y),this._motion.vel=j(0,0)):this._motion.vel=this._dir.scale(this._speed)}isComplete(t){const i=t.get(yt);return this._stopped||i.pos.distance(this._start)>=this._distance}stop(){this._motion.vel=j(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Jt{constructor(t,i,r,l){this.entity=t,this._started=!1,this._stopped=!1,this._tx=t.get(yt),this._motion=t.get(Bt),this._end=new D(i,r),this._speed=l}update(t){this._started||(this._started=!0,this._start=new D(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());const i=this._dir.scale(this._speed);this._motion.vel=j(i.x,i.y),this.isComplete(this.entity)&&(this._tx.pos=j(this._end.x,this._end.y),this._motion.vel=j(0,0))}isComplete(t){const i=t.get(yt);return this._stopped||new D(i.pos.x,i.pos.y).distance(this._start)>=this._distance}stop(){this._motion.vel=j(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}var te;(function(f){f[f.ShortestPath=0]="ShortestPath",f[f.LongestPath=1]="LongestPath",f[f.Clockwise=2]="Clockwise",f[f.CounterClockwise=3]="CounterClockwise"})(te||(te={}));class he{constructor(t,i,r,l){this._started=!1,this._stopped=!1,this._tx=t.get(yt),this._motion=t.get(Bt),this._end=i,this._speed=r,this._rotationType=l||te.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;const i=Math.abs(this._end-this._start),r=U-i;switch(i>r?(this._shortDistance=r,this._longDistance=i):(this._shortDistance=i,this._longDistance=r),this._shortestPathIsPositive=(this._start-this._end+U)%U>=Math.PI,this._rotationType){case te.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case te.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case te.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case te.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance;break}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Za{constructor(t,i,r,l){this._started=!1,this._stopped=!1,this._tx=t.get(yt),this._motion=t.get(Bt),this._speed=r,this._offset=i,this._rotationType=l||te.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;const i=Math.abs(this._end-this._start),r=U-i;switch(i>r?(this._shortDistance=r,this._longDistance=i):(this._shortDistance=i,this._longDistance=r),this._shortestPathIsPositive=(this._start-this._end+U)%U>=Math.PI,this._rotationType){case te.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case te.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case te.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case te.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance;break}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._start=void 0,this._currentNonCannonAngle=void 0,this._distance=void 0}}class hc{constructor(t,i,r,l,c){this._started=!1,this._stopped=!1,this._tx=t.get(yt),this._motion=t.get(Bt),this._endX=i,this._endY=r,this._speedX=l,this._speedY=c}update(t){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{const i=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*i}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{const i=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*i}this.isComplete()&&(this._tx.scale=j(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startX)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Yi{constructor(t,i,r,l){this._started=!1,this._stopped=!1,this._tx=t.get(yt),this._motion=t.get(Bt),this._offset=new D(i,r),this._speedX=this._speedY=l}update(t){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Uo{constructor(t){this._method=null,this._hasBeenCalled=!1,this._method=t}update(t){this._method(),this._hasBeenCalled=!0}isComplete(){return this._hasBeenCalled}reset(){this._hasBeenCalled=!1}stop(){this._hasBeenCalled=!0}}class uc{constructor(t,i,r,l,c){this.easingFcn=c,this._currentLerpTime=0,this._lerpDuration=1*1e3,this._lerpStart=new D(0,0),this._lerpEnd=new D(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(yt),this._motion=t.get(Bt),this._lerpDuration=l,this._lerpEnd=new D(i,r)}_initialize(){this._lerpStart=new D(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let i=this._tx.pos.x,r=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(this._lerpEnd.x<this._lerpStart.x?i=this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):i=this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),this._lerpEnd.y<this._lerpStart.y?r=this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):r=this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=j((i-this._tx.pos.x)/(t/1e3),(r-this._tx.pos.y)/(t/1e3))):(this._tx.pos=j(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=D.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=j(0,0),this._stopped=!0}}class or{constructor(t,i,r,l,c){this.easingFcn=c,this._currentLerpTime=0,this._lerpDuration=1*1e3,this._lerpStart=new D(0,0),this._lerpEnd=new D(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(yt),this._motion=t.get(Bt),this._lerpDuration=l,this._offset=new D(i,r)}_initialize(){this._lerpStart=new D(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._lerpEnd=this._lerpStart.add(this._offset)}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let i=this._tx.pos.x,r=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(this._lerpEnd.x<this._lerpStart.x?i=this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):i=this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),this._lerpEnd.y<this._lerpStart.y?r=this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):r=this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=j((i-this._tx.pos.x)/(t/1e3),(r-this._tx.pos.y)/(t/1e3))):(this._tx.pos=j(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=D.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=j(0,0),this._stopped=!0}}class zo{constructor(t,i,r,l=1){this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=t.get(Ge),this._timeVisible=i,this._timeNotVisible=r,this._duration=(i+r)*l}update(t){this._started||(this._started=!0,this._elapsedTime=0,this._totalTime=0),this._graphics&&(this._elapsedTime+=t,this._totalTime+=t,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}isComplete(){return this._stopped||this._totalTime>=this._duration}stop(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._elapsedTime=0,this._totalTime=0}}class Ho{constructor(t,i,r){this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=t.get(Ge),this._endOpacity=i,this._speed=this._ogspeed=r}update(t){this._graphics&&(this._started||(this._started=!0,this._speed=this._ogspeed,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._graphics.opacity=this._endOpacity),gt.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}isComplete(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}stop(){this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class se{constructor(t){this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=t}update(t){this._started||(this._started=!0),this._elapsedTime+=t}isComplete(){return this._stopped||this._elapsedTime>=this._delay}stop(){this._stopped=!0}reset(){this._elapsedTime=0,this._started=!1,this._stopped=!1}}class cc{constructor(t){this._stopped=!1,this._entity=t}update(t){this._entity.get(Mr).clearActions(),this._entity.kill(),this._stopped=!0}isComplete(){return this._stopped}stop(){}reset(){}}class Ka{constructor(t,i,r){this._started=!1,this._stopped=!1,this._tx=t.get(yt),this._motion=t.get(Bt),this._followTx=i.get(yt),this._followMotion=i.get(Bt),this._current=new D(this._tx.pos.x,this._tx.pos.y),this._end=new D(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=r!==void 0?r:this._current.distance(this._end),this._speed=0}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const i=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(i!==0&&(this._speed=i),this._current=j(this._tx.pos.x,this._tx.pos.y),this._end=j(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){const r=this._dir.scale(this._speed);this._motion.vel=j(r.x,r.y)}else this._motion.vel=j(0,0);this.isComplete()&&(this._tx.pos=j(this._end.x,this._end.y),this._motion.vel=j(0,0))}stop(){this._motion.vel=j(0,0),this._stopped=!0}isComplete(){return this._stopped}reset(){this._started=!1,this._stopped=!1}}class Lr{constructor(t,i,r){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=t.get(yt),this._motion=t.get(Bt),this._meetTx=i.get(yt),this._meetMotion=i.get(Bt),this._current=new D(this._tx.pos.x,this._tx.pos.y),this._end=new D(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=r||0,r!==void 0&&(this._speedWasSpecified=!0)}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const i=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));i!==0&&!this._speedWasSpecified&&(this._speed=i),this._current=j(this._tx.pos.x,this._tx.pos.y),this._end=j(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();const r=this._dir.scale(this._speed);this._motion.vel=j(r.x,r.y),this.isComplete()&&(this._tx.pos=j(this._end.x,this._end.y),this._motion.vel=j(0,0))}isComplete(){return this._stopped||this._distanceBetween<=1}stop(){this._motion.vel=j(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._distanceBetween=void 0}}class Wo{constructor(t){this._entity=t,this._queue=new rt(t)}getQueue(){return this._queue}update(t){this._queue.update(t)}clearActions(){this._queue.clearActions()}runAction(t){return t.reset(),this._queue.add(t),this}easeTo(...t){var i,r;let l=0,c=0,g=0,m=V.Linear;return t[0]instanceof D?(l=t[0].x,c=t[0].y,g=t[1],m=(i=t[2])!==null&&i!==void 0?i:m):(l=t[0],c=t[1],g=t[2],m=(r=t[3])!==null&&r!==void 0?r:m),this._queue.add(new uc(this._entity,l,c,g,m)),this}easeBy(...t){var i,r;let l=0,c=0,g=0,m=V.Linear;return t[0]instanceof D?(l=t[0].x,c=t[0].y,g=t[1],m=(i=t[2])!==null&&i!==void 0?i:m):(l=t[0],c=t[1],g=t[2],m=(r=t[3])!==null&&r!==void 0?r:m),this._queue.add(new or(this._entity,l,c,g,m)),this}moveTo(t,i,r){let l=0,c=0,g=0;return t instanceof D?(l=t.x,c=t.y,g=i):(l=t,c=i,g=r),this._queue.add(new Jt(this._entity,l,c,g)),this}moveBy(t,i,r){let l=0,c=0,g=0;return t instanceof D?(l=t.x,c=t.y,g=i):(l=t,c=i,g=r),this._queue.add(new Ot(this._entity,l,c,g)),this}rotateTo(t,i,r){return this._queue.add(new he(this._entity,t,i,r)),this}rotateBy(t,i,r){return this._queue.add(new Za(this._entity,t,i,r)),this}scaleTo(t,i,r,l){let c=1,g=1,m=0,w=0;return t instanceof D&&i instanceof D&&(c=t.x,g=t.y,m=i.x,w=i.y),typeof t=="number"&&typeof i=="number"&&(c=t,g=i,m=r,w=l),this._queue.add(new hc(this._entity,c,g,m,w)),this}scaleBy(t,i,r){let l=1,c=1;return t instanceof D&&(l=t.x,c=t.y,r=i),typeof t=="number"&&typeof i=="number"&&(l=t,c=i),this._queue.add(new Yi(this._entity,l,c,r)),this}blink(t,i,r=1){return this._queue.add(new zo(this._entity,t,i,r)),this}fade(t,i){return this._queue.add(new Ho(this._entity,t,i)),this}delay(t){return this._queue.add(new se(t)),this}die(){return this._queue.add(new cc(this._entity)),this}callMethod(t){return this._queue.add(new Uo(t)),this}repeat(t,i){return i?(this._queue.add(new tt(this._entity,t,i)),this):(this.repeatForever(t),this)}repeatForever(t){return this._queue.add(new xt(this._entity,t)),this}follow(t,i){return i===void 0?this._queue.add(new Ka(this._entity,t)):this._queue.add(new Ka(this._entity,t,i)),this}meet(t,i){return i===void 0?this._queue.add(new Lr(this._entity,t)):this._queue.add(new Lr(this._entity,t,i)),this}toPromise(){return new Promise(i=>{this._queue.add(new Uo(()=>{i()}))})}}class Mr extends Qe{constructor(){super(...arguments),this.dependencies=[yt,Bt],this._ctx=null}onAdd(t){this._ctx=new Wo(t)}onRemove(){this._ctx=null}_getCtx(){if(!this._ctx)throw new Error("Actions component not attached to an entity, no context available");return this._ctx}getQueue(){if(!this._ctx)throw new Error("Actions component not attached to an entity, no queue available");return this._ctx.getQueue()}runAction(t){if(!this._ctx)throw new Error("Actions component not attached to an entity, cannot run action");return this._ctx.runAction(t)}update(t){var i;return(i=this._ctx)===null||i===void 0?void 0:i.update(t)}clearActions(){var t;(t=this._ctx)===null||t===void 0||t.clearActions()}easeTo(...t){return this._getCtx().easeTo.apply(this._ctx,t)}easeBy(...t){return this._getCtx().easeBy.apply(this._ctx,t)}moveTo(t,i,r){return this._getCtx().moveTo.apply(this._ctx,[t,i,r])}moveBy(t,i,r){return this._getCtx().moveBy.apply(this._ctx,[t,i,r])}rotateTo(t,i,r){return this._getCtx().rotateTo(t,i,r)}rotateBy(t,i,r){return this._getCtx().rotateBy(t,i,r)}scaleTo(t,i,r,l){return this._getCtx().scaleTo.apply(this._ctx,[t,i,r,l])}scaleBy(t,i,r){return this._getCtx().scaleBy.apply(this._ctx,[t,i,r])}blink(t,i,r){return this._getCtx().blink(t,i,r)}fade(t,i){return this._getCtx().fade(t,i)}delay(t){return this._getCtx().delay(t)}die(){return this._getCtx().die()}callMethod(t){return this._getCtx().callMethod(t)}repeat(t,i){return this._getCtx().repeat(t,i)}repeatForever(t){return this._getCtx().repeatForever(t)}follow(t,i){return this._getCtx().follow(t,i)}meet(t,i){return this._getCtx().meet(t,i)}toPromise(){return this._getCtx().toPromise()}}var Ja;(function(f){f.Em="em",f.Rem="rem",f.Px="px",f.Pt="pt",f.Percent="%"})(Ja||(Ja={}));var ar;(function(f){f.Left="left",f.Right="right",f.Center="center",f.Start="start",f.End="end"})(ar||(ar={}));var Sn;(function(f){f.Top="top",f.Hanging="hanging",f.Middle="middle",f.Alphabetic="alphabetic",f.Ideographic="ideographic",f.Bottom="bottom"})(Sn||(Sn={}));var lr;(function(f){f.Normal="normal",f.Italic="italic",f.Oblique="oblique"})(lr||(lr={}));var jo;(function(f){f.LeftToRight="ltr",f.RightToLeft="rtl"})(jo||(jo={}));class ps{constructor(t,i,r,l){this.font=t,this.text=i,this.color=r,this.maxWidth=l,this._textFragments=[],this.disposed=!1,this._dirty=!0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.dimensions=this.measureText(i),this._setDimension(this.dimensions,this.ctx),this._lastHashCode=this.getHashCode()}measureText(t,i){if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);let r=null;i!=null?r=this._getLinesFromText(t,i):r=t.split(`
`);const l=r.reduce((M,z)=>M.length>z.length?M:z);this._applyFont(this.ctx);const c=this.ctx.measureText(l);let g=Math.abs(c.actualBoundingBoxAscent)+Math.abs(c.actualBoundingBoxDescent);const m=g*r.length;g=m;const w=m-Math.abs(c.actualBoundingBoxAscent),C=0,A=0;return new mt({left:C-Math.abs(c.actualBoundingBoxLeft)-this.font.padding,top:A-Math.abs(c.actualBoundingBoxAscent)-this.font.padding,bottom:A+w+this.font.padding,right:C+Math.abs(c.actualBoundingBoxRight)+this.font.padding})}_setDimension(t,i){let r=1;this.font.lineHeight&&(r=this.font.lineHeight/this.font.size),i.canvas.width=(t.width+this.font.padding*2)*2*this.font.quality,i.canvas.height=(t.height+this.font.padding*2)*2*this.font.quality*r}static getHashCode(t,i,r){var l;return i+"__hashcode__"+t.fontString+t.showDebug+t.textAlign+t.baseAlign+t.direction+t.lineHeight+JSON.stringify(t.shadow)+(t.padding.toString()+t.smoothing.toString()+t.lineWidth.toString()+t.lineDash.toString()+((l=t.strokeColor)===null||l===void 0?void 0:l.toString())+(r?r.toString():t.color.toString()))}getHashCode(t=!0){return ps.getHashCode(this.font,this.text,t?this.color:void 0)}_applyRasterProperties(t){var i,r;t.translate(this.font.padding,this.font.padding),t.imageSmoothingEnabled=this.font.smoothing,t.lineWidth=this.font.lineWidth,t.setLineDash((i=this.font.lineDash)!==null&&i!==void 0?i:t.getLineDash()),t.strokeStyle=(r=this.font.strokeColor)===null||r===void 0?void 0:r.toString(),t.fillStyle=this.color.toString()}_applyFont(t){t.resetTransform(),t.translate(this.font.padding+t.canvas.width/2,this.font.padding+t.canvas.height/2),t.scale(this.font.quality,this.font.quality),t.textAlign=this.font.textAlign,t.textBaseline=this.font.baseAlign,t.font=this.font.fontString,t.direction=this.font.direction,this.font.shadow&&(t.shadowColor=this.font.shadow.color.toString(),t.shadowBlur=this.font.shadow.blur,t.shadowOffsetX=this.font.shadow.offset.x,t.shadowOffsetY=this.font.shadow.offset.y)}_drawText(t,i,r){this._applyRasterProperties(t),this._applyFont(t);for(let l=0;l<i.length;l++){const c=i[l];this.color&&t.fillText(c,0,l*r),this.font.strokeColor&&t.strokeText(c,0,l*r)}this.font.showDebug&&(He(t,nt.Green,-t.canvas.width/2,0,t.canvas.width/2,0,2),He(t,nt.Red,0,-t.canvas.height/2,0,t.canvas.height/2,2))}_splitTextBitmap(t){const i=[];let r=0,l=0;const c=Math.min(4096,t.canvas.width),g=Math.min(4096,t.canvas.height);for(;r<t.canvas.width;){for(;l<t.canvas.height;){const m=document.createElement("canvas");m.width=c,m.height=g,m.getContext("2d").drawImage(t.canvas,r,l,c,g,0,0,c,g),i.push({x:r,y:l,canvas:m}),l+=g}r+=c,l=0}return i}flagDirty(){this._dirty=!0}render(t,i,r,l){var c;if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);this._ex=t;const g=this.getHashCode();if(this._lastHashCode!==g&&(this._dirty=!0),this._dirty){this.dimensions=this.measureText(this.text,l),this._setDimension(this.dimensions,this.ctx);const m=this._getLinesFromText(this.text,l),w=(c=this.font.lineHeight)!==null&&c!==void 0?c:this.dimensions.height/m.length;if(this._drawText(this.ctx,m,w),t instanceof ls)for(const C of this._textFragments)t.textureLoader.delete(C.canvas);if(this._textFragments=this._splitTextBitmap(this.ctx),t instanceof ls)for(const C of this._textFragments)t.textureLoader.load(C.canvas,{filtering:this.font.filtering},!0);this._lastHashCode=g,this._dirty=!1}for(const m of this._textFragments)t.drawImage(m.canvas,0,0,m.canvas.width,m.canvas.height,m.x/this.font.quality+i-this.ctx.canvas.width/this.font.quality/2,m.y/this.font.quality+r-this.ctx.canvas.height/this.font.quality/2,m.canvas.width/this.font.quality,m.canvas.height/this.font.quality)}dispose(){if(this.disposed=!0,this.dimensions=void 0,this.canvas=void 0,this.ctx=void 0,this._ex instanceof ls)for(const t of this._textFragments)this._ex.textureLoader.delete(t.canvas);this._textFragments.length=0}_getLinesFromText(t,i){if(this._cachedText===t&&this._cachedRenderWidth===i)return this._cachedLines;const r=t.split(`
`);if(i==null)return r;for(let l=0;l<r.length;l++){let c=r[l],g="";if(this.measureText(c).width>i){for(;this.measureText(c).width>i;)g=c[c.length-1]+g,c=c.slice(0,-1);r[l]=c,r[l+1]=g}}return this._cachedText=t,this._cachedLines=r,this._cachedRenderWidth=i,r}}class re{static measureText(t,i,r){const l=ps.getHashCode(i,t);if(re._MEASURE_CACHE.has(l))return re._MEASURE_CACHE.get(l);re._LOGGER.debug("Font text measurement cache miss");const c=i.measureTextWithoutCache(t,r);return re._MEASURE_CACHE.set(l,c),c}static getTextInstance(t,i,r){const l=ps.getHashCode(i,t,r);let c=re._TEXT_CACHE.get(l);return c||(c=new ps(i,t,r),re._TEXT_CACHE.set(l,c),re._LOGGER.debug("Font text instance cache miss")),re._TEXT_USAGE.set(c,performance.now()),c}static checkAndClearCache(){const t=[],i=new Set;for(const[l,c]of re._TEXT_USAGE.entries())if(c+re.FONT_TIMEOUT<performance.now())re._LOGGER.debug(`Text cache entry timed out ${l.text}`),t.push(l),l.dispose();else{const g=l.getHashCode(!1);i.add(g)}t.forEach(l=>{re._TEXT_USAGE.delete(l)}),this._TEXT_CACHE.clear();for(const[l]of this._TEXT_USAGE.entries())this._TEXT_CACHE.set(l.getHashCode(),l);const r=new Map;for(const l of i)re._MEASURE_CACHE.has(l)&&r.set(l,re._MEASURE_CACHE.get(l));this._MEASURE_CACHE.clear(),this._MEASURE_CACHE=r}static get cacheSize(){return re._TEXT_USAGE.size}static clearCache(){for(const[t]of re._TEXT_USAGE.entries())t.dispose();re._TEXT_USAGE.clear(),re._TEXT_CACHE.clear(),re._MEASURE_CACHE.clear()}}re.FONT_TIMEOUT=500,re._LOGGER=gt.getInstance(),re._TEXT_USAGE=new Map,re._TEXT_CACHE=new Map,re._MEASURE_CACHE=new Map;class zs extends oe{constructor(t={}){var i,r,l,c,g,m,w,C,A,T,M,z,W,Z,st,q,Q,ot,et,_t;super(t),this.filtering=ae.Blended,this.quality=2,this.padding=2,this.smoothing=!1,this.lineWidth=1,this.lineDash=[],this.color=nt.Black,this.family="sans-serif",this.style=lr.Normal,this.bold=!1,this.unit=Ja.Px,this.textAlign=ar.Left,this.baseAlign=Sn.Top,this.direction=jo.LeftToRight,this.lineHeight=void 0,this.size=10,this.shadow=null,this._textBounds=new mt,this._textMeasurement=new ps(this,"",nt.Black),this.smoothing=(i=t==null?void 0:t.smoothing)!==null&&i!==void 0?i:this.smoothing,this.padding=(r=t==null?void 0:t.padding)!==null&&r!==void 0?r:this.padding,this.color=(l=t==null?void 0:t.color)!==null&&l!==void 0?l:this.color,this.strokeColor=(c=t==null?void 0:t.strokeColor)!==null&&c!==void 0?c:this.strokeColor,this.lineDash=(g=t==null?void 0:t.lineDash)!==null&&g!==void 0?g:this.lineDash,this.lineWidth=(m=t==null?void 0:t.lineWidth)!==null&&m!==void 0?m:this.lineWidth,this.filtering=(w=t==null?void 0:t.filtering)!==null&&w!==void 0?w:this.filtering,this.family=(C=t==null?void 0:t.family)!==null&&C!==void 0?C:this.family,this.style=(A=t==null?void 0:t.style)!==null&&A!==void 0?A:this.style,this.bold=(T=t==null?void 0:t.bold)!==null&&T!==void 0?T:this.bold,this.size=(M=t==null?void 0:t.size)!==null&&M!==void 0?M:this.size,this.unit=(z=t==null?void 0:t.unit)!==null&&z!==void 0?z:this.unit,this.textAlign=(W=t==null?void 0:t.textAlign)!==null&&W!==void 0?W:this.textAlign,this.baseAlign=(Z=t==null?void 0:t.baseAlign)!==null&&Z!==void 0?Z:this.baseAlign,this.direction=(st=t==null?void 0:t.direction)!==null&&st!==void 0?st:this.direction,this.lineHeight=(q=t==null?void 0:t.lineHeight)!==null&&q!==void 0?q:this.lineHeight,this.quality=(Q=t==null?void 0:t.quality)!==null&&Q!==void 0?Q:this.quality,t!=null&&t.shadow&&(this.shadow={},this.shadow.blur=(ot=t.shadow.blur)!==null&&ot!==void 0?ot:this.shadow.blur,this.shadow.offset=(et=t.shadow.offset)!==null&&et!==void 0?et:this.shadow.offset,this.shadow.color=(_t=t.shadow.color)!==null&&_t!==void 0?_t:this.shadow.color)}clone(){return new zs({...this.cloneGraphicOptions(),size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null})}get fontString(){return`${this.style} ${this.bold?"bold":""} ${this.size}${this.unit} ${this.family}`}get localBounds(){return this._textBounds}_drawImage(t,i,r){}_rotate(t){var i;const r=(i=this.origin)!==null&&i!==void 0?i:this._textBounds.center;t.translate(r.x,r.y),t.rotate(this.rotation),t.translate(-r.x,-r.y)}_flip(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}measureTextWithoutCache(t,i){return this._textMeasurement.measureText(t,i)}measureText(t,i){return re.measureText(t,this,i)}_postDraw(t){t.restore()}render(t,i,r,l,c,g){const m=re.getTextInstance(i,this,r);this._textBounds=m.dimensions,this._preDraw(t,l,c),m.render(t,l,c,g),this._postDraw(t)}}class Hs extends oe{constructor(t){var i,r;super(t),this._text="",this._textWidth=0,this._textHeight=0,this.font=(i=t.font)!==null&&i!==void 0?i:new zs,this.color=(r=t.color)!==null&&r!==void 0?r:this.color,this.text=t.text,this.maxWidth=t.maxWidth}clone(){var t,i;return new Hs({text:this.text.slice(),color:(i=(t=this.color)===null||t===void 0?void 0:t.clone())!==null&&i!==void 0?i:nt.Black,font:this.font.clone(),maxWidth:this.maxWidth})}get text(){return this._text}set text(t){this._text=t,this._calculateDimension()}get font(){return this._font}set font(t){this._font=t}get width(){return this._textWidth===0&&this._calculateDimension(),this._textWidth*this.scale.x}get height(){return this._textHeight===0&&this._calculateDimension(),this._textHeight*this.scale.y}_calculateDimension(){const{width:t,height:i}=this.font.measureText(this._text,this.maxWidth);this._textWidth=t,this._textHeight=i}get localBounds(){return this.font.measureText(this._text,this.maxWidth).scale(this.scale)}_rotate(t){}_flip(t){}_preDraw(t,i,r){(this.isStale()||this.font.isStale())&&(this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity),this.font.tint=this.tint,super._preDraw(t,i,r)}_drawImage(t,i,r){var l;let c=nt.Black;this.font instanceof zs&&(c=(l=this.color)!==null&&l!==void 0?l:this.font.color);const{width:g,height:m}=this.font.measureText(this._text,this.maxWidth);this._textWidth=g,this._textHeight=m,this.font.render(t,this._text,c,i,r,this.maxWidth),this.font.showDebug&&(t.debug.drawRect(i-g,r-m,g*2,m*2),this.maxWidth!=null&&t.debug.drawRect(i,r,this.maxWidth,this.height,{color:nt.Yellow}))}}class Ei extends ni{get pos(){return this.transform.pos}set pos(t){this.transform.pos=t.clone()}get oldPos(){return this.body.oldPos}set oldPos(t){this.body.oldPos.setTo(t.x,t.y)}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t.clone()}get oldVel(){return this.body.oldVel}set oldVel(t){this.body.oldVel.setTo(t.x,t.y)}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t.clone()}set oldAcc(t){this.body.oldAcc.setTo(t.x,t.y)}get oldAcc(){return this.body.oldAcc}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}get scale(){return this.get(yt).scale}set scale(t){this.get(yt).scale=t}get anchor(){return this._anchor}set anchor(t){this._anchor=ie(t,i=>this._handleAnchorChange(i)),this._handleAnchorChange(t)}_handleAnchorChange(t){this.graphics&&(this.graphics.anchor=t)}get offset(){return this._offset}set offset(t){this._offset=ie(t,i=>this._handleOffsetChange(i)),this._handleOffsetChange(t)}_handleOffsetChange(t){this.graphics&&(this.graphics.offset=t)}get isOffScreen(){return this.hasTag("ex.offscreen")}get draggable(){return this._draggable}set draggable(t){t&&(t&&!this._draggable?(this.events.on("pointerdragstart",this._pointerDragStartHandler),this.events.on("pointerdragend",this._pointerDragEndHandler),this.events.on("pointerdragmove",this._pointerDragMoveHandler),this.events.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.events.off("pointerdragstart",this._pointerDragStartHandler),this.events.off("pointerdragend",this._pointerDragEndHandler),this.events.off("pointerdragmove",this._pointerDragMoveHandler),this.events.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}get color(){return this._color}set color(t){this._color=t.clone();const i=this.graphics.current;(i instanceof er||i instanceof Hs)&&(i.color=this._color)}constructor(t){super(),this.events=new b,this._anchor=ie(D.Half,Rt=>this._handleAnchorChange(Rt)),this._offset=ie(D.Zero,Rt=>this._handleOffsetChange(Rt)),this.logger=gt.getInstance(),this._draggable=!1,this._dragging=!1,this._pointerDragStartHandler=()=>{this._dragging=!0},this._pointerDragEndHandler=()=>{this._dragging=!1},this._pointerDragMoveHandler=Rt=>{this._dragging&&(this.pos=Rt.worldPos)},this._pointerDragLeaveHandler=Rt=>{this._dragging&&(this.pos=Rt.worldPos)};const{name:i,x:r,y:l,pos:c,coordPlane:g,scale:m,width:w,height:C,radius:A,collider:T,vel:M,acc:z,rotation:W,angularVelocity:Z,z:st,color:q,visible:Q,opacity:ot,anchor:et,offset:_t,collisionType:Nt,collisionGroup:at}={...t};this.name=i??this.name,this.anchor=et??Ei.defaults.anchor.clone(),this.offset=_t??D.Zero,this.transform=new yt,this.addComponent(this.transform),this.pos=c??j(r??0,l??0),this.rotation=W??0,this.scale=m??j(1,1),this.z=st??0,this.transform.coordPlane=g??Me.World,this.pointer=new Ai,this.addComponent(this.pointer),this.graphics=new Ge({anchor:this.anchor,offset:this.offset,opacity:ot}),this.addComponent(this.graphics),this.motion=new Bt,this.addComponent(this.motion),this.vel=M??D.Zero,this.acc=z??D.Zero,this.angularVelocity=Z??0,this.actions=new Mr,this.addComponent(this.actions),this.body=new Lt,this.addComponent(this.body),this.body.collisionType=Nt??Mt.Passive,at&&(this.body.group=at),T?(this.collider=new de(T),this.addComponent(this.collider)):A?(this.collider=new de(ii.Circle(A)),this.addComponent(this.collider)):w>0&&C>0?(this.collider=new de(ii.Box(w,C,this.anchor)),this.addComponent(this.collider)):(this.collider=new de,this.addComponent(this.collider)),this.graphics.visible=Q??!0,q&&(this.color=q,w&&C?this.graphics.add(new No({color:q,width:w,height:C})):A&&this.graphics.add(new qa({color:q,radius:A})))}clone(){const t=new Ei({color:this.color.clone(),anchor:this.anchor.clone(),offset:this.offset.clone()});t.clearComponents(),t.processComponentRemoval(),t.addComponent(t.transform=this.transform.clone(),!0),t.addComponent(t.pointer=this.pointer.clone(),!0),t.addComponent(t.graphics=this.graphics.clone(),!0),t.addComponent(t.motion=this.motion.clone(),!0),t.addComponent(t.actions=this.actions.clone(),!0),t.addComponent(t.body=this.body.clone(),!0),t.addComponent(t.collider=this.collider.clone(),!0);const i=[this.transform,this.pointer,this.graphics,this.motion,this.actions,this.body,this.collider],r=this.getComponents();for(const l of r)i.includes(l)||t.addComponent(l.clone(),!0);return t}onInitialize(t){}_initialize(t){super._initialize(t);for(const i of this.children)i._initialize(t)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}_prekill(t){this.events.emit("prekill",new Fa(this)),this.onPreKill(t)}onPreKill(t){}_postkill(t){this.events.emit("postkill",new Ao(this)),this.onPostKill(t)}onPostKill(t){}kill(){this.scene?(this._prekill(this.scene),this.events.emit("kill",new So(this)),super.kill(),this._postkill(this.scene)):this.logger.warn(`Cannot kill actor named "${this.name}", it was never added to the Scene`)}unkill(){this.active=!0}isKilled(){return!this.active}get z(){return this.get(yt).z}set z(t){this.get(yt).z=t}get center(){const t=this.getGlobalPos();return new D(t.x+this.width/2-this.anchor.x*this.width,t.y+this.height/2-this.anchor.y*this.height)}get localCenter(){return new D(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}get width(){return this.collider.localBounds.width*this.getGlobalScale().x}get height(){return this.collider.localBounds.height*this.getGlobalScale().y}getGlobalRotation(){return this.get(yt).globalRotation}getGlobalPos(){return this.get(yt).globalPos}getGlobalScale(){return this.get(yt).globalScale}contains(t,i,r=!1){const l=j(t,i),c=this.get(de);c.update();const g=c.get();if(!g)return!1;const m=g.contains(l);return r?m||this.children.some(w=>w.contains(t,i,!0)):m}within(t,i){const r=this.get(de),l=t.get(de),c=r.get(),g=l.get();return c&&g?c.getClosestLineBetween(g).getLength()<=i:!1}update(t,i){this._initialize(t),this._preupdate(t,i),this._postupdate(t,i)}onPreUpdate(t,i){}onPostUpdate(t,i){}onPreCollisionResolve(t,i,r,l){}onPostCollisionResolve(t,i,r,l){}onCollisionStart(t,i,r,l){}onCollisionEnd(t,i,r,l){}_preupdate(t,i){this.events.emit("preupdate",new Bs(t,i,this)),this.onPreUpdate(t,i)}_postupdate(t,i){this.events.emit("postupdate",new us(t,i,this)),this.onPostUpdate(t,i)}}Ei.defaults={anchor:D.Half};function Or(f){return f instanceof gs}class gs extends Ei{constructor(t){var i,r;super({...t}),this.get(yt).coordPlane=Me.Screen,this.anchor=(i=t==null?void 0:t.anchor)!==null&&i!==void 0?i:j(0,0),this.body.collisionType=(r=t==null?void 0:t.collisionType)!==null&&r!==void 0?r:Mt.PreventCollision,this.pointer.useGraphicsBounds=!0,this.pointer.useColliderShape=!1,!(t!=null&&t.collider)&&(t==null?void 0:t.width)>0&&(t==null?void 0:t.height)>0&&this.collider.useBoxCollider(this.width,this.height,this.anchor)}_initialize(t){this._engine=t,super._initialize(t)}contains(t,i,r=!0){if(r)return super.contains(t,i);const l=this._engine.worldToScreenCoordinates(new D(t,i));return super.contains(l.x,l.y)}}class zn{get complete(){return this._complete}constructor(t,i,r,l,c,g){if(this._logger=gt.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this.randomRange=[0,0],this._baseInterval=10,this._generateRandomInterval=()=>this._baseInterval+this.random.integer(this.randomRange[0],this.randomRange[1]),this._complete=!1,this.scene=null,typeof t!="function"){const m=t;t=m.fcn,i=m.interval,r=m.repeats,l=m.numberOfRepeats,c=m.randomRange,g=m.random}if(l&&l>=0&&(this.maxNumberOfRepeats=l,!r))throw new Error("repeats must be set to true if numberOfRepeats is set");if(this.id=zn._MAX_ID++,this._callbacks=[],this._baseInterval=this.interval=i,c){if(c[0]>c[1])throw new Error("min value must be lower than max value for range");this.random=g??new L,this.randomRange=c,this.interval=this._generateRandomInterval(),this.on(()=>{this.interval=this._generateRandomInterval()})}this.repeats=r||this.repeats,t&&this.on(t)}on(t){this._callbacks.push(t)}off(t){const i=this._callbacks.indexOf(t);this._callbacks.splice(i,1)}update(t){this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach(i=>{i.call(this)}),this._numberOfTicks++,this.repeats?this._elapsedTime=0:(this._complete=!0,this._running=!1,this._elapsedTime=0)))}reset(t,i){if(t&&t>=0&&(this._baseInterval=this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=i,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}get timesRepeated(){return this._numberOfTicks}getTimeRunning(){return this._totalTimeAlive}get timeToNextAction(){return this.complete?0:this.interval-this._elapsedTime}get timeElapsedTowardNextAction(){return this._elapsedTime}get isRunning(){return this._running}pause(){return this._running=!1,this}resume(){return this._running=!0,this}start(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}stop(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}cancel(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}zn._MAX_ID=0;class tl extends Qe{constructor(t){super(),this.parallaxFactor=j(1,1),this.parallaxFactor=t??this.parallaxFactor}}class el extends Qe{constructor(t,i=!0){super(),this.draw=t,this.useTransform=i}}const Zf={PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw",PointerUp:"pointerup",PointerDown:"pointerdown",PointerMove:"pointermove",PointerCancel:"pointercancel"};class Go extends ni{flagCollidersDirty(){this._collidersDirty=!0}flagTilesDirty(){for(let t=0;t<this.tiles.length;t++)this.tiles[t]&&this.tiles[t].flagDirty()}get x(){var t;return(t=this.transform.pos.x)!==null&&t!==void 0?t:0}set x(t){var i;!((i=this.transform)===null||i===void 0)&&i.pos&&(this.get(yt).pos=j(t,this.y))}get y(){var t,i;return(i=(t=this.transform)===null||t===void 0?void 0:t.pos.y)!==null&&i!==void 0?i:0}set y(t){var i;!((i=this.transform)===null||i===void 0)&&i.pos&&(this.transform.pos=j(this.x,t))}get z(){var t;return(t=this.transform.z)!==null&&t!==void 0?t:0}set z(t){this.transform&&(this.transform.z=t)}get rotation(){var t,i;return(i=(t=this.transform)===null||t===void 0?void 0:t.rotation)!==null&&i!==void 0?i:0}set rotation(t){this.transform&&(this.transform.rotation=t)}get scale(){var t,i;return(i=(t=this.transform)===null||t===void 0?void 0:t.scale)!==null&&i!==void 0?i:D.One}set scale(t){var i;!((i=this.transform)===null||i===void 0)&&i.scale&&(this.transform.scale=t)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t}get vel(){return this._motion.vel}set vel(t){this._motion.vel=t}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}constructor(t){var i,r,l;super([],t.name),this.events=new b,this._token=0,this.logger=gt.getInstance(),this.tiles=[],this._rows=[],this._cols=[],this.renderFromTopOfGraphic=!1,this.meshingLookBehind=10,this._collidersDirty=!0,this._forwardPointerEventToTile=g=>m=>{const w=this.getTileByPoint(m.worldPos);w&&w.events.emit(g,m)},this._originalOffsets=new WeakMap,this.meshingLookBehind=(i=t.meshingLookBehind)!==null&&i!==void 0?i:this.meshingLookBehind,this.addComponent(new yt),this.addComponent(new Bt),this.addComponent(new Lt({type:Mt.Fixed})),this.addComponent(new Ge({onPostDraw:(g,m)=>this.draw(g,m)})),this.addComponent(new el((g,m)=>this.debug(g,m),!1)),this.addComponent(new de),this.addComponent(new Ai),this.pointer=this.get(Ai),this._graphics=this.get(Ge),this.transform=this.get(yt),this._motion=this.get(Bt),this.collider=this.get(de),this._composite=this.collider.useCompositeCollider([]),this.transform.pos=(r=t.pos)!==null&&r!==void 0?r:D.Zero,this._oldPos=this.transform.pos.clone(),this._oldScale=this.transform.scale.clone(),this.renderFromTopOfGraphic=(l=t.renderFromTopOfGraphic)!==null&&l!==void 0?l:this.renderFromTopOfGraphic,this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight,this.rows=t.rows,this.columns=t.columns,this.tiles=new Array(this.rows*this.columns),this._rows=new Array(this.rows),this._cols=new Array(this.columns);let c=[];for(let g=0;g<this.columns;g++){for(let m=0;m<this.rows;m++){const w=new Vo({x:g,y:m,map:this});w.map=this,this.tiles[g+m*this.columns]=w,c.push(w),this._rows[m]||(this._rows[m]=[]),this._rows[m].push(w)}this._cols[g]=c,c=[]}this._setupPointerToTile(),this._graphics.localBounds=new mt({left:0,top:0,right:this.columns*this.tileWidth*this.scale.x,bottom:this.rows*this.tileHeight*this.scale.y})}_initialize(t){super._initialize(t),this._engine=t}_setupPointerToTile(){this.events.on("pointerup",this._forwardPointerEventToTile("pointerup")),this.events.on("pointerdown",this._forwardPointerEventToTile("pointerdown")),this.events.on("pointermove",this._forwardPointerEventToTile("pointermove")),this.events.on("pointercancel",this._forwardPointerEventToTile("pointercancel"))}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const i=t.offset;return this._originalOffsets.set(t,i),i}}_updateColliders(){this.collider.$colliderRemoved.notifyAll(this._composite),this._composite.clearColliders();const t=[];this._composite=this.collider.useCompositeCollider([]);let i;const r=(c,g)=>c&&g?c.top===g.top&&c.bottom===g.bottom&&c.right===g.left:!1,l=(c,g,m=this.meshingLookBehind)=>{if(!c)return!1;for(let w=g.length-1;w>=0;w--){if(m--<0)return!1;const C=g[w];if(r(C,c))return g[w]=C.combine(c),!0}return!1};for(let c=0;c<this.columns;c++){for(let g=0;g<this.rows;g++){const m=this.tiles[c+g*this.columns];if(m.solid)if(m.getColliders().length>0){for(const w of m.getColliders()){const C=this._getOrSetColliderOriginalOffset(w);w.offset=j(m.x*this.tileWidth*this.scale.x,m.y*this.tileHeight*this.scale.y).add(C),w.owner=this,this._composite.addCollider(w)}i&&!l(i,t)&&t.push(i),i=null}else i?i=i.combine(m.defaultGeometry):i=m.defaultGeometry;else i&&!l(i,t)&&t.push(i),i=null}i&&!l(i,t)&&t.push(i),i=null}for(const c of t){const g=ii.Box(c.width,c.height,D.Zero,j(c.left-this.pos.x,c.top-this.pos.y));g.owner=this,this._composite.addCollider(g)}this.collider.update(),this.collider.$colliderAdded.notifyAll(this._composite)}getTileByIndex(t){return this.tiles[t]}getTile(t,i){return t<0||i<0||t>=this.columns||i>=this.rows?null:this.tiles[t+i*this.columns]}getTileByPoint(t){const{x:i,y:r}=this._getTileCoordinates(t),l=this.getTile(i,r);return i>=0&&r>=0&&i<this.columns&&r<this.rows&&l?l:null}_getTileCoordinates(t){t=this.transform.applyInverse(t);const i=Math.floor(t.x/this.tileWidth),r=Math.floor(t.y/this.tileHeight);return{x:i,y:r}}getRows(){return this._rows}getColumns(){return this._cols}getOnScreenTiles(){let t=this._engine.screen.getWorldBounds();const i=this.get(tl);if(i&&this.isInitialized){let z=this.pos;const W=D.One.sub(i.parallaxFactor),Z=this._engine.currentScene.camera.pos.scale(W);z=z.sub(Z),t=t.translate(z)}const r=this.transform.coordPlane===Me.Screen?this._engine.screen.getScreenBounds():t,l=this._getTileCoordinates(r.topLeft),c=this._getTileCoordinates(r.topRight),g=this._getTileCoordinates(r.bottomRight),m=this._getTileCoordinates(r.bottomLeft),w=Math.min(G(l.x,0,this.columns-1),G(c.x,0,this.columns-1)),C=Math.min(G(l.y,0,this.rows-1),G(c.y,0,this.rows-1)),A=Math.max(G(g.x,0,this.columns-1),G(m.x,0,this.columns-1)),T=Math.max(G(g.y,0,this.rows-1),G(m.y,0,this.rows-1)),M=[];for(let z=w;z<=A;z++)for(let W=C;W<=T;W++)M.push(this.getTile(z,W));return M}update(t,i){this._initialize(t),this.onPreUpdate(t,i),this.emit("preupdate",new Bs(t,i,this)),(!this._oldPos.equals(this.pos)||this._oldRotation!==this.rotation||!this._oldScale.equals(this.scale))&&(this.flagCollidersDirty(),this.flagTilesDirty()),this._collidersDirty&&(this._collidersDirty=!1,this._updateColliders()),this._token++,this.pos.clone(this._oldPos),this._oldRotation=this.rotation,this.scale.clone(this._oldScale),this.transform.pos=this.pos,this.onPostUpdate(t,i),this.emit("postupdate",new us(t,i,this))}draw(t,i){if(!this.isInitialized)return;this.emit("predraw",new hs(t,i,this));let r,l,c;const g=this.getOnScreenTiles();for(let m=0;m<g.length;m++){const w=g[m],C=w.getGraphicsOffsets();for(r=w.getGraphics(),l=0,c=r.length;l<c;l++){const A=r[l],T=C[l];if(A){Ah(A)&&(A==null||A.tick(i,this._token));const M=this.renderFromTopOfGraphic?0:A.height-this.tileHeight;A.draw(t,w.x*this.tileWidth+T.x,w.y*this.tileHeight-M+T.y)}}}this.emit("postdraw",new ir(t,i,this))}debug(t,i){const{showAll:r,showGrid:l,gridColor:c,gridWidth:g,showSolidBounds:m,solidBoundsColor:w,showColliderGeometry:C}=i.tilemap,{geometryColor:A,geometryLineWidth:T,geometryPointSize:M}=i.collider,z=this.tileWidth*this.columns*this.scale.x,W=this.tileHeight*this.rows*this.scale.y,Z=this.pos;if(l||r){for(let st=0;st<this.rows+1;st++){const q=j(0,st*this.tileHeight*this.scale.y);t.drawLine(Z.add(q),Z.add(j(z,q.y)),c,g)}for(let st=0;st<this.columns+1;st++){const q=j(st*this.tileWidth*this.scale.x,0);t.drawLine(Z.add(q),Z.add(j(q.x,W)),c,g)}}if(r||m||C){const st=this._composite.getColliders();t.save(),t.translate(this.pos.x,this.pos.y),t.scale(this.scale.x,this.scale.y);for(const q of st){const Q=q.localBounds,ot=q.worldPos.sub(this.pos);m&&t.drawRectangle(ot,Q.width,Q.height,w)}if(t.restore(),C)for(const q of st)q.debug(t,A,{lineWidth:T,pointSize:M})}if(r||m){if(t.save(),t.z=999,m)for(let st=0;st<this.tiles.length;st++)this.tiles[st].bounds.draw(t);t.restore()}}}class Vo{get pos(){return this._posDirty&&(this._recalculate(),this._posDirty=!1),this._pos}get width(){return this._width}get height(){return this._height}get solid(){return this._solid}set solid(t){var i;(i=this.map)===null||i===void 0||i.flagCollidersDirty(),this._solid=t}getGraphics(){return this._graphics}getGraphicsOffsets(){return this._offsets}addGraphic(t,i){this._graphics.push(t),i!=null&&i.offset?this._offsets.push(i.offset):this._offsets.push(D.Zero)}removeGraphic(t){const i=this._graphics.indexOf(t);i>-1&&(this._graphics.splice(i,1),this._offsets.splice(i,1))}clearGraphics(){this._graphics.length=0,this._offsets.length=0}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const i=this._colliders.indexOf(t);i>-1&&this._colliders.splice(i,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}constructor(t){var i,r;this._posDirty=!1,this.events=new b,this._solid=!1,this._graphics=[],this._offsets=[],this._colliders=[],this.data=new Map,this.x=t.x,this.y=t.y,this.map=t.map,this._width=t.map.tileWidth*this.map.scale.x,this._height=t.map.tileHeight*this.map.scale.y,this.solid=(i=t.solid)!==null&&i!==void 0?i:this.solid,this._graphics=(r=t.graphics)!==null&&r!==void 0?r:[],this._recalculate()}flagDirty(){return this._posDirty=!0}_recalculate(){const t=this.map.pos.add(j(this.x*this.map.tileWidth,this.y*this.map.tileHeight));this._geometry=new mt(t.x,t.y,t.x+this.map.tileWidth,t.y+this.map.tileHeight),this._width=this.map.tileWidth*this.map.scale.x,this._height=this.map.tileHeight*this.map.scale.y,this._pos=this.map.pos.add(j(this.x*this._width,this.y*this._height)),this._bounds=new mt(this._pos.x,this._pos.y,this._pos.x+this._width,this._pos.y+this._height),this.map.rotation&&(this._bounds=this._bounds.rotate(this.map.rotation,this.map.pos)),this._posDirty=!1}get bounds(){return this._posDirty&&this._recalculate(),this._bounds}get defaultGeometry(){return this._geometry}get center(){return this._posDirty&&this._recalculate(),new D(this._pos.x+this._width/2,this._pos.y+this._height/2)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){i?this.events.off(t,i):this.events.off(t)}}class il{constructor(t){this.camera=t}lockToActor(t){this.camera.addStrategy(new Eh(t))}lockToActorAxis(t,i){this.camera.addStrategy(new dc(t,i))}elasticToActor(t,i,r){this.camera.addStrategy(new fc(t,i,r))}radiusAroundActor(t,i){this.camera.addStrategy(new Oe(t,i))}limitCameraBounds(t){this.camera.addStrategy(new si(t))}}var nl;(function(f){f[f.X=0]="X",f[f.Y=1]="Y"})(nl||(nl={}));class Eh{constructor(t){this.target=t,this.action=(i,r,l,c)=>i.center}}class dc{constructor(t,i){this.target=t,this.axis=i,this.action=(r,l,c,g)=>{const m=r.center,w=l.getFocus();return this.axis===nl.X?new D(m.x,w.y):new D(w.x,m.y)}}}class fc{constructor(t,i,r){this.target=t,this.cameraElasticity=i,this.cameraFriction=r,this.action=(l,c,g,m)=>{const w=l.center;let C=c.getFocus(),A=c.vel.clone();const T=w.sub(C).scale(this.cameraElasticity);A=A.add(T);const M=A.scale(-1).scale(this.cameraFriction);return A=A.add(M),C=C.add(A),C}}}class Oe{constructor(t,i){this.target=t,this.radius=i,this.action=(r,l,c,g)=>{const m=r.center,w=l.getFocus(),C=m.sub(w),A=C.size;if(A>=this.radius){const T=A-this.radius;return w.add(C.normalize().scale(T))}return w}}}class si{constructor(t){this.target=t,this.boundSizeChecked=!1,this.action=(i,r,l,c)=>{const g=r.getFocus();this.boundSizeChecked||((i.bottom-i.top<l.drawHeight||i.right-i.left<l.drawWidth)&&gt.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),this.boundSizeChecked=!0);let m=g.x,w=g.y;return g.x<i.left+l.halfDrawWidth?m=i.left+l.halfDrawWidth:g.x>i.right-l.halfDrawWidth&&(m=i.right-l.halfDrawWidth),g.y<i.top+l.halfDrawHeight?w=i.top+l.halfDrawHeight:g.y>i.bottom-l.halfDrawHeight&&(w=i.bottom-l.halfDrawHeight),j(m,w)}}}const Kf={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate"};class pc{constructor(){this.events=new b,this.transform=Zt.identity(),this.inverse=Zt.identity(),this._cameraStrategies=[],this.strategy=new il(this),this._z=1,this.dz=0,this.az=0,this.rotation=0,this._angularVelocity=0,this._posChanged=!1,this._pos=Oi(D.Zero,()=>this._posChanged=!0),this.drawPos=this.pos.clone(),this._oldPos=this.pos.clone(),this.vel=D.Zero,this.acc=D.Zero,this._cameraMoving=!1,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=null,this._lerpEnd=null,this._isShaking=!1,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._elapsedShakeTime=0,this._xShake=0,this._yShake=0,this._isZooming=!1,this._zoomStart=1,this._zoomEnd=1,this._currentZoomTime=0,this._zoomDuration=0,this._zoomEasing=V.EaseInOutCubic,this._easing=V.EaseInOutCubic,this._halfWidth=0,this._halfHeight=0,this._viewport=null,this._isInitialized=!1,this._snapPos=j(0,0)}get zoom(){return this._z}set zoom(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}get angularVelocity(){return this._angularVelocity}set angularVelocity(t){this._angularVelocity=t}get pos(){return this._pos}set pos(t){this._pos=Oi(t,()=>this._posChanged=!0),this._posChanged=!0}get x(){return this.pos.x}set x(t){!this._follow&&!this._cameraMoving&&(this.pos=j(t,this.pos.y))}get y(){return this.pos.y}set y(t){!this._follow&&!this._cameraMoving&&(this.pos=j(this.pos.x,t))}get dx(){return this.vel.x}set dx(t){this.vel=j(t,this.vel.y)}get dy(){return this.vel.y}set dy(t){this.vel=j(this.vel.x,t)}get ax(){return this.acc.x}set ax(t){this.acc=j(t,this.acc.y)}get ay(){return this.acc.y}set ay(t){this.acc=j(this.acc.x,t)}getFocus(){return this.pos}move(t,i,r=V.EaseInOutCubic){if(typeof r!="function")throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise(l=>{this._lerpResolve=l}),this._lerpStart=this.getFocus().clone(),this._lerpDuration=i,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=r,this._lerpPromise)}shake(t,i,r){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=i,this._shakeDuration=r}zoomOverTime(t,i=0,r=V.EaseInOutCubic){if(this._zoomPromise=new Promise(l=>{this._zoomResolve=l}),i)this._isZooming=!0,this._zoomEasing=r,this._currentZoomTime=0,this._zoomDuration=i,this._zoomStart=this.zoom,this._zoomEnd=t;else return this._isZooming=!1,this.zoom=t,Promise.resolve(!0);return this._zoomPromise}get viewport(){return this._viewport?this._viewport:new mt(0,0,0,0)}addStrategy(t){this._cameraStrategies.push(t)}removeStrategy(t){Tt(t,this._cameraStrategies)}clearAllStrategies(){this._cameraStrategies.length=0}_preupdate(t,i){this.events.emit("preupdate",new Bs(t,i,this)),this.onPreUpdate(t,i)}onPreUpdate(t,i){}_postupdate(t,i){this.events.emit("postupdate",new us(t,i,this)),this.onPostUpdate(t,i)}onPostUpdate(t,i){}get isInitialized(){return this._isInitialized}_initialize(t){if(!this.isInitialized){this._engine=t,this._screen=t.screen;const i=this._screen.contentArea;let r=j(i.width/2,i.height/2);if(!this._engine.loadingComplete){const l=this._screen.peekResolution();l&&(r=j(l.width/2,l.height/2))}this._halfWidth=r.x,this._halfHeight=r.y,this._posChanged||(this.pos=r),this.pos.clone(this.drawPos),this.updateTransform(this.pos),this.runStrategies(t,t.clock.elapsed()),this.updateViewport(),this.updateTransform(this.pos),this.pos.clone(this._oldPos),this.onInitialize(t),this.events.emit("initialize",new Br(t,this)),this._isInitialized=!0}}onInitialize(t){}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}runStrategies(t,i){for(const r of this._cameraStrategies)this.pos=r.action.call(r,r.target,this,t,i)}updateViewport(){this._viewport=new mt(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight)}update(t,i){if(this._initialize(t),this._preupdate(t,i),this.pos.clone(this._oldPos),this.pos=this.pos.add(this.vel.scale(i/1e3)),this.zoom+=this.dz*i/1e3,this.vel=this.vel.add(this.acc.scale(i/1e3)),this.dz+=this.az*i/1e3,this.rotation+=this.angularVelocity*i/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){const r=this._zoomEasing,l=r(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=l,this._currentZoomTime+=i}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){const l=V.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=l,this._currentLerpTime+=i}else{this.pos=this._lerpEnd;const r=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(r)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=i,this._xShake=(Math.random()*this._shakeMagnitudeX|0)+1,this._yShake=(Math.random()*this._shakeMagnitudeY|0)+1),this.runStrategies(t,i),this.updateViewport(),this.updateTransform(this.pos),this._postupdate(t,i)}draw(t){if(this.pos.clone(this.drawPos),this._engine.fixedUpdateFps){const i=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps),r=this.pos.scale(i).add(this._oldPos.scale(1-i));r.clone(this.drawPos),this.updateTransform(r)}if(t.snapToPixel){const i=this.drawPos.clone(this._snapPos);i.x=~~(i.x+Wt*$(i.x)),i.y=~~(i.y+Wt*$(i.y)),i.clone(this.drawPos),this.updateTransform(i)}t.multiply(this.transform)}updateTransform(t){const i=this._screen.resolution.width/this.zoom,r=this._screen.resolution.height/this.zoom,l=j(-t.x+i/2+this._xShake,-t.y+r/2+this._yShake);this.transform.reset(),this.transform.scale(this.zoom,this.zoom),this.transform.translate(i/2,r/2),this.transform.rotate(this.rotation),this.transform.translate(-i/2,-r/2),this.transform.translate(l.x,l.y),this.transform.inverse(this.inverse)}_isDoneShaking(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}const gc={ExitTrigger:"exit",EnterTrigger:"enter"},Jf={pos:D.Zero,width:10,height:10,visible:!1,action:()=>{},filter:()=>!0,repeat:-1};class sl extends Ei{constructor(t){super({x:t.pos.x,y:t.pos.y,width:t.width,height:t.height}),this.events=new b,this.action=()=>{},this.filter=()=>!0,this.repeat=-1,t={...Jf,...t},this.filter=t.filter||this.filter,this.repeat=t.repeat||this.repeat,this.action=t.action||this.action,t.target&&(this.target=t.target),this.graphics.visible=t.visible,this.body.collisionType=Mt.Passive,this.events.on("collisionstart",i=>{this.filter(i.other)&&(this.events.emit("enter",new ph(this,i.other)),this._dispatchAction(),this.repeat===0&&this.kill())}),this.events.on("collisionend",i=>{this.filter(i.other)&&this.events.emit("exit",new gh(this,i.other))})}set target(t){this._target=t,this.filter=i=>i===t}get target(){return this._target}_initialize(t){super._initialize(t)}_dispatchAction(){this.repeat!==0&&(this.action.call(this),this.repeat--)}}const Ui={Highest:-1/0,Higher:-5,Average:0,Lower:5,Lowest:1/0};var mi;(function(f){f.Update="update",f.Draw="draw"})(mi||(mi={}));class ri{constructor(){this.priority=Ui.Average}}class Nr{constructor(t){this._world=t,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}updateEntities(t,i){for(const r of this.entities)r.update(t.engine,i),r.active||this.removeEntity(r)}findEntitiesForRemoval(){for(const t of this.entities)t.active||this.removeEntity(t)}addEntity(t){t.active=!0,t.scene=this._world.scene,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.children.forEach(i=>{i.scene=t.scene,this.addEntity(i)}),t.childrenAdded$.register({notify:i=>{this.addEntity(i)}}),t.childrenRemoved$.register({notify:i=>{this.removeEntity(i,!1)}}))}removeEntity(t,i=!0){var r,l;let c=0;t instanceof ni?c=t.id:c=t;const g=this._entityIndex[c];if(g&&g.active&&(g.active=!1),g&&i){this._entitiesToRemove.push(g);return}delete this._entityIndex[c],g&&(g.scene=null,Tt(g,this.entities),this._world.queryManager.removeEntity(g),g.children.forEach(m=>{m.scene=null,this.removeEntity(m,i)}),g.childrenAdded$.clear(),g.childrenRemoved$.clear(),!((l=(r=this._world)===null||r===void 0?void 0:r.scene)===null||l===void 0)&&l.engine&&this._world.scene.engine.stats.currFrame.actors.killed++)}processEntityRemovals(){for(const t of this._entitiesToRemove)t.active||this.removeEntity(t,!1);this._entitiesToRemove.length=0}processComponentRemovals(){for(const t of this.entities)t.processComponentRemoval()}getById(t){return this._entityIndex[t]}getByName(t){return this.entities.filter(i=>i.name===t)}clear(){for(let t=this.entities.length-1;t>=0;t--)this.removeEntity(this.entities[t])}}class _s{constructor(t){if(this.requiredComponents=t,this.components=new Set,this.entities=[],this.entityAdded$=new We,this.entityRemoved$=new We,t.length===0)throw new Error("Cannot create query without components");for(const i of t)this.components.add(i);this.id=_s.createId(t)}static createId(t){return t.slice().map(i=>i.name).sort().join("-")}checkAndAdd(t){return!this.entities.includes(t)&&t.hasAll(Array.from(this.components))?(this.entities.push(t),this.entityAdded$.notifyAll(t),!0):!1}removeEntity(t){const i=this.entities.indexOf(t);i>-1&&(this.entities.splice(i,1),this.entityRemoved$.notifyAll(t))}getEntities(t){return t&&this.entities.sort(t),this.entities}}class Ws{constructor(t){if(this.requiredTags=t,this.tags=new Set,this.entities=[],this.entityAdded$=new We,this.entityRemoved$=new We,t.length===0)throw new Error("Cannot create tag query without tags");for(const i of t)this.tags.add(i);this.id=Ws.createId(t)}static createId(t){return t.slice().sort().join("-")}checkAndAdd(t){return!this.entities.includes(t)&&t.hasAllTags(Array.from(this.tags))?(this.entities.push(t),this.entityAdded$.notifyAll(t),!0):!1}removeEntity(t){const i=this.entities.indexOf(t);i>-1&&(this.entities.splice(i,1),this.entityRemoved$.notifyAll(t))}getEntities(t){return t&&this.entities.sort(t),this.entities}}class hr{constructor(t){this._world=t,this._queries=new Map,this._addComponentHandlers=new Map,this._removeComponentHandlers=new Map,this._componentToQueriesIndex=new Map,this._tagQueries=new Map,this._addTagHandlers=new Map,this._removeTagHandlers=new Map,this._tagToQueriesIndex=new Map,this._createAddComponentHandler=i=>r=>{this.addComponent(i,r)},this._createRemoveComponentHandler=i=>r=>{this.removeComponent(i,r)},this._createAddTagHandler=i=>r=>{this.addTag(i,r)},this._createRemoveTagHandler=i=>r=>{this.removeTag(i,r)}}createQuery(t){const i=_s.createId(t);if(this._queries.has(i))return this._queries.get(i);const r=new _s(t);this._queries.set(r.id,r);for(const l of t){const c=this._componentToQueriesIndex.get(l);c?c.push(r):this._componentToQueriesIndex.set(l,[r])}for(const l of this._world.entities)this.addEntity(l);return r}createTagQuery(t){const i=Ws.createId(t);if(this._tagQueries.has(i))return this._tagQueries.get(i);const r=new Ws(t);this._tagQueries.set(r.id,r);for(const l of t){const c=this._tagToQueriesIndex.get(l);c?c.push(r):this._tagToQueriesIndex.set(l,[r])}for(const l of this._world.entities)this.addEntity(l);return r}addEntity(t){const i=this._addComponentHandlers.get(t),r=this._removeComponentHandlers.get(t),l=i??this._createAddComponentHandler(t),c=r??this._createRemoveComponentHandler(t);this._addComponentHandlers.set(t,l),this._removeComponentHandlers.set(t,c);const g=this._addTagHandlers.get(t),m=this._removeTagHandlers.get(t),w=g??this._createAddTagHandler(t),C=m??this._createRemoveTagHandler(t);this._addTagHandlers.set(t,w),this._removeTagHandlers.set(t,C);for(const A of this._queries.values())A.checkAndAdd(t);for(const A of this._tagQueries.values())A.checkAndAdd(t);t.componentAdded$.subscribe(l),t.componentRemoved$.subscribe(c),t.tagAdded$.subscribe(w),t.tagRemoved$.subscribe(C)}removeEntity(t){const i=this._addComponentHandlers.get(t),r=this._removeComponentHandlers.get(t);for(const g of this._queries.values())g.removeEntity(t);i&&t.componentAdded$.unsubscribe(i),r&&t.componentRemoved$.unsubscribe(r);const l=this._addTagHandlers.get(t),c=this._removeTagHandlers.get(t);for(const g of this._tagQueries.values())g.removeEntity(t);l&&t.tagAdded$.unsubscribe(l),c&&t.tagRemoved$.unsubscribe(c)}addComponent(t,i){var r;const l=(r=this._componentToQueriesIndex.get(i.constructor))!==null&&r!==void 0?r:[];for(const c of l)c.checkAndAdd(t)}removeComponent(t,i){var r;const l=(r=this._componentToQueriesIndex.get(i.constructor))!==null&&r!==void 0?r:[];for(const c of l)c.removeEntity(t)}addTag(t,i){var r;const l=(r=this._tagToQueriesIndex.get(i))!==null&&r!==void 0?r:[];for(const c of l)c.checkAndAdd(t)}removeTag(t,i){var r;const l=(r=this._tagToQueriesIndex.get(i))!==null&&r!==void 0?r:[];for(const c of l)c.removeEntity(t)}}function _c(f){var t,i;return!!(f!=null&&f.prototype)&&!!(!((i=(t=f==null?void 0:f.prototype)===null||t===void 0?void 0:t.constructor)===null||i===void 0)&&i.name)}class mc{constructor(t){this._world=t,this.systems=[],this.initialized=!1}get(t){return this.systems.find(i=>i instanceof t)}addSystem(t){let i;t instanceof ri?i=t:i=new t(this._world),this.systems.push(i),this.systems.sort((r,l)=>r.priority-l.priority),this.initialized&&i.initialize&&i.initialize(this._world,this._world.scene)}removeSystem(t){Tt(t,this.systems)}initialize(){if(!this.initialized){this.initialized=!0;for(const t of this.systems)t.initialize&&t.initialize(this._world,this._world.scene)}}updateSystems(t,i,r){const l=this.systems.filter(c=>c.systemType===t);for(const c of l)c.preupdate&&c.preupdate(i,r);for(const c of l)c.update(r);for(const c of l)c.postupdate&&c.postupdate(i,r)}clear(){for(let t=this.systems.length-1;t>=0;t--)this.removeSystem(this.systems[t])}}class vc{constructor(t){this.scene=t,this.queryManager=new hr(this),this.entityManager=new Nr(this),this.systemManager=new mc(this)}query(t){return this.queryManager.createQuery(t)}queryTags(t){return this.queryManager.createTagQuery(t)}update(t,i){t===mi.Update&&this.entityManager.updateEntities(this.scene,i),this.systemManager.updateSystems(t,this.scene,i),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}add(t){t instanceof ni&&this.entityManager.addEntity(t),(t instanceof ri||_c(t))&&this.systemManager.addSystem(t)}get(t){return this.systemManager.get(t)}remove(t,i=!0){t instanceof ni&&this.entityManager.removeEntity(t,i),t instanceof ri&&this.systemManager.removeSystem(t)}get entities(){return this.entityManager.entities}clearEntities(){this.entityManager.clear()}clearSystems(){this.systemManager.clear()}}class Ti{static integrate(t,i,r,l){const c=l/1e3;i.vel.addEqual(r.scale(c,Ti._ACC)),t.pos.add(i.vel.scale(c,Ti._VEL),Ti._POS).addEqual(r.scale(.5*c*c,Ti._VEL_ACC)),i.angularVelocity+=i.torque*(1/i.inertia)*c;const g=t.rotation+i.angularVelocity*c;t.scale.add(i.scaleFactor.scale(c,this._SCALE_FACTOR),Ti._SCALE),t.get().setTransform(Ti._POS,g,Ti._SCALE)}}Ti._POS=new D(0,0),Ti._SCALE=new D(1,1),Ti._ACC=new D(0,0),Ti._VEL=new D(0,0),Ti._VEL_ACC=new D(0,0),Ti._SCALE_FACTOR=new D(0,0);class yc extends ri{constructor(t,i){super(),this.world=t,this.physics=i,this.systemType=mi.Update,this.priority=Ui.Higher,this._physicsConfigDirty=!1,i.$configUpdate.subscribe(()=>this._physicsConfigDirty=!0),this.query=this.world.query([yt,Bt])}update(t){let i,r;const l=this.query.entities;for(let c=0;c<l.length;c++){i=l[c].get(yt),r=l[c].get(Bt);const g=l[c].get(Lt);if(this._physicsConfigDirty&&g&&g.updatePhysicsConfig(this.physics.config.bodies),g!=null&&g.sleeping)continue;const m=r.acc.clone();(g==null?void 0:g.collisionType)===Mt.Active&&(g!=null&&g.useGravity)&&m.addEqual(this.physics.config.gravity),g==null||g.captureOldTransform(),Ti.integrate(i,r,m,t)}this._physicsConfigDirty=!1}}class Ur{constructor(t){this.config=t,this.directionMap=new Map,this.distanceMap=new Map}solve(t){this.preSolve(t),t=t.filter(r=>!r.isCanceled());let i;switch(this.config.contactSolveBias){case fs.HorizontalFirst:{i=Ch;break}case fs.VerticalFirst:{i=$a;break}default:i=ac}t.sort((r,l)=>{const c=this.directionMap.get(r.id),g=this.directionMap.get(l.id),m=this.distanceMap.get(r.id),w=this.distanceMap.get(l.id);return i[c]-i[g]||m-w});for(const r of t)this.solvePosition(r),this.solveVelocity(r);return this.postSolve(t),t}preSolve(t){for(const r of t){if(Math.abs(r.mtv.x)<1e-4&&Math.abs(r.mtv.y)<1e-4){r.cancel();continue}const l=Xt.fromDirection(r.mtv),c=r.mtv.negate(),g=r.colliderA.worldPos.squareDistance(r.colliderB.worldPos);this.distanceMap.set(r.id,g),this.directionMap.set(r.id,l===Xt.Left||l===Xt.Right?"horizontal":"vertical"),r.colliderA.events.emit("precollision",new Ls(r.colliderA,r.colliderB,l,c,r)),r.colliderB.events.emit("precollision",new Ls(r.colliderB,r.colliderA,Xt.getOpposite(l),c.negate(),r))}}postSolve(t){var i,r;for(const l of t){if(l.isCanceled())continue;const c=l.colliderA,g=l.colliderB,m=(i=c.owner)===null||i===void 0?void 0:i.get(Lt),w=(r=g.owner)===null||r===void 0?void 0:r.get(Lt);if(m&&w&&(m.collisionType===Mt.Passive||w.collisionType===Mt.Passive))continue;const C=Xt.fromDirection(l.mtv),A=l.mtv.negate();l.colliderA.events.emit("postcollision",new Ms(l.colliderA,l.colliderB,C,A,l)),l.colliderB.events.emit("postcollision",new Ms(l.colliderB,l.colliderA,Xt.getOpposite(C),A.negate(),l))}}solvePosition(t){var i,r;if(!t.colliderA.bounds.overlaps(t.colliderB.bounds,1e-4)){t.cancel();return}if(Math.abs(t.mtv.x)<1e-4&&Math.abs(t.mtv.y)<1e-4){t.cancel();return}let c=t.mtv;const g=t.colliderA,m=t.colliderB,w=(i=g.owner)===null||i===void 0?void 0:i.get(Lt),C=(r=m.owner)===null||r===void 0?void 0:r.get(Lt);if(w&&C){if(w.collisionType===Mt.Passive||C.collisionType===Mt.Passive)return;w.collisionType===Mt.Active&&C.collisionType===Mt.Active&&(c=c.scale(.5)),w.collisionType===Mt.Active&&(w.globalPos.x-=c.x,w.globalPos.y-=c.y,g.update(w.transform.get())),C.collisionType===Mt.Active&&(C.globalPos.x+=c.x,C.globalPos.y+=c.y,m.update(C.transform.get()))}}solveVelocity(t){var i,r;if(t.isCanceled())return;const l=t.colliderA,c=t.colliderB,g=(i=l.owner)===null||i===void 0?void 0:i.get(Lt),m=(r=c.owner)===null||r===void 0?void 0:r.get(Lt);if(g&&m){if(g.collisionType===Mt.Passive||m.collisionType===Mt.Passive)return;const w=t.normal,C=w.negate();if(g.collisionType===Mt.Active&&g.vel.normalize().dot(C)<0){const A=w.scale(w.dot(g.vel.negate()));g.vel=g.vel.add(A)}if(m.collisionType===Mt.Active&&m.vel.normalize().dot(w)<0){const A=C.scale(C.dot(m.vel.negate()));m.vel=m.vel.add(A)}}}}class zr{constructor(t,i,r){this.point=t,this.local=i,this.contact=r,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new D(0,0),this.bToContact=new D(0,0),this.originalVelocityAndRestitution=0,this.update()}update(){var t,i;const r=(t=this.contact.colliderA.owner)===null||t===void 0?void 0:t.get(Lt),l=(i=this.contact.colliderB.owner)===null||i===void 0?void 0:i.get(Lt);if(r&&l){const c=this.contact.normal,g=this.contact.tangent;this.aToContact=this.point.sub(r.globalPos),this.bToContact=this.point.sub(l.globalPos);const m=this.aToContact.cross(c),w=this.bToContact.cross(c);this.normalMass=r.inverseMass+l.inverseMass+r.inverseInertia*m*m+l.inverseInertia*w*w;const C=this.aToContact.cross(g),A=this.bToContact.cross(g);this.tangentMass=r.inverseMass+l.inverseMass+r.inverseInertia*C*C+l.inverseInertia*A*A}return this}getRelativeVelocity(){var t,i;const r=(t=this.contact.colliderA.owner)===null||t===void 0?void 0:t.get(Lt),l=(i=this.contact.colliderB.owner)===null||i===void 0?void 0:i.get(Lt);if(r&&l){const c=r.vel.add(D.cross(r.angularVelocity,this.aToContact));return l.vel.add(D.cross(l.angularVelocity,this.bToContact)).sub(c)}return D.Zero}}class rl{constructor(t){this.config=t,this.lastFrameContacts=new Map,this.idToContactConstraint=new Map}getContactConstraints(t){var i;return(i=this.idToContactConstraint.get(t))!==null&&i!==void 0?i:[]}solve(t){return this.preSolve(t),t=t.filter(i=>!i.isCanceled()),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}preSolve(t){var i,r,l;for(const m of t){if(Math.abs(m.mtv.x)<1e-4&&Math.abs(m.mtv.y)<1e-4){m.cancel();continue}const w=Xt.fromDirection(m.mtv);m.colliderA.events.emit("precollision",new Ls(m.colliderA,m.colliderB,w,m.mtv,m)),m.colliderA.events.emit("beforecollisionresolve",new Wa(m.colliderA,m.colliderB,w,m.mtv,m)),m.colliderB.events.emit("precollision",new Ls(m.colliderB,m.colliderA,Xt.getOpposite(w),m.mtv.negate(),m)),m.colliderB.events.emit("beforecollisionresolve",new Wa(m.colliderB,m.colliderA,Xt.getOpposite(w),m.mtv.negate(),m)),m.matchAwake()}const g=Array.from(this.idToContactConstraint.keys());for(const m of t){const w=g.indexOf(m.id);w>-1&&g.splice(w,1);const C=(i=this.idToContactConstraint.get(m.id))!==null&&i!==void 0?i:[];let A=0;const T=m.colliderA.owner.get(Lt),M=m.colliderB.owner.get(Lt);if(T&&M)for(const z of m.points){const W=m.normal,Z=m.tangent,st=z.sub(T.globalPos),q=z.sub(M.globalPos),Q=st.cross(W),ot=q.cross(W),et=T.inverseMass+M.inverseMass+T.inverseInertia*Q*Q+M.inverseInertia*ot*ot,_t=st.cross(Z),Nt=q.cross(Z),at=T.inverseMass+M.inverseMass+T.inverseInertia*_t*_t+M.inverseInertia*Nt*Nt;C[A]&&((l=(r=C[A])===null||r===void 0?void 0:r.point)===null||l===void 0?void 0:l.squareDistance(z))<4?(C[A].point=z,C[A].local=m.localPoints[A]):C[A]=new zr(z,m.localPoints[A],m),C[A].aToContact=st,C[A].bToContact=q,C[A].normalMass=1/et,C[A].tangentMass=1/at;const Rt=T.bounciness>M.bounciness?T.bounciness:M.bounciness,we=m.normal.dot(C[A].getRelativeVelocity());C[A].originalVelocityAndRestitution=0,we<-.1&&(C[A].originalVelocityAndRestitution=-Rt*we),A++}this.idToContactConstraint.set(m.id,C)}for(const m of g)this.idToContactConstraint.delete(m);if(this.config.warmStart)this.warmStart(t);else for(const m of t){const w=this.getContactConstraints(m.id);for(const C of w)C.normalImpulse=0,C.tangentImpulse=0}}postSolve(t){for(const i of t){const r=i.colliderA.owner.get(Lt),l=i.colliderB.owner.get(Lt);if(r&&l){if(r.collisionType===Mt.Passive||l.collisionType===Mt.Passive)continue;r.updateMotion(),l.updateMotion()}const c=Xt.fromDirection(i.mtv);i.colliderA.events.emit("postcollision",new Ms(i.colliderA,i.colliderB,c,i.mtv,i)),i.colliderA.events.emit("aftercollisionresolve",new Ro(i.colliderA,i.colliderB,c,i.mtv,i)),i.colliderB.events.emit("postcollision",new Ms(i.colliderB,i.colliderA,Xt.getOpposite(c),i.mtv.negate(),i)),i.colliderB.events.emit("aftercollisionresolve",new Ro(i.colliderB,i.colliderA,Xt.getOpposite(c),i.mtv.negate(),i))}this.lastFrameContacts.clear();for(const i of t)this.lastFrameContacts.set(i.id,i)}warmStart(t){var i,r,l;for(const c of t){const g=(i=c.colliderA.owner)===null||i===void 0?void 0:i.get(Lt),m=(r=c.colliderB.owner)===null||r===void 0?void 0:r.get(Lt);if(g&&m){const w=(l=this.idToContactConstraint.get(c.id))!==null&&l!==void 0?l:[];for(const C of w)if(this.config.warmStart){const A=c.normal.scale(C.normalImpulse),T=c.tangent.scale(C.tangentImpulse),M=A.add(T);g.applyImpulse(C.point,M.negate()),m.applyImpulse(C.point,M)}else C.normalImpulse=0,C.tangentImpulse=0}}}solvePosition(t){var i,r,l;for(let c=0;c<this.config.positionIterations;c++)for(const g of t){const m=(i=g.colliderA.owner)===null||i===void 0?void 0:i.get(Lt),w=(r=g.colliderB.owner)===null||r===void 0?void 0:r.get(Lt);if(m&&w){if(m.collisionType===Mt.Passive||w.collisionType===Mt.Passive)continue;const C=(l=this.idToContactConstraint.get(g.id))!==null&&l!==void 0?l:[];for(const A of C){const T=g.normal,M=xn.FindContactSeparation(g,A.local),z=this.config.steeringFactor,W=-5,Z=this.config.slop,st=G(z*(M+Z),W,0),q=T.scale(-st*A.normalMass);if(m.collisionType===Mt.Active){const Q=q.negate().scale(m.inverseMass);m.limitDegreeOfFreedom.includes(Si.X)&&(Q.x=0),m.limitDegreeOfFreedom.includes(Si.Y)&&(Q.y=0),m.globalPos=m.globalPos.add(Q),m.limitDegreeOfFreedom.includes(Si.Rotation)||(m.rotation-=A.aToContact.cross(q)*m.inverseInertia)}if(w.collisionType===Mt.Active){const Q=q.scale(w.inverseMass);w.limitDegreeOfFreedom.includes(Si.X)&&(Q.x=0),w.limitDegreeOfFreedom.includes(Si.Y)&&(Q.y=0),w.globalPos=w.globalPos.add(Q),w.limitDegreeOfFreedom.includes(Si.Rotation)||(w.rotation+=A.bToContact.cross(q)*w.inverseInertia)}}}}}solveVelocity(t){var i,r,l;for(let c=0;c<this.config.velocityIterations;c++)for(const g of t){const m=(i=g.colliderA.owner)===null||i===void 0?void 0:i.get(Lt),w=(r=g.colliderB.owner)===null||r===void 0?void 0:r.get(Lt);if(m&&w){if(m.collisionType===Mt.Passive||w.collisionType===Mt.Passive)continue;const C=Math.min(m.friction,w.friction),A=(l=this.idToContactConstraint.get(g.id))!==null&&l!==void 0?l:[];for(const T of A){let W=-T.getRelativeVelocity().dot(g.tangent)*T.tangentMass;const Z=C*T.normalImpulse,st=G(T.tangentImpulse+W,-Z,Z);W=st-T.tangentImpulse,T.tangentImpulse=st;const q=g.tangent.scale(W);m.applyImpulse(T.point,q.negate()),w.applyImpulse(T.point,q)}for(const T of A){const z=T.getRelativeVelocity().dot(g.normal);let W=-T.normalMass*(z-T.originalVelocityAndRestitution);const Z=Math.max(T.normalImpulse+W,0);W=Z-T.normalImpulse,T.normalImpulse=Z;const st=g.normal.scale(W);m.applyImpulse(T.point,st.negate()),w.applyImpulse(T.point,st)}}}}}class P extends ri{get _processor(){return this._physics.collisionProcessor}constructor(t,i){super(),this._physics=i,this.systemType=mi.Update,this.priority=Ui.Higher,this._configDirty=!1,this._lastFrameContacts=new Map,this._currentFrameContacts=new Map,this._arcadeSolver=new Ur(i.config.arcade),this._realisticSolver=new rl(i.config.realistic),this._physics.$configUpdate.subscribe(()=>this._configDirty=!0),this._trackCollider=r=>this._processor.track(r),this._untrackCollider=r=>this._processor.untrack(r),this.query=t.query([yt,Bt,de]),this.query.entityAdded$.subscribe(r=>{const l=r.get(de);l.$colliderAdded.subscribe(this._trackCollider),l.$colliderRemoved.subscribe(this._untrackCollider);const c=l.get();c&&this._processor.track(c)}),this.query.entityRemoved$.subscribe(r=>{const l=r.get(de),c=l.get();l&&c&&this._processor.untrack(c)})}initialize(t,i){this._engine=i.engine}update(t){var i,r,l,c;if(!this._physics.config.enabled)return;let g=[];for(const A of this.query.entities){const T=A.get(de),M=T==null?void 0:T.get();if(T&&(!((i=T.owner)===null||i===void 0)&&i.active)&&M)if(T.update(),M instanceof ei){const z=M.getColliders();M.compositeStrategy||(M.compositeStrategy=this._physics.config.colliders.compositeStrategy),g=g.concat(z)}else g.push(M)}this._processor.update(g);const m=this._processor.broadphase(g,t);this._currentFrameContacts.clear();let w=this._processor.narrowphase(m,(c=(l=(r=this._engine)===null||r===void 0?void 0:r.debug)===null||l===void 0?void 0:l.stats)===null||c===void 0?void 0:c.currFrame);w=this.getSolver().solve(w);for(const A of w){if(A.isCanceled())continue;const T=A.id.indexOf("|");if(T>0){const M=A.id.substring(T+1);this._currentFrameContacts.set(M,A)}else this._currentFrameContacts.set(A.id,A)}this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts);for(const A of this.query.entities){const T=A.get(de);T&&T.processColliderRemoval()}}getSolver(){return this._configDirty&&(this._configDirty=!1,this._arcadeSolver=new Ur(this._physics.config.arcade),this._realisticSolver=new rl(this._physics.config.realistic)),this._physics.config.solver===$i.Realistic?this._realisticSolver:this._arcadeSolver}debug(t){this._processor.debug(t)}runContactStartEnd(){for(const[t,i]of this._currentFrameContacts)if(!this._lastFrameContacts.has(t)){const r=i.colliderA,l=i.colliderB,c=Xt.fromDirection(i.mtv),g=Xt.getOpposite(c);r.events.emit("collisionstart",new Io(r,l,c,i)),r.events.emit("contactstart",new za(r,l,c,i)),l.events.emit("collisionstart",new Io(l,r,g,i)),l.events.emit("contactstart",new za(l,r,g,i))}for(const[t,i]of this._lastFrameContacts)if(!this._currentFrameContacts.has(t)){const r=i.colliderA,l=i.colliderB,c=Xt.fromDirection(i.mtv),g=Xt.getOpposite(c);r.events.emit("collisionend",new Do(r,l,c,i)),r.events.emit("contactend",new Ha(r,l,c,i)),l.events.emit("collisionend",new Do(l,r,g,i)),l.events.emit("contactend",new Ha(l,r,g,i))}}}function ur(f){return class extends f{assign(t){for(const i in t)typeof this[i]!="function"&&(this[i]=t[i])}constructor(...t){super(...t),t.filter(function(r){return r!==void 0}).length===1&&t[0]&&typeof t[0]=="object"&&!(t[0]instanceof Array)&&this.assign(t[0])}}}var ms;(function(f){f[f.Circle=0]="Circle",f[f.Rectangle=1]="Rectangle"})(ms||(ms={}));class on extends ni{constructor(t,i,r,l,c,g,m,w,C,A,T){super(),this.position=new D(0,0),this.velocity=new D(0,0),this.acceleration=new D(0,0),this.particleRotationalVelocity=0,this.currentRotation=0,this.focus=null,this.focusAccel=0,this.opacity=1,this.beginColor=nt.White,this.endColor=nt.White,this.life=300,this.fadeFlag=!1,this._rRate=1,this._gRate=1,this._bRate=1,this._aRate=0,this._currentColor=nt.White,this.emitter=null,this.particleSize=5,this.particleSprite=null,this.sizeRate=0,this.elapsedMultiplier=0,this.visible=!0,this.isOffscreen=!1;let M=t;if(M&&!(t instanceof wc)){const z=t;M=z.emitter,i=z.life,r=z.opacity,c=z.endColor,l=z.beginColor,g=z.position,m=z.velocity,w=z.acceleration,C=z.startSize,A=z.endSize,T=z.particleSprite}if(this.emitter=M,this.life=i||this.life,this.opacity=r||this.opacity,this.endColor=c||this.endColor.clone(),this.beginColor=l||this.beginColor.clone(),this._currentColor=this.beginColor.clone(),this.particleSprite=T,this.emitter.particleTransform===Hr.Global){const z=this.emitter.transform.globalPos;this.position=(g||this.position).add(z),this.velocity=(m||this.velocity).rotate(this.emitter.transform.globalRotation)}else this.velocity=m||this.velocity,this.position=g||this.position;this.acceleration=w||this.acceleration,this._rRate=(this.endColor.r-this.beginColor.r)/this.life,this._gRate=(this.endColor.g-this.beginColor.g)/this.life,this._bRate=(this.endColor.b-this.beginColor.b)/this.life,this._aRate=this.opacity/this.life,this.startSize=C||0,this.endSize=A||0,this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize),this.addComponent(this.transform=new yt),this.addComponent(this.graphics=new Ge),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=j(1,1),this.transform.z=this.emitter.z,this.particleSprite?(this.graphics.opacity=this.opacity,this.graphics.use(this.particleSprite)):(this.graphics.localBounds=mt.fromDimension(this.particleSize,this.particleSize,D.Half),this.graphics.onPostDraw=z=>{z.save(),this.graphics.opacity=this.opacity;const W=this._currentColor.clone();W.a=1,z.debug.drawPoint(j(0,0),{color:W,size:this.particleSize}),z.restore()})}kill(){this.emitter.removeParticle(this)}update(t,i){if(this.life=this.life-i,this.elapsedMultiplier=this.elapsedMultiplier+i,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=G(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=G(this.sizeRate*i+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=G(this._currentColor.r+this._rRate*i,0,255),this._currentColor.g=G(this._currentColor.g+this._gRate*i,0,255),this._currentColor.b=G(this._currentColor.b+this._bRate*i,0,255),this._currentColor.a=G(this.opacity,1e-4,1),this.focus){const r=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(i/1e3);this.velocity=this.velocity.add(r)}else this.velocity=this.velocity.add(this.acceleration.scale(i/1e3));this.position=this.position.add(this.velocity.scale(i/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*i/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=j(1,1),this.graphics.opacity=this.opacity}}class jt extends ur(on){constructor(t,i,r,l,c,g,m,w,C,A,T){super(t,i,r,l,c,g,m,w,C,A,T)}}var Hr;(function(f){f.Global="global",f.Local="local"})(Hr||(Hr={}));class wc extends Ei{get opacity(){return this.graphics.opacity}set opacity(t){this.graphics.opacity=t}get particleSprite(){return this._sprite}set particleSprite(t){t&&(this._sprite=t)}constructor(t){var i,r;super({width:(i=t.width)!==null&&i!==void 0?i:0,height:(r=t.height)!==null&&r!==void 0?r:0}),this._particlesToEmit=0,this.numParticles=0,this.isEmitting=!0,this.particles=[],this.deadParticles=[],this.minVel=0,this.maxVel=0,this.acceleration=new D(0,0),this.minAngle=0,this.maxAngle=0,this.emitRate=1,this.particleLife=2e3,this.fadeFlag=!1,this.focus=null,this.focusAccel=null,this.startSize=null,this.endSize=null,this.minSize=5,this.maxSize=5,this.beginColor=nt.White,this.endColor=nt.White,this._sprite=null,this.emitterType=ms.Rectangle,this.radius=0,this.particleRotationalVelocity=0,this.randomRotation=!1,this.particleTransform=Hr.Global;const{x:l,y:c,z:g,pos:m,isEmitting:w,minVel:C,maxVel:A,acceleration:T,minAngle:M,maxAngle:z,emitRate:W,particleLife:Z,opacity:st,fadeFlag:q,focus:Q,focusAccel:ot,startSize:et,endSize:_t,minSize:Nt,maxSize:at,beginColor:Rt,endColor:we,particleSprite:_e,emitterType:Ii,radius:Di,particleRotationalVelocity:vi,particleTransform:Fi,randomRotation:hi,random:ui}={...t};this.pos=m??j(l??0,c??0),this.z=g??0,this.isEmitting=w??this.isEmitting,this.minVel=C??this.minVel,this.maxVel=A??this.maxVel,this.acceleration=T??this.acceleration,this.minAngle=M??this.minAngle,this.maxAngle=z??this.maxAngle,this.emitRate=W??this.emitRate,this.particleLife=Z??this.particleLife,this.opacity=st??this.opacity,this.fadeFlag=q??this.fadeFlag,this.focus=Q??this.focus,this.focusAccel=ot??this.focusAccel,this.startSize=et??this.startSize,this.endSize=_t??this.endSize,this.minSize=Nt??this.minSize,this.maxSize=at??this.maxSize,this.beginColor=Rt??this.beginColor,this.endColor=we??this.endColor,this.particleSprite=_e??this.particleSprite,this.emitterType=Ii??this.emitterType,this.radius=Di??this.radius,this.particleRotationalVelocity=vi??this.particleRotationalVelocity,this.randomRotation=hi??this.randomRotation,this.particleTransform=Fi??this.particleTransform,this.body.collisionType=Mt.PreventCollision,this.random=ui??new L}removeParticle(t){this.deadParticles.push(t)}emitParticles(t){var i;for(let r=0;r<t;r++){const l=this._createParticle();this.particles.push(l),!((i=this===null||this===void 0?void 0:this.scene)===null||i===void 0)&&i.world&&(this.particleTransform===Hr.Global?this.scene.world.add(l):this.addChild(l))}}clearParticles(){this.particles.length=0}_createParticle(){let t=0,i=0;const r=K(this.minAngle,this.maxAngle,this.random),l=K(this.minVel,this.maxVel,this.random),c=this.startSize||K(this.minSize,this.maxSize,this.random),g=l*Math.cos(r),m=l*Math.sin(r);if(this.emitterType===ms.Rectangle)t=K(0,this.width,this.random),i=K(0,this.height,this.random);else if(this.emitterType===ms.Circle){const C=K(0,this.radius,this.random);t=C*Math.cos(r),i=C*Math.sin(r)}const w=new jt(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new D(t,i),new D(g,m),this.acceleration,this.startSize,this.endSize,this.particleSprite);return w.fadeFlag=this.fadeFlag,w.particleSize=c,w.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(w.currentRotation=K(0,Math.PI*2,this.random)),this.focus&&(w.focus=this.focus.add(new D(this.pos.x,this.pos.y)),w.focusAccel=this.focusAccel),w}update(t,i){var r;super.update(t,i),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(i/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(let l=0;l<this.deadParticles.length;l++)Tt(this.deadParticles[l],this.particles),!((r=this===null||this===void 0?void 0:this.scene)===null||r===void 0)&&r.world&&this.scene.world.remove(this.deadParticles[l],!1);this.deadParticles.length=0}}function tp(f,t,i,r){if(f.parent!==t.parent){const A=f.clone(),T=f.globalPos.clone(),M=f.globalScale.clone(),z=f.globalRotation;A.parent=t.parent,A.globalPos=T,A.globalScale=M,A.globalRotation=z,f=A}let l=t.pos,c=t.scale,g=t.rotation;l=t.pos.scale(i).add(f.pos.scale(1-i)),c=t.scale.scale(i).add(f.scale.scale(1-i));const m=(1-i)*Math.cos(f.rotation)+i*Math.cos(t.rotation),w=(1-i)*Math.sin(f.rotation)+i*Math.sin(t.rotation);g=Math.atan2(w,m);const C=r??new Ye;return C.setTransform(l,g,c),C}class js extends ri{get sortedTransforms(){return this._sortedTransforms}constructor(t){super(),this.world=t,this.systemType=mi.Draw,this.priority=Ui.Average,this._token=0,this._sortedTransforms=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0},this._targetInterpolationTransform=new Ye,this.query=this.world.query([yt,Ge]),this.query.entityAdded$.subscribe(i=>{const r=i.get(yt);this._sortedTransforms.push(r),r.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}),this.query.entityRemoved$.subscribe(i=>{const r=i.get(yt);r.zIndexChanged$.unsubscribe(this._zIndexUpdate);const l=this._sortedTransforms.indexOf(r);l>-1&&this._sortedTransforms.splice(l,1)})}initialize(t,i){this._camera=i.camera,this._engine=i.engine}preupdate(){this._graphicsContext=this._engine.graphicsContext,this._zHasChanged&&(this._sortedTransforms.sort((t,i)=>t.z-i.z),this._zHasChanged=!1)}update(t){this._token++;let i;re.checkAndClearCache(),this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext);for(const r of this._sortedTransforms){const l=r.owner;if(l.hasTag("ex.offscreen")||(i=l.get(Ge),!i.visible))continue;i.onPreTransformDraw&&i.onPreTransformDraw(this._graphicsContext,t),l.events.emit("pretransformdraw",new hh(this._graphicsContext,t,l)),r.coordPlane===Me.Screen&&this._graphicsContext.restore(),this._graphicsContext.save(),r.coordPlane===Me.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),i.update(t,this._token);const c=l.get(tl);if(c){const m=D.One.sub(c.parallaxFactor),w=this._camera.drawPos.scale(m);this._graphicsContext.translate(w.x,w.y)}this._applyTransform(l),i.material&&(this._graphicsContext.material=i.material),i.onPreDraw&&i.onPreDraw(this._graphicsContext,t),l.events.emit("predraw",new hs(this._graphicsContext,t,l));const g=l instanceof jt?l.opacity:1;this._graphicsContext.opacity*=i.opacity*g,this._drawGraphicsComponent(i,r),i.onPostDraw&&i.onPostDraw(this._graphicsContext,t),l.events.emit("postdraw",new ir(this._graphicsContext,t,l)),this._graphicsContext.restore(),r.coordPlane===Me.Screen&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext)),i.onPostTransformDraw&&i.onPostTransformDraw(this._graphicsContext,t),l.events.emit("posttransformdraw",new ka(this._graphicsContext,t,l))}this._graphicsContext.restore()}_drawGraphicsComponent(t,i){var r,l;if(t.visible){const c=t.flipHorizontal,g=t.flipVertical,m=t.current,w=(r=t.currentOptions)!==null&&r!==void 0?r:{};if(m){let C=t.anchor,A=t.offset,T=1,M=1;w!=null&&w.anchor&&(C=w.anchor),w!=null&&w.offset&&(A=w.offset);const z=i.globalScale;T*=m.scale.x*z.x,M*=m.scale.y*z.y;const W=-m.width*C.x+A.x*T,Z=-m.height*C.y+A.y*M,st=m.flipHorizontal,q=m.flipVertical;if((c||g)&&(m.flipHorizontal=c?!st:st,m.flipVertical=g?!q:q),m==null||m.draw(this._graphicsContext,W,Z),(c||g)&&(m.flipHorizontal=st,m.flipVertical=q),!((l=this._engine)===null||l===void 0)&&l.isDebug&&this._engine.debug.graphics.showBounds){const Q=j(W,Z);if(m instanceof kr)for(const ot of m.members){let et,_t=D.Zero;ot instanceof oe?et=ot:(et=ot.graphic,_t=ot.offset),m.useAnchor?et==null||et.localBounds.translate(Q.add(_t)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor):et==null||et.localBounds.translate(_t).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}else m==null||m.localBounds.translate(Q).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}}_applyTransform(t){const i=t.getAncestors();for(const r of i){const l=r==null?void 0:r.get(yt),c=r==null?void 0:r.get(Lt);let g=l.get();if(c&&this._engine.fixedUpdateFps&&c.__oldTransformCaptured&&c.enableFixedUpdateInterpolate){const m=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps);g=tp(c.oldTransform,l.get(),m,this._targetInterpolationTransform)}l&&(this._graphicsContext.z=l.z,this._graphicsContext.translate(g.pos.x,g.pos.y),this._graphicsContext.scale(g.scale.x,g.scale.y),this._graphicsContext.rotate(g.rotation))}}}class xc extends ri{constructor(t){super(),this.world=t,this.systemType=mi.Draw,this.priority=Ui.Lowest,this.query=this.world.query([yt])}initialize(t,i){this._graphicsContext=i.engine.graphicsContext,this._camera=i.camera,this._engine=i.engine,this._collisionSystem=t.systemManager.get(P)}update(){var t;if(!this._engine.isDebug)return;const i=this._engine.debug.filter;let r,l;const c=this._engine.debug.entity;let g;const m=this._engine.debug.transform;let w;const C=this._engine.debug.motion;let A;const T=this._engine.debug.collider,M=this._engine.debug.physics;let z;const W=this._engine.debug.graphics;let Z,st;const q=this._engine.debug.body,Q=this._engine.debug.camera;for(const ot of this.query.entities){if(ot.hasTag("offscreen")||ot instanceof jt||i.useFilter&&(!(i.ids.length===0||i.ids.includes(ot.id))||!(i.nameQuery===""||ot.name.includes(i.nameQuery))))continue;let et=D.Zero;const _t=j(0,16);if(r=ot.id,l=ot.name,g=ot.get(yt),this._pushCameraTransform(g),this._graphicsContext.save(),g.coordPlane===Me.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),this._graphicsContext.z=m.debugZIndex,this._applyTransform(ot),g&&((m.showAll||m.showPosition)&&this._graphicsContext.debug.drawPoint(D.Zero,{size:4,color:m.positionColor}),(m.showAll||m.showPositionLabel)&&(this._graphicsContext.debug.drawText(`pos${g.pos.toString(2)}`,et),et=et.add(_t)),(m.showAll||m.showZIndex)&&(this._graphicsContext.debug.drawText(`z(${g.z.toFixed(1)})`,et),et=et.add(_t)),(c.showAll||c.showId)&&(this._graphicsContext.debug.drawText(`id(${r}) ${ot.parent?"child of id("+((t=ot.parent)===null||t===void 0?void 0:t.id)+")":""}`,et),et=et.add(_t)),(c.showAll||c.showName)&&(this._graphicsContext.debug.drawText(`name(${l})`,et),et=et.add(_t)),(m.showAll||m.showRotation)&&(this._graphicsContext.drawLine(D.Zero,D.fromAngle(g.rotation).scale(50).add(D.Zero),m.rotationColor,2),this._graphicsContext.debug.drawText(`rot deg(${B(g.rotation).toFixed(2)})`,et),et=et.add(_t)),(m.showAll||m.showScale)&&this._graphicsContext.drawLine(D.Zero,g.scale.add(D.Zero),m.scaleColor,2)),z=ot.get(Ge),z&&(W.showAll||W.showBounds)&&z.localBounds.draw(this._graphicsContext,W.boundsColor),Z=ot.get(el),Z&&(Z.useTransform||this._graphicsContext.restore(),Z.draw(this._graphicsContext,this._engine.debug),Z.useTransform||(this._graphicsContext.save(),this._applyTransform(ot))),st=ot.get(Lt),st&&((q.showAll||q.showCollisionGroup)&&(this._graphicsContext.debug.drawText(`collision group(${st.group.name})`,et),et=et.add(_t)),(q.showAll||q.showCollisionType)&&(this._graphicsContext.debug.drawText(`collision type(${st.collisionType})`,et),et=et.add(_t)),(q.showAll||q.showMass)&&(this._graphicsContext.debug.drawText(`mass(${st.mass})`,et),et=et.add(_t)),(q.showAll||q.showMotion)&&(this._graphicsContext.debug.drawText(`motion(${st.sleepMotion})`,et),et=et.add(_t)),(q.showAll||q.showSleeping)&&(this._graphicsContext.debug.drawText(`sleeping(${st.canSleep?st.sleeping:"cant sleep"})`,et),et=et.add(_t))),this._graphicsContext.restore(),this._graphicsContext.save(),g.coordPlane===Me.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),this._graphicsContext.z=m.debugZIndex,w=ot.get(Bt),w&&((C.showAll||C.showVelocity)&&(this._graphicsContext.debug.drawText(`vel${w.vel.toString(2)}`,et.add(g.globalPos)),this._graphicsContext.drawLine(g.globalPos,g.globalPos.add(w.vel),C.velocityColor,2),et=et.add(_t)),(C.showAll||C.showAcceleration)&&this._graphicsContext.drawLine(g.globalPos,g.globalPos.add(w.acc),C.accelerationColor,2)),A=ot.get(de),A){const Nt=A.get();if((T.showAll||T.showGeometry)&&Nt&&Nt.debug(this._graphicsContext,T.geometryColor,{lineWidth:T.geometryLineWidth,pointSize:T.geometryPointSize}),T.showAll||T.showBounds){if(Nt instanceof ei){const at=Nt.getColliders();for(const Rt of at){const we=Rt.bounds,_e=j(we.left,we.top);this._graphicsContext.debug.drawRect(_e.x,_e.y,we.width,we.height,{color:T.boundsColor}),(T.showAll||T.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${Rt.owner.id})`,_e)}A.bounds.draw(this._graphicsContext,T.boundsColor)}else if(Nt){const at=A.bounds,Rt=j(at.left,at.top);this._graphicsContext.debug.drawRect(Rt.x,Rt.y,at.width,at.height,{color:T.boundsColor}),(T.showAll||T.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${A.owner.id})`,Rt)}}}this._graphicsContext.restore(),this._popCameraTransform(g)}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(M.showAll||M.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),M.showAll||M.showCollisionContacts||M.showCollisionNormals)for(const[ot,et]of this._engine.debug.stats.currFrame.physics.contacts){if(M.showAll||M.showCollisionContacts)for(const _t of et.points)this._graphicsContext.debug.drawPoint(_t,{size:M.contactSize,color:M.collisionContactColor});if(M.showAll||M.showCollisionNormals)for(const _t of et.points)this._graphicsContext.debug.drawLine(_t,et.normal.scale(30).add(_t),{color:M.collisionNormalColor})}this._graphicsContext.restore(),Q&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(Q.showAll||Q.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,Q.focusColor),(Q.showAll||Q.showZoom)&&this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`,this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}postupdate(t,i){this._engine.isDebug&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext),je.flush(this._graphicsContext),this._graphicsContext.restore())}_applyTransform(t){const i=t.getAncestors();for(const r of i){const l=r==null?void 0:r.get(yt);l&&(this._graphicsContext.translate(l.pos.x,l.pos.y),this._graphicsContext.scale(l.scale.x,l.scale.y),this._graphicsContext.rotate(l.rotation))}}_pushCameraTransform(t){t.coordPlane===Me.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}_popCameraTransform(t){t.coordPlane===Me.World&&this._graphicsContext.restore()}}class ol extends ri{constructor(t){super(),this.world=t,this.systemType=mi.Update,this.priority=Ui.Higher,this.overrideUseColliderShape=!1,this.overrideUseGraphicsBounds=!1,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map,this._sortedTransforms=[],this._sortedEntities=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0},this.query=this.world.query([yt,Ai]),this.query.entityAdded$.subscribe(i=>{const r=i.get(yt);this._sortedTransforms.push(r),this._sortedEntities.push(r.owner),r.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}),this.query.entityRemoved$.subscribe(i=>{const r=i.get(yt);r.zIndexChanged$.unsubscribe(this._zIndexUpdate);const l=this._sortedTransforms.indexOf(r);l>-1&&(this._sortedTransforms.splice(l,1),this._sortedEntities.splice(l,1))})}initialize(t,i){this._engine=i.engine,this._scene=i}preupdate(){this._receivers=[this._engine.input.pointers,this._scene.input.pointers],this._engineReceiver=this._engine.input.pointers,this._zHasChanged&&(this._sortedTransforms.sort((t,i)=>i.z-t.z),this._sortedEntities=this._sortedTransforms.map(t=>t.owner),this._zHasChanged=!1)}entityCurrentlyUnderPointer(t,i){return this.currentFrameEntityToPointers.has(t.id)&&this.currentFrameEntityToPointers.get(t.id).includes(i)}entityWasUnderPointer(t,i){return this.lastFrameEntityToPointers.has(t.id)&&this.lastFrameEntityToPointers.get(t.id).includes(i)}entered(t,i){return this.entityCurrentlyUnderPointer(t,i)&&!this.lastFrameEntityToPointers.has(t.id)}left(t,i){return!this.currentFrameEntityToPointers.has(t.id)&&this.entityWasUnderPointer(t,i)}addPointerToEntity(t,i){if(!this.currentFrameEntityToPointers.has(t.id)){this.currentFrameEntityToPointers.set(t.id,[i]);return}const r=this.currentFrameEntityToPointers.get(t.id);this.currentFrameEntityToPointers.set(t.id,r.concat(i))}update(){this._processPointerToEntity(this._sortedEntities),this._dispatchEvents(this._sortedEntities),this._receivers.forEach(t=>t.update()),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear(),this._receivers.forEach(t=>t.clear())}_processPointerToEntity(t){var i;let r,l,c,g;const m=this._engineReceiver;for(const w of t){if(r=w.get(yt),g=(i=w.get(Ai))!==null&&i!==void 0?i:new Ai,g.localBounds){const C=g.localBounds.transform(r.get().matrix);for(const[A,T]of m.currentFramePointerCoords.entries())C.contains(r.coordPlane===Me.World?T.worldPos:T.screenPos)&&this.addPointerToEntity(w,A)}if(l=w.get(de),l&&(g.useColliderShape||this.overrideUseColliderShape)){l.update();const C=l.get();if(C)for(const[A,T]of m.currentFramePointerCoords.entries())C.contains(r.coordPlane===Me.World?T.worldPos:T.screenPos)&&this.addPointerToEntity(w,A)}if(c=w.get(Ge),c&&(g.useGraphicsBounds||this.overrideUseGraphicsBounds)){const C=c.localBounds.transform(r.get().matrix);for(const[A,T]of m.currentFramePointerCoords.entries())C.contains(r.coordPlane===Me.World?T.worldPos:T.screenPos)&&this.addPointerToEntity(w,A)}}}_processDownAndEmit(t){const i=this._engineReceiver,r=new Map;for(const l of i.currentFrameDown)l.active&&t.active&&this.entityCurrentlyUnderPointer(t,l.pointerId)&&(t.events.emit("pointerdown",l),i.isDragStart(l.pointerId)&&t.events.emit("pointerdragstart",l)),r.set(l.pointerId,l);return r}_processUpAndEmit(t){const i=this._engineReceiver,r=new Map;for(const l of i.currentFrameUp)l.active&&t.active&&this.entityCurrentlyUnderPointer(t,l.pointerId)&&(t.events.emit("pointerup",l),i.isDragEnd(l.pointerId)&&t.events.emit("pointerdragend",l)),r.set(l.pointerId,l);return r}_processMoveAndEmit(t){const i=this._engineReceiver,r=new Map;for(const l of i.currentFrameMove)l.active&&t.active&&this.entityCurrentlyUnderPointer(t,l.pointerId)&&(t.events.emit("pointermove",l),i.isDragging(l.pointerId)&&t.events.emit("pointerdragmove",l)),r.set(l.pointerId,l);return r}_processEnterLeaveAndEmit(t,i){const r=this._engineReceiver;for(const l of i){if(l.active&&t.active&&this.entered(t,l.pointerId)){t.events.emit("pointerenter",l),r.isDragging(l.pointerId)&&t.events.emit("pointerdragenter",l);break}if(l.active&&t.active&&(this.left(t,l.pointerId)||this.entityCurrentlyUnderPointer(t,l.pointerId)&&l.type==="up")){t.events.emit("pointerleave",l),r.isDragging(l.pointerId)&&t.events.emit("pointerdragleave",l);break}}}_processCancelAndEmit(t){const i=this._engineReceiver;for(const r of i.currentFrameCancel)r.active&&t.active&&this.entityCurrentlyUnderPointer(t,r.pointerId)&&t.events.emit("pointercancel",r)}_processWheelAndEmit(t){const i=this._engineReceiver;for(const r of i.currentFrameWheel)r.active&&t.active&&this.entityCurrentlyUnderPointer(t,0)&&t.events.emit("pointerwheel",r)}_dispatchEvents(t){const i=new Set(this.lastFrameEntityToPointers.keys()),r=new Set(this.currentFrameEntityToPointers.keys()),l=t.filter(w=>i.has(w.id)||r.has(w.id));let c,g,m;for(const w of l){m=this._processDownAndEmit(w),g=this._processUpAndEmit(w),c=this._processMoveAndEmit(w);const C=[...c.values(),...m.values(),...g.values()];this._processEnterLeaveAndEmit(w,C),this._processCancelAndEmit(w),this._processWheelAndEmit(w)}}}class bc extends ri{constructor(t){super(),this.world=t,this.systemType=mi.Update,this.priority=Ui.Higher,this._actions=[],this.query=this.world.query([Mr]),this.query.entityAdded$.subscribe(i=>this._actions.push(i.get(Mr))),this.query.entityRemoved$.subscribe(i=>{const r=i.get(Mr),l=this._actions.indexOf(r);l>-1&&this._actions.splice(l,1)})}update(t){for(const i of this._actions)i.update(t)}}class Xo extends Qe{constructor(t){super(),this.elevation=0,this.columns=t.columns,this.rows=t.rows,this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight}}class Cc extends ri{constructor(t){super(),this.world=t,this.systemType=mi.Update,this.priority=Ui.Lower,this.query=this.world.query([yt,Xo])}update(){let t,i;for(const r of this.query.entities){t=r.get(yt),i=r.get(Xo);const c=Math.max(i.columns*i.tileWidth,i.rows*i.tileHeight)*i.elevation+t.pos.y;t.z=c}}}class Hn extends ri{constructor(t){super(),this.world=t,this.systemType=mi.Draw,this.priority=Ui.Higher,this.query=this.world.query([yt,Ge])}initialize(t,i){this._camera=i.camera,this._screen=i.engine.screen}update(){this._worldBounds=this._screen.getWorldBounds();let t,i,r;for(const l of this.query.entities){i=l.get(Ge),t=l.get(yt),r=l.get(tl);let c;if(r){const m=D.One.sub(r.parallaxFactor);c=this._camera.pos.scale(m)}const g=this._isOffscreen(t,i,c);g&&!l.hasTag("ex.offscreen")&&(l.events.emit("exitviewport",new dh(l)),l.addTag("ex.offscreen")),!g&&l.hasTag("ex.offscreen")&&(l.events.emit("enterviewport",new fh(l)),l.removeTag("ex.offscreen"))}}_isOffscreen(t,i,r){if(t.coordPlane===Me.World){let l=i.localBounds;r&&(l=l.translate(r));const c=l.transform(t.get().matrix);return!this._worldBounds.overlaps(c)}else return!1}}class Sc{get config(){return ss(this._config,t=>{this.$configUpdate.notifyAll(t)})}set config(t){this._config=t,this.$configUpdate.notifyAll(t)}get collisionProcessor(){if(this._configDirty){this._configDirty=!1;const t=this._collisionProcessor.getColliders();this._collisionProcessor=new ko(this._config);for(const i of t)this._collisionProcessor.track(i)}return this._collisionProcessor}constructor(t){this.$configUpdate=new We,this._configDirty=!1,this.config=t,this.$configUpdate.subscribe(i=>{this._configDirty=!0,Lt.updateDefaultPhysicsConfig(i.bodies)}),this._collisionProcessor=new ko(this.config)}rayCast(t,i){return this.collisionProcessor.rayCast(t,i)}}class $o{constructor(){this.events=new b,this.enabled=!1,this.supported=!!navigator.getGamepads,this._gamePadTimeStamps=[0,0,0,0],this._oldPads=[],this._pads=[],this._initSuccess=!1,this._navigator=navigator,this._minimumConfiguration=null,this._enabled=!0}init(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}toggleEnabled(t){this._enabled=t}setMinimumGamepadConfiguration(t){this._enableAndUpdate(),this._minimumConfiguration=t}_enableAndUpdate(){this.enabled||(this.enabled=!0,this.update())}_isGamepadValid(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;const i=t.axes.filter(l=>typeof l!==void 0).length,r=t.buttons.filter(l=>typeof l!==void 0).length;return i>=this._minimumConfiguration.axis&&r>=this._minimumConfiguration.buttons&&t.connected}emit(t,i){this.events.emit(t,i)}on(t,i){return this._enableAndUpdate(),this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this._enableAndUpdate(),this.events.off(t,i)}update(){if(!this.enabled||!this.supported||!this._enabled)return;this.init();const t=this._navigator.getGamepads();for(let i=0;i<t.length;i++){if(t[i])!this.at(i).connected&&this._isGamepadValid(t[i])&&this.events.emit("connect",new ks(i,this.at(i))),this.at(i).connected=!0;else{const w=this.at(i);w.connected&&this.events.emit("disconnect",new Ma(i,w)),w.connected=!1;continue}if(this.at(i).update(),t[i].timestamp&&t[i].timestamp===this._gamePadTimeStamps[i])continue;this._gamePadTimeStamps[i]=t[i].timestamp,this.at(i).navigatorGamepad=t[i];let r,l,c,g,m;for(r in Wr)l=Wr[r],typeof l=="number"&&t[i].buttons[l]&&(m=t[i].buttons[l].value,m!==this._oldPads[i].getButton(l)&&(t[i].buttons[l].pressed?(this.at(i).updateButton(l,m),this.at(i).events.emit("button",new Oa(l,m,this.at(i)))):this.at(i).updateButton(l,0)));for(c in jr)g=jr[c],typeof g=="number"&&(m=t[i].axes[g],m!==this._oldPads[i].getAxes(g)&&(this.at(i).updateAxes(g,m),this.at(i).events.emit("axis",new uh(g,m,this.at(i)))));this._oldPads[i]=this._clonePad(t[i])}}at(t){if(this._enableAndUpdate(),t>=this._pads.length)for(let i=this._pads.length-1,r=t;i<r;i++)this._pads.push(new Yo),this._oldPads.push(new Yo);return this._pads[t]}getValidGamepads(){this._enableAndUpdate();const t=[];for(let i=0;i<this._pads.length;i++)this._isGamepadValid(this.at(i).navigatorGamepad)&&this.at(i).connected&&t.push(this.at(i));return t}count(){return this._pads.filter(t=>t.connected).length}_clonePads(t){const i=[];for(let r=0,l=t.length;r<l;r++)i.push(this._clonePad(t[r]));return i}_clonePad(t){let i,r;const l=new Yo;if(!t)return l;for(i=0,r=t.buttons.length;i<r;i++)t.buttons[i]&&l.updateButton(i,t.buttons[i].value);for(i=0,r=t.axes.length;i<r;i++)l.updateAxes(i,t.axes[i]);return l}}$o.MinAxisMoveThreshold=.05;class Yo{constructor(){this.events=new b,this.connected=!1,this._axes=new Array(4),this._buttons=new Array(16),this._buttonsUp=new Array(16),this._buttonsDown=new Array(16);for(let t=0;t<this._buttons.length;t++)this._buttons[t]=0;for(let t=0;t<this._axes.length;t++)this._axes[t]=0}update(){this._buttonsDown=new Array(16),this._buttonsUp=new Array(16)}isButtonPressed(t,i=1){return this._buttons[t]>=i}isButtonHeld(t,i=1){return this._buttons[t]>=i}wasButtonPressed(t,i=1){return this._buttonsDown[t]>=i}wasButtonReleased(t){return!!this._buttonsUp[t]}getButton(t){return this._buttons[t]}getAxes(t){const i=this._axes[t];return Math.abs(i)<$o.MinAxisMoveThreshold?0:i}updateButton(t,i){i===0&&this._buttons[t]?this._buttonsUp[t]=1:this._buttonsDown[t]=i,this._buttons[t]=i}updateAxes(t,i){this._axes[t]=i}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}var Wr;(function(f){f[f.Face1=0]="Face1",f[f.Face2=1]="Face2",f[f.Face3=2]="Face3",f[f.Face4=3]="Face4",f[f.LeftBumper=4]="LeftBumper",f[f.RightBumper=5]="RightBumper",f[f.LeftTrigger=6]="LeftTrigger",f[f.RightTrigger=7]="RightTrigger",f[f.Select=8]="Select",f[f.Start=9]="Start",f[f.LeftStick=10]="LeftStick",f[f.RightStick=11]="RightStick",f[f.DpadUp=12]="DpadUp",f[f.DpadDown=13]="DpadDown",f[f.DpadLeft=14]="DpadLeft",f[f.DpadRight=15]="DpadRight"})(Wr||(Wr={}));var jr;(function(f){f[f.LeftStickX=0]="LeftStickX",f[f.LeftStickY=1]="LeftStickY",f[f.RightStickX=2]="RightStickX",f[f.RightStickY=3]="RightStickY"})(jr||(jr={}));class Wn{constructor(t){this.inputs=t,this._handlers=new Map}execute(){for(const[t,i]of this._handlers.entries()){const r=t(this.inputs);r&&i(r)}}on(t,i){this._handlers.set(t,i)}}function Ac(){try{const f=()=>{};window.top.addEventListener("blur",f),window.top.removeEventListener("blur",f)}catch{return!0}return!1}var Gr;(function(f){f.Num0="Numpad0",f.Num1="Numpad1",f.Num2="Numpad2",f.Num3="Numpad3",f.Num4="Numpad4",f.Num5="Numpad5",f.Num6="Numpad6",f.Num7="Numpad7",f.Num8="Numpad8",f.Num9="Numpad9",f.NumAdd="NumpadAdd",f.NumSubtract="NumpadSubtract",f.NumMultiply="NumpadMultiply",f.NumDivide="NumpadDivide",f.NumDecimal="NumpadDecimal",f.Numpad0="Numpad0",f.Numpad1="Numpad1",f.Numpad2="Numpad2",f.Numpad3="Numpad3",f.Numpad4="Numpad4",f.Numpad5="Numpad5",f.Numpad6="Numpad6",f.Numpad7="Numpad7",f.Numpad8="Numpad8",f.Numpad9="Numpad9",f.NumpadAdd="NumpadAdd",f.NumpadSubtract="NumpadSubtract",f.NumpadMultiply="NumpadMultiply",f.NumpadDivide="NumpadDivide",f.NumpadDecimal="NumpadDecimal",f.NumLock="NumLock",f.ShiftLeft="ShiftLeft",f.ShiftRight="ShiftRight",f.AltLeft="AltLeft",f.AltRight="AltRight",f.ControlLeft="ControlLeft",f.ControlRight="ControlRight",f.MetaLeft="MetaLeft",f.MetaRight="MetaRight",f.Key0="Digit0",f.Key1="Digit1",f.Key2="Digit2",f.Key3="Digit3",f.Key4="Digit4",f.Key5="Digit5",f.Key6="Digit6",f.Key7="Digit7",f.Key8="Digit8",f.Key9="Digit9",f.Digit0="Digit0",f.Digit1="Digit1",f.Digit2="Digit2",f.Digit3="Digit3",f.Digit4="Digit4",f.Digit5="Digit5",f.Digit6="Digit6",f.Digit7="Digit7",f.Digit8="Digit8",f.Digit9="Digit9",f.F1="F1",f.F2="F2",f.F3="F3",f.F4="F4",f.F5="F5",f.F6="F6",f.F7="F7",f.F8="F8",f.F9="F9",f.F10="F10",f.F11="F11",f.F12="F12",f.A="KeyA",f.B="KeyB",f.C="KeyC",f.D="KeyD",f.E="KeyE",f.F="KeyF",f.G="KeyG",f.H="KeyH",f.I="KeyI",f.J="KeyJ",f.K="KeyK",f.L="KeyL",f.M="KeyM",f.N="KeyN",f.O="KeyO",f.P="KeyP",f.Q="KeyQ",f.R="KeyR",f.S="KeyS",f.T="KeyT",f.U="KeyU",f.V="KeyV",f.W="KeyW",f.X="KeyX",f.Y="KeyY",f.Z="KeyZ",f.KeyA="KeyA",f.KeyB="KeyB",f.KeyC="KeyC",f.KeyD="KeyD",f.KeyE="KeyE",f.KeyF="KeyF",f.KeyG="KeyG",f.KeyH="KeyH",f.KeyI="KeyI",f.KeyJ="KeyJ",f.KeyK="KeyK",f.KeyL="KeyL",f.KeyM="KeyM",f.KeyN="KeyN",f.KeyO="KeyO",f.KeyP="KeyP",f.KeyQ="KeyQ",f.KeyR="KeyR",f.KeyS="KeyS",f.KeyT="KeyT",f.KeyU="KeyU",f.KeyV="KeyV",f.KeyW="KeyW",f.KeyX="KeyX",f.KeyY="KeyY",f.KeyZ="KeyZ",f.Semicolon="Semicolon",f.Quote="Quote",f.Comma="Comma",f.Minus="Minus",f.Period="Period",f.Slash="Slash",f.Equal="Equal",f.BracketLeft="BracketLeft",f.Backslash="Backslash",f.BracketRight="BracketRight",f.Backquote="Backquote",f.Up="ArrowUp",f.Down="ArrowDown",f.Left="ArrowLeft",f.Right="ArrowRight",f.ArrowUp="ArrowUp",f.ArrowDown="ArrowDown",f.ArrowLeft="ArrowLeft",f.ArrowRight="ArrowRight",f.Space="Space",f.Backspace="Backspace",f.Delete="Delete",f.Esc="Escape",f.Escape="Escape",f.Enter="Enter",f.NumpadEnter="NumpadEnter",f.ContextMenu="ContextMenu"})(Gr||(Gr={}));class Vr extends Ut{constructor(t,i,r){super(),this.key=t,this.value=i,this.originalEvent=r}}class Th{constructor(){this.events=new b,this._enabled=!0,this._keys=[],this._keysUp=[],this._keysDown=[],this._releaseAllKeys=t=>{for(const i of this._keys){const r=new Vr(i,t.key,t);this.events.emit("up",r),this.events.emit("release",r)}this._keysUp=Array.from(new Set(this._keys.concat(this._keysUp))),this._keys.length=0},this._handleKeyDown=t=>{if(!this._enabled)return;!t.metaKey&&(this._keys.includes(Gr.MetaLeft)||this._keys.includes(Gr.MetaRight))&&this._releaseAllKeys(t);const i=t.code;if(this._keys.indexOf(i)===-1){this._keys.push(i),this._keysDown.push(i);const r=new Vr(i,t.key,t);this.events.emit("down",r),this.events.emit("press",r)}},this._handleKeyUp=t=>{if(!this._enabled)return;const i=t.code,r=this._keys.indexOf(i);this._keys.splice(r,1),this._keysUp.push(i);const l=new Vr(i,t.key,t);this.events.emit("up",l),this.events.emit("release",l),t.key==="Meta"&&this._releaseAllKeys(t)}}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}init(t){let{global:i}=t;const{grabWindowFocus:r}=t;i||(Ac()?(i=window,r&&window.focus(),gt.getInstance().warn("Excalibur might be in a cross-origin iframe, in order to receive keyboard events it must be in focus")):i=window.top),i.addEventListener("blur",()=>{this._keys.length=0}),i.addEventListener("keyup",this._handleKeyUp),i.addEventListener("keydown",this._handleKeyDown)}toggleEnabled(t){this._enabled=t}update(){this._keysDown.length=0,this._keysUp.length=0;for(let t=0;t<this._keys.length;t++)this.events.emit("hold",new Vr(this._keys[t]))}getKeys(){return this._keys}wasPressed(t){return this._keysDown.indexOf(t)>-1}isHeld(t){return this._keys.indexOf(t)>-1}wasReleased(t){return this._keysUp.indexOf(t)>-1}triggerEvent(t,i,r){t==="down"&&this._handleKeyDown(new KeyboardEvent("keydown",{code:i,key:r??null})),t==="up"&&this._handleKeyUp(new KeyboardEvent("keyup",{code:i,key:r??null}))}}class Qo{static fromPagePosition(t,i,r){let l,c,g,m;arguments.length===3?(l=t,c=i,g=new D(l,c),m=r):(g=t,l=g.x,c=g.y,m=i);const w=m.screen.pageToScreenCoordinates(g),C=m.screen.screenToWorldCoordinates(w);return new Qo(C,g,w)}constructor(t,i,r){this.worldPos=t,this.pagePos=i,this.screenPos=r}}class an{cancel(){this.active=!1}get pagePos(){return this.coordinates.pagePos}get screenPos(){return this.coordinates.screenPos}get worldPos(){return this.coordinates.worldPos}constructor(t,i,r,l,c,g){this.type=t,this.pointerId=i,this.button=r,this.pointerType=l,this.coordinates=c,this.nativeEvent=g,this.active=!0}}class Ph{cancel(){this.active=!1}constructor(t,i,r,l,c,g,m,w,C,A,T,M){this.x=t,this.y=i,this.pageX=r,this.pageY=l,this.screenX=c,this.screenY=g,this.index=m,this.deltaX=w,this.deltaY=C,this.deltaZ=A,this.deltaMode=T,this.ev=M,this.active=!0}}class Rh{constructor(){this.events=new b,this.lastPagePos=D.Zero,this.lastScreenPos=D.Zero,this.lastWorldPos=D.Zero,this._onPointerMove=t=>{this.lastPagePos=new D(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new D(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new D(t.worldPos.x,t.worldPos.y)},this._onPointerDown=t=>{this.lastPagePos=new D(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new D(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new D(t.worldPos.x,t.worldPos.y)},this.on("move",this._onPointerMove),this.on("down",this._onPointerDown)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}var oi;(function(f){f.Pixel="Pixel",f.Line="Line",f.Page="Page"})(oi||(oi={}));var vs;(function(f){f[f.NoButton=-1]="NoButton",f[f.Left=0]="Left",f[f.Middle=1]="Middle",f[f.Right=2]="Right",f[f.Unknown=3]="Unknown"})(vs||(vs={}));var jn;(function(f){f.Left="Left",f.Middle="Middle",f.Right="Right",f.Unknown="Unknown",f.NoButton="NoButton"})(jn||(jn={}));var Gn;(function(f){f.Touch="Touch",f.Mouse="Mouse",f.Pen="Pen",f.Unknown="Unknown"})(Gn||(Gn={}));function ep(f){return globalThis.TouchEvent&&f instanceof globalThis.TouchEvent}function ip(f){return globalThis.PointerEvent&&f instanceof globalThis.PointerEvent}class Xr{constructor(t,i){this.target=t,this.engine=i,this.events=new b,this.primary=new Rh,this._activeNativePointerIdsToNormalized=new Map,this.lastFramePointerCoords=new Map,this.currentFramePointerCoords=new Map,this.currentFramePointerDown=new Map,this.lastFramePointerDown=new Map,this.currentFrameDown=[],this.currentFrameUp=[],this.currentFrameMove=[],this.currentFrameCancel=[],this.currentFrameWheel=[],this._enabled=!0,this._pointers=[this.primary],this._boundHandle=this._handle.bind(this),this._boundWheel=this._handleWheel.bind(this)}toggleEnabled(t){this._enabled=t}recreate(t,i){const r=new Xr(t,i);return r.primary=this.primary,r._pointers=this._pointers,r}at(t){if(t>=this._pointers.length)for(let i=this._pointers.length-1,r=t;i<r;i++)this._pointers.push(new Rh);return this._pointers[t]}count(){return this._pointers.length}isDown(t){var i;return(i=this.currentFramePointerDown.get(t))!==null&&i!==void 0?i:!1}wasDown(t){var i;return(i=this.lastFramePointerDown.get(t))!==null&&i!==void 0?i:!1}isDragging(t){return this.isDown(t)}isDragStart(t){return this.isDown(t)&&!this.wasDown(t)}isDragEnd(t){return!this.isDown(t)&&this.wasDown(t)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}update(){this.lastFramePointerDown=new Map(this.currentFramePointerDown),this.lastFramePointerCoords=new Map(this.currentFramePointerCoords);for(const t of this.currentFrameDown)this.emit("down",t),this.at(t.pointerId).emit("down",t),this.primary.emit("pointerdown",t);for(const t of this.currentFrameUp)this.emit("up",t),this.at(t.pointerId).emit("up",t);for(const t of this.currentFrameMove)this.emit("move",t),this.at(t.pointerId).emit("move",t);for(const t of this.currentFrameCancel)this.emit("cancel",t),this.at(t.pointerId).emit("cancel",t);for(const t of this.currentFrameWheel)this.emit("wheel",t),this.primary.emit("pointerwheel",t),this.primary.emit("wheel",t)}clear(){for(const t of this.currentFrameUp){this.currentFramePointerCoords.delete(t.pointerId);const i=this._activeNativePointerIdsToNormalized.entries();for(const[r,l]of i)l===t.pointerId&&this._activeNativePointerIdsToNormalized.delete(r)}this.currentFrameDown.length=0,this.currentFrameUp.length=0,this.currentFrameMove.length=0,this.currentFrameCancel.length=0,this.currentFrameWheel.length=0}init(t){var i;if(this.engine.isDisposed())return;this.target===this.engine.canvas?this.engine.canvas.style.touchAction="none":document.body.style.touchAction="none",window.PointerEvent?(this.target.addEventListener("pointerdown",this._boundHandle),this.target.addEventListener("pointerup",this._boundHandle),this.target.addEventListener("pointermove",this._boundHandle),this.target.addEventListener("pointercancel",this._boundHandle)):(this.target.addEventListener("touchstart",this._boundHandle),this.target.addEventListener("touchend",this._boundHandle),this.target.addEventListener("touchmove",this._boundHandle),this.target.addEventListener("touchcancel",this._boundHandle),this.target.addEventListener("mousedown",this._boundHandle),this.target.addEventListener("mouseup",this._boundHandle),this.target.addEventListener("mousemove",this._boundHandle));const r={passive:!(this.engine.pageScrollPreventionMode===En.All||this.engine.pageScrollPreventionMode===En.Canvas)};if("onwheel"in document.createElement("div")?this.target.addEventListener("wheel",this._boundWheel,r):document.onmousewheel!==void 0?this.target.addEventListener("mousewheel",this._boundWheel,r):this.target.addEventListener("MozMousePixelScroll",this._boundWheel,r),((i=t==null?void 0:t.grabWindowFocus)!==null&&i!==void 0?i:!0)&&Ac()){const c=()=>{window.focus()};window.PointerEvent?this.target.addEventListener("pointerdown",c):(this.target.addEventListener("touchstart",c),this.target.addEventListener("mousedown",c))}}detach(){window.PointerEvent?(this.target.removeEventListener("pointerdown",this._boundHandle),this.target.removeEventListener("pointerup",this._boundHandle),this.target.removeEventListener("pointermove",this._boundHandle),this.target.removeEventListener("pointercancel",this._boundHandle)):(this.target.removeEventListener("touchstart",this._boundHandle),this.target.removeEventListener("touchend",this._boundHandle),this.target.removeEventListener("touchmove",this._boundHandle),this.target.removeEventListener("touchcancel",this._boundHandle),this.target.removeEventListener("mousedown",this._boundHandle),this.target.removeEventListener("mouseup",this._boundHandle),this.target.removeEventListener("mousemove",this._boundHandle)),"onwheel"in document.createElement("div")?this.target.removeEventListener("wheel",this._boundWheel):document.onmousewheel!==void 0?this.target.addEventListener("mousewheel",this._boundWheel):this.target.addEventListener("MozMousePixelScroll",this._boundWheel)}_normalizePointerId(t){this._activeNativePointerIdsToNormalized.set(t,-1);const r=Array.from(this._activeNativePointerIdsToNormalized.keys()).sort((l,c)=>l-c).findIndex(l=>l===t);return this._activeNativePointerIdsToNormalized.set(t,r),r}_handle(t){if(!this._enabled)return;t.preventDefault();const i=new Map;let r,l;if(ep(t)){r=jn.Unknown,l=Gn.Touch;for(let c=0;c<t.changedTouches.length;c++){const g=t.changedTouches[c],m=Qo.fromPagePosition(g.pageX,g.pageY,this.engine),w=c+1,C=this._normalizePointerId(w);this.currentFramePointerCoords.set(C,m),i.set(C,m)}}else{r=this._nativeButtonToPointerButton(t.button),l=Gn.Mouse;const c=Qo.fromPagePosition(t.pageX,t.pageY,this.engine);let g=1;ip(t)&&(g=t.pointerId,l=this._stringToPointerType(t.pointerType));const m=this._normalizePointerId(g);this.currentFramePointerCoords.set(m,c),i.set(m,c)}for(const[c,g]of i.entries())switch(t.type){case"mousedown":case"pointerdown":case"touchstart":this.currentFrameDown.push(new an("down",c,r,l,g,t)),this.currentFramePointerDown.set(c,!0);break;case"mouseup":case"pointerup":case"touchend":this.currentFrameUp.push(new an("up",c,r,l,g,t)),this.currentFramePointerDown.set(c,!1);break;case"mousemove":case"pointermove":case"touchmove":this.currentFrameMove.push(new an("move",c,r,l,g,t));break;case"touchcancel":case"pointercancel":this.currentFrameCancel.push(new an("cancel",c,r,l,g,t));break}}_handleWheel(t){if(!this._enabled)return;(this.engine.pageScrollPreventionMode===En.All||this.engine.pageScrollPreventionMode===En.Canvas&&t.target===this.engine.canvas)&&t.preventDefault();const i=this.engine.screen.pageToScreenCoordinates(j(t.pageX,t.pageY)),r=this.engine.screen.screenToWorldCoordinates(i),l=-1/40,c=t.deltaX||t.wheelDeltaX*l||0,g=t.deltaY||t.wheelDeltaY*l||t.wheelDelta*l||t.detail||0,m=t.deltaZ||0;let w=oi.Pixel;t.deltaMode&&(t.deltaMode===1?w=oi.Line:t.deltaMode===2&&(w=oi.Page));const C=new Ph(r.x,r.y,t.pageX,t.pageY,i.x,i.y,0,c,g,m,w,t);this.currentFrameWheel.push(C)}triggerEvent(t,i){const r=this.engine.screen.worldToPageCoordinates(i);window.PointerEvent?this._handle(new window.PointerEvent("pointer"+t,{pointerId:0,clientX:r.x,clientY:r.y})):this._handle(new window.MouseEvent("mouse"+t,{clientX:r.x,clientY:r.y}));const l=this.engine.currentScene.world.get(ol);l.preupdate(this.engine.currentScene,1),l.update(1)}_nativeButtonToPointerButton(t){switch(t){case vs.NoButton:return jn.NoButton;case vs.Left:return jn.Left;case vs.Middle:return jn.Middle;case vs.Right:return jn.Right;case vs.Unknown:return jn.Unknown;default:return Yt(t)}}_stringToPointerType(t){switch(t){case"touch":return Gn.Touch;case"mouse":return Gn.Mouse;case"pen":return Gn.Pen;default:return Gn.Unknown}}}class al{constructor(t){this._enabled=!0;const{pointerTarget:i,grabWindowFocus:r,engine:l}=t;this.keyboard=new Th,this.pointers=new Xr(i,l),this.gamepads=new $o,this.keyboard.init({grabWindowFocus:r}),this.pointers.init({grabWindowFocus:r}),this.gamepads.init(),this.inputMapper=new Wn({keyboard:this.keyboard,pointers:this.pointers,gamepads:this.gamepads})}get enabled(){return this._enabled}toggleEnabled(t){this._enabled=t,this.keyboard.toggleEnabled(this._enabled),this.pointers.toggleEnabled(this._enabled),this.gamepads.toggleEnabled(this._enabled)}update(){this._enabled&&(this.inputMapper.execute(),this.keyboard.update(),this.gamepads.update())}}class np{}const sp={Initialize:"initialize",Activate:"activate",Deactivate:"deactivate",PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw",PreDebugDraw:"predebugdraw",PostDebugDraw:"postdebugdraw",PreLoad:"preload"};function ln(f){var t,i;return!!(f!=null&&f.prototype)&&!!(!((i=(t=f==null?void 0:f.prototype)===null||t===void 0?void 0:t.constructor)===null||i===void 0)&&i.name)}class ai{get actors(){return this.world.entityManager.entities.filter(t=>t instanceof Ei)}get entities(){return this.world.entityManager.entities}get triggers(){return this.world.entityManager.entities.filter(t=>t instanceof sl)}get tileMaps(){return this.world.entityManager.entities.filter(t=>t instanceof Go)}get timers(){return this._timers}constructor(){this._logger=gt.getInstance(),this.events=new b,this.camera=new pc,this.world=new vc(this),this.physics=new Sc(sn),this._isInitialized=!1,this._timers=[],this._cancelQueue=[],this.world.add(bc),this.world.add(new yc(this.world,this.physics)),this.world.add(new P(this.world,this.physics)),this.world.add(ol),this.world.add(Cc),this.world.add(Hn),this.world.add(js),this.world.add(xc)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}onPreLoad(t){}onTransition(t){}onInitialize(t){}onActivate(t){}onDeactivate(t){}onPreUpdate(t,i){}onPostUpdate(t,i){}onPreDraw(t,i){}onPostDraw(t,i){}_initializeChildren(){for(const t of this.entities)t._initialize(this.engine)}get isInitialized(){return this._isInitialized}async _initialize(t){var i;if(!this.isInitialized){try{this.engine=t,this.physics.config=this.engine.physics,this.input=new al({pointerTarget:t.pointerScope===E.Canvas?t.canvas:document,grabWindowFocus:t.grabWindowFocus,engine:t}),this.camera._initialize(t),this.world.systemManager.initialize(),await this.onInitialize(t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.events.emit("initialize",new Br(t,this))}catch(r){throw this._logger.error(`Error during scene initialization for scene ${(i=t.director)===null||i===void 0?void 0:i.getSceneName(this)}!`),r}this._isInitialized=!0}}async _activate(t){var i,r;try{this._logger.debug("Scene.onActivate",this),this.input.toggleEnabled(!0),await this.onActivate(t)}catch(l){throw this._logger.error(`Error during scene activation for scene ${(r=(i=this.engine)===null||i===void 0?void 0:i.director)===null||r===void 0?void 0:r.getSceneName(this)}!`),l}}async _deactivate(t){this._logger.debug("Scene.onDeactivate",this),this.input.toggleEnabled(!1),await this.onDeactivate(t)}_preupdate(t,i){this.emit("preupdate",new Bs(t,i,this)),this.onPreUpdate(t,i)}_postupdate(t,i){this.emit("postupdate",new us(t,i,this)),this.onPostUpdate(t,i)}_predraw(t,i){this.emit("predraw",new hs(t,i,this)),this.onPreDraw(t,i)}_postdraw(t,i){this.emit("postdraw",new ir(t,i,this)),this.onPostDraw(t,i)}update(t,i){var r;if(!this.isInitialized){this._logger.warnOnce(`Scene update called before initialize for scene ${(r=t.director)===null||r===void 0?void 0:r.getSceneName(this)}!`);return}this._preupdate(t,i);let l,c;for(l=0,c=this._cancelQueue.length;l<c;l++)this.removeTimer(this._cancelQueue[l]);this._cancelQueue.length=0;for(const g of this._timers)g.update(i);this.world.update(mi.Update,i),this.camera&&this.camera.update(t,i),this._collectActorStats(t),this._postupdate(t,i),this.input.update()}draw(t,i){var r;if(!this.isInitialized){this._logger.warnOnce("Scene draw called before initialize!");return}this._predraw(t,i),this.world.update(mi.Draw,i),!((r=this.engine)===null||r===void 0)&&r.isDebug&&this.debugDraw(t),this._postdraw(t,i)}debugDraw(t){this.emit("predebugdraw",new La(t,this)),this.emit("postdebugdraw",new Eo(t,this))}contains(t){return this.actors.indexOf(t)>-1}add(t){if(this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof zn){Ft(this._timers,t)||this.addTimer(t);return}}transfer(t){let i;t instanceof ni&&t.scene&&t.scene!==this&&(i=t.scene,t.scene.world.remove(t,!1)),t instanceof zn&&t.scene&&(i=t.scene,t.scene.removeTimer(t)),i==null||i.emit("entityremoved",{target:t}),this.add(t)}remove(t){t instanceof ni&&(this.emit("entityremoved",{target:t}),t.active&&t.kill(),this.world.remove(t)),t instanceof zn&&this.removeTimer(t)}clear(t=!0){for(let i=this.entities.length-1;i>=0;i--)this.world.remove(this.entities[i],t);for(let i=this.timers.length-1;i>=0;i--)this.removeTimer(this.timers[i])}addTimer(t){return this._timers.push(t),t.scene=this,t}removeTimer(t){const i=this._timers.indexOf(t);return i!==-1&&this._timers.splice(i,1),t}cancelTimer(t){return this._cancelQueue.push(t),t}isTimerActive(t){return this._timers.indexOf(t)>-1&&!t.complete}isCurrentScene(){return this.engine?this.engine.currentScene===this:!1}_collectActorStats(t){const i=this.actors.filter(r=>r instanceof gs);for(const r of i)t.stats.currFrame.actors.ui++;for(const r of this.actors){t.stats.currFrame.actors.alive++;for(const l of r.children)Or(l)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}}}var Vn;(function(f){f.Protanope="Protanope",f.Deuteranope="Deuteranope",f.Tritanope="Tritanope"})(Vn||(Vn={}));const rp=`#version 300 es\r
precision mediump float;\r
// our texture\r
uniform sampler2D u_image;\r
// the texCoords passed in from the vertex shader.\r
in vec2 v_texcoord;\r
\r
// color blind type\r
uniform int u_type;\r
\r
// simulation?\r
uniform bool u_simulate;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  vec4 o =  texture(u_image, v_texcoord);\r
  // RGB to LMS matrix conversion\r
  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\r
  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\r
  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\r
  // Simulate color blindness\r
  float l;\r
  float m;\r
  float s;\r
  //MODE CODE//\r
  if (u_type == 0) {\r
    // Protanope\r
    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\r
    m = 0.0 * L + 1.0 * M + 0.0 * S;\r
    s = 0.0 * L + 0.0 * M + 1.0 * S;;\r
  } else if (u_type == 1) {\r
    // Deuteranope\r
    l = 1.0 * L + 0.0 * M + 0.0 * S;\r
    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\r
    s = 0.0 * L + 0.0 * M + 1.0 * S;\r
  } else if (u_type == 2) {\r
    // Tritanope\r
    l = 1.0 * L + 0.0 * M + 0.0 * S;\r
    m = 0.0 * L + 1.0 * M + 0.0 * S;\r
    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\r
  }\r
\r
  // LMS to RGB matrix conversion\r
  vec4 error; // simulate the colors\r
  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\r
  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\r
  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\r
  error.a = 1.0;\r
  vec4 diff = o - error;\r
  vec4 correction; // correct the colors\r
  correction.r = 0.0;\r
  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\r
  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\r
  correction = o + correction;\r
  correction.a = o.a;\r
  //SIMULATE//\r
\r
  // sim \r
  if (u_simulate) {\r
    fragColor = error.rgba;\r
  } else {\r
    fragColor = correction.rgba;\r
  }\r
}`;class Ih{constructor(t,i){this._shader=new bi({gl:t,vertexSource:`#version 300 es
      in vec2 a_position;
      in vec2 a_texcoord;
      out vec2 v_texcoord;

      void main() {
        gl_Position = vec4(a_position, 0.0, 1.0);
        // Pass the texcoord to the fragment shader.
        v_texcoord = a_texcoord;
      }`,fragmentSource:i}),this._shader.compile(),this._buffer=new os({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new as({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}getShader(){return this._shader}getLayout(){return this._layout}}class Ec{constructor(t,i=!1){this._colorBlindnessMode=t,this._simulate=!1,this._simulate=i}initialize(t){this._shader=new Ih(t,rp),this.simulate=this._simulate,this.colorBlindnessMode=this._colorBlindnessMode}getShader(){return this._shader.getShader()}getLayout(){return this._shader.getLayout()}set colorBlindnessMode(t){if(this._colorBlindnessMode=t,this._shader){const i=this._shader.getShader();i.use(),this._colorBlindnessMode===Vn.Protanope?i.setUniformInt("u_type",0):this._colorBlindnessMode===Vn.Deuteranope?i.setUniformInt("u_type",1):this._colorBlindnessMode===Vn.Tritanope&&i.setUniformInt("u_type",2)}}get colorBlindnessMode(){return this._colorBlindnessMode}set simulate(t){if(this._simulate=t,this._shader){const i=this._shader.getShader();i.use(),i.setUniformBoolean("u_simulate",t)}}get simulate(){return this._simulate}}class Xn{constructor(t){this._engine=t,this._colorBlindPostProcessor=new Ec(Vn.Protanope)}correct(t){this._engine.graphicsContext instanceof ls&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!1,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}simulate(t){this._engine.graphicsContext instanceof ls&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!0,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}clear(){this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor)}}class ll{constructor(t){this.stats={currFrame:new An,prevFrame:new An},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!1,showName:!1},this.transform={showAll:!1,debugZIndex:1e7,showPosition:!1,showPositionLabel:!1,positionColor:nt.Yellow,showZIndex:!1,showScale:!1,scaleColor:nt.Green,showRotation:!1,rotationColor:nt.Blue},this.graphics={showAll:!1,showBounds:!1,boundsColor:nt.Yellow},this.collider={showAll:!1,showBounds:!1,boundsColor:nt.Blue,showOwner:!1,showGeometry:!0,geometryColor:nt.Green,geometryLineWidth:1,geometryPointSize:.5},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:nt.Cyan,showCollisionContacts:!0,contactSize:2,collisionContactColor:nt.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:nt.Yellow,showAcceleration:!1,accelerationColor:nt.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:nt.Red,showZoom:!1},this.tilemap={showAll:!1,showGrid:!1,gridColor:nt.Red,gridWidth:.5,showSolidBounds:!1,solidBoundsColor:nt.fromHex("#8080807F"),showColliderGeometry:!0},this.isometric={showAll:!1,showPosition:!1,positionColor:nt.Yellow,positionSize:1,showGrid:!1,gridColor:nt.Red,gridWidth:1,showColliderGeometry:!0},this._engine=t,this.colorBlindMode=new Xn(this._engine)}useTestClock(){const t=this._engine.clock,i=t.isRunning();t.stop();const r=t.toTestClock();return i&&r.start(),this._engine.clock=r,r}useStandardClock(){const t=this._engine.clock,i=t.isRunning();t.stop();const r=t.toStandardClock();return i&&r.start(),this._engine.clock=r,r}}class An{constructor(){this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new Pi,this._graphicsStats={drawCalls:0,drawnImages:0}}reset(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}clone(){const t=new An;return t.reset(this),t}get id(){return this._id}set id(t){this._id=t}get delta(){return this._delta}set delta(t){this._delta=t}get fps(){return this._fps}set fps(t){this._fps=t}get actors(){return this._actorStats}get duration(){return this._durationStats}get physics(){return this._physicsStats}get graphics(){return this._graphicsStats}}class Pi{constructor(){this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}reset(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}clone(){const t=new Pi;return t.reset(this),t}get pairs(){return this._pairs}set pairs(t){this._pairs=t}get collisions(){return this._collisions}set collisions(t){this._collisions=t}get contacts(){return this._contacts}set contacts(t){this._contacts=t}get fastBodies(){return this._fastBodies}set fastBodies(t){this._fastBodies=t}get fastBodyCollisions(){return this._fastBodyCollisions}set fastBodyCollisions(t){this._fastBodyCollisions=t}get broadphase(){return this._broadphase}set broadphase(t){this._broadphase=t}get narrowphase(){return this._narrowphase}set narrowphase(t){this._narrowphase=t}}class Dh{on(t,i){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(i),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}off(t,i){i||(i=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,i),this._nativeHandlers[t]=null}_decorate(t){return i=>{this._paused||t(i)}}pause(){this._paused=!0}resume(){this._paused=!1}clear(){for(const t in this._nativeHandlers)this.off(t)}constructor(t){this.nativeComponent=t,this._paused=!1,this._nativeHandlers={}}}class Fh{constructor(t,i){this._windowGlobal=t,this._documentGlobal=i,this._windowComponent=new Dh(this._windowGlobal),this._documentComponent=new Dh(this._documentGlobal)}get window(){return this._windowComponent}get document(){return this._documentComponent}pause(){this.window.pause(),this.document.pause()}resume(){this.window.resume(),this.document.resume()}clear(){this.window.clear(),this.document.clear()}}const Bh={pixelArtSampler:!1,nativeContextAntialiasing:!1,multiSampleAntialiasing:!0,filtering:ae.Blended,canvasImageRendering:"auto"},$r={pixelArtSampler:!0,nativeContextAntialiasing:!1,multiSampleAntialiasing:!0,filtering:ae.Blended,canvasImageRendering:"auto"};class ys{constructor(t){var i;this._samplePeriod=100,this._currentFrameTime=0,this._frames=0,this._previousSampleTime=0,this._beginFrameTime=0,this._fps=t.initialFps,this._samplePeriod=(i=t.samplePeriod)!==null&&i!==void 0?i:this._samplePeriod,this._currentFrameTime=1e3/t.initialFps,this._nowFn=t.nowFn,this._previousSampleTime=this._nowFn()}start(){this._beginFrameTime=this._nowFn()}end(){this._frames++;const t=this._nowFn();this._currentFrameTime=t-this._beginFrameTime,t>=this._previousSampleTime+this._samplePeriod&&(this._fps=this._frames*1e3/(t-this._previousSampleTime),this._previousSampleTime=t,this._frames=0)}get fps(){return this._fps}get instant(){return 1e3/this._currentFrameTime}}class hl{constructor(t){var i,r,l;this._onFatalException=()=>{},this._maxFps=1/0,this._lastTime=0,this._elapsed=1,this._scheduledCbs=[],this._totalElapsed=0,this._options=t,this.tick=t.tick,this._lastTime=(i=this.now())!==null&&i!==void 0?i:0,this._maxFps=(r=t.maxFps)!==null&&r!==void 0?r:this._maxFps,this._onFatalException=(l=t.onFatalException)!==null&&l!==void 0?l:this._onFatalException,this.fpsSampler=new ys({initialFps:60,nowFn:()=>this.now()})}elapsed(){return this._elapsed}now(){return performance.now()}toTestClock(){return new qo({...this._options,defaultUpdateMs:16.6})}toStandardClock(){return new kh({...this._options})}setFatalExceptionHandler(t){this._onFatalException=t}schedule(t,i=0,r="preframe"){const l=this._totalElapsed+i;this._scheduledCbs.push([t,l,r])}__runScheduledCbs(t="preframe"){for(let i=this._scheduledCbs.length-1;i>-1;i--)t===this._scheduledCbs[i][2]&&this._scheduledCbs[i][1]<=this._totalElapsed&&(this._scheduledCbs[i][0](this._elapsed),this._scheduledCbs.splice(i,1))}update(t){try{this.fpsSampler.start();const i=this.now();let r=i-this._lastTime||1;const l=1e3/this._maxFps;if(r>=l){let c=0;l!==0&&(c=r%l,r=r-c),r>200&&(r=1),this._elapsed=t||r,this._totalElapsed+=this._elapsed,this.__runScheduledCbs("preframe"),this.tick(t||r),this.__runScheduledCbs("postframe"),l!==0?this._lastTime=i-c:this._lastTime=i,this.fpsSampler.end()}}catch(i){this._onFatalException(i),this.stop()}}}class kh extends hl{constructor(t){super(t),this._running=!1}isRunning(){return this._running}start(){if(this._running)return;this._running=!0;const t=()=>{if(this._running)try{this._requestId=window.requestAnimationFrame(t),this.update()}catch(i){throw window.cancelAnimationFrame(this._requestId),i}};t()}stop(){window.cancelAnimationFrame(this._requestId),this._running=!1}}class qo extends hl{constructor(t){super({...t}),this._logger=gt.getInstance(),this._running=!1,this._currentTime=0,this._updateMs=t.defaultUpdateMs}now(){var t;return(t=this._currentTime)!==null&&t!==void 0?t:0}isRunning(){return this._running}start(){this._running=!0}stop(){this._running=!1}step(t){const i=t??this._updateMs;this._running?(this.update(i),this._currentTime+=i):this._logger.warn("The clock is not running, no step will be performed")}run(t,i){for(let r=0;r<t;r++)this.step(i??this._updateMs)}}var op=Ee(4296);class Lh{constructor(){this._toasterCss=op.A.toString(),this._isInitialized=!1}_initialize(){this._isInitialized||(this._container=document.createElement("div"),this._container.id="ex-toast-container",document.body.appendChild(this._container),this._isInitialized=!0,this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._toasterCss,document.head.appendChild(this._styleBlock))}dispose(){this._container.parentElement.removeChild(this._container),this._styleBlock.parentElement.removeChild(this._styleBlock),this._isInitialized=!1}_createFragment(t){const i=document.createElement("span");return i.innerText=t,i}toast(t,i,r){this._initialize();const l=document.createElement("div");l.className="ex-toast-message";const c=t.split("[LINK]").map(A=>this._createFragment(A));if(i){const A=document.createElement("a");A.href=i,r?A.innerText=r:A.innerText=i,c.splice(1,0,A)}const g=document.createElement("div");c.forEach(A=>{g.appendChild(A)}),l.appendChild(g);const m=document.createElement("button");m.innerText="x",m.addEventListener("click",()=>{this._container.removeChild(l)}),l.appendChild(m);const w=A=>{if(A.key==="Escape")try{this._container.removeChild(l)}catch{}document.removeEventListener("keydown",w)};document.addEventListener("keydown",w);const C=this._container.firstChild;this._container.insertBefore(l,C)}}const li={NavigationStart:"navigationstart",Navigation:"navigation",NavigationEnd:"navigationend"};class ul{get isTransitioning(){return this._isTransitioning}constructor(t,i){this._engine=t,this.events=new b,this._logger=gt.getInstance(),this._initialized=!1,this.scenes={},this._sceneToInstance=new Map,this._sceneToLoader=new Map,this._sceneToTransition=new Map,this._loadedScenes=new Set,this._isTransitioning=!1,this.rootScene=this.currentScene=new ai,this.add("root",this.rootScene),this.currentScene=this.rootScene,this.currentSceneName="root";for(const r in i){const l=i[r];this.add(r,l),r==="root"&&(this.rootScene=this.getSceneInstance("root"),this.currentScene=this.rootScene)}}async onInitialize(){if(!this._initialized)if(this._initialized=!0,this._deferredGoto){const t=this._deferredGoto,i=this._deferredTransition;this._deferredGoto=null,this._deferredTransition=null,await this.swapScene(t),i&&await this.playTransition(i)}else await this.swapScene("root")}get isInitialized(){return this._initialized}configureStart(t,i){const r=i==null?void 0:i.loader;r instanceof Bo?this.mainLoader=r:ja(r)?this.mainLoader=new r:this.mainLoader=new Os;let l;if(i){const{inTransition:c}=i;l=c}this.startScene=t,l?this.swapScene(this.startScene).then(()=>{this.playTransition(l)}):this.swapScene(this.startScene),this.currentSceneName=this.startScene}_getLoader(t){return this._sceneToLoader.get(t)}_getInTransition(t){var i;const r=this.scenes[t];return r instanceof ai||ln(r)?null:(i=r==null?void 0:r.transitions)===null||i===void 0?void 0:i.in}_getOutTransition(t){var i;const r=this.scenes[t];return r instanceof ai||ln(r)?null:(i=r==null?void 0:r.transitions)===null||i===void 0?void 0:i.out}getDeferredScene(){const t=this.getSceneDefinition(this._deferredGoto);return this._deferredGoto&&t?t:null}getSceneDefinition(t){const i=this.scenes[t];if(i instanceof ai||ln(i))return i;if(i)return i.scene}getSceneName(t){for(const[i,r]of Object.entries(this.scenes))if(r instanceof ai){if(t===r)return i}else if(!ln(r)&&t===r.scene)return i;for(const[i,r]of Object.entries(this.scenes))if(ln(r)){if(t.constructor===r)return i}else if(!(r instanceof ai)&&t.constructor===r.scene)return i;return null}assertAdded(t){return this}assertRemoved(t){return this}add(t,i){if(!(i instanceof ai)&&!ln(i)){const{loader:r,transitions:l}=i,{in:c,out:g}=l??{};this._sceneToTransition.set(t,{in:c,out:g}),ja(r)?this._sceneToLoader.set(t,new r):this._sceneToLoader.set(t,r)}return this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=i,this.assertAdded(t)}remove(t){if(t instanceof ai||ln(t)){const i=t;for(const r in this.scenes)if(this.scenes.hasOwnProperty(r)){const l=this.scenes[r];let c;if(l instanceof ai||ln(l)?c=l:c=l.scene,c===i){if(r===this.currentSceneName)throw new Error(`Cannot remove a currently active scene: ${r}`);this._sceneToInstance.delete(r),this._sceneToTransition.delete(r),this._sceneToLoader.delete(r),delete this.scenes[r]}}}if(typeof t=="string"){if(t===this.currentSceneName)throw new Error(`Cannot remove a currently active scene: ${t}`);this._sceneToInstance.delete(t),this._sceneToTransition.delete(t),this._sceneToLoader.delete(t),delete this.scenes[t]}}async goto(t,i){var r,l,c,g,m,w;const C=this.getSceneInstance(t);if(!C){this._logger.warn(`Scene ${t} does not exist! Check the name, are you sure you added it?`);return}const A=this.currentSceneName,T=(l=(r=this._engine.input)===null||r===void 0?void 0:r.enabled)!==null&&l!==void 0?l:!0;this._isTransitioning=!0;const M=(c=this.getSceneInstance(A))===null||c===void 0?void 0:c.onTransition("out"),z=C==null?void 0:C.onTransition("in");i={sourceOut:(g=this._getOutTransition(this.currentSceneName))!==null&&g!==void 0?g:M,destinationIn:(m=this._getInTransition(t))!==null&&m!==void 0?m:z,...i};const{sourceOut:W,destinationIn:Z,sceneActivationData:st}=i,q=W??this._getOutTransition(this.currentSceneName),Q=Z??this._getInTransition(t),ot=(q==null?void 0:q.hideLoader)||(Q==null?void 0:Q.hideLoader);ot&&this.maybeLoadScene(t,ot),this._emitEvent("navigationstart",A,t),await this.playTransition(q),await this.maybeLoadScene(t,ot),await(Q==null?void 0:Q.onPreviousSceneDeactivate(this.currentScene)),await this.swapScene(t,st),this._emitEvent("navigation",A,t),await this.playTransition(Q),this._emitEvent("navigationend",A,t),(w=this._engine.input)===null||w===void 0||w.toggleEnabled(T),this._isTransitioning=!1}getSceneInstance(t){const i=this.getSceneDefinition(t);if(!i)return;if(this._sceneToInstance.has(t))return this._sceneToInstance.get(t);if(i instanceof ai)return this._sceneToInstance.set(t,i),i;const r=new i;return this._sceneToInstance.set(t,r),r}async maybeLoadScene(t,i=!1){var r;const l=(r=this._getLoader(t))!==null&&r!==void 0?r:new Bo,c=this.getSceneDefinition(t),g=this.getSceneInstance(t);c&&g&&!this._loadedScenes.has(g)&&(g.onPreLoad(l),g.events.emit("preload",{loader:l}),i?this._engine.load(l,i):await this._engine.load(l),this._loadedScenes.add(g))}async playTransition(t){var i,r,l,c,g,m,w;if(!this.isInitialized){this._deferredTransition=t;return}if(t){this.currentTransition=t;const C=this._engine.currentScene,A=(r=(i=C.input)===null||i===void 0?void 0:i.enabled)!==null&&r!==void 0?r:!0;(l=C.input)===null||l===void 0||l.toggleEnabled(!t.blockInput),(c=this._engine.input)===null||c===void 0||c.toggleEnabled(!t.blockInput),await this.currentTransition.play(this._engine),(g=C.input)===null||g===void 0||g.toggleEnabled(A)}(m=this.currentTransition)===null||m===void 0||m.kill(),(w=this.currentTransition)===null||w===void 0||w.reset(),this.currentTransition=null}async swapScene(t,i){const r=this._engine;if(!this.isInitialized){this._deferredGoto=t;return}const l=this.getSceneInstance(t);if(l){const c=this.currentScene,g=l;if(this._logger.debug("Going to scene:",t),this.currentScene.isInitialized){const C={engine:r,previousScene:c,nextScene:g};await this.currentScene._deactivate(C),this.currentScene.events.emit("deactivate",new Fo(C,this.currentScene))}const m=this._sceneToLoader.get(t);await(m==null?void 0:m.areResourcesLoaded()),this.currentScene=g,this.currentSceneName=t,r.screen.setCurrentCamera(g.camera),await this.currentScene._initialize(r);const w={engine:r,previousScene:c,nextScene:g,data:i};await this.currentScene._activate(w),this.currentScene.events.emit("activate",new ch(w,this.currentScene))}else this._logger.error("Scene",t,"does not exist!")}_emitEvent(t,i,r){const l=this.getSceneDefinition(i),c=this.getSceneDefinition(r);this.events.emit(t,{sourceScene:l,sourceName:i,destinationScene:c,destinationName:r})}}function Tc(){const f={scope:(t,i)=>(f.value=t,i()),value:void 0};return f}function $n(f){return f.value}d();const Mh={FallbackGraphicsContext:"fallbackgraphicscontext",Initialize:"initialize",Visible:"visible",Hidden:"hidden",Start:"start",Stop:"stop",PreUpdate:"preupdate",PostUpdate:"postupdate",PreFrame:"preframe",PostFrame:"postframe",PreDraw:"predraw",PostDraw:"postdraw"};var En;(function(f){f[f.None=0]="None",f[f.Canvas=1]="Canvas",f[f.All=2]="All"})(En||(En={}));class Ie{static useEngine(){const t=$n(Ie.Context);if(!t)throw new Error("Cannot inject engine with `useEngine()`, `useEngine()` was called outside of Engine lifecycle scope.");return t}get canvasWidth(){return this.screen.canvasWidth}get halfCanvasWidth(){return this.screen.halfCanvasWidth}get canvasHeight(){return this.screen.canvasHeight}get halfCanvasHeight(){return this.screen.halfCanvasHeight}get drawWidth(){return this.screen.drawWidth}get halfDrawWidth(){return this.screen.halfDrawWidth}get drawHeight(){return this.screen.drawHeight}get halfDrawHeight(){return this.screen.halfDrawHeight}get isHiDpi(){return this.screen.isHiDpi}get stats(){return this.debug.stats}get currentScene(){return this.director.currentScene}get currentSceneName(){return this.director.currentSceneName}get rootScene(){return this.director.rootScene}get scenes(){return this.director.scenes}get isFullscreen(){return this.screen.isFullScreen}get displayMode(){return this.screen.displayMode}get pixelRatio(){return this.screen.pixelRatio}get isDebug(){return this._isDebug}get snapToPixel(){return this.graphicsContext.snapToPixel}set snapToPixel(t){this.graphicsContext.snapToPixel=t}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}constructor(t){var i,r,l,c,g,m,w,C;this.scope=ot=>Ie.Context.scope(this,ot),this.version=$h,this.events=new b,this.maxFps=Number.POSITIVE_INFINITY,this._inputEnabled=!0,this._suppressPlayButton=!1,this.pauseAudioWhenHidden=!0,this._isDebug=!1,this.enableCanvasTransparency=!0,this.onFatalException=ot=>{gt.getInstance().fatal(ot,ot.stack)},this._toaster=new Lh,this._timescale=1,this._isInitialized=!1,this._originalOptions={},this._handleWebGLContextLost=ot=>{var et;ot.preventDefault(),this.clock.stop(),this._logger.fatalOnce("WebGL Graphics Lost",ot);const _t=document.createElement("div");_t.id="ex-webgl-graphics-context-lost",_t.style.position="absolute",_t.style.zIndex="99",_t.style.left="50%",_t.style.top="50%",_t.style.display="flex",_t.style.flexDirection="column",_t.style.transform="translate(-50%, -50%)",_t.style.backgroundColor="white",_t.style.padding="10px",_t.style.borderStyle="solid 1px";const Nt=document.createElement("div");if(Nt.innerHTML=`
      <h1>There was an issue rendering, please refresh the page.</h1>
      <div>
        <p>WebGL Graphics Context Lost</p>

        <button id="ex-webgl-graphics-reload">Refresh Page</button>

        <p>There are a few reasons this might happen:</p>
        <ul>
          <li>Two or more pages are placing a high demand on the GPU</li>
          <li>Another page or operation has stalled the GPU and the browser has decided to reset the GPU</li>
          <li>The computer has multiple GPUs and the user has switched between them</li>
          <li>Graphics driver has crashed or restarted</li>
          <li>Graphics driver was updated</li>
        </ul>
      </div>
    `,_t.appendChild(Nt),!((et=this.canvas)===null||et===void 0)&&et.parentElement){this.canvas.parentElement.appendChild(_t);const at=Nt.querySelector("#ex-webgl-graphics-reload");at==null||at.addEventListener("click",()=>location.reload())}},this._performanceThresholdTriggered=!1,this._fpsSamples=[],this._disposed=!1,this._isLoading=!1,this._hideLoader=!1,this._isReadyFuture=new x,this.currentFrameElapsedMs=0,this.currentFrameLagMs=0,this._lagMs=0,this._screenShotRequests=[],t={...Ie._DEFAULT_ENGINE_OPTIONS,...t},this._originalOptions=t,_.freeze(),this.browser=new Fh(window,document);const A=new wh;if(!t.suppressMinimumBrowserFeatureDetection&&!(this._compatible=A.test())){const ot=document.createElement("div");if(ot.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(ot),A.failedTests.forEach(function(et){const _t=document.createElement("div");_t.innerText="Browser feature missing "+et,document.body.appendChild(_t)}),t.canvasElementId){const et=document.getElementById(t.canvasElementId);et&&et.parentElement.removeChild(et)}return}else this._compatible=!0;if(console.log&&!t.suppressConsoleBootMessage&&(console.log(`%cPowered by Excalibur.js (v${$h})`,"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log(`
      /| ________________
O|===|* >________________>
      \\|`),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(this._suppressPlayButton=!0),this._logger=gt.getInstance(),this._logger.defaultLevel===Et.Debug&&A.logBrowserFeatures(),this._logger.debug("Building engine..."),this.canvasElementId=t.canvasElementId,t.canvasElementId){if(this._logger.debug("Using Canvas element specified: "+t.canvasElementId),document.getElementById(t.canvasElementId)===null)throw new Error("Cannot find existing element in the DOM, please ensure element is created prior to engine creation.");this.canvas=document.getElementById(t.canvasElementId)}else t.canvasElement?(this._logger.debug("Using Canvas element specified:",t.canvasElement),this.canvas=t.canvasElement):(this._logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));let T=(i=t.displayMode)!==null&&i!==void 0?i:Ae.Fixed;t.width&&t.height||t.viewport?(t.displayMode===void 0&&(T=Ae.Fixed),this._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(this._logger.debug("Engine viewport is fit"),T=Ae.FitScreen),this._originalDisplayMode=T;let M,z,W,Z,st,q;typeof t.antialiasing=="object"?{pixelArtSampler:M,nativeContextAntialiasing:W,multiSampleAntialiasing:q,filtering:st,canvasImageRendering:Z}={...t.pixelArt?$r:Bh,...t.antialiasing}:(M=!!t.pixelArt,W=!1,q=t.antialiasing,Z=t.antialiasing?"auto":"pixelated",st=t.antialiasing?ae.Blended:ae.Pixel),W&&q&&this._logger.warnOnce("Cannot use antialias setting nativeContextAntialiasing and multiSampleAntialiasing at the same time, they are incompatible settings. If you aren't sure use multiSampleAntialiasing"),t.pixelArt&&(z=.25),(!t.antialiasing||st===ae.Pixel)&&(z=0),z=(l=(r=t.uvPadding)!==null&&r!==void 0?r:z)!==null&&l!==void 0?l:.01;let Q=_.isEnabled("use-canvas-context");if(!Q)try{this.graphicsContext=new ls({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,pixelArtSampler:M,antialiasing:W,multiSampleAntialiasing:q,uvPadding:z,powerPreference:t.powerPreference,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting,handleContextLost:(c=t.handleContextLost)!==null&&c!==void 0?c:this._handleWebGLContextLost,handleContextRestored:t.handleContextRestored})}catch(ot){this._logger.warn(`Excalibur could not load webgl for some reason (${ot.message}) and loaded a Canvas 2D fallback. Some features of Excalibur will not work in this mode. 

Read more about this issue at https://excaliburjs.com/docs/performance`),Q=!0}Q&&(this.graphicsContext=new Pa({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,antialiasing:W,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})),this.screen=new oh({canvas:this.canvas,context:this.graphicsContext,antialiasing:W,canvasImageRendering:Z,browser:this.browser,viewport:(g=t.viewport)!==null&&g!==void 0?g:t.width&&t.height?{width:t.width,height:t.height}:rh.SVGA,resolution:t.resolution,displayMode:T,pixelRatio:t.suppressHiDPIScaling?1:(m=t.pixelRatio)!==null&&m!==void 0?m:null}),ne.filtering=st,t.backgroundColor&&(this.backgroundColor=t.backgroundColor.clone()),this.grabWindowFocus=t.grabWindowFocus,this.pointerScope=t.pointerScope,this.maxFps=(w=t.maxFps)!==null&&w!==void 0?w:this.maxFps,this.fixedUpdateFps=(C=t.fixedUpdateFps)!==null&&C!==void 0?C:this.fixedUpdateFps,this.clock=new kh({maxFps:this.maxFps,tick:this._mainloop.bind(this),onFatalException:ot=>this.onFatalException(ot)}),this.enableCanvasTransparency=t.enableCanvasTransparency,typeof t.physics=="boolean"?this.physics={...sn,...Mo(),enabled:t.physics}:this.physics={...sn,...Mo(),...t.physics},this.debug=new ll(this),this.director=new ul(this,t.scenes),this._initialize(t),window.___EXCALIBUR_DEVTOOL=this,Ie.InstanceCount++}_monitorPerformanceThresholdAndTriggerFallback(){const{allow:t}=this._originalOptions.configurePerformanceCanvas2DFallback;let{threshold:i,showPlayerMessage:r}=this._originalOptions.configurePerformanceCanvas2DFallback;if(i===void 0&&(i=Ie._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold),r===void 0&&(r=Ie._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage),!_.isEnabled("use-canvas-context")&&t&&this.ready&&!this._performanceThresholdTriggered){this._fpsSamples.length===i.numberOfFrames&&this._fpsSamples.splice(0,1),this._fpsSamples.push(this.clock.fpsSampler.fps);let l=0;for(let g=0;g<this._fpsSamples.length;g++)l+=this._fpsSamples[g];const c=l/this._fpsSamples.length;this._fpsSamples.length===i.numberOfFrames&&c<=i.fps&&(this._performanceThresholdTriggered=!0,this._logger.warn(`Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.
this might mean your browser doesn't have webgl enabled or hardware acceleration is unavailable.

If in Chrome:
  * Visit Settings > Advanced > System, and ensure "Use Hardware Acceleration" is checked.
  * Visit chrome://flags/#ignore-gpu-blocklist and ensure "Override software rendering list" is "enabled"
If in Firefox, visit about:config
  * Ensure webgl.disabled = false
  * Ensure webgl.force-enabled = true
  * Ensure layers.acceleration.force-enabled = true

Read more about this issue at https://excaliburjs.com/docs/performance`),r&&this._toaster.toast("Excalibur is encountering performance issues. It's possible that your browser doesn't have hardware acceleration enabled. Visit [LINK] for more information and potential solutions.","https://excaliburjs.com/docs/performance"),this.useCanvas2DFallback(),this.emit("fallbackgraphicscontext",this.graphicsContext))}}useCanvas2DFallback(){var t,i,r;const l=this.canvas.cloneNode(!1);this.canvas.parentNode.replaceChild(l,this.canvas),this.canvas=l;const c={...this._originalOptions,antialiasing:this.getAntialiasing()},g=this._originalDisplayMode;this.graphicsContext=new Pa({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,antialiasing:c.antialiasing,backgroundColor:c.backgroundColor,snapToPixel:c.snapToPixel,useDrawSorting:c.useDrawSorting}),this.screen&&this.screen.dispose(),this.screen=new oh({canvas:this.canvas,context:this.graphicsContext,antialiasing:(t=c.antialiasing)!==null&&t!==void 0?t:!0,browser:this.browser,viewport:(i=c.viewport)!==null&&i!==void 0?i:c.width&&c.height?{width:c.width,height:c.height}:rh.SVGA,resolution:c.resolution,displayMode:g,pixelRatio:c.suppressHiDPIScaling?1:(r=c.pixelRatio)!==null&&r!==void 0?r:null}),this.screen.setCurrentCamera(this.currentScene.camera),this.input.pointers.detach();const m=c&&c.pointerScope===E.Document?document:this.canvas;this.input.pointers=this.input.pointers.recreate(m,this),this.input.pointers.init()}dispose(){this._disposed||(this._disposed=!0,this.stop(),this.input.toggleEnabled(!1),this.canvas.parentNode.removeChild(this.canvas),this.canvas=null,this.screen.dispose(),this.graphicsContext.dispose(),this.graphicsContext=null,Ie.InstanceCount--)}isDisposed(){return this._disposed}getWorldBounds(){return this.screen.getWorldBounds()}get timescale(){return this._timescale}set timescale(t){if(t<=0){gt.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0.");return}this._timescale=t}addTimer(t){return this.currentScene.addTimer(t)}removeTimer(t){return this.currentScene.removeTimer(t)}addScene(t,i){return this.director.add(t,i),this}removeScene(t){this.director.remove(t)}add(t){if(arguments.length===2){this.director.add(arguments[0],arguments[1]);return}const i=this.director.getDeferredScene();i instanceof ai?i.add(t):this.currentScene.add(t)}remove(t){t instanceof ni&&this.currentScene.remove(t),(t instanceof ai||ln(t))&&this.removeScene(t),typeof t=="string"&&this.removeScene(t)}async goto(t,i){await this.scope(async()=>{await this.director.goto(t,i)})}async goToScene(t,i){await this.scope(async()=>{await this.director.goto(t,i)})}screenToWorldCoordinates(t){return this.screen.screenToWorldCoordinates(t)}worldToScreenCoordinates(t){return this.screen.worldToScreenCoordinates(t)}_initialize(t){var i,r;this.pageScrollPreventionMode=t.scrollPreventionMode;const l=t&&t.pointerScope===E.Document?document:this.canvas,c=(r=(i=this._originalOptions)===null||i===void 0?void 0:i.grabWindowFocus)!==null&&r!==void 0?r:!0;this.input=new al({pointerTarget:l,grabWindowFocus:c,engine:this}),this.inputMapper=this.input.inputMapper,this.browser.document.on("visibilitychange",()=>{document.visibilityState==="hidden"?(this.events.emit("hidden",new Ua(this)),this._logger.debug("Window hidden")):document.visibilityState==="visible"&&(this.events.emit("visible",new Na(this)),this._logger.debug("Window visible"))}),!this.canvasElementId&&!t.canvasElement&&document.body.appendChild(this.canvas)}toggleInputEnabled(t){this._inputEnabled=t,this.input.toggleEnabled(this._inputEnabled)}onInitialize(t){}setAntialiasing(t){this.screen.antialiasing=t}getAntialiasing(){return this.screen.antialiasing}get isInitialized(){return this._isInitialized}async _overrideInitialize(t){this.isInitialized||(await this.director.onInitialize(),await this.onInitialize(t),this.events.emit("initialize",new Br(t,this)),this._isInitialized=!0)}_update(t){var i;if(this._isLoading){(i=this._loader)===null||i===void 0||i.onUpdate(this,t),this.input.update();return}this.clock.__runScheduledCbs("preupdate"),this._preupdate(t),this.currentScene.update(this,t),this.graphicsContext.updatePostProcessors(t),this.clock.__runScheduledCbs("postupdate"),this._postupdate(t),this.input.update()}_preupdate(t){this.emit("preupdate",new Bs(this,t,this)),this.onPreUpdate(this,t)}onPreUpdate(t,i){}_postupdate(t){this.emit("postupdate",new us(this,t,this)),this.onPostUpdate(this,t)}onPostUpdate(t,i){}_draw(t){var i,r;if(this.graphicsContext.beginDrawLifecycle(),this.graphicsContext.clear(),this.clock.__runScheduledCbs("predraw"),this._predraw(this.graphicsContext,t),this._isLoading){this._hideLoader||((i=this._loader)===null||i===void 0||i.canvas.draw(this.graphicsContext,0,0),this.clock.__runScheduledCbs("postdraw"),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle());return}this.graphicsContext.backgroundColor=(r=this.currentScene.backgroundColor)!==null&&r!==void 0?r:this.backgroundColor,this.currentScene.draw(this.graphicsContext,t),this.clock.__runScheduledCbs("postdraw"),this._postdraw(this.graphicsContext,t),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle(),this._checkForScreenShots()}_predraw(t,i){this.emit("predraw",new hs(t,i,this)),this.onPreDraw(t,i)}onPreDraw(t,i){}_postdraw(t,i){this.emit("postdraw",new ir(t,i,this)),this.onPostDraw(t,i)}onPostDraw(t,i){}showDebug(t){this._isDebug=t}toggleDebug(){return this._isDebug=!this._isDebug,this._isDebug}get loadingComplete(){return!this._isLoading}get ready(){return this._isReadyFuture.isCompleted}isReady(){return this._isReadyFuture.promise}async start(t,i){await this.scope(async()=>{if(!this._compatible)throw new Error("Excalibur is incompatible with your browser");this._isLoading=!0;let r;return t instanceof Bo?r=t:typeof t=="string"&&(this.director.configureStart(t,i),r=this.director.mainLoader),this._logger.debug("Starting game clock..."),this.browser.resume(),this.clock.start(),this._logger.debug("Game clock started"),await this.load(r??new Os),await this._overrideInitialize(this),this._isReadyFuture.resolve(),this.emit("start",new lh(this)),this._isReadyFuture.promise})}_mainloop(t){this.scope(()=>{this.emit("preframe",new To(this,this.stats.prevFrame));const i=t*this.timescale;this.currentFrameElapsedMs=i;const r=this.stats.prevFrame.id+1;this.stats.currFrame.reset(),this.stats.currFrame.id=r,this.stats.currFrame.delta=i,this.stats.currFrame.fps=this.clock.fpsSampler.fps,ye.clear();const l=this.clock.now(),c=1e3/this.fixedUpdateFps;if(this.fixedUpdateFps)for(this._lagMs+=i;this._lagMs>=c;)this._update(c),this._lagMs-=c;else this._update(i);const g=this.clock.now();this.currentFrameLagMs=this._lagMs,this._draw(i);const m=this.clock.now();this.stats.currFrame.duration.update=g-l,this.stats.currFrame.duration.draw=m-g,this.stats.currFrame.graphics.drawnImages=ye.DrawnImagesCount,this.stats.currFrame.graphics.drawCalls=ye.DrawCallCount,this.emit("postframe",new Po(this,this.stats.currFrame)),this.stats.prevFrame.reset(this.stats.currFrame),this._monitorPerformanceThresholdAndTriggerFallback()})}stop(){this.clock.isRunning()&&(this.emit("stop",new Ba(this)),this.browser.pause(),this.clock.stop(),this._logger.debug("Game stopped"))}isRunning(){return this.clock.isRunning()}screenshot(t=!1){return new Promise(r=>{this._screenShotRequests.push({preserveHiDPIResolution:t,resolve:r})})}_checkForScreenShots(){for(const t of this._screenShotRequests){const i=t.preserveHiDPIResolution?this.canvas.width:this.screen.resolution.width,r=t.preserveHiDPIResolution?this.canvas.height:this.screen.resolution.height,l=document.createElement("canvas");l.width=i,l.height=r;const c=l.getContext("2d");c.imageSmoothingEnabled=this.screen.antialiasing,c.drawImage(this.canvas,0,0,i,r);const g=new Image,m=l.toDataURL("image/png");g.src=m,t.resolve(g)}this._screenShotRequests.length=0}async load(t,i=!1){await this.scope(async()=>{try{if(t.isLoaded())return;this._loader=t,this._isLoading=!0,this._hideLoader=i,t instanceof Os&&(t.suppressPlayButton=t.suppressPlayButton||this._suppressPlayButton),this._loader.onInitialize(this),await t.load()}catch(r){this._logger.error("Error loading resources, things may not behave properly",r),await Promise.resolve()}finally{this._isLoading=!1,this._hideLoader=!1,this._loader=null}})}}Ie.Context=Tc(),Ie.InstanceCount=0,Ie._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,useDrawSorting:!0,configurePerformanceCanvas2DFallback:{allow:!1,showPlayerMessage:!1,threshold:{fps:20,numberOfFrames:100}},canvasElementId:"",canvasElement:void 0,snapToPixel:!1,antialiasing:!0,pixelArt:!1,powerPreference:"high-performance",pointerScope:E.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,grabWindowFocus:!0,scrollPreventionMode:En.Canvas,backgroundColor:nt.fromHex("#2185d0")};class Pc{constructor(){this._handlers={},this._wiredEventDispatchers=[],this._deferedHandlerRemovals=[]}clear(){this._handlers={},this._wiredEventDispatchers=[]}_processDeferredHandlerRemovals(){for(const t of this._deferedHandlerRemovals)this._removeHandler(t.name,t.handler);this._deferedHandlerRemovals.length=0}emit(t,i){if(this._processDeferredHandlerRemovals(),!t)return;t=t.toLowerCase(),(typeof i>"u"||i===null)&&(i=new Ut);let r,l;if(this._handlers[t])for(r=0,l=this._handlers[t].length,r;r<l;r++)this._handlers[t][r](i);for(r=0,l=this._wiredEventDispatchers.length,r;r<l;r++)this._wiredEventDispatchers[r].emit(t,i)}on(t,i){this._processDeferredHandlerRemovals(),t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(i)}off(t,i){this._deferedHandlerRemovals.push({name:t,handler:i})}_removeHandler(t,i){t=t.toLowerCase();const r=this._handlers[t];if(r)if(!i)this._handlers[t].length=0;else{const l=r.indexOf(i);l>-1&&this._handlers[t].splice(l,1)}}once(t,i){this._processDeferredHandlerRemovals();const r=l=>{const c=l||new Ut;this.off(t,r),i(c)};this.on(t,r)}wire(t){t._wiredEventDispatchers.push(this)}unwire(t){const i=t._wiredEventDispatchers.indexOf(this);i>-1&&t._wiredEventDispatchers.splice(i,1)}}class Ri extends Ei{get font(){return this._font}set font(t){this._font=t,this._text.font=t}get text(){return this._text.text}set text(t){this._text.text=t}get color(){return this._text.color}set color(t){this._text&&(this._text.color=t)}get opacity(){return this._text.opacity}set opacity(t){this._text.opacity=t}get spriteFont(){return this._spriteFont}set spriteFont(t){t&&(this._spriteFont=t,this._text.font=this._spriteFont)}constructor(t){super(t),this._font=new zs,this._text=new Hs({text:"",font:this._font});const{text:i,pos:r,x:l,y:c,spriteFont:g,font:m,color:w}={text:"",...t};this.pos=r??(l&&c?j(l,c):this.pos),this.text=i??this.text,this.font=m??this.font,this.spriteFont=g??this.spriteFont,this._text.color=w??this.color;const C=this.get(Ge);C.anchor=D.Zero,C.use(this._text)}_initialize(t){super._initialize(t)}getTextWidth(){return this._text.width}}class cl extends ni{getGraphics(){return this._graphics}addGraphic(t,i){this._graphics.push(t),this._gfx.visible=this.map.visible,this._gfx.opacity=this.map.opacity,i!=null&&i.offset&&(this._gfx.offset=i.offset),this._gfx.localBounds=this._recalculateBounds()}_recalculateBounds(){let t=this._tileBounds.clone();for(const i of this._graphics){const r=j(this.map.graphicsOffset.x-this.map.tileWidth/2,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:i.height-this.map.tileHeight));t=t.combine(i.localBounds.translate(r))}return t}removeGraphic(t){const i=this._graphics.indexOf(t);i>-1&&this._graphics.splice(i,1),this._gfx.localBounds=this._recalculateBounds()}clearGraphics(){this._graphics.length=0,this._gfx.visible=!1,this._gfx.localBounds=this._recalculateBounds()}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const i=this._colliders.indexOf(t);i>-1&&this._colliders.splice(i,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}get pos(){return this.map.tileToWorld(j(this.x,this.y))}get center(){return this.pos.add(j(0,this.map.tileHeight/2))}constructor(t,i,r,l){super([new yt,new Ge({offset:r??D.Zero,onPostDraw:(M,z)=>this.draw(M,z)}),new Xo(l)]),this.solid=!1,this.events=new b,this._tileBounds=new mt,this._graphics=[],this._colliders=[],this.data=new Map,this.x=t,this.y=i,this.map=l,this._transform=this.get(yt),this._isometricEntityComponent=this.get(Xo);const c=this.map.tileWidth/2,g=this.map.tileHeight/2,m=(this.x-this.y)*c,w=(this.x+this.y)*g;this._transform.pos=j(m,w),this._isometricEntityComponent.elevation=l.elevation,this._gfx=this.get(Ge),this._gfx.visible=!1;const C=this.map.tileWidth,A=this.map.tileHeight,T=j(0,this.map.renderFromTopOfGraphic?A:0);this._gfx.localBounds=this._tileBounds=new mt({left:-C/2,top:-A,right:C/2,bottom:A}).translate(T)}draw(t,i){const r=this.map.tileWidth/2;t.save(),t.translate(-r,0);for(const l of this._graphics)l.draw(t,this.map.graphicsOffset.x,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:l.height-this.map.tileHeight));t.restore()}}class ap extends ni{constructor(t){super([new yt,new Lt({type:Mt.Fixed}),new de,new Ai,new el((A,T)=>this.debug(A,T),!1)],t.name),this.elevation=0,this.visible=!0,this.opacity=1,this.renderFromTopOfGraphic=!1,this.graphicsOffset=j(0,0),this._forwardPointerEventToTile=A=>T=>{const M=this.getTileByPoint(T.worldPos);M&&M.events.emit(A,T)},this._collidersDirty=!1,this._originalOffsets=new WeakMap;const{pos:i,tileWidth:r,tileHeight:l,columns:c,rows:g,renderFromTopOfGraphic:m,graphicsOffset:w,elevation:C}=t;this.transform=this.get(yt),i&&(this.transform.pos=i),this.collider=this.get(de),this.collider&&this.collider.set(this._composite=new ei([])),this.pointer=this.get(Ai),this.renderFromTopOfGraphic=m??this.renderFromTopOfGraphic,this.graphicsOffset=w??this.graphicsOffset,this.elevation=C??this.elevation,this.tileWidth=r,this.tileHeight=l,this.columns=c,this.rows=g,this.tiles=new Array(c*g);for(let A=0;A<g;A++)for(let T=0;T<c;T++){const M=new cl(T,A,this.graphicsOffset,this);this.tiles[T+A*c]=M,this.addChild(M)}this.pointer.localBounds=mt.fromDimension(r*c*this.transform.scale.x,l*g*this.transform.scale.y,j(.5,0)),this._setupPointerToTile()}_setupPointerToTile(){this.events.on("pointerup",this._forwardPointerEventToTile("pointerup")),this.events.on("pointerdown",this._forwardPointerEventToTile("pointerdown")),this.events.on("pointermove",this._forwardPointerEventToTile("pointermove")),this.events.on("pointercancel",this._forwardPointerEventToTile("pointercancel"))}update(){this._collidersDirty&&(this.updateColliders(),this._collidersDirty=!1)}flagCollidersDirty(){this._collidersDirty=!0}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const i=t.offset;return this._originalOffsets.set(t,i),i}}updateColliders(){this._composite.clearColliders();const t=this.get(yt).pos;for(const i of this.tiles)if(i.solid)for(const r of i.getColliders()){const l=this._getOrSetColliderOriginalOffset(r);r.offset=this.tileToWorld(j(i.x,i.y)).sub(t).add(l).sub(j(this.tileWidth/2,this.tileHeight)),r.owner=this,this._composite.addCollider(r)}this.collider.update()}worldToTile(t){t=t.sub(this.transform.globalPos);const i=this.tileWidth/2,r=this.tileHeight/2;return j(~~((t.x/i+t.y/r)/2),~~((t.y/r-t.x/i)/2))}tileToWorld(t){const i=this.tileWidth/2,r=this.tileHeight/2,l=(t.x-t.y)*i,c=(t.x+t.y)*r;return j(l,c).add(this.transform.pos)}getTile(t,i){return t<0||i<0||t>=this.columns||i>=this.rows?null:this.tiles[t+i*this.columns]}getTileByPoint(t){const i=this.worldToTile(t);return this.getTile(i.x,i.y)}_getMaxZIndex(){let t=Number.NEGATIVE_INFINITY;for(const i of this.tiles){const r=i.get(yt).z;r>t&&(t=r)}return t}debug(t,i){const{showAll:r,showPosition:l,positionColor:c,positionSize:g,showGrid:m,gridColor:w,gridWidth:C,showColliderGeometry:A}=i.isometric,{geometryColor:T,geometryLineWidth:M,geometryPointSize:z}=i.collider;if(t.save(),t.z=this._getMaxZIndex()+.5,r||m){for(let W=0;W<this.rows+1;W++){const Z=this.tileToWorld(j(0,W)),st=this.tileToWorld(j(this.columns,W));t.drawLine(Z,st,w,C)}for(let W=0;W<this.columns+1;W++){const Z=this.tileToWorld(j(W,0)),st=this.tileToWorld(j(W,this.rows));t.drawLine(Z,st,w,C)}}if(r||l)for(const W of this.tiles)t.drawCircle(this.tileToWorld(j(W.x,W.y)),g,c);if(r||A){for(const W of this.tiles)if(W.solid)for(const Z of W.getColliders())Z.debug(t,T,{lineWidth:M,pointSize:z})}t.restore()}}class Oh{constructor(t,i){this._stopped=!1,this._sequenceBuilder=i,this._sequenceContext=new Wo(t),this._actionQueue=this._sequenceContext.getQueue(),this._sequenceBuilder(this._sequenceContext)}update(t){this._actionQueue.update(t)}isComplete(){return this._stopped||this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._stopped=!1,this._actionQueue.reset()}clone(t){return new Oh(t,this._sequenceBuilder)}}class lp{constructor(t){this._actions=t}update(t){for(let i=0;i<this._actions.length;i++)this._actions[i].update(t)}isComplete(t){return this._actions.every(i=>i.isComplete(t))}reset(){this._actions.forEach(t=>t.reset())}stop(){this._actions.forEach(t=>t.stop())}}class Gs{constructor(t,i){this.bounds=t,this.options=i,this._defaultOptions={maxDepth:10,capacity:10,level:0},this.items=[],this._isDivided=!1,this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null,this.options={...this._defaultOptions,...i},this.halfWidth=t.width/2,this.halfHeight=t.height/2}_split(){this._isDivided=!0;const t={maxDepth:this.options.maxDepth,capacity:this.options.capacity,level:this.options.level+1};this.topLeft=new Gs(new mt({left:this.bounds.left,top:this.bounds.top,right:this.bounds.left+this.halfWidth,bottom:this.bounds.top+this.halfHeight}),t),this.topRight=new Gs(new mt({left:this.bounds.left+this.halfWidth,top:this.bounds.top,right:this.bounds.right,bottom:this.bounds.top+this.halfHeight}),t),this.bottomLeft=new Gs(new mt({left:this.bounds.left,top:this.bounds.top+this.halfHeight,right:this.bounds.left+this.halfWidth,bottom:this.bounds.bottom}),t),this.bottomRight=new Gs(new mt({left:this.bounds.left+this.halfWidth,top:this.bounds.top+this.halfHeight,right:this.bounds.right,bottom:this.bounds.bottom}),t)}_insertIntoSubNodes(t){var i,r,l,c;!((i=this.topLeft)===null||i===void 0)&&i.bounds.overlaps(t.bounds)&&this.topLeft.insert(t),!((r=this.topRight)===null||r===void 0)&&r.bounds.overlaps(t.bounds)&&this.topRight.insert(t),!((l=this.bottomLeft)===null||l===void 0)&&l.bounds.overlaps(t.bounds)&&this.bottomLeft.insert(t),!((c=this.bottomRight)===null||c===void 0)&&c.bounds.overlaps(t.bounds)&&this.bottomRight.insert(t)}insert(t){if(this._isDivided){this._insertIntoSubNodes(t);return}if(this.items.push(t),this.items.length>this.options.capacity&&this.options.level<this.options.maxDepth){this._isDivided||this._split();for(const i of this.items)this._insertIntoSubNodes(i);this.items.length=0}}remove(t){var i,r,l,c;if(this.bounds.overlaps(t.bounds)){if(!this._isDivided){const g=this.items.indexOf(t);g>-1&&this.items.splice(g,1);return}!((i=this.topLeft)===null||i===void 0)&&i.bounds.overlaps(t.bounds)&&this.topLeft.remove(t),!((r=this.topRight)===null||r===void 0)&&r.bounds.overlaps(t.bounds)&&this.topRight.remove(t),!((l=this.bottomLeft)===null||l===void 0)&&l.bounds.overlaps(t.bounds)&&this.bottomLeft.remove(t),!((c=this.bottomRight)===null||c===void 0)&&c.bounds.overlaps(t.bounds)&&this.bottomRight.remove(t)}}query(t){let i=this.items;return this._isDivided&&(this.topLeft.bounds.overlaps(t)&&(i=i.concat(this.topLeft.query(t))),this.topRight.bounds.overlaps(t)&&(i=i.concat(this.topRight.query(t))),this.bottomLeft.bounds.overlaps(t)&&(i=i.concat(this.bottomLeft.query(t))),this.bottomRight.bounds.overlaps(t)&&(i=i.concat(this.bottomRight.query(t)))),i=i.filter((r,l)=>i.indexOf(r)>=l),i}clear(){this.items=[],this._isDivided=!1,this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null}getAllItems(){let t=this.items;return this._isDivided&&(t=t.concat(this.topLeft.getAllItems()),t=t.concat(this.topRight.getAllItems()),t=t.concat(this.bottomLeft.getAllItems()),t=t.concat(this.bottomRight.getAllItems())),t=t.filter((i,r)=>t.indexOf(i)>=r),t}getTreeDepth(){return this._isDivided?1+Math.max(this.topLeft.getTreeDepth(),this.topRight.getTreeDepth(),this.bottomLeft.getTreeDepth(),this.bottomRight.getTreeDepth()):0}debug(t){this.bounds.draw(t,nt.Yellow),this._isDivided&&(this.topLeft.bounds.draw(t,nt.Yellow),this.topRight.bounds.draw(t,nt.Yellow),this.bottomLeft.bounds.draw(t,nt.Yellow),this.bottomRight.bounds.draw(t,nt.Yellow))}}function hp(f){return!!f._initialize}function Zo(f){return!!f.onInitialize}function Rc(f){return!!f._preupdate}function up(f){return!!f.onPreUpdate}function cp(f){return!!f.onPostUpdate}function Ko(f){return!!f.onPostUpdate}function dp(f){return!!f.onPreDraw}function fp(f){return!!f.onPostDraw}class Nh{constructor(t,i=nt.Magenta,r=!1){this.path=t,this.color=i,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new $t(t,"arraybuffer",r),this._transparentColor=i}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){const t=await this._resource.load();this._stream=new Ic(t),this._gif=new zh(this._stream,this._transparentColor);const i=this._gif.images.map(r=>new rs(r.src,!1));return await Promise.all(i.map(r=>r.load())),this.data=this._textures=i}isLoaded(){return!!this.data}toSprite(t=0){return this._textures[t].toSprite()}toSpriteSheet(){const t=this._textures.map(i=>i.toSprite());return new yn({sprites:t})}toAnimation(t){const i=this.toSpriteSheet(),r=i.sprites.length;return this._animation=Cn.fromSpriteSheet(i,J(0,r),t),this._animation}get readCheckBytes(){return this._gif.checkBytes}}const Jo=f=>f.reduce(function(t,i){return t*2+i},0),Uh=f=>{const t=[];for(let i=7;i>=0;i--)t.push(!!(f&1<<i));return t};class Ic{constructor(t){if(this.data=null,this.len=0,this.position=0,this.readByte=()=>{if(this.position>=this.data.byteLength)throw new Error("Attempted to read past end of stream.");return this.data[this.position++]},this.readBytes=i=>{const r=[];for(let l=0;l<i;l++)r.push(this.readByte());return r},this.read=i=>{let r="";for(let l=0;l<i;l++)r+=String.fromCharCode(this.readByte());return r},this.readUnsigned=()=>{const i=this.readBytes(2);return(i[1]<<8)+i[0]},this.data=new Uint8Array(t),this.len=this.data.byteLength,this.len===0)throw new Error("No data loaded from file")}}const pp=function(f,t){let i=0;const r=function(M){let z=0;for(let W=0;W<M;W++)t.charCodeAt(i>>3)&1<<(i&7)&&(z|=1<<W),i++;return z},l=[],c=1<<f,g=c+1;let m=f+1,w=[];const C=function(){w=[],m=f+1;for(let M=0;M<c;M++)w[M]=[M];w[c]=[],w[g]=null};let A,T;for(;;){if(T=A,A=r(m),A===c){C();continue}if(A===g)break;if(A<w.length)T!==c&&w.push(w[T].concat(w[A][0]));else{if(A!==w.length)throw new Error("Invalid LZW code.");w.push(w[T].concat(w[T][0]))}l.push.apply(l,w[A]),w.length===1<<m&&m<12&&m++}return l};class zh{constructor(t,i=nt.Magenta){this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=r=>{const l=[];for(let c=0;c<r;c++){const m="#"+this._st.readBytes(3).map(w=>{const C=w.toString(16);return C.length===1?"0"+C:C}).join("");l.push(m)}return l},this.readSubBlocks=()=>{let r,l;l="";do r=this._st.readByte(),l+=this._st.read(r);while(r!==0);return l},this.parseHeader=()=>{const r={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(r.sig=this._st.read(3),r.ver=this._st.read(3),r.sig!=="GIF")throw new Error("Not a GIF file.");r.width=this._st.readUnsigned(),r.height=this._st.readUnsigned();const l=Uh(this._st.readByte());r.gctFlag=l.shift(),r.colorRes=Jo(l.splice(0,3)),r.sorted=l.shift(),r.globalColorTableSize=Jo(l.splice(0,3)),r.bgColor=this._st.readByte(),r.pixelAspectRatio=this._st.readByte(),r.gctFlag&&(r.globalColorTable=this.parseColorTable(1<<r.globalColorTableSize+1),this.globalColorTable=r.globalColorTable),this._handler.hdr&&this._handler.hdr(r)&&this.checkBytes.push(this._handler.hdr)},this.parseExt=r=>{const l=C=>{this.checkBytes.push(this._st.readByte());const A=Uh(this._st.readByte());C.reserved=A.splice(0,3),C.disposalMethod=Jo(A.splice(0,3)),C.userInput=A.shift(),C.transparencyGiven=A.shift(),C.delayTime=this._st.readUnsigned(),C.transparencyIndex=this._st.readByte(),C.terminator=this._st.readByte(),this._handler.gce&&this._handler.gce(C)&&this.checkBytes.push(this._handler.gce)},c=C=>{C.comment=this.readSubBlocks(),this._handler.com&&this._handler.com(C)&&this.checkBytes.push(this._handler.com)},g=C=>{this.checkBytes.push(this._st.readByte()),C.ptHeader=this._st.readBytes(12),C.ptData=this.readSubBlocks(),this._handler.pte&&this._handler.pte(C)&&this.checkBytes.push(this._handler.pte)},m=C=>{const A=M=>{this.checkBytes.push(this._st.readByte()),M.unknown=this._st.readByte(),M.iterations=this._st.readUnsigned(),M.terminator=this._st.readByte(),this._handler.app&&this._handler.app.NETSCAPE&&this._handler.app.NETSCAPE(M)&&this.checkBytes.push(this._handler.app)},T=M=>{M.appData=this.readSubBlocks(),this._handler.app&&this._handler.app[M.identifier]&&this._handler.app[M.identifier](M)&&this.checkBytes.push(this._handler.app[M.identifier])};switch(this.checkBytes.push(this._st.readByte()),C.identifier=this._st.read(8),C.authCode=this._st.read(3),C.identifier){case"NETSCAPE":A(C);break;default:T(C);break}},w=C=>{C.data=this.readSubBlocks(),this._handler.unknown&&this._handler.unknown(C)&&this.checkBytes.push(this._handler.unknown)};switch(r.label=this._st.readByte(),r.label){case 249:r.extType="gce",l(r);break;case 254:r.extType="com",c(r);break;case 1:r.extType="pte",g(r);break;case 255:r.extType="app",m(r);break;default:r.extType="unknown",w(r);break}},this.parseImg=r=>{const l=(m,w)=>{const C=new Array(m.length),A=m.length/w,T=(Z,st)=>{const q=m.slice(st*w,(st+1)*w);C.splice.apply(C,[Z*w,w].concat(q))},M=[0,4,2,1],z=[8,8,4,2];let W=0;for(let Z=0;Z<4;Z++)for(let st=M[Z];st<A;st+=z[Z])T(st,W),W++;return C};r.leftPos=this._st.readUnsigned(),r.topPos=this._st.readUnsigned(),r.width=this._st.readUnsigned(),r.height=this._st.readUnsigned();const c=Uh(this._st.readByte());r.lctFlag=c.shift(),r.interlaced=c.shift(),r.sorted=c.shift(),r.reserved=c.splice(0,2),r.lctSize=Jo(c.splice(0,3)),r.lctFlag&&(r.lct=this.parseColorTable(1<<r.lctSize+1)),r.lzwMinCodeSize=this._st.readByte();const g=this.readSubBlocks();r.pixels=pp(r.lzwMinCodeSize,g),r.interlaced&&(r.pixels=l(r.pixels,r.width)),this.frames.push(r),this.arrayToImage(r),this._handler.img&&this._handler.img(r)&&this.checkBytes.push(this._handler)},this.parseBlock=()=>{const r={sentinel:this._st.readByte(),type:""};switch(String.fromCharCode(r.sentinel)){case"!":r.type="ext",this.parseExt(r);break;case",":r.type="img",this.parseImg(r);break;case";":r.type="eof",this._handler.eof&&this._handler.eof(r)&&this.checkBytes.push(this._handler.eof);break;default:throw new Error("Unknown block: 0x"+r.sentinel.toString(16))}r.type!=="eof"&&this.parseBlock()},this.arrayToImage=r=>{let l=0;const c=document.createElement("canvas");c.id=l.toString(),c.width=r.width,c.height=r.height,l++;const g=c.getContext("2d"),m=1;let w=0,C=0;for(let T=0;T<r.pixels.length;T++)C%r.width===0&&(w++,C=0),this.globalColorTable[r.pixels[T]]===this._transparentColor.toHex()?g.fillStyle="rgba(0, 0, 0, 0)":g.fillStyle=this.globalColorTable[r.pixels[T]],g.fillRect(C,w,m,m),C++;const A=new Image;A.src=c.toDataURL(),this.images.push(A)},this._st=t,this._handler={},this._transparentColor=i,this.parseHeader(),this.parseBlock()}}class Hh{constructor(t,i,{bustCache:r,...l}={}){this.path=t,this.family=i,this._isLoaded=!1,this._resource=new $t(t,"blob",r),this._options=l}async load(){if(this.isLoaded())return this.data;try{const t=await this._resource.load(),i=URL.createObjectURL(t);this.data||(this.data=new FontFace(this.family,`url(${i})`),document.fonts.add(this.data)),await this.data.load(),this._isLoaded=!0}catch(t){throw`Error loading FontSource from path '${this.path}' with error [${t.message}]`}return this.data}isLoaded(){return this._isLoaded}toFont(t){return new zs({family:this.family,...this._options,...t})}}const gp=/^\s*(?:function)?\*/;function dl(f){return typeof f!="function"?!1:gp.test(Function.prototype.toString.call(f))?!0:Object.getPrototypeOf?Object.getPrototypeOf(f)===Object.getPrototypeOf(new Function("return function * () {}")()):!1}function Wh(...f){let t,i,r,l;dl(f[0])&&(i=globalThis,t=f[0],r=f[1]),dl(f[1])&&(i=f[0],t=f[1],r=f[2]),f[1]instanceof Ie&&(i=f[0],l=f[1],t=f[2],r=f[3]),f[0]instanceof Ie&&(i=globalThis,l=f[0],t=f[1],r=f[2]);const c=r==null?void 0:r.timing;let g;try{g=l??Ie.useEngine()}catch{throw Error(`Cannot run coroutine without engine parameter outside of an excalibur lifecycle method.
Pass an engine parameter to ex.coroutine(engine, function * {...})`)}const m=t.bind(i);return new Promise((w,C)=>{const A=m(),T=M=>{try{const{done:z,value:W}=A.next(M);z&&w(),W instanceof Promise?W.then(()=>{g.clock.schedule(T,0,c)}):W===void 0||W===void 0?g.clock.schedule(T,0,c):g.clock.schedule(T,W||0,c)}catch(z){C(z)}};T(g.clock.elapsed())})}class fl extends ni{get progress(){return this._currentProgress}get complete(){return this.direction==="out"?this.progress>=1:this.progress<=0}constructor(t){var i,r,l,c;super(),this._logger=gt.getInstance(),this.transform=new yt,this.graphics=new Ge,this._completeFuture=new x,this.started=!1,this._currentDistance=0,this._currentProgress=0,this.done=this._completeFuture.promise,this.name=`Transition#${this.id}`,this.duration=t.duration,this.easing=(i=t.easing)!==null&&i!==void 0?i:V.Linear,this.direction=(r=t.direction)!==null&&r!==void 0?r:"out",this.hideLoader=(l=t.hideLoader)!==null&&l!==void 0?l:!1,this.blockInput=(c=t.blockInput)!==null&&c!==void 0?c:!1,this.transform.coordPlane=Me.Screen,this.transform.pos=D.Zero,this.transform.z=1/0,this.graphics.anchor=D.Zero,this.addComponent(this.transform),this.addComponent(this.graphics),this.direction==="out"?this._currentProgress=0:this._currentProgress=1}updateTransition(t,i){this.complete||(this._currentDistance+=G(i/this.duration,0,1),this._currentDistance>=1&&(this._currentDistance=1),this.direction==="out"?this._currentProgress=G(this.easing(this._currentDistance,0,1,1),0,1):this._currentProgress=G(this.easing(this._currentDistance,1,0,1),0,1))}async onPreviousSceneDeactivate(t){}onStart(t){}onUpdate(t){}onEnd(t){}onReset(){}reset(){this.started=!1,this._completeFuture=new x,this.done=this._completeFuture.promise,this._currentDistance=0,this.direction==="out"?this._currentProgress=0:this._currentProgress=1,this.onReset()}play(t,i){this.started&&(this.reset(),this._logger.warn(`Attempted to play a transition ${this.name} that is already playing, reset transition.`)),(i??t.currentScene).add(this);const l=this;return Wh(t,function*(){for(;!l.complete;){const c=yield;l.updateTransition(t,c),l.execute()}})}execute(){this.isInitialized&&(this.started||(this.started=!0,this.onStart(this.progress)),this.onUpdate(this.progress),this.complete&&!this._completeFuture.isCompleted&&(this.onEnd(this.progress),this._completeFuture.resolve()))}}class Dc extends fl{constructor(t){var i,r;super({...t,duration:(i=t.duration)!==null&&i!==void 0?i:2e3}),this.name=`FadeInOut#${this.id}`,this.color=(r=t.color)!==null&&r!==void 0?r:nt.Black}onInitialize(t){this.transform.pos=t.screen.unsafeArea.topLeft,this.screenCover=new No({width:t.screen.resolution.width,height:t.screen.resolution.height,color:this.color}),this.graphics.add(this.screenCover),this.graphics.opacity=this.progress}onReset(){this.graphics.opacity=this.progress}onStart(t){this.graphics.opacity=t}onEnd(t){this.graphics.opacity=t}onUpdate(t){this.graphics.opacity=t}}class pl extends fl{constructor(t){super({direction:"in",...t}),this.name=`CrossFade#${this.id}`}async onPreviousSceneDeactivate(t){this.image=await t.engine.screenshot(!0),await this.image.decode()}onInitialize(t){this.engine=t,this.transform.pos=t.screen.unsafeArea.topLeft,this.screenCover=rs.fromHtmlImageElement(this.image).toSprite(),this.graphics.add(this.screenCover),this.transform.scale=j(1/t.screen.pixelRatio,1/t.screen.pixelRatio),this.graphics.opacity=this.progress}onStart(t){this.graphics.opacity=this.progress}onReset(){this.graphics.opacity=this.progress}onEnd(t){this.graphics.opacity=t}onUpdate(t){this.graphics.opacity=t}}class jh extends oe{constructor(t){super(),this.color=nt.Black,this.thickness=1;const{start:i,end:r,color:l,thickness:c}=t;this.start=i,this.end=r,this.color=l??this.color,this.thickness=c??this.thickness,this._localBounds=this._calculateBounds();const{width:g,height:m}=this._localBounds;this.width=g,this.height=m}get localBounds(){return this._localBounds}_calculateBounds(){const t=this.end.sub(this.start).normal(),i=this.thickness/2,r=[this.start.add(t.scale(i)),this.end.add(t.scale(i)),this.end.add(t.scale(-i)),this.start.add(t.scale(-i))];return mt.fromPoints(r)}_drawImage(t,i,r){t.drawLine(this.start,this.end,this.color,this.thickness)}clone(){return new jh({start:this.start,end:this.end,color:this.color,thickness:this.thickness})}}class gl extends er{get points(){return this._points}set points(t){this._points=t;const i=this.minPoint;this.width=this._points.reduce((r,l)=>Math.max(l.x,r),0)-i.x,this.height=this._points.reduce((r,l)=>Math.max(l.y,r),0)-i.y,this.flagDirty()}get minPoint(){const t=this._points.reduce((r,l)=>Math.min(l.x,r),1/0),i=this._points.reduce((r,l)=>Math.min(l.y,r),1/0);return j(t,i)}constructor(t){super(t),this.points=t.points,this.filtering=ae.Blended,this.rasterize()}clone(){return new gl({points:this.points.map(t=>t.clone()),...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){if(this.points&&this.points.length){t.beginPath();const i=this.minPoint.negate(),r=this.points[0].add(i);t.moveTo(r.x,r.y),this.points.forEach(l=>{t.lineTo(l.x+i.x,l.y+i.y)}),t.lineTo(r.x,r.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}const Gh=5,Yr={},Fc=()=>{for(const f in Yr)Yr[f]=0},_l=(f,t)=>{const i=_.isEnabled("suppress-obsolete-message");Yr[f]<Gh&&!i&&(gt.getInstance().warn(f),console.trace&&t.showStackTrace&&console.trace()),Yr[f]++};function Vh(f){return f={message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrace:!1,...f},function(t,i,r){if(r&&!(typeof r.value=="function"||typeof r.get=="function"||typeof r.set=="function"))throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");const c=`${`${t.name||""}${t.name&&i?".":""}${i||""}`} is marked obsolete: ${f.message}`+(f.alternateMethod?` Use ${f.alternateMethod} instead`:"");Yr[c]||(Yr[c]=0);const g=r?{...r}:t;if(!r){class m extends g{constructor(...C){_l(c,f),super(...C)}}return m}return r&&r.value?(g.value=function(){return _l(c,f),r.value.apply(this,arguments)},g):(r&&r.get&&(g.get=function(){return _l(c,f),r.get.apply(this,arguments)}),r&&r.set&&(g.set=function(){return _l(c,f),r.set.apply(this,arguments)}),g)}}class Bc{constructor(){this._queue=[]}get length(){return this._queue.length}enqueue(){const t=new x;return this._queue.push(t),t.promise}dequeue(t){this._queue.shift().resolve(t)}}class Xh{constructor(t){this._count=t,this._waitQueue=new Bc}get count(){return this._count}get waiting(){return this._waitQueue.length}async enter(){return this._count!==0?(this._count--,Promise.resolve()):this._waitQueue.enqueue()}exit(t=1){if(t!==0){for(;t!==0&&this._waitQueue.length!==0;)this._waitQueue.dequeue(null),t--;this._count+=t}}}const $h="0.29.3";d()})();I.eKr;I.yVm;I.a7j;I.U_w;I.JF2;I.htg;I.HXL;I.mcg;var yg=I.Agj;I.u6S;I.x7M;I.X55;I.m3M;I.aE5;I.YJU;I.eZi;I.GNv;I.Y56;I._0v;I.vhs;I.Z8b;I.Yfw;I.IcQ;I.Rl2;I.kgJ;I.GTT;I.ypY;I.i7d;I.fQ3;I.HlI;I.jlt;I.VQc;I.zD7;I.I0I;I.AUF;I.JoF;I.MlA;I.PZh;I.qA;I.CrD;I.dQK;I.D3r;I.Qpo;I.D9n;I.b6v;I.mvh;var wg=I.Bpo,xg=I.Q1f;I.IKv;I.fcV;I.Glf;I.uAl;I.ElT;I.MPu;I.Z8r;I.QSL;I.sPV;I.nAn;I.zCU;I.QrV;I.fF9;I.xI8;I.yar;I.SP7;I.oRy;I.f5X;I.V1c;I.Mlx;I.ZCo;I.Vy3;I.J5p;I.mL_;I.Guw;I.VKx;I.N5j;I.pgY;I.OP3;I.rl5;I.eod;var rD=I.q5Z;I.YUC;I.saR;I.hvr;I.Qol;I.Wf4;I.JCs;I.gJV;I.fWD;I.Va_;var oD=I.N$8;I._jQ;I.rxj;I.rhv;I.wCu;I.HAp;I.Zy1;I.Qev;I.bkB;I.wfL;I.sVA;I.$Gs;I.CJ0;I.NWh;I.tWi;I.xAj;I.zWh;I.i_4;I.iIx;I.c9e;I.KQV;I.weH;I.jXp;I.zzY;I.yRQ;I.MtE;I.rPj;I.KLc;I.Fir;I.V5f;I.Xj7;I.Wud;I.FVg;I.g5Y;I.YQB;I.KPb;I.nHK;I.TX_;I.r3n;I.vYh;I.hnk;I.D2R;I.n1o;I.RLG;I.fBU;I.Adb;I.bEs;I.wCy;I.CbD;I.x_C;var aD=I.pde;I.pGf;I.ibQ;I.QlN;I.shR;I.Yjk;I._u1;I.OBI;I.klh;I.s3S;I.D$R;I.xth;I.JU7;I.h9x;I.N1A;I.e_k;I.aHM;I.tlv;I.Vi9;I.ieR;I.$bb;I.VyI;I.imn;I.uqu;I.QnL;I.vnc;I.wk_;I.GH0;I._1r;I.l0X;I.HHX;I.tjk;I.rWe;I.j9l;I.NVp;I.cPK;I.XoL;I.RmF;I.DXI;I.tCD;I.oGn;I.J3D;I.vCJ;I.f9l;I.AQx;I.v9m;I.yRJ;I.EU6;I.m3O;I.Ryz;I.OxP;I.LEs;I.Ec;I.Pi5;I.gmH;I.tS;I.XxX;I.bCz;I.nYS;I.yiT;I.NHl;I.mO8;I.PXI;I.bn5;I.Ywr;I.cMd;I.Bs6;I.G0k;I.pyn;I.QeM;I.aPX;I.ITP;I.BY0;I.MFw;I.sBn;I.S3L;I.XKQ;I.ESI;I.uxz;I.o8N;I.u_r;I.RlV;I.gVA;I.M_G;I.GRB;I.kM6;I.dO8;I.jgM;I.FWq;I.s3j;I.hlw;I.B7e;I.H_X;I.S_d;I.U7E;I.Z58;I.yh2;I.ff$;I.cWi;I.NBt;I.oNz;I.QlU;I.Xey;I.jft;I.Mtr;I.ypk;I.mnM;I.bAZ;I.ABN;I.VK6;I.kxk;I.DT1;I.FLG;I.qN_;I.Z37;I.FtL;I.Z6X;I.iQT;I.ziO;I.OEF;I.uuE;I.tiv;I.T$Y;I.EYj;I.nOB;I.Tap;I.FAs;I.B_P;I.aA5;var lD=I.M4G;I.l$l;I.dLy;I.WZP;I.eB6;I.nFK;I.l9z;I.YOF;I.yhB;I.J0N;I.Miz;I.Bj4;I.Rcs;I.vJ4;I.TqC;I.nM0;I.X1u;I.SpZ;I.DX8;I.Yx$;I.HK4;I.SE$;I.qE8;I.Pz7;I.sX_;I.JuI;I.Nl$;I.OwT;I.P$G;I.mHV;I.Fx_;I.WFC;I.aDq;I.jIg;I.UH3;I.K6X;I.C1Y;I.Aw1;I.A8$;I.hsx;I.l9E;I.aSf;I.Zex;I.mXP;I.vt$;I.hCA;I.pjR;I.U43;I.pSZ;I.y17;I.jVr;I._SZ;I.xWn;I.ehJ;I.t6s;I.Eyn;function hD(){const e=lt.useRef(null),n=lt.useRef(null),[s,a]=lt.useState(!1),u=50,d=50,_=()=>{if(e.current){const x=new oD({canvasElement:e.current,displayMode:rD.FillContainer});n.current=x;const b=new yg({x:x.drawWidth/2,y:x.drawHeight-u/2,width:x.drawWidth+100,height:u,color:xg.fromHex("333333")});b.body.collisionType=wg.Fixed,x.add(b);const E=new yg({x:100,y:x.drawHeight-u,width:50,height:50,color:xg.fromHex("ff0000")});E.body.collisionType=wg.Active,E.body.bounciness=0,x.add(E),x.input.keyboard.on("press",U=>{U.key===aD.Keys.Space&&E.vel.y===0&&(E.vel.y=-600)}),x.on("postupdate",()=>{E.pos.y<x.drawHeight-u-d/2?E.vel.y+=20:(E.vel.y=0,E.pos.y=x.drawHeight-u-d/2)});const R=()=>{const U=new yg({x:x.drawWidth+50,y:x.drawHeight-u,width:50,height:50,color:xg.fromHex("0000ff")});U.body.collisionType=wg.Active,U.vel.x=-200,x.add(U),U.on("exitviewport",()=>{U.pos.x+U.width<0&&x.remove(U)})},L=new lD({fcn:()=>R(),repeats:!0,randomRange:[500,1500],interval:1e3});x.currentScene.add(L),L.start(),E.on("collisionstart",U=>{U.other===b?E.vel.y=0:(x.stop(),a(!0))}),x.start()}},v=()=>{a(!1),n.current&&(n.current.stop(),n.current=null),_()};return lt.useEffect(()=>(_(),()=>{n.current&&n.current.stop()}),[]),ct.jsx("section",{className:"flex h-full items-center p-3",children:ct.jsxs("div",{className:"flex w-full flex-col items-center justify-center",children:[ct.jsx("canvas",{ref:e}),s&&ct.jsx("div",{style:{textAlign:"center",marginTop:20},children:ct.jsx("button",{onClick:v,style:{padding:"10px 20px",fontSize:"16px"},className:"rounded-md bg-secondary px-5 py-2 text-xs",children:"Restart Game"})})]})})}const cy="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAABHNCSVQICAgIfAhkiAAAATZJREFUSEtjZCAC/P//nwWoLB6IbYBYFYiVgVgCqvUzkL4CxD+BOIORkHlAwwyBatYAsRIhtUB5N7wGAg2zBCo6AMRsRBgGUoLbQKBh/EAF14FYkkjDQMrccboQaGAtUEETCYaBlHrgM/AukeGGbCd2A4GukwaqeoLHde+BcsVAfBCIHzIyMv6FqcXqQmhkHMNjoBfQkO3Y5HEZ6AxUvAeHgS+AhuGMKFwGugEN24nDwJNAAy1wuR6Xge5ADTtwaDoKNBCUY7CCIWAgMEYdsLjdBCjWjcNXoIIgF2sMMzIeYAQa+J/E3IBL+XNg2EpR08ADQAMdqWngDKCBmdQ0sBBo4ARqGugJNHAHNQ1UAhp4H2QgtZLNIaCB/4ZATsGWSoHBMJwLh1Evg0NgNJbRE8JQr/WonbABL1K4mEmaPHoAAAAASUVORK5CYII=",uD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAsCAYAAAD8WEF4AAAABHNCSVQICAgIfAhkiAAABIxJREFUWEe1mT1oFEEUx+8UURH8AAsFwaSwEAsTFMXGXAqxUTSkE8EEi5Qq+NEIRu1UUNsgehZiIxgsVFAwCoKiaMRGUPAshFj5AaIoeP7/4e3xbnZmdmZ3MjDZze7Me7+Zee/tm7l6u92+VKvVDqGGlm9o2Fuv13mdkwKmSQjeI8Lf4NqgvjpeLMc/06hrIzRPovNQRPvgpuBpovEB6fBdQMlXq/MPGjRweaQkfsJ9y6KhD8+WyfMjAOaqJCvgOAxhF5XAfuiYBe3ACrA2B4KyYddSQ9gInl+TvnzHNrZBRQ/AkM3+o5Dd1IJmZzYr6MBRbJT/L6MxR9pVDHuaQpvBaLK8TK4YV5YmyWJdNROWnV4rWUOAobHrAVFgCzWJOWDwPaIzA70OnSO2CeiCZQN0HsfllDS2ej7a7MX720pgl22FzrQ4N2eUk8TyGKANV/8crABrc7B6vuG101DSHwqZtYOMKdwPyP+dEBULy6UhcLbULnPQIe80gLkqQcUSovqKnNU6szK7OoxYPd8S8gahkLPlLUaI6oqlvo5OWAHWy2T1fOML2EK/XMjTACEhKsoMlE0Ver44CQflDXky+KAQVQpWFGjPpzlwqTtfFQWhQ17OHGJCVGlYgdGJhdXzfSEvNkRVhTXNwer5xhewE/KM54UhqhKszG4DV53s5D4EgKJN0n47IQ/3NCOdRRWGqMqwAqyTHdotbdNMdnTI+402i0R5cIhKBUtz0B8CV7KjQ16mO5dFuaCSwDrMweX5H5XSm1iBfbFwZnvvR8El3PD8FtrZct8reH5QZCTJfUvBygzrZKeJmRs1B4dBveJA5Hnl3LcKbJncNyrZSWIGmRDDHP7i+QbM8HutJFXuS5mlZ1YBa8+fAexqizl0hbwyuW8qWO4qxhXgCcCcM2Y3KOQVRYtKM4sl3gEF91HnKUVJc189gNKwAGVK+BR1iQicwXWVz/Njc98kDgalayDohYJ7gvth1A+o3l1vyHbfZQ7RMwtlnEmCrheh73DdCjv9YXh+aO6b298lgQXMfAi6h0pbZfmCugmgnzMFxiFIdO7rc7KomQXIVQjLvlS/ZEbfagWSaLeUOUTlvklgAXEUgs6LsH+47saM3rUJt+x6bblvD/p6t/um7KCZhfJd6HgHNWs/BtAJ3yyEeL6xJS9MdgphIXAzoOjtiwXuAkCP+UD5TswhNvf1JjtF5wZcKnr+SoHj+dYwYNtFsAJsJjuu3Febg/Pc13cisxQKX6KuE7BnuA4A9E8IaNYmMPc1t/vWc1/XwdwCKHtAOFHKk3AK+BoDqoB17us66Cvc7rtgb0BRtg0h4BaA8utUqsiuN/bcNxfybOezJ0F0Vqi45Fx6mkClYvH8XsvOWJsD9dl/UxCH4Pf9llDRiehM+tC4KvCUMi2XOThz387MYuTbIIiHGAuF6DhAs49AJUhluz2493q+L+RlPy3R45+jrhDBEwAdS0JoCDHMIVTFbMjjj3YE5C6Uo2Z5iLoTL/lJnZNiJDshOlpo1E/YM7jZLj3o+fsB+jNEQtk2stQMVTGl+R/V8GS18NcxwwAAAABJRU5ErkJggg==",cD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAw9JREFUWEetl4910zAQxusJgAlIJyCdgGQCygQ4E1AmoJ0AOgHpBLQTECagTEA6AWWC8P307vwusuTaTfSenu3T6e67v5Kbk8LY7XYzkT9oLmzZnyX2Gm2rBZ+3TdPclRibSDTF34LiKQqf4gXMVwG5jowdACmfa+GH5suKpAez6ClFrL8dYFoLxMrXEwCz/FdQ/g+0mrjufozGEo/kYgzhu8hAXUsutBMHgOUwMn7zLobH5yqugGlFJ7w+ltKxacz6P0bF8tmxlEs2iTzTxOJHfV/q/bPpuhGtBUAkXonI98FDcnHxFxN0L7lnFpKtaC+gi9YAYKN3T5qzsTHXvphoD9qH4G5o/VYf75yALt4z+nIPgDPVzLdw4cJzzbxaSFbK7MYULfQEBNZ2SZd5PAHY5ShLAMTWmktrZerb8Oh7izm85FRXSb2QBwC4cTagPGYwyYoiF4xH3oS90MnyXiVJH7zfjfcqeuCnNuC2vVHoEbj4IhcuvuhyZHRujwKNj7JnjAKwFiPlxEilU/ISNOumG72mLNc4LSQnQCcB+KsNxHJUj8hi/EkA6KjdmOSBjPlOwojf4MgaWy+shwAY3aRCYh8VQDGpSu44JoCZFPg5kdrpiBDEMusl7aQQWGZT017j1DZZXh1SEE9WGhLd8HlJaABaPb0J0VgAUbwjSDl88DOKjW2yBwwEVvvhAwhKC/dubZ1Dh9NvEYztWW+88BT7QDoeS761YxQQsd2WWJ22kqh1RVY8plMnxIrXMNcAGHKa0aXmxwHN3BvboTzJGtUqvw+8Kh0gUaE1GjI9NiWM4P64l3AVDxA+NyIdx7jKe30xbkO+nromfVx+57bvFACtPjzLN7JiOVXoWP6sAlKV+DWJzPYTrJpAYxVVXE8Okf1ufTqoHEDMTPaTbOkme4hS32uWc0F15STrHPnxzyjmAntRvtH0prPVO3PMWBgTVvPuiiFzrPPfkeTm/4YxQ8comsqD5eexk/Yaj7mrFaNXxlQlJX4UYxz/hXthLXY+l2Bg+HSXTgHjIdt6yy5t/g9cxM+6jM9e3QAAAABJRU5ErkJggg==",dD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAuCAYAAABap1twAAAABHNCSVQICAgIfAhkiAAAAvRJREFUWEftmItV2zAUhvEEpRM0maB0gsIEhQlqNmgnwJmgZYLCBA0TECZoO0HTDWCC8H9GShVHL2NRTE/uOYpzrNen+5Lkas/IarU6099aZWLfPdNzrnlnVVX9ZP6KH8F91+P4mYBC054Icl4JrlELtDc2uRXQFMDfIzBrSDmnAK7GpjqHZ7YDHGidnQYHKlD58H8Okhuph2x/qPI2oKorvSefHUTaxLTcW4N/NNpXFbajjyonBgBQQFwBaqLyQ+VSZalSq3xSeZVp+16AMwPHlsjEc7tfxiaTC+2rnj48Fwb0Qs8PGZDZgJeCqTXZQQ5UaGL1Z2F7GmOp/2j0TQIyG/DdEDAfhAAx97cSgL8Ehz8VFWN6tBjzxywNfhYggVFcBIkvEmwhyQKc4jPF6TSgAAkezqKPBnwS87o0iY0iqcFzaY+8tSUaGAevVdAup9/2iG5F9fT7okJ+xE0wp2+chV6+D6gwCdgeu7udnclt1ULtjhw4gooEbeVW9a8DgI3eh070SUCv//muCQJo7zeI6g/1uO4AHakJ2tqQhB/GAd1J3VE9OexKbdeXLpOQuUpYuVM9O8mWBBZj20UBowGigUk9tQpaqQWwsRebRWA+3lO/4aOdBYeuHVHAGw2KqZ5cIpHcD5C9WLT7Pl/KWYUxJ3vxhi8+FvDhXrptOnyNFEKCxfeWMTizKNIIR7PGA4eVugGV5YM0wm9Off7jBAqAtHN9jICw50GiG7CL7kJMBJNPvQGk98k0Y8ds9IekvQ4EJ1HnWJdFrgFNlNtvQbH+2YB2EKspQL07TGA22hP1aNVqNmdhvQFzBi3ZZgc4VJs7Db5YDd6JPOdu3JqY1BH6MjBUA6H+3LFJUynIFrBWw9T1rzToucmLHIZjypnZj+hk+djtqjTgUjvL1Fw9FxHIB0DEnDRQe2hfLA15zNaZgPwLWHr2PuMZSKzY/V4zDkDHil1XGxegcbVGT3vLGx+ggbSZZZyABpKT+2QdxX2c+l+2vQfOkqOdRa6s+AAAAABJRU5ErkJggg==",fD="/ais-telegram-webpages/assets/msw-6jIDzMdt.png",S1="/ais-telegram-webpages/assets/mgg-jRCbbsf_.png";function pD({task:e}){return ct.jsxs("div",{className:"task-card",children:[ct.jsx(ba,{src:e.icon}),ct.jsx("div",{className:"instruction",children:e.instruction}),ct.jsx("div",{className:"reward",children:ct.jsx("span",{children:e.reward})}),ct.jsx(xm,{className:"cta-button",children:"Go"})]})}function gD(){const e=[{link:"/msw",icon:S1,instruction:"Join the MGG Community",reward:"1000000"},{link:"/mgg",icon:fD,instruction:"Join the MSW Community",reward:"1000000"},{link:"/facebook",icon:cy,instruction:"Follow us on Facebook",reward:"1000000"},{link:"/x",icon:uD,instruction:"Follow us on X",reward:"1000000"},{link:"/instagram",icon:cD,instruction:"Follow us on Instagram",reward:"1000000"},{link:"/discord-mgg",icon:dD,instruction:"Join MGG Discord server",reward:"1000000"},{link:"/discord-msw",icon:cy,instruction:"Join MSW Discord server",reward:"1000000"}];return ct.jsxs("section",{className:"flex-1 items-center overflow-auto",children:[ct.jsx("h1",{className:"py-3 text-center text-4xl font-bold text-white",children:"Tasks"}),ct.jsx("div",{className:"flex w-auto flex-col items-center gap-3 p-3",children:e.map((n,s)=>ct.jsx(pD,{task:n},s))})]})}/**
 * @remix-run/router v1.19.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hu(){return Hu=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Hu.apply(this,arguments)}var ro;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ro||(ro={}));const dy="popstate";function _D(e){e===void 0&&(e={});function n(a,u){let{pathname:d,search:_,hash:v}=a.location;return S_("",{pathname:d,search:_,hash:v},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function s(a,u){return typeof u=="string"?u:E1(u)}return vD(n,s,null,e)}function fi(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function A1(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function mD(){return Math.random().toString(36).substr(2,8)}function fy(e,n){return{usr:e.state,key:e.key,idx:n}}function S_(e,n,s,a){return s===void 0&&(s=null),Hu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?Kl(n):n,{state:s,key:n&&n.key||a||mD()})}function E1(e){let{pathname:n="/",search:s="",hash:a=""}=e;return s&&s!=="?"&&(n+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(n+=a.charAt(0)==="#"?a:"#"+a),n}function Kl(e){let n={};if(e){let s=e.indexOf("#");s>=0&&(n.hash=e.substr(s),e=e.substr(0,s));let a=e.indexOf("?");a>=0&&(n.search=e.substr(a),e=e.substr(0,a)),e&&(n.pathname=e)}return n}function vD(e,n,s,a){a===void 0&&(a={});let{window:u=document.defaultView,v5Compat:d=!1}=a,_=u.history,v=ro.Pop,x=null,b=E();b==null&&(b=0,_.replaceState(Hu({},_.state,{idx:b}),""));function E(){return(_.state||{idx:null}).idx}function R(){v=ro.Pop;let G=E(),k=G==null?null:G-b;b=G,x&&x({action:v,location:$.location,delta:k})}function L(G,k){v=ro.Push;let B=S_($.location,G,k);b=E()+1;let N=fy(B,b),J=$.createHref(B);try{_.pushState(N,"",J)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;u.location.assign(J)}d&&x&&x({action:v,location:$.location,delta:1})}function U(G,k){v=ro.Replace;let B=S_($.location,G,k);b=E();let N=fy(B,b),J=$.createHref(B);_.replaceState(N,"",J),d&&x&&x({action:v,location:$.location,delta:0})}function H(G){let k=u.location.origin!=="null"?u.location.origin:u.location.href,B=typeof G=="string"?G:E1(G);return B=B.replace(/ $/,"%20"),fi(k,"No window.location.(origin|href) available to create URL for href: "+B),new URL(B,k)}let $={get action(){return v},get location(){return e(u,_)},listen(G){if(x)throw new Error("A history only accepts one active listener");return u.addEventListener(dy,R),x=G,()=>{u.removeEventListener(dy,R),x=null}},createHref(G){return n(u,G)},createURL:H,encodeLocation(G){let k=H(G);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:L,replace:U,go(G){return _.go(G)}};return $}var py;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(py||(py={}));function yD(e,n,s){return s===void 0&&(s="/"),wD(e,n,s,!1)}function wD(e,n,s,a){let u=typeof n=="string"?Kl(n):n,d=R1(u.pathname||"/",s);if(d==null)return null;let _=T1(e);xD(_);let v=null;for(let x=0;v==null&&x<_.length;++x){let b=FD(d);v=ID(_[x],b,a)}return v}function T1(e,n,s,a){n===void 0&&(n=[]),s===void 0&&(s=[]),a===void 0&&(a="");let u=(d,_,v)=>{let x={relativePath:v===void 0?d.path||"":v,caseSensitive:d.caseSensitive===!0,childrenIndex:_,route:d};x.relativePath.startsWith("/")&&(fi(x.relativePath.startsWith(a),'Absolute route path "'+x.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),x.relativePath=x.relativePath.slice(a.length));let b=fa([a,x.relativePath]),E=s.concat(x);d.children&&d.children.length>0&&(fi(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),T1(d.children,n,E,b)),!(d.path==null&&!d.index)&&n.push({path:b,score:PD(b,d.index),routesMeta:E})};return e.forEach((d,_)=>{var v;if(d.path===""||!((v=d.path)!=null&&v.includes("?")))u(d,_);else for(let x of P1(d.path))u(d,_,x)}),n}function P1(e){let n=e.split("/");if(n.length===0)return[];let[s,...a]=n,u=s.endsWith("?"),d=s.replace(/\?$/,"");if(a.length===0)return u?[d,""]:[d];let _=P1(a.join("/")),v=[];return v.push(..._.map(x=>x===""?d:[d,x].join("/"))),u&&v.push(..._),v.map(x=>e.startsWith("/")&&x===""?"/":x)}function xD(e){e.sort((n,s)=>n.score!==s.score?s.score-n.score:RD(n.routesMeta.map(a=>a.childrenIndex),s.routesMeta.map(a=>a.childrenIndex)))}const bD=/^:[\w-]+$/,CD=3,SD=2,AD=1,ED=10,TD=-2,gy=e=>e==="*";function PD(e,n){let s=e.split("/"),a=s.length;return s.some(gy)&&(a+=TD),n&&(a+=SD),s.filter(u=>!gy(u)).reduce((u,d)=>u+(bD.test(d)?CD:d===""?AD:ED),a)}function RD(e,n){return e.length===n.length&&e.slice(0,-1).every((a,u)=>a===n[u])?e[e.length-1]-n[n.length-1]:0}function ID(e,n,s){let{routesMeta:a}=e,u={},d="/",_=[];for(let v=0;v<a.length;++v){let x=a[v],b=v===a.length-1,E=d==="/"?n:n.slice(d.length)||"/",R=_y({path:x.relativePath,caseSensitive:x.caseSensitive,end:b},E),L=x.route;if(!R&&b&&s&&!a[a.length-1].route.index&&(R=_y({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},E)),!R)return null;Object.assign(u,R.params),_.push({params:u,pathname:fa([d,R.pathname]),pathnameBase:ND(fa([d,R.pathnameBase])),route:L}),R.pathnameBase!=="/"&&(d=fa([d,R.pathnameBase]))}return _}function _y(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=DD(e.path,e.caseSensitive,e.end),u=n.match(s);if(!u)return null;let d=u[0],_=d.replace(/(.)\/+$/,"$1"),v=u.slice(1);return{params:a.reduce((b,E,R)=>{let{paramName:L,isOptional:U}=E;if(L==="*"){let $=v[R]||"";_=d.slice(0,d.length-$.length).replace(/(.)\/+$/,"$1")}const H=v[R];return U&&!H?b[L]=void 0:b[L]=(H||"").replace(/%2F/g,"/"),b},{}),pathname:d,pathnameBase:_,pattern:e}}function DD(e,n,s){n===void 0&&(n=!1),s===void 0&&(s=!0),A1(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],u="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_,v,x)=>(a.push({paramName:v,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),u+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?u+="\\/*$":e!==""&&e!=="/"&&(u+="(?:(?=\\/|$))"),[new RegExp(u,n?void 0:"i"),a]}function FD(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return A1(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function R1(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let s=n.endsWith("/")?n.length-1:n.length,a=e.charAt(s);return a&&a!=="/"?null:e.slice(s)||"/"}function BD(e,n){n===void 0&&(n="/");let{pathname:s,search:a="",hash:u=""}=typeof e=="string"?Kl(e):e;return{pathname:s?s.startsWith("/")?s:kD(s,n):n,search:UD(a),hash:zD(u)}}function kD(e,n){let s=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(u=>{u===".."?s.length>1&&s.pop():u!=="."&&s.push(u)}),s.length>1?s.join("/"):"/"}function bg(e,n,s,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function LD(e){return e.filter((n,s)=>s===0||n.route.path&&n.route.path.length>0)}function MD(e,n){let s=LD(e);return n?s.map((a,u)=>u===s.length-1?a.pathname:a.pathnameBase):s.map(a=>a.pathnameBase)}function OD(e,n,s,a){a===void 0&&(a=!1);let u;typeof e=="string"?u=Kl(e):(u=Hu({},e),fi(!u.pathname||!u.pathname.includes("?"),bg("?","pathname","search",u)),fi(!u.pathname||!u.pathname.includes("#"),bg("#","pathname","hash",u)),fi(!u.search||!u.search.includes("#"),bg("#","search","hash",u)));let d=e===""||u.pathname==="",_=d?"/":u.pathname,v;if(_==null)v=s;else{let R=n.length-1;if(!a&&_.startsWith("..")){let L=_.split("/");for(;L[0]==="..";)L.shift(),R-=1;u.pathname=L.join("/")}v=R>=0?n[R]:"/"}let x=BD(u,v),b=_&&_!=="/"&&_.endsWith("/"),E=(d||_===".")&&s.endsWith("/");return!x.pathname.endsWith("/")&&(b||E)&&(x.pathname+="/"),x}const fa=e=>e.join("/").replace(/\/\/+/g,"/"),ND=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),UD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,zD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function HD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const I1=["post","put","patch","delete"];new Set(I1);const WD=["get",...I1];new Set(WD);/**
 * React Router v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wu(){return Wu=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Wu.apply(this,arguments)}const Pm=lt.createContext(null),jD=lt.createContext(null),Tf=lt.createContext(null),Pf=lt.createContext(null),Jl=lt.createContext({outlet:null,matches:[],isDataRoute:!1}),D1=lt.createContext(null);function Rf(){return lt.useContext(Pf)!=null}function F1(){return Rf()||fi(!1),lt.useContext(Pf).location}function B1(e){lt.useContext(Tf).static||lt.useLayoutEffect(e)}function GD(){let{isDataRoute:e}=lt.useContext(Jl);return e?nF():VD()}function VD(){Rf()||fi(!1);let e=lt.useContext(Pm),{basename:n,future:s,navigator:a}=lt.useContext(Tf),{matches:u}=lt.useContext(Jl),{pathname:d}=F1(),_=JSON.stringify(MD(u,s.v7_relativeSplatPath)),v=lt.useRef(!1);return B1(()=>{v.current=!0}),lt.useCallback(function(b,E){if(E===void 0&&(E={}),!v.current)return;if(typeof b=="number"){a.go(b);return}let R=OD(b,JSON.parse(_),d,E.relative==="path");e==null&&n!=="/"&&(R.pathname=R.pathname==="/"?n:fa([n,R.pathname])),(E.replace?a.replace:a.push)(R,E.state,E)},[n,a,_,d,e])}function XD(e,n){return $D(e,n)}function $D(e,n,s,a){Rf()||fi(!1);let{navigator:u}=lt.useContext(Tf),{matches:d}=lt.useContext(Jl),_=d[d.length-1],v=_?_.params:{};_&&_.pathname;let x=_?_.pathnameBase:"/";_&&_.route;let b=F1(),E;if(n){var R;let G=typeof n=="string"?Kl(n):n;x==="/"||(R=G.pathname)!=null&&R.startsWith(x)||fi(!1),E=G}else E=b;let L=E.pathname||"/",U=L;if(x!=="/"){let G=x.replace(/^\//,"").split("/");U="/"+L.replace(/^\//,"").split("/").slice(G.length).join("/")}let H=yD(e,{pathname:U}),$=KD(H&&H.map(G=>Object.assign({},G,{params:Object.assign({},v,G.params),pathname:fa([x,u.encodeLocation?u.encodeLocation(G.pathname).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?x:fa([x,u.encodeLocation?u.encodeLocation(G.pathnameBase).pathname:G.pathnameBase])})),d,s,a);return n&&$?lt.createElement(Pf.Provider,{value:{location:Wu({pathname:"/",search:"",hash:"",state:null,key:"default"},E),navigationType:ro.Pop}},$):$}function YD(){let e=iF(),n=HD(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,u={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return lt.createElement(lt.Fragment,null,lt.createElement("h2",null,"Unexpected Application Error!"),lt.createElement("h3",{style:{fontStyle:"italic"}},n),s?lt.createElement("pre",{style:u},s):null,null)}const QD=lt.createElement(YD,null);class qD extends lt.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,s){return s.location!==n.location||s.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:s.error,location:s.location,revalidation:n.revalidation||s.revalidation}}componentDidCatch(n,s){console.error("React Router caught the following error during render",n,s)}render(){return this.state.error!==void 0?lt.createElement(Jl.Provider,{value:this.props.routeContext},lt.createElement(D1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ZD(e){let{routeContext:n,match:s,children:a}=e,u=lt.useContext(Pm);return u&&u.static&&u.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(u.staticContext._deepestRenderedBoundaryId=s.route.id),lt.createElement(Jl.Provider,{value:n},a)}function KD(e,n,s,a){var u;if(n===void 0&&(n=[]),s===void 0&&(s=null),a===void 0&&(a=null),e==null){var d;if(!s)return null;if(s.errors)e=s.matches;else if((d=a)!=null&&d.v7_partialHydration&&n.length===0&&!s.initialized&&s.matches.length>0)e=s.matches;else return null}let _=e,v=(u=s)==null?void 0:u.errors;if(v!=null){let E=_.findIndex(R=>R.route.id&&(v==null?void 0:v[R.route.id])!==void 0);E>=0||fi(!1),_=_.slice(0,Math.min(_.length,E+1))}let x=!1,b=-1;if(s&&a&&a.v7_partialHydration)for(let E=0;E<_.length;E++){let R=_[E];if((R.route.HydrateFallback||R.route.hydrateFallbackElement)&&(b=E),R.route.id){let{loaderData:L,errors:U}=s,H=R.route.loader&&L[R.route.id]===void 0&&(!U||U[R.route.id]===void 0);if(R.route.lazy||H){x=!0,b>=0?_=_.slice(0,b+1):_=[_[0]];break}}}return _.reduceRight((E,R,L)=>{let U,H=!1,$=null,G=null;s&&(U=v&&R.route.id?v[R.route.id]:void 0,$=R.route.errorElement||QD,x&&(b<0&&L===0?(H=!0,G=null):b===L&&(H=!0,G=R.route.hydrateFallbackElement||null)));let k=n.concat(_.slice(0,L+1)),B=()=>{let N;return U?N=$:H?N=G:R.route.Component?N=lt.createElement(R.route.Component,null):R.route.element?N=R.route.element:N=E,lt.createElement(ZD,{match:R,routeContext:{outlet:E,matches:k,isDataRoute:s!=null},children:N})};return s&&(R.route.ErrorBoundary||R.route.errorElement||L===0)?lt.createElement(qD,{location:s.location,revalidation:s.revalidation,component:$,error:U,children:B(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):B()},null)}var k1=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(k1||{}),rf=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(rf||{});function JD(e){let n=lt.useContext(Pm);return n||fi(!1),n}function tF(e){let n=lt.useContext(jD);return n||fi(!1),n}function eF(e){let n=lt.useContext(Jl);return n||fi(!1),n}function L1(e){let n=eF(),s=n.matches[n.matches.length-1];return s.route.id||fi(!1),s.route.id}function iF(){var e;let n=lt.useContext(D1),s=tF(rf.UseRouteError),a=L1(rf.UseRouteError);return n!==void 0?n:(e=s.errors)==null?void 0:e[a]}function nF(){let{router:e}=JD(k1.UseNavigateStable),n=L1(rf.UseNavigateStable),s=lt.useRef(!1);return B1(()=>{s.current=!0}),lt.useCallback(function(u,d){d===void 0&&(d={}),s.current&&(typeof u=="number"?e.navigate(u):e.navigate(u,Wu({fromRouteId:n},d)))},[e,n])}function Pd(e){fi(!1)}function sF(e){let{basename:n="/",children:s=null,location:a,navigationType:u=ro.Pop,navigator:d,static:_=!1,future:v}=e;Rf()&&fi(!1);let x=n.replace(/^\/*/,"/"),b=lt.useMemo(()=>({basename:x,navigator:d,static:_,future:Wu({v7_relativeSplatPath:!1},v)}),[x,v,d,_]);typeof a=="string"&&(a=Kl(a));let{pathname:E="/",search:R="",hash:L="",state:U=null,key:H="default"}=a,$=lt.useMemo(()=>{let G=R1(E,x);return G==null?null:{location:{pathname:G,search:R,hash:L,state:U,key:H},navigationType:u}},[x,E,R,L,U,H,u]);return $==null?null:lt.createElement(Tf.Provider,{value:b},lt.createElement(Pf.Provider,{children:s,value:$}))}function rF(e){let{children:n,location:s}=e;return XD(A_(n),s)}new Promise(()=>{});function A_(e,n){n===void 0&&(n=[]);let s=[];return lt.Children.forEach(e,(a,u)=>{if(!lt.isValidElement(a))return;let d=[...n,u];if(a.type===lt.Fragment){s.push.apply(s,A_(a.props.children,d));return}a.type!==Pd&&fi(!1),!a.props.index||!a.props.children||fi(!1);let _={id:a.props.id||d.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(_.children=A_(a.props.children,d)),s.push(_)}),s}/**
 * React Router DOM v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const oF="6";try{window.__reactRouterVersion=oF}catch{}const aF="startTransition",my=BE[aF];function lF(e){let{basename:n,children:s,future:a,window:u}=e,d=lt.useRef();d.current==null&&(d.current=_D({window:u,v5Compat:!0}));let _=d.current,[v,x]=lt.useState({action:_.action,location:_.location}),{v7_startTransition:b}=a||{},E=lt.useCallback(R=>{b&&my?my(()=>x(R)):x(R)},[x,b]);return lt.useLayoutEffect(()=>_.listen(E),[_,E]),lt.createElement(sF,{basename:n,children:s,location:v.location,navigationType:v.action,navigator:_,future:a})}var vy;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(vy||(vy={}));var yy;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(yy||(yy={}));const hF="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAgCAYAAAB6kdqOAAAABHNCSVQICAgIfAhkiAAAAVlJREFUWEft1m0RwjAMBmDqAAk4YBJACVjAwXCAA0ABEhgOkAAOhgJ4C+tuK2uT9IMf3HbXP3RNH9I2nXrimeR9jkqptT0Fpp3itxPaBv1X068yg3yYMxAFWo22NKicIA7GJKZF5QJJMH3UwJJd8EYVsa1qpH/n2DNmmVzh70MZ2iJgGQH6GtpsYArzwMBFdpAIg9OWFSTF6NRmA4VggkCugtbdOKEYMciaqFfQDCgGIwI5JuqhYjFsEDHRG4V2Q+Md7c7dZdcI1qYG6ICBK09t0igN0neT6/nUGQ9GmqEKA+aBBZOFYYP0i82yhaCcGMQs7Iyxlsw6QRKUD7NH3Lt9TYlAwkxRmDXifd2bYhATxcHoUGlABIqLSQtyoLynaeDbK12GBjb6jKozPwF1MjWjit7PQNxiOYKoTP1Nhqg/mrKfdexTTkjFGkFBGSqpURn7KxRT/TnTPi+ImnZn2O6OawAAAABJRU5ErkJggg==",uF="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAXCAYAAACf+8ZRAAAABHNCSVQICAgIfAhkiAAAAmhJREFUWEfFl481BDEQh20FdOBU4FRgVcBVgApQgVUBKuAqQAVOBVwFVgWo4Py+ldzL7uXfsUfey3u7m5nJl8lkMlusRdpsNtvX8IH6QL2MyfY0NpGdWv2+KIqHkM3CNyDYQ32vDGxPPEubAb4S/Lir2YIW7IYEbox3l55lRQr3snss+A9rfw5tgB81MFzR5L8x+yLlPQvuQt9FPEx8oWjbqR7Wf0PxA13ifIReAy0vH5mw8NqScDeMKgme/2DimMqUGFafmN3mebejQJjcWuhXDQ5CFv8AGuDSjVvjTBbggteS2SrkZVIaoRFsfwDdeLALILZS3zhnbhsBjTAp7j+hOWR4tdXExu4TBW4bA93dggcZwPvZTTbIOM/ZCouCIU/7ouAJ6FnHxoWgq2UBPHZSJp6MADFbq++4MR1JwR//AQ3sgQU0IcAFQgq9Uie1EhakVe+dATSr3HTcskpPfwLkyRLLhNfUF9Ncl6x43jTJhftuTrWbipg05xwEz4ts4uHtVExpvIlptuEyJtxjyhvL1pFvLk9CCCGdAU38dNNKS6FH6IUDx0Tm0L1neBmRLXsj3uolmKt7hGZS5jpzDiKVZW6h1uyUhcbbxFSoCCIdzQsmeSZWXOU4DI9be6WeAU81DvFQHLVb5SWv85TVFY+PBExq/K7ybEtVewkoih4OdaiRkXKyg0+/dWMu/G6ZK5kVubk75cRreSEG3OjLNuAnKWPO+JueuYjcWr7taY/XAQl5hxhjcfzH1bkgJltVwKiHzhC7duWr/JjH+2PbgR/onV6a7wBS105yQUNy5pKy9hHDJrajTvgCAZ8NyvA3Y5cAAAAASUVORK5CYII=";function cF(){const[e,n]=lt.useState("/exchange"),s=[{key:"/",icon:S1,label:"Home"},{key:"/tasks",icon:hF,label:"Tasks"},{key:"/jumping-game",icon:uF,label:"Minigames"}],a=GD(),u=d=>{n(d),a(d)};return ct.jsx("nav",{className:"flex flex-row justify-center gap-2 bg-violet-800 px-1 py-2",children:s.map(d=>ct.jsx(G0,{className:`nav-card basis-1/6 ${e===d.key?"active":""}`,onClick:()=>u(d.key),children:ct.jsxs(G0.Body,{className:"bottomnav-card-body",children:[ct.jsx(ba,{src:d.icon,className:"img-fluid",rounded:!0,draggable:"false"}),ct.jsx("div",{className:"text-center align-text-bottom text-xs",children:d.label})]})},d.key))})}const dF=e=>new Promise((n,s)=>{const a=document.querySelector(`script[src="${e}"]`);if(a){n(a);return}const u=document.createElement("script");u.src=e,u.async=!0,u.onload=()=>n(u),u.onerror=()=>s(new Error(`Failed to load script: ${e}`)),document.head.appendChild(u)}),fF=({userData:e})=>{const{setData:n}=zu(),s="https://molesmash-cqcqevedheceb6bd.southeastasia-01.azurewebsites.net";return lt.useEffect(()=>{const a=()=>{console.log("App is about to close",e),ze.post(s+"/test")},u=d=>{ze.post(s+"/test"),a(),d.preventDefault(),d.returnValue=""};return window.addEventListener("beforeunload",u),window.addEventListener("unload",u),()=>{window.removeEventListener("unload",u),window.removeEventListener("beforeunload",u)}},[e,n]),null},pF={BASE_URL:"/ais-telegram-webpages/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BOT_SERVER_URL:"https://molesmash-cqcqevedheceb6bd.southeastasia-01.azurewebsites.net"},Rm=lt.createContext(null);function gF(){const[e,n]=lt.useState(null),[s,a]=lt.useState(!0),[u,d]=lt.useState({isError:!1}),_="https://telegram.org/js/telegram-web-app.js",v="https://molesmash-cqcqevedheceb6bd.southeastasia-01.azurewebsites.net",{sessionData:x,setPlayFabId:b,setData:E,setGameData:R}=zu();let L=!1;return console.log(pF),lt.useEffect(()=>{const U=async G=>{try{const B=await(await fetch(v+"/playFab/validate/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({initData:G})})).json();B.valid?(console.log(B),b(B.loginData.PlayFabId),E(B.userData,void 0,!1),R(B.gameData)):(console.error("Data validation failed!"),d({isError:!0,error:B.message}))}catch(k){console.error("Error validating data:",k),d({isError:!0,error:String(k)})}finally{a(!1)}};(async()=>{var G,k,B,N;try{await dF(_),console.log("Script loaded");const J=()=>window.Telegram!==void 0&&window.Telegram.WebApp!==void 0&&window.Telegram.WebApp.initData!=="";console.log(window.Telegram!==void 0),console.log((G=window.Telegram)==null?void 0:G.WebApp),console.log((B=(k=window.Telegram)==null?void 0:k.WebApp)==null?void 0:B.initData),console.log(J());let K;J()?(K=(N=window.Telegram)==null?void 0:N.WebApp,K.ready(),U(K.initData),n(K),console.log("Telegram initialized:",JSON.stringify(K)),K.expand(),K.onEvent("mainButtonClicked",()=>{console.log("Main Button Clicked")})):(L=!0,await $P(async()=>{const{mockTelegram:ft}=await import("./mockTelegramAPI-BaXyXYe0.js");return{mockTelegram:ft}},[]).then(({mockTelegram:ft})=>{var D;ft(),K=(D=window.Telegram)==null?void 0:D.WebApp,K&&(n(K),console.log("Using mock data:",JSON.stringify(K)))}))}catch(J){console.error("Error loading Telegram Web App script:",J)}})();const $=()=>{console.log("Viewport changed. App may have been resized, minimized, or put in the background.")};return()=>{var G;L||(G=window==null?void 0:window.Telegram)==null||G.WebApp.offEvent("viewportChanged",$)}},[]),ct.jsx(Rm.Provider,{value:{tgData:e,setTgData:n},children:s?ct.jsx("div",{className:"flex h-dvh w-dvw grow items-center justify-center font-bold",children:ct.jsx("p",{children:"Loading, please wait..."})}):u.isError?ct.jsx("div",{className:"flex h-dvh w-dvw grow items-center justify-center font-bold",children:ct.jsx("p",{children:"Something went wrong, please try again later."})}):ct.jsxs(ct.Fragment,{children:[ct.jsx(lF,{basename:"/ais-telegram-webpages",children:ct.jsxs("main",{className:"flex h-dvh flex-col overflow-hidden bg-violet-900",children:[ct.jsx("div",{className:"flex flex-1 flex-col overflow-hidden",children:ct.jsxs(rF,{children:[ct.jsx(Pd,{path:"/",element:ct.jsx(nD,{})}),ct.jsx(Pd,{path:"/tasks",element:ct.jsx(gD,{})}),ct.jsx(Pd,{path:"/jumping-game",element:ct.jsx(hD,{})})]})}),ct.jsx(cF,{})]})}),ct.jsx(fF,{userData:x.userData})]})})}Cg.createRoot(document.getElementById("root")).render(ct.jsx(Cr.StrictMode,{children:ct.jsxs(XI,{children:[ct.jsx(gF,{}),","]})}));
