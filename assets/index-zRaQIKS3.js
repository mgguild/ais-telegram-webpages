function Ry(e,s){for(var r=0;r<s.length;r++){const o=s[r];if(typeof o!="string"&&!Array.isArray(o)){for(const l in o)if(l!=="default"&&!(l in e)){const c=Object.getOwnPropertyDescriptor(o,l);c&&Object.defineProperty(e,l,c.get?c:{enumerable:!0,get:()=>o[l]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function r(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(l){if(l.ep)return;l.ep=!0;const c=r(l);fetch(l.href,c)}})();function xu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zg={exports:{}},hl={},Hg={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wo=Symbol.for("react.element"),Iy=Symbol.for("react.portal"),Dy=Symbol.for("react.fragment"),ky=Symbol.for("react.strict_mode"),Fy=Symbol.for("react.profiler"),By=Symbol.for("react.provider"),My=Symbol.for("react.context"),Ly=Symbol.for("react.forward_ref"),Oy=Symbol.for("react.suspense"),Ny=Symbol.for("react.memo"),Uy=Symbol.for("react.lazy"),sp=Symbol.iterator;function zy(e){return e===null||typeof e!="object"?null:(e=sp&&e[sp]||e["@@iterator"],typeof e=="function"?e:null)}var Wg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jg=Object.assign,Vg={};function rr(e,s,r){this.props=e,this.context=s,this.refs=Vg,this.updater=r||Wg}rr.prototype.isReactComponent={};rr.prototype.setState=function(e,s){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,s,"setState")};rr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Gg(){}Gg.prototype=rr.prototype;function bu(e,s,r){this.props=e,this.context=s,this.refs=Vg,this.updater=r||Wg}var Cu=bu.prototype=new Gg;Cu.constructor=bu;jg(Cu,rr.prototype);Cu.isPureReactComponent=!0;var np=Array.isArray,Xg=Object.prototype.hasOwnProperty,Su={current:null},Yg={key:!0,ref:!0,__self:!0,__source:!0};function $g(e,s,r){var o,l={},c=null,f=null;if(s!=null)for(o in s.ref!==void 0&&(f=s.ref),s.key!==void 0&&(c=""+s.key),s)Xg.call(s,o)&&!Yg.hasOwnProperty(o)&&(l[o]=s[o]);var g=arguments.length-2;if(g===1)l.children=r;else if(1<g){for(var _=Array(g),v=0;v<g;v++)_[v]=arguments[v+2];l.children=_}if(e&&e.defaultProps)for(o in g=e.defaultProps,g)l[o]===void 0&&(l[o]=g[o]);return{$$typeof:wo,type:e,key:c,ref:f,props:l,_owner:Su.current}}function Hy(e,s){return{$$typeof:wo,type:e.type,key:s,ref:e.ref,props:e.props,_owner:e._owner}}function Eu(e){return typeof e=="object"&&e!==null&&e.$$typeof===wo}function Wy(e){var s={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return s[r]})}var rp=/\/+/g;function Oh(e,s){return typeof e=="object"&&e!==null&&e.key!=null?Wy(""+e.key):s.toString(36)}function xa(e,s,r,o,l){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(c){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case wo:case Iy:f=!0}}if(f)return f=e,l=l(f),e=o===""?"."+Oh(f,0):o,np(l)?(r="",e!=null&&(r=e.replace(rp,"$&/")+"/"),xa(l,s,r,"",function(v){return v})):l!=null&&(Eu(l)&&(l=Hy(l,r+(!l.key||f&&f.key===l.key?"":(""+l.key).replace(rp,"$&/")+"/")+e)),s.push(l)),1;if(f=0,o=o===""?".":o+":",np(e))for(var g=0;g<e.length;g++){c=e[g];var _=o+Oh(c,g);f+=xa(c,s,r,_,l)}else if(_=zy(e),typeof _=="function")for(e=_.call(e),g=0;!(c=e.next()).done;)c=c.value,_=o+Oh(c,g++),f+=xa(c,s,r,_,l);else if(c==="object")throw s=String(e),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return f}function na(e,s,r){if(e==null)return e;var o=[],l=0;return xa(e,o,"","",function(c){return s.call(r,c,l++)}),o}function jy(e){if(e._status===-1){var s=e._result;s=s(),s.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=s)}if(e._status===1)return e._result.default;throw e._result}var ke={current:null},ba={transition:null},Vy={ReactCurrentDispatcher:ke,ReactCurrentBatchConfig:ba,ReactCurrentOwner:Su};function Qg(){throw Error("act(...) is not supported in production builds of React.")}yt.Children={map:na,forEach:function(e,s,r){na(e,function(){s.apply(this,arguments)},r)},count:function(e){var s=0;return na(e,function(){s++}),s},toArray:function(e){return na(e,function(s){return s})||[]},only:function(e){if(!Eu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};yt.Component=rr;yt.Fragment=Dy;yt.Profiler=Fy;yt.PureComponent=bu;yt.StrictMode=ky;yt.Suspense=Oy;yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vy;yt.act=Qg;yt.cloneElement=function(e,s,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=jg({},e.props),l=e.key,c=e.ref,f=e._owner;if(s!=null){if(s.ref!==void 0&&(c=s.ref,f=Su.current),s.key!==void 0&&(l=""+s.key),e.type&&e.type.defaultProps)var g=e.type.defaultProps;for(_ in s)Xg.call(s,_)&&!Yg.hasOwnProperty(_)&&(o[_]=s[_]===void 0&&g!==void 0?g[_]:s[_])}var _=arguments.length-2;if(_===1)o.children=r;else if(1<_){g=Array(_);for(var v=0;v<_;v++)g[v]=arguments[v+2];o.children=g}return{$$typeof:wo,type:e.type,key:l,ref:c,props:o,_owner:f}};yt.createContext=function(e){return e={$$typeof:My,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:By,_context:e},e.Consumer=e};yt.createElement=$g;yt.createFactory=function(e){var s=$g.bind(null,e);return s.type=e,s};yt.createRef=function(){return{current:null}};yt.forwardRef=function(e){return{$$typeof:Ly,render:e}};yt.isValidElement=Eu;yt.lazy=function(e){return{$$typeof:Uy,_payload:{_status:-1,_result:e},_init:jy}};yt.memo=function(e,s){return{$$typeof:Ny,type:e,compare:s===void 0?null:s}};yt.startTransition=function(e){var s=ba.transition;ba.transition={};try{e()}finally{ba.transition=s}};yt.unstable_act=Qg;yt.useCallback=function(e,s){return ke.current.useCallback(e,s)};yt.useContext=function(e){return ke.current.useContext(e)};yt.useDebugValue=function(){};yt.useDeferredValue=function(e){return ke.current.useDeferredValue(e)};yt.useEffect=function(e,s){return ke.current.useEffect(e,s)};yt.useId=function(){return ke.current.useId()};yt.useImperativeHandle=function(e,s,r){return ke.current.useImperativeHandle(e,s,r)};yt.useInsertionEffect=function(e,s){return ke.current.useInsertionEffect(e,s)};yt.useLayoutEffect=function(e,s){return ke.current.useLayoutEffect(e,s)};yt.useMemo=function(e,s){return ke.current.useMemo(e,s)};yt.useReducer=function(e,s,r){return ke.current.useReducer(e,s,r)};yt.useRef=function(e){return ke.current.useRef(e)};yt.useState=function(e){return ke.current.useState(e)};yt.useSyncExternalStore=function(e,s,r){return ke.current.useSyncExternalStore(e,s,r)};yt.useTransition=function(){return ke.current.useTransition()};yt.version="18.3.1";Hg.exports=yt;var Q=Hg.exports;const qg=xu(Q),Gy=Ry({__proto__:null,default:qg},[Q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xy=Q,Yy=Symbol.for("react.element"),$y=Symbol.for("react.fragment"),Qy=Object.prototype.hasOwnProperty,qy=Xy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zy={key:!0,ref:!0,__self:!0,__source:!0};function Zg(e,s,r){var o,l={},c=null,f=null;r!==void 0&&(c=""+r),s.key!==void 0&&(c=""+s.key),s.ref!==void 0&&(f=s.ref);for(o in s)Qy.call(s,o)&&!Zy.hasOwnProperty(o)&&(l[o]=s[o]);if(e&&e.defaultProps)for(o in s=e.defaultProps,s)l[o]===void 0&&(l[o]=s[o]);return{$$typeof:Yy,type:e,key:c,ref:f,props:l,_owner:qy.current}}hl.Fragment=$y;hl.jsx=Zg;hl.jsxs=Zg;zg.exports=hl;var Z=zg.exports,vc={},Kg={exports:{}},si={},Jg={exports:{}},tm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function s(st,lt){var dt=st.length;st.push(lt);t:for(;0<dt;){var Et=dt-1>>>1,ht=st[Et];if(0<l(ht,lt))st[Et]=lt,st[dt]=ht,dt=Et;else break t}}function r(st){return st.length===0?null:st[0]}function o(st){if(st.length===0)return null;var lt=st[0],dt=st.pop();if(dt!==lt){st[0]=dt;t:for(var Et=0,ht=st.length,Ut=ht>>>1;Et<Ut;){var Gt=2*(Et+1)-1,oe=st[Gt],bt=Gt+1,fn=st[bt];if(0>l(oe,dt))bt<ht&&0>l(fn,oe)?(st[Et]=fn,st[bt]=dt,Et=bt):(st[Et]=oe,st[Gt]=dt,Et=Gt);else if(bt<ht&&0>l(fn,dt))st[Et]=fn,st[bt]=dt,Et=bt;else break t}}return lt}function l(st,lt){var dt=st.sortIndex-lt.sortIndex;return dt!==0?dt:st.id-lt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var f=Date,g=f.now();e.unstable_now=function(){return f.now()-g}}var _=[],v=[],x=1,S=null,A=3,I=!1,F=!1,L=!1,O=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(st){for(var lt=r(v);lt!==null;){if(lt.callback===null)o(v);else if(lt.startTime<=st)o(v),lt.sortIndex=lt.expirationTime,s(_,lt);else break;lt=r(v)}}function W(st){if(L=!1,D(st),!F)if(r(_)!==null)F=!0,et(j);else{var lt=r(v);lt!==null&&fi(W,lt.startTime-st)}}function j(st,lt){F=!1,L&&(L=!1,T(B),B=-1),I=!0;var dt=A;try{for(D(lt),S=r(_);S!==null&&(!(S.expirationTime>lt)||st&&!at());){var Et=S.callback;if(typeof Et=="function"){S.callback=null,A=S.priorityLevel;var ht=Et(S.expirationTime<=lt);lt=e.unstable_now(),typeof ht=="function"?S.callback=ht:S===r(_)&&o(_),D(lt)}else o(_);S=r(_)}if(S!==null)var Ut=!0;else{var Gt=r(v);Gt!==null&&fi(W,Gt.startTime-lt),Ut=!1}return Ut}finally{S=null,A=dt,I=!1}}var K=!1,E=null,B=-1,G=5,rt=-1;function at(){return!(e.unstable_now()-rt<G)}function J(){if(E!==null){var st=e.unstable_now();rt=st;var lt=!0;try{lt=E(!0,st)}finally{lt?Nt():(K=!1,E=null)}}else K=!1}var Nt;if(typeof P=="function")Nt=function(){P(J)};else if(typeof MessageChannel<"u"){var Zt=new MessageChannel,wt=Zt.port2;Zt.port1.onmessage=J,Nt=function(){wt.postMessage(null)}}else Nt=function(){O(J,0)};function et(st){E=st,K||(K=!0,Nt())}function fi(st,lt){B=O(function(){st(e.unstable_now())},lt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(st){st.callback=null},e.unstable_continueExecution=function(){F||I||(F=!0,et(j))},e.unstable_forceFrameRate=function(st){0>st||125<st?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<st?Math.floor(1e3/st):5},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return r(_)},e.unstable_next=function(st){switch(A){case 1:case 2:case 3:var lt=3;break;default:lt=A}var dt=A;A=lt;try{return st()}finally{A=dt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(st,lt){switch(st){case 1:case 2:case 3:case 4:case 5:break;default:st=3}var dt=A;A=st;try{return lt()}finally{A=dt}},e.unstable_scheduleCallback=function(st,lt,dt){var Et=e.unstable_now();switch(typeof dt=="object"&&dt!==null?(dt=dt.delay,dt=typeof dt=="number"&&0<dt?Et+dt:Et):dt=Et,st){case 1:var ht=-1;break;case 2:ht=250;break;case 5:ht=1073741823;break;case 4:ht=1e4;break;default:ht=5e3}return ht=dt+ht,st={id:x++,callback:lt,priorityLevel:st,startTime:dt,expirationTime:ht,sortIndex:-1},dt>Et?(st.sortIndex=dt,s(v,st),r(_)===null&&st===r(v)&&(L?(T(B),B=-1):L=!0,fi(W,dt-Et))):(st.sortIndex=ht,s(_,st),F||I||(F=!0,et(j))),st},e.unstable_shouldYield=at,e.unstable_wrapCallback=function(st){var lt=A;return function(){var dt=A;A=lt;try{return st.apply(this,arguments)}finally{A=dt}}}})(tm);Jg.exports=tm;var Ky=Jg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jy=Q,ii=Ky;function q(e){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)s+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var em=new Set,Jr={};function cn(e,s){Kn(e,s),Kn(e+"Capture",s)}function Kn(e,s){for(Jr[e]=s,e=0;e<s.length;e++)em.add(s[e])}var qi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yc=Object.prototype.hasOwnProperty,tw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,op={},ap={};function ew(e){return yc.call(ap,e)?!0:yc.call(op,e)?!1:tw.test(e)?ap[e]=!0:(op[e]=!0,!1)}function iw(e,s,r,o){if(r!==null&&r.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return o?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function sw(e,s,r,o){if(s===null||typeof s>"u"||iw(e,s,r,o))return!0;if(o)return!1;if(r!==null)switch(r.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function Fe(e,s,r,o,l,c,f){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=o,this.attributeNamespace=l,this.mustUseProperty=r,this.propertyName=e,this.type=s,this.sanitizeURL=c,this.removeEmptyString=f}var ye={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ye[e]=new Fe(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var s=e[0];ye[s]=new Fe(s,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ye[e]=new Fe(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ye[e]=new Fe(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ye[e]=new Fe(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ye[e]=new Fe(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ye[e]=new Fe(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ye[e]=new Fe(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ye[e]=new Fe(e,5,!1,e.toLowerCase(),null,!1,!1)});var Au=/[\-:]([a-z])/g;function Tu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var s=e.replace(Au,Tu);ye[s]=new Fe(s,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var s=e.replace(Au,Tu);ye[s]=new Fe(s,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var s=e.replace(Au,Tu);ye[s]=new Fe(s,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ye[e]=new Fe(e,1,!1,e.toLowerCase(),null,!1,!1)});ye.xlinkHref=new Fe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ye[e]=new Fe(e,1,!1,e.toLowerCase(),null,!0,!0)});function Pu(e,s,r,o){var l=ye.hasOwnProperty(s)?ye[s]:null;(l!==null?l.type!==0:o||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(sw(s,r,l,o)&&(r=null),o||l===null?ew(s)&&(r===null?e.removeAttribute(s):e.setAttribute(s,""+r)):l.mustUseProperty?e[l.propertyName]=r===null?l.type===3?!1:"":r:(s=l.attributeName,o=l.attributeNamespace,r===null?e.removeAttribute(s):(l=l.type,r=l===3||l===4&&r===!0?"":""+r,o?e.setAttributeNS(o,s,r):e.setAttribute(s,r))))}var ts=Jy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ra=Symbol.for("react.element"),Bn=Symbol.for("react.portal"),Mn=Symbol.for("react.fragment"),Ru=Symbol.for("react.strict_mode"),wc=Symbol.for("react.profiler"),im=Symbol.for("react.provider"),sm=Symbol.for("react.context"),Iu=Symbol.for("react.forward_ref"),xc=Symbol.for("react.suspense"),bc=Symbol.for("react.suspense_list"),Du=Symbol.for("react.memo"),ls=Symbol.for("react.lazy"),nm=Symbol.for("react.offscreen"),lp=Symbol.iterator;function Ir(e){return e===null||typeof e!="object"?null:(e=lp&&e[lp]||e["@@iterator"],typeof e=="function"?e:null)}var Ot=Object.assign,Nh;function zr(e){if(Nh===void 0)try{throw Error()}catch(r){var s=r.stack.trim().match(/\n( *(at )?)/);Nh=s&&s[1]||""}return`
`+Nh+e}var Uh=!1;function zh(e,s){if(!e||Uh)return"";Uh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(v){var o=v}Reflect.construct(e,[],s)}else{try{s.call()}catch(v){o=v}e.call(s.prototype)}else{try{throw Error()}catch(v){o=v}e()}}catch(v){if(v&&o&&typeof v.stack=="string"){for(var l=v.stack.split(`
`),c=o.stack.split(`
`),f=l.length-1,g=c.length-1;1<=f&&0<=g&&l[f]!==c[g];)g--;for(;1<=f&&0<=g;f--,g--)if(l[f]!==c[g]){if(f!==1||g!==1)do if(f--,g--,0>g||l[f]!==c[g]){var _=`
`+l[f].replace(" at new "," at ");return e.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",e.displayName)),_}while(1<=f&&0<=g);break}}}finally{Uh=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?zr(e):""}function nw(e){switch(e.tag){case 5:return zr(e.type);case 16:return zr("Lazy");case 13:return zr("Suspense");case 19:return zr("SuspenseList");case 0:case 2:case 15:return e=zh(e.type,!1),e;case 11:return e=zh(e.type.render,!1),e;case 1:return e=zh(e.type,!0),e;default:return""}}function Cc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Mn:return"Fragment";case Bn:return"Portal";case wc:return"Profiler";case Ru:return"StrictMode";case xc:return"Suspense";case bc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sm:return(e.displayName||"Context")+".Consumer";case im:return(e._context.displayName||"Context")+".Provider";case Iu:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Du:return s=e.displayName||null,s!==null?s:Cc(e.type)||"Memo";case ls:s=e._payload,e=e._init;try{return Cc(e(s))}catch{}}return null}function rw(e){var s=e.type;switch(e.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=s.render,e=e.displayName||e.name||"",s.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cc(s);case 8:return s===Ru?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Cs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rm(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function ow(e){var s=rm(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,s),o=""+e[s];if(!e.hasOwnProperty(s)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var l=r.get,c=r.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return l.call(this)},set:function(f){o=""+f,c.call(this,f)}}),Object.defineProperty(e,s,{enumerable:r.enumerable}),{getValue:function(){return o},setValue:function(f){o=""+f},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function oa(e){e._valueTracker||(e._valueTracker=ow(e))}function om(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var r=s.getValue(),o="";return e&&(o=rm(e)?e.checked?"true":"false":e.value),e=o,e!==r?(s.setValue(e),!0):!1}function La(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Sc(e,s){var r=s.checked;return Ot({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function hp(e,s){var r=s.defaultValue==null?"":s.defaultValue,o=s.checked!=null?s.checked:s.defaultChecked;r=Cs(s.value!=null?s.value:r),e._wrapperState={initialChecked:o,initialValue:r,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function am(e,s){s=s.checked,s!=null&&Pu(e,"checked",s,!1)}function Ec(e,s){am(e,s);var r=Cs(s.value),o=s.type;if(r!=null)o==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}s.hasOwnProperty("value")?Ac(e,s.type,r):s.hasOwnProperty("defaultValue")&&Ac(e,s.type,Cs(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(e.defaultChecked=!!s.defaultChecked)}function cp(e,s,r){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var o=s.type;if(!(o!=="submit"&&o!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+e._wrapperState.initialValue,r||s===e.value||(e.value=s),e.defaultValue=s}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ac(e,s,r){(s!=="number"||La(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Hr=Array.isArray;function Xn(e,s,r,o){if(e=e.options,s){s={};for(var l=0;l<r.length;l++)s["$"+r[l]]=!0;for(r=0;r<e.length;r++)l=s.hasOwnProperty("$"+e[r].value),e[r].selected!==l&&(e[r].selected=l),l&&o&&(e[r].defaultSelected=!0)}else{for(r=""+Cs(r),s=null,l=0;l<e.length;l++){if(e[l].value===r){e[l].selected=!0,o&&(e[l].defaultSelected=!0);return}s!==null||e[l].disabled||(s=e[l])}s!==null&&(s.selected=!0)}}function Tc(e,s){if(s.dangerouslySetInnerHTML!=null)throw Error(q(91));return Ot({},s,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function up(e,s){var r=s.value;if(r==null){if(r=s.children,s=s.defaultValue,r!=null){if(s!=null)throw Error(q(92));if(Hr(r)){if(1<r.length)throw Error(q(93));r=r[0]}s=r}s==null&&(s=""),r=s}e._wrapperState={initialValue:Cs(r)}}function lm(e,s){var r=Cs(s.value),o=Cs(s.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),s.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),o!=null&&(e.defaultValue=""+o)}function dp(e){var s=e.textContent;s===e._wrapperState.initialValue&&s!==""&&s!==null&&(e.value=s)}function hm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pc(e,s){return e==null||e==="http://www.w3.org/1999/xhtml"?hm(s):e==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var aa,cm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,r,o,l){MSApp.execUnsafeLocalFunction(function(){return e(s,r,o,l)})}:e}(function(e,s){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=s;else{for(aa=aa||document.createElement("div"),aa.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=aa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;s.firstChild;)e.appendChild(s.firstChild)}});function to(e,s){if(s){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=s;return}}e.textContent=s}var Vr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aw=["Webkit","ms","Moz","O"];Object.keys(Vr).forEach(function(e){aw.forEach(function(s){s=s+e.charAt(0).toUpperCase()+e.substring(1),Vr[s]=Vr[e]})});function um(e,s,r){return s==null||typeof s=="boolean"||s===""?"":r||typeof s!="number"||s===0||Vr.hasOwnProperty(e)&&Vr[e]?(""+s).trim():s+"px"}function dm(e,s){e=e.style;for(var r in s)if(s.hasOwnProperty(r)){var o=r.indexOf("--")===0,l=um(r,s[r],o);r==="float"&&(r="cssFloat"),o?e.setProperty(r,l):e[r]=l}}var lw=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rc(e,s){if(s){if(lw[e]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(q(137,e));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(q(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(q(61))}if(s.style!=null&&typeof s.style!="object")throw Error(q(62))}}function Ic(e,s){if(e.indexOf("-")===-1)return typeof s.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dc=null;function ku(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var kc=null,Yn=null,$n=null;function fp(e){if(e=Co(e)){if(typeof kc!="function")throw Error(q(280));var s=e.stateNode;s&&(s=pl(s),kc(e.stateNode,e.type,s))}}function fm(e){Yn?$n?$n.push(e):$n=[e]:Yn=e}function pm(){if(Yn){var e=Yn,s=$n;if($n=Yn=null,fp(e),s)for(e=0;e<s.length;e++)fp(s[e])}}function gm(e,s){return e(s)}function mm(){}var Hh=!1;function _m(e,s,r){if(Hh)return e(s,r);Hh=!0;try{return gm(e,s,r)}finally{Hh=!1,(Yn!==null||$n!==null)&&(mm(),pm())}}function eo(e,s){var r=e.stateNode;if(r===null)return null;var o=pl(r);if(o===null)return null;r=o[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break t;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(q(231,s,typeof r));return r}var Fc=!1;if(qi)try{var Dr={};Object.defineProperty(Dr,"passive",{get:function(){Fc=!0}}),window.addEventListener("test",Dr,Dr),window.removeEventListener("test",Dr,Dr)}catch{Fc=!1}function hw(e,s,r,o,l,c,f,g,_){var v=Array.prototype.slice.call(arguments,3);try{s.apply(r,v)}catch(x){this.onError(x)}}var Gr=!1,Oa=null,Na=!1,Bc=null,cw={onError:function(e){Gr=!0,Oa=e}};function uw(e,s,r,o,l,c,f,g,_){Gr=!1,Oa=null,hw.apply(cw,arguments)}function dw(e,s,r,o,l,c,f,g,_){if(uw.apply(this,arguments),Gr){if(Gr){var v=Oa;Gr=!1,Oa=null}else throw Error(q(198));Na||(Na=!0,Bc=v)}}function un(e){var s=e,r=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,s.flags&4098&&(r=s.return),e=s.return;while(e)}return s.tag===3?r:null}function vm(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function pp(e){if(un(e)!==e)throw Error(q(188))}function fw(e){var s=e.alternate;if(!s){if(s=un(e),s===null)throw Error(q(188));return s!==e?null:e}for(var r=e,o=s;;){var l=r.return;if(l===null)break;var c=l.alternate;if(c===null){if(o=l.return,o!==null){r=o;continue}break}if(l.child===c.child){for(c=l.child;c;){if(c===r)return pp(l),e;if(c===o)return pp(l),s;c=c.sibling}throw Error(q(188))}if(r.return!==o.return)r=l,o=c;else{for(var f=!1,g=l.child;g;){if(g===r){f=!0,r=l,o=c;break}if(g===o){f=!0,o=l,r=c;break}g=g.sibling}if(!f){for(g=c.child;g;){if(g===r){f=!0,r=c,o=l;break}if(g===o){f=!0,o=c,r=l;break}g=g.sibling}if(!f)throw Error(q(189))}}if(r.alternate!==o)throw Error(q(190))}if(r.tag!==3)throw Error(q(188));return r.stateNode.current===r?e:s}function ym(e){return e=fw(e),e!==null?wm(e):null}function wm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var s=wm(e);if(s!==null)return s;e=e.sibling}return null}var xm=ii.unstable_scheduleCallback,gp=ii.unstable_cancelCallback,pw=ii.unstable_shouldYield,gw=ii.unstable_requestPaint,Xt=ii.unstable_now,mw=ii.unstable_getCurrentPriorityLevel,Fu=ii.unstable_ImmediatePriority,bm=ii.unstable_UserBlockingPriority,Ua=ii.unstable_NormalPriority,_w=ii.unstable_LowPriority,Cm=ii.unstable_IdlePriority,cl=null,Oi=null;function vw(e){if(Oi&&typeof Oi.onCommitFiberRoot=="function")try{Oi.onCommitFiberRoot(cl,e,void 0,(e.current.flags&128)===128)}catch{}}var xi=Math.clz32?Math.clz32:xw,yw=Math.log,ww=Math.LN2;function xw(e){return e>>>=0,e===0?32:31-(yw(e)/ww|0)|0}var la=64,ha=4194304;function Wr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function za(e,s){var r=e.pendingLanes;if(r===0)return 0;var o=0,l=e.suspendedLanes,c=e.pingedLanes,f=r&268435455;if(f!==0){var g=f&~l;g!==0?o=Wr(g):(c&=f,c!==0&&(o=Wr(c)))}else f=r&~l,f!==0?o=Wr(f):c!==0&&(o=Wr(c));if(o===0)return 0;if(s!==0&&s!==o&&!(s&l)&&(l=o&-o,c=s&-s,l>=c||l===16&&(c&4194240)!==0))return s;if(o&4&&(o|=r&16),s=e.entangledLanes,s!==0)for(e=e.entanglements,s&=o;0<s;)r=31-xi(s),l=1<<r,o|=e[r],s&=~l;return o}function bw(e,s){switch(e){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cw(e,s){for(var r=e.suspendedLanes,o=e.pingedLanes,l=e.expirationTimes,c=e.pendingLanes;0<c;){var f=31-xi(c),g=1<<f,_=l[f];_===-1?(!(g&r)||g&o)&&(l[f]=bw(g,s)):_<=s&&(e.expiredLanes|=g),c&=~g}}function Mc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Sm(){var e=la;return la<<=1,!(la&4194240)&&(la=64),e}function Wh(e){for(var s=[],r=0;31>r;r++)s.push(e);return s}function xo(e,s,r){e.pendingLanes|=s,s!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,s=31-xi(s),e[s]=r}function Sw(e,s){var r=e.pendingLanes&~s;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=s,e.mutableReadLanes&=s,e.entangledLanes&=s,s=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<r;){var l=31-xi(r),c=1<<l;s[l]=0,o[l]=-1,e[l]=-1,r&=~c}}function Bu(e,s){var r=e.entangledLanes|=s;for(e=e.entanglements;r;){var o=31-xi(r),l=1<<o;l&s|e[o]&s&&(e[o]|=s),r&=~l}}var St=0;function Em(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Am,Mu,Tm,Pm,Rm,Lc=!1,ca=[],gs=null,ms=null,_s=null,io=new Map,so=new Map,cs=[],Ew="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mp(e,s){switch(e){case"focusin":case"focusout":gs=null;break;case"dragenter":case"dragleave":ms=null;break;case"mouseover":case"mouseout":_s=null;break;case"pointerover":case"pointerout":io.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":so.delete(s.pointerId)}}function kr(e,s,r,o,l,c){return e===null||e.nativeEvent!==c?(e={blockedOn:s,domEventName:r,eventSystemFlags:o,nativeEvent:c,targetContainers:[l]},s!==null&&(s=Co(s),s!==null&&Mu(s)),e):(e.eventSystemFlags|=o,s=e.targetContainers,l!==null&&s.indexOf(l)===-1&&s.push(l),e)}function Aw(e,s,r,o,l){switch(s){case"focusin":return gs=kr(gs,e,s,r,o,l),!0;case"dragenter":return ms=kr(ms,e,s,r,o,l),!0;case"mouseover":return _s=kr(_s,e,s,r,o,l),!0;case"pointerover":var c=l.pointerId;return io.set(c,kr(io.get(c)||null,e,s,r,o,l)),!0;case"gotpointercapture":return c=l.pointerId,so.set(c,kr(so.get(c)||null,e,s,r,o,l)),!0}return!1}function Im(e){var s=Qs(e.target);if(s!==null){var r=un(s);if(r!==null){if(s=r.tag,s===13){if(s=vm(r),s!==null){e.blockedOn=s,Rm(e.priority,function(){Tm(r)});return}}else if(s===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ca(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var r=Oc(e.domEventName,e.eventSystemFlags,s[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var o=new r.constructor(r.type,r);Dc=o,r.target.dispatchEvent(o),Dc=null}else return s=Co(r),s!==null&&Mu(s),e.blockedOn=r,!1;s.shift()}return!0}function _p(e,s,r){Ca(e)&&r.delete(s)}function Tw(){Lc=!1,gs!==null&&Ca(gs)&&(gs=null),ms!==null&&Ca(ms)&&(ms=null),_s!==null&&Ca(_s)&&(_s=null),io.forEach(_p),so.forEach(_p)}function Fr(e,s){e.blockedOn===s&&(e.blockedOn=null,Lc||(Lc=!0,ii.unstable_scheduleCallback(ii.unstable_NormalPriority,Tw)))}function no(e){function s(l){return Fr(l,e)}if(0<ca.length){Fr(ca[0],e);for(var r=1;r<ca.length;r++){var o=ca[r];o.blockedOn===e&&(o.blockedOn=null)}}for(gs!==null&&Fr(gs,e),ms!==null&&Fr(ms,e),_s!==null&&Fr(_s,e),io.forEach(s),so.forEach(s),r=0;r<cs.length;r++)o=cs[r],o.blockedOn===e&&(o.blockedOn=null);for(;0<cs.length&&(r=cs[0],r.blockedOn===null);)Im(r),r.blockedOn===null&&cs.shift()}var Qn=ts.ReactCurrentBatchConfig,Ha=!0;function Pw(e,s,r,o){var l=St,c=Qn.transition;Qn.transition=null;try{St=1,Lu(e,s,r,o)}finally{St=l,Qn.transition=c}}function Rw(e,s,r,o){var l=St,c=Qn.transition;Qn.transition=null;try{St=4,Lu(e,s,r,o)}finally{St=l,Qn.transition=c}}function Lu(e,s,r,o){if(Ha){var l=Oc(e,s,r,o);if(l===null)Kh(e,s,o,Wa,r),mp(e,o);else if(Aw(l,e,s,r,o))o.stopPropagation();else if(mp(e,o),s&4&&-1<Ew.indexOf(e)){for(;l!==null;){var c=Co(l);if(c!==null&&Am(c),c=Oc(e,s,r,o),c===null&&Kh(e,s,o,Wa,r),c===l)break;l=c}l!==null&&o.stopPropagation()}else Kh(e,s,o,null,r)}}var Wa=null;function Oc(e,s,r,o){if(Wa=null,e=ku(o),e=Qs(e),e!==null)if(s=un(e),s===null)e=null;else if(r=s.tag,r===13){if(e=vm(s),e!==null)return e;e=null}else if(r===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null);return Wa=e,null}function Dm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mw()){case Fu:return 1;case bm:return 4;case Ua:case _w:return 16;case Cm:return 536870912;default:return 16}default:return 16}}var ds=null,Ou=null,Sa=null;function km(){if(Sa)return Sa;var e,s=Ou,r=s.length,o,l="value"in ds?ds.value:ds.textContent,c=l.length;for(e=0;e<r&&s[e]===l[e];e++);var f=r-e;for(o=1;o<=f&&s[r-o]===l[c-o];o++);return Sa=l.slice(e,1<o?1-o:void 0)}function Ea(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function ua(){return!0}function vp(){return!1}function ni(e){function s(r,o,l,c,f){this._reactName=r,this._targetInst=l,this.type=o,this.nativeEvent=c,this.target=f,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(r=e[g],this[g]=r?r(c):c[g]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?ua:vp,this.isPropagationStopped=vp,this}return Ot(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ua)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ua)},persist:function(){},isPersistent:ua}),s}var or={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nu=ni(or),bo=Ot({},or,{view:0,detail:0}),Iw=ni(bo),jh,Vh,Br,ul=Ot({},bo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Br&&(Br&&e.type==="mousemove"?(jh=e.screenX-Br.screenX,Vh=e.screenY-Br.screenY):Vh=jh=0,Br=e),jh)},movementY:function(e){return"movementY"in e?e.movementY:Vh}}),yp=ni(ul),Dw=Ot({},ul,{dataTransfer:0}),kw=ni(Dw),Fw=Ot({},bo,{relatedTarget:0}),Gh=ni(Fw),Bw=Ot({},or,{animationName:0,elapsedTime:0,pseudoElement:0}),Mw=ni(Bw),Lw=Ot({},or,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ow=ni(Lw),Nw=Ot({},or,{data:0}),wp=ni(Nw),Uw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ww(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=Hw[e])?!!s[e]:!1}function Uu(){return Ww}var jw=Ot({},bo,{key:function(e){if(e.key){var s=Uw[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=Ea(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?zw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uu,charCode:function(e){return e.type==="keypress"?Ea(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ea(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Vw=ni(jw),Gw=Ot({},ul,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xp=ni(Gw),Xw=Ot({},bo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uu}),Yw=ni(Xw),$w=Ot({},or,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qw=ni($w),qw=Ot({},ul,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zw=ni(qw),Kw=[9,13,27,32],zu=qi&&"CompositionEvent"in window,Xr=null;qi&&"documentMode"in document&&(Xr=document.documentMode);var Jw=qi&&"TextEvent"in window&&!Xr,Fm=qi&&(!zu||Xr&&8<Xr&&11>=Xr),bp=" ",Cp=!1;function Bm(e,s){switch(e){case"keyup":return Kw.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ln=!1;function tx(e,s){switch(e){case"compositionend":return Mm(s);case"keypress":return s.which!==32?null:(Cp=!0,bp);case"textInput":return e=s.data,e===bp&&Cp?null:e;default:return null}}function ex(e,s){if(Ln)return e==="compositionend"||!zu&&Bm(e,s)?(e=km(),Sa=Ou=ds=null,Ln=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Fm&&s.locale!=="ko"?null:s.data;default:return null}}var ix={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sp(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!ix[e.type]:s==="textarea"}function Lm(e,s,r,o){fm(o),s=ja(s,"onChange"),0<s.length&&(r=new Nu("onChange","change",null,r,o),e.push({event:r,listeners:s}))}var Yr=null,ro=null;function sx(e){Ym(e,0)}function dl(e){var s=Un(e);if(om(s))return e}function nx(e,s){if(e==="change")return s}var Om=!1;if(qi){var Xh;if(qi){var Yh="oninput"in document;if(!Yh){var Ep=document.createElement("div");Ep.setAttribute("oninput","return;"),Yh=typeof Ep.oninput=="function"}Xh=Yh}else Xh=!1;Om=Xh&&(!document.documentMode||9<document.documentMode)}function Ap(){Yr&&(Yr.detachEvent("onpropertychange",Nm),ro=Yr=null)}function Nm(e){if(e.propertyName==="value"&&dl(ro)){var s=[];Lm(s,ro,e,ku(e)),_m(sx,s)}}function rx(e,s,r){e==="focusin"?(Ap(),Yr=s,ro=r,Yr.attachEvent("onpropertychange",Nm)):e==="focusout"&&Ap()}function ox(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return dl(ro)}function ax(e,s){if(e==="click")return dl(s)}function lx(e,s){if(e==="input"||e==="change")return dl(s)}function hx(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var Ci=typeof Object.is=="function"?Object.is:hx;function oo(e,s){if(Ci(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var r=Object.keys(e),o=Object.keys(s);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++){var l=r[o];if(!yc.call(s,l)||!Ci(e[l],s[l]))return!1}return!0}function Tp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pp(e,s){var r=Tp(e);e=0;for(var o;r;){if(r.nodeType===3){if(o=e+r.textContent.length,e<=s&&o>=s)return{node:r,offset:s-e};e=o}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=Tp(r)}}function Um(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?Um(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function zm(){for(var e=window,s=La();s instanceof e.HTMLIFrameElement;){try{var r=typeof s.contentWindow.location.href=="string"}catch{r=!1}if(r)e=s.contentWindow;else break;s=La(e.document)}return s}function Hu(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}function cx(e){var s=zm(),r=e.focusedElem,o=e.selectionRange;if(s!==r&&r&&r.ownerDocument&&Um(r.ownerDocument.documentElement,r)){if(o!==null&&Hu(r)){if(s=o.start,e=o.end,e===void 0&&(e=s),"selectionStart"in r)r.selectionStart=s,r.selectionEnd=Math.min(e,r.value.length);else if(e=(s=r.ownerDocument||document)&&s.defaultView||window,e.getSelection){e=e.getSelection();var l=r.textContent.length,c=Math.min(o.start,l);o=o.end===void 0?c:Math.min(o.end,l),!e.extend&&c>o&&(l=o,o=c,c=l),l=Pp(r,c);var f=Pp(r,o);l&&f&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(s=s.createRange(),s.setStart(l.node,l.offset),e.removeAllRanges(),c>o?(e.addRange(s),e.extend(f.node,f.offset)):(s.setEnd(f.node,f.offset),e.addRange(s)))}}for(s=[],e=r;e=e.parentNode;)e.nodeType===1&&s.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<s.length;r++)e=s[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ux=qi&&"documentMode"in document&&11>=document.documentMode,On=null,Nc=null,$r=null,Uc=!1;function Rp(e,s,r){var o=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Uc||On==null||On!==La(o)||(o=On,"selectionStart"in o&&Hu(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),$r&&oo($r,o)||($r=o,o=ja(Nc,"onSelect"),0<o.length&&(s=new Nu("onSelect","select",null,s,r),e.push({event:s,listeners:o}),s.target=On)))}function da(e,s){var r={};return r[e.toLowerCase()]=s.toLowerCase(),r["Webkit"+e]="webkit"+s,r["Moz"+e]="moz"+s,r}var Nn={animationend:da("Animation","AnimationEnd"),animationiteration:da("Animation","AnimationIteration"),animationstart:da("Animation","AnimationStart"),transitionend:da("Transition","TransitionEnd")},$h={},Hm={};qi&&(Hm=document.createElement("div").style,"AnimationEvent"in window||(delete Nn.animationend.animation,delete Nn.animationiteration.animation,delete Nn.animationstart.animation),"TransitionEvent"in window||delete Nn.transitionend.transition);function fl(e){if($h[e])return $h[e];if(!Nn[e])return e;var s=Nn[e],r;for(r in s)if(s.hasOwnProperty(r)&&r in Hm)return $h[e]=s[r];return e}var Wm=fl("animationend"),jm=fl("animationiteration"),Vm=fl("animationstart"),Gm=fl("transitionend"),Xm=new Map,Ip="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Es(e,s){Xm.set(e,s),cn(s,[e])}for(var Qh=0;Qh<Ip.length;Qh++){var qh=Ip[Qh],dx=qh.toLowerCase(),fx=qh[0].toUpperCase()+qh.slice(1);Es(dx,"on"+fx)}Es(Wm,"onAnimationEnd");Es(jm,"onAnimationIteration");Es(Vm,"onAnimationStart");Es("dblclick","onDoubleClick");Es("focusin","onFocus");Es("focusout","onBlur");Es(Gm,"onTransitionEnd");Kn("onMouseEnter",["mouseout","mouseover"]);Kn("onMouseLeave",["mouseout","mouseover"]);Kn("onPointerEnter",["pointerout","pointerover"]);Kn("onPointerLeave",["pointerout","pointerover"]);cn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cn("onBeforeInput",["compositionend","keypress","textInput","paste"]);cn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),px=new Set("cancel close invalid load scroll toggle".split(" ").concat(jr));function Dp(e,s,r){var o=e.type||"unknown-event";e.currentTarget=r,dw(o,s,void 0,e),e.currentTarget=null}function Ym(e,s){s=(s&4)!==0;for(var r=0;r<e.length;r++){var o=e[r],l=o.event;o=o.listeners;t:{var c=void 0;if(s)for(var f=o.length-1;0<=f;f--){var g=o[f],_=g.instance,v=g.currentTarget;if(g=g.listener,_!==c&&l.isPropagationStopped())break t;Dp(l,g,v),c=_}else for(f=0;f<o.length;f++){if(g=o[f],_=g.instance,v=g.currentTarget,g=g.listener,_!==c&&l.isPropagationStopped())break t;Dp(l,g,v),c=_}}}if(Na)throw e=Bc,Na=!1,Bc=null,e}function Tt(e,s){var r=s[Vc];r===void 0&&(r=s[Vc]=new Set);var o=e+"__bubble";r.has(o)||($m(s,e,2,!1),r.add(o))}function Zh(e,s,r){var o=0;s&&(o|=4),$m(r,e,o,s)}var fa="_reactListening"+Math.random().toString(36).slice(2);function ao(e){if(!e[fa]){e[fa]=!0,em.forEach(function(r){r!=="selectionchange"&&(px.has(r)||Zh(r,!1,e),Zh(r,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[fa]||(s[fa]=!0,Zh("selectionchange",!1,s))}}function $m(e,s,r,o){switch(Dm(s)){case 1:var l=Pw;break;case 4:l=Rw;break;default:l=Lu}r=l.bind(null,s,r,e),l=void 0,!Fc||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(l=!0),o?l!==void 0?e.addEventListener(s,r,{capture:!0,passive:l}):e.addEventListener(s,r,!0):l!==void 0?e.addEventListener(s,r,{passive:l}):e.addEventListener(s,r,!1)}function Kh(e,s,r,o,l){var c=o;if(!(s&1)&&!(s&2)&&o!==null)t:for(;;){if(o===null)return;var f=o.tag;if(f===3||f===4){var g=o.stateNode.containerInfo;if(g===l||g.nodeType===8&&g.parentNode===l)break;if(f===4)for(f=o.return;f!==null;){var _=f.tag;if((_===3||_===4)&&(_=f.stateNode.containerInfo,_===l||_.nodeType===8&&_.parentNode===l))return;f=f.return}for(;g!==null;){if(f=Qs(g),f===null)return;if(_=f.tag,_===5||_===6){o=c=f;continue t}g=g.parentNode}}o=o.return}_m(function(){var v=c,x=ku(r),S=[];t:{var A=Xm.get(e);if(A!==void 0){var I=Nu,F=e;switch(e){case"keypress":if(Ea(r)===0)break t;case"keydown":case"keyup":I=Vw;break;case"focusin":F="focus",I=Gh;break;case"focusout":F="blur",I=Gh;break;case"beforeblur":case"afterblur":I=Gh;break;case"click":if(r.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=yp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=kw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=Yw;break;case Wm:case jm:case Vm:I=Mw;break;case Gm:I=Qw;break;case"scroll":I=Iw;break;case"wheel":I=Zw;break;case"copy":case"cut":case"paste":I=Ow;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=xp}var L=(s&4)!==0,O=!L&&e==="scroll",T=L?A!==null?A+"Capture":null:A;L=[];for(var P=v,D;P!==null;){D=P;var W=D.stateNode;if(D.tag===5&&W!==null&&(D=W,T!==null&&(W=eo(P,T),W!=null&&L.push(lo(P,W,D)))),O)break;P=P.return}0<L.length&&(A=new I(A,F,null,r,x),S.push({event:A,listeners:L}))}}if(!(s&7)){t:{if(A=e==="mouseover"||e==="pointerover",I=e==="mouseout"||e==="pointerout",A&&r!==Dc&&(F=r.relatedTarget||r.fromElement)&&(Qs(F)||F[Zi]))break t;if((I||A)&&(A=x.window===x?x:(A=x.ownerDocument)?A.defaultView||A.parentWindow:window,I?(F=r.relatedTarget||r.toElement,I=v,F=F?Qs(F):null,F!==null&&(O=un(F),F!==O||F.tag!==5&&F.tag!==6)&&(F=null)):(I=null,F=v),I!==F)){if(L=yp,W="onMouseLeave",T="onMouseEnter",P="mouse",(e==="pointerout"||e==="pointerover")&&(L=xp,W="onPointerLeave",T="onPointerEnter",P="pointer"),O=I==null?A:Un(I),D=F==null?A:Un(F),A=new L(W,P+"leave",I,r,x),A.target=O,A.relatedTarget=D,W=null,Qs(x)===v&&(L=new L(T,P+"enter",F,r,x),L.target=D,L.relatedTarget=O,W=L),O=W,I&&F)e:{for(L=I,T=F,P=0,D=L;D;D=Fn(D))P++;for(D=0,W=T;W;W=Fn(W))D++;for(;0<P-D;)L=Fn(L),P--;for(;0<D-P;)T=Fn(T),D--;for(;P--;){if(L===T||T!==null&&L===T.alternate)break e;L=Fn(L),T=Fn(T)}L=null}else L=null;I!==null&&kp(S,A,I,L,!1),F!==null&&O!==null&&kp(S,O,F,L,!0)}}t:{if(A=v?Un(v):window,I=A.nodeName&&A.nodeName.toLowerCase(),I==="select"||I==="input"&&A.type==="file")var j=nx;else if(Sp(A))if(Om)j=lx;else{j=ox;var K=rx}else(I=A.nodeName)&&I.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(j=ax);if(j&&(j=j(e,v))){Lm(S,j,r,x);break t}K&&K(e,A,v),e==="focusout"&&(K=A._wrapperState)&&K.controlled&&A.type==="number"&&Ac(A,"number",A.value)}switch(K=v?Un(v):window,e){case"focusin":(Sp(K)||K.contentEditable==="true")&&(On=K,Nc=v,$r=null);break;case"focusout":$r=Nc=On=null;break;case"mousedown":Uc=!0;break;case"contextmenu":case"mouseup":case"dragend":Uc=!1,Rp(S,r,x);break;case"selectionchange":if(ux)break;case"keydown":case"keyup":Rp(S,r,x)}var E;if(zu)t:{switch(e){case"compositionstart":var B="onCompositionStart";break t;case"compositionend":B="onCompositionEnd";break t;case"compositionupdate":B="onCompositionUpdate";break t}B=void 0}else Ln?Bm(e,r)&&(B="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(B="onCompositionStart");B&&(Fm&&r.locale!=="ko"&&(Ln||B!=="onCompositionStart"?B==="onCompositionEnd"&&Ln&&(E=km()):(ds=x,Ou="value"in ds?ds.value:ds.textContent,Ln=!0)),K=ja(v,B),0<K.length&&(B=new wp(B,e,null,r,x),S.push({event:B,listeners:K}),E?B.data=E:(E=Mm(r),E!==null&&(B.data=E)))),(E=Jw?tx(e,r):ex(e,r))&&(v=ja(v,"onBeforeInput"),0<v.length&&(x=new wp("onBeforeInput","beforeinput",null,r,x),S.push({event:x,listeners:v}),x.data=E))}Ym(S,s)})}function lo(e,s,r){return{instance:e,listener:s,currentTarget:r}}function ja(e,s){for(var r=s+"Capture",o=[];e!==null;){var l=e,c=l.stateNode;l.tag===5&&c!==null&&(l=c,c=eo(e,r),c!=null&&o.unshift(lo(e,c,l)),c=eo(e,s),c!=null&&o.push(lo(e,c,l))),e=e.return}return o}function Fn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function kp(e,s,r,o,l){for(var c=s._reactName,f=[];r!==null&&r!==o;){var g=r,_=g.alternate,v=g.stateNode;if(_!==null&&_===o)break;g.tag===5&&v!==null&&(g=v,l?(_=eo(r,c),_!=null&&f.unshift(lo(r,_,g))):l||(_=eo(r,c),_!=null&&f.push(lo(r,_,g)))),r=r.return}f.length!==0&&e.push({event:s,listeners:f})}var gx=/\r\n?/g,mx=/\u0000|\uFFFD/g;function Fp(e){return(typeof e=="string"?e:""+e).replace(gx,`
`).replace(mx,"")}function pa(e,s,r){if(s=Fp(s),Fp(e)!==s&&r)throw Error(q(425))}function Va(){}var zc=null,Hc=null;function Wc(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var jc=typeof setTimeout=="function"?setTimeout:void 0,_x=typeof clearTimeout=="function"?clearTimeout:void 0,Bp=typeof Promise=="function"?Promise:void 0,vx=typeof queueMicrotask=="function"?queueMicrotask:typeof Bp<"u"?function(e){return Bp.resolve(null).then(e).catch(yx)}:jc;function yx(e){setTimeout(function(){throw e})}function Jh(e,s){var r=s,o=0;do{var l=r.nextSibling;if(e.removeChild(r),l&&l.nodeType===8)if(r=l.data,r==="/$"){if(o===0){e.removeChild(l),no(s);return}o--}else r!=="$"&&r!=="$?"&&r!=="$!"||o++;r=l}while(r);no(s)}function vs(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return e}function Mp(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(s===0)return e;s--}else r==="/$"&&s++}e=e.previousSibling}return null}var ar=Math.random().toString(36).slice(2),Li="__reactFiber$"+ar,ho="__reactProps$"+ar,Zi="__reactContainer$"+ar,Vc="__reactEvents$"+ar,wx="__reactListeners$"+ar,xx="__reactHandles$"+ar;function Qs(e){var s=e[Li];if(s)return s;for(var r=e.parentNode;r;){if(s=r[Zi]||r[Li]){if(r=s.alternate,s.child!==null||r!==null&&r.child!==null)for(e=Mp(e);e!==null;){if(r=e[Li])return r;e=Mp(e)}return s}e=r,r=e.parentNode}return null}function Co(e){return e=e[Li]||e[Zi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Un(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(q(33))}function pl(e){return e[ho]||null}var Gc=[],zn=-1;function As(e){return{current:e}}function Pt(e){0>zn||(e.current=Gc[zn],Gc[zn]=null,zn--)}function At(e,s){zn++,Gc[zn]=e.current,e.current=s}var Ss={},Se=As(Ss),je=As(!1),nn=Ss;function Jn(e,s){var r=e.type.contextTypes;if(!r)return Ss;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===s)return o.__reactInternalMemoizedMaskedChildContext;var l={},c;for(c in r)l[c]=s[c];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=l),l}function Ve(e){return e=e.childContextTypes,e!=null}function Ga(){Pt(je),Pt(Se)}function Lp(e,s,r){if(Se.current!==Ss)throw Error(q(168));At(Se,s),At(je,r)}function Qm(e,s,r){var o=e.stateNode;if(s=s.childContextTypes,typeof o.getChildContext!="function")return r;o=o.getChildContext();for(var l in o)if(!(l in s))throw Error(q(108,rw(e)||"Unknown",l));return Ot({},r,o)}function Xa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ss,nn=Se.current,At(Se,e),At(je,je.current),!0}function Op(e,s,r){var o=e.stateNode;if(!o)throw Error(q(169));r?(e=Qm(e,s,nn),o.__reactInternalMemoizedMergedChildContext=e,Pt(je),Pt(Se),At(Se,e)):Pt(je),At(je,r)}var Xi=null,gl=!1,tc=!1;function qm(e){Xi===null?Xi=[e]:Xi.push(e)}function bx(e){gl=!0,qm(e)}function Ts(){if(!tc&&Xi!==null){tc=!0;var e=0,s=St;try{var r=Xi;for(St=1;e<r.length;e++){var o=r[e];do o=o(!0);while(o!==null)}Xi=null,gl=!1}catch(l){throw Xi!==null&&(Xi=Xi.slice(e+1)),xm(Fu,Ts),l}finally{St=s,tc=!1}}return null}var Hn=[],Wn=0,Ya=null,$a=0,ai=[],li=0,rn=null,Yi=1,$i="";function Ys(e,s){Hn[Wn++]=$a,Hn[Wn++]=Ya,Ya=e,$a=s}function Zm(e,s,r){ai[li++]=Yi,ai[li++]=$i,ai[li++]=rn,rn=e;var o=Yi;e=$i;var l=32-xi(o)-1;o&=~(1<<l),r+=1;var c=32-xi(s)+l;if(30<c){var f=l-l%5;c=(o&(1<<f)-1).toString(32),o>>=f,l-=f,Yi=1<<32-xi(s)+l|r<<l|o,$i=c+e}else Yi=1<<c|r<<l|o,$i=e}function Wu(e){e.return!==null&&(Ys(e,1),Zm(e,1,0))}function ju(e){for(;e===Ya;)Ya=Hn[--Wn],Hn[Wn]=null,$a=Hn[--Wn],Hn[Wn]=null;for(;e===rn;)rn=ai[--li],ai[li]=null,$i=ai[--li],ai[li]=null,Yi=ai[--li],ai[li]=null}var Je=null,Ke=null,Dt=!1,wi=null;function Km(e,s){var r=hi(5,null,null,0);r.elementType="DELETED",r.stateNode=s,r.return=e,s=e.deletions,s===null?(e.deletions=[r],e.flags|=16):s.push(r)}function Np(e,s){switch(e.tag){case 5:var r=e.type;return s=s.nodeType!==1||r.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(e.stateNode=s,Je=e,Ke=vs(s.firstChild),!0):!1;case 6:return s=e.pendingProps===""||s.nodeType!==3?null:s,s!==null?(e.stateNode=s,Je=e,Ke=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(r=rn!==null?{id:Yi,overflow:$i}:null,e.memoizedState={dehydrated:s,treeContext:r,retryLane:1073741824},r=hi(18,null,null,0),r.stateNode=s,r.return=e,e.child=r,Je=e,Ke=null,!0):!1;default:return!1}}function Xc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Yc(e){if(Dt){var s=Ke;if(s){var r=s;if(!Np(e,s)){if(Xc(e))throw Error(q(418));s=vs(r.nextSibling);var o=Je;s&&Np(e,s)?Km(o,r):(e.flags=e.flags&-4097|2,Dt=!1,Je=e)}}else{if(Xc(e))throw Error(q(418));e.flags=e.flags&-4097|2,Dt=!1,Je=e}}}function Up(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Je=e}function ga(e){if(e!==Je)return!1;if(!Dt)return Up(e),Dt=!0,!1;var s;if((s=e.tag!==3)&&!(s=e.tag!==5)&&(s=e.type,s=s!=="head"&&s!=="body"&&!Wc(e.type,e.memoizedProps)),s&&(s=Ke)){if(Xc(e))throw Jm(),Error(q(418));for(;s;)Km(e,s),s=vs(s.nextSibling)}if(Up(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(q(317));t:{for(e=e.nextSibling,s=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(s===0){Ke=vs(e.nextSibling);break t}s--}else r!=="$"&&r!=="$!"&&r!=="$?"||s++}e=e.nextSibling}Ke=null}}else Ke=Je?vs(e.stateNode.nextSibling):null;return!0}function Jm(){for(var e=Ke;e;)e=vs(e.nextSibling)}function tr(){Ke=Je=null,Dt=!1}function Vu(e){wi===null?wi=[e]:wi.push(e)}var Cx=ts.ReactCurrentBatchConfig;function Mr(e,s,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(q(309));var o=r.stateNode}if(!o)throw Error(q(147,e));var l=o,c=""+e;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===c?s.ref:(s=function(f){var g=l.refs;f===null?delete g[c]:g[c]=f},s._stringRef=c,s)}if(typeof e!="string")throw Error(q(284));if(!r._owner)throw Error(q(290,e))}return e}function ma(e,s){throw e=Object.prototype.toString.call(s),Error(q(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}function zp(e){var s=e._init;return s(e._payload)}function t_(e){function s(T,P){if(e){var D=T.deletions;D===null?(T.deletions=[P],T.flags|=16):D.push(P)}}function r(T,P){if(!e)return null;for(;P!==null;)s(T,P),P=P.sibling;return null}function o(T,P){for(T=new Map;P!==null;)P.key!==null?T.set(P.key,P):T.set(P.index,P),P=P.sibling;return T}function l(T,P){return T=bs(T,P),T.index=0,T.sibling=null,T}function c(T,P,D){return T.index=D,e?(D=T.alternate,D!==null?(D=D.index,D<P?(T.flags|=2,P):D):(T.flags|=2,P)):(T.flags|=1048576,P)}function f(T){return e&&T.alternate===null&&(T.flags|=2),T}function g(T,P,D,W){return P===null||P.tag!==6?(P=ac(D,T.mode,W),P.return=T,P):(P=l(P,D),P.return=T,P)}function _(T,P,D,W){var j=D.type;return j===Mn?x(T,P,D.props.children,W,D.key):P!==null&&(P.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===ls&&zp(j)===P.type)?(W=l(P,D.props),W.ref=Mr(T,P,D),W.return=T,W):(W=ka(D.type,D.key,D.props,null,T.mode,W),W.ref=Mr(T,P,D),W.return=T,W)}function v(T,P,D,W){return P===null||P.tag!==4||P.stateNode.containerInfo!==D.containerInfo||P.stateNode.implementation!==D.implementation?(P=lc(D,T.mode,W),P.return=T,P):(P=l(P,D.children||[]),P.return=T,P)}function x(T,P,D,W,j){return P===null||P.tag!==7?(P=tn(D,T.mode,W,j),P.return=T,P):(P=l(P,D),P.return=T,P)}function S(T,P,D){if(typeof P=="string"&&P!==""||typeof P=="number")return P=ac(""+P,T.mode,D),P.return=T,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case ra:return D=ka(P.type,P.key,P.props,null,T.mode,D),D.ref=Mr(T,null,P),D.return=T,D;case Bn:return P=lc(P,T.mode,D),P.return=T,P;case ls:var W=P._init;return S(T,W(P._payload),D)}if(Hr(P)||Ir(P))return P=tn(P,T.mode,D,null),P.return=T,P;ma(T,P)}return null}function A(T,P,D,W){var j=P!==null?P.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return j!==null?null:g(T,P,""+D,W);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case ra:return D.key===j?_(T,P,D,W):null;case Bn:return D.key===j?v(T,P,D,W):null;case ls:return j=D._init,A(T,P,j(D._payload),W)}if(Hr(D)||Ir(D))return j!==null?null:x(T,P,D,W,null);ma(T,D)}return null}function I(T,P,D,W,j){if(typeof W=="string"&&W!==""||typeof W=="number")return T=T.get(D)||null,g(P,T,""+W,j);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case ra:return T=T.get(W.key===null?D:W.key)||null,_(P,T,W,j);case Bn:return T=T.get(W.key===null?D:W.key)||null,v(P,T,W,j);case ls:var K=W._init;return I(T,P,D,K(W._payload),j)}if(Hr(W)||Ir(W))return T=T.get(D)||null,x(P,T,W,j,null);ma(P,W)}return null}function F(T,P,D,W){for(var j=null,K=null,E=P,B=P=0,G=null;E!==null&&B<D.length;B++){E.index>B?(G=E,E=null):G=E.sibling;var rt=A(T,E,D[B],W);if(rt===null){E===null&&(E=G);break}e&&E&&rt.alternate===null&&s(T,E),P=c(rt,P,B),K===null?j=rt:K.sibling=rt,K=rt,E=G}if(B===D.length)return r(T,E),Dt&&Ys(T,B),j;if(E===null){for(;B<D.length;B++)E=S(T,D[B],W),E!==null&&(P=c(E,P,B),K===null?j=E:K.sibling=E,K=E);return Dt&&Ys(T,B),j}for(E=o(T,E);B<D.length;B++)G=I(E,T,B,D[B],W),G!==null&&(e&&G.alternate!==null&&E.delete(G.key===null?B:G.key),P=c(G,P,B),K===null?j=G:K.sibling=G,K=G);return e&&E.forEach(function(at){return s(T,at)}),Dt&&Ys(T,B),j}function L(T,P,D,W){var j=Ir(D);if(typeof j!="function")throw Error(q(150));if(D=j.call(D),D==null)throw Error(q(151));for(var K=j=null,E=P,B=P=0,G=null,rt=D.next();E!==null&&!rt.done;B++,rt=D.next()){E.index>B?(G=E,E=null):G=E.sibling;var at=A(T,E,rt.value,W);if(at===null){E===null&&(E=G);break}e&&E&&at.alternate===null&&s(T,E),P=c(at,P,B),K===null?j=at:K.sibling=at,K=at,E=G}if(rt.done)return r(T,E),Dt&&Ys(T,B),j;if(E===null){for(;!rt.done;B++,rt=D.next())rt=S(T,rt.value,W),rt!==null&&(P=c(rt,P,B),K===null?j=rt:K.sibling=rt,K=rt);return Dt&&Ys(T,B),j}for(E=o(T,E);!rt.done;B++,rt=D.next())rt=I(E,T,B,rt.value,W),rt!==null&&(e&&rt.alternate!==null&&E.delete(rt.key===null?B:rt.key),P=c(rt,P,B),K===null?j=rt:K.sibling=rt,K=rt);return e&&E.forEach(function(J){return s(T,J)}),Dt&&Ys(T,B),j}function O(T,P,D,W){if(typeof D=="object"&&D!==null&&D.type===Mn&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case ra:t:{for(var j=D.key,K=P;K!==null;){if(K.key===j){if(j=D.type,j===Mn){if(K.tag===7){r(T,K.sibling),P=l(K,D.props.children),P.return=T,T=P;break t}}else if(K.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===ls&&zp(j)===K.type){r(T,K.sibling),P=l(K,D.props),P.ref=Mr(T,K,D),P.return=T,T=P;break t}r(T,K);break}else s(T,K);K=K.sibling}D.type===Mn?(P=tn(D.props.children,T.mode,W,D.key),P.return=T,T=P):(W=ka(D.type,D.key,D.props,null,T.mode,W),W.ref=Mr(T,P,D),W.return=T,T=W)}return f(T);case Bn:t:{for(K=D.key;P!==null;){if(P.key===K)if(P.tag===4&&P.stateNode.containerInfo===D.containerInfo&&P.stateNode.implementation===D.implementation){r(T,P.sibling),P=l(P,D.children||[]),P.return=T,T=P;break t}else{r(T,P);break}else s(T,P);P=P.sibling}P=lc(D,T.mode,W),P.return=T,T=P}return f(T);case ls:return K=D._init,O(T,P,K(D._payload),W)}if(Hr(D))return F(T,P,D,W);if(Ir(D))return L(T,P,D,W);ma(T,D)}return typeof D=="string"&&D!==""||typeof D=="number"?(D=""+D,P!==null&&P.tag===6?(r(T,P.sibling),P=l(P,D),P.return=T,T=P):(r(T,P),P=ac(D,T.mode,W),P.return=T,T=P),f(T)):r(T,P)}return O}var er=t_(!0),e_=t_(!1),Qa=As(null),qa=null,jn=null,Gu=null;function Xu(){Gu=jn=qa=null}function Yu(e){var s=Qa.current;Pt(Qa),e._currentValue=s}function $c(e,s,r){for(;e!==null;){var o=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,o!==null&&(o.childLanes|=s)):o!==null&&(o.childLanes&s)!==s&&(o.childLanes|=s),e===r)break;e=e.return}}function qn(e,s){qa=e,Gu=jn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&s&&(We=!0),e.firstContext=null)}function ui(e){var s=e._currentValue;if(Gu!==e)if(e={context:e,memoizedValue:s,next:null},jn===null){if(qa===null)throw Error(q(308));jn=e,qa.dependencies={lanes:0,firstContext:e}}else jn=jn.next=e;return s}var qs=null;function $u(e){qs===null?qs=[e]:qs.push(e)}function i_(e,s,r,o){var l=s.interleaved;return l===null?(r.next=r,$u(s)):(r.next=l.next,l.next=r),s.interleaved=r,Ki(e,o)}function Ki(e,s){e.lanes|=s;var r=e.alternate;for(r!==null&&(r.lanes|=s),r=e,e=e.return;e!==null;)e.childLanes|=s,r=e.alternate,r!==null&&(r.childLanes|=s),r=e,e=e.return;return r.tag===3?r.stateNode:null}var hs=!1;function Qu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function s_(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Qi(e,s){return{eventTime:e,lane:s,tag:0,payload:null,callback:null,next:null}}function ys(e,s,r){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,xt&2){var l=o.pending;return l===null?s.next=s:(s.next=l.next,l.next=s),o.pending=s,Ki(e,r)}return l=o.interleaved,l===null?(s.next=s,$u(o)):(s.next=l.next,l.next=s),o.interleaved=s,Ki(e,r)}function Aa(e,s,r){if(s=s.updateQueue,s!==null&&(s=s.shared,(r&4194240)!==0)){var o=s.lanes;o&=e.pendingLanes,r|=o,s.lanes=r,Bu(e,r)}}function Hp(e,s){var r=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,r===o)){var l=null,c=null;if(r=r.firstBaseUpdate,r!==null){do{var f={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};c===null?l=c=f:c=c.next=f,r=r.next}while(r!==null);c===null?l=c=s:c=c.next=s}else l=c=s;r={baseState:o.baseState,firstBaseUpdate:l,lastBaseUpdate:c,shared:o.shared,effects:o.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=s:e.next=s,r.lastBaseUpdate=s}function Za(e,s,r,o){var l=e.updateQueue;hs=!1;var c=l.firstBaseUpdate,f=l.lastBaseUpdate,g=l.shared.pending;if(g!==null){l.shared.pending=null;var _=g,v=_.next;_.next=null,f===null?c=v:f.next=v,f=_;var x=e.alternate;x!==null&&(x=x.updateQueue,g=x.lastBaseUpdate,g!==f&&(g===null?x.firstBaseUpdate=v:g.next=v,x.lastBaseUpdate=_))}if(c!==null){var S=l.baseState;f=0,x=v=_=null,g=c;do{var A=g.lane,I=g.eventTime;if((o&A)===A){x!==null&&(x=x.next={eventTime:I,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});t:{var F=e,L=g;switch(A=s,I=r,L.tag){case 1:if(F=L.payload,typeof F=="function"){S=F.call(I,S,A);break t}S=F;break t;case 3:F.flags=F.flags&-65537|128;case 0:if(F=L.payload,A=typeof F=="function"?F.call(I,S,A):F,A==null)break t;S=Ot({},S,A);break t;case 2:hs=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,A=l.effects,A===null?l.effects=[g]:A.push(g))}else I={eventTime:I,lane:A,tag:g.tag,payload:g.payload,callback:g.callback,next:null},x===null?(v=x=I,_=S):x=x.next=I,f|=A;if(g=g.next,g===null){if(g=l.shared.pending,g===null)break;A=g,g=A.next,A.next=null,l.lastBaseUpdate=A,l.shared.pending=null}}while(!0);if(x===null&&(_=S),l.baseState=_,l.firstBaseUpdate=v,l.lastBaseUpdate=x,s=l.shared.interleaved,s!==null){l=s;do f|=l.lane,l=l.next;while(l!==s)}else c===null&&(l.shared.lanes=0);an|=f,e.lanes=f,e.memoizedState=S}}function Wp(e,s,r){if(e=s.effects,s.effects=null,e!==null)for(s=0;s<e.length;s++){var o=e[s],l=o.callback;if(l!==null){if(o.callback=null,o=r,typeof l!="function")throw Error(q(191,l));l.call(o)}}}var So={},Ni=As(So),co=As(So),uo=As(So);function Zs(e){if(e===So)throw Error(q(174));return e}function qu(e,s){switch(At(uo,s),At(co,e),At(Ni,So),e=s.nodeType,e){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Pc(null,"");break;default:e=e===8?s.parentNode:s,s=e.namespaceURI||null,e=e.tagName,s=Pc(s,e)}Pt(Ni),At(Ni,s)}function ir(){Pt(Ni),Pt(co),Pt(uo)}function n_(e){Zs(uo.current);var s=Zs(Ni.current),r=Pc(s,e.type);s!==r&&(At(co,e),At(Ni,r))}function Zu(e){co.current===e&&(Pt(Ni),Pt(co))}var Mt=As(0);function Ka(e){for(var s=e;s!==null;){if(s.tag===13){var r=s.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var ec=[];function Ku(){for(var e=0;e<ec.length;e++)ec[e]._workInProgressVersionPrimary=null;ec.length=0}var Ta=ts.ReactCurrentDispatcher,ic=ts.ReactCurrentBatchConfig,on=0,Lt=null,se=null,he=null,Ja=!1,Qr=!1,fo=0,Sx=0;function xe(){throw Error(q(321))}function Ju(e,s){if(s===null)return!1;for(var r=0;r<s.length&&r<e.length;r++)if(!Ci(e[r],s[r]))return!1;return!0}function td(e,s,r,o,l,c){if(on=c,Lt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Ta.current=e===null||e.memoizedState===null?Px:Rx,e=r(o,l),Qr){c=0;do{if(Qr=!1,fo=0,25<=c)throw Error(q(301));c+=1,he=se=null,s.updateQueue=null,Ta.current=Ix,e=r(o,l)}while(Qr)}if(Ta.current=tl,s=se!==null&&se.next!==null,on=0,he=se=Lt=null,Ja=!1,s)throw Error(q(300));return e}function ed(){var e=fo!==0;return fo=0,e}function Mi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return he===null?Lt.memoizedState=he=e:he=he.next=e,he}function di(){if(se===null){var e=Lt.alternate;e=e!==null?e.memoizedState:null}else e=se.next;var s=he===null?Lt.memoizedState:he.next;if(s!==null)he=s,se=e;else{if(e===null)throw Error(q(310));se=e,e={memoizedState:se.memoizedState,baseState:se.baseState,baseQueue:se.baseQueue,queue:se.queue,next:null},he===null?Lt.memoizedState=he=e:he=he.next=e}return he}function po(e,s){return typeof s=="function"?s(e):s}function sc(e){var s=di(),r=s.queue;if(r===null)throw Error(q(311));r.lastRenderedReducer=e;var o=se,l=o.baseQueue,c=r.pending;if(c!==null){if(l!==null){var f=l.next;l.next=c.next,c.next=f}o.baseQueue=l=c,r.pending=null}if(l!==null){c=l.next,o=o.baseState;var g=f=null,_=null,v=c;do{var x=v.lane;if((on&x)===x)_!==null&&(_=_.next={lane:0,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null}),o=v.hasEagerState?v.eagerState:e(o,v.action);else{var S={lane:x,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null};_===null?(g=_=S,f=o):_=_.next=S,Lt.lanes|=x,an|=x}v=v.next}while(v!==null&&v!==c);_===null?f=o:_.next=g,Ci(o,s.memoizedState)||(We=!0),s.memoizedState=o,s.baseState=f,s.baseQueue=_,r.lastRenderedState=o}if(e=r.interleaved,e!==null){l=e;do c=l.lane,Lt.lanes|=c,an|=c,l=l.next;while(l!==e)}else l===null&&(r.lanes=0);return[s.memoizedState,r.dispatch]}function nc(e){var s=di(),r=s.queue;if(r===null)throw Error(q(311));r.lastRenderedReducer=e;var o=r.dispatch,l=r.pending,c=s.memoizedState;if(l!==null){r.pending=null;var f=l=l.next;do c=e(c,f.action),f=f.next;while(f!==l);Ci(c,s.memoizedState)||(We=!0),s.memoizedState=c,s.baseQueue===null&&(s.baseState=c),r.lastRenderedState=c}return[c,o]}function r_(){}function o_(e,s){var r=Lt,o=di(),l=s(),c=!Ci(o.memoizedState,l);if(c&&(o.memoizedState=l,We=!0),o=o.queue,id(h_.bind(null,r,o,e),[e]),o.getSnapshot!==s||c||he!==null&&he.memoizedState.tag&1){if(r.flags|=2048,go(9,l_.bind(null,r,o,l,s),void 0,null),ce===null)throw Error(q(349));on&30||a_(r,s,l)}return l}function a_(e,s,r){e.flags|=16384,e={getSnapshot:s,value:r},s=Lt.updateQueue,s===null?(s={lastEffect:null,stores:null},Lt.updateQueue=s,s.stores=[e]):(r=s.stores,r===null?s.stores=[e]:r.push(e))}function l_(e,s,r,o){s.value=r,s.getSnapshot=o,c_(s)&&u_(e)}function h_(e,s,r){return r(function(){c_(s)&&u_(e)})}function c_(e){var s=e.getSnapshot;e=e.value;try{var r=s();return!Ci(e,r)}catch{return!0}}function u_(e){var s=Ki(e,1);s!==null&&bi(s,e,1,-1)}function jp(e){var s=Mi();return typeof e=="function"&&(e=e()),s.memoizedState=s.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:po,lastRenderedState:e},s.queue=e,e=e.dispatch=Tx.bind(null,Lt,e),[s.memoizedState,e]}function go(e,s,r,o){return e={tag:e,create:s,destroy:r,deps:o,next:null},s=Lt.updateQueue,s===null?(s={lastEffect:null,stores:null},Lt.updateQueue=s,s.lastEffect=e.next=e):(r=s.lastEffect,r===null?s.lastEffect=e.next=e:(o=r.next,r.next=e,e.next=o,s.lastEffect=e)),e}function d_(){return di().memoizedState}function Pa(e,s,r,o){var l=Mi();Lt.flags|=e,l.memoizedState=go(1|s,r,void 0,o===void 0?null:o)}function ml(e,s,r,o){var l=di();o=o===void 0?null:o;var c=void 0;if(se!==null){var f=se.memoizedState;if(c=f.destroy,o!==null&&Ju(o,f.deps)){l.memoizedState=go(s,r,c,o);return}}Lt.flags|=e,l.memoizedState=go(1|s,r,c,o)}function Vp(e,s){return Pa(8390656,8,e,s)}function id(e,s){return ml(2048,8,e,s)}function f_(e,s){return ml(4,2,e,s)}function p_(e,s){return ml(4,4,e,s)}function g_(e,s){if(typeof s=="function")return e=e(),s(e),function(){s(null)};if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function m_(e,s,r){return r=r!=null?r.concat([e]):null,ml(4,4,g_.bind(null,s,e),r)}function sd(){}function __(e,s){var r=di();s=s===void 0?null:s;var o=r.memoizedState;return o!==null&&s!==null&&Ju(s,o[1])?o[0]:(r.memoizedState=[e,s],e)}function v_(e,s){var r=di();s=s===void 0?null:s;var o=r.memoizedState;return o!==null&&s!==null&&Ju(s,o[1])?o[0]:(e=e(),r.memoizedState=[e,s],e)}function y_(e,s,r){return on&21?(Ci(r,s)||(r=Sm(),Lt.lanes|=r,an|=r,e.baseState=!0),s):(e.baseState&&(e.baseState=!1,We=!0),e.memoizedState=r)}function Ex(e,s){var r=St;St=r!==0&&4>r?r:4,e(!0);var o=ic.transition;ic.transition={};try{e(!1),s()}finally{St=r,ic.transition=o}}function w_(){return di().memoizedState}function Ax(e,s,r){var o=xs(e);if(r={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null},x_(e))b_(s,r);else if(r=i_(e,s,r,o),r!==null){var l=De();bi(r,e,o,l),C_(r,s,o)}}function Tx(e,s,r){var o=xs(e),l={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null};if(x_(e))b_(s,l);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=s.lastRenderedReducer,c!==null))try{var f=s.lastRenderedState,g=c(f,r);if(l.hasEagerState=!0,l.eagerState=g,Ci(g,f)){var _=s.interleaved;_===null?(l.next=l,$u(s)):(l.next=_.next,_.next=l),s.interleaved=l;return}}catch{}finally{}r=i_(e,s,l,o),r!==null&&(l=De(),bi(r,e,o,l),C_(r,s,o))}}function x_(e){var s=e.alternate;return e===Lt||s!==null&&s===Lt}function b_(e,s){Qr=Ja=!0;var r=e.pending;r===null?s.next=s:(s.next=r.next,r.next=s),e.pending=s}function C_(e,s,r){if(r&4194240){var o=s.lanes;o&=e.pendingLanes,r|=o,s.lanes=r,Bu(e,r)}}var tl={readContext:ui,useCallback:xe,useContext:xe,useEffect:xe,useImperativeHandle:xe,useInsertionEffect:xe,useLayoutEffect:xe,useMemo:xe,useReducer:xe,useRef:xe,useState:xe,useDebugValue:xe,useDeferredValue:xe,useTransition:xe,useMutableSource:xe,useSyncExternalStore:xe,useId:xe,unstable_isNewReconciler:!1},Px={readContext:ui,useCallback:function(e,s){return Mi().memoizedState=[e,s===void 0?null:s],e},useContext:ui,useEffect:Vp,useImperativeHandle:function(e,s,r){return r=r!=null?r.concat([e]):null,Pa(4194308,4,g_.bind(null,s,e),r)},useLayoutEffect:function(e,s){return Pa(4194308,4,e,s)},useInsertionEffect:function(e,s){return Pa(4,2,e,s)},useMemo:function(e,s){var r=Mi();return s=s===void 0?null:s,e=e(),r.memoizedState=[e,s],e},useReducer:function(e,s,r){var o=Mi();return s=r!==void 0?r(s):s,o.memoizedState=o.baseState=s,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},o.queue=e,e=e.dispatch=Ax.bind(null,Lt,e),[o.memoizedState,e]},useRef:function(e){var s=Mi();return e={current:e},s.memoizedState=e},useState:jp,useDebugValue:sd,useDeferredValue:function(e){return Mi().memoizedState=e},useTransition:function(){var e=jp(!1),s=e[0];return e=Ex.bind(null,e[1]),Mi().memoizedState=e,[s,e]},useMutableSource:function(){},useSyncExternalStore:function(e,s,r){var o=Lt,l=Mi();if(Dt){if(r===void 0)throw Error(q(407));r=r()}else{if(r=s(),ce===null)throw Error(q(349));on&30||a_(o,s,r)}l.memoizedState=r;var c={value:r,getSnapshot:s};return l.queue=c,Vp(h_.bind(null,o,c,e),[e]),o.flags|=2048,go(9,l_.bind(null,o,c,r,s),void 0,null),r},useId:function(){var e=Mi(),s=ce.identifierPrefix;if(Dt){var r=$i,o=Yi;r=(o&~(1<<32-xi(o)-1)).toString(32)+r,s=":"+s+"R"+r,r=fo++,0<r&&(s+="H"+r.toString(32)),s+=":"}else r=Sx++,s=":"+s+"r"+r.toString(32)+":";return e.memoizedState=s},unstable_isNewReconciler:!1},Rx={readContext:ui,useCallback:__,useContext:ui,useEffect:id,useImperativeHandle:m_,useInsertionEffect:f_,useLayoutEffect:p_,useMemo:v_,useReducer:sc,useRef:d_,useState:function(){return sc(po)},useDebugValue:sd,useDeferredValue:function(e){var s=di();return y_(s,se.memoizedState,e)},useTransition:function(){var e=sc(po)[0],s=di().memoizedState;return[e,s]},useMutableSource:r_,useSyncExternalStore:o_,useId:w_,unstable_isNewReconciler:!1},Ix={readContext:ui,useCallback:__,useContext:ui,useEffect:id,useImperativeHandle:m_,useInsertionEffect:f_,useLayoutEffect:p_,useMemo:v_,useReducer:nc,useRef:d_,useState:function(){return nc(po)},useDebugValue:sd,useDeferredValue:function(e){var s=di();return se===null?s.memoizedState=e:y_(s,se.memoizedState,e)},useTransition:function(){var e=nc(po)[0],s=di().memoizedState;return[e,s]},useMutableSource:r_,useSyncExternalStore:o_,useId:w_,unstable_isNewReconciler:!1};function vi(e,s){if(e&&e.defaultProps){s=Ot({},s),e=e.defaultProps;for(var r in e)s[r]===void 0&&(s[r]=e[r]);return s}return s}function Qc(e,s,r,o){s=e.memoizedState,r=r(o,s),r=r==null?s:Ot({},s,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var _l={isMounted:function(e){return(e=e._reactInternals)?un(e)===e:!1},enqueueSetState:function(e,s,r){e=e._reactInternals;var o=De(),l=xs(e),c=Qi(o,l);c.payload=s,r!=null&&(c.callback=r),s=ys(e,c,l),s!==null&&(bi(s,e,l,o),Aa(s,e,l))},enqueueReplaceState:function(e,s,r){e=e._reactInternals;var o=De(),l=xs(e),c=Qi(o,l);c.tag=1,c.payload=s,r!=null&&(c.callback=r),s=ys(e,c,l),s!==null&&(bi(s,e,l,o),Aa(s,e,l))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var r=De(),o=xs(e),l=Qi(r,o);l.tag=2,s!=null&&(l.callback=s),s=ys(e,l,o),s!==null&&(bi(s,e,o,r),Aa(s,e,o))}};function Gp(e,s,r,o,l,c,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,c,f):s.prototype&&s.prototype.isPureReactComponent?!oo(r,o)||!oo(l,c):!0}function S_(e,s,r){var o=!1,l=Ss,c=s.contextType;return typeof c=="object"&&c!==null?c=ui(c):(l=Ve(s)?nn:Se.current,o=s.contextTypes,c=(o=o!=null)?Jn(e,l):Ss),s=new s(r,c),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=_l,e.stateNode=s,s._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=c),s}function Xp(e,s,r,o){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(r,o),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(r,o),s.state!==e&&_l.enqueueReplaceState(s,s.state,null)}function qc(e,s,r,o){var l=e.stateNode;l.props=r,l.state=e.memoizedState,l.refs={},Qu(e);var c=s.contextType;typeof c=="object"&&c!==null?l.context=ui(c):(c=Ve(s)?nn:Se.current,l.context=Jn(e,c)),l.state=e.memoizedState,c=s.getDerivedStateFromProps,typeof c=="function"&&(Qc(e,s,c,r),l.state=e.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(s=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),s!==l.state&&_l.enqueueReplaceState(l,l.state,null),Za(e,r,l,o),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function sr(e,s){try{var r="",o=s;do r+=nw(o),o=o.return;while(o);var l=r}catch(c){l=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:s,stack:l,digest:null}}function rc(e,s,r){return{value:e,source:null,stack:r??null,digest:s??null}}function Zc(e,s){try{console.error(s.value)}catch(r){setTimeout(function(){throw r})}}var Dx=typeof WeakMap=="function"?WeakMap:Map;function E_(e,s,r){r=Qi(-1,r),r.tag=3,r.payload={element:null};var o=s.value;return r.callback=function(){il||(il=!0,au=o),Zc(e,s)},r}function A_(e,s,r){r=Qi(-1,r),r.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var l=s.value;r.payload=function(){return o(l)},r.callback=function(){Zc(e,s)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(r.callback=function(){Zc(e,s),typeof o!="function"&&(ws===null?ws=new Set([this]):ws.add(this));var f=s.stack;this.componentDidCatch(s.value,{componentStack:f!==null?f:""})}),r}function Yp(e,s,r){var o=e.pingCache;if(o===null){o=e.pingCache=new Dx;var l=new Set;o.set(s,l)}else l=o.get(s),l===void 0&&(l=new Set,o.set(s,l));l.has(r)||(l.add(r),e=Gx.bind(null,e,s,r),s.then(e,e))}function $p(e){do{var s;if((s=e.tag===13)&&(s=e.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return e;e=e.return}while(e!==null);return null}function Qp(e,s,r,o,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===s?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(s=Qi(-1,1),s.tag=2,ys(r,s,1))),r.lanes|=1),e)}var kx=ts.ReactCurrentOwner,We=!1;function Ie(e,s,r,o){s.child=e===null?e_(s,null,r,o):er(s,e.child,r,o)}function qp(e,s,r,o,l){r=r.render;var c=s.ref;return qn(s,l),o=td(e,s,r,o,c,l),r=ed(),e!==null&&!We?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~l,Ji(e,s,l)):(Dt&&r&&Wu(s),s.flags|=1,Ie(e,s,o,l),s.child)}function Zp(e,s,r,o,l){if(e===null){var c=r.type;return typeof c=="function"&&!ud(c)&&c.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(s.tag=15,s.type=c,T_(e,s,c,o,l)):(e=ka(r.type,null,o,s,s.mode,l),e.ref=s.ref,e.return=s,s.child=e)}if(c=e.child,!(e.lanes&l)){var f=c.memoizedProps;if(r=r.compare,r=r!==null?r:oo,r(f,o)&&e.ref===s.ref)return Ji(e,s,l)}return s.flags|=1,e=bs(c,o),e.ref=s.ref,e.return=s,s.child=e}function T_(e,s,r,o,l){if(e!==null){var c=e.memoizedProps;if(oo(c,o)&&e.ref===s.ref)if(We=!1,s.pendingProps=o=c,(e.lanes&l)!==0)e.flags&131072&&(We=!0);else return s.lanes=e.lanes,Ji(e,s,l)}return Kc(e,s,r,o,l)}function P_(e,s,r){var o=s.pendingProps,l=o.children,c=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(Gn,Ze),Ze|=r;else{if(!(r&1073741824))return e=c!==null?c.baseLanes|r:r,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:e,cachePool:null,transitions:null},s.updateQueue=null,At(Gn,Ze),Ze|=e,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=c!==null?c.baseLanes:r,At(Gn,Ze),Ze|=o}else c!==null?(o=c.baseLanes|r,s.memoizedState=null):o=r,At(Gn,Ze),Ze|=o;return Ie(e,s,l,r),s.child}function R_(e,s){var r=s.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(s.flags|=512,s.flags|=2097152)}function Kc(e,s,r,o,l){var c=Ve(r)?nn:Se.current;return c=Jn(s,c),qn(s,l),r=td(e,s,r,o,c,l),o=ed(),e!==null&&!We?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~l,Ji(e,s,l)):(Dt&&o&&Wu(s),s.flags|=1,Ie(e,s,r,l),s.child)}function Kp(e,s,r,o,l){if(Ve(r)){var c=!0;Xa(s)}else c=!1;if(qn(s,l),s.stateNode===null)Ra(e,s),S_(s,r,o),qc(s,r,o,l),o=!0;else if(e===null){var f=s.stateNode,g=s.memoizedProps;f.props=g;var _=f.context,v=r.contextType;typeof v=="object"&&v!==null?v=ui(v):(v=Ve(r)?nn:Se.current,v=Jn(s,v));var x=r.getDerivedStateFromProps,S=typeof x=="function"||typeof f.getSnapshotBeforeUpdate=="function";S||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(g!==o||_!==v)&&Xp(s,f,o,v),hs=!1;var A=s.memoizedState;f.state=A,Za(s,o,f,l),_=s.memoizedState,g!==o||A!==_||je.current||hs?(typeof x=="function"&&(Qc(s,r,x,o),_=s.memoizedState),(g=hs||Gp(s,r,g,o,A,_,v))?(S||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(s.flags|=4194308)):(typeof f.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=o,s.memoizedState=_),f.props=o,f.state=_,f.context=v,o=g):(typeof f.componentDidMount=="function"&&(s.flags|=4194308),o=!1)}else{f=s.stateNode,s_(e,s),g=s.memoizedProps,v=s.type===s.elementType?g:vi(s.type,g),f.props=v,S=s.pendingProps,A=f.context,_=r.contextType,typeof _=="object"&&_!==null?_=ui(_):(_=Ve(r)?nn:Se.current,_=Jn(s,_));var I=r.getDerivedStateFromProps;(x=typeof I=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(g!==S||A!==_)&&Xp(s,f,o,_),hs=!1,A=s.memoizedState,f.state=A,Za(s,o,f,l);var F=s.memoizedState;g!==S||A!==F||je.current||hs?(typeof I=="function"&&(Qc(s,r,I,o),F=s.memoizedState),(v=hs||Gp(s,r,v,o,A,F,_)||!1)?(x||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(o,F,_),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(o,F,_)),typeof f.componentDidUpdate=="function"&&(s.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof f.componentDidUpdate!="function"||g===e.memoizedProps&&A===e.memoizedState||(s.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&A===e.memoizedState||(s.flags|=1024),s.memoizedProps=o,s.memoizedState=F),f.props=o,f.state=F,f.context=_,o=v):(typeof f.componentDidUpdate!="function"||g===e.memoizedProps&&A===e.memoizedState||(s.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&A===e.memoizedState||(s.flags|=1024),o=!1)}return Jc(e,s,r,o,c,l)}function Jc(e,s,r,o,l,c){R_(e,s);var f=(s.flags&128)!==0;if(!o&&!f)return l&&Op(s,r,!1),Ji(e,s,c);o=s.stateNode,kx.current=s;var g=f&&typeof r.getDerivedStateFromError!="function"?null:o.render();return s.flags|=1,e!==null&&f?(s.child=er(s,e.child,null,c),s.child=er(s,null,g,c)):Ie(e,s,g,c),s.memoizedState=o.state,l&&Op(s,r,!0),s.child}function I_(e){var s=e.stateNode;s.pendingContext?Lp(e,s.pendingContext,s.pendingContext!==s.context):s.context&&Lp(e,s.context,!1),qu(e,s.containerInfo)}function Jp(e,s,r,o,l){return tr(),Vu(l),s.flags|=256,Ie(e,s,r,o),s.child}var tu={dehydrated:null,treeContext:null,retryLane:0};function eu(e){return{baseLanes:e,cachePool:null,transitions:null}}function D_(e,s,r){var o=s.pendingProps,l=Mt.current,c=!1,f=(s.flags&128)!==0,g;if((g=f)||(g=e!==null&&e.memoizedState===null?!1:(l&2)!==0),g?(c=!0,s.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),At(Mt,l&1),e===null)return Yc(s),e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(s.mode&1?e.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(f=o.children,e=o.fallback,c?(o=s.mode,c=s.child,f={mode:"hidden",children:f},!(o&1)&&c!==null?(c.childLanes=0,c.pendingProps=f):c=wl(f,o,0,null),e=tn(e,o,r,null),c.return=s,e.return=s,c.sibling=e,s.child=c,s.child.memoizedState=eu(r),s.memoizedState=tu,e):nd(s,f));if(l=e.memoizedState,l!==null&&(g=l.dehydrated,g!==null))return Fx(e,s,f,o,g,l,r);if(c){c=o.fallback,f=s.mode,l=e.child,g=l.sibling;var _={mode:"hidden",children:o.children};return!(f&1)&&s.child!==l?(o=s.child,o.childLanes=0,o.pendingProps=_,s.deletions=null):(o=bs(l,_),o.subtreeFlags=l.subtreeFlags&14680064),g!==null?c=bs(g,c):(c=tn(c,f,r,null),c.flags|=2),c.return=s,o.return=s,o.sibling=c,s.child=o,o=c,c=s.child,f=e.child.memoizedState,f=f===null?eu(r):{baseLanes:f.baseLanes|r,cachePool:null,transitions:f.transitions},c.memoizedState=f,c.childLanes=e.childLanes&~r,s.memoizedState=tu,o}return c=e.child,e=c.sibling,o=bs(c,{mode:"visible",children:o.children}),!(s.mode&1)&&(o.lanes=r),o.return=s,o.sibling=null,e!==null&&(r=s.deletions,r===null?(s.deletions=[e],s.flags|=16):r.push(e)),s.child=o,s.memoizedState=null,o}function nd(e,s){return s=wl({mode:"visible",children:s},e.mode,0,null),s.return=e,e.child=s}function _a(e,s,r,o){return o!==null&&Vu(o),er(s,e.child,null,r),e=nd(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function Fx(e,s,r,o,l,c,f){if(r)return s.flags&256?(s.flags&=-257,o=rc(Error(q(422))),_a(e,s,f,o)):s.memoizedState!==null?(s.child=e.child,s.flags|=128,null):(c=o.fallback,l=s.mode,o=wl({mode:"visible",children:o.children},l,0,null),c=tn(c,l,f,null),c.flags|=2,o.return=s,c.return=s,o.sibling=c,s.child=o,s.mode&1&&er(s,e.child,null,f),s.child.memoizedState=eu(f),s.memoizedState=tu,c);if(!(s.mode&1))return _a(e,s,f,null);if(l.data==="$!"){if(o=l.nextSibling&&l.nextSibling.dataset,o)var g=o.dgst;return o=g,c=Error(q(419)),o=rc(c,o,void 0),_a(e,s,f,o)}if(g=(f&e.childLanes)!==0,We||g){if(o=ce,o!==null){switch(f&-f){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(o.suspendedLanes|f)?0:l,l!==0&&l!==c.retryLane&&(c.retryLane=l,Ki(e,l),bi(o,e,l,-1))}return cd(),o=rc(Error(q(421))),_a(e,s,f,o)}return l.data==="$?"?(s.flags|=128,s.child=e.child,s=Xx.bind(null,e),l._reactRetry=s,null):(e=c.treeContext,Ke=vs(l.nextSibling),Je=s,Dt=!0,wi=null,e!==null&&(ai[li++]=Yi,ai[li++]=$i,ai[li++]=rn,Yi=e.id,$i=e.overflow,rn=s),s=nd(s,o.children),s.flags|=4096,s)}function tg(e,s,r){e.lanes|=s;var o=e.alternate;o!==null&&(o.lanes|=s),$c(e.return,s,r)}function oc(e,s,r,o,l){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:l}:(c.isBackwards=s,c.rendering=null,c.renderingStartTime=0,c.last=o,c.tail=r,c.tailMode=l)}function k_(e,s,r){var o=s.pendingProps,l=o.revealOrder,c=o.tail;if(Ie(e,s,o.children,r),o=Mt.current,o&2)o=o&1|2,s.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&tg(e,r,s);else if(e.tag===19)tg(e,r,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break t;for(;e.sibling===null;){if(e.return===null||e.return===s)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(At(Mt,o),!(s.mode&1))s.memoizedState=null;else switch(l){case"forwards":for(r=s.child,l=null;r!==null;)e=r.alternate,e!==null&&Ka(e)===null&&(l=r),r=r.sibling;r=l,r===null?(l=s.child,s.child=null):(l=r.sibling,r.sibling=null),oc(s,!1,l,r,c);break;case"backwards":for(r=null,l=s.child,s.child=null;l!==null;){if(e=l.alternate,e!==null&&Ka(e)===null){s.child=l;break}e=l.sibling,l.sibling=r,r=l,l=e}oc(s,!0,r,null,c);break;case"together":oc(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ra(e,s){!(s.mode&1)&&e!==null&&(e.alternate=null,s.alternate=null,s.flags|=2)}function Ji(e,s,r){if(e!==null&&(s.dependencies=e.dependencies),an|=s.lanes,!(r&s.childLanes))return null;if(e!==null&&s.child!==e.child)throw Error(q(153));if(s.child!==null){for(e=s.child,r=bs(e,e.pendingProps),s.child=r,r.return=s;e.sibling!==null;)e=e.sibling,r=r.sibling=bs(e,e.pendingProps),r.return=s;r.sibling=null}return s.child}function Bx(e,s,r){switch(s.tag){case 3:I_(s),tr();break;case 5:n_(s);break;case 1:Ve(s.type)&&Xa(s);break;case 4:qu(s,s.stateNode.containerInfo);break;case 10:var o=s.type._context,l=s.memoizedProps.value;At(Qa,o._currentValue),o._currentValue=l;break;case 13:if(o=s.memoizedState,o!==null)return o.dehydrated!==null?(At(Mt,Mt.current&1),s.flags|=128,null):r&s.child.childLanes?D_(e,s,r):(At(Mt,Mt.current&1),e=Ji(e,s,r),e!==null?e.sibling:null);At(Mt,Mt.current&1);break;case 19:if(o=(r&s.childLanes)!==0,e.flags&128){if(o)return k_(e,s,r);s.flags|=128}if(l=s.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),At(Mt,Mt.current),o)break;return null;case 22:case 23:return s.lanes=0,P_(e,s,r)}return Ji(e,s,r)}var F_,iu,B_,M_;F_=function(e,s){for(var r=s.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};iu=function(){};B_=function(e,s,r,o){var l=e.memoizedProps;if(l!==o){e=s.stateNode,Zs(Ni.current);var c=null;switch(r){case"input":l=Sc(e,l),o=Sc(e,o),c=[];break;case"select":l=Ot({},l,{value:void 0}),o=Ot({},o,{value:void 0}),c=[];break;case"textarea":l=Tc(e,l),o=Tc(e,o),c=[];break;default:typeof l.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=Va)}Rc(r,o);var f;r=null;for(v in l)if(!o.hasOwnProperty(v)&&l.hasOwnProperty(v)&&l[v]!=null)if(v==="style"){var g=l[v];for(f in g)g.hasOwnProperty(f)&&(r||(r={}),r[f]="")}else v!=="dangerouslySetInnerHTML"&&v!=="children"&&v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(Jr.hasOwnProperty(v)?c||(c=[]):(c=c||[]).push(v,null));for(v in o){var _=o[v];if(g=l!=null?l[v]:void 0,o.hasOwnProperty(v)&&_!==g&&(_!=null||g!=null))if(v==="style")if(g){for(f in g)!g.hasOwnProperty(f)||_&&_.hasOwnProperty(f)||(r||(r={}),r[f]="");for(f in _)_.hasOwnProperty(f)&&g[f]!==_[f]&&(r||(r={}),r[f]=_[f])}else r||(c||(c=[]),c.push(v,r)),r=_;else v==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,g=g?g.__html:void 0,_!=null&&g!==_&&(c=c||[]).push(v,_)):v==="children"?typeof _!="string"&&typeof _!="number"||(c=c||[]).push(v,""+_):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&(Jr.hasOwnProperty(v)?(_!=null&&v==="onScroll"&&Tt("scroll",e),c||g===_||(c=[])):(c=c||[]).push(v,_))}r&&(c=c||[]).push("style",r);var v=c;(s.updateQueue=v)&&(s.flags|=4)}};M_=function(e,s,r,o){r!==o&&(s.flags|=4)};function Lr(e,s){if(!Dt)switch(e.tailMode){case"hidden":s=e.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function be(e){var s=e.alternate!==null&&e.alternate.child===e.child,r=0,o=0;if(s)for(var l=e.child;l!==null;)r|=l.lanes|l.childLanes,o|=l.subtreeFlags&14680064,o|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)r|=l.lanes|l.childLanes,o|=l.subtreeFlags,o|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=o,e.childLanes=r,s}function Mx(e,s,r){var o=s.pendingProps;switch(ju(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return be(s),null;case 1:return Ve(s.type)&&Ga(),be(s),null;case 3:return o=s.stateNode,ir(),Pt(je),Pt(Se),Ku(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(ga(s)?s.flags|=4:e===null||e.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,wi!==null&&(cu(wi),wi=null))),iu(e,s),be(s),null;case 5:Zu(s);var l=Zs(uo.current);if(r=s.type,e!==null&&s.stateNode!=null)B_(e,s,r,o,l),e.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!o){if(s.stateNode===null)throw Error(q(166));return be(s),null}if(e=Zs(Ni.current),ga(s)){o=s.stateNode,r=s.type;var c=s.memoizedProps;switch(o[Li]=s,o[ho]=c,e=(s.mode&1)!==0,r){case"dialog":Tt("cancel",o),Tt("close",o);break;case"iframe":case"object":case"embed":Tt("load",o);break;case"video":case"audio":for(l=0;l<jr.length;l++)Tt(jr[l],o);break;case"source":Tt("error",o);break;case"img":case"image":case"link":Tt("error",o),Tt("load",o);break;case"details":Tt("toggle",o);break;case"input":hp(o,c),Tt("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!c.multiple},Tt("invalid",o);break;case"textarea":up(o,c),Tt("invalid",o)}Rc(r,c),l=null;for(var f in c)if(c.hasOwnProperty(f)){var g=c[f];f==="children"?typeof g=="string"?o.textContent!==g&&(c.suppressHydrationWarning!==!0&&pa(o.textContent,g,e),l=["children",g]):typeof g=="number"&&o.textContent!==""+g&&(c.suppressHydrationWarning!==!0&&pa(o.textContent,g,e),l=["children",""+g]):Jr.hasOwnProperty(f)&&g!=null&&f==="onScroll"&&Tt("scroll",o)}switch(r){case"input":oa(o),cp(o,c,!0);break;case"textarea":oa(o),dp(o);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(o.onclick=Va)}o=l,s.updateQueue=o,o!==null&&(s.flags|=4)}else{f=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=hm(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=f.createElement(r,{is:o.is}):(e=f.createElement(r),r==="select"&&(f=e,o.multiple?f.multiple=!0:o.size&&(f.size=o.size))):e=f.createElementNS(e,r),e[Li]=s,e[ho]=o,F_(e,s,!1,!1),s.stateNode=e;t:{switch(f=Ic(r,o),r){case"dialog":Tt("cancel",e),Tt("close",e),l=o;break;case"iframe":case"object":case"embed":Tt("load",e),l=o;break;case"video":case"audio":for(l=0;l<jr.length;l++)Tt(jr[l],e);l=o;break;case"source":Tt("error",e),l=o;break;case"img":case"image":case"link":Tt("error",e),Tt("load",e),l=o;break;case"details":Tt("toggle",e),l=o;break;case"input":hp(e,o),l=Sc(e,o),Tt("invalid",e);break;case"option":l=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},l=Ot({},o,{value:void 0}),Tt("invalid",e);break;case"textarea":up(e,o),l=Tc(e,o),Tt("invalid",e);break;default:l=o}Rc(r,l),g=l;for(c in g)if(g.hasOwnProperty(c)){var _=g[c];c==="style"?dm(e,_):c==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&cm(e,_)):c==="children"?typeof _=="string"?(r!=="textarea"||_!=="")&&to(e,_):typeof _=="number"&&to(e,""+_):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Jr.hasOwnProperty(c)?_!=null&&c==="onScroll"&&Tt("scroll",e):_!=null&&Pu(e,c,_,f))}switch(r){case"input":oa(e),cp(e,o,!1);break;case"textarea":oa(e),dp(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Cs(o.value));break;case"select":e.multiple=!!o.multiple,c=o.value,c!=null?Xn(e,!!o.multiple,c,!1):o.defaultValue!=null&&Xn(e,!!o.multiple,o.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=Va)}switch(r){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break t;case"img":o=!0;break t;default:o=!1}}o&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return be(s),null;case 6:if(e&&s.stateNode!=null)M_(e,s,e.memoizedProps,o);else{if(typeof o!="string"&&s.stateNode===null)throw Error(q(166));if(r=Zs(uo.current),Zs(Ni.current),ga(s)){if(o=s.stateNode,r=s.memoizedProps,o[Li]=s,(c=o.nodeValue!==r)&&(e=Je,e!==null))switch(e.tag){case 3:pa(o.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&pa(o.nodeValue,r,(e.mode&1)!==0)}c&&(s.flags|=4)}else o=(r.nodeType===9?r:r.ownerDocument).createTextNode(o),o[Li]=s,s.stateNode=o}return be(s),null;case 13:if(Pt(Mt),o=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Dt&&Ke!==null&&s.mode&1&&!(s.flags&128))Jm(),tr(),s.flags|=98560,c=!1;else if(c=ga(s),o!==null&&o.dehydrated!==null){if(e===null){if(!c)throw Error(q(318));if(c=s.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(q(317));c[Li]=s}else tr(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;be(s),c=!1}else wi!==null&&(cu(wi),wi=null),c=!0;if(!c)return s.flags&65536?s:null}return s.flags&128?(s.lanes=r,s):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(s.child.flags|=8192,s.mode&1&&(e===null||Mt.current&1?ne===0&&(ne=3):cd())),s.updateQueue!==null&&(s.flags|=4),be(s),null);case 4:return ir(),iu(e,s),e===null&&ao(s.stateNode.containerInfo),be(s),null;case 10:return Yu(s.type._context),be(s),null;case 17:return Ve(s.type)&&Ga(),be(s),null;case 19:if(Pt(Mt),c=s.memoizedState,c===null)return be(s),null;if(o=(s.flags&128)!==0,f=c.rendering,f===null)if(o)Lr(c,!1);else{if(ne!==0||e!==null&&e.flags&128)for(e=s.child;e!==null;){if(f=Ka(e),f!==null){for(s.flags|=128,Lr(c,!1),o=f.updateQueue,o!==null&&(s.updateQueue=o,s.flags|=4),s.subtreeFlags=0,o=r,r=s.child;r!==null;)c=r,e=o,c.flags&=14680066,f=c.alternate,f===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=f.childLanes,c.lanes=f.lanes,c.child=f.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=f.memoizedProps,c.memoizedState=f.memoizedState,c.updateQueue=f.updateQueue,c.type=f.type,e=f.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return At(Mt,Mt.current&1|2),s.child}e=e.sibling}c.tail!==null&&Xt()>nr&&(s.flags|=128,o=!0,Lr(c,!1),s.lanes=4194304)}else{if(!o)if(e=Ka(f),e!==null){if(s.flags|=128,o=!0,r=e.updateQueue,r!==null&&(s.updateQueue=r,s.flags|=4),Lr(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!Dt)return be(s),null}else 2*Xt()-c.renderingStartTime>nr&&r!==1073741824&&(s.flags|=128,o=!0,Lr(c,!1),s.lanes=4194304);c.isBackwards?(f.sibling=s.child,s.child=f):(r=c.last,r!==null?r.sibling=f:s.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Xt(),s.sibling=null,r=Mt.current,At(Mt,o?r&1|2:r&1),s):(be(s),null);case 22:case 23:return hd(),o=s.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(s.flags|=8192),o&&s.mode&1?Ze&1073741824&&(be(s),s.subtreeFlags&6&&(s.flags|=8192)):be(s),null;case 24:return null;case 25:return null}throw Error(q(156,s.tag))}function Lx(e,s){switch(ju(s),s.tag){case 1:return Ve(s.type)&&Ga(),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return ir(),Pt(je),Pt(Se),Ku(),e=s.flags,e&65536&&!(e&128)?(s.flags=e&-65537|128,s):null;case 5:return Zu(s),null;case 13:if(Pt(Mt),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(q(340));tr()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return Pt(Mt),null;case 4:return ir(),null;case 10:return Yu(s.type._context),null;case 22:case 23:return hd(),null;case 24:return null;default:return null}}var va=!1,Ce=!1,Ox=typeof WeakSet=="function"?WeakSet:Set,nt=null;function Vn(e,s){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(o){Vt(e,s,o)}else r.current=null}function su(e,s,r){try{r()}catch(o){Vt(e,s,o)}}var eg=!1;function Nx(e,s){if(zc=Ha,e=zm(),Hu(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else t:{r=(r=e.ownerDocument)&&r.defaultView||window;var o=r.getSelection&&r.getSelection();if(o&&o.rangeCount!==0){r=o.anchorNode;var l=o.anchorOffset,c=o.focusNode;o=o.focusOffset;try{r.nodeType,c.nodeType}catch{r=null;break t}var f=0,g=-1,_=-1,v=0,x=0,S=e,A=null;e:for(;;){for(var I;S!==r||l!==0&&S.nodeType!==3||(g=f+l),S!==c||o!==0&&S.nodeType!==3||(_=f+o),S.nodeType===3&&(f+=S.nodeValue.length),(I=S.firstChild)!==null;)A=S,S=I;for(;;){if(S===e)break e;if(A===r&&++v===l&&(g=f),A===c&&++x===o&&(_=f),(I=S.nextSibling)!==null)break;S=A,A=S.parentNode}S=I}r=g===-1||_===-1?null:{start:g,end:_}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hc={focusedElem:e,selectionRange:r},Ha=!1,nt=s;nt!==null;)if(s=nt,e=s.child,(s.subtreeFlags&1028)!==0&&e!==null)e.return=s,nt=e;else for(;nt!==null;){s=nt;try{var F=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(F!==null){var L=F.memoizedProps,O=F.memoizedState,T=s.stateNode,P=T.getSnapshotBeforeUpdate(s.elementType===s.type?L:vi(s.type,L),O);T.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var D=s.stateNode.containerInfo;D.nodeType===1?D.textContent="":D.nodeType===9&&D.documentElement&&D.removeChild(D.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(W){Vt(s,s.return,W)}if(e=s.sibling,e!==null){e.return=s.return,nt=e;break}nt=s.return}return F=eg,eg=!1,F}function qr(e,s,r){var o=s.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&e)===e){var c=l.destroy;l.destroy=void 0,c!==void 0&&su(s,r,c)}l=l.next}while(l!==o)}}function vl(e,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&e)===e){var o=r.create;r.destroy=o()}r=r.next}while(r!==s)}}function nu(e){var s=e.ref;if(s!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof s=="function"?s(e):s.current=e}}function L_(e){var s=e.alternate;s!==null&&(e.alternate=null,L_(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&(delete s[Li],delete s[ho],delete s[Vc],delete s[wx],delete s[xx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function O_(e){return e.tag===5||e.tag===3||e.tag===4}function ig(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||O_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ru(e,s,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,s?r.nodeType===8?r.parentNode.insertBefore(e,s):r.insertBefore(e,s):(r.nodeType===8?(s=r.parentNode,s.insertBefore(e,r)):(s=r,s.appendChild(e)),r=r._reactRootContainer,r!=null||s.onclick!==null||(s.onclick=Va));else if(o!==4&&(e=e.child,e!==null))for(ru(e,s,r),e=e.sibling;e!==null;)ru(e,s,r),e=e.sibling}function ou(e,s,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,s?r.insertBefore(e,s):r.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(ou(e,s,r),e=e.sibling;e!==null;)ou(e,s,r),e=e.sibling}var _e=null,yi=!1;function os(e,s,r){for(r=r.child;r!==null;)N_(e,s,r),r=r.sibling}function N_(e,s,r){if(Oi&&typeof Oi.onCommitFiberUnmount=="function")try{Oi.onCommitFiberUnmount(cl,r)}catch{}switch(r.tag){case 5:Ce||Vn(r,s);case 6:var o=_e,l=yi;_e=null,os(e,s,r),_e=o,yi=l,_e!==null&&(yi?(e=_e,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):_e.removeChild(r.stateNode));break;case 18:_e!==null&&(yi?(e=_e,r=r.stateNode,e.nodeType===8?Jh(e.parentNode,r):e.nodeType===1&&Jh(e,r),no(e)):Jh(_e,r.stateNode));break;case 4:o=_e,l=yi,_e=r.stateNode.containerInfo,yi=!0,os(e,s,r),_e=o,yi=l;break;case 0:case 11:case 14:case 15:if(!Ce&&(o=r.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){l=o=o.next;do{var c=l,f=c.destroy;c=c.tag,f!==void 0&&(c&2||c&4)&&su(r,s,f),l=l.next}while(l!==o)}os(e,s,r);break;case 1:if(!Ce&&(Vn(r,s),o=r.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=r.memoizedProps,o.state=r.memoizedState,o.componentWillUnmount()}catch(g){Vt(r,s,g)}os(e,s,r);break;case 21:os(e,s,r);break;case 22:r.mode&1?(Ce=(o=Ce)||r.memoizedState!==null,os(e,s,r),Ce=o):os(e,s,r);break;default:os(e,s,r)}}function sg(e){var s=e.updateQueue;if(s!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Ox),s.forEach(function(o){var l=Yx.bind(null,e,o);r.has(o)||(r.add(o),o.then(l,l))})}}function _i(e,s){var r=s.deletions;if(r!==null)for(var o=0;o<r.length;o++){var l=r[o];try{var c=e,f=s,g=f;t:for(;g!==null;){switch(g.tag){case 5:_e=g.stateNode,yi=!1;break t;case 3:_e=g.stateNode.containerInfo,yi=!0;break t;case 4:_e=g.stateNode.containerInfo,yi=!0;break t}g=g.return}if(_e===null)throw Error(q(160));N_(c,f,l),_e=null,yi=!1;var _=l.alternate;_!==null&&(_.return=null),l.return=null}catch(v){Vt(l,s,v)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)U_(s,e),s=s.sibling}function U_(e,s){var r=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_i(s,e),Bi(e),o&4){try{qr(3,e,e.return),vl(3,e)}catch(L){Vt(e,e.return,L)}try{qr(5,e,e.return)}catch(L){Vt(e,e.return,L)}}break;case 1:_i(s,e),Bi(e),o&512&&r!==null&&Vn(r,r.return);break;case 5:if(_i(s,e),Bi(e),o&512&&r!==null&&Vn(r,r.return),e.flags&32){var l=e.stateNode;try{to(l,"")}catch(L){Vt(e,e.return,L)}}if(o&4&&(l=e.stateNode,l!=null)){var c=e.memoizedProps,f=r!==null?r.memoizedProps:c,g=e.type,_=e.updateQueue;if(e.updateQueue=null,_!==null)try{g==="input"&&c.type==="radio"&&c.name!=null&&am(l,c),Ic(g,f);var v=Ic(g,c);for(f=0;f<_.length;f+=2){var x=_[f],S=_[f+1];x==="style"?dm(l,S):x==="dangerouslySetInnerHTML"?cm(l,S):x==="children"?to(l,S):Pu(l,x,S,v)}switch(g){case"input":Ec(l,c);break;case"textarea":lm(l,c);break;case"select":var A=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!c.multiple;var I=c.value;I!=null?Xn(l,!!c.multiple,I,!1):A!==!!c.multiple&&(c.defaultValue!=null?Xn(l,!!c.multiple,c.defaultValue,!0):Xn(l,!!c.multiple,c.multiple?[]:"",!1))}l[ho]=c}catch(L){Vt(e,e.return,L)}}break;case 6:if(_i(s,e),Bi(e),o&4){if(e.stateNode===null)throw Error(q(162));l=e.stateNode,c=e.memoizedProps;try{l.nodeValue=c}catch(L){Vt(e,e.return,L)}}break;case 3:if(_i(s,e),Bi(e),o&4&&r!==null&&r.memoizedState.isDehydrated)try{no(s.containerInfo)}catch(L){Vt(e,e.return,L)}break;case 4:_i(s,e),Bi(e);break;case 13:_i(s,e),Bi(e),l=e.child,l.flags&8192&&(c=l.memoizedState!==null,l.stateNode.isHidden=c,!c||l.alternate!==null&&l.alternate.memoizedState!==null||(ad=Xt())),o&4&&sg(e);break;case 22:if(x=r!==null&&r.memoizedState!==null,e.mode&1?(Ce=(v=Ce)||x,_i(s,e),Ce=v):_i(s,e),Bi(e),o&8192){if(v=e.memoizedState!==null,(e.stateNode.isHidden=v)&&!x&&e.mode&1)for(nt=e,x=e.child;x!==null;){for(S=nt=x;nt!==null;){switch(A=nt,I=A.child,A.tag){case 0:case 11:case 14:case 15:qr(4,A,A.return);break;case 1:Vn(A,A.return);var F=A.stateNode;if(typeof F.componentWillUnmount=="function"){o=A,r=A.return;try{s=o,F.props=s.memoizedProps,F.state=s.memoizedState,F.componentWillUnmount()}catch(L){Vt(o,r,L)}}break;case 5:Vn(A,A.return);break;case 22:if(A.memoizedState!==null){rg(S);continue}}I!==null?(I.return=A,nt=I):rg(S)}x=x.sibling}t:for(x=null,S=e;;){if(S.tag===5){if(x===null){x=S;try{l=S.stateNode,v?(c=l.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(g=S.stateNode,_=S.memoizedProps.style,f=_!=null&&_.hasOwnProperty("display")?_.display:null,g.style.display=um("display",f))}catch(L){Vt(e,e.return,L)}}}else if(S.tag===6){if(x===null)try{S.stateNode.nodeValue=v?"":S.memoizedProps}catch(L){Vt(e,e.return,L)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===e)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===e)break t;for(;S.sibling===null;){if(S.return===null||S.return===e)break t;x===S&&(x=null),S=S.return}x===S&&(x=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:_i(s,e),Bi(e),o&4&&sg(e);break;case 21:break;default:_i(s,e),Bi(e)}}function Bi(e){var s=e.flags;if(s&2){try{t:{for(var r=e.return;r!==null;){if(O_(r)){var o=r;break t}r=r.return}throw Error(q(160))}switch(o.tag){case 5:var l=o.stateNode;o.flags&32&&(to(l,""),o.flags&=-33);var c=ig(e);ou(e,c,l);break;case 3:case 4:var f=o.stateNode.containerInfo,g=ig(e);ru(e,g,f);break;default:throw Error(q(161))}}catch(_){Vt(e,e.return,_)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function Ux(e,s,r){nt=e,z_(e)}function z_(e,s,r){for(var o=(e.mode&1)!==0;nt!==null;){var l=nt,c=l.child;if(l.tag===22&&o){var f=l.memoizedState!==null||va;if(!f){var g=l.alternate,_=g!==null&&g.memoizedState!==null||Ce;g=va;var v=Ce;if(va=f,(Ce=_)&&!v)for(nt=l;nt!==null;)f=nt,_=f.child,f.tag===22&&f.memoizedState!==null?og(l):_!==null?(_.return=f,nt=_):og(l);for(;c!==null;)nt=c,z_(c),c=c.sibling;nt=l,va=g,Ce=v}ng(e)}else l.subtreeFlags&8772&&c!==null?(c.return=l,nt=c):ng(e)}}function ng(e){for(;nt!==null;){var s=nt;if(s.flags&8772){var r=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:Ce||vl(5,s);break;case 1:var o=s.stateNode;if(s.flags&4&&!Ce)if(r===null)o.componentDidMount();else{var l=s.elementType===s.type?r.memoizedProps:vi(s.type,r.memoizedProps);o.componentDidUpdate(l,r.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var c=s.updateQueue;c!==null&&Wp(s,c,o);break;case 3:var f=s.updateQueue;if(f!==null){if(r=null,s.child!==null)switch(s.child.tag){case 5:r=s.child.stateNode;break;case 1:r=s.child.stateNode}Wp(s,f,r)}break;case 5:var g=s.stateNode;if(r===null&&s.flags&4){r=g;var _=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&r.focus();break;case"img":_.src&&(r.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var v=s.alternate;if(v!==null){var x=v.memoizedState;if(x!==null){var S=x.dehydrated;S!==null&&no(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}Ce||s.flags&512&&nu(s)}catch(A){Vt(s,s.return,A)}}if(s===e){nt=null;break}if(r=s.sibling,r!==null){r.return=s.return,nt=r;break}nt=s.return}}function rg(e){for(;nt!==null;){var s=nt;if(s===e){nt=null;break}var r=s.sibling;if(r!==null){r.return=s.return,nt=r;break}nt=s.return}}function og(e){for(;nt!==null;){var s=nt;try{switch(s.tag){case 0:case 11:case 15:var r=s.return;try{vl(4,s)}catch(_){Vt(s,r,_)}break;case 1:var o=s.stateNode;if(typeof o.componentDidMount=="function"){var l=s.return;try{o.componentDidMount()}catch(_){Vt(s,l,_)}}var c=s.return;try{nu(s)}catch(_){Vt(s,c,_)}break;case 5:var f=s.return;try{nu(s)}catch(_){Vt(s,f,_)}}}catch(_){Vt(s,s.return,_)}if(s===e){nt=null;break}var g=s.sibling;if(g!==null){g.return=s.return,nt=g;break}nt=s.return}}var zx=Math.ceil,el=ts.ReactCurrentDispatcher,rd=ts.ReactCurrentOwner,ci=ts.ReactCurrentBatchConfig,xt=0,ce=null,Qt=null,ve=0,Ze=0,Gn=As(0),ne=0,mo=null,an=0,yl=0,od=0,Zr=null,He=null,ad=0,nr=1/0,Gi=null,il=!1,au=null,ws=null,ya=!1,fs=null,sl=0,Kr=0,lu=null,Ia=-1,Da=0;function De(){return xt&6?Xt():Ia!==-1?Ia:Ia=Xt()}function xs(e){return e.mode&1?xt&2&&ve!==0?ve&-ve:Cx.transition!==null?(Da===0&&(Da=Sm()),Da):(e=St,e!==0||(e=window.event,e=e===void 0?16:Dm(e.type)),e):1}function bi(e,s,r,o){if(50<Kr)throw Kr=0,lu=null,Error(q(185));xo(e,r,o),(!(xt&2)||e!==ce)&&(e===ce&&(!(xt&2)&&(yl|=r),ne===4&&us(e,ve)),Ge(e,o),r===1&&xt===0&&!(s.mode&1)&&(nr=Xt()+500,gl&&Ts()))}function Ge(e,s){var r=e.callbackNode;Cw(e,s);var o=za(e,e===ce?ve:0);if(o===0)r!==null&&gp(r),e.callbackNode=null,e.callbackPriority=0;else if(s=o&-o,e.callbackPriority!==s){if(r!=null&&gp(r),s===1)e.tag===0?bx(ag.bind(null,e)):qm(ag.bind(null,e)),vx(function(){!(xt&6)&&Ts()}),r=null;else{switch(Em(o)){case 1:r=Fu;break;case 4:r=bm;break;case 16:r=Ua;break;case 536870912:r=Cm;break;default:r=Ua}r=$_(r,H_.bind(null,e))}e.callbackPriority=s,e.callbackNode=r}}function H_(e,s){if(Ia=-1,Da=0,xt&6)throw Error(q(327));var r=e.callbackNode;if(Zn()&&e.callbackNode!==r)return null;var o=za(e,e===ce?ve:0);if(o===0)return null;if(o&30||o&e.expiredLanes||s)s=nl(e,o);else{s=o;var l=xt;xt|=2;var c=j_();(ce!==e||ve!==s)&&(Gi=null,nr=Xt()+500,Js(e,s));do try{jx();break}catch(g){W_(e,g)}while(!0);Xu(),el.current=c,xt=l,Qt!==null?s=0:(ce=null,ve=0,s=ne)}if(s!==0){if(s===2&&(l=Mc(e),l!==0&&(o=l,s=hu(e,l))),s===1)throw r=mo,Js(e,0),us(e,o),Ge(e,Xt()),r;if(s===6)us(e,o);else{if(l=e.current.alternate,!(o&30)&&!Hx(l)&&(s=nl(e,o),s===2&&(c=Mc(e),c!==0&&(o=c,s=hu(e,c))),s===1))throw r=mo,Js(e,0),us(e,o),Ge(e,Xt()),r;switch(e.finishedWork=l,e.finishedLanes=o,s){case 0:case 1:throw Error(q(345));case 2:$s(e,He,Gi);break;case 3:if(us(e,o),(o&130023424)===o&&(s=ad+500-Xt(),10<s)){if(za(e,0)!==0)break;if(l=e.suspendedLanes,(l&o)!==o){De(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=jc($s.bind(null,e,He,Gi),s);break}$s(e,He,Gi);break;case 4:if(us(e,o),(o&4194240)===o)break;for(s=e.eventTimes,l=-1;0<o;){var f=31-xi(o);c=1<<f,f=s[f],f>l&&(l=f),o&=~c}if(o=l,o=Xt()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*zx(o/1960))-o,10<o){e.timeoutHandle=jc($s.bind(null,e,He,Gi),o);break}$s(e,He,Gi);break;case 5:$s(e,He,Gi);break;default:throw Error(q(329))}}}return Ge(e,Xt()),e.callbackNode===r?H_.bind(null,e):null}function hu(e,s){var r=Zr;return e.current.memoizedState.isDehydrated&&(Js(e,s).flags|=256),e=nl(e,s),e!==2&&(s=He,He=r,s!==null&&cu(s)),e}function cu(e){He===null?He=e:He.push.apply(He,e)}function Hx(e){for(var s=e;;){if(s.flags&16384){var r=s.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var o=0;o<r.length;o++){var l=r[o],c=l.getSnapshot;l=l.value;try{if(!Ci(c(),l))return!1}catch{return!1}}}if(r=s.child,s.subtreeFlags&16384&&r!==null)r.return=s,s=r;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function us(e,s){for(s&=~od,s&=~yl,e.suspendedLanes|=s,e.pingedLanes&=~s,e=e.expirationTimes;0<s;){var r=31-xi(s),o=1<<r;e[r]=-1,s&=~o}}function ag(e){if(xt&6)throw Error(q(327));Zn();var s=za(e,0);if(!(s&1))return Ge(e,Xt()),null;var r=nl(e,s);if(e.tag!==0&&r===2){var o=Mc(e);o!==0&&(s=o,r=hu(e,o))}if(r===1)throw r=mo,Js(e,0),us(e,s),Ge(e,Xt()),r;if(r===6)throw Error(q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=s,$s(e,He,Gi),Ge(e,Xt()),null}function ld(e,s){var r=xt;xt|=1;try{return e(s)}finally{xt=r,xt===0&&(nr=Xt()+500,gl&&Ts())}}function ln(e){fs!==null&&fs.tag===0&&!(xt&6)&&Zn();var s=xt;xt|=1;var r=ci.transition,o=St;try{if(ci.transition=null,St=1,e)return e()}finally{St=o,ci.transition=r,xt=s,!(xt&6)&&Ts()}}function hd(){Ze=Gn.current,Pt(Gn)}function Js(e,s){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,_x(r)),Qt!==null)for(r=Qt.return;r!==null;){var o=r;switch(ju(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&Ga();break;case 3:ir(),Pt(je),Pt(Se),Ku();break;case 5:Zu(o);break;case 4:ir();break;case 13:Pt(Mt);break;case 19:Pt(Mt);break;case 10:Yu(o.type._context);break;case 22:case 23:hd()}r=r.return}if(ce=e,Qt=e=bs(e.current,null),ve=Ze=s,ne=0,mo=null,od=yl=an=0,He=Zr=null,qs!==null){for(s=0;s<qs.length;s++)if(r=qs[s],o=r.interleaved,o!==null){r.interleaved=null;var l=o.next,c=r.pending;if(c!==null){var f=c.next;c.next=l,o.next=f}r.pending=o}qs=null}return e}function W_(e,s){do{var r=Qt;try{if(Xu(),Ta.current=tl,Ja){for(var o=Lt.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}Ja=!1}if(on=0,he=se=Lt=null,Qr=!1,fo=0,rd.current=null,r===null||r.return===null){ne=1,mo=s,Qt=null;break}t:{var c=e,f=r.return,g=r,_=s;if(s=ve,g.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var v=_,x=g,S=x.tag;if(!(x.mode&1)&&(S===0||S===11||S===15)){var A=x.alternate;A?(x.updateQueue=A.updateQueue,x.memoizedState=A.memoizedState,x.lanes=A.lanes):(x.updateQueue=null,x.memoizedState=null)}var I=$p(f);if(I!==null){I.flags&=-257,Qp(I,f,g,c,s),I.mode&1&&Yp(c,v,s),s=I,_=v;var F=s.updateQueue;if(F===null){var L=new Set;L.add(_),s.updateQueue=L}else F.add(_);break t}else{if(!(s&1)){Yp(c,v,s),cd();break t}_=Error(q(426))}}else if(Dt&&g.mode&1){var O=$p(f);if(O!==null){!(O.flags&65536)&&(O.flags|=256),Qp(O,f,g,c,s),Vu(sr(_,g));break t}}c=_=sr(_,g),ne!==4&&(ne=2),Zr===null?Zr=[c]:Zr.push(c),c=f;do{switch(c.tag){case 3:c.flags|=65536,s&=-s,c.lanes|=s;var T=E_(c,_,s);Hp(c,T);break t;case 1:g=_;var P=c.type,D=c.stateNode;if(!(c.flags&128)&&(typeof P.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(ws===null||!ws.has(D)))){c.flags|=65536,s&=-s,c.lanes|=s;var W=A_(c,g,s);Hp(c,W);break t}}c=c.return}while(c!==null)}G_(r)}catch(j){s=j,Qt===r&&r!==null&&(Qt=r=r.return);continue}break}while(!0)}function j_(){var e=el.current;return el.current=tl,e===null?tl:e}function cd(){(ne===0||ne===3||ne===2)&&(ne=4),ce===null||!(an&268435455)&&!(yl&268435455)||us(ce,ve)}function nl(e,s){var r=xt;xt|=2;var o=j_();(ce!==e||ve!==s)&&(Gi=null,Js(e,s));do try{Wx();break}catch(l){W_(e,l)}while(!0);if(Xu(),xt=r,el.current=o,Qt!==null)throw Error(q(261));return ce=null,ve=0,ne}function Wx(){for(;Qt!==null;)V_(Qt)}function jx(){for(;Qt!==null&&!pw();)V_(Qt)}function V_(e){var s=Y_(e.alternate,e,Ze);e.memoizedProps=e.pendingProps,s===null?G_(e):Qt=s,rd.current=null}function G_(e){var s=e;do{var r=s.alternate;if(e=s.return,s.flags&32768){if(r=Lx(r,s),r!==null){r.flags&=32767,Qt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ne=6,Qt=null;return}}else if(r=Mx(r,s,Ze),r!==null){Qt=r;return}if(s=s.sibling,s!==null){Qt=s;return}Qt=s=e}while(s!==null);ne===0&&(ne=5)}function $s(e,s,r){var o=St,l=ci.transition;try{ci.transition=null,St=1,Vx(e,s,r,o)}finally{ci.transition=l,St=o}return null}function Vx(e,s,r,o){do Zn();while(fs!==null);if(xt&6)throw Error(q(327));r=e.finishedWork;var l=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(q(177));e.callbackNode=null,e.callbackPriority=0;var c=r.lanes|r.childLanes;if(Sw(e,c),e===ce&&(Qt=ce=null,ve=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ya||(ya=!0,$_(Ua,function(){return Zn(),null})),c=(r.flags&15990)!==0,r.subtreeFlags&15990||c){c=ci.transition,ci.transition=null;var f=St;St=1;var g=xt;xt|=4,rd.current=null,Nx(e,r),U_(r,e),cx(Hc),Ha=!!zc,Hc=zc=null,e.current=r,Ux(r),gw(),xt=g,St=f,ci.transition=c}else e.current=r;if(ya&&(ya=!1,fs=e,sl=l),c=e.pendingLanes,c===0&&(ws=null),vw(r.stateNode),Ge(e,Xt()),s!==null)for(o=e.onRecoverableError,r=0;r<s.length;r++)l=s[r],o(l.value,{componentStack:l.stack,digest:l.digest});if(il)throw il=!1,e=au,au=null,e;return sl&1&&e.tag!==0&&Zn(),c=e.pendingLanes,c&1?e===lu?Kr++:(Kr=0,lu=e):Kr=0,Ts(),null}function Zn(){if(fs!==null){var e=Em(sl),s=ci.transition,r=St;try{if(ci.transition=null,St=16>e?16:e,fs===null)var o=!1;else{if(e=fs,fs=null,sl=0,xt&6)throw Error(q(331));var l=xt;for(xt|=4,nt=e.current;nt!==null;){var c=nt,f=c.child;if(nt.flags&16){var g=c.deletions;if(g!==null){for(var _=0;_<g.length;_++){var v=g[_];for(nt=v;nt!==null;){var x=nt;switch(x.tag){case 0:case 11:case 15:qr(8,x,c)}var S=x.child;if(S!==null)S.return=x,nt=S;else for(;nt!==null;){x=nt;var A=x.sibling,I=x.return;if(L_(x),x===v){nt=null;break}if(A!==null){A.return=I,nt=A;break}nt=I}}}var F=c.alternate;if(F!==null){var L=F.child;if(L!==null){F.child=null;do{var O=L.sibling;L.sibling=null,L=O}while(L!==null)}}nt=c}}if(c.subtreeFlags&2064&&f!==null)f.return=c,nt=f;else t:for(;nt!==null;){if(c=nt,c.flags&2048)switch(c.tag){case 0:case 11:case 15:qr(9,c,c.return)}var T=c.sibling;if(T!==null){T.return=c.return,nt=T;break t}nt=c.return}}var P=e.current;for(nt=P;nt!==null;){f=nt;var D=f.child;if(f.subtreeFlags&2064&&D!==null)D.return=f,nt=D;else t:for(f=P;nt!==null;){if(g=nt,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:vl(9,g)}}catch(j){Vt(g,g.return,j)}if(g===f){nt=null;break t}var W=g.sibling;if(W!==null){W.return=g.return,nt=W;break t}nt=g.return}}if(xt=l,Ts(),Oi&&typeof Oi.onPostCommitFiberRoot=="function")try{Oi.onPostCommitFiberRoot(cl,e)}catch{}o=!0}return o}finally{St=r,ci.transition=s}}return!1}function lg(e,s,r){s=sr(r,s),s=E_(e,s,1),e=ys(e,s,1),s=De(),e!==null&&(xo(e,1,s),Ge(e,s))}function Vt(e,s,r){if(e.tag===3)lg(e,e,r);else for(;s!==null;){if(s.tag===3){lg(s,e,r);break}else if(s.tag===1){var o=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(ws===null||!ws.has(o))){e=sr(r,e),e=A_(s,e,1),s=ys(s,e,1),e=De(),s!==null&&(xo(s,1,e),Ge(s,e));break}}s=s.return}}function Gx(e,s,r){var o=e.pingCache;o!==null&&o.delete(s),s=De(),e.pingedLanes|=e.suspendedLanes&r,ce===e&&(ve&r)===r&&(ne===4||ne===3&&(ve&130023424)===ve&&500>Xt()-ad?Js(e,0):od|=r),Ge(e,s)}function X_(e,s){s===0&&(e.mode&1?(s=ha,ha<<=1,!(ha&130023424)&&(ha=4194304)):s=1);var r=De();e=Ki(e,s),e!==null&&(xo(e,s,r),Ge(e,r))}function Xx(e){var s=e.memoizedState,r=0;s!==null&&(r=s.retryLane),X_(e,r)}function Yx(e,s){var r=0;switch(e.tag){case 13:var o=e.stateNode,l=e.memoizedState;l!==null&&(r=l.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(q(314))}o!==null&&o.delete(s),X_(e,r)}var Y_;Y_=function(e,s,r){if(e!==null)if(e.memoizedProps!==s.pendingProps||je.current)We=!0;else{if(!(e.lanes&r)&&!(s.flags&128))return We=!1,Bx(e,s,r);We=!!(e.flags&131072)}else We=!1,Dt&&s.flags&1048576&&Zm(s,$a,s.index);switch(s.lanes=0,s.tag){case 2:var o=s.type;Ra(e,s),e=s.pendingProps;var l=Jn(s,Se.current);qn(s,r),l=td(null,s,o,e,l,r);var c=ed();return s.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Ve(o)?(c=!0,Xa(s)):c=!1,s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Qu(s),l.updater=_l,s.stateNode=l,l._reactInternals=s,qc(s,o,e,r),s=Jc(null,s,o,!0,c,r)):(s.tag=0,Dt&&c&&Wu(s),Ie(null,s,l,r),s=s.child),s;case 16:o=s.elementType;t:{switch(Ra(e,s),e=s.pendingProps,l=o._init,o=l(o._payload),s.type=o,l=s.tag=Qx(o),e=vi(o,e),l){case 0:s=Kc(null,s,o,e,r);break t;case 1:s=Kp(null,s,o,e,r);break t;case 11:s=qp(null,s,o,e,r);break t;case 14:s=Zp(null,s,o,vi(o.type,e),r);break t}throw Error(q(306,o,""))}return s;case 0:return o=s.type,l=s.pendingProps,l=s.elementType===o?l:vi(o,l),Kc(e,s,o,l,r);case 1:return o=s.type,l=s.pendingProps,l=s.elementType===o?l:vi(o,l),Kp(e,s,o,l,r);case 3:t:{if(I_(s),e===null)throw Error(q(387));o=s.pendingProps,c=s.memoizedState,l=c.element,s_(e,s),Za(s,o,null,r);var f=s.memoizedState;if(o=f.element,c.isDehydrated)if(c={element:o,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},s.updateQueue.baseState=c,s.memoizedState=c,s.flags&256){l=sr(Error(q(423)),s),s=Jp(e,s,o,r,l);break t}else if(o!==l){l=sr(Error(q(424)),s),s=Jp(e,s,o,r,l);break t}else for(Ke=vs(s.stateNode.containerInfo.firstChild),Je=s,Dt=!0,wi=null,r=e_(s,null,o,r),s.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(tr(),o===l){s=Ji(e,s,r);break t}Ie(e,s,o,r)}s=s.child}return s;case 5:return n_(s),e===null&&Yc(s),o=s.type,l=s.pendingProps,c=e!==null?e.memoizedProps:null,f=l.children,Wc(o,l)?f=null:c!==null&&Wc(o,c)&&(s.flags|=32),R_(e,s),Ie(e,s,f,r),s.child;case 6:return e===null&&Yc(s),null;case 13:return D_(e,s,r);case 4:return qu(s,s.stateNode.containerInfo),o=s.pendingProps,e===null?s.child=er(s,null,o,r):Ie(e,s,o,r),s.child;case 11:return o=s.type,l=s.pendingProps,l=s.elementType===o?l:vi(o,l),qp(e,s,o,l,r);case 7:return Ie(e,s,s.pendingProps,r),s.child;case 8:return Ie(e,s,s.pendingProps.children,r),s.child;case 12:return Ie(e,s,s.pendingProps.children,r),s.child;case 10:t:{if(o=s.type._context,l=s.pendingProps,c=s.memoizedProps,f=l.value,At(Qa,o._currentValue),o._currentValue=f,c!==null)if(Ci(c.value,f)){if(c.children===l.children&&!je.current){s=Ji(e,s,r);break t}}else for(c=s.child,c!==null&&(c.return=s);c!==null;){var g=c.dependencies;if(g!==null){f=c.child;for(var _=g.firstContext;_!==null;){if(_.context===o){if(c.tag===1){_=Qi(-1,r&-r),_.tag=2;var v=c.updateQueue;if(v!==null){v=v.shared;var x=v.pending;x===null?_.next=_:(_.next=x.next,x.next=_),v.pending=_}}c.lanes|=r,_=c.alternate,_!==null&&(_.lanes|=r),$c(c.return,r,s),g.lanes|=r;break}_=_.next}}else if(c.tag===10)f=c.type===s.type?null:c.child;else if(c.tag===18){if(f=c.return,f===null)throw Error(q(341));f.lanes|=r,g=f.alternate,g!==null&&(g.lanes|=r),$c(f,r,s),f=c.sibling}else f=c.child;if(f!==null)f.return=c;else for(f=c;f!==null;){if(f===s){f=null;break}if(c=f.sibling,c!==null){c.return=f.return,f=c;break}f=f.return}c=f}Ie(e,s,l.children,r),s=s.child}return s;case 9:return l=s.type,o=s.pendingProps.children,qn(s,r),l=ui(l),o=o(l),s.flags|=1,Ie(e,s,o,r),s.child;case 14:return o=s.type,l=vi(o,s.pendingProps),l=vi(o.type,l),Zp(e,s,o,l,r);case 15:return T_(e,s,s.type,s.pendingProps,r);case 17:return o=s.type,l=s.pendingProps,l=s.elementType===o?l:vi(o,l),Ra(e,s),s.tag=1,Ve(o)?(e=!0,Xa(s)):e=!1,qn(s,r),S_(s,o,l),qc(s,o,l,r),Jc(null,s,o,!0,e,r);case 19:return k_(e,s,r);case 22:return P_(e,s,r)}throw Error(q(156,s.tag))};function $_(e,s){return xm(e,s)}function $x(e,s,r,o){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hi(e,s,r,o){return new $x(e,s,r,o)}function ud(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Qx(e){if(typeof e=="function")return ud(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Iu)return 11;if(e===Du)return 14}return 2}function bs(e,s){var r=e.alternate;return r===null?(r=hi(e.tag,s,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=s,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,s=e.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ka(e,s,r,o,l,c){var f=2;if(o=e,typeof e=="function")ud(e)&&(f=1);else if(typeof e=="string")f=5;else t:switch(e){case Mn:return tn(r.children,l,c,s);case Ru:f=8,l|=8;break;case wc:return e=hi(12,r,s,l|2),e.elementType=wc,e.lanes=c,e;case xc:return e=hi(13,r,s,l),e.elementType=xc,e.lanes=c,e;case bc:return e=hi(19,r,s,l),e.elementType=bc,e.lanes=c,e;case nm:return wl(r,l,c,s);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case im:f=10;break t;case sm:f=9;break t;case Iu:f=11;break t;case Du:f=14;break t;case ls:f=16,o=null;break t}throw Error(q(130,e==null?e:typeof e,""))}return s=hi(f,r,s,l),s.elementType=e,s.type=o,s.lanes=c,s}function tn(e,s,r,o){return e=hi(7,e,o,s),e.lanes=r,e}function wl(e,s,r,o){return e=hi(22,e,o,s),e.elementType=nm,e.lanes=r,e.stateNode={isHidden:!1},e}function ac(e,s,r){return e=hi(6,e,null,s),e.lanes=r,e}function lc(e,s,r){return s=hi(4,e.children!==null?e.children:[],e.key,s),s.lanes=r,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}function qx(e,s,r,o,l){this.tag=s,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wh(0),this.expirationTimes=Wh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wh(0),this.identifierPrefix=o,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function dd(e,s,r,o,l,c,f,g,_){return e=new qx(e,s,r,g,_),s===1?(s=1,c===!0&&(s|=8)):s=0,c=hi(3,null,null,s),e.current=c,c.stateNode=e,c.memoizedState={element:o,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qu(c),e}function Zx(e,s,r){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bn,key:o==null?null:""+o,children:e,containerInfo:s,implementation:r}}function Q_(e){if(!e)return Ss;e=e._reactInternals;t:{if(un(e)!==e||e.tag!==1)throw Error(q(170));var s=e;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(Ve(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(s!==null);throw Error(q(171))}if(e.tag===1){var r=e.type;if(Ve(r))return Qm(e,r,s)}return s}function q_(e,s,r,o,l,c,f,g,_){return e=dd(r,o,!0,e,l,c,f,g,_),e.context=Q_(null),r=e.current,o=De(),l=xs(r),c=Qi(o,l),c.callback=s??null,ys(r,c,l),e.current.lanes=l,xo(e,l,o),Ge(e,o),e}function xl(e,s,r,o){var l=s.current,c=De(),f=xs(l);return r=Q_(r),s.context===null?s.context=r:s.pendingContext=r,s=Qi(c,f),s.payload={element:e},o=o===void 0?null:o,o!==null&&(s.callback=o),e=ys(l,s,f),e!==null&&(bi(e,l,f,c),Aa(e,l,f)),f}function rl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hg(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<s?r:s}}function fd(e,s){hg(e,s),(e=e.alternate)&&hg(e,s)}function Kx(){return null}var Z_=typeof reportError=="function"?reportError:function(e){console.error(e)};function pd(e){this._internalRoot=e}bl.prototype.render=pd.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(q(409));xl(e,s,null,null)};bl.prototype.unmount=pd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;ln(function(){xl(null,e,null,null)}),s[Zi]=null}};function bl(e){this._internalRoot=e}bl.prototype.unstable_scheduleHydration=function(e){if(e){var s=Pm();e={blockedOn:null,target:e,priority:s};for(var r=0;r<cs.length&&s!==0&&s<cs[r].priority;r++);cs.splice(r,0,e),r===0&&Im(e)}};function gd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Cl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function cg(){}function Jx(e,s,r,o,l){if(l){if(typeof o=="function"){var c=o;o=function(){var v=rl(f);c.call(v)}}var f=q_(s,o,e,0,null,!1,!1,"",cg);return e._reactRootContainer=f,e[Zi]=f.current,ao(e.nodeType===8?e.parentNode:e),ln(),f}for(;l=e.lastChild;)e.removeChild(l);if(typeof o=="function"){var g=o;o=function(){var v=rl(_);g.call(v)}}var _=dd(e,0,!1,null,null,!1,!1,"",cg);return e._reactRootContainer=_,e[Zi]=_.current,ao(e.nodeType===8?e.parentNode:e),ln(function(){xl(s,_,r,o)}),_}function Sl(e,s,r,o,l){var c=r._reactRootContainer;if(c){var f=c;if(typeof l=="function"){var g=l;l=function(){var _=rl(f);g.call(_)}}xl(s,f,e,l)}else f=Jx(r,s,e,l,o);return rl(f)}Am=function(e){switch(e.tag){case 3:var s=e.stateNode;if(s.current.memoizedState.isDehydrated){var r=Wr(s.pendingLanes);r!==0&&(Bu(s,r|1),Ge(s,Xt()),!(xt&6)&&(nr=Xt()+500,Ts()))}break;case 13:ln(function(){var o=Ki(e,1);if(o!==null){var l=De();bi(o,e,1,l)}}),fd(e,1)}};Mu=function(e){if(e.tag===13){var s=Ki(e,134217728);if(s!==null){var r=De();bi(s,e,134217728,r)}fd(e,134217728)}};Tm=function(e){if(e.tag===13){var s=xs(e),r=Ki(e,s);if(r!==null){var o=De();bi(r,e,s,o)}fd(e,s)}};Pm=function(){return St};Rm=function(e,s){var r=St;try{return St=e,s()}finally{St=r}};kc=function(e,s,r){switch(s){case"input":if(Ec(e,r),s=r.name,r.type==="radio"&&s!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<r.length;s++){var o=r[s];if(o!==e&&o.form===e.form){var l=pl(o);if(!l)throw Error(q(90));om(o),Ec(o,l)}}}break;case"textarea":lm(e,r);break;case"select":s=r.value,s!=null&&Xn(e,!!r.multiple,s,!1)}};gm=ld;mm=ln;var tb={usingClientEntryPoint:!1,Events:[Co,Un,pl,fm,pm,ld]},Or={findFiberByHostInstance:Qs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eb={bundleType:Or.bundleType,version:Or.version,rendererPackageName:Or.rendererPackageName,rendererConfig:Or.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ts.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ym(e),e===null?null:e.stateNode},findFiberByHostInstance:Or.findFiberByHostInstance||Kx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wa.isDisabled&&wa.supportsFiber)try{cl=wa.inject(eb),Oi=wa}catch{}}si.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tb;si.createPortal=function(e,s){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gd(s))throw Error(q(200));return Zx(e,s,null,r)};si.createRoot=function(e,s){if(!gd(e))throw Error(q(299));var r=!1,o="",l=Z_;return s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(o=s.identifierPrefix),s.onRecoverableError!==void 0&&(l=s.onRecoverableError)),s=dd(e,1,!1,null,null,r,!1,o,l),e[Zi]=s.current,ao(e.nodeType===8?e.parentNode:e),new pd(s)};si.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(q(188)):(e=Object.keys(e).join(","),Error(q(268,e)));return e=ym(s),e=e===null?null:e.stateNode,e};si.flushSync=function(e){return ln(e)};si.hydrate=function(e,s,r){if(!Cl(s))throw Error(q(200));return Sl(null,e,s,!0,r)};si.hydrateRoot=function(e,s,r){if(!gd(e))throw Error(q(405));var o=r!=null&&r.hydratedSources||null,l=!1,c="",f=Z_;if(r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onRecoverableError!==void 0&&(f=r.onRecoverableError)),s=q_(s,null,e,1,r??null,l,!1,c,f),e[Zi]=s.current,ao(e),o)for(e=0;e<o.length;e++)r=o[e],l=r._getVersion,l=l(r._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[r,l]:s.mutableSourceEagerHydrationData.push(r,l);return new bl(s)};si.render=function(e,s,r){if(!Cl(s))throw Error(q(200));return Sl(null,e,s,!1,r)};si.unmountComponentAtNode=function(e){if(!Cl(e))throw Error(q(40));return e._reactRootContainer?(ln(function(){Sl(null,null,e,!1,function(){e._reactRootContainer=null,e[Zi]=null})}),!0):!1};si.unstable_batchedUpdates=ld;si.unstable_renderSubtreeIntoContainer=function(e,s,r,o){if(!Cl(r))throw Error(q(200));if(e==null||e._reactInternals===void 0)throw Error(q(38));return Sl(e,s,r,!1,o)};si.version="18.3.1-next-f1338f8080-20240426";function K_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(K_)}catch(e){console.error(e)}}K_(),Kg.exports=si;var ib=Kg.exports,ug=ib;vc.createRoot=ug.createRoot,vc.hydrateRoot=ug.hydrateRoot;const sb="modulepreload",nb=function(e){return"/ais-telegram-webpages/"+e},dg={},rb=function(s,r,o){let l=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));l=Promise.all(r.map(g=>{if(g=nb(g),g in dg)return;dg[g]=!0;const _=g.endsWith(".css"),v=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${v}`))return;const x=document.createElement("link");if(x.rel=_?"stylesheet":sb,_||(x.as="script",x.crossOrigin=""),x.href=g,f&&x.setAttribute("nonce",f),document.head.appendChild(x),_)return new Promise((S,A)=>{x.addEventListener("load",S),x.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${g}`)))})}))}return l.then(()=>s()).catch(c=>{const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c})};var J_={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var s={}.hasOwnProperty;function r(){for(var c="",f=0;f<arguments.length;f++){var g=arguments[f];g&&(c=l(c,o(g)))}return c}function o(c){if(typeof c=="string"||typeof c=="number")return c;if(typeof c!="object")return"";if(Array.isArray(c))return r.apply(null,c);if(c.toString!==Object.prototype.toString&&!c.toString.toString().includes("[native code]"))return c.toString();var f="";for(var g in c)s.call(c,g)&&c[g]&&(f=l(f,g));return f}function l(c,f){return f?c?c+" "+f:c+f:c}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(J_);var ob=J_.exports;const Be=xu(ob),ab=["xxl","xl","lg","md","sm","xs"],lb="xs",hb=Q.createContext({prefixes:{},breakpoints:ab,minBreakpoint:lb});function ri(e,s){const{prefixes:r}=Q.useContext(hb);return e||r[s]||s}var tv={exports:{}},cb="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ub=cb,db=ub;function ev(){}function iv(){}iv.resetWarningCache=ev;var fb=function(){function e(o,l,c,f,g,_){if(_!==db){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}e.isRequired=e;function s(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:s,element:e,elementType:e,instanceOf:s,node:e,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:iv,resetWarningCache:ev};return r.PropTypes=r,r};tv.exports=fb();var pb=tv.exports;const Nr=xu(pb),sv=e=>Q.forwardRef((s,r)=>Z.jsx("div",{...s,ref:r,className:Be(s.className,e)})),gb=["as","disabled"];function mb(e,s){if(e==null)return{};var r={},o=Object.keys(e),l,c;for(c=0;c<o.length;c++)l=o[c],!(s.indexOf(l)>=0)&&(r[l]=e[l]);return r}function _b(e){return!e||e.trim()==="#"}function nv({tagName:e,disabled:s,href:r,target:o,rel:l,role:c,onClick:f,tabIndex:g=0,type:_}){e||(r!=null||o!=null||l!=null?e="a":e="button");const v={tagName:e};if(e==="button")return[{type:_||"button",disabled:s},v];const x=A=>{if((s||e==="a"&&_b(r))&&A.preventDefault(),s){A.stopPropagation();return}f==null||f(A)},S=A=>{A.key===" "&&(A.preventDefault(),x(A))};return e==="a"&&(r||(r="#"),s&&(r=void 0)),[{role:c??"button",disabled:void 0,tabIndex:s?void 0:g,href:r,target:e==="a"?o:void 0,"aria-disabled":s||void 0,rel:e==="a"?l:void 0,onClick:x,onKeyDown:S},v]}const vb=Q.forwardRef((e,s)=>{let{as:r,disabled:o}=e,l=mb(e,gb);const[c,{tagName:f}]=nv(Object.assign({tagName:r,disabled:o},l));return Z.jsx(f,Object.assign({},l,c,{ref:s}))});vb.displayName="Button";const md=Q.forwardRef(({as:e,bsPrefix:s,variant:r="primary",size:o,active:l=!1,disabled:c=!1,className:f,...g},_)=>{const v=ri(s,"btn"),[x,{tagName:S}]=nv({tagName:e,disabled:c,...g}),A=S;return Z.jsx(A,{...x,...g,ref:_,disabled:c,className:Be(f,v,l&&"active",r&&`${v}-${r}`,o&&`${v}-${o}`,g.href&&c&&"disabled")})});md.displayName="Button";const _d=Q.forwardRef(({className:e,bsPrefix:s,as:r="div",...o},l)=>(s=ri(s,"card-body"),Z.jsx(r,{ref:l,className:Be(e,s),...o})));_d.displayName="CardBody";const rv=Q.forwardRef(({className:e,bsPrefix:s,as:r="div",...o},l)=>(s=ri(s,"card-footer"),Z.jsx(r,{ref:l,className:Be(e,s),...o})));rv.displayName="CardFooter";const ov=Q.createContext(null);ov.displayName="CardHeaderContext";const av=Q.forwardRef(({bsPrefix:e,className:s,as:r="div",...o},l)=>{const c=ri(e,"card-header"),f=Q.useMemo(()=>({cardHeaderBsPrefix:c}),[c]);return Z.jsx(ov.Provider,{value:f,children:Z.jsx(r,{ref:l,...o,className:Be(s,c)})})});av.displayName="CardHeader";const lv=Q.forwardRef(({bsPrefix:e,className:s,variant:r,as:o="img",...l},c)=>{const f=ri(e,"card-img");return Z.jsx(o,{ref:c,className:Be(r?`${f}-${r}`:f,s),...l})});lv.displayName="CardImg";const hv=Q.forwardRef(({className:e,bsPrefix:s,as:r="div",...o},l)=>(s=ri(s,"card-img-overlay"),Z.jsx(r,{ref:l,className:Be(e,s),...o})));hv.displayName="CardImgOverlay";const cv=Q.forwardRef(({className:e,bsPrefix:s,as:r="a",...o},l)=>(s=ri(s,"card-link"),Z.jsx(r,{ref:l,className:Be(e,s),...o})));cv.displayName="CardLink";const yb=sv("h6"),uv=Q.forwardRef(({className:e,bsPrefix:s,as:r=yb,...o},l)=>(s=ri(s,"card-subtitle"),Z.jsx(r,{ref:l,className:Be(e,s),...o})));uv.displayName="CardSubtitle";const dv=Q.forwardRef(({className:e,bsPrefix:s,as:r="p",...o},l)=>(s=ri(s,"card-text"),Z.jsx(r,{ref:l,className:Be(e,s),...o})));dv.displayName="CardText";const wb=sv("h5"),fv=Q.forwardRef(({className:e,bsPrefix:s,as:r=wb,...o},l)=>(s=ri(s,"card-title"),Z.jsx(r,{ref:l,className:Be(e,s),...o})));fv.displayName="CardTitle";const pv=Q.forwardRef(({bsPrefix:e,className:s,bg:r,text:o,border:l,body:c=!1,children:f,as:g="div",..._},v)=>{const x=ri(e,"card");return Z.jsx(g,{ref:v,..._,className:Be(s,x,r&&`bg-${r}`,o&&`text-${o}`,l&&`border-${l}`),children:c?Z.jsx(_d,{children:f}):f})});pv.displayName="Card";const fg=Object.assign(pv,{Img:lv,Title:fv,Subtitle:uv,Body:_d,Link:cv,Text:dv,Header:av,Footer:rv,ImgOverlay:hv});function xb(e,s){let r=0;return Q.Children.map(e,o=>Q.isValidElement(o)?s(o,r++):o)}Nr.string,Nr.bool,Nr.bool,Nr.bool,Nr.bool;const dn=Q.forwardRef(({bsPrefix:e,className:s,fluid:r=!1,rounded:o=!1,roundedCircle:l=!1,thumbnail:c=!1,...f},g)=>(e=ri(e,"img"),Z.jsx("img",{ref:g,...f,className:Be(s,r&&`${e}-fluid`,o&&"rounded",l&&"rounded-circle",c&&`${e}-thumbnail`)})));dn.displayName="Image";const pg=1e3;function bb(e,s,r){const o=(e-s)/(r-s)*100;return Math.round(o*pg)/pg}function gg({min:e,now:s,max:r,label:o,visuallyHidden:l,striped:c,animated:f,className:g,style:_,variant:v,bsPrefix:x,...S},A){return Z.jsx("div",{ref:A,...S,role:"progressbar",className:Be(g,`${x}-bar`,{[`bg-${v}`]:v,[`${x}-bar-animated`]:f,[`${x}-bar-striped`]:f||c}),style:{width:`${bb(s,e,r)}%`,..._},"aria-valuenow":s,"aria-valuemin":e,"aria-valuemax":r,children:l?Z.jsx("span",{className:"visually-hidden",children:o}):o})}const gv=Q.forwardRef(({isChild:e=!1,...s},r)=>{const o={min:0,max:100,animated:!1,visuallyHidden:!1,striped:!1,...s};if(o.bsPrefix=ri(o.bsPrefix,"progress"),e)return gg(o,r);const{min:l,now:c,max:f,label:g,visuallyHidden:_,striped:v,animated:x,bsPrefix:S,variant:A,className:I,children:F,...L}=o;return Z.jsx("div",{ref:r,...L,className:Be(I,S),children:F?xb(F,O=>Q.cloneElement(O,{isChild:!0})):gg({min:l,now:c,max:f,label:g,visuallyHidden:_,striped:v,animated:x,bsPrefix:S,variant:A},r)})});gv.displayName="ProgressBar";const Cb="/ais-telegram-webpages/assets/DiggerButton-CiwoLz5n.png";function Sb({onTap:e,children:s}){const r=Q.useRef(null),[o,l]=Q.useState(!1);Q.useContext(Sd),Q.useEffect(()=>{if(o){const _=setTimeout(()=>l(!1),100);return()=>clearTimeout(_)}},[o]);const c=(_,v)=>{const x=r.current;if(x){const S=x.getBoundingClientRect();return[_-S.left,v-S.top]}return[_,v]},f=_=>{l(!0);const v=_.touches;for(let x=0;x<v.length;x++){const S=v[x],[A,I]=c(S.clientX,S.clientY);e(A,I)}},g=_=>{if(!o){const[v,x]=c(_.clientX,_.clientY);e(v,x)}};return Q.useEffect(()=>{const _=x=>{x.touches.length===1&&x.changedTouches[0].clientY>0&&x.preventDefault()},v=r.current;return v&&(v.addEventListener("touchstart",_,{passive:!1}),v.addEventListener("touchmove",_,{passive:!1})),()=>{v&&(v.removeEventListener("touchstart",_),v.removeEventListener("touchmove",_))}},[]),Z.jsxs("div",{ref:r,className:"relative flex h-72 justify-center",onTouchStart:f,onMouseDown:g,children:[Z.jsx(dn,{src:Cb,className:"tap-button w-100 h-auto object-contain",rounded:!0,draggable:"false"}),s]})}const mv="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAABHNCSVQICAgIfAhkiAAABHFJREFUWEfVWVFO20AQnbWd/paegPxWVQn8VW0Q4QTQE5AbEE5AOAHhBA0naDhBjaBV/0ioqv7CCQq/je3pm107cRw7sZNg2pWiRIl39+3szJs3E0UrGny7vUMcVMlSVWJq6GUZnxVVU7dg7uO3B/z2gPc+nu2T7d+rN9/6WZDUolj5prFGlneAjQBM7S+6ztQ81uB7OLiral/P478XBqtB2v4pFmmuDGDWQgLc4o56e30ijxQCyz/fb5Jnf8GstScHGt9AXCZwdouBHWz/Lh3oGPRFbrDaqr59U6pFJ6xLj7nB6uC+rSNSVe1ZADOfFQOrg8vrAfBOqYAFaO26VQhsBBCcCibgVglWPifFXbCBW5gNktY07KAapIRnV2BtpkfNsUQuVYauev39bimenXX9/OtdlTynSkGYwZSq4gbwShmMrCXZixhciuzlOX215UpGmxo8+HBAZLUXcoMy/FUf/I+zhxtrRSn7nwE70hbK2iRmca3NpFFyg9UnHVbWR2IlzbyB5HUtSB5nCZJwrTZcYB2Wa+S9qUywOngCa08rKMYpF0qxjCgGeASM2ri6iIMKhVAbhzvMCfZ8AqxewPEOKVDNTGmXc+XpKAnVVGV4Eo9yQ4P0ac6yF8iezRFYPYnpdDELFj5BB5Y+imYh2hFElii5xOBL4GlP8CyAysnkhOWNSEmFdDVO5QDI3KMXfm+KZ7NPVQZu7qmN64+yk7hgJs/+qCNu6FjxoH6TRhNlQNV7+ParNJAmAId7wIYbN4wBsNtSRrwsDVxyI9vfimgO7ghwDJ7VpZIGGB8KD3TxBdLZMwzme6iparQzsPAsFMrUVJ5bgoKaxCGixfEb8eQxB6zh2bAIFAsjF5cxeEB20ExmuWywYAjf2Z9MCibq2iuRe2lnxrUjYNrgWDHM1JgCm3he2OAQfnMWn2l0qiVZTBx9uTLGbAg3I9DUlWjV0WAxjhU8xAIMPgurM/SsE3STlpcAkwdcADuJMsXEgiYFQydEGjV8Hz8kZflYh0Y6VQSNb7uptGRE0THmwSC8m7ZvmuVDsKN4dJE9uslOyKq8WFuSlTBPc7Tm4mDDJXQLB9Y213E5S+7NOogR0PYO8r7EAjRqSt9rabDpwRE20tQdDnKXCpIVXEKT+lrurFgQrDh9SZSVOCK4VtWucreioqTwHL2Ae7jYfhEXS+hZFuWOUuMJh2Qu4g4abZ0slZW1+1RZoyM2IOm37q8MeKwfkJUQ8pgH1FX/TBXvKCl0ZXJY5qRzrKnLYmoNKXHEgGFPQLi2MuzPWFvqr8tFeLaLqvSsiA/lsUbymbARcoA6T/oBYI2Fk4KYk0BN4Fe0ycnhwbLgw7JbUja4NqUfsBTYdAJ1zde4VoV2T3xIr8BKdMLHf4DML+ELgv3veBaWW1JdFXXgFPE9b4kxzw7q7bAJ9rT1WERjvt1anmdNh0SEB3h2RYWkAWiCNqh0i4KMLD6zMRf+6YF/DCFOdFePJY/jleEyWmiDTTRJA5wyoicvj85zg7/ODzdd40KoLAAAAABJRU5ErkJggg==";function Eb({score:e}){return Z.jsxs("section",{className:"flex items-center justify-center gap-3 pb-2 pt-3",children:[Z.jsx("div",{className:"score-icon",children:Z.jsx(dn,{src:mv})}),Z.jsx("span",{className:"text-5xl font-bold",children:e.toLocaleString()})]})}const Ab=({number:e,x:s,y:r,onAnimationEnd:o})=>{const l=Q.useRef(null),[c,f]=Q.useState({x:s,y:r});return Q.useLayoutEffect(()=>{if(l.current){const g=s-l.current.clientWidth/2,_=r-l.current.clientHeight/2;f({x:g,y:_})}},[s,r]),Q.useEffect(()=>{const g=setTimeout(()=>{o()},1e3);return()=>clearTimeout(g)},[o]),Z.jsxs("div",{ref:l,className:"floating-number",style:{left:`${c.x}px`,top:`${c.y}px`},children:["+",e]})};function Tb({size:e=1,className:s=""}){return Z.jsx("span",{className:`absolute top-[-3px] right-[-3px] bg-red-500 
                 rounded-full p-${e} ${s}`})}function hc({caption:e,onClick:s,disabled:r,children:o}){return Z.jsxs("div",{className:"captioned-button",children:[Z.jsxs(md,{className:"button group",onClick:s,disabled:r,children:[o,Z.jsx(Tb,{className:"group-disabled:hidden"})]}),Z.jsx("div",{className:"text",children:e})]})}const Pb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAcCAYAAABlL09dAAAABHNCSVQICAgIfAhkiAAAAiBJREFUSEullU1OAkEQhatA3MoNHJfGKLgzOkQ8gXgC9QTqCdQTiCcQTyCeQAho3OFgjEvxBOJWA2X1AP033STOzGpoqr9+XfWqBiHjQ1FlCAhLEkPwjaVOEbNwqV+p8f47i3GMG51GVnCToftKLX1iqRuI3wkwvW8F8FtYdt2ElbRn69O4DyvugGPEYQ5wP2zx8m4STG3c6FYlONo5BcxdqTjzf0OxR8Vkb+F3BVefBwocDgBR3QxpD9e7LGrymOAovODgc0cabvmKRxL6tl2GUb6ncgtDyFFdQte7lzbYVCEi2T4wzge42RpKcL/S4PdDhwCxdM8iahJMr2EVCB8SwUSXXOkLfT3hXXmiEqHALhUOtfbBFBm5Nl1BvWoRcqMPznjR2hib3XNlIDPXRh1ixdxBojA3BoCU2b3g2S05FsYLZb0OU7DDuwRcSBooKH6LojhzbVlNxOBc7xqU8RmWHqWl5C2Jrrm4p/atkJPv864eG1vIOKdfaQJR2U7BLAbjk4kCuQmxzO/aYHH4eDJPuNhmt+kHJ4eQUKKDAaSFpF3FnAAs2v72gmPb5UdfWkAiBVMXNe3UJHJsVlmbWJ7miA9f/Alw7enFZ8PYFWZBQg7G0nQtkYJ5IK9iq4ucKUgHjsI6j8wT1zT7D1DaTVVafm0zpcAAy6+tp4tSK2bw3C5KBZbendNF6cCTLgpcgyQNUJ8VTf4wHumzNAtwtvcPuoUeLFmI7gkAAAAASUVORK5CYII=";function Rb({energy:e,limit:s}){return Z.jsxs("section",{className:"flex w-auto items-center justify-center gap-1",children:[Z.jsx(dn,{src:Pb}),Z.jsxs("span",{children:[e>=0?e:0," / ",s]})]})}function Ib({token:e}){const s=r=>r>=1e9?`+${(r/1e9).toFixed(2)}K`:r>=1e6?`+${(r/1e6).toFixed(2)}K`:r>=1e3?`+${(r/1e3).toFixed(2)}K`:`+${r}`;return Z.jsxs("div",{className:"flex flex-col items-end justify-between",children:[Z.jsx("div",{className:"label",children:"Token Per Hour"}),Z.jsxs("div",{className:"flex flex-row items-center justify-end gap-2",children:[Z.jsx(dn,{src:mv,className:"h-6"}),Z.jsx("span",{className:"text-3xl",children:s(e)})]})]})}function Db({tokens:e}){const[s,r]=Q.useState(0),o=["Bronze","Silver","Gold","Platinum","Diamond","Epic","Legendary","Master","Grandmaster","Lord","Creator"],l=[0,5e3,25e3,1e5,1e6,2e6,1e7,5e7,1e8,1e9,18e8],c=()=>{if(s>=o.length-1)return 100;const f=l[s],g=l[s+1],_=(e-f)/(g-f)*100;return Math.min(_,100)};return Q.useEffect(()=>{const f=l[s+1];e>=f&&s<o.length-1&&r(s+1)},[e,s,l,o.length]),Z.jsxs("section",{className:"mt-1 flex flex-col justify-between",children:[Z.jsxs("div",{className:"level",children:[o[s]," ",s," / ",l.length]}),Z.jsx(gv,{now:c(),className:"progress-gradient h-2"})]})}function _v(e,s){return function(){return e.apply(s,arguments)}}const{toString:kb}=Object.prototype,{getPrototypeOf:vd}=Object,El=(e=>s=>{const r=kb.call(s);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Si=e=>(e=e.toLowerCase(),s=>El(s)===e),Al=e=>s=>typeof s===e,{isArray:lr}=Array,_o=Al("undefined");function Fb(e){return e!==null&&!_o(e)&&e.constructor!==null&&!_o(e.constructor)&&ti(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const vv=Si("ArrayBuffer");function Bb(e){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(e):s=e&&e.buffer&&vv(e.buffer),s}const Mb=Al("string"),ti=Al("function"),yv=Al("number"),Tl=e=>e!==null&&typeof e=="object",Lb=e=>e===!0||e===!1,Fa=e=>{if(El(e)!=="object")return!1;const s=vd(e);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Ob=Si("Date"),Nb=Si("File"),Ub=Si("Blob"),zb=Si("FileList"),Hb=e=>Tl(e)&&ti(e.pipe),Wb=e=>{let s;return e&&(typeof FormData=="function"&&e instanceof FormData||ti(e.append)&&((s=El(e))==="formdata"||s==="object"&&ti(e.toString)&&e.toString()==="[object FormData]"))},jb=Si("URLSearchParams"),[Vb,Gb,Xb,Yb]=["ReadableStream","Request","Response","Headers"].map(Si),$b=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Eo(e,s,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let o,l;if(typeof e!="object"&&(e=[e]),lr(e))for(o=0,l=e.length;o<l;o++)s.call(null,e[o],o,e);else{const c=r?Object.getOwnPropertyNames(e):Object.keys(e),f=c.length;let g;for(o=0;o<f;o++)g=c[o],s.call(null,e[g],g,e)}}function wv(e,s){s=s.toLowerCase();const r=Object.keys(e);let o=r.length,l;for(;o-- >0;)if(l=r[o],s===l.toLowerCase())return l;return null}const Ks=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,xv=e=>!_o(e)&&e!==Ks;function uu(){const{caseless:e}=xv(this)&&this||{},s={},r=(o,l)=>{const c=e&&wv(s,l)||l;Fa(s[c])&&Fa(o)?s[c]=uu(s[c],o):Fa(o)?s[c]=uu({},o):lr(o)?s[c]=o.slice():s[c]=o};for(let o=0,l=arguments.length;o<l;o++)arguments[o]&&Eo(arguments[o],r);return s}const Qb=(e,s,r,{allOwnKeys:o}={})=>(Eo(s,(l,c)=>{r&&ti(l)?e[c]=_v(l,r):e[c]=l},{allOwnKeys:o}),e),qb=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Zb=(e,s,r,o)=>{e.prototype=Object.create(s.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:s.prototype}),r&&Object.assign(e.prototype,r)},Kb=(e,s,r,o)=>{let l,c,f;const g={};if(s=s||{},e==null)return s;do{for(l=Object.getOwnPropertyNames(e),c=l.length;c-- >0;)f=l[c],(!o||o(f,e,s))&&!g[f]&&(s[f]=e[f],g[f]=!0);e=r!==!1&&vd(e)}while(e&&(!r||r(e,s))&&e!==Object.prototype);return s},Jb=(e,s,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=s.length;const o=e.indexOf(s,r);return o!==-1&&o===r},tC=e=>{if(!e)return null;if(lr(e))return e;let s=e.length;if(!yv(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=e[s];return r},eC=(e=>s=>e&&s instanceof e)(typeof Uint8Array<"u"&&vd(Uint8Array)),iC=(e,s)=>{const o=(e&&e[Symbol.iterator]).call(e);let l;for(;(l=o.next())&&!l.done;){const c=l.value;s.call(e,c[0],c[1])}},sC=(e,s)=>{let r;const o=[];for(;(r=e.exec(s))!==null;)o.push(r);return o},nC=Si("HTMLFormElement"),rC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,o,l){return o.toUpperCase()+l}),mg=(({hasOwnProperty:e})=>(s,r)=>e.call(s,r))(Object.prototype),oC=Si("RegExp"),bv=(e,s)=>{const r=Object.getOwnPropertyDescriptors(e),o={};Eo(r,(l,c)=>{let f;(f=s(l,c,e))!==!1&&(o[c]=f||l)}),Object.defineProperties(e,o)},aC=e=>{bv(e,(s,r)=>{if(ti(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const o=e[r];if(ti(o)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},lC=(e,s)=>{const r={},o=l=>{l.forEach(c=>{r[c]=!0})};return lr(e)?o(e):o(String(e).split(s)),r},hC=()=>{},cC=(e,s)=>e!=null&&Number.isFinite(e=+e)?e:s,cc="abcdefghijklmnopqrstuvwxyz",_g="0123456789",Cv={DIGIT:_g,ALPHA:cc,ALPHA_DIGIT:cc+cc.toUpperCase()+_g},uC=(e=16,s=Cv.ALPHA_DIGIT)=>{let r="";const{length:o}=s;for(;e--;)r+=s[Math.random()*o|0];return r};function dC(e){return!!(e&&ti(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const fC=e=>{const s=new Array(10),r=(o,l)=>{if(Tl(o)){if(s.indexOf(o)>=0)return;if(!("toJSON"in o)){s[l]=o;const c=lr(o)?[]:{};return Eo(o,(f,g)=>{const _=r(f,l+1);!_o(_)&&(c[g]=_)}),s[l]=void 0,c}}return o};return r(e,0)},pC=Si("AsyncFunction"),gC=e=>e&&(Tl(e)||ti(e))&&ti(e.then)&&ti(e.catch),Sv=((e,s)=>e?setImmediate:s?((r,o)=>(Ks.addEventListener("message",({source:l,data:c})=>{l===Ks&&c===r&&o.length&&o.shift()()},!1),l=>{o.push(l),Ks.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ti(Ks.postMessage)),mC=typeof queueMicrotask<"u"?queueMicrotask.bind(Ks):typeof process<"u"&&process.nextTick||Sv,V={isArray:lr,isArrayBuffer:vv,isBuffer:Fb,isFormData:Wb,isArrayBufferView:Bb,isString:Mb,isNumber:yv,isBoolean:Lb,isObject:Tl,isPlainObject:Fa,isReadableStream:Vb,isRequest:Gb,isResponse:Xb,isHeaders:Yb,isUndefined:_o,isDate:Ob,isFile:Nb,isBlob:Ub,isRegExp:oC,isFunction:ti,isStream:Hb,isURLSearchParams:jb,isTypedArray:eC,isFileList:zb,forEach:Eo,merge:uu,extend:Qb,trim:$b,stripBOM:qb,inherits:Zb,toFlatObject:Kb,kindOf:El,kindOfTest:Si,endsWith:Jb,toArray:tC,forEachEntry:iC,matchAll:sC,isHTMLForm:nC,hasOwnProperty:mg,hasOwnProp:mg,reduceDescriptors:bv,freezeMethods:aC,toObjectSet:lC,toCamelCase:rC,noop:hC,toFiniteNumber:cC,findKey:wv,global:Ks,isContextDefined:xv,ALPHABET:Cv,generateString:uC,isSpecCompliantForm:dC,toJSONObject:fC,isAsyncFn:pC,isThenable:gC,setImmediate:Sv,asap:mC};function pt(e,s,r,o,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),o&&(this.request=o),l&&(this.response=l,this.status=l.status?l.status:null)}V.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:V.toJSONObject(this.config),code:this.code,status:this.status}}});const Ev=pt.prototype,Av={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Av[e]={value:e}});Object.defineProperties(pt,Av);Object.defineProperty(Ev,"isAxiosError",{value:!0});pt.from=(e,s,r,o,l,c)=>{const f=Object.create(Ev);return V.toFlatObject(e,f,function(_){return _!==Error.prototype},g=>g!=="isAxiosError"),pt.call(f,e.message,s,r,o,l),f.cause=e,f.name=e.name,c&&Object.assign(f,c),f};const _C=null;function du(e){return V.isPlainObject(e)||V.isArray(e)}function Tv(e){return V.endsWith(e,"[]")?e.slice(0,-2):e}function vg(e,s,r){return e?e.concat(s).map(function(l,c){return l=Tv(l),!r&&c?"["+l+"]":l}).join(r?".":""):s}function vC(e){return V.isArray(e)&&!e.some(du)}const yC=V.toFlatObject(V,{},null,function(s){return/^is[A-Z]/.test(s)});function Pl(e,s,r){if(!V.isObject(e))throw new TypeError("target must be an object");s=s||new FormData,r=V.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(L,O){return!V.isUndefined(O[L])});const o=r.metaTokens,l=r.visitor||x,c=r.dots,f=r.indexes,_=(r.Blob||typeof Blob<"u"&&Blob)&&V.isSpecCompliantForm(s);if(!V.isFunction(l))throw new TypeError("visitor must be a function");function v(F){if(F===null)return"";if(V.isDate(F))return F.toISOString();if(!_&&V.isBlob(F))throw new pt("Blob is not supported. Use a Buffer instead.");return V.isArrayBuffer(F)||V.isTypedArray(F)?_&&typeof Blob=="function"?new Blob([F]):Buffer.from(F):F}function x(F,L,O){let T=F;if(F&&!O&&typeof F=="object"){if(V.endsWith(L,"{}"))L=o?L:L.slice(0,-2),F=JSON.stringify(F);else if(V.isArray(F)&&vC(F)||(V.isFileList(F)||V.endsWith(L,"[]"))&&(T=V.toArray(F)))return L=Tv(L),T.forEach(function(D,W){!(V.isUndefined(D)||D===null)&&s.append(f===!0?vg([L],W,c):f===null?L:L+"[]",v(D))}),!1}return du(F)?!0:(s.append(vg(O,L,c),v(F)),!1)}const S=[],A=Object.assign(yC,{defaultVisitor:x,convertValue:v,isVisitable:du});function I(F,L){if(!V.isUndefined(F)){if(S.indexOf(F)!==-1)throw Error("Circular reference detected in "+L.join("."));S.push(F),V.forEach(F,function(T,P){(!(V.isUndefined(T)||T===null)&&l.call(s,T,V.isString(P)?P.trim():P,L,A))===!0&&I(T,L?L.concat(P):[P])}),S.pop()}}if(!V.isObject(e))throw new TypeError("data must be an object");return I(e),s}function yg(e){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(o){return s[o]})}function yd(e,s){this._pairs=[],e&&Pl(e,this,s)}const Pv=yd.prototype;Pv.append=function(s,r){this._pairs.push([s,r])};Pv.toString=function(s){const r=s?function(o){return s.call(this,o,yg)}:yg;return this._pairs.map(function(l){return r(l[0])+"="+r(l[1])},"").join("&")};function wC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Rv(e,s,r){if(!s)return e;const o=r&&r.encode||wC,l=r&&r.serialize;let c;if(l?c=l(s,r):c=V.isURLSearchParams(s)?s.toString():new yd(s,r).toString(o),c){const f=e.indexOf("#");f!==-1&&(e=e.slice(0,f)),e+=(e.indexOf("?")===-1?"?":"&")+c}return e}class wg{constructor(){this.handlers=[]}use(s,r,o){return this.handlers.push({fulfilled:s,rejected:r,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){V.forEach(this.handlers,function(o){o!==null&&s(o)})}}const Iv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xC=typeof URLSearchParams<"u"?URLSearchParams:yd,bC=typeof FormData<"u"?FormData:null,CC=typeof Blob<"u"?Blob:null,SC={isBrowser:!0,classes:{URLSearchParams:xC,FormData:bC,Blob:CC},protocols:["http","https","file","blob","url","data"]},wd=typeof window<"u"&&typeof document<"u",fu=typeof navigator=="object"&&navigator||void 0,EC=wd&&(!fu||["ReactNative","NativeScript","NS"].indexOf(fu.product)<0),AC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",TC=wd&&window.location.href||"http://localhost",PC=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wd,hasStandardBrowserEnv:EC,hasStandardBrowserWebWorkerEnv:AC,navigator:fu,origin:TC},Symbol.toStringTag,{value:"Module"})),ei={...PC,...SC};function RC(e,s){return Pl(e,new ei.classes.URLSearchParams,Object.assign({visitor:function(r,o,l,c){return ei.isNode&&V.isBuffer(r)?(this.append(o,r.toString("base64")),!1):c.defaultVisitor.apply(this,arguments)}},s))}function IC(e){return V.matchAll(/\w+|\[(\w*)]/g,e).map(s=>s[0]==="[]"?"":s[1]||s[0])}function DC(e){const s={},r=Object.keys(e);let o;const l=r.length;let c;for(o=0;o<l;o++)c=r[o],s[c]=e[c];return s}function Dv(e){function s(r,o,l,c){let f=r[c++];if(f==="__proto__")return!0;const g=Number.isFinite(+f),_=c>=r.length;return f=!f&&V.isArray(l)?l.length:f,_?(V.hasOwnProp(l,f)?l[f]=[l[f],o]:l[f]=o,!g):((!l[f]||!V.isObject(l[f]))&&(l[f]=[]),s(r,o,l[f],c)&&V.isArray(l[f])&&(l[f]=DC(l[f])),!g)}if(V.isFormData(e)&&V.isFunction(e.entries)){const r={};return V.forEachEntry(e,(o,l)=>{s(IC(o),l,r,0)}),r}return null}function kC(e,s,r){if(V.isString(e))try{return(s||JSON.parse)(e),V.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(r||JSON.stringify)(e)}const Ao={transitional:Iv,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const o=r.getContentType()||"",l=o.indexOf("application/json")>-1,c=V.isObject(s);if(c&&V.isHTMLForm(s)&&(s=new FormData(s)),V.isFormData(s))return l?JSON.stringify(Dv(s)):s;if(V.isArrayBuffer(s)||V.isBuffer(s)||V.isStream(s)||V.isFile(s)||V.isBlob(s)||V.isReadableStream(s))return s;if(V.isArrayBufferView(s))return s.buffer;if(V.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let g;if(c){if(o.indexOf("application/x-www-form-urlencoded")>-1)return RC(s,this.formSerializer).toString();if((g=V.isFileList(s))||o.indexOf("multipart/form-data")>-1){const _=this.env&&this.env.FormData;return Pl(g?{"files[]":s}:s,_&&new _,this.formSerializer)}}return c||l?(r.setContentType("application/json",!1),kC(s)):s}],transformResponse:[function(s){const r=this.transitional||Ao.transitional,o=r&&r.forcedJSONParsing,l=this.responseType==="json";if(V.isResponse(s)||V.isReadableStream(s))return s;if(s&&V.isString(s)&&(o&&!this.responseType||l)){const f=!(r&&r.silentJSONParsing)&&l;try{return JSON.parse(s)}catch(g){if(f)throw g.name==="SyntaxError"?pt.from(g,pt.ERR_BAD_RESPONSE,this,null,this.response):g}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ei.classes.FormData,Blob:ei.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};V.forEach(["delete","get","head","post","put","patch"],e=>{Ao.headers[e]={}});const FC=V.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),BC=e=>{const s={};let r,o,l;return e&&e.split(`
`).forEach(function(f){l=f.indexOf(":"),r=f.substring(0,l).trim().toLowerCase(),o=f.substring(l+1).trim(),!(!r||s[r]&&FC[r])&&(r==="set-cookie"?s[r]?s[r].push(o):s[r]=[o]:s[r]=s[r]?s[r]+", "+o:o)}),s},xg=Symbol("internals");function Ur(e){return e&&String(e).trim().toLowerCase()}function Ba(e){return e===!1||e==null?e:V.isArray(e)?e.map(Ba):String(e)}function MC(e){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=r.exec(e);)s[o[1]]=o[2];return s}const LC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function uc(e,s,r,o,l){if(V.isFunction(o))return o.call(this,s,r);if(l&&(s=r),!!V.isString(s)){if(V.isString(o))return s.indexOf(o)!==-1;if(V.isRegExp(o))return o.test(s)}}function OC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,o)=>r.toUpperCase()+o)}function NC(e,s){const r=V.toCamelCase(" "+s);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+r,{value:function(l,c,f){return this[o].call(this,s,l,c,f)},configurable:!0})})}class Xe{constructor(s){s&&this.set(s)}set(s,r,o){const l=this;function c(g,_,v){const x=Ur(_);if(!x)throw new Error("header name must be a non-empty string");const S=V.findKey(l,x);(!S||l[S]===void 0||v===!0||v===void 0&&l[S]!==!1)&&(l[S||_]=Ba(g))}const f=(g,_)=>V.forEach(g,(v,x)=>c(v,x,_));if(V.isPlainObject(s)||s instanceof this.constructor)f(s,r);else if(V.isString(s)&&(s=s.trim())&&!LC(s))f(BC(s),r);else if(V.isHeaders(s))for(const[g,_]of s.entries())c(_,g,o);else s!=null&&c(r,s,o);return this}get(s,r){if(s=Ur(s),s){const o=V.findKey(this,s);if(o){const l=this[o];if(!r)return l;if(r===!0)return MC(l);if(V.isFunction(r))return r.call(this,l,o);if(V.isRegExp(r))return r.exec(l);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=Ur(s),s){const o=V.findKey(this,s);return!!(o&&this[o]!==void 0&&(!r||uc(this,this[o],o,r)))}return!1}delete(s,r){const o=this;let l=!1;function c(f){if(f=Ur(f),f){const g=V.findKey(o,f);g&&(!r||uc(o,o[g],g,r))&&(delete o[g],l=!0)}}return V.isArray(s)?s.forEach(c):c(s),l}clear(s){const r=Object.keys(this);let o=r.length,l=!1;for(;o--;){const c=r[o];(!s||uc(this,this[c],c,s,!0))&&(delete this[c],l=!0)}return l}normalize(s){const r=this,o={};return V.forEach(this,(l,c)=>{const f=V.findKey(o,c);if(f){r[f]=Ba(l),delete r[c];return}const g=s?OC(c):String(c).trim();g!==c&&delete r[c],r[g]=Ba(l),o[g]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return V.forEach(this,(o,l)=>{o!=null&&o!==!1&&(r[l]=s&&V.isArray(o)?o.join(", "):o)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const o=new this(s);return r.forEach(l=>o.set(l)),o}static accessor(s){const o=(this[xg]=this[xg]={accessors:{}}).accessors,l=this.prototype;function c(f){const g=Ur(f);o[g]||(NC(l,f),o[g]=!0)}return V.isArray(s)?s.forEach(c):c(s),this}}Xe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);V.reduceDescriptors(Xe.prototype,({value:e},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>e,set(o){this[r]=o}}});V.freezeMethods(Xe);function dc(e,s){const r=this||Ao,o=s||r,l=Xe.from(o.headers);let c=o.data;return V.forEach(e,function(g){c=g.call(r,c,l.normalize(),s?s.status:void 0)}),l.normalize(),c}function kv(e){return!!(e&&e.__CANCEL__)}function hr(e,s,r){pt.call(this,e??"canceled",pt.ERR_CANCELED,s,r),this.name="CanceledError"}V.inherits(hr,pt,{__CANCEL__:!0});function Fv(e,s,r){const o=r.config.validateStatus;!r.status||!o||o(r.status)?e(r):s(new pt("Request failed with status code "+r.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function UC(e){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return s&&s[1]||""}function zC(e,s){e=e||10;const r=new Array(e),o=new Array(e);let l=0,c=0,f;return s=s!==void 0?s:1e3,function(_){const v=Date.now(),x=o[c];f||(f=v),r[l]=_,o[l]=v;let S=c,A=0;for(;S!==l;)A+=r[S++],S=S%e;if(l=(l+1)%e,l===c&&(c=(c+1)%e),v-f<s)return;const I=x&&v-x;return I?Math.round(A*1e3/I):void 0}}function HC(e,s){let r=0,o=1e3/s,l,c;const f=(v,x=Date.now())=>{r=x,l=null,c&&(clearTimeout(c),c=null),e.apply(null,v)};return[(...v)=>{const x=Date.now(),S=x-r;S>=o?f(v,x):(l=v,c||(c=setTimeout(()=>{c=null,f(l)},o-S)))},()=>l&&f(l)]}const ol=(e,s,r=3)=>{let o=0;const l=zC(50,250);return HC(c=>{const f=c.loaded,g=c.lengthComputable?c.total:void 0,_=f-o,v=l(_),x=f<=g;o=f;const S={loaded:f,total:g,progress:g?f/g:void 0,bytes:_,rate:v||void 0,estimated:v&&g&&x?(g-f)/v:void 0,event:c,lengthComputable:g!=null,[s?"download":"upload"]:!0};e(S)},r)},bg=(e,s)=>{const r=e!=null;return[o=>s[0]({lengthComputable:r,total:e,loaded:o}),s[1]]},Cg=e=>(...s)=>V.asap(()=>e(...s)),WC=ei.hasStandardBrowserEnv?function(){const s=ei.navigator&&/(msie|trident)/i.test(ei.navigator.userAgent),r=document.createElement("a");let o;function l(c){let f=c;return s&&(r.setAttribute("href",f),f=r.href),r.setAttribute("href",f),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return o=l(window.location.href),function(f){const g=V.isString(f)?l(f):f;return g.protocol===o.protocol&&g.host===o.host}}():function(){return function(){return!0}}(),jC=ei.hasStandardBrowserEnv?{write(e,s,r,o,l,c){const f=[e+"="+encodeURIComponent(s)];V.isNumber(r)&&f.push("expires="+new Date(r).toGMTString()),V.isString(o)&&f.push("path="+o),V.isString(l)&&f.push("domain="+l),c===!0&&f.push("secure"),document.cookie=f.join("; ")},read(e){const s=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function VC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function GC(e,s){return s?e.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):e}function Bv(e,s){return e&&!VC(s)?GC(e,s):s}const Sg=e=>e instanceof Xe?{...e}:e;function hn(e,s){s=s||{};const r={};function o(v,x,S){return V.isPlainObject(v)&&V.isPlainObject(x)?V.merge.call({caseless:S},v,x):V.isPlainObject(x)?V.merge({},x):V.isArray(x)?x.slice():x}function l(v,x,S){if(V.isUndefined(x)){if(!V.isUndefined(v))return o(void 0,v,S)}else return o(v,x,S)}function c(v,x){if(!V.isUndefined(x))return o(void 0,x)}function f(v,x){if(V.isUndefined(x)){if(!V.isUndefined(v))return o(void 0,v)}else return o(void 0,x)}function g(v,x,S){if(S in s)return o(v,x);if(S in e)return o(void 0,v)}const _={url:c,method:c,data:c,baseURL:f,transformRequest:f,transformResponse:f,paramsSerializer:f,timeout:f,timeoutMessage:f,withCredentials:f,withXSRFToken:f,adapter:f,responseType:f,xsrfCookieName:f,xsrfHeaderName:f,onUploadProgress:f,onDownloadProgress:f,decompress:f,maxContentLength:f,maxBodyLength:f,beforeRedirect:f,transport:f,httpAgent:f,httpsAgent:f,cancelToken:f,socketPath:f,responseEncoding:f,validateStatus:g,headers:(v,x)=>l(Sg(v),Sg(x),!0)};return V.forEach(Object.keys(Object.assign({},e,s)),function(x){const S=_[x]||l,A=S(e[x],s[x],x);V.isUndefined(A)&&S!==g||(r[x]=A)}),r}const Mv=e=>{const s=hn({},e);let{data:r,withXSRFToken:o,xsrfHeaderName:l,xsrfCookieName:c,headers:f,auth:g}=s;s.headers=f=Xe.from(f),s.url=Rv(Bv(s.baseURL,s.url),e.params,e.paramsSerializer),g&&f.set("Authorization","Basic "+btoa((g.username||"")+":"+(g.password?unescape(encodeURIComponent(g.password)):"")));let _;if(V.isFormData(r)){if(ei.hasStandardBrowserEnv||ei.hasStandardBrowserWebWorkerEnv)f.setContentType(void 0);else if((_=f.getContentType())!==!1){const[v,...x]=_?_.split(";").map(S=>S.trim()).filter(Boolean):[];f.setContentType([v||"multipart/form-data",...x].join("; "))}}if(ei.hasStandardBrowserEnv&&(o&&V.isFunction(o)&&(o=o(s)),o||o!==!1&&WC(s.url))){const v=l&&c&&jC.read(c);v&&f.set(l,v)}return s},XC=typeof XMLHttpRequest<"u",YC=XC&&function(e){return new Promise(function(r,o){const l=Mv(e);let c=l.data;const f=Xe.from(l.headers).normalize();let{responseType:g,onUploadProgress:_,onDownloadProgress:v}=l,x,S,A,I,F;function L(){I&&I(),F&&F(),l.cancelToken&&l.cancelToken.unsubscribe(x),l.signal&&l.signal.removeEventListener("abort",x)}let O=new XMLHttpRequest;O.open(l.method.toUpperCase(),l.url,!0),O.timeout=l.timeout;function T(){if(!O)return;const D=Xe.from("getAllResponseHeaders"in O&&O.getAllResponseHeaders()),j={data:!g||g==="text"||g==="json"?O.responseText:O.response,status:O.status,statusText:O.statusText,headers:D,config:e,request:O};Fv(function(E){r(E),L()},function(E){o(E),L()},j),O=null}"onloadend"in O?O.onloadend=T:O.onreadystatechange=function(){!O||O.readyState!==4||O.status===0&&!(O.responseURL&&O.responseURL.indexOf("file:")===0)||setTimeout(T)},O.onabort=function(){O&&(o(new pt("Request aborted",pt.ECONNABORTED,e,O)),O=null)},O.onerror=function(){o(new pt("Network Error",pt.ERR_NETWORK,e,O)),O=null},O.ontimeout=function(){let W=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded";const j=l.transitional||Iv;l.timeoutErrorMessage&&(W=l.timeoutErrorMessage),o(new pt(W,j.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,e,O)),O=null},c===void 0&&f.setContentType(null),"setRequestHeader"in O&&V.forEach(f.toJSON(),function(W,j){O.setRequestHeader(j,W)}),V.isUndefined(l.withCredentials)||(O.withCredentials=!!l.withCredentials),g&&g!=="json"&&(O.responseType=l.responseType),v&&([A,F]=ol(v,!0),O.addEventListener("progress",A)),_&&O.upload&&([S,I]=ol(_),O.upload.addEventListener("progress",S),O.upload.addEventListener("loadend",I)),(l.cancelToken||l.signal)&&(x=D=>{O&&(o(!D||D.type?new hr(null,e,O):D),O.abort(),O=null)},l.cancelToken&&l.cancelToken.subscribe(x),l.signal&&(l.signal.aborted?x():l.signal.addEventListener("abort",x)));const P=UC(l.url);if(P&&ei.protocols.indexOf(P)===-1){o(new pt("Unsupported protocol "+P+":",pt.ERR_BAD_REQUEST,e));return}O.send(c||null)})},$C=(e,s)=>{let r=new AbortController,o;const l=function(_){if(!o){o=!0,f();const v=_ instanceof Error?_:this.reason;r.abort(v instanceof pt?v:new hr(v instanceof Error?v.message:v))}};let c=s&&setTimeout(()=>{l(new pt(`timeout ${s} of ms exceeded`,pt.ETIMEDOUT))},s);const f=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(_=>{_&&(_.removeEventListener?_.removeEventListener("abort",l):_.unsubscribe(l))}),e=null)};e.forEach(_=>_&&_.addEventListener&&_.addEventListener("abort",l));const{signal:g}=r;return g.unsubscribe=f,[g,()=>{c&&clearTimeout(c),c=null}]},QC=function*(e,s){let r=e.byteLength;if(!s||r<s){yield e;return}let o=0,l;for(;o<r;)l=o+s,yield e.slice(o,l),o=l},qC=async function*(e,s,r){for await(const o of e)yield*QC(ArrayBuffer.isView(o)?o:await r(String(o)),s)},Eg=(e,s,r,o,l)=>{const c=qC(e,s,l);let f=0,g,_=v=>{g||(g=!0,o&&o(v))};return new ReadableStream({async pull(v){try{const{done:x,value:S}=await c.next();if(x){_(),v.close();return}let A=S.byteLength;if(r){let I=f+=A;r(I)}v.enqueue(new Uint8Array(S))}catch(x){throw _(x),x}},cancel(v){return _(v),c.return()}},{highWaterMark:2})},Rl=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Lv=Rl&&typeof ReadableStream=="function",pu=Rl&&(typeof TextEncoder=="function"?(e=>s=>e.encode(s))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Ov=(e,...s)=>{try{return!!e(...s)}catch{return!1}},ZC=Lv&&Ov(()=>{let e=!1;const s=new Request(ei.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!s}),Ag=64*1024,gu=Lv&&Ov(()=>V.isReadableStream(new Response("").body)),al={stream:gu&&(e=>e.body)};Rl&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(s=>{!al[s]&&(al[s]=V.isFunction(e[s])?r=>r[s]():(r,o)=>{throw new pt(`Response type '${s}' is not supported`,pt.ERR_NOT_SUPPORT,o)})})})(new Response);const KC=async e=>{if(e==null)return 0;if(V.isBlob(e))return e.size;if(V.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(V.isArrayBufferView(e)||V.isArrayBuffer(e))return e.byteLength;if(V.isURLSearchParams(e)&&(e=e+""),V.isString(e))return(await pu(e)).byteLength},JC=async(e,s)=>{const r=V.toFiniteNumber(e.getContentLength());return r??KC(s)},t1=Rl&&(async e=>{let{url:s,method:r,data:o,signal:l,cancelToken:c,timeout:f,onDownloadProgress:g,onUploadProgress:_,responseType:v,headers:x,withCredentials:S="same-origin",fetchOptions:A}=Mv(e);v=v?(v+"").toLowerCase():"text";let[I,F]=l||c||f?$C([l,c],f):[],L,O;const T=()=>{!L&&setTimeout(()=>{I&&I.unsubscribe()}),L=!0};let P;try{if(_&&ZC&&r!=="get"&&r!=="head"&&(P=await JC(x,o))!==0){let E=new Request(s,{method:"POST",body:o,duplex:"half"}),B;if(V.isFormData(o)&&(B=E.headers.get("content-type"))&&x.setContentType(B),E.body){const[G,rt]=bg(P,ol(Cg(_)));o=Eg(E.body,Ag,G,rt,pu)}}V.isString(S)||(S=S?"include":"omit");const D="credentials"in Request.prototype;O=new Request(s,{...A,signal:I,method:r.toUpperCase(),headers:x.normalize().toJSON(),body:o,duplex:"half",credentials:D?S:void 0});let W=await fetch(O);const j=gu&&(v==="stream"||v==="response");if(gu&&(g||j)){const E={};["status","statusText","headers"].forEach(at=>{E[at]=W[at]});const B=V.toFiniteNumber(W.headers.get("content-length")),[G,rt]=g&&bg(B,ol(Cg(g),!0))||[];W=new Response(Eg(W.body,Ag,G,()=>{rt&&rt(),j&&T()},pu),E)}v=v||"text";let K=await al[V.findKey(al,v)||"text"](W,e);return!j&&T(),F&&F(),await new Promise((E,B)=>{Fv(E,B,{data:K,headers:Xe.from(W.headers),status:W.status,statusText:W.statusText,config:e,request:O})})}catch(D){throw T(),D&&D.name==="TypeError"&&/fetch/i.test(D.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,e,O),{cause:D.cause||D}):pt.from(D,D&&D.code,e,O)}}),mu={http:_C,xhr:YC,fetch:t1};V.forEach(mu,(e,s)=>{if(e){try{Object.defineProperty(e,"name",{value:s})}catch{}Object.defineProperty(e,"adapterName",{value:s})}});const Tg=e=>`- ${e}`,e1=e=>V.isFunction(e)||e===null||e===!1,Nv={getAdapter:e=>{e=V.isArray(e)?e:[e];const{length:s}=e;let r,o;const l={};for(let c=0;c<s;c++){r=e[c];let f;if(o=r,!e1(r)&&(o=mu[(f=String(r)).toLowerCase()],o===void 0))throw new pt(`Unknown adapter '${f}'`);if(o)break;l[f||"#"+c]=o}if(!o){const c=Object.entries(l).map(([g,_])=>`adapter ${g} `+(_===!1?"is not supported by the environment":"is not available in the build"));let f=s?c.length>1?`since :
`+c.map(Tg).join(`
`):" "+Tg(c[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+f,"ERR_NOT_SUPPORT")}return o},adapters:mu};function fc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new hr(null,e)}function Pg(e){return fc(e),e.headers=Xe.from(e.headers),e.data=dc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Nv.getAdapter(e.adapter||Ao.adapter)(e).then(function(o){return fc(e),o.data=dc.call(e,e.transformResponse,o),o.headers=Xe.from(o.headers),o},function(o){return kv(o)||(fc(e),o&&o.response&&(o.response.data=dc.call(e,e.transformResponse,o.response),o.response.headers=Xe.from(o.response.headers))),Promise.reject(o)})}const Uv="1.7.5",xd={};["object","boolean","number","function","string","symbol"].forEach((e,s)=>{xd[e]=function(o){return typeof o===e||"a"+(s<1?"n ":" ")+e}});const Rg={};xd.transitional=function(s,r,o){function l(c,f){return"[Axios v"+Uv+"] Transitional option '"+c+"'"+f+(o?". "+o:"")}return(c,f,g)=>{if(s===!1)throw new pt(l(f," has been removed"+(r?" in "+r:"")),pt.ERR_DEPRECATED);return r&&!Rg[f]&&(Rg[f]=!0,console.warn(l(f," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(c,f,g):!0}};function i1(e,s,r){if(typeof e!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let l=o.length;for(;l-- >0;){const c=o[l],f=s[c];if(f){const g=e[c],_=g===void 0||f(g,c,e);if(_!==!0)throw new pt("option "+c+" must be "+_,pt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new pt("Unknown option "+c,pt.ERR_BAD_OPTION)}}const _u={assertOptions:i1,validators:xd},as=_u.validators;class en{constructor(s){this.defaults=s,this.interceptors={request:new wg,response:new wg}}async request(s,r){try{return await this._request(s,r)}catch(o){if(o instanceof Error){let l;Error.captureStackTrace?Error.captureStackTrace(l={}):l=new Error;const c=l.stack?l.stack.replace(/^.+\n/,""):"";try{o.stack?c&&!String(o.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+c):o.stack=c}catch{}}throw o}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=hn(this.defaults,r);const{transitional:o,paramsSerializer:l,headers:c}=r;o!==void 0&&_u.assertOptions(o,{silentJSONParsing:as.transitional(as.boolean),forcedJSONParsing:as.transitional(as.boolean),clarifyTimeoutError:as.transitional(as.boolean)},!1),l!=null&&(V.isFunction(l)?r.paramsSerializer={serialize:l}:_u.assertOptions(l,{encode:as.function,serialize:as.function},!0)),r.method=(r.method||this.defaults.method||"get").toLowerCase();let f=c&&V.merge(c.common,c[r.method]);c&&V.forEach(["delete","get","head","post","put","patch","common"],F=>{delete c[F]}),r.headers=Xe.concat(f,c);const g=[];let _=!0;this.interceptors.request.forEach(function(L){typeof L.runWhen=="function"&&L.runWhen(r)===!1||(_=_&&L.synchronous,g.unshift(L.fulfilled,L.rejected))});const v=[];this.interceptors.response.forEach(function(L){v.push(L.fulfilled,L.rejected)});let x,S=0,A;if(!_){const F=[Pg.bind(this),void 0];for(F.unshift.apply(F,g),F.push.apply(F,v),A=F.length,x=Promise.resolve(r);S<A;)x=x.then(F[S++],F[S++]);return x}A=g.length;let I=r;for(S=0;S<A;){const F=g[S++],L=g[S++];try{I=F(I)}catch(O){L.call(this,O);break}}try{x=Pg.call(this,I)}catch(F){return Promise.reject(F)}for(S=0,A=v.length;S<A;)x=x.then(v[S++],v[S++]);return x}getUri(s){s=hn(this.defaults,s);const r=Bv(s.baseURL,s.url);return Rv(r,s.params,s.paramsSerializer)}}V.forEach(["delete","get","head","options"],function(s){en.prototype[s]=function(r,o){return this.request(hn(o||{},{method:s,url:r,data:(o||{}).data}))}});V.forEach(["post","put","patch"],function(s){function r(o){return function(c,f,g){return this.request(hn(g||{},{method:s,headers:o?{"Content-Type":"multipart/form-data"}:{},url:c,data:f}))}}en.prototype[s]=r(),en.prototype[s+"Form"]=r(!0)});class bd{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(c){r=c});const o=this;this.promise.then(l=>{if(!o._listeners)return;let c=o._listeners.length;for(;c-- >0;)o._listeners[c](l);o._listeners=null}),this.promise.then=l=>{let c;const f=new Promise(g=>{o.subscribe(g),c=g}).then(l);return f.cancel=function(){o.unsubscribe(c)},f},s(function(c,f,g){o.reason||(o.reason=new hr(c,f,g),r(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}static source(){let s;return{token:new bd(function(l){s=l}),cancel:s}}}function s1(e){return function(r){return e.apply(null,r)}}function n1(e){return V.isObject(e)&&e.isAxiosError===!0}const vu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(vu).forEach(([e,s])=>{vu[s]=e});function zv(e){const s=new en(e),r=_v(en.prototype.request,s);return V.extend(r,en.prototype,s,{allOwnKeys:!0}),V.extend(r,s,null,{allOwnKeys:!0}),r.create=function(l){return zv(hn(e,l))},r}const qt=zv(Ao);qt.Axios=en;qt.CanceledError=hr;qt.CancelToken=bd;qt.isCancel=kv;qt.VERSION=Uv;qt.toFormData=Pl;qt.AxiosError=pt;qt.Cancel=qt.CanceledError;qt.all=function(s){return Promise.all(s)};qt.spread=s1;qt.isAxiosError=n1;qt.mergeConfig=hn;qt.AxiosHeaders=Xe;qt.formToJSON=e=>Dv(V.isHTMLForm(e)?new FormData(e):e);qt.getAdapter=Nv.getAdapter;qt.HttpStatusCode=vu;qt.default=qt;const Hv=Q.createContext(void 0),Wv=()=>{const e=Q.useContext(Hv);if(!e)throw new Error("useSession must be used within a SessionProvider");return e},r1=({children:e})=>{const[s,r]=Q.useState({playFabId:null,data:{}}),o=f=>{r(g=>({...g,playFabId:f}))},l=(f,g)=>{r(_=>{const v=typeof f=="object"?{...f}:{[f]:g},x={playFabId:_.playFabId,data:v};return c(x),{..._,data:{..._.data,...v}}})},c=async f=>{try{const _=await qt.put("https://ec51-103-225-136-38.ngrok-free.app"+"/playFab/update/userData",f);console.log("Data successfully sent to server:",_.data)}catch(g){console.error("Error sending data to the server:",g)}};return Z.jsx(Hv.Provider,{value:{sessionData:s,setPlayFabId:o,setData:l},children:e})};function o1(){var dt,Et;const f=Q.useContext(Sd),{setData:g}=Wv(),[_]=Q.useState(6e3),[v,x]=Q.useState(0),[S,A]=Q.useState(1),[I,F]=Q.useState(1e3),[L,O]=Q.useState(I),[T,P]=Q.useState(I),[D,W]=Q.useState(6),[j,K]=Q.useState(25),[E,B]=Q.useState(1e3),[G,rt]=Q.useState([]),at=v<j,J=v<E,Nt=T==0||L>=I,Zt=Nt?D==6||L>=I?"Energy Full":`${D}/6`:`${D}/6`,wt=ht=>{rt(Ut=>Ut.filter(Gt=>Gt.id!==ht))},et=(ht,Ut)=>{L>=S&&(x(Gt=>Gt+S),O(Gt=>Gt-S),rt(Gt=>[...Gt,{id:Date.now(),value:S,x:ht,y:Ut}]))},fi=()=>{L<I&&(W(ht=>{const Ut=ht-1;return g("refill",Ut),Ut}),O(ht=>ht+I),P(ht=>ht-1))},st=()=>{v>=E&&(F(ht=>{const Ut=ht+1e3;return g("energyLimit",Ut),Ut}),B(ht=>{const Ut=ht*2;return g("energyUpgradeCost",Ut),Ut}))},lt=()=>{v>=j&&(A(ht=>ht+1),x(ht=>ht-j),K(ht=>ht*2),g({tapUpgradeCost:j,tapValue:S}))};return Q.useEffect(()=>{const ht=Math.floor(1.6666666666666667),Ut=setInterval(()=>{x(Gt=>Gt+ht)},1e3);return()=>clearInterval(Ut)},[6e3]),Z.jsxs("div",{className:"flex flex-1 grow flex-col justify-between text-white",children:[Z.jsx(Eb,{score:v}),Z.jsxs("section",{className:"align-center flex justify-center gap-2",children:[Z.jsx(hc,{caption:Zt,onClick:fi,disabled:Nt,children:"Refill Energy"}),Z.jsx(hc,{caption:`${E} pts to Upgrade`,onClick:st,disabled:J,children:"Upgrade Energy Limit"}),Z.jsx(hc,{caption:`${j} pts to Upgrade`,onClick:lt,disabled:at,children:"Upgrade Tap Value"})]}),Z.jsx(Rb,{energy:L,limit:I}),Z.jsx(Sb,{onTap:et,children:G.map(ht=>Z.jsx(Ab,{number:ht.value,x:ht.x,y:ht.y,onAnimationEnd:()=>wt(ht.id)},ht.id))}),Z.jsxs("section",{className:"flex flex-row justify-between px-3 pb-3",children:[Z.jsxs("div",{className:"level-progress",children:[Z.jsx("div",{className:"text-md font-bold",children:((Et=(dt=f==null?void 0:f.tgData)==null?void 0:dt.initDataUnsafe)==null?void 0:Et.user.username)??"Guest"}),Z.jsx(Db,{tokens:v})]}),Z.jsx(Ib,{token:_})]})]})}/*!
 * excalibur - 0.29.3 - 2024-5-5
 * https://github.com/excaliburjs/Excalibur
 * Copyright (c) 2024 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>
 * Licensed BSD-2-Clause
 * @preserve
 */var a1={8851:(e,s,r)=>{r.d(s,{A:()=>_});var o=r(2001),l=r.n(o),c=r(935),f=r.n(c),g=f()(l());g.push([e.id,`/* Buttons styles start */

button#excalibur-play {
  display: inline-block;
  position: relative;
  z-index: 999;
  border-radius: 6px;
  border: none;
  /*border: 3px solid;
    border-color: white;
    box-shadow: 0 0 10px #ccc;*/
  padding: 1rem 1.5rem 1rem 4rem;
  margin: 0;
  text-decoration: none;
  background: #00b233;
  color: #ffffff;
  font-family: sans-serif;
  font-size: 2rem;
  white-space: nowrap;
  line-height: 1;
  cursor: pointer;
  text-align: center;
  transition: background 250ms ease-in-out, transform 150ms ease;
  -webkit-appearance: none;
  -moz-appearance: none;

  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */
  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */
  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */
  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */
  animation: excalibur-button-fadein 200ms;
}

/*
button#excalibur-play {
  display: none;
}*/

button#excalibur-play:after {
  position: absolute;
  content: '';
  border: 8px solid;
  border-color: transparent transparent transparent white;
  left: 35px;
  top: 24px;
  width: 0;
  height: 0;
}

button#excalibur-play:before {
  position: absolute;
  content: '';
  border: 3px solid;
  left: 19px;
  top: 14px;
  border-radius: 20px;
  width: 30px;
  height: 30px;
}

button#excalibur-play:hover,
button#excalibur-play:focus {
  background: #00982c;
}

button#excalibur-play:focus {
  outline: 1px solid #fff;
  outline-offset: -4px;
}

button#excalibur-play:active {
  transform: scale(0.99);
}

@keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Firefox < 16 */
@-moz-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Safari, Chrome and Opera > 12.1 */
@-webkit-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Internet Explorer */
@-ms-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Opera < 12.1 */
@-o-keyframes excalibur-button-fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
`,"",{version:3,sources:["webpack://./Director/Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:[`/* Buttons styles start */\r
\r
button#excalibur-play {\r
  display: inline-block;\r
  position: relative;\r
  z-index: 999;\r
  border-radius: 6px;\r
  border: none;\r
  /*border: 3px solid;\r
    border-color: white;\r
    box-shadow: 0 0 10px #ccc;*/\r
  padding: 1rem 1.5rem 1rem 4rem;\r
  margin: 0;\r
  text-decoration: none;\r
  background: #00b233;\r
  color: #ffffff;\r
  font-family: sans-serif;\r
  font-size: 2rem;\r
  white-space: nowrap;\r
  line-height: 1;\r
  cursor: pointer;\r
  text-align: center;\r
  transition: background 250ms ease-in-out, transform 150ms ease;\r
  -webkit-appearance: none;\r
  -moz-appearance: none;\r
\r
  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r
  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r
  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r
  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r
  animation: excalibur-button-fadein 200ms;\r
}\r
\r
/*\r
button#excalibur-play {\r
  display: none;\r
}*/\r
\r
button#excalibur-play:after {\r
  position: absolute;\r
  content: '';\r
  border: 8px solid;\r
  border-color: transparent transparent transparent white;\r
  left: 35px;\r
  top: 24px;\r
  width: 0;\r
  height: 0;\r
}\r
\r
button#excalibur-play:before {\r
  position: absolute;\r
  content: '';\r
  border: 3px solid;\r
  left: 19px;\r
  top: 14px;\r
  border-radius: 20px;\r
  width: 30px;\r
  height: 30px;\r
}\r
\r
button#excalibur-play:hover,\r
button#excalibur-play:focus {\r
  background: #00982c;\r
}\r
\r
button#excalibur-play:focus {\r
  outline: 1px solid #fff;\r
  outline-offset: -4px;\r
}\r
\r
button#excalibur-play:active {\r
  transform: scale(0.99);\r
}\r
\r
@keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Firefox < 16 */\r
@-moz-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Safari, Chrome and Opera > 12.1 */\r
@-webkit-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Internet Explorer */\r
@-ms-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Opera < 12.1 */\r
@-o-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
`],sourceRoot:""}]);const _=g},4296:(e,s,r)=>{r.d(s,{A:()=>_});var o=r(2001),l=r.n(o),c=r(935),f=r.n(c),g=f()(l());g.push([e.id,`
#ex-toast-container {
  position: absolute;
  height: 0;
  min-width: 50%;
  left: 50%;
  top: 0;
}

.ex-toast-message {
  left: -50%;
  position: relative;
  display: flex;
  justify-content: space-between;


  padding: 10px;
  margin-top: 5px;
  font-size: 18px;
  font-family: sans-serif;
  border-radius: 6px;
  border: 3px solid #b7b779;
  background-color: rgb(253, 253, 192);
}


.ex-toast-message button {
  align-self: flex-start;
}`,"",{version:3,sources:["webpack://./Util/Toaster.css"],names:[],mappings:";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB",sourcesContent:[`\r
#ex-toast-container {\r
  position: absolute;\r
  height: 0;\r
  min-width: 50%;\r
  left: 50%;\r
  top: 0;\r
}\r
\r
.ex-toast-message {\r
  left: -50%;\r
  position: relative;\r
  display: flex;\r
  justify-content: space-between;\r
\r
\r
  padding: 10px;\r
  margin-top: 5px;\r
  font-size: 18px;\r
  font-family: sans-serif;\r
  border-radius: 6px;\r
  border: 3px solid #b7b779;\r
  background-color: rgb(253, 253, 192);\r
}\r
\r
\r
.ex-toast-message button {\r
  align-self: flex-start;\r
}`],sourceRoot:""}]);const _=g},935:e=>{e.exports=function(s){var r=[];return r.toString=function(){return this.map(function(l){var c="",f=typeof l[5]<"u";return l[4]&&(c+="@supports (".concat(l[4],") {")),l[2]&&(c+="@media ".concat(l[2]," {")),f&&(c+="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {")),c+=s(l),f&&(c+="}"),l[2]&&(c+="}"),l[4]&&(c+="}"),c}).join("")},r.i=function(l,c,f,g,_){typeof l=="string"&&(l=[[null,l,void 0]]);var v={};if(f)for(var x=0;x<this.length;x++){var S=this[x][0];S!=null&&(v[S]=!0)}for(var A=0;A<l.length;A++){var I=[].concat(l[A]);f&&v[I[0]]||(typeof _<"u"&&(typeof I[5]>"u"||(I[1]="@layer".concat(I[5].length>0?" ".concat(I[5]):""," {").concat(I[1],"}")),I[5]=_),c&&(I[2]&&(I[1]="@media ".concat(I[2]," {").concat(I[1],"}")),I[2]=c),g&&(I[4]?(I[1]="@supports (".concat(I[4],") {").concat(I[1],"}"),I[4]=g):I[4]="".concat(g)),r.push(I))}},r}},2001:e=>{e.exports=function(s){var r=s[1],o=s[3];if(!o)return r;if(typeof btoa=="function"){var l=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),f="/*# ".concat(c," */");return[r].concat([f]).join(`
`)}return[r].join(`
`)}},9493:(e,s,r)=>{r(3975);var o=r(2564);e.exports=o("Array","sort")},311:(e,s,r)=>{r(8291);var o=r(9120);e.exports=o.Object.keys},4977:(e,s,r)=>{var o=r(4188),l=r(3174),c=TypeError;e.exports=function(f){if(o(f))return f;throw new c(l(f)+" is not a function")}},3770:(e,s,r)=>{var o=r(831),l=String,c=TypeError;e.exports=function(f){if(o(f))return f;throw new c(l(f)+" is not an object")}},1458:(e,s,r)=>{var o=r(380),l=r(675),c=r(9389),f=function(g){return function(_,v,x){var S=o(_),A=c(S);if(A===0)return!g&&-1;var I=l(x,A),F;if(g&&v!==v){for(;A>I;)if(F=S[I++],F!==F)return!0}else for(;A>I;I++)if((g||I in S)&&S[I]===v)return g||I||0;return!g&&-1}};e.exports={includes:f(!0),indexOf:f(!1)}},5397:(e,s,r)=>{var o=r(5234);e.exports=function(l,c){var f=[][l];return!!f&&o(function(){f.call(null,c||function(){return 1},1)})}},7825:(e,s,r)=>{var o=r(6881);e.exports=o([].slice)},9295:(e,s,r)=>{var o=r(7825),l=Math.floor,c=function(f,g){var _=f.length;if(_<8)for(var v=1,x,S;v<_;){for(S=v,x=f[v];S&&g(f[S-1],x)>0;)f[S]=f[--S];S!==v++&&(f[S]=x)}else for(var A=l(_/2),I=c(o(f,0,A),g),F=c(o(f,A),g),L=I.length,O=F.length,T=0,P=0;T<L||P<O;)f[T+P]=T<L&&P<O?g(I[T],F[P])<=0?I[T++]:F[P++]:T<L?I[T++]:F[P++];return f};e.exports=c},8689:(e,s,r)=>{var o=r(6881),l=o({}.toString),c=o("".slice);e.exports=function(f){return c(l(f),8,-1)}},5438:(e,s,r)=>{var o=r(9345),l=r(4188),c=r(8689),f=r(4282),g=f("toStringTag"),_=Object,v=c(function(){return arguments}())==="Arguments",x=function(S,A){try{return S[A]}catch{}};e.exports=o?c:function(S){var A,I,F;return S===void 0?"Undefined":S===null?"Null":typeof(I=x(A=_(S),g))=="string"?I:v?c(A):(F=c(A))==="Object"&&l(A.callee)?"Arguments":F}},8657:(e,s,r)=>{var o=r(4418),l=r(3168),c=r(9304),f=r(4466);e.exports=function(g,_,v){for(var x=l(_),S=f.f,A=c.f,I=0;I<x.length;I++){var F=x[I];!o(g,F)&&!(v&&o(v,F))&&S(g,F,A(_,F))}}},8088:(e,s,r)=>{var o=r(6893),l=r(4466),c=r(9123);e.exports=o?function(f,g,_){return l.f(f,g,c(1,_))}:function(f,g,_){return f[g]=_,f}},9123:e=>{e.exports=function(s,r){return{enumerable:!(s&1),configurable:!(s&2),writable:!(s&4),value:r}}},7509:(e,s,r)=>{var o=r(4188),l=r(4466),c=r(4530),f=r(4798);e.exports=function(g,_,v,x){x||(x={});var S=x.enumerable,A=x.name!==void 0?x.name:_;if(o(v)&&c(v,A,x),x.global)S?g[_]=v:f(_,v);else{try{x.unsafe?g[_]&&(S=!0):delete g[_]}catch{}S?g[_]=v:l.f(g,_,{value:v,enumerable:!1,configurable:!x.nonConfigurable,writable:!x.nonWritable})}return g}},4798:(e,s,r)=>{var o=r(1488),l=Object.defineProperty;e.exports=function(c,f){try{l(o,c,{value:f,configurable:!0,writable:!0})}catch{o[c]=f}return f}},1305:(e,s,r)=>{var o=r(3174),l=TypeError;e.exports=function(c,f){if(!delete c[f])throw new l("Cannot delete property "+o(f)+" of "+o(c))}},6893:(e,s,r)=>{var o=r(5234);e.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},5926:(e,s,r)=>{var o=r(1488),l=r(831),c=o.document,f=l(c)&&l(c.createElement);e.exports=function(g){return f?c.createElement(g):{}}},8807:(e,s,r)=>{var o=r(4109),l=o.match(/firefox\/(\d+)/i);e.exports=!!l&&+l[1]},5661:(e,s,r)=>{var o=r(4109);e.exports=/MSIE|Trident/.test(o)},4109:e=>{e.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},3749:(e,s,r)=>{var o=r(1488),l=r(4109),c=o.process,f=o.Deno,g=c&&c.versions||f&&f.version,_=g&&g.v8,v,x;_&&(v=_.split("."),x=v[0]>0&&v[0]<4?1:+(v[0]+v[1])),!x&&l&&(v=l.match(/Edge\/(\d+)/),(!v||v[1]>=74)&&(v=l.match(/Chrome\/(\d+)/),v&&(x=+v[1]))),e.exports=x},3589:(e,s,r)=>{var o=r(4109),l=o.match(/AppleWebKit\/(\d+)\./);e.exports=!!l&&+l[1]},2564:(e,s,r)=>{var o=r(1488),l=r(6881);e.exports=function(c,f){return l(o[c].prototype[f])}},1274:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},5613:(e,s,r)=>{var o=r(1488),l=r(9304).f,c=r(8088),f=r(7509),g=r(4798),_=r(8657),v=r(8489);e.exports=function(x,S){var A=x.target,I=x.global,F=x.stat,L,O,T,P,D,W;if(I?O=o:F?O=o[A]||g(A,{}):O=o[A]&&o[A].prototype,O)for(T in S){if(D=S[T],x.dontCallGetSet?(W=l(O,T),P=W&&W.value):P=O[T],L=v(I?T:A+(F?".":"#")+T,x.forced),!L&&P!==void 0){if(typeof D==typeof P)continue;_(D,P)}(x.sham||P&&P.sham)&&c(D,"sham",!0),f(O,T,D,x)}}},5234:e=>{e.exports=function(s){try{return!!s()}catch{return!0}}},9055:(e,s,r)=>{var o=r(5234);e.exports=!o(function(){var l=(function(){}).bind();return typeof l!="function"||l.hasOwnProperty("prototype")})},9944:(e,s,r)=>{var o=r(9055),l=Function.prototype.call;e.exports=o?l.bind(l):function(){return l.apply(l,arguments)}},2735:(e,s,r)=>{var o=r(6893),l=r(4418),c=Function.prototype,f=o&&Object.getOwnPropertyDescriptor,g=l(c,"name"),_=g&&(function(){}).name==="something",v=g&&(!o||o&&f(c,"name").configurable);e.exports={EXISTS:g,PROPER:_,CONFIGURABLE:v}},6881:(e,s,r)=>{var o=r(9055),l=Function.prototype,c=l.call,f=o&&l.bind.bind(c,c);e.exports=o?f:function(g){return function(){return c.apply(g,arguments)}}},5604:(e,s,r)=>{var o=r(1488),l=r(4188),c=function(f){return l(f)?f:void 0};e.exports=function(f,g){return arguments.length<2?c(o[f]):o[f]&&o[f][g]}},2913:(e,s,r)=>{var o=r(4977),l=r(4318);e.exports=function(c,f){var g=c[f];return l(g)?void 0:o(g)}},1488:function(e,s,r){var o=function(l){return l&&l.Math===Math&&l};e.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof r.g=="object"&&r.g)||o(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},4418:(e,s,r)=>{var o=r(6881),l=r(3628),c=o({}.hasOwnProperty);e.exports=Object.hasOwn||function(g,_){return c(l(g),_)}},7588:e=>{e.exports={}},9622:(e,s,r)=>{var o=r(6893),l=r(5234),c=r(5926);e.exports=!o&&!l(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!==7})},7568:(e,s,r)=>{var o=r(6881),l=r(5234),c=r(8689),f=Object,g=o("".split);e.exports=l(function(){return!f("z").propertyIsEnumerable(0)})?function(_){return c(_)==="String"?g(_,""):f(_)}:f},3029:(e,s,r)=>{var o=r(6881),l=r(4188),c=r(2694),f=o(Function.toString);l(c.inspectSource)||(c.inspectSource=function(g){return f(g)}),e.exports=c.inspectSource},3086:(e,s,r)=>{var o=r(5945),l=r(1488),c=r(831),f=r(8088),g=r(4418),_=r(2694),v=r(168),x=r(7588),S="Object already initialized",A=l.TypeError,I=l.WeakMap,F,L,O,T=function(j){return O(j)?L(j):F(j,{})},P=function(j){return function(K){var E;if(!c(K)||(E=L(K)).type!==j)throw new A("Incompatible receiver, "+j+" required");return E}};if(o||_.state){var D=_.state||(_.state=new I);D.get=D.get,D.has=D.has,D.set=D.set,F=function(j,K){if(D.has(j))throw new A(S);return K.facade=j,D.set(j,K),K},L=function(j){return D.get(j)||{}},O=function(j){return D.has(j)}}else{var W=v("state");x[W]=!0,F=function(j,K){if(g(j,W))throw new A(S);return K.facade=j,f(j,W,K),K},L=function(j){return g(j,W)?j[W]:{}},O=function(j){return g(j,W)}}e.exports={set:F,get:L,has:O,enforce:T,getterFor:P}},4188:e=>{var s=typeof document=="object"&&document.all;e.exports=typeof s>"u"&&s!==void 0?function(r){return typeof r=="function"||r===s}:function(r){return typeof r=="function"}},8489:(e,s,r)=>{var o=r(5234),l=r(4188),c=/#|\.prototype\./,f=function(S,A){var I=_[g(S)];return I===x?!0:I===v?!1:l(A)?o(A):!!A},g=f.normalize=function(S){return String(S).replace(c,".").toLowerCase()},_=f.data={},v=f.NATIVE="N",x=f.POLYFILL="P";e.exports=f},4318:e=>{e.exports=function(s){return s==null}},831:(e,s,r)=>{var o=r(4188);e.exports=function(l){return typeof l=="object"?l!==null:o(l)}},1942:e=>{e.exports=!1},6032:(e,s,r)=>{var o=r(5604),l=r(4188),c=r(4578),f=r(9809),g=Object;e.exports=f?function(_){return typeof _=="symbol"}:function(_){var v=o("Symbol");return l(v)&&c(v.prototype,g(_))}},9389:(e,s,r)=>{var o=r(7611);e.exports=function(l){return o(l.length)}},4530:(e,s,r)=>{var o=r(6881),l=r(5234),c=r(4188),f=r(4418),g=r(6893),_=r(2735).CONFIGURABLE,v=r(3029),x=r(3086),S=x.enforce,A=x.get,I=String,F=Object.defineProperty,L=o("".slice),O=o("".replace),T=o([].join),P=g&&!l(function(){return F(function(){},"length",{value:8}).length!==8}),D=String(String).split("String"),W=e.exports=function(j,K,E){L(I(K),0,7)==="Symbol("&&(K="["+O(I(K),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),E&&E.getter&&(K="get "+K),E&&E.setter&&(K="set "+K),(!f(j,"name")||_&&j.name!==K)&&(g?F(j,"name",{value:K,configurable:!0}):j.name=K),P&&E&&f(E,"arity")&&j.length!==E.arity&&F(j,"length",{value:E.arity});try{E&&f(E,"constructor")&&E.constructor?g&&F(j,"prototype",{writable:!1}):j.prototype&&(j.prototype=void 0)}catch{}var B=S(j);return f(B,"source")||(B.source=T(D,typeof K=="string"?K:"")),j};Function.prototype.toString=W(function(){return c(this)&&A(this).source||v(this)},"toString")},142:e=>{var s=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(l){var c=+l;return(c>0?r:s)(c)}},4466:(e,s,r)=>{var o=r(6893),l=r(9622),c=r(3315),f=r(3770),g=r(2344),_=TypeError,v=Object.defineProperty,x=Object.getOwnPropertyDescriptor,S="enumerable",A="configurable",I="writable";s.f=o?c?function(L,O,T){if(f(L),O=g(O),f(T),typeof L=="function"&&O==="prototype"&&"value"in T&&I in T&&!T[I]){var P=x(L,O);P&&P[I]&&(L[O]=T.value,T={configurable:A in T?T[A]:P[A],enumerable:S in T?T[S]:P[S],writable:!1})}return v(L,O,T)}:v:function(L,O,T){if(f(L),O=g(O),f(T),l)try{return v(L,O,T)}catch{}if("get"in T||"set"in T)throw new _("Accessors not supported");return"value"in T&&(L[O]=T.value),L}},9304:(e,s,r)=>{var o=r(6893),l=r(9944),c=r(4416),f=r(9123),g=r(380),_=r(2344),v=r(4418),x=r(9622),S=Object.getOwnPropertyDescriptor;s.f=o?S:function(I,F){if(I=g(I),F=_(F),x)try{return S(I,F)}catch{}if(v(I,F))return f(!l(c.f,I,F),I[F])}},5629:(e,s,r)=>{var o=r(1843),l=r(1274),c=l.concat("length","prototype");s.f=Object.getOwnPropertyNames||function(g){return o(g,c)}},156:(e,s)=>{s.f=Object.getOwnPropertySymbols},4578:(e,s,r)=>{var o=r(6881);e.exports=o({}.isPrototypeOf)},1843:(e,s,r)=>{var o=r(6881),l=r(4418),c=r(380),f=r(1458).indexOf,g=r(7588),_=o([].push);e.exports=function(v,x){var S=c(v),A=0,I=[],F;for(F in S)!l(g,F)&&l(S,F)&&_(I,F);for(;x.length>A;)l(S,F=x[A++])&&(~f(I,F)||_(I,F));return I}},7137:(e,s,r)=>{var o=r(1843),l=r(1274);e.exports=Object.keys||function(f){return o(f,l)}},4416:(e,s)=>{var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,l=o&&!r.call({1:2},1);s.f=l?function(f){var g=o(this,f);return!!g&&g.enumerable}:r},2287:(e,s,r)=>{var o=r(9944),l=r(4188),c=r(831),f=TypeError;e.exports=function(g,_){var v,x;if(_==="string"&&l(v=g.toString)&&!c(x=o(v,g))||l(v=g.valueOf)&&!c(x=o(v,g))||_!=="string"&&l(v=g.toString)&&!c(x=o(v,g)))return x;throw new f("Can't convert object to primitive value")}},3168:(e,s,r)=>{var o=r(5604),l=r(6881),c=r(5629),f=r(156),g=r(3770),_=l([].concat);e.exports=o("Reflect","ownKeys")||function(x){var S=c.f(g(x)),A=f.f;return A?_(S,A(x)):S}},9120:(e,s,r)=>{var o=r(1488);e.exports=o},9509:(e,s,r)=>{var o=r(4318),l=TypeError;e.exports=function(c){if(o(c))throw new l("Can't call method on "+c);return c}},168:(e,s,r)=>{var o=r(746),l=r(6209),c=o("keys");e.exports=function(f){return c[f]||(c[f]=l(f))}},2694:(e,s,r)=>{var o=r(1942),l=r(1488),c=r(4798),f="__core-js_shared__",g=e.exports=l[f]||c(f,{});(g.versions||(g.versions=[])).push({version:"3.36.1",mode:o?"pure":"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE",source:"https://github.com/zloirock/core-js"})},746:(e,s,r)=>{var o=r(2694);e.exports=function(l,c){return o[l]||(o[l]=c||{})}},8944:(e,s,r)=>{var o=r(3749),l=r(5234),c=r(1488),f=c.String;e.exports=!!Object.getOwnPropertySymbols&&!l(function(){var g=Symbol("symbol detection");return!f(g)||!(Object(g)instanceof Symbol)||!Symbol.sham&&o&&o<41})},675:(e,s,r)=>{var o=r(6744),l=Math.max,c=Math.min;e.exports=function(f,g){var _=o(f);return _<0?l(_+g,0):c(_,g)}},380:(e,s,r)=>{var o=r(7568),l=r(9509);e.exports=function(c){return o(l(c))}},6744:(e,s,r)=>{var o=r(142);e.exports=function(l){var c=+l;return c!==c||c===0?0:o(c)}},7611:(e,s,r)=>{var o=r(6744),l=Math.min;e.exports=function(c){var f=o(c);return f>0?l(f,9007199254740991):0}},3628:(e,s,r)=>{var o=r(9509),l=Object;e.exports=function(c){return l(o(c))}},290:(e,s,r)=>{var o=r(9944),l=r(831),c=r(6032),f=r(2913),g=r(2287),_=r(4282),v=TypeError,x=_("toPrimitive");e.exports=function(S,A){if(!l(S)||c(S))return S;var I=f(S,x),F;if(I){if(A===void 0&&(A="default"),F=o(I,S,A),!l(F)||c(F))return F;throw new v("Can't convert object to primitive value")}return A===void 0&&(A="number"),g(S,A)}},2344:(e,s,r)=>{var o=r(290),l=r(6032);e.exports=function(c){var f=o(c,"string");return l(f)?f:f+""}},9345:(e,s,r)=>{var o=r(4282),l=o("toStringTag"),c={};c[l]="z",e.exports=String(c)==="[object z]"},2618:(e,s,r)=>{var o=r(5438),l=String;e.exports=function(c){if(o(c)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return l(c)}},3174:e=>{var s=String;e.exports=function(r){try{return s(r)}catch{return"Object"}}},6209:(e,s,r)=>{var o=r(6881),l=0,c=Math.random(),f=o(1 .toString);e.exports=function(g){return"Symbol("+(g===void 0?"":g)+")_"+f(++l+c,36)}},9809:(e,s,r)=>{var o=r(8944);e.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3315:(e,s,r)=>{var o=r(6893),l=r(5234);e.exports=o&&l(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},5945:(e,s,r)=>{var o=r(1488),l=r(4188),c=o.WeakMap;e.exports=l(c)&&/native code/.test(String(c))},4282:(e,s,r)=>{var o=r(1488),l=r(746),c=r(4418),f=r(6209),g=r(8944),_=r(9809),v=o.Symbol,x=l("wks"),S=_?v.for||v:v&&v.withoutSetter||f;e.exports=function(A){return c(x,A)||(x[A]=g&&c(v,A)?v[A]:S("Symbol."+A)),x[A]}},3975:(e,s,r)=>{var o=r(5613),l=r(6881),c=r(4977),f=r(3628),g=r(9389),_=r(1305),v=r(2618),x=r(5234),S=r(9295),A=r(5397),I=r(8807),F=r(5661),L=r(3749),O=r(3589),T=[],P=l(T.sort),D=l(T.push),W=x(function(){T.sort(void 0)}),j=x(function(){T.sort(null)}),K=A("sort"),E=!x(function(){if(L)return L<70;if(!(I&&I>3)){if(F)return!0;if(O)return O<603;var rt="",at,J,Nt,Zt;for(at=65;at<76;at++){switch(J=String.fromCharCode(at),at){case 66:case 69:case 70:case 72:Nt=3;break;case 68:case 71:Nt=4;break;default:Nt=2}for(Zt=0;Zt<47;Zt++)T.push({k:J+Zt,v:Nt})}for(T.sort(function(wt,et){return et.v-wt.v}),Zt=0;Zt<T.length;Zt++)J=T[Zt].k.charAt(0),rt.charAt(rt.length-1)!==J&&(rt+=J);return rt!=="DGBEFHACIJK"}}),B=W||!j||!K||!E,G=function(rt){return function(at,J){return J===void 0?-1:at===void 0?1:rt!==void 0?+rt(at,J)||0:v(at)>v(J)?1:-1}};o({target:"Array",proto:!0,forced:B},{sort:function(at){at!==void 0&&c(at);var J=f(this);if(E)return at===void 0?P(J):P(J,at);var Nt=[],Zt=g(J),wt,et;for(et=0;et<Zt;et++)et in J&&D(Nt,J[et]);for(S(Nt,G(at)),wt=g(Nt),et=0;et<wt;)J[et]=Nt[et++];for(;et<Zt;)_(J,et++);return J}})},8291:(e,s,r)=>{var o=r(5613),l=r(3628),c=r(7137),f=r(5234),g=f(function(){c(1)});o({target:"Object",stat:!0,forced:g},{keys:function(v){return c(l(v))}})}},Ig={};function It(e){var s=Ig[e];if(s!==void 0)return s.exports;var r=Ig[e]={id:e,exports:{}};return a1[e].call(r.exports,r,r.exports,It),r.exports}It.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return It.d(s,{a:s}),s};It.d=(e,s)=>{for(var r in s)It.o(s,r)&&!It.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})};It.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();It.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s);It.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var C={};(()=>{It.d(C,{eKr:()=>ah,yVm:()=>wr,a7j:()=>Vd,U_w:()=>Dh,JF2:()=>oh,htg:()=>xn,HXL:()=>Rf,mcg:()=>th,Agj:()=>Le,u6S:()=>N0,x7M:()=>bt,X55:()=>Pi,m3M:()=>vr,aE5:()=>j0,YJU:()=>mi,eZi:()=>xh,GNv:()=>gn,Y56:()=>An,_0v:()=>Ko,vhs:()=>Yo,Z8b:()=>sf,Yfw:()=>ct,IcQ:()=>et,Rl2:()=>Ho,kgJ:()=>Ph,GTT:()=>Uf,ypY:()=>En,i7d:()=>mf,fQ3:()=>G0,HlI:()=>Do,jlt:()=>Vo,VQc:()=>de,zD7:()=>Rh,I0I:()=>jo,AUF:()=>Ti,JoF:()=>ss,MlA:()=>jt,PZh:()=>Us,qA:()=>gr,CrD:()=>Os,dQK:()=>Ei,D3r:()=>gi,Qpo:()=>No,D9n:()=>Oo,b6v:()=>pr,mvh:()=>Ch,Bpo:()=>ft,Q1f:()=>G,IKv:()=>Of,fcV:()=>js,Glf:()=>Lf,uAl:()=>pi,ElT:()=>ue,MPu:()=>Ef,Z8r:()=>Nt,QSL:()=>Sf,sPV:()=>Lo,nAn:()=>Ns,zCU:()=>Mo,QrV:()=>te,fF9:()=>Cy,xI8:()=>eh,yar:()=>ee,SP7:()=>Nf,oRy:()=>Zo,f5X:()=>Pf,V1c:()=>Fl,Mlx:()=>zf,ZCo:()=>mr,Vy3:()=>Ai,J5p:()=>Hf,mL_:()=>Ae,Guw:()=>rf,VKx:()=>gh,N5j:()=>Ud,pgY:()=>of,OP3:()=>Qo,rl5:()=>Gf,eod:()=>iy,q5Z:()=>Jt,YUC:()=>ph,saR:()=>zo,hvr:()=>Lh,Qol:()=>ef,Wf4:()=>tf,JCs:()=>Rt,gJV:()=>Me,fWD:()=>ff,Va_:()=>Cn,N$8:()=>Pe,_jQ:()=>ry,rxj:()=>nh,rhv:()=>sh,wCu:()=>pe,HAp:()=>W0,Zy1:()=>vf,Qev:()=>oy,bkB:()=>v,wfL:()=>Fo,sVA:()=>s,$Gs:()=>Ol,CJ0:()=>Io,NWh:()=>Wi,tWi:()=>rh,xAj:()=>ih,zWh:()=>nf,i_4:()=>by,iIx:()=>f,c9e:()=>vh,KQV:()=>zs,weH:()=>Ct,jXp:()=>wy,zzY:()=>$o,yRQ:()=>Go,MtE:()=>Wf,rPj:()=>Rr,KLc:()=>_,Fir:()=>_t,V5f:()=>zl,Xj7:()=>Hl,Wud:()=>Ar,FVg:()=>Zl,g5Y:()=>ql,YQB:()=>$l,KPb:()=>Ql,nHK:()=>Er,TX_:()=>vy,r3n:()=>Tr,vYh:()=>zt,hnk:()=>ie,D2R:()=>wn,n1o:()=>Tf,RLG:()=>Jl,fBU:()=>Wd,Adb:()=>Yt,bEs:()=>pn,wCy:()=>Kt,CbD:()=>Ht,x_C:()=>yn,pde:()=>o,pGf:()=>Th,ibQ:()=>Ff,QlN:()=>Wo,shR:()=>Sr,Yjk:()=>If,_u1:()=>ly,OBI:()=>Xf,klh:()=>Pn,s3S:()=>Sh,D$R:()=>Tn,xth:()=>Bo,JU7:()=>ay,h9x:()=>gf,N1A:()=>Bh,e_k:()=>Ee,aHM:()=>Ms,tlv:()=>D0,Vi9:()=>df,ieR:()=>uf,$bb:()=>at,VyI:()=>J,imn:()=>Fd,uqu:()=>oe,QnL:()=>Gt,vnc:()=>lh,wk_:()=>yh,GH0:()=>Ft,_1r:()=>Cf,l0X:()=>Yd,HHX:()=>$d,tjk:()=>Vi,rWe:()=>Bs,j9l:()=>Ld,NVp:()=>jd,cPK:()=>we,XoL:()=>Df,RmF:()=>$e,DXI:()=>qo,tCD:()=>hy,oGn:()=>$f,J3D:()=>Jo,vCJ:()=>Af,f9l:()=>Sn,AQx:()=>ut,v9m:()=>ea,yRJ:()=>kf,EU6:()=>Ah,m3O:()=>Di,Ryz:()=>Ri,OxP:()=>Rn,LEs:()=>Pr,Ec:()=>x,Pi5:()=>ta,gmH:()=>ki,tS:()=>Mh,XxX:()=>ae,bCz:()=>kd,nYS:()=>Fs,yiT:()=>Gl,NHl:()=>vn,mO8:()=>Yl,PXI:()=>Ul,bn5:()=>jl,Ywr:()=>is,cMd:()=>ks,Bs6:()=>Vl,G0k:()=>_n,pyn:()=>Xl,QeM:()=>Nl,aPX:()=>K0,ITP:()=>Wl,BY0:()=>es,MFw:()=>_r,sBn:()=>fr,S3L:()=>In,XKQ:()=>br,ESI:()=>yf,uxz:()=>pf,o8N:()=>A,u_r:()=>mn,RlV:()=>ji,gVA:()=>bh,M_G:()=>yr,GRB:()=>z0,kM6:()=>Gd,dO8:()=>Xd,jgM:()=>Ml,FWq:()=>dr,s3j:()=>e0,hlw:()=>qd,B7e:()=>Qd,H_X:()=>Qe,S_d:()=>Kd,U7E:()=>Zd,Z58:()=>qe,yh2:()=>J0,ff$:()=>Ll,cWi:()=>Zt,NBt:()=>wh,oNz:()=>T0,QlU:()=>Mf,Xey:()=>rs,jft:()=>Ty,Mtr:()=>Ye,ypk:()=>fe,mnM:()=>wt,bAZ:()=>ns,ABN:()=>Od,VK6:()=>I0,kxk:()=>Ps,DT1:()=>Po,FLG:()=>Is,qN_:()=>Ih,Z37:()=>ko,FtL:()=>cf,Z6X:()=>Yf,iQT:()=>oi,ziO:()=>xf,OEF:()=>Ii,uuE:()=>Oe,tiv:()=>Cr,T$Y:()=>jf,EYj:()=>xr,nOB:()=>Xo,Tap:()=>$t,FAs:()=>hf,B_P:()=>lf,aA5:()=>V0,M4G:()=>Hs,l$l:()=>Vf,dLy:()=>Ls,WZP:()=>it,eB6:()=>Fh,nFK:()=>fh,l9z:()=>_f,YOF:()=>X0,yhB:()=>I,J0N:()=>l,Miz:()=>E,Bj4:()=>dh,Rcs:()=>zi,vJ4:()=>Hi,TqC:()=>Hd,nM0:()=>Kl,X1u:()=>Ds,SpZ:()=>Md,DX8:()=>Ws,Yx$:()=>Eh,HK4:()=>bf,SE$:()=>T,qE8:()=>O,Pz7:()=>qf,sX_:()=>g,JuI:()=>F,Nl$:()=>_h,OwT:()=>uy,P$G:()=>gy,mHV:()=>fy,Fx_:()=>_y,WFC:()=>my,aDq:()=>cy,jIg:()=>py,UH3:()=>dy,K6X:()=>U0,C1Y:()=>zd,Aw1:()=>hh,A8$:()=>H0,hsx:()=>Fi,l9E:()=>af,aSf:()=>wf,Zex:()=>Zf,mXP:()=>Ey,vt$:()=>To,hCA:()=>Rs,pjR:()=>vt,U43:()=>j,pSZ:()=>K,y17:()=>W,jVr:()=>Sy,_SZ:()=>L,xWn:()=>P,ehJ:()=>D,t6s:()=>B,Eyn:()=>e});var e={};It.r(e),It.d(e,{getAttributeComponentSize:()=>Id,getAttributePointerType:()=>Dd,getGLTypeFromSource:()=>Rd,getGlTypeSizeBytes:()=>Bl,isAttributeInSource:()=>Pd});var s={};It.r(s),It.d(s,{ActionCompleteEvent:()=>ah,ActionStartEvent:()=>oh,ActivateEvent:()=>th,CollisionEndEvent:()=>gr,CollisionPostSolveEvent:()=>No,CollisionPreSolveEvent:()=>Oo,CollisionStartEvent:()=>pr,ContactEndEvent:()=>Lo,ContactStartEvent:()=>Mo,DeactivateEvent:()=>eh,EnterTriggerEvent:()=>nh,EnterViewPortEvent:()=>sh,EventTypes:()=>Fo,ExitTriggerEvent:()=>rh,ExitViewPortEvent:()=>ih,GameEvent:()=>_t,GameStartEvent:()=>zl,GameStopEvent:()=>Hl,GamepadAxisEvent:()=>Zl,GamepadButtonEvent:()=>ql,GamepadConnectEvent:()=>$l,GamepadDisconnectEvent:()=>Ql,HiddenEvent:()=>Jl,InitializeEvent:()=>yn,KillEvent:()=>Bo,PostCollisionEvent:()=>Fs,PostDebugDrawEvent:()=>Gl,PostDrawEvent:()=>vn,PostFrameEvent:()=>Yl,PostKillEvent:()=>Ul,PostTransformDrawEvent:()=>jl,PostUpdateEvent:()=>is,PreCollisionEvent:()=>ks,PreDebugDrawEvent:()=>Vl,PreDrawEvent:()=>_n,PreFrameEvent:()=>Xl,PreKillEvent:()=>Nl,PreTransformDrawEvent:()=>Wl,PreUpdateEvent:()=>es,VisibleEvent:()=>Kl});var r={};It.r(r),It.d(r,{circle:()=>B0,line:()=>ch,point:()=>k0,roundRect:()=>uh,vector:()=>F0});var o={};It.r(o),It.d(o,{Axes:()=>An,Buttons:()=>En,Gamepad:()=>Ar,Gamepads:()=>Er,KeyEvent:()=>Pn,Keyboard:()=>Sh,Keys:()=>Tn,NativePointerButton:()=>Vi,PointerButton:()=>Di,PointerComponent:()=>Ri,PointerEvent:()=>Rn,PointerEventReceiver:()=>Pr,PointerScope:()=>x,PointerSystem:()=>ta,PointerType:()=>ki,WheelDeltaMode:()=>Ws,WheelEvent:()=>Eh});var l={};It.r(l),It.d(l,{ConsoleAppender:()=>Nt,DrawUtil:()=>r,EasingFunctions:()=>Rt,LogLevel:()=>at,Logger:()=>J,Observable:()=>we,ScreenAppender:()=>Zt,addItemToArray:()=>st,contains:()=>dt,delay:()=>ht,fail:()=>Et,getPosition:()=>fi,omit:()=>Ut,removeItemFromArray:()=>lt}),It(9493),It(311);function c(){if(typeof window>"u"&&(window={audioContext:function(){}}),typeof window<"u"&&!window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(u){window.setInterval(u,1e3/60)}),typeof window<"u"&&!window.cancelAnimationFrame&&(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),typeof window<"u"&&!window.AudioContext){if(window.webkitAudioContext){const t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(i){return new Promise((n,a)=>{t.call(this,i,n,a)})}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}typeof window<"u"&&!window.devicePixelRatio&&(window.devicePixelRatio=window.devicePixelRatio||1)}class f{static useCanvasGraphicsContext(){f.enable("use-canvas-context")}static freeze(){f._FROZEN=!0}static _reset(){f._FROZEN=!1,f._FLAGS={}}static enable(t){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");f._FLAGS[t]=!0}static disable(t){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");f._FLAGS[t]=!1}static isEnabled(t){return!!f._FLAGS[t]}static show(){return Object.keys(f._FLAGS)}}f._FROZEN=!1,f._FLAGS={};function g(u,t){return{type:u,value:t}}class _{constructor(){this._isCompleted=!1,this.promise=new Promise((t,i)=>{this._resolver=t,this._rejecter=i})}get isCompleted(){return this._isCompleted}resolve(t){this._isCompleted||(this._isCompleted=!0,this._resolver(t))}reject(t){this._isCompleted||(this._isCompleted=!0,this._rejecter(t))}}class v{constructor(){this._paused=!1,this._listeners={},this._listenersOnce={},this._pipes=[]}clear(){this._listeners={},this._listenersOnce={},this._pipes.length=0}on(t,i){var n;return this._listeners[t]=(n=this._listeners[t])!==null&&n!==void 0?n:[],this._listeners[t].push(i),{close:()=>this.off(t,i)}}once(t,i){var n;return this._listenersOnce[t]=(n=this._listenersOnce[t])!==null&&n!==void 0?n:[],this._listenersOnce[t].push(i),{close:()=>this.off(t,i)}}off(t,i){var n,a;if(i){const h=(n=this._listeners[t])===null||n===void 0?void 0:n.filter(p=>p!==i);this._listeners[t]=h;const d=(a=this._listenersOnce[t])===null||a===void 0?void 0:a.filter(p=>p!==i);this._listenersOnce[t]=d}else delete this._listeners[t]}emit(t,i){var n;if(this._paused)return;(n=this._listeners[t])===null||n===void 0||n.forEach(h=>h(i));const a=this._listenersOnce[t];this._listenersOnce[t]=[],a&&a.forEach(h=>h(i)),this._pipes.forEach(h=>{h.emit(t,i)})}pipe(t){if(this===t)throw Error("Cannot pipe to self");return this._pipes.push(t),{close:()=>{const i=this._pipes.indexOf(t);i>-1&&this._pipes.splice(i,1)}}}unpipe(t){const i=this._pipes.indexOf(t);i>-1&&this._pipes.splice(i,1)}pause(){this._paused=!0}unpause(){this._paused=!1}}var x;(function(u){u.Canvas="Canvas",u.Document="Document"})(x||(x={}));const S=4294967295;class A{constructor(t){this.seed=t,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(t||Date.now())>>>0;for(let i=1;i<this._n;i++){const n=this._mt[i-1]^this._mt[i-1]>>>this._w-2;this._mt[i]=(this._f*((n&4294901760)>>>16)<<16)+this._f*(n&65535)+i>>>0}this._index=this._n}_twist(){const t=[0,this._a];let i=0,n=0;for(;n<this._n-this._m;n++)i=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+this._m]^i>>>1^t[i&1]&S;for(;n<this._n-1;n++)i=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+(this._m-this._n)]^i>>>1^t[i&1]&S;i=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^i>>>1^t[i&1]&S,this._index=0}nextInt(){this._index>=this._n&&this._twist();let t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,t^=t>>>this._l,t>>>0}next(){return this.nextInt()*(1/4294967296)}floating(t,i){return(i-t)*this.next()+t}integer(t,i){return Math.floor((i-t+1)*this.next()+t)}bool(t=.5){return this.next()<=t}pickOne(t){return t[this.integer(0,t.length-1)]}pickSet(t,i,n=!1){return n?this._pickSetWithDuplicates(t,i):this._pickSetWithoutDuplicates(t,i)}_pickSetWithoutDuplicates(t,i){if(i>t.length||i<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(i===t.length)return t;const n=new Array(i);let a=0;const h=t.slice(0);for(;a<i;){const d=this.integer(0,h.length-1);n[a++]=h[d],h.splice(d,1)}return n}_pickSetWithDuplicates(t,i){if(i<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");const n=new Array(i);for(let a=0;a<i;a++)n[a]=this.pickOne(t);return n}shuffle(t){const i=t.slice(0);let n=null;for(let a=0;a<i.length-2;a++){const h=this.integer(a,i.length-1);n=i[a],i[a]=i[h],i[h]=n}return i}range(t,i,n){const a=new Array(t);for(let h=0;h<t;h++)a[h]=this.integer(i,n);return a}d4(){return this.integer(1,4)}d6(){return this.integer(1,6)}d8(){return this.integer(1,8)}d10(){return this.integer(1,10)}d12(){return this.integer(1,12)}d20(){return this.integer(1,20)}}const I=Math.PI*2;function F(u){return u>=0?u-Math.floor(u):u-Math.ceil(u)}function L(u){return u===0?0:u<0?-1:1}function O(u,t,i){return Math.min(Math.max(t,u),i)}function T(u){let t=u;if(u>I)for(;t>I;)t-=I;if(u<0)for(;t<0;)t+=I;return t}function P(u){return 180/Math.PI*u}function D(u){return u/180*Math.PI}const W=(u,t)=>Array.from(new Array(t-u+1),(i,n)=>n+u);function j(u,t,i=new A){return i?i.floating(u,t):u+Math.random()*(t-u)}function K(u,t,i=new A){return i?i.integer(u,t):Math.round(j(u,t))}class E{static get Zero(){return new E(0,0)}static get One(){return new E(1,1)}static get Half(){return new E(.5,.5)}static get Up(){return new E(0,-1)}static get Down(){return new E(0,1)}static get Left(){return new E(-1,0)}static get Right(){return new E(1,0)}static fromAngle(t){return new E(Math.cos(t),Math.sin(t))}static isValid(t){return!(t==null||isNaN(t.x)||isNaN(t.y)||t.x===1/0||t.y===1/0||t.x===-1/0||t.y===-1/0)}static distance(t,i){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}static min(t,i){return new E(Math.min(t.x,i.x),Math.min(t.y,i.y))}static max(t,i){return new E(Math.max(t.x,i.x),Math.max(t.y,i.y))}constructor(t,i){this._x=0,this._y=0,this._x=t,this._y=i}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}setTo(t,i){this.x=t,this.y=i}equals(t,i=E.EQUALS_EPSILON){return Math.abs(this.x-t.x)<=i&&Math.abs(this.y-t.y)<=i}distance(t){if(!t)return Math.sqrt(this.x*this.x+this.y*this.y);const i=this.x-t.x,n=this.y-t.y;return Math.sqrt(i*i+n*n)}squareDistance(t){t||(t=E.Zero);const i=this.x-t.x,n=this.y-t.y;return i*i+n*n}clampMagnitude(t){const i=this.size,n=O(i,0,t);return this.size=n,this}get size(){return this.distance()}set size(t){const i=this.normalize().scale(t);this.setTo(i.x,i.y)}normalize(){const t=this.distance();return t>0?new E(this.x/t,this.y/t):new E(0,1)}average(t){return this.add(t).scale(.5)}scale(t,i){const n=i||new E(0,0);return t instanceof E?(n.x=this.x*t.x,n.y=this.y*t.y):(n.x=this.x*t,n.y=this.y*t),n}add(t,i){return i?(i.x=this.x+t.x,i.y=this.y+t.y,i):new E(this.x+t.x,this.y+t.y)}sub(t){return new E(this.x-t.x,this.y-t.y)}addEqual(t){return this.setTo(this.x+t.x,this.y+t.y),this}subEqual(t){return this.setTo(this.x-t.x,this.y-t.y),this}scaleEqual(t){return this.setTo(this.x*t,this.y*t),this}dot(t){return this.x*t.x+this.y*t.y}cross(t){if(t instanceof E)return this.x*t.y-this.y*t.x;if(typeof t=="number")return new E(t*this.y,-t*this.x)}static cross(t,i){return new E(-t*i.y,t*i.x)}perpendicular(){return new E(this.y,-this.x)}normal(){return this.perpendicular().normalize()}negate(){return this.scale(-1)}toAngle(){return T(Math.atan2(this.y,this.x))}rotate(t,i){i||(i=new E(0,0));const n=Math.sin(t),a=Math.cos(t),h=a*(this.x-i.x)-n*(this.y-i.y)+i.x,d=n*(this.x-i.x)+a*(this.y-i.y)+i.y;return new E(h,d)}clone(t){const i=t??new E(0,0);return i.x=this.x,i.y=this.y,i}toString(t){return t?`(${this.x.toFixed(t)}, ${this.y.toFixed(t)})`:`(${this.x}, ${this.y})`}}E.EQUALS_EPSILON=.001;function B(u,t){return new E(u,t)}class G{constructor(t,i,n,a){this.r=t,this.g=i,this.b=n,this.a=a??1}static fromRGB(t,i,n,a){return new G(t,i,n,a)}static fromRGBString(t){const i=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i;let n=null;if(n=t.match(i)){const a=parseInt(n[1],10),h=parseInt(n[2],10),d=parseInt(n[3],10);let p=1;return n[4]&&(p=parseFloat(n[4])),new G(a,h,d,p)}else throw new Error("Invalid rgb/a string: "+t)}static fromHex(t){const i=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;let n=null;if(n=t.match(i)){const a=parseInt(n[1],16),h=parseInt(n[2],16),d=parseInt(n[3],16);let p=1;return n[4]&&(p=parseInt(n[4],16)/255),new G(a,h,d,p)}else throw new Error("Invalid hex string: "+t)}static fromHSL(t,i,n,a=1){return new rt(t,i,n,a).toRGBA()}lighten(t=.1){const i=rt.fromRGBA(this.r,this.g,this.b,this.a);return i.l+=(1-i.l)*t,i.toRGBA()}darken(t=.1){const i=rt.fromRGBA(this.r,this.g,this.b,this.a);return i.l-=i.l*t,i.toRGBA()}saturate(t=.1){const i=rt.fromRGBA(this.r,this.g,this.b,this.a);return i.s+=i.s*t,i.toRGBA()}desaturate(t=.1){const i=rt.fromRGBA(this.r,this.g,this.b,this.a);return i.s-=i.s*t,i.toRGBA()}multiply(t){const i=t.r/255*this.r/255*255,n=t.g/255*this.g/255*255,a=t.b/255*this.b/255*255,h=t.a*this.a;return new G(i,n,a,h)}screen(t){const i=t.invert(),n=t.invert();return i.multiply(n).invert()}invert(){return new G(255-this.r,255-this.g,255-this.b,1-this.a)}average(t){const i=(t.r+this.r)/2,n=(t.g+this.g)/2,a=(t.b+this.b)/2,h=(t.a+this.a)/2;return new G(i,n,a,h)}equal(t){return this.toString()===t.toString()}toString(t="rgb"){switch(t){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}_componentToHex(t){const i=Math.max(Math.round(t),0).toString(16);return i.length===1?"0"+i:i}toHex(){let t="#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b);return this.a!==1&&(t+=this._componentToHex(this.a*255)),t}toRGBA(){const t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return this.a!==void 0||this.a!==null?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}toHSLA(){return rt.fromRGBA(this.r,this.g,this.b,this.a).toString()}fillStyle(){return this.toString()}clone(){return new G(this.r,this.g,this.b,this.a)}static get Black(){return G.fromHex("#000000")}static get White(){return G.fromHex("#FFFFFF")}static get Gray(){return G.fromHex("#808080")}static get LightGray(){return G.fromHex("#D3D3D3")}static get DarkGray(){return G.fromHex("#A9A9A9")}static get Yellow(){return G.fromHex("#FFFF00")}static get Orange(){return G.fromHex("#FFA500")}static get Red(){return G.fromHex("#FF0000")}static get Vermilion(){return G.fromHex("#FF5B31")}static get Rose(){return G.fromHex("#FF007F")}static get Magenta(){return G.fromHex("#FF00FF")}static get Violet(){return G.fromHex("#7F00FF")}static get Blue(){return G.fromHex("#0000FF")}static get Azure(){return G.fromHex("#007FFF")}static get Cyan(){return G.fromHex("#00FFFF")}static get Viridian(){return G.fromHex("#59978F")}static get Green(){return G.fromHex("#00FF00")}static get Chartreuse(){return G.fromHex("#7FFF00")}static get Transparent(){return G.fromHex("#FFFFFF00")}static get ExcaliburBlue(){return G.fromHex("#176BAA")}}class rt{constructor(t,i,n,a){this.h=t,this.s=i,this.l=n,this.a=a}static hue2rgb(t,i,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(i-t)*6*n:n<1/2?i:n<2/3?t+(i-t)*(2/3-n)*6:t}static fromRGBA(t,i,n,a){t/=255,i/=255,n/=255;const h=Math.max(t,i,n),d=Math.min(t,i,n);let p,m;const y=(h+d)/2;if(h===d)p=m=0;else{const w=h-d;switch(m=y>.5?w/(2-h-d):w/(h+d),h){case t:p=(i-n)/w+(i<n?6:0);break;case i:p=(n-t)/w+2;break;case n:p=(t-i)/w+4;break}p/=6}return new rt(p,m,y,a)}toRGBA(){let t,i,n;if(this.s===0)t=i=n=this.l;else{const a=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,h=2*this.l-a;t=rt.hue2rgb(h,a,this.h+1/3),i=rt.hue2rgb(h,a,this.h),n=rt.hue2rgb(h,a,this.h-1/3)}return new G(t*255,i*255,n*255,this.a)}toString(){const t=this.h.toFixed(0),i=this.s.toFixed(0),n=this.l.toFixed(0),a=this.a.toFixed(0);return`hsla(${t}, ${i}, ${n}, ${a})`}}var at;(function(u){u[u.Debug=0]="Debug",u[u.Info=1]="Info",u[u.Warn=2]="Warn",u[u.Error=3]="Error",u[u.Fatal=4]="Fatal"})(at||(at={}));class J{constructor(){if(this._appenders=[],this.defaultLevel=at.Info,this._logOnceSet=new Set,J._INSTANCE)throw new Error("Logger is a singleton");return J._INSTANCE=this,J._INSTANCE.addAppender(new Nt),J._INSTANCE}static getInstance(){return J._INSTANCE==null&&(J._INSTANCE=new J),J._INSTANCE}addAppender(t){this._appenders.push(t)}clearAppenders(){this._appenders.length=0}_log(t,i){t==null&&(t=this.defaultLevel);const n=this._appenders.length;for(let a=0;a<n;a++)t>=this.defaultLevel&&this._appenders[a].log(t,i)}_logOnce(t,i){const n=t+i.join("+");this._logOnceSet.has(n)||(this._logOnceSet.add(n),this._log(t,i))}debug(...t){this._log(at.Debug,t)}debugOnce(...t){this._logOnce(at.Debug,t)}info(...t){this._log(at.Info,t)}infoOnce(...t){this._logOnce(at.Info,t)}warn(...t){this._log(at.Warn,t)}warnOnce(...t){this._logOnce(at.Warn,t)}error(...t){this._log(at.Error,t)}errorOnce(...t){this._logOnce(at.Error,t)}fatal(...t){this._log(at.Fatal,t)}fatalOnce(...t){this._logOnce(at.Fatal,t)}}J._INSTANCE=null;class Nt{log(t,i){if(!console&&!console.log&&console.warn&&console.error)return;const n=[];n.unshift.apply(n,i),n.unshift("["+at[t]+"] : "),t<at.Warn?console.log.apply?console.log.apply(console,n):console.log(n.join(" ")):t<at.Error?console.warn.apply?console.warn.apply(console,n):console.warn(n.join(" ")):console.error.apply?console.error.apply(console,n):console.error(n.join(" "))}}class Zt{constructor(t){var i,n;this._messages=[],this._pos=10,this._color=G.Black,this._options=t,this.canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.zIndex=(n=(i=t.zIndex)===null||i===void 0?void 0:i.toString())!==null&&n!==void 0?n:"99",document.body.appendChild(this.canvas),this._positionScreenAppenderCanvas(),t.engine.screen.events.on("resize",()=>{this._positionScreenAppenderCanvas()})}_positionScreenAppenderCanvas(){var t,i,n,a;const h=this._options;this.canvas.width=(t=h.width)!==null&&t!==void 0?t:h.engine.screen.resolution.width,this.canvas.height=(i=h.height)!==null&&i!==void 0?i:h.engine.screen.resolution.height,this.canvas.style.position="absolute";const d=h.engine.screen.screenToPageCoordinates(B(0,0));this.canvas.style.left=d.x+"px",this.canvas.style.top=d.y+"px",this._pos=(n=h.xPos)!==null&&n!==void 0?n:this._pos,this._color=(a=h.color)!==null&&a!==void 0?a:this._color}log(t,i){const n=i.join(",");this._ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this._messages.unshift("["+at[t]+"] : "+n);let a=10;this._messages=this._messages.slice(0,1e3);for(let h=0;h<this._messages.length;h++)this._ctx.fillStyle=this._color.toRGBA(),this._ctx.fillText(this._messages[h],this._pos,a),a+=10}}var wt;(function(u){u.None="None",u.Top="Top",u.Bottom="Bottom",u.Left="Left",u.Right="Right"})(wt||(wt={})),function(u){function t(n){return n===u.Top?u.Bottom:n===u.Bottom?u.Top:n===u.Left?u.Right:n===u.Right?u.Left:u.None}u.getOpposite=t;function i(n){const a=[E.Left,E.Right,E.Up,E.Down],h=[u.Left,u.Right,u.Top,u.Bottom];let d=-Number.MAX_VALUE,p=-1;for(let m=0;m<a.length;m++)a[m].dot(n)>d&&(d=a[m].dot(n),p=m);return h[p]}u.fromDirection=i}(wt||(wt={}));class et{constructor(t=0,i=0,n=0,a=0){this._points=[],typeof t=="object"?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):typeof t=="number"&&(this.left=t,this.top=i,this.right=n,this.bottom=a)}clone(){return new et(this.left,this.top,this.right,this.bottom)}static getSideFromIntersection(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?wt.Right:wt.Left:t.y<0?wt.Bottom:wt.Top:wt.None}static fromPoints(t){let i=1/0,n=1/0,a=-1/0,h=-1/0;for(let d=0;d<t.length;d++)t[d].x<i&&(i=t[d].x),t[d].x>a&&(a=t[d].x),t[d].y<n&&(n=t[d].y),t[d].y>h&&(h=t[d].y);return new et(i,n,a,h)}static fromDimension(t,i,n=E.Half,a=E.Zero){return new et(-t*n.x+a.x,-i*n.y+a.y,t-t*n.x+a.x,i-i*n.y+a.y)}get width(){return this.right-this.left}get height(){return this.bottom-this.top}hasZeroDimensions(){return this.width===0||this.height===0}get center(){return new E((this.left+this.right)/2,(this.top+this.bottom)/2)}get topLeft(){return new E(this.left,this.top)}get bottomRight(){return new E(this.right,this.bottom)}get topRight(){return new E(this.right,this.top)}get bottomLeft(){return new E(this.left,this.bottom)}translate(t){return new et(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)}rotate(t,i=E.Zero){const n=this.getPoints().map(a=>a.rotate(t,i));return et.fromPoints(n)}scale(t,i=E.Zero){const n=this.translate(i);return new et(n.left*t.x,n.top*t.y,n.right*t.x,n.bottom*t.y)}transform(t){const i=t.data[0]*this.left,n=t.data[1]*this.left,a=t.data[0]*this.right,h=t.data[1]*this.right,d=t.data[2]*this.top,p=t.data[3]*this.top,m=t.data[2]*this.bottom,y=t.data[3]*this.bottom,w=t.getPosition(),b=Math.min(i,a)+Math.min(d,m)+w.x,R=Math.min(n,h)+Math.min(p,y)+w.y,k=Math.max(i,a)+Math.max(d,m)+w.x,M=Math.max(n,h)+Math.max(p,y)+w.y;return new et({left:b,top:R,right:k,bottom:M})}getPerimeter(){const t=this.width,i=this.height;return 2*(t+i)}getPoints(){return(this._left!==this.left||this._right!==this.right||this._top!==this.top||this._bottom!==this.bottom)&&(this._points.length=0,this._points.push(new E(this.left,this.top)),this._points.push(new E(this.right,this.top)),this._points.push(new E(this.right,this.bottom)),this._points.push(new E(this.left,this.bottom)),this._left=this.left,this._right=this.right,this._top=this.top,this._bottom=this.bottom),this._points}rayCast(t,i=1/0){let n=-1/0,a=1/0;const h=t.dir.x===0?Number.MAX_VALUE:1/t.dir.x,d=t.dir.y===0?Number.MAX_VALUE:1/t.dir.y,p=(this.left-t.pos.x)*h,m=(this.right-t.pos.x)*h;n=Math.min(p,m),a=Math.max(p,m);const y=(this.top-t.pos.y)*d,w=(this.bottom-t.pos.y)*d;return n=Math.max(n,Math.min(y,w)),a=Math.min(a,Math.max(y,w)),a>=Math.max(0,n)&&n<i}rayCastTime(t,i=1/0){let n=-1/0,a=1/0;const h=t.dir.x===0?Number.MAX_VALUE:1/t.dir.x,d=t.dir.y===0?Number.MAX_VALUE:1/t.dir.y,p=(this.left-t.pos.x)*h,m=(this.right-t.pos.x)*h;n=Math.min(p,m),a=Math.max(p,m);const y=(this.top-t.pos.y)*d,w=(this.bottom-t.pos.y)*d;return n=Math.max(n,Math.min(y,w)),a=Math.min(a,Math.max(y,w)),a>=Math.max(0,n)&&n<i?n:-1}contains(t){return t instanceof E?this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x:t instanceof et?this.left<=t.left&&this.top<=t.top&&t.bottom<=this.bottom&&t.right<=this.right:!1}combine(t){return new et(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom))}get dimensions(){return new E(this.width,this.height)}overlaps(t,i){const n=i||0;if(t.hasZeroDimensions())return this.contains(t);if(this.hasZeroDimensions())return t.contains(this);const a=this.combine(t);return a.width+n<t.width+this.width&&a.height+n<t.height+this.height}intersect(t){const i=this.combine(t);if(i.width<t.width+this.width&&i.height<t.height+this.height&&!i.dimensions.equals(t.dimensions)&&!i.dimensions.equals(this.dimensions)){let n=0;this.right>=t.left&&this.right<=t.right?n=t.left-this.right:n=t.right-this.left;let a=0;return this.top<=t.bottom&&this.top>=t.top?a=t.bottom-this.top:a=t.top-this.bottom,Math.abs(n)<Math.abs(a)?new E(n,0):new E(0,a)}else if(i.dimensions.equals(t.dimensions)||i.dimensions.equals(this.dimensions)){let n=0;this.width-t.width>=0?this.right-t.right<=t.left-this.left?n=t.left-this.right:n=t.right-this.left:t.right-this.right<=this.left-t.left?n=this.left-t.right:n=this.right-t.left;let a=0;return this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?a=t.top-this.bottom:a=t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?a=this.top-t.bottom:a=this.bottom-t.top,Math.abs(n)<Math.abs(a)?new E(n,0):new E(0,a)}else return null}intersectWithSide(t){const i=this.intersect(t);return et.getSideFromIntersection(i)}draw(t,i=G.Yellow){t.debug.drawRect(this.left,this.top,this.width,this.height,{color:i})}}function fi(u){if(u){const t=u.getBoundingClientRect();return B(t.x+window.scrollX,t.y+window.scrollY)}return E.Zero}function st(u,t){return t.indexOf(u)===-1?(t.push(u),!0):!1}function lt(u,t){let i=-1;return(i=t.indexOf(u))>-1?(t.splice(i,1),!0):!1}function dt(u,t){for(let i=0;i<u.length;i++)if(u[i]===t)return!0;return!1}function Et(u){throw new Error(u)}function ht(u,t){var i;const n=new _;return((i=t==null?void 0:t.schedule.bind(t))!==null&&i!==void 0?i:setTimeout)(()=>{n.resolve()},u),n.promise}function Ut(u,t){const i={};for(const n in u)t.includes(n)||(i[n]=u[n]);return i}var Gt;(function(u){u[u.X=12]="X",u[u.Y=13]="Y"})(Gt||(Gt={}));class oe{constructor(){this.data=new Float32Array(16),this._scaleX=1,this._scaleSignX=1,this._scaleY=1,this._scaleSignY=1}static ortho(t,i,n,a,h,d){const p=new oe;return p.data[0]=2/(i-t),p.data[1]=0,p.data[2]=0,p.data[3]=0,p.data[4]=0,p.data[5]=2/(a-n),p.data[6]=0,p.data[7]=0,p.data[8]=0,p.data[9]=0,p.data[10]=-2/(d-h),p.data[11]=0,p.data[12]=-(i+t)/(i-t),p.data[13]=-(a+n)/(a-n),p.data[14]=-(d+h)/(d-h),p.data[15]=1,p}clone(t){const i=t||new oe;return i.data[0]=this.data[0],i.data[1]=this.data[1],i.data[2]=this.data[2],i.data[3]=this.data[3],i.data[4]=this.data[4],i.data[5]=this.data[5],i.data[6]=this.data[6],i.data[7]=this.data[7],i.data[8]=this.data[8],i.data[9]=this.data[9],i.data[10]=this.data[10],i.data[11]=this.data[11],i.data[12]=this.data[12],i.data[13]=this.data[13],i.data[14]=this.data[14],i.data[15]=this.data[15],i}toDOMMatrix(){return new DOMMatrix([...this.data])}static fromFloat32Array(t){const i=new oe;return i.data=t,i}static identity(){const t=new oe;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}static translation(t,i){const n=oe.identity();return n.data[12]=t,n.data[13]=i,n}static scale(t,i){const n=oe.identity();return n.data[0]=t,n.data[5]=i,n.data[10]=1,n.data[15]=1,n}static rotation(t){const i=oe.identity();return i.data[0]=Math.cos(t),i.data[4]=-Math.sin(t),i.data[1]=Math.sin(t),i.data[5]=Math.cos(t),i}multiply(t,i){if(t instanceof E){const n=i||new E(0,0),a=t,h=a.x*this.data[0]+a.y*this.data[4]+this.data[12],d=a.x*this.data[1]+a.y*this.data[5]+this.data[13];return n.x=h,n.y=d,n}else{const n=i||new oe,a=t,h=this.data[0],d=this.data[1],p=this.data[2],m=this.data[3],y=this.data[4],w=this.data[5],b=this.data[6],R=this.data[7],k=this.data[8],M=this.data[9],z=this.data[10],X=this.data[11],N=this.data[12],U=this.data[13],Y=this.data[14],H=this.data[15],tt=a.data[0],gt=a.data[1],$=a.data[2],mt=a.data[3],Bt=a.data[4],le=a.data[5],Ne=a.data[6],Ue=a.data[7],ze=a.data[8],Re=a.data[9],ge=a.data[10],me=a.data[11],ot=a.data[12],Vs=a.data[13],Gs=a.data[14],Xs=a.data[15];n.data[0]=h*tt+y*gt+k*$+N*mt,n.data[1]=d*tt+w*gt+M*$+U*mt,n.data[2]=p*tt+b*gt+z*$+Y*mt,n.data[3]=m*tt+R*gt+X*$+H*mt,n.data[4]=h*Bt+y*le+k*Ne+N*Ue,n.data[5]=d*Bt+w*le+M*Ne+U*Ue,n.data[6]=p*Bt+b*le+z*Ne+Y*Ue,n.data[7]=m*Bt+R*le+X*Ne+H*Ue,n.data[8]=h*ze+y*Re+k*ge+N*me,n.data[9]=d*ze+w*Re+M*ge+U*me,n.data[10]=p*ze+b*Re+z*ge+Y*me,n.data[11]=m*ze+R*Re+X*ge+H*me,n.data[12]=h*ot+y*Vs+k*Gs+N*Xs,n.data[13]=d*ot+w*Vs+M*Gs+U*Xs,n.data[14]=p*ot+b*Vs+z*Gs+Y*Xs,n.data[15]=m*ot+R*Vs+X*Gs+H*Xs;const kn=this.getScale();return n._scaleSignX=L(kn.x)*L(n._scaleSignX),n._scaleSignY=L(kn.y)*L(n._scaleSignY),n}}translate(t,i){const n=this.data[0],a=this.data[1],h=this.data[2],d=this.data[3],p=this.data[4],m=this.data[5],y=this.data[6],w=this.data[7],b=this.data[8],R=this.data[9],k=this.data[10],M=this.data[11],z=this.data[12],X=this.data[13],N=this.data[14],U=this.data[15],Y=0,H=1;return this.data[12]=n*t+p*i+b*Y+z*H,this.data[13]=a*t+m*i+R*Y+X*H,this.data[14]=h*t+y*i+k*Y+N*H,this.data[15]=d*t+w*i+M*Y+U*H,this}setPosition(t,i){this.data[12]=t,this.data[13]=i}getPosition(){return B(this.data[12],this.data[13])}rotate(t){const i=this.data[0],n=this.data[1],a=this.data[2],h=this.data[3],d=this.data[4],p=this.data[5],m=this.data[6],y=this.data[7],w=Math.sin(t),b=Math.cos(t);return this.data[0]=b*i+w*d,this.data[1]=b*n+w*p,this.data[2]=b*a+w*m,this.data[3]=b*h+w*y,this.data[4]=b*d-w*i,this.data[5]=b*p-w*n,this.data[6]=b*m-w*a,this.data[7]=b*y-w*h,this}scale(t,i){const n=this.data[0],a=this.data[1],h=this.data[2],d=this.data[3],p=this.data[4],m=this.data[5],y=this.data[6],w=this.data[7];return this.data[0]=n*t,this.data[1]=a*t,this.data[2]=h*t,this.data[3]=d*t,this.data[4]=p*i,this.data[5]=m*i,this.data[6]=y*i,this.data[7]=w*i,this}setRotation(t){const i=this.getScale(),n=Math.sin(t),a=Math.cos(t);this.data[0]=a*i.x,this.data[1]=n*i.y,this.data[4]=-n*i.x,this.data[5]=a*i.y}getRotation(){const t=Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX());return T(t)}getScaleX(){const t=B(this.data[0],this.data[4]).size;return this._scaleSignX*t}getScaleY(){const t=B(this.data[1],this.data[5]).size;return this._scaleSignY*t}getScale(){return B(this.getScaleX(),this.getScaleY())}setScaleX(t){if(this._scaleX===t)return;this._scaleSignX=L(t);const i=B(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=i.x*t,this.data[4]=i.y*t,this._scaleX=t}setScaleY(t){if(this._scaleY===t)return;this._scaleSignY=L(t);const i=B(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=i.x*t,this.data[5]=i.y*t,this._scaleY=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}getBasisDeterminant(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}getAffineInverse(t){const n=1/this.getBasisDeterminant(),a=this.data[0],h=this.data[4],d=this.data[1],p=this.data[5],m=t||oe.identity();m.data[0]=p*n,m.data[1]=-d*n,m.data[4]=-h*n,m.data[5]=a*n;const y=this.data[12],w=this.data[13];return m.data[12]=-(y*m.data[0]+w*m.data[4]),m.data[13]=-(y*m.data[1]+w*m.data[5]),m}isIdentity(){return this.data[0]===1&&this.data[1]===0&&this.data[2]===0&&this.data[3]===0&&this.data[4]===0&&this.data[5]===1&&this.data[6]===0&&this.data[7]===0&&this.data[8]===0&&this.data[9]===0&&this.data[10]===1&&this.data[11]===0&&this.data[12]===0&&this.data[13]===0&&this.data[14]===0&&this.data[15]===1}toString(){return`
[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]
[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]
[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]
[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]
`}}class bt{constructor(){this.data=new Float64Array(6),this._scale=new Float64Array([1,1]),this._scaleSignX=1,this._scaleSignY=1}toDOMMatrix(){return new DOMMatrix([...this.data])}static identity(){const t=new bt;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}static translation(t,i){const n=bt.identity();return n.data[4]=t,n.data[5]=i,n}static scale(t,i){const n=bt.identity();return n.data[0]=t,n.data[3]=i,n._scale[0]=t,n._scale[1]=i,n}static rotation(t){const i=bt.identity();return i.data[0]=Math.cos(t),i.data[1]=Math.sin(t),i.data[2]=-Math.sin(t),i.data[3]=Math.cos(t),i}setPosition(t,i){this.data[4]=t,this.data[5]=i}getPosition(){return B(this.data[4],this.data[5])}rotate(t){const i=this.data[0],n=this.data[1],a=this.data[2],h=this.data[3],d=Math.sin(t),p=Math.cos(t);return this.data[0]=p*i+d*a,this.data[1]=p*n+d*h,this.data[2]=p*a-d*i,this.data[3]=p*h-d*n,this}translate(t,i){const n=this.data[0],a=this.data[1],h=this.data[2],d=this.data[3],p=this.data[4],m=this.data[5];return this.data[4]=n*t+h*i+p,this.data[5]=a*t+d*i+m,this}scale(t,i){const n=this.data[0],a=this.data[1],h=this.data[2],d=this.data[3];return this.data[0]=n*t,this.data[1]=a*t,this.data[2]=h*i,this.data[3]=d*i,this._scale[0]=t,this._scale[1]=i,this}determinant(){return this.data[0]*this.data[3]-this.data[1]*this.data[2]}inverse(t){const n=1/this.determinant(),a=this.data[0],h=this.data[2],d=this.data[1],p=this.data[3],m=t||bt.identity();m.data[0]=p*n,m.data[1]=-d*n,m.data[2]=-h*n,m.data[3]=a*n;const y=this.data[4],w=this.data[5];return m.data[4]=-(y*m.data[0]+w*m.data[2]),m.data[5]=-(y*m.data[1]+w*m.data[3]),m}multiply(t,i){if(t instanceof E){const n=i||new E(0,0),a=t,h=a.x*this.data[0]+a.y*this.data[2]+this.data[4],d=a.x*this.data[1]+a.y*this.data[3]+this.data[5];return n.x=h,n.y=d,n}else{const n=i||new bt,a=t,h=this.data[0],d=this.data[1],p=this.data[2],m=this.data[3],y=this.data[4],w=this.data[5],b=a.data[0],R=a.data[1],k=a.data[2],M=a.data[3],z=a.data[4],X=a.data[5];n.data[0]=h*b+p*R,n.data[1]=d*b+m*R,n.data[2]=h*k+p*M,n.data[3]=d*k+m*M,n.data[4]=h*z+p*X+y,n.data[5]=d*z+m*X+w;const N=this.getScale();return n._scaleSignX=L(N.x)*L(n._scaleSignX),n._scaleSignY=L(N.y)*L(n._scaleSignY),n}}multiplyQuadInPlace(t){const i=t[0]*this.data[0]+t[1]*this.data[2]+this.data[4],n=t[0]*this.data[1]+t[1]*this.data[3]+this.data[5];t[0]=i,t[1]=n;const a=t[2]*this.data[0]+t[3]*this.data[2]+this.data[4],h=t[2]*this.data[1]+t[3]*this.data[3]+this.data[5];t[2]=a,t[3]=h;const d=t[4]*this.data[0]+t[5]*this.data[2]+this.data[4],p=t[4]*this.data[1]+t[5]*this.data[3]+this.data[5];t[4]=d,t[5]=p;const m=t[6]*this.data[0]+t[7]*this.data[2]+this.data[4],y=t[6]*this.data[1]+t[7]*this.data[3]+this.data[5];t[6]=m,t[7]=y}to4x4(){const t=new oe;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=0,t.data[3]=0,t.data[4]=this.data[2],t.data[5]=this.data[3],t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=this.data[4],t.data[13]=this.data[5],t.data[14]=0,t.data[15]=1,t}setRotation(t){const i=this.getScale(),n=Math.sin(t),a=Math.cos(t);this.data[0]=a*i.x,this.data[1]=n*i.y,this.data[2]=-n*i.x,this.data[3]=a*i.y}getRotation(){const t=Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX());return T(t)}getScaleX(){const t=B(this.data[0],this.data[2]).distance();return this._scaleSignX*t}getScaleY(){const t=B(this.data[1],this.data[3]).distance();return this._scaleSignY*t}getScale(){return B(this.getScaleX(),this.getScaleY())}setScaleX(t){if(t===this._scale[0])return;this._scaleSignX=L(t);const i=B(this.data[0]*this._scaleSignX,this.data[2]*this._scaleSignX).normalize();this.data[0]=i.x*t,this.data[2]=i.y*t,this._scale[0]=t}setScaleY(t){if(t===this._scale[1])return;this._scaleSignY=L(t);const i=B(this.data[1]*this._scaleSignY,this.data[3]*this._scaleSignY).normalize();this.data[1]=i.x*t,this.data[3]=i.y*t,this._scale[1]=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}isIdentity(){return this.data[0]===1&&this.data[1]===0&&this.data[2]===0&&this.data[3]===1&&this.data[4]===0&&this.data[5]===0}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}clone(t){const i=t||new bt;return i.data.set(this.data),i}toString(){return`
[${this.data[0]} ${this.data[2]} ${this.data[4]}]
[${this.data[1]} ${this.data[3]} ${this.data[5]}]
[0 0 1]
`}}class fn{constructor(){this._transforms=[],this._currentTransform=bt.identity()}save(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}restore(){this._currentTransform=this._transforms.pop()}translate(t,i){return this._currentTransform.translate(t,i)}rotate(t){return this._currentTransform.rotate(t)}scale(t,i){return this._currentTransform.scale(t,i)}set current(t){this._currentTransform=t}get current(){return this._currentTransform}}class Ed{constructor(){this.current=this._getDefaultState(),this._states=[]}_getDefaultState(){return{opacity:1,z:0,tint:G.White,material:null}}_cloneState(){return{opacity:this.current.opacity,z:this.current.z,tint:this.current.tint.clone(),material:this.current.material}}save(){this._states.push(this.current),this.current=this._cloneState()}restore(){this.current=this._states.pop()}}const e0={Complete:"complete",Load:"load",LoadStart:"loadstart",Progress:"progress",Error:"error"};class dr{constructor(t,i,n=!1){this.path=t,this.responseType=i,this.bustCache=n,this.data=null,this.logger=J.getInstance(),this.events=new v}isLoaded(){return this.data!==null}_cacheBust(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}load(){return new Promise((t,i)=>{if(this.data!==null){this.logger.debug("Already have data for resource",this.path),this.events.emit("complete",this.data),t(this.data);return}const n=new XMLHttpRequest;n.open("GET",this.bustCache?this._cacheBust(this.path):this.path,!0),n.responseType=this.responseType,n.addEventListener("loadstart",a=>this.events.emit("loadstart",a)),n.addEventListener("progress",a=>this.events.emit("progress",a)),n.addEventListener("error",a=>this.events.emit("error",a)),n.addEventListener("load",a=>this.events.emit("load",a)),n.addEventListener("load",()=>{if(n.status!==0&&n.status!==200){this.logger.error("Failed to load resource ",this.path," server responded with error code",n.status),this.events.emit("error",n.response),i(new Error(n.statusText));return}this.data=n.response,this.events.emit("complete",this.data),this.logger.debug("Completed loading resource",this.path),t(this.data)}),n.send()})}}function Ui(u,t){return u&&(u.__isProxy===void 0?new Proxy(u,{set:(i,n,a)=>(i[n]!==a&&(i[n]=a,typeof n=="string"&&n[0]!=="_"&&t(i)),!0),get:(i,n)=>n!=="__isProxy"?i[n]:!0}):u)}const Ad=(u=[],t,i)=>({get:(n,a)=>a==="__isProxy"?!0:typeof n[a]=="object"&&n[a]!=null?new Proxy(n[a],Ad([...u,a],t,i)):n[a],set:(n,a,h)=>(typeof a=="string"&&a[0]!=="_"&&t(i),n[a]=h,!0)});function i0(u,t){return u&&(u.__isProxy===void 0?new Proxy(u,Ad([],t,u)):u)}function Td(u,t){return u&&(u.__isProxy===void 0?new Proxy(u,{set:(i,n,a)=>(i[n]=a,typeof n=="string"&&n[0]!=="_"&&t(i),!0),get:(i,n)=>n!=="__isProxy"?i[n]:!0}):u)}class zt{isStale(){return this._transformStale}get flipHorizontal(){return this._flipHorizontal}set flipHorizontal(t){this._flipHorizontal=t,this._transformStale=!0}get flipVertical(){return this._flipVertical}set flipVertical(t){this._flipVertical=t,this._transformStale=!0}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._transformStale=!0}get scale(){return this._scale}set scale(t){this._scale=Ui(t,()=>{this._transformStale=!0}),this._transformStale=!0}get origin(){return this._origin}set origin(t){this._origin=Ui(t,()=>{this._transformStale=!0}),this._transformStale=!0}constructor(t){var i,n,a,h,d,p,m;this.id=zt._ID++,this.transform=bt.identity(),this.tint=null,this._transformStale=!0,this.showDebug=!1,this._flipHorizontal=!1,this._flipVertical=!1,this._rotation=0,this.opacity=1,this._scale=E.One,this._origin=null,this._width=0,this._height=0,t&&(this.origin=(i=t.origin)!==null&&i!==void 0?i:this.origin,this.flipHorizontal=(n=t.flipHorizontal)!==null&&n!==void 0?n:this.flipHorizontal,this.flipVertical=(a=t.flipVertical)!==null&&a!==void 0?a:this.flipVertical,this.rotation=(h=t.rotation)!==null&&h!==void 0?h:this.rotation,this.opacity=(d=t.opacity)!==null&&d!==void 0?d:this.opacity,this.scale=(p=t.scale)!==null&&p!==void 0?p:this.scale,this.tint=(m=t.tint)!==null&&m!==void 0?m:this.tint)}cloneGraphicOptions(){return{width:this.width/this.scale.x,height:this.height/this.scale.y,origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null,tint:this.tint?this.tint.clone():null}}get width(){return Math.abs(this._width*this.scale.x)}get height(){return Math.abs(this._height*this.scale.y)}set width(t){this._width=t,this._transformStale=!0}set height(t){this._height=t,this._transformStale=!0}get localBounds(){return et.fromDimension(this.width,this.height,E.Zero)}draw(t,i,n){this._preDraw(t,i,n),this._drawImage(t,0,0),this._postDraw(t)}_preDraw(t,i,n){t.save(),t.translate(i,n),this._transformStale&&(this.transform.reset(),this.transform.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(this.transform),this._flip(this.transform),this._transformStale=!1),t.multiply(this.transform),t.opacity=t.opacity*this.opacity,this.tint&&(t.tint=this.tint)}_rotate(t){var i;const n=this.scale.x>0?1:-1,a=this.scale.y>0?1:-1,h=(i=this.origin)!==null&&i!==void 0?i:B(this.width/2,this.height/2);t.translate(h.x,h.y),t.rotate(this.rotation),t.scale(n,a),t.translate(-h.x,-h.y)}_flip(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}_postDraw(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}zt._ID=0;class Ps extends zt{static from(t){return new Ps({image:t})}constructor(t){var i,n;super(t),this._logger=J.getInstance(),this._dirty=!0,this.image=t.image;const{width:a,height:h}=t;this.sourceView=(i=t.sourceView)!==null&&i!==void 0?i:{x:0,y:0,width:a??0,height:h??0},this.destSize=(n=t.destSize)!==null&&n!==void 0?n:{width:a??0,height:h??0},this._updateSpriteDimensions(),this.image.ready.then(()=>{this._updateSpriteDimensions()})}get width(){return Math.abs(this.destSize.width*this.scale.x)}get height(){return Math.abs(this.destSize.height*this.scale.y)}set width(t){t/=Math.abs(this.scale.x),this.destSize.width=t,super.width=Math.ceil(this.destSize.width)}set height(t){t/=Math.abs(this.scale.y),this.destSize.height=t,super.height=Math.ceil(this.destSize.height)}_updateSpriteDimensions(){var t,i,n,a,h,d;const{width:p,height:m}=this.image;this.sourceView.width=((t=this.sourceView)===null||t===void 0?void 0:t.width)||p,this.sourceView.height=((i=this.sourceView)===null||i===void 0?void 0:i.height)||m,this.destSize.width=((n=this.destSize)===null||n===void 0?void 0:n.width)||((a=this.sourceView)===null||a===void 0?void 0:a.width)||p,this.destSize.height=((h=this.destSize)===null||h===void 0?void 0:h.height)||((d=this.sourceView)===null||d===void 0?void 0:d.height)||m,this.width=Math.ceil(this.destSize.width)*this.scale.x,this.height=Math.ceil(this.destSize.height)*this.scale.y}_preDraw(t,i,n){this.image.isLoaded()&&this._dirty&&(this._dirty=!1,this._updateSpriteDimensions()),super._preDraw(t,i,n)}_drawImage(t,i,n){this.image.isLoaded()?t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,i,n,this.destSize.width,this.destSize.height):this._logger.warnOnce(`ImageSource ${this.image.path} is not yet loaded and won't be drawn. Please call .load() or include in a Loader.

Read https://excaliburjs.com/docs/imagesource for more information.`)}clone(){return new Ps({image:this.image,sourceView:{...this.sourceView},destSize:{...this.destSize},...this.cloneGraphicOptions()})}}var Yt;(function(u){u.Pixel="Pixel",u.Blended="Blended"})(Yt||(Yt={}));function To(u){switch(u){case Yt.Pixel:return Yt.Pixel;case Yt.Blended:return Yt.Blended;default:return null}}var Ht;(function(u){u.Clamp="Clamp",u.Repeat="Repeat",u.Mirror="Mirror"})(Ht||(Ht={}));function Rs(u){switch(u){case Ht.Clamp:return Ht.Clamp;case Ht.Repeat:return Ht.Repeat;case Ht.Mirror:return Ht.Mirror;default:return Ht.Clamp}}class $t{constructor(t){this._textureMap=new Map,this._gl=t,$t._MAX_TEXTURE_SIZE=t.getParameter(t.MAX_TEXTURE_SIZE)}dispose(){for(const[t]of this._textureMap)this.delete(t);this._textureMap.clear(),this._gl=null}get(t){return this._textureMap.get(t)}has(t){return this._textureMap.has(t)}load(t,i,n=!1){const a=this._gl;if(!a)return null;const{filtering:h,wrapping:d}={...i};let p=null;if(this.has(t)&&(p=this.get(t)),p)return n&&(a.bindTexture(a.TEXTURE_2D,p),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,t)),p;p=a.createTexture(),$t.checkImageSizeSupportedAndLog(t),a.bindTexture(a.TEXTURE_2D,p),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);let m;d&&(typeof d=="string"?m={x:d,y:d}:m={x:d.x,y:d.y});const{x:y,y:w}=m??$t.wrapping;switch(y){case Ht.Clamp:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);break;case Ht.Repeat:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT);break;case Ht.Mirror:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.MIRRORED_REPEAT);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE)}switch(w){case Ht.Clamp:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);break;case Ht.Repeat:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT);break;case Ht.Mirror:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.MIRRORED_REPEAT);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)}const b=h??$t.filtering;return a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,b===Yt.Pixel?a.NEAREST:a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,b===Yt.Pixel?a.NEAREST:a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,t),this._textureMap.set(t,p),p}delete(t){const i=this._gl;if(!i)return null;let n=null;this.has(t)&&(n=this.get(t),i.deleteTexture(n))}static checkImageSizeSupportedAndLog(t){var i;const n=(i=t.dataset.originalSrc)!==null&&i!==void 0?i:"internal canvas bitmap";return t.width>$t._MAX_TEXTURE_SIZE||t.height>$t._MAX_TEXTURE_SIZE?($t._LOGGER.error(`The image [${n}] provided to Excalibur is too large for the device's maximum texture size of (${$t._MAX_TEXTURE_SIZE}x${$t._MAX_TEXTURE_SIZE}) please resize to an image for excalibur to render properly.

Images will likely render as black rectangles.

Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!1):((t.width>4096||t.height>4096)&&$t._LOGGER.warn(`The image [${n}] provided to excalibur is too large may not work on all mobile devices, it is recommended you resize images to a maximum (4096x4096).

Images will likely render as black rectangles on some mobile platforms.

Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!0)}}$t._LOGGER=J.getInstance(),$t.filtering=Yt.Blended,$t.wrapping={x:Ht.Clamp,y:Ht.Clamp},$t._MAX_TEXTURE_SIZE=4096;const Kt={Filtering:"filtering",WrappingX:"wrapping-x",WrappingY:"wrapping-y"};class pn{get width(){return this.image.naturalWidth}get height(){return this.image.naturalHeight}isLoaded(){return this._src||(this._src=this.data.src),!!this._src}get image(){return this.data}constructor(t,i,n){this._logger=J.getInstance(),this.data=new Image,this._readyFuture=new _,this.ready=this._readyFuture.promise,this.path=t;let a=!1,h;typeof i=="boolean"?a=i:{filtering:n,wrapping:h,bustCache:a}={...i},this._resource=new dr(t,"blob",a),this.filtering=n??this.filtering,typeof h=="string"?this.wrapping={x:h,y:h}:this.wrapping=h??this.wrapping,(t.endsWith(".svg")||t.endsWith(".gif"))&&this._logger.warn(`Image type is not fully supported, you may have mixed results ${t}. Fully supported: jpg, bmp, and png`)}static fromHtmlImageElement(t,i){const n=new pn("");if(n._src="image-element",n.data=t,n.data.setAttribute("data-original-src","image-element"),i!=null&&i.filtering?n.data.setAttribute(Kt.Filtering,i==null?void 0:i.filtering):n.data.setAttribute(Kt.Filtering,Yt.Blended),i!=null&&i.wrapping){let a;typeof i.wrapping=="string"?a={x:i.wrapping,y:i.wrapping}:a={x:i.wrapping.x,y:i.wrapping.y},n.data.setAttribute(Kt.WrappingX,a.x),n.data.setAttribute(Kt.WrappingY,a.y)}else n.data.setAttribute(Kt.WrappingX,Ht.Clamp),n.data.setAttribute(Kt.WrappingY,Ht.Clamp);return $t.checkImageSizeSupportedAndLog(t),n._readyFuture.resolve(t),n}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){var t,i,n,a;if(this.isLoaded())return this.data;try{let h;if(this.path.includes("data:image/"))h=this.path;else{const m=await this._resource.load();h=URL.createObjectURL(m)}const d=new Image,p=new _;d.onload=()=>p.resolve(),d.src=h,d.setAttribute("data-original-src",this.path),await p.promise,this.data=d,$t.checkImageSizeSupportedAndLog(this.data)}catch(h){throw`Error loading ImageSource from path '${this.path}' with error [${h.message}]`}return this.data.setAttribute(Kt.Filtering,this.filtering),this.data.setAttribute(Kt.WrappingX,(i=(t=this.wrapping)===null||t===void 0?void 0:t.x)!==null&&i!==void 0?i:Ht.Clamp),this.data.setAttribute(Kt.WrappingY,(a=(n=this.wrapping)===null||n===void 0?void 0:n.y)!==null&&a!==void 0?a:Ht.Clamp),this._readyFuture.resolve(this.data),this.data}toSprite(){return Ps.from(this)}unload(){this.data=new Image}}class Po extends zt{constructor(t){super(t),this._text="",this.alphabet="",this.shadow=null,this.caseInsensitive=!1,this.spacing=0,this.lineHeight=void 0,this._logger=J.getInstance();const{alphabet:i,spriteSheet:n,caseInsensitive:a,spacing:h,shadow:d,lineHeight:p}=t;this.alphabet=i,this.spriteSheet=n,this.caseInsensitive=a??this.caseInsensitive,this.spacing=h??this.spacing,this.shadow=d??this.shadow,this.lineHeight=p??this.lineHeight}_getCharacterSprites(t){const i=[],n=this.caseInsensitive?t.toLocaleLowerCase():t,a=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet;for(let h=0;h<n.length;h++){const d=n[h];let p=a.indexOf(d);p===-1&&(p=0,this._logger.warnOnce(`SpriteFont - Cannot find letter '${d}' in configured alphabet '${a}'.`),this._logger.warnOnce("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."));const m=this.spriteSheet.sprites[p];m?i.push(m):(this._logger.warnOnce(`SpriteFont - Cannot find sprite for '${d}' at index '${p}' in configured SpriteSheet`),this._logger.warnOnce("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."))}return i}measureText(t,i){const n=this._getLinesFromText(t,i),a=n.reduce((m,y)=>m.length>y.length?m:y),h=this._getCharacterSprites(a);let d=0,p=0;for(const m of h)d+=m.width+this.spacing,p=Math.max(p,m.height);return et.fromDimension(d,p*n.length,E.Zero)}_drawImage(t,i,n,a){var h;let d=0,p=0,m=0;const y=this._getLinesFromText(this._text,a);for(const w of y){for(const b of this._getCharacterSprites(w))b.draw(t,i+d,n+p),d+=b.width+this.spacing,m=Math.max(m,b.height);d=0,p+=(h=this.lineHeight)!==null&&h!==void 0?h:m}}render(t,i,n,a,h,d){this._text=i;const p=this.measureText(i,d);this.width=p.width,this.height=p.height,this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this._preDraw(t,a,h),this._drawImage(t,0,0,d),this._postDraw(t),t.restore()),this._preDraw(t,a,h),this._drawImage(t,0,0,d),this._postDraw(t)}clone(){return new Po({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}_getLinesFromText(t,i){if(this._cachedText===t&&this._cachedRenderWidth===i)return this._cachedLines;const n=t.split(`
`);if(i==null)return n;for(let a=0;a<n.length;a++){let h=n[a],d="";if(this.measureText(h).width>i){for(;this.measureText(h).width>i;)d=h[h.length-1]+d,h=h.slice(0,-1);n[a]=h,n[a+1]=d}}return this._cachedText=t,this._cachedLines=n,this._cachedRenderWidth=i,n}}class Is{constructor(t){this.sprites=[];const{sprites:i,rows:n,columns:a}=t;this.sprites=i,this.rows=n??1,this.columns=a??this.sprites.length}getSprite(t,i,n){var a,h,d,p,m,y,w,b,R;if(t>=this.columns||t<0)throw Error(`No sprite exists in the SpriteSheet at (${t}, ${i}), x: ${t} should be between 0 and ${this.columns-1}`);if(i>=this.rows||i<0)throw Error(`No sprite exists in the SpriteSheet at (${t}, ${i}), y: ${i} should be between 0 and ${this.rows-1}`);const k=t+i*this.columns,M=this.sprites[k];if(M){if(n){const z=M.clone();return z.flipHorizontal=(a=n.flipHorizontal)!==null&&a!==void 0?a:z.flipHorizontal,z.flipVertical=(h=n.flipVertical)!==null&&h!==void 0?h:z.flipVertical,z.width=(d=n.width)!==null&&d!==void 0?d:z.width,z.height=(p=n.height)!==null&&p!==void 0?p:z.height,z.rotation=(m=n.rotation)!==null&&m!==void 0?m:z.rotation,z.scale=(y=n.scale)!==null&&y!==void 0?y:z.scale,z.opacity=(w=n.opacity)!==null&&w!==void 0?w:z.opacity,z.tint=(b=n.tint)!==null&&b!==void 0?b:z.tint,z.origin=(R=n.origin)!==null&&R!==void 0?R:z.origin,z}return M}throw Error(`Invalid sprite coordinates (${t}, ${i}`)}static fromImageSourceWithSourceViews(t){const i=t.sourceViews.map(n=>new Ps({image:t.image,sourceView:n}));return new Is({sprites:i})}static fromImageSource(t){var i;const n=[];t.spacing=(i=t.spacing)!==null&&i!==void 0?i:{};const{image:a,grid:{rows:h,columns:d,spriteWidth:p,spriteHeight:m},spacing:{originOffset:y,margin:w}}=t,b={x:0,y:0,...y},R={x:0,y:0,...w};for(let k=0;k<d;k++)for(let M=0;M<h;M++)n[k+M*d]=new Ps({image:a,sourceView:{x:k*p+R.x*k+b.x,y:M*m+R.y*M+b.y,width:p,height:m},destSize:{height:m,width:p}});return new Is({sprites:n,rows:h,columns:d})}clone(){return new Is({sprites:this.sprites.map(t=>t.clone()),rows:this.rows,columns:this.columns})}}const s0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAYAAAD1Xam+AAAAAXNSR0IArs4c6QAABlFJREFUeJztndmy4yoMRcWt/v9fdr8EWoDAaDD4JntVpeqcxBrMIGQDNhEAAAAAAAAAAAAAAOCrSbMfr+u6yoEpTY+906GV57YtPkjyXj9WZZ+wHWHfo2N3/bU6Tte9Rv6ptruqRyMvKvvIX/zY3I/vjLeqsg6l/CWdp0KHKO/1Y1H2EdsR9j06Ntdfp+N03SvkH2u7i3pu5XkQ+DNTkgNJSok+/183xpcdWZHjgUzpQ2pGD67vaf//KRAGAq3tdhCy2tcMQKPyXyz7iPqrdBjbX5h9g7xbtvWf4ZJvM4D/BKG24Sd+IkQ0TC9aW5NM5FbO2HgrPVzW2vmN50DZNv/QWtl5bfPy85SBtdy9dFmjsf2F2SehTBVE+u+tkE5+lAGcJlFwGuodwRRU2Qe3rx0FhPNflc3HWC7BEh8EDGVR5IMCiLnDONtPp87qhxVH/S/LvzUAuDs/kyGimA5oSONKR1w8vsLpv+v+S9vhmS71JRiX1xB5CWZNw7m6rMrllMag/RJyWb67BEgpDVMWSydc+K47pr35w05kWd7ReEq6116KaG4CsbJ7OmV9PdZLEKkONiC1/7ZONVgDsajLIJPYp2OUAXRpnPcGmnIE6eSK4nv5YQqqSYO52JqnYfYj/PdQXQIY7XszuMofMgZRT/1LdeC5h2I5/0EdWDMY2Yb05WDE1RodVdpSA5r85slArAVnSf+89iP896St0f5bZKVA7Gk/3ja8q+152/+wrLqBWZTem3IBADbRBoDuHgAA4HdAAADgh0EAAOCHQQAA4IdBAADgh0EAAOCHuVsKbJ3P9M7jjuxHzGfv8j9iDt47Dx7hP8cjq5F/o/0T62Aer//ZOgDrajBp6aNlOWTEajKLjgj/Pcs/vfZD/a++3Pc8hNfZ966EVeh5vP75luDRJUAl0KzJfnopaqbaTuzZiulc2BS5lltFXntu3dcQsXadl59Wn1H+dfYNtrt2d6D/LDF9HkCQw6eXFbr8P9X5W/un5Ol8gz1t39p5pWOPn0vLynbgdnfe8maEQw+UIPJdfxdOd/4oTtVD0IYg8wDywGas0I04T5O3P8/qf2UWwPpkn1PbOT1bN2tFe59EM7TvKf+TRFw+erZ2ey4hpS3hp9qBkqq/tjsSU1OYqucBWB1yynt5QxC42Mdk30pAEIio//zRG3feBzLUX+TTjCKwlH83aI/KbpQBVEHgUGF0j/SitcLofHem8q6AyH0wBhFv4WszuOjy0yK2vc/oRWQoP2X9ve78jfaLnpncbBqQSC6s0HnIRT0a2yNZjfxT8+ir8t+yDsDTWaS6X70GP33+d77stp+I5HtBdwEAAPBl8ECApcAA/DBvfSowAGAB7/05ZAAA/DAIAADMMU3fOuS2ggAAwBjrorKoxWiPBxHMAgAg490Ts0VeePdA+ZfJDKcCh7sBqY88mmjklZeOt9iXPrvx2I2QPRnN2/qzyJ84h4gNcbtfasq5mM1rZr+bBWh2A+bIIX13Z9wqL+nQvFno7v3oq4tJItCed7isUT6C/I7BUn9KP95wDicYBYpcjncrO2c/dmW4tBtw4RiRld1IDxDyYsoXMHxF1w3dyz0Nne8033AOFsT6VgRCafl89fenTZUfbm8CGhrgdDcS7anAsvnkkP0IeCfQ+JzYunky6jhNYj5bl7++4fJvN9WDSKS/292A0wyANyKDI91bfkm3kcH7ckaP/SKW/VHKRZAcI14pP3beu0fPyn/DuZQbWMogNnsc16sziE96f7H/iai7uTf0/3N8lwFz/e13T00Djt4OrInCnkeChXT+qOcKOLA21tJpsv/G8/COnGnw97J9QwbTvd6djYSv7fxEVTuV/LzNhj7nOawv6bfbAGCYEpQ6HxFtuxs6sq9tzOYHobQ6Nje+6vo5BwFrPZ4OgMayS4PPt1NlzdLfbRCYBoBc+NaO4JWPwLEf33oN3unY3InKPQBW6Z7nEZzEmrl4iZjC804lqgePPEOguQcwWghUphxm343wyt/pWpWR0OrR+jvyxavHajfb9pTjbt9bH07Z5/expM4TLWfwb7QQqMoC+UDWXZo/4RgA38LOgUvLJAAQ1Td9y9//0ylxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB+g79apuVUsS5ZmwAAAABJRU5ErkJggg==";class Fl{constructor(){this.fontSheet=s0,this.size=16,this.load()}load(){return this._imageSource=new pn(this.fontSheet),this._imageSource.load().then(()=>{this._spriteSheet=Is.fromImageSource({image:this._imageSource,grid:{rows:4,columns:16,spriteWidth:16,spriteHeight:16}}),this._spriteFont=new Po({alphabet:`0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&."?-()+# `,caseInsensitive:!0,spriteSheet:this._spriteSheet,spacing:-6})})}write(t,i,n){this._imageSource.isLoaded()&&this._spriteFont.render(t,i,null,n.x,n.y)}}class n0{constructor(t,i){this._gl=t,this._texture=i}use(){const t=this._gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._texture)}disable(){const t=this._gl;t.bindTexture(t.TEXTURE_2D,null)}}class Ro{constructor(t){var i,n;this.antialias=!1,this.samples=1,this._gl=t.gl,this.width=t.width,this.height=t.height,this.transparency=t.transparency,this.antialias=(i=t.antialias)!==null&&i!==void 0?i:this.antialias,this.samples=(n=t.samples)!==null&&n!==void 0?n:this._gl.getParameter(this._gl.MAX_SAMPLES);const a=this._gl;a.drawingBufferFormat?this.bufferFormat=a.drawingBufferFormat:this.transparency?this.bufferFormat=a.RGBA8:this.bufferFormat=a.RGB8,this._setupRenderBuffer(),this._setupFramebuffer()}setResolution(t,i){const n=this._gl;this.width=t,this.height=i,n.bindTexture(n.TEXTURE_2D,this._frameTexture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),this._renderBuffer&&(n.bindRenderbuffer(n.RENDERBUFFER,this._renderBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,Math.min(this.samples,n.getParameter(n.MAX_SAMPLES)),this.bufferFormat,this.width,this.height))}get renderBuffer(){return this._renderBuffer}get renderFrameBuffer(){return this._renderFrameBuffer}get frameBuffer(){return this._frameBuffer}get frameTexture(){return this._frameTexture}_setupRenderBuffer(){if(this.antialias){const t=this._gl;this._renderBuffer=t.createRenderbuffer(),this._renderFrameBuffer=t.createFramebuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this._renderBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,Math.min(this.samples,t.getParameter(t.MAX_SAMPLES)),this.bufferFormat,this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,this._renderFrameBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,this._renderBuffer)}}_setupFramebuffer(){const t=this._gl;this._frameTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._frameTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const i=t.COLOR_ATTACHMENT0;this._frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,i,t.TEXTURE_2D,this._frameTexture,0),this.disable()}toRenderSource(){return this.renderBuffer&&this.blitRenderBufferToFrameBuffer(),new n0(this._gl,this._frameTexture)}blitToScreen(){const t=this._gl;this._renderBuffer?(t.bindFramebuffer(t.READ_FRAMEBUFFER,this.renderFrameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.clearBufferfv(t.COLOR,0,[0,0,1,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.LINEAR)):(t.bindFramebuffer(t.READ_FRAMEBUFFER,this.frameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.clearBufferfv(t.COLOR,0,[0,0,1,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.LINEAR))}blitRenderBufferToFrameBuffer(){if(this._renderBuffer){const t=this._gl;t.bindFramebuffer(t.READ_FRAMEBUFFER,this.renderFrameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.frameBuffer),t.clearBufferfv(t.COLOR,0,[0,0,1,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.LINEAR)}}copyToTexture(t){const i=this._gl;this._renderBuffer&&this.blitRenderBufferToFrameBuffer(),i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.bindTexture(i.TEXTURE_2D,t),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,this.width,this.height,0)}use(){const t=this._gl;this.antialias?t.bindFramebuffer(t.FRAMEBUFFER,this._renderFrameBuffer):t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.viewport(0,0,this.width,this.height)}disable(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null)}}const r0=`#version 300 es\r
in vec2 a_position;\r
in vec4 a_color;\r
\r
out lowp vec4 v_color;\r
\r
uniform mat4 u_matrix;\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Passthrough the color\r
   v_color = a_color;\r
}`,o0=`#version 300 es\r
precision mediump float;\r
\r
// Color\r
in lowp vec4 v_color;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  fragColor = v_color;\r
}`;function Bl(u,t){switch(t){case u.FLOAT:return 4;case u.SHORT:return 2;case u.UNSIGNED_SHORT:return 2;case u.BYTE:return 1;case u.UNSIGNED_BYTE:return 1;default:return 1}}function Pd(u,t){const i=`(?<type>[a-z0-9]+)\\s+${t};`,a=new RegExp(i,"g").exec(u);return(a==null?void 0:a.length)>0}function Rd(u,t,i){var n;const a=`(?<type>[a-z0-9]+)\\s+${i};`,d=new RegExp(a,"g").exec(t);switch((n=d==null?void 0:d.groups)===null||n===void 0?void 0:n.type){case"float":case"vec2":case"vec3":case"vec4":return u.FLOAT;case"int":case"ivec2":case"ivec3":case"ivec4":return u.INT;case"uint":case"uvec2":case"uvec3":case"uvec4":return u.UNSIGNED_INT;case"bool":case"bvec2":case"bvec3":case"bvec4":return u.BOOL;case"short":return u.SHORT;case"ushort":return u.UNSIGNED_SHORT;case"ubyte":return u.UNSIGNED_BYTE;case"byte":return u.BYTE;default:return u.FLOAT}}function Id(u,t){switch(t){case u.LOW_FLOAT:case u.HIGH_FLOAT:case u.FLOAT:return 1;case u.FLOAT_VEC2:return 2;case u.FLOAT_VEC3:return 3;case u.FLOAT_VEC4:return 4;case u.BYTE:return 1;case u.UNSIGNED_BYTE:return 1;case u.UNSIGNED_SHORT:case u.SHORT:return 1;default:return 1}}function Dd(u,t){switch(t){case u.LOW_FLOAT:case u.HIGH_FLOAT:case u.FLOAT:case u.FLOAT_VEC2:case u.FLOAT_VEC3:case u.FLOAT_VEC4:return u.FLOAT;case u.BYTE:return u.BYTE;case u.UNSIGNED_BYTE:return u.UNSIGNED_BYTE;case u.SHORT:return u.SHORT;case u.UNSIGNED_SHORT:return u.UNSIGNED_SHORT;default:return u.FLOAT}}class Ye{get compiled(){return this._compiled}constructor(t){this._logger=J.getInstance(),this.uniforms={},this.attributes={},this._compiled=!1;const{gl:i,vertexSource:n,fragmentSource:a}=t;this._gl=i,this.vertexSource=n,this.fragmentSource=a}dispose(){this._gl.deleteProgram(this.program),this._gl=null}use(){this._gl.useProgram(this.program),Ye._ACTIVE_SHADER_INSTANCE=this}isCurrentlyBound(){return Ye._ACTIVE_SHADER_INSTANCE===this}compile(){const t=this._gl,i=this._compileShader(t,this.vertexSource,t.VERTEX_SHADER),n=this._compileShader(t,this.fragmentSource,t.FRAGMENT_SHADER);this.program=this._createProgram(t,i,n);const a=this.getAttributes();for(const d of a)this.attributes[d.name]=d;const h=this.getUniforms();for(const d of h)this.uniforms[d.name]=d;return this._compiled=!0,this.program}getUniforms(){const t=this._gl,i=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),n=[];for(let a=0;a<i;a++){const h=t.getActiveUniform(this.program,a),d=t.getUniformLocation(this.program,h.name);n.push({name:h.name,glType:h.type,location:d})}return n}getAttributes(){const t=this._gl,i=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),n=[];for(let a=0;a<i;a++){const h=t.getActiveAttrib(this.program,a),d=t.getAttribLocation(this.program,h.name);n.push({name:h.name,glType:Dd(t,h.type),size:Id(t,h.type),location:d,normalized:!1})}return n}setTexture(t,i){const n=this._gl;n.activeTexture(n.TEXTURE0+t),n.bindTexture(n.TEXTURE_2D,i)}setUniformInt(t,i){this.setUniform("uniform1i",t,~~i)}trySetUniformInt(t,i){return this.trySetUniform("uniform1i",t,~~i)}setUniformIntArray(t,i){this.setUniform("uniform1iv",t,i)}trySetUniformIntArray(t,i){return this.trySetUniform("uniform1iv",t,i)}setUniformBoolean(t,i){this.setUniform("uniform1i",t,i?1:0)}trySetUniformBoolean(t,i){return this.trySetUniform("uniform1i",t,i?1:0)}setUniformFloat(t,i){this.setUniform("uniform1f",t,i)}trySetUniformFloat(t,i){return this.trySetUniform("uniform1f",t,i)}setUniformFloatArray(t,i){this.setUniform("uniform1fv",t,i)}trySetUniformFloatArray(t,i){return this.trySetUniform("uniform1fv",t,i)}setUniformFloatVector(t,i){this.setUniform("uniform2f",t,i.x,i.y)}trySetUniformFloatVector(t,i){return this.trySetUniform("uniform2f",t,i.x,i.y)}setUniformFloatColor(t,i){this.setUniform("uniform4f",t,i.r/255,i.g/255,i.b/255,i.a)}trySetUniformFloatColor(t,i){return this.trySetUniform("uniform4f",t,i.r/255,i.g/255,i.b/255,i.a)}setUniformMatrix(t,i){this.setUniform("uniformMatrix4fv",t,!1,i.data)}trySetUniformMatrix(t,i){return this.trySetUniform("uniformMatrix4fv",t,!1,i.data)}setUniform(t,i,...n){if(!this._compiled)throw Error(`Must compile shader before setting a uniform ${t}:${i}`);if(!this.isCurrentlyBound())throw Error("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms");const h=this._gl.getUniformLocation(this.program,i);if(h){const d=[h,...n];this._gl[t].apply(this._gl,d)}else throw Error(`Uniform ${t}:${i} doesn't exist or is not used in the shader source code, unused uniforms are optimized away by most browsers`)}trySetUniform(t,i,...n){if(!this._compiled)return this._logger.warn(`Must compile shader before setting a uniform ${t}:${i}`),!1;if(!this.isCurrentlyBound())return this._logger.warn("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms"),!1;const h=this._gl.getUniformLocation(this.program,i);if(h){const d=[h,...n];this._gl[t].apply(this._gl,d)}else return!1;return!0}_createProgram(t,i,n){const a=t.createProgram();if(a===null)throw Error("Could not create graphics shader program");if(t.attachShader(a,i),t.attachShader(a,n),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw Error(`Could not link the program: [${t.getProgramInfoLog(a)}]`);return a}_compileShader(t,i,n){const a=t.VERTEX_SHADER===n?"vertex":"fragment",h=t.createShader(n);if(h===null)throw Error(`Could not build shader: [${i}]`);if(t.shaderSource(h,i),t.compileShader(h),!t.getShaderParameter(h,t.COMPILE_STATUS)){const p=t.getShaderInfoLog(h);throw Error(`Could not compile ${a} shader:

${p}${this._processSourceForError(i,p)}`)}return h}_processSourceForError(t,i){if(!t)return i;const n=t.split(`
`),a=i.search(/\d:\d/),h=i.indexOf(" ",a),[d,p]=i.slice(a,h).split(":").map(m=>Number(m));for(let m=0;m<n.length;m++)n[m]=`${m+1}: ${n[m]}${p===m+1?" <----- ERROR!":""}`;return`

Source:
`+n.join(`
`)}}Ye._ACTIVE_SHADER_INSTANCE=null;class zi{constructor(t){this.type="dynamic";const{gl:i,size:n,type:a,data:h}=t;if(this._gl=i,this.buffer=this._gl.createBuffer(),!h&&!n)throw Error("Must either provide data or a size to the VertexBuffer");h?this.bufferData=h:this.bufferData=new Float32Array(n),this.type=a??this.type,i.bindBuffer(i.ARRAY_BUFFER,this.buffer),i.bufferData(i.ARRAY_BUFFER,this.bufferData,this.type==="static"?i.STATIC_DRAW:i.DYNAMIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}unbind(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,null)}upload(t){const i=this._gl;i.bindBuffer(i.ARRAY_BUFFER,this.buffer),t?i.bufferSubData(i.ARRAY_BUFFER,0,this.bufferData,0,t):i.bufferData(i.ARRAY_BUFFER,this.bufferData,this.type==="static"?i.STATIC_DRAW:i.DYNAMIC_DRAW)}dispose(){this._gl.deleteBuffer(this.buffer),this._gl=null}}class Hi{get vertexBuffer(){return this._vertexBuffer}get attributes(){return this._attributes}constructor(t){this._logger=J.getInstance(),this._suppressWarnings=!1,this._layout=[],this._attributes=[],this._vertexTotalSizeBytes=0,this._initialized=!1;const{gl:i,shader:n,vertexBuffer:a,attributes:h,suppressWarnings:d}=t;this._gl=i,this._vertexBuffer=a,this._attributes=h,this._shader=n,this._suppressWarnings=d,n&&this.initialize()}get totalVertexSizeBytes(){return this._vertexTotalSizeBytes}set shader(t){t&&this._shader!==t&&(this._shader=t,this.initialize())}get shader(){return this._shader}initialize(){if(this._initialized||!this._shader)return;if(!this._shader.compiled)throw Error("Shader not compiled, shader must be compiled before defining a vertex layout");this._vertexTotalSizeBytes=0,this._layout.length=0;const t=this._shader.attributes;for(const h of this._attributes){const d=t[h[0]];if(!d){if(!Pd(this._shader.vertexSource,h[0]))throw Error(`The attribute named: ${h[0]} size ${h[1]} not found in the shader source code:
 ${this._shader.vertexSource}`);this._suppressWarnings||this._logger.warn(`The attribute named: ${h[0]} size ${h[1]} not found in the compiled shader. This is possibly a bug:
 1. Not a bug, but should remove unused code - attribute "${h[0]}" is unused in vertex/fragment and has been automatically removed by glsl compiler.
 2. Definitely a bug, attribute "${h[0]}" in layout has been mistyped or is missing in shader, check vertex/fragment source.`);const p=Rd(this._gl,this._shader.vertexSource,h[0]);this._layout.push({name:h[0],glType:p,size:h[1],location:-1,normalized:!1})}if(d){if(d.size!==h[1])throw Error(`VertexLayout size definition for attribute: [${h[0]}, ${h[1]}], doesn't match shader source size ${d.size}:
 ${this._shader.vertexSource}`);this._layout.push(d)}}let i=0;for(const h of this._layout){const d=Bl(this._gl,h.glType);this._vertexTotalSizeBytes+=d*h.size,i+=h.size}this._vertexBuffer.bufferData.length%i!==0&&this._logger.warn(`The vertex component size (${i})  does NOT divide evenly into the specified vertex buffer (${this._vertexBuffer.bufferData.length})`);const n=this._gl;this._vao=n.createVertexArray(),n.bindVertexArray(this._vao),this._vertexBuffer.bind();let a=0;for(const h of this._layout)h.location!==-1&&(n.vertexAttribPointer(h.location,h.size,h.glType,h.normalized,this.totalVertexSizeBytes,a),n.enableVertexAttribArray(h.location)),a+=Bl(n,h.glType)*h.size;n.bindVertexArray(null),this._vertexBuffer.unbind(),this._initialized=!0}use(t=!1,i){if(!this._shader)throw Error("No shader is associated with this vertex layout, a shader must be set");const n=this._gl;if(!this._shader.isCurrentlyBound())throw Error("Shader associated with this vertex layout is not active! Call shader.use() before layout.use()");this._vertexBuffer.bind(),t&&this._vertexBuffer.upload(i),n.bindVertexArray(this._vao)}}class kt{static clear(){kt.DrawCallCount=0,kt.DrawnImagesCount=0}}kt.DrawCallCount=0,kt.DrawnImagesCount=0;class a0{constructor(){this.type="ex.line",this.priority=0,this._maxLines=10922,this._vertexIndex=0,this._lineCount=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new Ye({gl:t,vertexSource:r0,fragmentSource:o0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._vertexBuffer=new zi({gl:t,size:6*2*this._maxLines,type:"dynamic"}),this._layout=new Hi({gl:t,vertexBuffer:this._vertexBuffer,shader:this._shader,attributes:[["a_position",2],["a_color",4]]})}dispose(){this._vertexBuffer.dispose(),this._shader.dispose(),this._context=null,this._gl=null}draw(t,i,n){this._isFull()&&this.flush(),this._lineCount++;const a=this._context.getTransform(),h=a.multiply(t),d=a.multiply(i),p=this._vertexBuffer.bufferData;p[this._vertexIndex++]=h.x,p[this._vertexIndex++]=h.y,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a,p[this._vertexIndex++]=d.x,p[this._vertexIndex++]=d.y,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a}_isFull(){return this._lineCount>=this._maxLines}hasPendingDraws(){return this._lineCount!==0}flush(){if(this._lineCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.LINES,0,this._lineCount*2),kt.DrawnImagesCount+=this._lineCount,kt.DrawCallCount++,this._vertexIndex=0,this._lineCount=0}}const l0=`#version 300 es\r
in vec2 a_position;\r
in vec4 a_color;\r
in float a_size;\r
out lowp vec4 v_color;\r
uniform mat4 u_matrix;\r
\r
void main() {\r
  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
  gl_PointSize = a_size * 2.0;\r
  v_color = a_color;\r
}`,h0=`#version 300 es\r
\r
precision mediump float;\r
in lowp vec4 v_color;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  float r = 0.0, delta = 0.0, alpha = 1.0;\r
  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r
  r = dot(cxy, cxy);\r
\r
  delta = fwidth(r);\r
  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r
  // "premultiply" the color by alpha\r
  vec4 color = v_color;\r
  color.a = color.a * alpha;\r
  color.rgb = color.rgb * color.a;\r
  fragColor = color;\r
}`;class c0{constructor(){this.type="ex.point",this.priority=0,this._maxPoints=10922,this._pointCount=0,this._vertexIndex=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new Ye({gl:t,vertexSource:l0,fragmentSource:h0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._buffer=new zi({gl:t,size:7*this._maxPoints,type:"dynamic"}),this._layout=new Hi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_color",4],["a_size",1]]})}dispose(){this._buffer.dispose(),this._shader.dispose(),this._context=null,this._gl=null}draw(t,i,n){this._isFull()&&this.flush(),this._pointCount++;const a=this._context.getTransform(),h=this._context.opacity,d=this._context.snapToPixel,p=a.multiply(t);d&&(p.x=~~(p.x+vt),p.y=~~(p.y+vt));const m=this._buffer.bufferData;m[this._vertexIndex++]=p.x,m[this._vertexIndex++]=p.y,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a*h,m[this._vertexIndex++]=n*Math.max(a.getScaleX(),a.getScaleY())}_isFull(){return this._pointCount>=this._maxPoints}hasPendingDraws(){return this._pointCount!==0}flush(){if(this._pointCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.POINTS,0,this._pointCount),kt.DrawnImagesCount+=this._pointCount,kt.DrawCallCount++,this._pointCount=0,this._vertexIndex=0}}const u0=`#version 300 es\r
in vec2 a_position;\r
\r
in vec2 a_texcoord;\r
out vec2 v_texcoord;\r
\r
void main() {\r
  gl_Position = vec4(a_position, 0.0, 1.0);\r
\r
  // Pass the texcoord to the fragment shader.\r
  v_texcoord = a_texcoord;\r
}`,d0=`#version 300 es\r
precision mediump float;\r
\r
// Passed in from the vertex shader.\r
in vec2 v_texcoord;\r
\r
// The texture.\r
uniform sampler2D u_texture;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
   fragColor = texture(u_texture, v_texcoord);\r
}`;class f0{constructor(t){this._gl=t,this._shader=new Ye({gl:t,vertexSource:u0,fragmentSource:d0}),this._shader.compile(),this._buffer=new zi({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new Hi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}renderWithPostProcessor(t){const i=this._gl;t.getShader().use(),t.getLayout().use(),i.drawArrays(i.TRIANGLES,0,6)}renderToScreen(){const t=this._gl;this._shader.use(),this._layout.use(),t.drawArrays(t.TRIANGLES,0,6)}}class fr{constructor(t,i,n){this._logger=J.getInstance(),this._gl=t,this.buffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer);const a=i*6;if(!n)this.bufferData=new Uint32Array(a);else{const p=Math.floor(16383.5);this.bufferGlType=t.UNSIGNED_SHORT,this.bufferData=new Uint16Array(a),i>p&&this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${p}) requested quads(${i})`)}let h=0;for(let d=0;d<a;d+=6)this.bufferData[d+0]=h+0,this.bufferData[d+1]=h+1,this.bufferData[d+2]=h+2,this.bufferData[d+3]=h+2,this.bufferData[d+4]=h+1,this.bufferData[d+5]=h+3,h+=4;t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}get size(){return this.bufferData.length}upload(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer)}dispose(){this._gl.deleteBuffer(this.buffer),this._gl=null}}const p0=`#version 300 es\r
precision mediump float;\r
\r
// UV coord\r
in vec2 v_texcoord;\r
\r
// Texture index\r
in lowp float v_textureIndex;\r
\r
// Textures in the current draw\r
uniform sampler2D u_textures[%%count%%];\r
\r
uniform bool u_pixelart;\r
\r
// Opacity\r
in float v_opacity;\r
\r
in vec4 v_tint;\r
\r
in vec2 v_res;\r
\r
out vec4 fragColor;\r
\r
// Inigo Quilez pixel art filter https://jorenjoestar.github.io/post/pixel_art_filtering/\r
vec2 uv_iq(in vec2 uv, in vec2 texture_size) {\r
  vec2 pixel = uv * texture_size;\r
  \r
  vec2 seam=floor(pixel+.5);\r
  vec2 dudv=fwidth(pixel);\r
  pixel=seam+clamp((pixel-seam)/dudv,-.5,.5);\r
  \r
  return pixel/texture_size;\r
}\r
\r
void main(){\r
  // In order to support the most efficient sprite batching, we have multiple\r
  // textures loaded into the gpu (usually 8) this picker logic skips over textures\r
  // that do not apply to a particular sprite.\r
  \r
  vec4 color=vec4(1.,0,0,1.);\r
  \r
  // GLSL is templated out to pick the right texture and set the vec4 color\r
  %%texture_picker%%\r
  \r
  color.rgb=color.rgb*v_opacity;\r
  color.a=color.a*v_opacity;\r
  fragColor=color*v_tint;\r
}`,g0=`#version 300 es\r
in vec2 a_position;\r
\r
// Opacity\r
in float a_opacity;\r
out float v_opacity;\r
\r
// UV coordinate\r
in vec2 a_texcoord;\r
out vec2 v_texcoord;\r
\r
// Texture res\r
in vec2 a_res;\r
out vec2 v_res;\r
\r
// Texture number\r
in lowp float a_textureIndex;\r
out lowp float v_textureIndex;\r
\r
in vec4 a_tint;\r
out vec4 v_tint;\r
\r
uniform mat4 u_matrix;\r
\r
void main(){\r
  // Set the vertex position using the ortho transform matrix\r
  gl_Position=u_matrix*vec4(a_position,0.,1.);\r
  \r
  // Pass through the Opacity to the fragment shader\r
  v_opacity=a_opacity;\r
  // Pass through the UV coord to the fragment shader\r
  v_texcoord=a_texcoord;\r
\r
  v_res = a_res;\r
\r
  // Pass through the texture number to the fragment shader\r
  v_textureIndex=a_textureIndex;\r
  // Pass through the tint\r
  v_tint=a_tint;\r
}`;class m0{constructor(t){this.type="ex.image",this.priority=0,this._maxImages=10922,this._maxTextures=0,this._imageCount=0,this._textures=[],this._textureIndex=0,this._textureToIndex=new Map,this._images=new Set,this._vertexIndex=0,this._imageToWidth=new Map,this._imageToHeight=new Map,this._view=[0,0,0,0],this._dest=[0,0],this._quad=[0,0,0,0,0,0,0,0],this.pixelArtSampler=t.pixelArtSampler,this.uvPadding=t.uvPadding}initialize(t,i){this._gl=t,this._context=i,this._maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),125);const n=this._transformFragmentSource(p0,this._maxTextures);this._shader=new Ye({gl:t,fragmentSource:n,vertexSource:g0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",i.ortho),this._shader.setUniformIntArray("u_textures",[...Array(this._maxTextures)].map((a,h)=>h)),this._buffer=new zi({gl:t,size:12*4*this._maxImages,type:"dynamic"}),this._layout=new Hi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_opacity",1],["a_res",2],["a_texcoord",2],["a_textureIndex",1],["a_tint",4]]}),this._quads=new fr(t,this._maxImages,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._shader.dispose(),this._textures.length=0,this._context=null,this._gl=null}_transformFragmentSource(t,i){let n=t.replace("%%count%%",i.toString()),a="";for(let h=0;h<i;h++)h===0?a+=`if (v_textureIndex <= ${h}.5) {
`:a+=`   else if (v_textureIndex <= ${h}.5) {
`,a+=`      vec2 uv = u_pixelart ? uv_iq(v_texcoord, v_res) : v_texcoord;
`,a+=`      color = texture(u_textures[${h}], uv);
`,a+=`   }
`;return n=n.replace("%%texture_picker%%",a),n}_addImageAsTexture(t){if(this._images.has(t))return;const i=t.getAttribute(Kt.Filtering),n=i?To(i):null,a=Rs(t.getAttribute(Kt.WrappingX)),h=Rs(t.getAttribute(Kt.WrappingY)),d=t.getAttribute("forceUpload")==="true",p=this._context.textureLoader.load(t,{filtering:n,wrapping:{x:a,y:h}},d);t.removeAttribute("forceUpload"),this._textures.indexOf(p)===-1&&(this._textures.push(p),this._textureToIndex.set(p,this._textureIndex++),this._images.add(t))}_bindTextures(t){for(let i=0;i<this._maxTextures;i++)t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,this._textures[i]||this._textures[0])}_getTextureIdForImage(t){var i;if(t){const n=this._context.textureLoader.get(t);return(i=this._textureToIndex.get(n))!==null&&i!==void 0?i:-1}return-1}_isFull(){return this._imageCount>=this._maxImages||this._textures.length>=this._maxTextures}_getImageWidth(t){let i=this._imageToWidth.get(t);return i===void 0&&(i=t.width,this._imageToWidth.set(t,i)),i}_getImageHeight(t){let i=this._imageToHeight.get(t);return i===void 0&&(i=t.height,this._imageToHeight.set(t,i)),i}draw(t,i,n,a,h,d,p,m,y){var w,b,R,k;this._isFull()&&this.flush(),this._imageCount++,this._addImageAsTexture(t);const M=this._getImageWidth(t),z=this._getImageHeight(t);let X=M||a||0,N=z||h||0;this._view[0]=0,this._view[1]=0,this._view[2]=(w=a??M)!==null&&w!==void 0?w:0,this._view[3]=(b=h??z)!==null&&b!==void 0?b:0,this._dest[0]=i??1,this._dest[1]=n??1,d!==void 0&&p!==void 0&&m!==void 0&&y!==void 0&&(this._view[0]=i??1,this._view[1]=n??1,this._view[2]=(R=a??M)!==null&&R!==void 0?R:0,this._view[3]=(k=h??z)!==null&&k!==void 0?k:0,this._dest[0]=d,this._dest[1]=p,X=m,N=y),i=this._view[0],n=this._view[1];const U=this._view[2],Y=this._view[3],H=this._context.getTransform(),tt=this._context.opacity,gt=this._context.snapToPixel;this._quad[0]=this._dest[0],this._quad[1]=this._dest[1],this._quad[2]=this._dest[0]+X,this._quad[3]=this._dest[1],this._quad[4]=this._dest[0],this._quad[5]=this._dest[1]+N,this._quad[6]=this._dest[0]+X,this._quad[7]=this._dest[1]+N,H.multiplyQuadInPlace(this._quad),gt&&(this._quad[0]=~~(this._quad[0]+L(this._quad[0])*vt),this._quad[1]=~~(this._quad[1]+L(this._quad[1])*vt),this._quad[2]=~~(this._quad[2]+L(this._quad[2])*vt),this._quad[3]=~~(this._quad[3]+L(this._quad[3])*vt),this._quad[4]=~~(this._quad[4]+L(this._quad[4])*vt),this._quad[5]=~~(this._quad[5]+L(this._quad[5])*vt),this._quad[6]=~~(this._quad[6]+L(this._quad[6])*vt),this._quad[7]=~~(this._quad[7]+L(this._quad[7])*vt));const $=this._context.tint,mt=this._getTextureIdForImage(t),Bt=M||X,le=z||N,Ne=(i+this.uvPadding)/Bt,Ue=(n+this.uvPadding)/le,ze=(i+U-this.uvPadding)/Bt,Re=(n+Y-this.uvPadding)/le,ge=M,me=z,ot=this._layout.vertexBuffer.bufferData;ot[this._vertexIndex++]=this._quad[0],ot[this._vertexIndex++]=this._quad[1],ot[this._vertexIndex++]=tt,ot[this._vertexIndex++]=ge,ot[this._vertexIndex++]=me,ot[this._vertexIndex++]=Ne,ot[this._vertexIndex++]=Ue,ot[this._vertexIndex++]=mt,ot[this._vertexIndex++]=$.r/255,ot[this._vertexIndex++]=$.g/255,ot[this._vertexIndex++]=$.b/255,ot[this._vertexIndex++]=$.a,ot[this._vertexIndex++]=this._quad[4],ot[this._vertexIndex++]=this._quad[5],ot[this._vertexIndex++]=tt,ot[this._vertexIndex++]=ge,ot[this._vertexIndex++]=me,ot[this._vertexIndex++]=Ne,ot[this._vertexIndex++]=Re,ot[this._vertexIndex++]=mt,ot[this._vertexIndex++]=$.r/255,ot[this._vertexIndex++]=$.g/255,ot[this._vertexIndex++]=$.b/255,ot[this._vertexIndex++]=$.a,ot[this._vertexIndex++]=this._quad[2],ot[this._vertexIndex++]=this._quad[3],ot[this._vertexIndex++]=tt,ot[this._vertexIndex++]=ge,ot[this._vertexIndex++]=me,ot[this._vertexIndex++]=ze,ot[this._vertexIndex++]=Ue,ot[this._vertexIndex++]=mt,ot[this._vertexIndex++]=$.r/255,ot[this._vertexIndex++]=$.g/255,ot[this._vertexIndex++]=$.b/255,ot[this._vertexIndex++]=$.a,ot[this._vertexIndex++]=this._quad[6],ot[this._vertexIndex++]=this._quad[7],ot[this._vertexIndex++]=tt,ot[this._vertexIndex++]=ge,ot[this._vertexIndex++]=me,ot[this._vertexIndex++]=ze,ot[this._vertexIndex++]=Re,ot[this._vertexIndex++]=mt,ot[this._vertexIndex++]=$.r/255,ot[this._vertexIndex++]=$.g/255,ot[this._vertexIndex++]=$.b/255,ot[this._vertexIndex++]=$.a}hasPendingDraws(){return this._imageCount!==0}flush(){if(this._imageCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0,4*12*this._imageCount),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._shader.setUniformBoolean("u_pixelart",this.pixelArtSampler),this._bindTextures(t),this._quads.bind(),t.drawElements(t.TRIANGLES,this._imageCount*6,this._quads.bufferGlType,0),kt.DrawnImagesCount+=this._imageCount,kt.DrawCallCount++,this._imageCount=0,this._vertexIndex=0,this._textures.length=0,this._textureIndex=0,this._textureToIndex.clear(),this._images.clear(),this._imageToWidth.clear(),this._imageToHeight.clear()}}const _0=`#version 300 es\r
\r
precision mediump float;\r
\r
// UV coord\r
in vec2 v_uv;\r
\r
in vec2 v_size; // in pixels\r
\r
// Color coord to blend with image\r
in lowp vec4 v_color;\r
\r
// Stroke color if used\r
in lowp vec4 v_strokeColor;\r
\r
// Stroke thickness if used\r
in lowp float v_strokeThickness; // in pixels\r
\r
// Opacity\r
in float v_opacity;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r
    vec2 uv = v_uv;\r
    vec2 fragCoord = uv * v_size;\r
    float maxX = v_size.x - v_strokeThickness;\r
    float minX = v_strokeThickness;\r
    float maxY = v_size.y - v_strokeThickness;\r
    float minY = v_strokeThickness;\r
\r
    if (fragCoord.x < maxX && fragCoord.x > minX &&\r
        fragCoord.y < maxY && fragCoord.y > minY) {\r
      fragColor = v_color;\r
    } else {\r
      fragColor = v_strokeColor;\r
    }\r
    fragColor.a *= v_opacity;\r
    fragColor.rgb *= fragColor.a;\r
\r
    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\r
    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\r
\r
    // float fHalfBorderDist      = 0.0;\r
    // float fHalfBorderThickness = 0.0;\r
\r
    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \r
    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\r
    // {\r
    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\r
    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r
    // }\r
    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \r
    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\r
    // {\r
    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\r
    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r
    // }\r
    // else\r
    // {\r
    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\r
    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\r
    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\r
        \r
    //     float ellipse_ab    = v_radius-v_strokeThickness;\r
    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\r
    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \r
            \r
    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\r
    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\r
    // }\r
\r
    // vec4 v4FromColor = v_strokeColor;\r
    // v4FromColor.rgb *= v4FromColor.a;\r
    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\r
    // if (fHalfBorderDist < 0.0) {\r
    //     v4ToColor = v_color;\r
    //     v4ToColor.rgb *= v4ToColor.a;\r
    // }\r
\r
    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\r
\r
    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\r
    // gl_FragColor = finalColor;\r
}`,v0=`#version 300 es\r
in vec2 a_position;\r
\r
// UV coordinate\r
in vec2 a_uv;\r
out vec2 v_uv;\r
\r
in vec2 a_size;\r
out vec2 v_size;\r
\r
// Opacity \r
in float a_opacity;\r
out float v_opacity;\r
\r
in vec4 a_color;\r
out vec4 v_color;\r
\r
in vec4 a_strokeColor;\r
out vec4 v_strokeColor;\r
\r
in float a_strokeThickness;\r
out float v_strokeThickness;\r
\r
uniform mat4 u_matrix;\r
\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Pass through UV coords\r
   v_uv = a_uv;\r
   // Pass through size\r
   v_size = a_size;\r
   // Pass through the Opacity to the fragment shader\r
   v_opacity = a_opacity;\r
   // Pass through the color to the fragment shader\r
   v_color = a_color;\r
   // Pass through the stroke color to the fragment shader\r
   v_strokeColor = a_strokeColor;\r
   // Pass through the stroke thickenss to the fragment shader\r
   v_strokeThickness = a_strokeThickness;\r
}`;class y0{constructor(){this.type="ex.rectangle",this.priority=0,this._maxRectangles=10922,this._rectangleCount=0,this._vertexIndex=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new Ye({gl:t,fragmentSource:_0,vertexSource:v0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",i.ortho),this._buffer=new zi({gl:t,size:16*4*this._maxRectangles,type:"dynamic"}),this._layout=new Hi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_size",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new fr(t,this._maxRectangles,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._shader.dispose(),this._context=null,this._gl=null}_isFull(){return this._rectangleCount>=this._maxRectangles}draw(...t){t[0]instanceof E&&t[1]instanceof E?this.drawLine.apply(this,t):this.drawRectangle.apply(this,t)}drawLine(t,i,n,a=1){this._isFull()&&this.flush(),this._rectangleCount++;const h=this._context.getTransform(),d=this._context.opacity,p=this._context.snapToPixel,m=i.sub(t),y=m.size,w=m.normalize().perpendicular(),b=a/2,R=h.multiply(w.scale(b).add(t)),k=h.multiply(w.scale(-b).add(t)),M=h.multiply(w.scale(b).add(i)),z=h.multiply(w.scale(-b).add(i));p&&(R.x=~~(R.x+vt),R.y=~~(R.y+vt),M.x=~~(M.x+vt),M.y=~~(M.y+vt),k.x=~~(k.x+vt),k.y=~~(k.y+vt),z.x=~~(z.x+vt),z.y=~~(z.y+vt));const X=0,N=0,U=1,Y=1,H=G.Transparent,tt=0,gt=1,$=this._layout.vertexBuffer.bufferData;$[this._vertexIndex++]=R.x,$[this._vertexIndex++]=R.y,$[this._vertexIndex++]=X,$[this._vertexIndex++]=N,$[this._vertexIndex++]=y,$[this._vertexIndex++]=a,$[this._vertexIndex++]=d,$[this._vertexIndex++]=n.r/255,$[this._vertexIndex++]=n.g/255,$[this._vertexIndex++]=n.b/255,$[this._vertexIndex++]=n.a,$[this._vertexIndex++]=H.r/255,$[this._vertexIndex++]=H.g/255,$[this._vertexIndex++]=H.b/255,$[this._vertexIndex++]=H.a,$[this._vertexIndex++]=tt/gt,$[this._vertexIndex++]=k.x,$[this._vertexIndex++]=k.y,$[this._vertexIndex++]=X,$[this._vertexIndex++]=Y,$[this._vertexIndex++]=y,$[this._vertexIndex++]=a,$[this._vertexIndex++]=d,$[this._vertexIndex++]=n.r/255,$[this._vertexIndex++]=n.g/255,$[this._vertexIndex++]=n.b/255,$[this._vertexIndex++]=n.a,$[this._vertexIndex++]=H.r/255,$[this._vertexIndex++]=H.g/255,$[this._vertexIndex++]=H.b/255,$[this._vertexIndex++]=H.a,$[this._vertexIndex++]=tt/gt,$[this._vertexIndex++]=M.x,$[this._vertexIndex++]=M.y,$[this._vertexIndex++]=U,$[this._vertexIndex++]=N,$[this._vertexIndex++]=y,$[this._vertexIndex++]=a,$[this._vertexIndex++]=d,$[this._vertexIndex++]=n.r/255,$[this._vertexIndex++]=n.g/255,$[this._vertexIndex++]=n.b/255,$[this._vertexIndex++]=n.a,$[this._vertexIndex++]=H.r/255,$[this._vertexIndex++]=H.g/255,$[this._vertexIndex++]=H.b/255,$[this._vertexIndex++]=H.a,$[this._vertexIndex++]=tt/gt,$[this._vertexIndex++]=z.x,$[this._vertexIndex++]=z.y,$[this._vertexIndex++]=U,$[this._vertexIndex++]=Y,$[this._vertexIndex++]=y,$[this._vertexIndex++]=a,$[this._vertexIndex++]=d,$[this._vertexIndex++]=n.r/255,$[this._vertexIndex++]=n.g/255,$[this._vertexIndex++]=n.b/255,$[this._vertexIndex++]=n.a,$[this._vertexIndex++]=H.r/255,$[this._vertexIndex++]=H.g/255,$[this._vertexIndex++]=H.b/255,$[this._vertexIndex++]=H.a,$[this._vertexIndex++]=tt/gt}drawRectangle(t,i,n,a,h=G.Transparent,d=0){this._isFull()&&this.flush(),this._rectangleCount++;const p=this._context.getTransform(),m=this._context.opacity,y=this._context.snapToPixel,w=p.multiply(t.add(B(0,0))),b=p.multiply(t.add(B(i,0))),R=p.multiply(t.add(B(i,n))),k=p.multiply(t.add(B(0,n)));y&&(w.x=~~(w.x+vt),w.y=~~(w.y+vt),b.x=~~(b.x+vt),b.y=~~(b.y+vt),k.x=~~(k.x+vt),k.y=~~(k.y+vt),R.x=~~(R.x+vt),R.y=~~(R.y+vt));const M=0,z=0,X=1,N=1,U=this._layout.vertexBuffer.bufferData;U[this._vertexIndex++]=w.x,U[this._vertexIndex++]=w.y,U[this._vertexIndex++]=M,U[this._vertexIndex++]=z,U[this._vertexIndex++]=i,U[this._vertexIndex++]=n,U[this._vertexIndex++]=m,U[this._vertexIndex++]=a.r/255,U[this._vertexIndex++]=a.g/255,U[this._vertexIndex++]=a.b/255,U[this._vertexIndex++]=a.a,U[this._vertexIndex++]=h.r/255,U[this._vertexIndex++]=h.g/255,U[this._vertexIndex++]=h.b/255,U[this._vertexIndex++]=h.a,U[this._vertexIndex++]=d,U[this._vertexIndex++]=k.x,U[this._vertexIndex++]=k.y,U[this._vertexIndex++]=M,U[this._vertexIndex++]=N,U[this._vertexIndex++]=i,U[this._vertexIndex++]=n,U[this._vertexIndex++]=m,U[this._vertexIndex++]=a.r/255,U[this._vertexIndex++]=a.g/255,U[this._vertexIndex++]=a.b/255,U[this._vertexIndex++]=a.a,U[this._vertexIndex++]=h.r/255,U[this._vertexIndex++]=h.g/255,U[this._vertexIndex++]=h.b/255,U[this._vertexIndex++]=h.a,U[this._vertexIndex++]=d,U[this._vertexIndex++]=b.x,U[this._vertexIndex++]=b.y,U[this._vertexIndex++]=X,U[this._vertexIndex++]=z,U[this._vertexIndex++]=i,U[this._vertexIndex++]=n,U[this._vertexIndex++]=m,U[this._vertexIndex++]=a.r/255,U[this._vertexIndex++]=a.g/255,U[this._vertexIndex++]=a.b/255,U[this._vertexIndex++]=a.a,U[this._vertexIndex++]=h.r/255,U[this._vertexIndex++]=h.g/255,U[this._vertexIndex++]=h.b/255,U[this._vertexIndex++]=h.a,U[this._vertexIndex++]=d,U[this._vertexIndex++]=R.x,U[this._vertexIndex++]=R.y,U[this._vertexIndex++]=X,U[this._vertexIndex++]=N,U[this._vertexIndex++]=i,U[this._vertexIndex++]=n,U[this._vertexIndex++]=m,U[this._vertexIndex++]=a.r/255,U[this._vertexIndex++]=a.g/255,U[this._vertexIndex++]=a.b/255,U[this._vertexIndex++]=a.a,U[this._vertexIndex++]=h.r/255,U[this._vertexIndex++]=h.g/255,U[this._vertexIndex++]=h.b/255,U[this._vertexIndex++]=h.a,U[this._vertexIndex++]=d}hasPendingDraws(){return this._rectangleCount!==0}flush(){if(this._rectangleCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,this._rectangleCount*6,this._quads.bufferGlType,0),kt.DrawnImagesCount+=this._rectangleCount,kt.DrawCallCount++,this._rectangleCount=0,this._vertexIndex=0}}const w0=`#version 300 es\r
precision highp float;\r
\r
// UV coord\r
in vec2 v_uv;\r
\r
// Color coord to blend with image\r
in lowp vec4 v_color;\r
\r
// Stroke color if used\r
in lowp vec4 v_strokeColor;\r
\r
// Stroke thickness if used\r
in lowp float v_strokeThickness;\r
\r
// Opacity\r
in float v_opacity;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  // make (0, 0) the center the uv \r
  vec2 uv = v_uv * 2.0 - 1.0;\r
\r
  vec4 color = v_color;\r
  vec4 strokeColor = v_strokeColor;\r
\r
  // circle border is at radius 1.0 \r
  // dist is > 0 when inside the circle \r
  float d = length(uv);\r
  float dist = 1.0 - length(uv);\r
\r
  // Fade based on fwidth\r
  float fade = fwidth(dot(uv, uv));\r
\r
  // if dist is greater than 0 step to 1;\r
  // when we cross this 0 threshold add a smooth fade\r
  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\r
\r
  // if dist is greater than the stroke thickness step to 1\r
  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\r
\r
  strokeColor.a *= fill * stroke;\r
  strokeColor.rgb *= strokeColor.a;\r
\r
  color.a *= fill * (1.0 - stroke);\r
  color.rgb *= color.a;\r
\r
  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\r
  finalColor.rgb = finalColor.rgb * v_opacity;\r
  finalColor.a = finalColor.a * v_opacity;\r
  fragColor = finalColor;\r
}`,x0=`#version 300 es\r
in vec2 a_position;\r
\r
// UV coordinate\r
in vec2 a_uv;\r
out vec2 v_uv;\r
\r
// Opacity \r
in float a_opacity;\r
out float v_opacity;\r
\r
in vec4 a_color;\r
out vec4 v_color;\r
\r
in vec4 a_strokeColor;\r
out vec4 v_strokeColor;\r
\r
in float a_strokeThickness;\r
out float v_strokeThickness;\r
\r
uniform mat4 u_matrix;\r
\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Pass through UV coords\r
   v_uv = a_uv;\r
   // Pass through the Opacity to the fragment shader\r
   v_opacity = a_opacity;\r
   // Pass through the color to the fragment shader\r
   v_color = a_color;\r
   // Pass through the stroke color to the fragment shader\r
   v_strokeColor = a_strokeColor;\r
   // Pass through the stroke thickenss to the fragment shader\r
   v_strokeThickness = a_strokeThickness;\r
}`;class b0{constructor(){this.type="ex.circle",this.priority=0,this._maxCircles=10922,this._circleCount=0,this._vertexIndex=0}initialize(t,i){this._gl=t,this._context=i,this._shader=new Ye({gl:t,fragmentSource:w0,vertexSource:x0}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",i.ortho),this._buffer=new zi({gl:t,size:14*4*this._maxCircles,type:"dynamic"}),this._layout=new Hi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new fr(t,this._maxCircles,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._shader.dispose(),this._context=null,this._gl=null}_isFull(){return this._circleCount>=this._maxCircles}draw(t,i,n,a=G.Transparent,h=0){this._isFull()&&this.flush(),this._circleCount++;const d=this._context.getTransform(),p=this._context.opacity,m=this._context.snapToPixel,y=d.multiply(t.add(B(-i,-i))),w=d.multiply(t.add(B(i,-i))),b=d.multiply(t.add(B(i,i))),R=d.multiply(t.add(B(-i,i)));m&&(y.x=~~(y.x+vt),y.y=~~(y.y+vt),w.x=~~(w.x+vt),w.y=~~(w.y+vt),R.x=~~(R.x+vt),R.y=~~(R.y+vt),b.x=~~(b.x+vt),b.y=~~(b.y+vt));const k=0,M=0,z=1,X=1,N=this._layout.vertexBuffer.bufferData;N[this._vertexIndex++]=y.x,N[this._vertexIndex++]=y.y,N[this._vertexIndex++]=k,N[this._vertexIndex++]=M,N[this._vertexIndex++]=p,N[this._vertexIndex++]=n.r/255,N[this._vertexIndex++]=n.g/255,N[this._vertexIndex++]=n.b/255,N[this._vertexIndex++]=n.a,N[this._vertexIndex++]=a.r/255,N[this._vertexIndex++]=a.g/255,N[this._vertexIndex++]=a.b/255,N[this._vertexIndex++]=a.a,N[this._vertexIndex++]=h/i,N[this._vertexIndex++]=R.x,N[this._vertexIndex++]=R.y,N[this._vertexIndex++]=k,N[this._vertexIndex++]=X,N[this._vertexIndex++]=p,N[this._vertexIndex++]=n.r/255,N[this._vertexIndex++]=n.g/255,N[this._vertexIndex++]=n.b/255,N[this._vertexIndex++]=n.a,N[this._vertexIndex++]=a.r/255,N[this._vertexIndex++]=a.g/255,N[this._vertexIndex++]=a.b/255,N[this._vertexIndex++]=a.a,N[this._vertexIndex++]=h/i,N[this._vertexIndex++]=w.x,N[this._vertexIndex++]=w.y,N[this._vertexIndex++]=z,N[this._vertexIndex++]=M,N[this._vertexIndex++]=p,N[this._vertexIndex++]=n.r/255,N[this._vertexIndex++]=n.g/255,N[this._vertexIndex++]=n.b/255,N[this._vertexIndex++]=n.a,N[this._vertexIndex++]=a.r/255,N[this._vertexIndex++]=a.g/255,N[this._vertexIndex++]=a.b/255,N[this._vertexIndex++]=a.a,N[this._vertexIndex++]=h/i,N[this._vertexIndex++]=b.x,N[this._vertexIndex++]=b.y,N[this._vertexIndex++]=z,N[this._vertexIndex++]=X,N[this._vertexIndex++]=p,N[this._vertexIndex++]=n.r/255,N[this._vertexIndex++]=n.g/255,N[this._vertexIndex++]=n.b/255,N[this._vertexIndex++]=n.a,N[this._vertexIndex++]=a.r/255,N[this._vertexIndex++]=a.g/255,N[this._vertexIndex++]=a.b/255,N[this._vertexIndex++]=a.a,N[this._vertexIndex++]=h/i}hasPendingDraws(){return this._circleCount!==0}flush(){if(this._circleCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,this._circleCount*6,this._quads.bufferGlType,0),kt.DrawnImagesCount+=this._circleCount,kt.DrawCallCount++,this._circleCount=0,this._vertexIndex=0}}class kd{constructor(t,i,n=100){this.builder=t,this.recycler=i,this.maxObjects=n,this.totalAllocations=0,this.index=0,this.objects=[],this.disableWarnings=!1,this._logger=J.getInstance()}dispose(){this.objects.length=0}preallocate(){for(let t=0;t<this.maxObjects;t++)this.objects[t]=this.builder()}using(t){const i=t(this);return i?this.done(...i):this.done()}borrow(t){const i=this.get();t(i),this.index--}get(){return this.index===this.maxObjects&&(this.disableWarnings||this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=this.maxObjects*2),this.objects[this.index]?this.recycler(this.objects[this.index++]):(this.totalAllocations++,this.objects[this.index++]=this.builder())}done(...t){this.index=0;for(const i of t){const n=this.objects.indexOf(i);this.objects[n]=this.builder(),this.totalAllocations++}return t}}class C0{constructor(){this.z=0,this.priority=0,this.transform=bt.identity(),this.state={z:0,opacity:1,tint:G.White,material:null}}}const S0=`#version 300 es
in vec2 a_position;

in vec2 a_uv;
out vec2 v_uv;

in vec2 a_screenuv;
out vec2 v_screenuv;

uniform mat4 u_matrix;
uniform mat4 u_transform;

void main() {
  // Set the vertex position using the ortho & transform matrix
  gl_Position = u_matrix * u_transform * vec4(a_position, 0.0, 1.0);

  // Pass through the UV coord to the fragment shader
  v_uv = a_uv;
  v_screenuv = a_screenuv;
}
`;class Fd{constructor(t){this._logger=J.getInstance(),this._color=G.Transparent,this._initialized=!1,this._images=new Map,this._textures=new Map;const{color:i,name:n,vertexSource:a,fragmentSource:h,graphicsContext:d,images:p}=t;if(this._name=n??"anonymous material",this._vertexSource=a??S0,this._fragmentSource=h,this._color=i??this._color,!d)throw Error(`Material ${n} must be provided an excalibur webgl graphics context`);if(d instanceof Wi?(this._graphicsContext=d,this._initialize(d)):this._logger.warn(`Material ${n} was created in 2D Canvas mode, currently only WebGL is supported`),p)for(const m in p)this.addImageSource(m,p[m])}_initialize(t){if(this._initialized)return;const i=t.__gl;this._maxTextureSlots=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS)-2,this._shader=t.createShader({vertexSource:this._vertexSource,fragmentSource:this._fragmentSource}),this._shader.compile(),this._initialized=!0}get name(){var t;return(t=this._name)!==null&&t!==void 0?t:"anonymous material"}get isUsingScreenTexture(){return this._fragmentSource.includes("u_screen_texture")}update(t){this._shader&&(this._shader.use(),t(this._shader))}getShader(){return this._shader}addImageSource(t,i){this._images.size<this._maxTextureSlots?this._images.set(t,i):this._logger.warn(`Max number texture slots ${this._maxTextureSlots} have been reached for material "${this.name}", no more textures will be uploaded due to hardware constraints.`)}removeImageSource(t){const i=this._images.get(t);this._graphicsContext.textureLoader.delete(i.image),this._images.delete(t)}_loadImageSource(t){const i=t.image,n=i.getAttribute(Kt.Filtering),a=n?To(n):null,h=Rs(i.getAttribute(Kt.WrappingX)),d=Rs(i.getAttribute(Kt.WrappingY)),p=i.getAttribute("forceUpload")==="true",m=this._graphicsContext.textureLoader.load(i,{filtering:a,wrapping:{x:h,y:d}},p);return i.removeAttribute("forceUpload"),this._textures.has(t)||this._textures.set(t,m),m}uploadAndBind(t,i=2){let n=i;for(const[a,h]of this._images.entries()){if(!h.isLoaded()){this._logger.warnOnce(`Image named ${a} in material ${this.name} not loaded, nothing will be uploaded to the shader. Did you forget to add this to a loader? https://excaliburjs.com/docs/loaders/`);continue}const d=this._loadImageSource(h);t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_2D,d),this._shader.trySetUniformInt(a,n),n++}}use(){if(this._initialized)this._shader.use(),this._shader.trySetUniformFloatColor("u_color",this._color);else throw Error(`Material ${this.name} not yet initialized, use the ExcaliburGraphicsContext.createMaterial() to work around this.`)}}class Bd{constructor(){this.type="ex.material",this.priority=0,this._textures=[]}initialize(t,i){this._gl=t,this._context=i,this._buffer=new zi({gl:t,size:6*4,type:"dynamic"}),this._layout=new Hi({gl:t,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_screenuv",2]],suppressWarnings:!0}),this._quads=new fr(t,1,!0)}dispose(){this._buffer.dispose(),this._quads.dispose(),this._textures.length=0,this._context=null,this._gl=null}draw(t,i,n,a,h,d,p,m,y){var w,b,R,k;const M=this._gl,z=this._context.material,X=this._context.getTransform(),N=this._context.opacity,U=z.getShader(),Y=this._layout.vertexBuffer.bufferData;let H=0,tt=(t==null?void 0:t.width)||a||0,gt=(t==null?void 0:t.height)||h||0,$=[0,0,(w=a??(t==null?void 0:t.width))!==null&&w!==void 0?w:0,(b=h??(t==null?void 0:t.height))!==null&&b!==void 0?b:0],mt=[i??1,n??1];d!==void 0&&p!==void 0&&m!==void 0&&y!==void 0&&($=[i??1,n??1,(R=a??(t==null?void 0:t.width))!==null&&R!==void 0?R:0,(k=h??(t==null?void 0:t.height))!==null&&k!==void 0?k:0],mt=[d,p],tt=m,gt=y),i=$[0],n=$[1];const Bt=$[2],le=$[3],Ne=B(mt[0],mt[1]),Ue=B(mt[0]+tt,mt[1]),ze=B(mt[0],mt[1]+gt),Re=B(mt[0]+tt,mt[1]+gt),ge=t.width||tt,me=t.height||gt,ot=i/ge,Vs=n/me,Gs=(i+Bt-.01)/ge,Xs=(n+le-.01)/me,kn=X.getPosition(),Kf=kn.add(Re),Jf=kn.x/this._context.width,tp=kn.y/this._context.height,ep=Kf.x/this._context.width,ip=Kf.y/this._context.height;Y[H++]=Ne.x,Y[H++]=Ne.y,Y[H++]=ot,Y[H++]=Vs,Y[H++]=Jf,Y[H++]=tp,Y[H++]=ze.x,Y[H++]=ze.y,Y[H++]=ot,Y[H++]=Xs,Y[H++]=Jf,Y[H++]=ip,Y[H++]=Ue.x,Y[H++]=Ue.y,Y[H++]=Gs,Y[H++]=Vs,Y[H++]=ep,Y[H++]=tp,Y[H++]=Re.x,Y[H++]=Re.y,Y[H++]=Gs,Y[H++]=Xs,Y[H++]=ep,Y[H++]=ip;const Py=this._addImageAsTexture(t);z.use(),this._layout.shader=U,this._layout.use(!0),U.trySetUniformFloat("u_time_ms",performance.now()),U.trySetUniformFloat("u_opacity",N),U.trySetUniformFloatVector("u_resolution",B(this._context.width,this._context.height)),U.trySetUniformFloatVector("u_graphic_resolution",B(ge,me)),U.trySetUniformFloatVector("u_size",B(Bt,le)),U.trySetUniformMatrix("u_matrix",this._context.ortho),U.trySetUniformMatrix("u_transform",X.to4x4()),M.activeTexture(M.TEXTURE0+0),M.bindTexture(M.TEXTURE_2D,Py),U.trySetUniformInt("u_graphic",0),M.activeTexture(M.TEXTURE0+1),M.bindTexture(M.TEXTURE_2D,this._context.materialScreenTexture),U.trySetUniformInt("u_screen_texture",1),z.uploadAndBind(M),this._quads.bind(),M.drawElements(M.TRIANGLES,6,this._quads.bufferGlType,0),kt.DrawnImagesCount++,kt.DrawCallCount++}_addImageAsTexture(t){const i=t.getAttribute(Kt.Filtering),n=i?To(i):null,a=Rs(t.getAttribute(Kt.WrappingX)),h=Rs(t.getAttribute(Kt.WrappingY)),d=t.getAttribute("forceUpload")==="true",p=this._context.textureLoader.load(t,{filtering:n,wrapping:{x:a,y:h}},d);return t.removeAttribute("forceUpload"),this._textures.indexOf(p)===-1&&this._textures.push(p),p}hasPendingDraws(){return!1}flush(){}}const vt=1e-4;class E0{constructor(t){this._webglCtx=t,this._debugText=new Fl}drawRect(t,i,n,a,h={color:G.Black}){this.drawLine(B(t,i),B(t+n,i),{...h}),this.drawLine(B(t+n,i),B(t+n,i+a),{...h}),this.drawLine(B(t+n,i+a),B(t,i+a),{...h}),this.drawLine(B(t,i+a),B(t,i),{...h})}drawLine(t,i,n={color:G.Black}){this._webglCtx.draw("ex.line",t,i,n.color)}drawPoint(t,i={color:G.Black,size:5}){this._webglCtx.draw("ex.point",t,i.color,i.size)}drawText(t,i){this._debugText.write(this._webglCtx,t,i)}}class Wi{get z(){return this._state.current.z}set z(t){this._state.current.z=t}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get width(){return this.__gl.canvas.width}get height(){return this.__gl.canvas.height}get ortho(){return this._ortho}checkIfResolutionSupported(t){let i=!0;return(t.width>4096||t.height>4096)&&(i=!1),i}constructor(t){this._logger=J.getInstance(),this._renderers=new Map,this._isDrawLifecycle=!1,this.useDrawSorting=!0,this._drawCallPool=new kd(()=>new C0,z=>(z.priority=0,z.z=0,z.renderer=void 0,z.args=void 0,z),4e3),this._drawCallIndex=0,this._drawCalls=new Array(4e3).fill(null),this._postProcessTargets=[],this._postprocessors=[],this._transform=new fn,this._state=new Ed,this.snapToPixel=!1,this.smoothing=!1,this.pixelArtSampler=!1,this.uvPadding=.01,this.backgroundColor=G.ExcaliburBlue,this.multiSampleAntialiasing=!0,this.transparency=!0,this._isContextLost=!1,this._disposed=!1,this._imageToWidth=new Map,this._imageToHeight=new Map,this.debug=new E0(this),this._totalPostProcessorTime=0;const{canvasElement:i,context:n,enableTransparency:a,antialiasing:h,uvPadding:d,multiSampleAntialiasing:p,pixelArtSampler:m,powerPreference:y,snapToPixel:w,backgroundColor:b,useDrawSorting:R,handleContextLost:k,handleContextRestored:M}=t;if(this.__gl=n??i.getContext("webgl2",{antialias:h??this.smoothing,premultipliedAlpha:!1,alpha:a??this.transparency,depth:!1,powerPreference:y??"high-performance"}),!this.__gl)throw Error("Failed to retrieve webgl context from browser");k&&this.__gl.canvas.addEventListener("webglcontextlost",k,!1),M&&this.__gl.canvas.addEventListener("webglcontextrestored",M,!1),this.__gl.canvas.addEventListener("webglcontextlost",()=>{this._isContextLost=!0}),this.__gl.canvas.addEventListener("webglcontextrestored",()=>{this._isContextLost=!1}),this.textureLoader=new $t(this.__gl),this.snapToPixel=w??this.snapToPixel,this.smoothing=h??this.smoothing,this.transparency=a??this.transparency,this.pixelArtSampler=m??this.pixelArtSampler,this.uvPadding=d??this.uvPadding,this.multiSampleAntialiasing=typeof p=="boolean"?p:this.multiSampleAntialiasing,this.samples=typeof p=="object"?p.samples:void 0,this.backgroundColor=b??this.backgroundColor,this.useDrawSorting=R??this.useDrawSorting,this._drawCallPool.disableWarnings=!0,this._drawCallPool.preallocate(),this._init()}dispose(){if(!this._disposed){this._disposed=!0,this.textureLoader.dispose();for(const t of this._renderers.values())t.dispose();this._renderers.clear(),this._drawCallPool.dispose(),this._drawCalls.length=0,this.__gl=null}}_init(){const t=this.__gl;this._ortho=oe.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.register(new m0({uvPadding:this.uvPadding,pixelArtSampler:this.pixelArtSampler})),this.register(new Bd),this.register(new y0),this.register(new b0),this.register(new c0),this.register(new a0),this.materialScreenTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.materialScreenTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.bindTexture(t.TEXTURE_2D,null),this._screenRenderer=new f0(t),this._renderTarget=new Ro({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height}),this._postProcessTargets=[new Ro({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height}),new Ro({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height})],this._msaaTarget=new Ro({gl:t,transparency:this.transparency,width:t.canvas.width,height:t.canvas.height,antialias:this.multiSampleAntialiasing,samples:this.samples})}register(t){this._renderers.set(t.type,t),t.initialize(this.__gl,this)}get(t){return this._renderers.get(t)}_isCurrentRenderer(t){return!this._currentRenderer||this._currentRenderer===t}beginDrawLifecycle(){this._isDrawLifecycle=!0}endDrawLifecycle(){this._isDrawLifecycle=!1}draw(t,...i){if(this._isDrawLifecycle||this._logger.warnOnce(`Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.
If you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler.`),this._isContextLost){this._logger.errorOnce(`Unable to draw ${t}, the webgl context is lost`);return}const n=this._renderers.get(t);if(n)if(this.useDrawSorting){const a=this._drawCallPool.get();a.z=this._state.current.z,a.priority=n.priority,a.renderer=t,this.getTransform().clone(a.transform),a.state.z=this._state.current.z,a.state.opacity=this._state.current.opacity,a.state.tint=this._state.current.tint,a.state.material=this._state.current.material,a.args=i,this._drawCalls[this._drawCallIndex++]=a}else this._currentRenderer||(this._currentRenderer=n),this._isCurrentRenderer(n)||this._currentRenderer.flush(),n.draw(...i),this._currentRenderer=n;else throw Error(`No renderer with name ${t} has been registered`)}resetTransform(){this._transform.current=bt.identity()}updateViewport(t){const i=this.__gl;this._ortho=this._ortho=oe.ortho(0,t.width,t.height,0,400,-400),this._renderTarget.setResolution(i.canvas.width,i.canvas.height),this._msaaTarget.setResolution(i.canvas.width,i.canvas.height),this._postProcessTargets[0].setResolution(i.canvas.width,i.canvas.height),this._postProcessTargets[1].setResolution(i.canvas.width,i.canvas.height)}_getImageWidth(t){let i=this._imageToWidth.get(t);return i===void 0&&(i=t.width,this._imageToWidth.set(t,i)),i}_getImageHeight(t){let i=this._imageToHeight.get(t);return i===void 0&&(i=t.height,this._imageToHeight.set(t,i)),i}drawImage(t,i,n,a,h,d,p,m,y){if(!(a===0||h===0)){{if(m===0||y===0)return;if(this._getImageWidth(t)===0||this._getImageHeight(t)===0)return}if(!t){J.getInstance().warn("Cannot draw a null or undefined image"),console.trace&&console.trace();return}this._state.current.material?this.draw("ex.material",t,i,n,a,h,d,p,m,y):this.draw("ex.image",t,i,n,a,h,d,p,m,y)}}drawLine(t,i,n,a=1){this.draw("ex.rectangle",t,i,n,a)}drawRectangle(t,i,n,a,h,d){this.draw("ex.rectangle",t,i,n,a,h,d)}drawCircle(t,i,n,a,h){this.draw("ex.circle",t,i,n,a,h)}save(){this._transform.save(),this._state.save()}restore(){this._transform.restore(),this._state.restore()}translate(t,i){this._transform.translate(this.snapToPixel?~~(t+vt):t,this.snapToPixel?~~(i+vt):i)}rotate(t){this._transform.rotate(t)}scale(t,i){this._transform.scale(t,i)}transform(t){this._transform.current=t}getTransform(){return this._transform.current}multiply(t){this._transform.current.multiply(t,this._transform.current)}addPostProcessor(t){this._postprocessors.push(t),t.initialize(this.__gl)}removePostProcessor(t){const i=this._postprocessors.indexOf(t);i!==-1&&this._postprocessors.splice(i,1)}clearPostProcessors(){this._postprocessors.length=0}updatePostProcessors(t){for(const i of this._postprocessors){const n=i.getShader();n.use();const a=n.getUniforms();this._totalPostProcessorTime+=t,a.find(h=>h.name==="u_time_ms")&&n.setUniformFloat("u_time_ms",this._totalPostProcessorTime),a.find(h=>h.name==="u_elapsed_ms")&&n.setUniformFloat("u_elapsed_ms",t),a.find(h=>h.name==="u_resolution")&&n.setUniformFloatVector("u_resolution",B(this.width,this.height)),i.onUpdate&&i.onUpdate(t)}}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){return new Fd({...t,graphicsContext:this})}createShader(t){const i=this.__gl,{vertexSource:n,fragmentSource:a}=t,h=new Ye({gl:i,vertexSource:n,fragmentSource:a});return h.compile(),h}clear(){const t=this.__gl;(this.multiSampleAntialiasing?this._msaaTarget:this._renderTarget).use(),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT)}flush(){if(this._isContextLost){this._logger.errorOnce("Unable to flush the webgl context is lost");return}let t=this.multiSampleAntialiasing?this._msaaTarget:this._renderTarget;if(t.use(),this.useDrawSorting){for(let h=this._drawCallIndex;h<this._drawCalls.length;h++)this._drawCalls[h]=null;const i=new Map;for(const[h]of this._renderers){let d=0;for(d=0;d<this._drawCallIndex&&this._drawCalls[d].renderer!==h;d++);i.set(h,d)}this._drawCalls.sort((h,d)=>{if(h===null||d===null)return 0;const p=h.z-d.z,m=i.get(h.renderer)-i.get(d.renderer),y=h.priority-d.priority;return p===0?y===0?m:y:p});const n=this._transform.current,a=this._state.current;if(this._drawCalls.length&&this._drawCallIndex){let h=this._drawCalls[0].renderer,d=this._renderers.get(h);for(let p=0;p<this._drawCallIndex;p++)this._transform.current=this._drawCalls[p].transform,this._state.current=this._drawCalls[p].state,this._drawCalls[p].renderer!==h&&(d.flush(),h=this._drawCalls[p].renderer,d=this._renderers.get(h)),d instanceof Bd&&this.material.isUsingScreenTexture&&(t.copyToTexture(this.materialScreenTexture),t.use()),d.draw(...this._drawCalls[p].args);d.hasPendingDraws()&&d.flush()}this._transform.current=n,this._state.current=a,this._drawCallPool.done(),this._drawCallIndex=0,this._imageToHeight.clear(),this._imageToWidth.clear()}else for(const i of this._renderers.values())i.hasPendingDraws()&&i.flush();t.disable(),this._postprocessors.length>0&&t.toRenderSource().use();for(let i=0;i<this._postprocessors.length;i++)t=this._postProcessTargets[i%2],this._postProcessTargets[i%2].use(),this._screenRenderer.renderWithPostProcessor(this._postprocessors[i]),this._postProcessTargets[i%2].toRenderSource().use();t.blitToScreen()}}const Wt=1e-4;class A0{constructor(t){this._ex=t,this._debugText=new Fl}drawRect(t,i,n,a){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~(t+Wt):t,this._ex.snapToPixel?~~(i+Wt):i,this._ex.snapToPixel?~~(n+Wt):n,this._ex.snapToPixel?~~(a+Wt):a),this._ex.__ctx.restore()}drawLine(t,i,n={color:G.Black}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=n.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~(t.x+Wt):t.x,this._ex.snapToPixel?~~(t.y+Wt):t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~(i.x+Wt):i.x,this._ex.snapToPixel?~~(i.y+Wt):i.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawPoint(t,i={color:G.Black,size:5}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=i.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~(t.x+Wt):t.x,this._ex.snapToPixel?~~(t.y+Wt):t.y,i.size,0,Math.PI*2),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawText(t,i){this._debugText.write(this._ex,t,i)}}class Io{get width(){return this.__ctx.canvas.width}get height(){return this.__ctx.canvas.height}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get smoothing(){return this.__ctx.imageSmoothingEnabled}set smoothing(t){this.__ctx.imageSmoothingEnabled=t}constructor(t){this.useDrawSorting=!1,this.z=0,this.backgroundColor=G.ExcaliburBlue,this._state=new Ed,this.snapToPixel=!1,this.debug=new A0(this);const{canvasElement:i,context:n,enableTransparency:a,snapToPixel:h,antialiasing:d,backgroundColor:p}=t;if(this.__ctx=n??i.getContext("2d",{alpha:a??!0}),!this.__ctx)throw new Error("Cannot build new ExcaliburGraphicsContext2D for some reason!");this.backgroundColor=p??this.backgroundColor,this.snapToPixel=h??this.snapToPixel,this.smoothing=d??this.smoothing}resetTransform(){this.__ctx.resetTransform()}updateViewport(t){}drawImage(t,i,n,a,h,d,p,m,y){if(a===0||h===0)return;if(m===0||y===0)return;if(t.width===0||t.height===0)return;this.__ctx.globalAlpha=this.opacity;const w=[t,i,n,a,h,d,p,m,y].filter(b=>b!==void 0).map(b=>typeof b=="number"&&this.snapToPixel?~~b:b);this.__ctx.drawImage.apply(this.__ctx,w),kt.DrawCallCount++,kt.DrawnImagesCount=1}drawLine(t,i,n,a=1){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=n.toString(),this.__ctx.moveTo(this.snapToPixel?~~(t.x+Wt):t.x,this.snapToPixel?~~(t.y+Wt):t.y),this.__ctx.lineTo(this.snapToPixel?~~(i.x+Wt):i.x,this.snapToPixel?~~(i.y+Wt):i.y),this.__ctx.lineWidth=a,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}drawRectangle(t,i,n,a){this.__ctx.save(),this.__ctx.fillStyle=a.toString(),this.__ctx.fillRect(this.snapToPixel?~~(t.x+Wt):t.x,this.snapToPixel?~~(t.y+Wt):t.y,this.snapToPixel?~~(i+Wt):i,this.snapToPixel?~~(n+Wt):n),this.__ctx.restore()}drawCircle(t,i,n,a,h){this.__ctx.save(),this.__ctx.beginPath(),a&&(this.__ctx.strokeStyle=a.toString()),h&&(this.__ctx.lineWidth=h),this.__ctx.fillStyle=n.toString(),this.__ctx.arc(this.snapToPixel?~~(t.x+Wt):t.x,this.snapToPixel?~~(t.y+Wt):t.y,i,0,Math.PI*2),this.__ctx.fill(),a&&this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}save(){this.__ctx.save(),this._state.save()}restore(){this.__ctx.restore(),this._state.restore()}translate(t,i){this.__ctx.translate(this.snapToPixel?~~(t+Wt):t,this.snapToPixel?~~(i+Wt):i)}rotate(t){this.__ctx.rotate(t)}scale(t,i){this.__ctx.scale(t,i)}getTransform(){throw new Error("Not implemented")}multiply(t){this.__ctx.setTransform(this.__ctx.getTransform().multiply(t.toDOMMatrix()))}addPostProcessor(t){}removePostProcessor(t){}clearPostProcessors(){}updatePostProcessors(t){}beginDrawLifecycle(){}endDrawLifecycle(){}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){return null}clear(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),kt.clear()}flush(){}dispose(){this.__ctx=null}}var Jt;(function(u){u.Fixed="Fixed",u.FitContainerAndFill="FitContainerAndFill",u.FitScreenAndFill="FitScreenAndFill",u.FitContainerAndZoom="FitContainerAndZoom",u.FitScreenAndZoom="FitScreenAndZoom",u.FitScreen="FitScreen",u.FillScreen="FillScreen",u.FitContainer="FitContainer",u.FillContainer="FillContainer"})(Jt||(Jt={}));class Ml{static get SVGA(){return{width:800,height:600}}static get Standard(){return{width:1920,height:1080}}static get Atari2600(){return{width:160,height:192}}static get GameBoy(){return{width:160,height:144}}static get GameBoyAdvance(){return{width:240,height:160}}static get NintendoDS(){return{width:256,height:192}}static get NES(){return{width:256,height:224}}static get SNES(){return{width:256,height:244}}}const T0={ScreenResize:"resize",PixelRatioChange:"pixelratio",FullScreenChange:"fullscreen"};class Ll{constructor(t){var i,n,a,h;this.events=new v,this._antialiasing=!0,this._canvasImageRendering="auto",this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=J.getInstance(),this._fullscreenChangeHandler=()=>{this._isDisposed||(this._isFullScreen=!this._isFullScreen,this._logger.debug("Fullscreen Change",this._isFullScreen),this.events.emit("fullscreen",{fullscreen:this.isFullScreen}))},this._pixelRatioChangeHandler=()=>{this._isDisposed||(this._logger.debug("Pixel Ratio Change",window.devicePixelRatio),this._listenForPixelRatio(),this._devicePixelRatio=this._calculateDevicePixelRatio(),this.applyResolutionAndViewport(),this.events.emit("pixelratio",{pixelRatio:this.pixelRatio}))},this._resizeHandler=()=>{if(this._isDisposed)return;const d=this.parent;this._logger.debug("View port resized"),this._setResolutionAndViewportByDisplayMode(d),this.applyResolutionAndViewport(),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._contentArea=new et,this._unsafeArea=new et,this.viewport=t.viewport,this.resolution=(i=t.resolution)!==null&&i!==void 0?i:{...this.viewport},this._contentResolution=this.resolution,this._displayMode=(n=t.displayMode)!==null&&n!==void 0?n:Jt.Fixed,this._canvas=t.canvas,this.graphicsContext=t.context,this._antialiasing=(a=t.antialiasing)!==null&&a!==void 0?a:this._antialiasing,this._canvasImageRendering=(h=t.canvasImageRendering)!==null&&h!==void 0?h:this._canvasImageRendering,this._browser=t.browser,this._pixelRatioOverride=t.pixelRatio,this._applyDisplayMode(),this._listenForPixelRatio(),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}_listenForPixelRatio(){this._mediaQueryList&&!this._mediaQueryList.addEventListener&&this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler,{once:!0}):this._mediaQueryList.addListener(this._pixelRatioChangeHandler)}dispose(){this._isDisposed||(this._isDisposed=!0,this.events.clear(),this._browser.window.off("resize",this._resizeHandler),this._browser.window.clear(),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler):this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler),this._canvas=null)}_calculateDevicePixelRatio(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}get pixelRatio(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}get pixelRatioOverride(){return this._pixelRatioOverride}set pixelRatioOverride(t){this._pixelRatioOverride=t}get isHiDpi(){return this.pixelRatio!==1}get displayMode(){return this._displayMode}get canvas(){return this._canvas}get parent(){switch(this.displayMode){case Jt.FillContainer:case Jt.FitContainer:case Jt.FitContainerAndFill:case Jt.FitContainerAndZoom:return this.canvas.parentElement||document.body;default:return window}}get resolution(){return this._resolution}set resolution(t){this._resolution=t}get viewport(){return this._viewport?this._viewport:this._resolution}set viewport(t){this._viewport=t}get aspectRatio(){return this._resolution.width/this._resolution.height}get scaledWidth(){return this._resolution.width*this.pixelRatio}get scaledHeight(){return this._resolution.height*this.pixelRatio}setCurrentCamera(t){this._camera=t}pushResolutionAndViewport(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution={...this.resolution},this.viewport={...this.viewport}}peekViewport(){return this._viewportStack[this._viewportStack.length-1]}peekResolution(){return this._resolutionStack[this._resolutionStack.length-1]}popResolutionAndViewport(){this._resolutionStack.length&&this._viewportStack.length&&(this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop())}applyResolutionAndViewport(){if(this.graphicsContext instanceof Wi&&!this.graphicsContext.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})&&(this._logger.warnOnce(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) and pixel ratio (${this.pixelRatio}) are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`),!this.pixelRatioOverride)){let a=Math.max(1,this.pixelRatio-.5),h=!1;for(;a>1&&!h;){a=Math.max(1,a-.5);const d=this._resolution.width*a,p=this._resolution.height*a;h=this.graphicsContext.checkIfResolutionSupported({width:d,height:p})}this.pixelRatioOverride=a,this._logger.warnOnce(`Scaled resolution too big attempted recovery! Pixel ratio was automatically reduced to (${this.pixelRatio}) to avoid 4k texture limit. Setting \`ex.Engine({pixelRatio: ...}) will override any automatic recalculation, do so at your own risk.\`  (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`)}this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this._canvasImageRendering==="auto"?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",this._canvas.style.imageRendering===""&&(this._canvas.style.imageRendering="crisp-edges"));const t=this.viewport.widthUnit==="percent"?"%":"px",i=this.viewport.heightUnit==="percent"?"%":"px";this._canvas.style.width=this.viewport.width+t,this._canvas.style.height=this.viewport.height+i,this.graphicsContext.updateViewport(this.resolution),this.graphicsContext.resetTransform(),this.graphicsContext.smoothing=this._antialiasing,this.graphicsContext instanceof Io&&this.graphicsContext.scale(this.pixelRatio,this.pixelRatio)}get antialiasing(){return this._antialiasing}set antialiasing(t){this._antialiasing=t,this.graphicsContext.smoothing=this._antialiasing}get isFullScreen(){return this._isFullScreen}goFullScreen(t){if(t){const i=document.getElementById(t);if(i)return i.getAttribute("ex-fullscreen-listener")||(i.setAttribute("ex-fullscreen-listener","true"),i.addEventListener("fullscreenchange",this._fullscreenChangeHandler)),i.requestFullscreen()}return this._canvas.requestFullscreen()}exitFullScreen(){return document.exitFullscreen()}_viewportToPixels(t){return{width:t.widthUnit==="percent"?this.canvas.offsetWidth:t.width,height:t.heightUnit==="percent"?this.canvas.offsetHeight:t.height}}pageToScreenCoordinates(t){let i=t.x,n=t.y;this._isFullScreen||(i-=fi(this._canvas).x,n-=fi(this._canvas).y);const a=this._viewportToPixels(this.viewport);if(this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const h=window.innerWidth/this.aspectRatio,d=(window.innerHeight-h)/2;n=(n-d)/h*a.height,i=i/window.innerWidth*a.width}else{const h=window.innerHeight*this.aspectRatio,d=(window.innerWidth-h)/2;i=(i-d)/h*a.width,n=n/window.innerHeight*a.height}return i=i/a.width*this.resolution.width,n=n/a.height*this.resolution.height,i=i-this.contentArea.left,n=n-this.contentArea.top,new E(i,n)}screenToPageCoordinates(t){let i=t.x,n=t.y;const a=this._viewportToPixels(this.viewport);if(i=i/this.resolution.width*a.width,n=n/this.resolution.height*a.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const h=window.innerWidth/this.aspectRatio,d=(window.innerHeight-h)/2;n=n/a.height*h+d,i=i/a.width*window.innerWidth}else{const h=window.innerHeight*this.aspectRatio,d=(window.innerWidth-h)/2;i=i/a.width*h+d,n=n/a.height*window.innerHeight}return this._isFullScreen||(i+=fi(this._canvas).x,n+=fi(this._canvas).y),new E(i,n)}screenToWorldCoordinates(t){return t=t.add(B(this.contentArea.left,this.contentArea.top)),this._camera?this._camera.inverse.multiply(t):t.sub(B(this.resolution.width/2,this.resolution.height/2))}worldToScreenCoordinates(t){return this._camera?this._camera.transform.multiply(t):t.add(B(this.resolution.width/2,this.resolution.height/2))}pageToWorldCoordinates(t){const i=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(i)}worldToPageCoordinates(t){const i=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(i)}getWorldBounds(){return et.fromDimension(this.resolution.width,this.resolution.height,E.Half).scale(B(1/this._camera.zoom,1/this._camera.zoom)).rotate(this._camera.rotation).translate(this._camera.drawPos)}getScreenBounds(){return et.fromDimension(this.resolution.width,this.resolution.height,E.Zero,E.Zero)}get canvasWidth(){return this.canvas.width}get halfCanvasWidth(){return this.canvas.width/2}get canvasHeight(){return this.canvas.height}get halfCanvasHeight(){return this.canvas.height/2}get drawWidth(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}get halfDrawWidth(){return this.drawWidth/2}get drawHeight(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}get halfDrawHeight(){return this.drawHeight/2}get center(){return B(this.halfDrawWidth,this.halfDrawHeight)}get contentArea(){return this._contentArea}get unsafeArea(){return this._unsafeArea}_computeFit(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.aspectRatio;let i=0,n=0;window.innerWidth/t<window.innerHeight?(i=window.innerWidth,n=window.innerWidth/t):(i=window.innerHeight*t,n=window.innerHeight),this.viewport={width:i,height:n},this._contentArea=et.fromDimension(this.resolution.width,this.resolution.height,E.Zero),this._unsafeArea=et.fromDimension(this.resolution.width,this.resolution.height,E.Zero),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitScreenAndFill(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=window.innerWidth,i=window.innerHeight;this._computeFitAndFill(t,i),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitContainerAndFill(){this.canvas.style.width="100%",this.canvas.style.height="100%",this._computeFitAndFill(this.canvas.offsetWidth,this.canvas.offsetHeight,{width:100,widthUnit:"percent",height:100,heightUnit:"percent"}),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitAndFill(t,i,n){if(this.viewport=n??{width:t,height:i},t/i<=this._contentResolution.width/this._contentResolution.height){this.resolution={width:t*this._contentResolution.width/t,height:t*this._contentResolution.width/t*i/t};const a=(this.resolution.height-this._contentResolution.height)/2;this._contentArea=new et({top:a,left:0,right:this._contentResolution.width,bottom:this.resolution.height-a}),this._unsafeArea=new et({top:-a,left:0,right:this._contentResolution.width,bottom:this.resolution.height+a})}else{this.resolution={width:i*this._contentResolution.height/i*t/i,height:i*this._contentResolution.height/i};const a=(this.resolution.width-this._contentResolution.width)/2;this._contentArea=new et({top:0,left:a,right:this.resolution.width-a,bottom:this._contentResolution.height}),this._unsafeArea=new et({top:0,left:-a,right:this.resolution.width+a,bottom:this._contentResolution.height})}}_computeFitScreenAndZoom(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";const t=window.innerWidth,i=window.innerHeight;this._computeFitAndZoom(t,i),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitContainerAndZoom(){this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="relative";const t=this.canvas.parentElement;t.style.overflow="hidden";const{offsetWidth:i,offsetHeight:n}=this.canvas;this._computeFitAndZoom(i,n),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_computeFitAndZoom(t,i){const n=this.aspectRatio;let a=0,h=0;t/n<i?(a=t,h=t/n):(a=i*n,h=i);const d=t/a,p=i/h,m=Math.max(d,p),y=a*m,w=h*m;y>t?this.canvas.style.left=-(y-t)/2+"px":this.canvas.style.left="",w>i?this.canvas.style.top=-(w-i)/2+"px":this.canvas.style.top="",this.viewport={width:y,height:w};const b=et.fromDimension(this.viewport.width,this.viewport.height,E.Zero);if(this.viewport.width>t){const R=(this.viewport.width-t)/this.viewport.width*this.resolution.width;b.top=0,b.left=R/2,b.right=this.resolution.width-R/2,b.bottom=this.resolution.height}if(this.viewport.height>i){const R=(this.viewport.height-i)/this.viewport.height*this.resolution.height;b.top=R/2,b.left=0,b.bottom=this.resolution.height-R/2,b.right=this.resolution.width}this._contentArea=b}_computeFitContainer(){const t=this.aspectRatio;let i=0,n=0,a="pixel",h="pixel";const d=this.canvas.parentElement;d.clientWidth/t<d.clientHeight?(this.canvas.style.width="100%",i=100,a="percent",n=this.canvas.offsetWidth/t):(this.canvas.style.height="100%",n=100,h="percent",i=this.canvas.offsetHeight*t),this.viewport={width:i,widthUnit:a,height:n,heightUnit:h},this._contentArea=et.fromDimension(this.resolution.width,this.resolution.height,E.Zero),this.events.emit("resize",{resolution:this.resolution,viewport:this.viewport})}_applyDisplayMode(){this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver(()=>{this._resizeHandler()}),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler)}_setResolutionAndViewportByDisplayMode(t){this.displayMode===Jt.FillContainer&&(this.canvas.style.width="100%",this.canvas.style.height="100%",this.viewport={width:100,widthUnit:"percent",height:100,heightUnit:"percent"},this.resolution={width:this.canvas.offsetWidth,height:this.canvas.offsetHeight}),this.displayMode===Jt.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this._contentArea=et.fromDimension(this.resolution.width,this.resolution.height,E.Zero),this.displayMode===Jt.FitScreen&&this._computeFit(),this.displayMode===Jt.FitContainer&&this._computeFitContainer(),this.displayMode===Jt.FitScreenAndFill&&this._computeFitScreenAndFill(),this.displayMode===Jt.FitContainerAndFill&&this._computeFitContainerAndFill(),this.displayMode===Jt.FitScreenAndZoom&&this._computeFitScreenAndZoom(),this.displayMode===Jt.FitContainerAndZoom&&this._computeFitContainerAndZoom()}}class gn{static create(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}gn._INSTANCE=null;function P0(u){return!!u.playbackState}class Ds{static unlock(){return new Promise((i,n)=>{if(Ds._UNLOCKED||!gn.create())return i(!0);const a=setTimeout(()=>{J.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),i(!1)},200),h=gn.create();h.resume().then(()=>{const d=h.createBuffer(1,1,22050),p=h.createBufferSource();let m=!1;p.buffer=d,p.connect(h.destination),p.onended=()=>m=!0,p.start(0),setTimeout(()=>{P0(p)?(p.playbackState===p.PLAYING_STATE||p.playbackState===p.FINISHED_STATE)&&(Ds._UNLOCKED=!0):(h.currentTime>0||m)&&(Ds._UNLOCKED=!0)},0),clearTimeout(a),i(!0)},()=>{n()})})}static isUnlocked(){return this._UNLOCKED}}Ds._UNLOCKED=!1;class mn extends zt{constructor(t){var i,n,a,h,d,p,m,y,w,b;super(Ut(t,["width","height"])),this.filtering=null,this.lineCap="butt",this.quality=1,this._dirty=!0,this._smoothing=!1,this._color=Ui(G.Black,()=>this.flagDirty()),this._lineWidth=1,this._lineDash=[],this._padding=0,t&&(this.quality=(i=t.quality)!==null&&i!==void 0?i:this.quality,this.color=(n=t.color)!==null&&n!==void 0?n:G.Black,this.strokeColor=t==null?void 0:t.strokeColor,this.smoothing=(a=t.smoothing)!==null&&a!==void 0?a:this.smoothing,this.lineWidth=(h=t.lineWidth)!==null&&h!==void 0?h:this.lineWidth,this.lineDash=(d=t.lineDash)!==null&&d!==void 0?d:this.lineDash,this.lineCap=(p=t.lineCap)!==null&&p!==void 0?p:this.lineCap,this.padding=(m=t.padding)!==null&&m!==void 0?m:this.padding,this.filtering=(y=t.filtering)!==null&&y!==void 0?y:this.filtering),this._bitmap=document.createElement("canvas");const R=(w=t==null?void 0:t.width)!==null&&w!==void 0?w:this._bitmap.width,k=(b=t==null?void 0:t.height)!==null&&b!==void 0?b:this._bitmap.height;this.width=R,this.height=k;const M=this._bitmap.getContext("2d");if(M)this._ctx=M;else throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic")}cloneRasterOptions(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,lineCap:this.lineCap,quality:this.quality,padding:this.padding}}get dirty(){return this._dirty}flagDirty(){this._dirty=!0}get width(){return Math.abs(this._getTotalWidth()*this.scale.x)}set width(t){t/=Math.abs(this.scale.x),this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}get height(){return Math.abs(this._getTotalHeight()*this.scale.y)}set height(t){t/=Math.abs(this.scale.y),this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}_getTotalWidth(){var t;return(((t=this._originalWidth)!==null&&t!==void 0?t:this._bitmap.width)+this.padding*2)*1}_getTotalHeight(){var t;return(((t=this._originalHeight)!==null&&t!==void 0?t:this._bitmap.height)+this.padding*2)*1}get localBounds(){return et.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,E.Zero)}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this.flagDirty()}get color(){return this._color}set color(t){this.flagDirty(),this._color=Ui(t,()=>this.flagDirty())}get strokeColor(){return this._strokeColor}set strokeColor(t){this.flagDirty(),this._strokeColor=Ui(t,()=>this.flagDirty())}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this.flagDirty()}get lineDash(){return this._lineDash}set lineDash(t){this._lineDash=t,this.flagDirty()}get padding(){return this._padding}set padding(t){this._padding=t,this.flagDirty()}rasterize(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperties(this._ctx),this.execute(this._ctx),this._ctx.restore()}_applyRasterProperties(t){var i,n,a;this._bitmap.width=this._getTotalWidth()*this.quality,this._bitmap.height=this._getTotalHeight()*this.quality,this._bitmap.setAttribute("filtering",this.filtering),this._bitmap.setAttribute("forceUpload","true"),t.scale(this.quality,this.quality),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash((i=this.lineDash)!==null&&i!==void 0?i:t.getLineDash()),t.lineCap=this.lineCap,t.strokeStyle=(n=this.strokeColor)===null||n===void 0?void 0:n.toString(),t.fillStyle=(a=this.color)===null||a===void 0?void 0:a.toString()}_drawImage(t,i,n){this._dirty&&this.rasterize(),t.scale(1/this.quality,1/this.quality),t.drawImage(this._bitmap,i,n)}}class Do extends mn{get ctx(){return this._ctx}constructor(t){super(t),this._options=t}clone(){return new Do({...this._options,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){var i,n;!((i=this._options)===null||i===void 0)&&i.draw&&((n=this._options)===null||n===void 0||n.draw(t)),this._options.cache||this.flagDirty()}}class Ol{}Ol.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};class ko{constructor(){this.states=new Map}get currentState(){return this._currentState}set currentState(t){this._currentState=t}static create(t,i){const n=new ko;n.data=i;for(const a in t.states)n.states.set(a,{name:a,...t.states[a]});for(const a of n.states.values())for(const h of a.transitions)if(h!=="*"&&!n.states.has(h))throw Error(`Invalid state machine, state [${a.name}] has a transition to another state that doesn't exist [${h}]`);return n.currentState=n.startState=n.states.get(t.start),n}in(t){return this.currentState.name===t}go(t,i){var n,a;if(this.currentState.transitions.includes(t)||this.currentState.transitions.includes("*")){const h=this.states.get(t);return this.currentState.onExit&&((n=this.currentState)===null||n===void 0?void 0:n.onExit({to:h.name,data:this.data}))===!1||h!=null&&h.onEnter&&(h==null?void 0:h.onEnter({from:this.currentState.name,eventData:i,data:this.data}))===!1?!1:(this.currentState=h,!((a=this.currentState)===null||a===void 0)&&a.onState&&this.currentState.onState(),!0)}return!1}update(t){this.currentState.onUpdate&&this.currentState.onUpdate(this.data,t)}save(t){localStorage.setItem(t,JSON.stringify({currentState:this.currentState.name,data:this.data}))}restore(t){const i=JSON.parse(localStorage.getItem(t));this.currentState=this.states.get(i.currentState),this.data=i.data}}class Md{_createNewBufferSource(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.value=this._playbackRate,this._instance.connect(this._volumeNode),this._volumeNode.connect(this._audioContext.destination)}_handleEnd(){this.loop||(this._instance.onended=()=>{this._playingFuture.resolve(!0)})}set loop(t){this._loop=t,this._instance&&(this._instance.loop=t,this.loop||(this._instance.onended=()=>{this._playingFuture.resolve(!0)}))}get loop(){return this._loop}set volume(t){t=O(t,0,1),this._volume=t,this._stateMachine.in("PLAYING")&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}get volume(){return this._volume}get duration(){var t;return(t=this._duration)!==null&&t!==void 0?t:this.getTotalPlaybackDuration()}set duration(t){this._duration=t}constructor(t){this._src=t,this._audioContext=gn.create(),this._volumeNode=this._audioContext.createGain(),this._playingFuture=new _,this._stateMachine=ko.create({start:"STOPPED",states:{PLAYING:{onEnter:({data:i})=>{this._createNewBufferSource(),this._handleEnd(),this.loop?this._instance.start(0,i.pausedAt*this._playbackRate):this._instance.start(0,i.pausedAt*this._playbackRate,this.duration),i.startedAt=this._audioContext.currentTime-i.pausedAt,i.pausedAt=0},onState:()=>this._playStarted(),onExit:({to:i})=>{i==="STOPPED"&&this._playingFuture.resolve(!0),this._instance.onended=null,this._instance.disconnect(),this._instance.stop(0),this._instance=null},transitions:["STOPPED","PAUSED","SEEK"]},SEEK:{onEnter:({eventData:i,data:n})=>{n.pausedAt=(i??0)/this._playbackRate,n.startedAt=0},transitions:["*"]},STOPPED:{onEnter:({data:i})=>{i.pausedAt=0,i.startedAt=0,this._playingFuture.resolve(!0)},transitions:["PLAYING","PAUSED","SEEK"]},PAUSED:{onEnter:({data:i})=>{i.pausedAt=this._audioContext.currentTime-i.startedAt},transitions:["PLAYING","STOPPED","SEEK"]}}},{startedAt:0,pausedAt:0}),this._volume=1,this._loop=!1,this._playStarted=()=>{},this._playbackRate=1,this._createNewBufferSource()}isPlaying(){return this._stateMachine.in("PLAYING")}isPaused(){return this._stateMachine.in("PAUSED")||this._stateMachine.in("SEEK")}isStopped(){return this._stateMachine.in("STOPPED")}play(t=()=>{}){return this._playStarted=t,this._stateMachine.go("PLAYING"),this._playingFuture.promise}pause(){this._stateMachine.go("PAUSED")}stop(){this._stateMachine.go("STOPPED")}seek(t){this._stateMachine.go("PAUSED"),this._stateMachine.go("SEEK",t)}getTotalPlaybackDuration(){return this._src.duration}getPlaybackPosition(){const{pausedAt:t,startedAt:i}=this._stateMachine.data;return t?t*this._playbackRate:i?(this._audioContext.currentTime-i)*this._playbackRate:0}set playbackRate(t){this._instance.playbackRate.value=this._playbackRate=t}get playbackRate(){return this._instance.playbackRate.value}}var Fo;(function(u){u.Kill="kill",u.PreKill="prekill",u.PostKill="postkill",u.PreDraw="predraw",u.PostDraw="postdraw",u.PreDebugDraw="predebugdraw",u.PostDebugDraw="postdebugdraw",u.PreUpdate="preupdate",u.PostUpdate="postupdate",u.PreFrame="preframe",u.PostFrame="postframe",u.PreCollision="precollision",u.CollisionStart="collisionstart",u.CollisionEnd="collisionend",u.PostCollision="postcollision",u.Initialize="initialize",u.Activate="activate",u.Deactivate="deactivate",u.ExitViewport="exitviewport",u.EnterViewport="enterviewport",u.ExitTrigger="exit",u.EnterTrigger="enter",u.Connect="connect",u.Disconnect="disconnect",u.Button="button",u.Axis="axis",u.Visible="visible",u.Hidden="hidden",u.Start="start",u.Stop="stop",u.PointerUp="pointerup",u.PointerDown="pointerdown",u.PointerMove="pointermove",u.PointerEnter="pointerenter",u.PointerLeave="pointerleave",u.PointerCancel="pointercancel",u.PointerWheel="pointerwheel",u.Up="up",u.Down="down",u.Move="move",u.Enter="enter",u.Leave="leave",u.Cancel="cancel",u.Wheel="wheel",u.Press="press",u.Release="release",u.Hold="hold",u.PointerDragStart="pointerdragstart",u.PointerDragEnd="pointerdragend",u.PointerDragEnter="pointerdragenter",u.PointerDragLeave="pointerdragleave",u.PointerDragMove="pointerdragmove",u.ActionStart="actionstart",u.ActionComplete="actioncomplete"})(Fo||(Fo={}));class _t{constructor(){this._bubbles=!0}get bubbles(){return this._bubbles}set bubbles(t){this._bubbles=t}stopPropagation(){this.bubbles=!1}}class Bo extends _t{constructor(t){super(),this.target=t}}class Nl extends _t{constructor(t){super(),this.target=t}}class Ul extends _t{constructor(t){super(),this.target=t}}class zl extends _t{constructor(t){super(),this.target=t}}class Hl extends _t{constructor(t){super(),this.target=t}}class _n extends _t{constructor(t,i,n){super(),this.ctx=t,this.delta=i,this.target=n}}class vn extends _t{constructor(t,i,n){super(),this.ctx=t,this.delta=i,this.target=n}}class Wl extends _t{constructor(t,i,n){super(),this.ctx=t,this.delta=i,this.target=n}}class jl extends _t{constructor(t,i,n){super(),this.ctx=t,this.delta=i,this.target=n}}class Vl extends _t{constructor(t,i){super(),this.ctx=t,this.target=i}}class Gl extends _t{constructor(t,i){super(),this.ctx=t,this.target=i}}class es extends _t{constructor(t,i,n){super(),this.engine=t,this.delta=i,this.target=n}}class is extends _t{constructor(t,i,n){super(),this.engine=t,this.delta=i,this.target=n}}class Xl extends _t{constructor(t,i){super(),this.engine=t,this.prevStats=i,this.target=t}}class Yl extends _t{constructor(t,i){super(),this.engine=t,this.stats=i,this.target=t}}class $l extends _t{constructor(t,i){super(),this.index=t,this.gamepad=i,this.target=i}}class Ql extends _t{constructor(t,i){super(),this.index=t,this.gamepad=i,this.target=i}}class ql extends _t{constructor(t,i,n){super(),this.button=t,this.value=i,this.target=n}}class Zl extends _t{constructor(t,i,n){super(),this.axis=t,this.value=i,this.target=n}}class Kl extends _t{constructor(t){super(),this.target=t}}class Jl extends _t{constructor(t){super(),this.target=t}}class ks extends _t{constructor(t,i,n,a,h){super(),this.other=i,this.side=n,this.intersection=a,this.contact=h,this.target=t}}class Fs extends _t{constructor(t,i,n,a,h){super(),this.other=i,this.side=n,this.intersection=a,this.contact=h,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class Mo{constructor(t,i,n,a){this.target=t,this.other=i,this.side=n,this.contact=a}}class Lo{constructor(t,i,n,a){this.target=t,this.other=i,this.side=n,this.lastContact=a}}class Oo{constructor(t,i,n,a,h){this.target=t,this.other=i,this.side=n,this.intersection=a,this.contact=h}}class No{constructor(t,i,n,a,h){this.target=t,this.other=i,this.side=n,this.intersection=a,this.contact=h}}class pr extends _t{constructor(t,i,n,a){super(),this.other=i,this.side=n,this.contact=a,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class gr extends _t{constructor(t,i,n,a){super(),this.other=i,this.side=n,this.lastContact=a,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class yn extends _t{constructor(t,i){super(),this.engine=t,this.target=i}}class th extends _t{constructor(t,i){super(),this.context=t,this.target=i}}class eh extends _t{constructor(t,i){super(),this.context=t,this.target=i}}class ih extends _t{constructor(t){super(),this.target=t}}class sh extends _t{constructor(t){super(),this.target=t}}class nh extends _t{constructor(t,i){super(),this.target=t,this.actor=i}}class rh extends _t{constructor(t,i){super(),this.target=t,this.actor=i}}class oh extends _t{constructor(t,i){super(),this.action=t,this.target=i}}class ah extends _t{constructor(t,i){super(),this.action=t,this.target=i}}class lh extends _t{set bubbles(t){}get bubbles(){return!1}get _path(){return null}set _path(t){}constructor(t,i="MediaEvent"){super(),this.target=t,this._name=i}stopPropagation(){}action(){}propagate(){}layPath(t){}}class Bs extends lh{constructor(t,i){super(t,"NativeSoundEvent"),this.track=i}}class Ld extends lh{constructor(t,i){super(t,"NativeSoundProcessedEvent"),this._processedData=i,this.data=this._processedData}}function R0(u){try{const t=new Audio,i=/.*\.([A-Za-z0-9]+)(?:(?:\?|\#).*)*$/,n=u.match(i)[1];return!!t.canPlayType("audio/"+n)}catch(t){return J.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",t),!1}}const I0={VolumeChange:"volumechange",Processed:"processed",Pause:"pause",Stop:"stop",PlaybackEnd:"playbackend",Resume:"resume",PlaybackStart:"playbackstart"};class Od{set loop(t){this._loop=t;for(const i of this._tracks)i.loop=this._loop;this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}get loop(){return this._loop}set volume(t){this._volume=t;for(const i of this._tracks)i.volume=this._volume;this.events.emit("volumechange",new Bs(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}get volume(){return this._volume}get duration(){return this._duration}set duration(t){this._duration=t}get instances(){return this._tracks}get path(){return this._resource.path}set path(t){this._resource.path=t}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}constructor(...t){this.events=new v,this.logger=J.getInstance(),this._loop=!1,this._volume=1,this._isStopped=!1,this._tracks=[],this._wasPlayingOnHidden=!1,this._playbackRate=1,this._audioContext=gn.create(),this._resource=new dr("",Ol.type.arraybuffer);for(const i of t)if(R0(i)){this.path=i;break}this.path||(this.logger.warn("This browser does not support any of the audio files specified:",t.join(", ")),this.logger.warn("Attempting to use",t[0]),this.path=t[0])}isLoaded(){return!!this.data}async load(){var t,i;if(this.data)return this.data;const n=await this._resource.load(),a=await this.decodeAudio(n.slice(0));return this._duration=(i=(t=this._duration)!==null&&t!==void 0?t:a==null?void 0:a.duration)!==null&&i!==void 0?i:void 0,this.events.emit("processed",new Ld(this,a)),this.data=a}async decodeAudio(t){try{return await this._audioContext.decodeAudioData(t.slice(0))}catch{return this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),await Promise.reject()}}wireEngine(t){t&&(this._engine=t,this._engine.on("hidden",()=>{t.pauseAudioWhenHidden&&this.isPlaying()&&(this._wasPlayingOnHidden=!0,this.pause())}),this._engine.on("visible",()=>{t.pauseAudioWhenHidden&&this._wasPlayingOnHidden&&(this.play(),this._wasPlayingOnHidden=!1)}),this._engine.on("start",()=>{this._isStopped=!1}),this._engine.on("stop",()=>{this.stop(),this._isStopped=!0}))}instanceCount(){return this._tracks.length}isPlaying(){return this._tracks.some(t=>t.isPlaying())}isPaused(){return this._tracks.some(t=>t.isPaused())}isStopped(){return this._tracks.some(t=>t.isStopped())}play(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this.isPaused()?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}pause(){if(this.isPlaying()){for(const t of this._tracks)t.pause();this.events.emit("pause",new Bs(this)),this.logger.debug("Paused all instances of sound",this.path)}}stop(){for(const t of this._tracks)t.stop();this.events.emit("stop",new Bs(this)),this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._tracks.forEach(i=>{i.playbackRate=this._playbackRate})}seek(t,i=0){this._tracks.length===0&&this._getTrackInstance(this.data),this._tracks[i].seek(t)}getTotalPlaybackDuration(){return this.isLoaded()?this.data.duration:(this.logger.warnOnce(`Sound from ${this.path} is not loaded, cannot return total playback duration.Did you forget to add Sound to a loader? https://excaliburjs.com/docs/loaders/`),0)}getPlaybackPosition(t=0){return this._tracks.length?this._tracks[t].getPlaybackPosition():0}getTrackId(t){return this._tracks.indexOf(t)}async _resumePlayback(){if(this.isPaused){const t=[];for(const i of this._tracks)t.push(i.play().then(()=>(this._tracks.splice(this.getTrackId(i),1),!0)));this.events.emit("resume",new Bs(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),await Promise.all(t)}return!0}async _startPlayback(){const t=this._getTrackInstance(this.data),i=await t.play(()=>{this.events.emit("playbackstart",new Bs(this,t)),this.logger.debug("Playing new instance for sound",this.path)});this.events.emit("playbackend",new Bs(this,t));const n=this.getTrackId(t);return n!==-1&&this._tracks.splice(n,1),i}_getTrackInstance(t){const i=new Md(t);return i.loop=this.loop,i.volume=this.volume,i.duration=this.duration,i.playbackRate=this._playbackRate,this._tracks.push(i),i}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}const D0={BeforeLoad:"beforeload",AfterLoad:"afterload",UserAction:"useraction",LoadResourceStart:"loadresourcestart",LoadResourceEnd:"loadresourceend"};function hh(u){var t,i;return!!(u!=null&&u.prototype)&&!!(!((i=(t=u==null?void 0:u.prototype)===null||t===void 0?void 0:t.constructor)===null||i===void 0)&&i.name)}class mr{get resources(){return this._resources}constructor(t){var i;this.events=new v,this.canvas=new Do({filtering:Yt.Blended,smoothing:!0,cache:!1,draw:this.onDraw.bind(this)}),this._resources=[],this._numLoaded=0,this._totalTimeMs=0,this._loadingFuture=new _,t&&(!((i=t.loadables)===null||i===void 0)&&i.length)&&this.addResources(t.loadables)}onInitialize(t){this.engine=t,this.canvas.width=this.engine.screen.resolution.width,this.canvas.height=this.engine.screen.resolution.height}async onUserAction(){return await Promise.resolve()}async onBeforeLoad(){}async onAfterLoad(){await ht(500,this.engine.clock)}addResource(t){this._resources.push(t)}addResources(t){let i=0;const n=t.length;for(i;i<n;i++)this.addResource(t[i])}markResourceComplete(){this._numLoaded++}get progress(){const t=this._resources.length;return t>0?O(this._numLoaded,0,t)/t:1}isLoaded(){return this._numLoaded===this._resources.length}onUpdate(t,i){this._totalTimeMs+=i}onDraw(t){const i=this._totalTimeMs/1e3;t.fillStyle=G.Black.toRGBA(),t.fillRect(0,0,this.engine.screen.resolution.width,this.engine.screen.resolution.height),t.save(),t.translate(this.engine.screen.resolution.width/2,this.engine.screen.resolution.height/2);const n=i*10;t.strokeStyle="white",t.lineWidth=10,t.lineCap="round",t.arc(0,0,40,n,n+Math.PI*3/2),t.stroke(),t.fillStyle="white",t.font="16px sans-serif";const a=(this.progress*100).toFixed(0)+"%",h=t.measureText(a),d=Math.abs(h.actualBoundingBoxLeft)+Math.abs(h.actualBoundingBoxRight),p=Math.abs(h.actualBoundingBoxAscent)+Math.abs(h.actualBoundingBoxDescent);t.fillText(a,-d/2,p/2),t.restore()}areResourcesLoaded(){return this._loadingFuture.promise}async load(){await this.onBeforeLoad(),this.events.emit("beforeload"),this.canvas.flagDirty(),await Promise.all(this._resources.map(async t=>{this.events.emit("loadresourcestart",t),await t.load().finally(()=>{this._numLoaded++,this.canvas.flagDirty(),this.events.emit("loadresourceend",t)})}));for(const t of this._resources)t instanceof Od&&t.wireEngine(this.engine);return this._loadingFuture.resolve(),this.canvas.flagDirty(),await this.onUserAction(),this.events.emit("useraction"),await Ds.unlock(),await this.onAfterLoad(),this.events.emit("afterload"),this.data=this._resources}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}function ch(u,t=G.Red,i,n,a,h,d=1,p="butt"){u.save(),u.beginPath(),u.lineWidth=d,u.lineCap=p,u.strokeStyle=t.toString(),u.moveTo(i,n),u.lineTo(a,h),u.closePath(),u.stroke(),u.restore()}function k0(u,t=G.Red,i){u.beginPath(),u.strokeStyle=t.toString(),u.arc(i.x,i.y,5,0,Math.PI*2),u.closePath(),u.stroke()}function F0(u,t,i,n,a=1){const h=t?t.toString():"blue",d=n.scale(a);u.beginPath(),u.strokeStyle=h,u.moveTo(i.x,i.y),u.lineTo(i.x+d.x,i.y+d.y),u.closePath(),u.stroke()}function uh(u,t,i,n,a,h=5,d=G.White,p=null){let m;if(typeof h=="number")m={tl:h,tr:h,br:h,bl:h};else{const y={tl:0,tr:0,br:0,bl:0};for(const w in y)if(y.hasOwnProperty(w)){const b=w;m[b]=h[b]||y[b]}}u.beginPath(),u.moveTo(t+m.tl,i),u.lineTo(t+n-m.tr,i),u.quadraticCurveTo(t+n,i,t+n,i+m.tr),u.lineTo(t+n,i+a-m.br),u.quadraticCurveTo(t+n,i+a,t+n-m.br,i+a),u.lineTo(t+m.bl,i+a),u.quadraticCurveTo(t,i+a,t,i+a-m.bl),u.lineTo(t,i+m.tl),u.quadraticCurveTo(t,i,t+m.tl,i),u.closePath(),p&&(u.fillStyle=p.toString(),u.fill()),d&&(u.strokeStyle=d.toString(),u.stroke())}function B0(u,t,i,n,a=G.White,h=null){u.beginPath(),u.arc(t,i,n,0,Math.PI*2),u.closePath(),h&&(u.fillStyle=h.toString(),u.fill()),a&&(u.strokeStyle=a.toString(),u.stroke())}const M0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=";var L0=It(8851);class Ms extends mr{get _image(){return this._imageElement||(this._imageElement=new Image,this._imageElement.onload=()=>this._imageLoaded.resolve(),this._imageElement.src=this.logo),this._imageElement}get playButtonRootElement(){return this._playButtonRootElement}get playButtonElement(){return this._playButtonElement}get _playButton(){const t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}constructor(t){const i=Array.isArray(t)?{loadables:t}:t;super(i),this._logger=J.getInstance(),this._originalOptions={loadables:[]},this.events=new v,this._playButtonShown=!1,this.logo=M0,this.logoWidth=468,this.logoHeight=118,this.loadingBarColor=G.White,this.backgroundColor="#176BAA",this._imageLoaded=new _,this.suppressPlayButton=!1,this._playButtonStyles=L0.A.toString(),this.playButtonText="Play game",this.startButtonFactory=()=>{let n=document.getElementById("excalibur-play");return n||(n=document.createElement("button")),n.id="excalibur-play",n.textContent=this.playButtonText,n.style.display="none",n},this._configuredPixelRatio=null,this._originalOptions={...Ms._DEFAULT_LOADER_OPTIONS,...i}}onInitialize(t){this.engine=t,this.screen=t.screen,this.canvas.width=this.engine.canvas.width,this.canvas.height=this.engine.canvas.height,this.screen.events.on("resize",()=>{this.canvas.width=this.engine.canvas.width,this.canvas.height=this.engine.canvas.height})}async showPlayButton(){var t,i;if(this.suppressPlayButton)this.hidePlayButton(),await ht(500,(t=this.engine)===null||t===void 0?void 0:t.clock);else{const n=()=>{try{this._positionPlayButton()}catch{}};return!((i=this.engine)===null||i===void 0)&&i.browser&&this.engine.browser.window.on("resize",n),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",h=>{h.key==="Enter"&&this._playButton.click()}),this._positionPlayButton(),await new Promise(h=>{const d=p=>{var m;if(p.stopPropagation(),this.hidePlayButton(),!((m=this.engine)===null||m===void 0)&&m.browser&&this.engine.browser.window.off("resize",n),this._originalOptions.fullscreenAfterLoad)try{this._logger.info("requesting fullscreen"),this._originalOptions.fullscreenContainer instanceof HTMLElement?this._originalOptions.fullscreenContainer.requestFullscreen():this.engine.screen.goFullScreen(this._originalOptions.fullscreenContainer)}catch(y){this._logger.error("could not go fullscreen",y)}h()};this._playButton.addEventListener("click",d),this._playButton.addEventListener("touchend",d),this._playButton.addEventListener("pointerup",d)})}}hidePlayButton(){this._playButtonShown=!1,this._playButton.style.display="none"}dispose(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}async onUserAction(){var t;await ht(200,(t=this.engine)===null||t===void 0?void 0:t.clock),this.canvas.flagDirty(),await this.showPlayButton()}async onBeforeLoad(){const t=this._image;await this._imageLoaded.promise,await(t==null?void 0:t.decode())}async onAfterLoad(){this.screen.pixelRatioOverride=this._configuredPixelRatio,this.screen.popResolutionAndViewport(),this.screen.applyResolutionAndViewport(),this.dispose()}_positionPlayButton(){if(this.engine){const{x:t,y:i,width:n,height:a}=this.engine.canvas.getBoundingClientRect();if(this._playButtonRootElement){const h=this._playButton.clientWidth,d=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left=`${this.playButtonPosition.x}px`,this._playButtonRootElement.style.top=`${this.playButtonPosition.y}px`):(this._playButtonRootElement.style.left=`${t+n/2-h/2}px`,this._playButtonRootElement.style.top=`${i+a/2-d/2+100}px`)}}}onDraw(t){const i=this.engine.canvasHeight/this.engine.pixelRatio,n=this.engine.canvasWidth/this.engine.pixelRatio;this._positionPlayButton(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,n,i);let a=i/2;const h=Math.min(this.logoWidth,n*.75);let d=n/2-h/2;this.logoPosition&&(d=this.logoPosition.x,a=this.logoPosition.y);const p=Math.floor(h*(this.logoHeight/this.logoWidth)),m=this.engine.getAntialiasing();if(this.engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,d,a,h,p):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,d,a-p-20,h,p),!this.suppressPlayButton&&this._playButtonShown){this.engine.setAntialiasing(m);return}let y=d,w=a;this.loadingBarPosition&&(y=this.loadingBarPosition.x,w=this.loadingBarPosition.y),t.lineWidth=2,uh(t,y,w,h,20,10,this.loadingBarColor);const b=h*this.progress,R=5,k=b-R*2,M=20-R*2;uh(t,y+R,w+R,k>10?k:10,M,5,null,this.loadingBarColor),this.engine.setAntialiasing(m)}}Ms._DEFAULT_LOADER_OPTIONS={loadables:[],fullscreenAfterLoad:!1,fullscreenContainer:void 0};const Nd={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"};class Ud{constructor(){this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){const t=document.createElement("canvas");return!!(t.getContext&&t.getContext("2d"))},arrayBufferSupport:function(){const t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch{return!1}return t.responseType==="arraybuffer"},dataUrlSupport:function(){return document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")===0},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){const t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){const t=document.createElement("canvas");return!!(t.getContext&&t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}getBrowserFeatures(){return this._features===null&&(this._features=this._loadBrowserFeatures()),this._features}logBrowserFeatures(){let t=`%cSUPPORTED BROWSER FEATURES
==========================%c
`;const i=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],n=this.getBrowserFeatures();for(const a of Object.keys(Nd))n[a]?(t+="(%c%c)",i.push("font-weight: bold; color: green"),i.push("font-weight: normal; color: inherit")):(t+="(%c%c)",i.push("font-weight: bold; color: red"),i.push("font-weight: normal; color: inherit")),t+=" "+Nd[a]+`
`;i.unshift(t),console.log.apply(console,i)}_loadBrowserFeatures(){return{canvas:this._criticalTests.canvasSupport(),arraybuffer:this._criticalTests.arrayBufferSupport(),dataurl:this._criticalTests.dataUrlSupport(),objecturl:this._criticalTests.objectUrlSupport(),rgba:this._criticalTests.rgbaSupport(),webaudio:this._warningTest.webAudioSupport(),webgl:this._warningTest.webglSupport(),gamepadapi:!!navigator.getGamepads}}test(){let t=!1;for(const i in this._criticalTests)this._criticalTests[i].call(this)||(this.failedTests.push(i),J.getInstance().error("Critical browser feature missing, Excalibur requires:",i),t=!0);if(t)return!1;for(const i in this._warningTest)this._warningTest[i]()||J.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",i);return!0}}var ft;(function(u){u.PreventCollision="PreventCollision",u.Passive="Passive",u.Active="Active",u.Fixed="Fixed"})(ft||(ft={}));var te;(function(u){u.World="world",u.Screen="screen"})(te||(te={}));class dh extends E{constructor(t){super(0,0),this._getX=t.getX,this._getY=t.getY,this._setX=t.setX,this._setY=t.setY}get x(){return this._x=this._getX()}set x(t){this._setX(t),this._x=t}get y(){return this._y=this._getY()}set y(t){this._setY(t),this._y=t}}class Uo extends E{constructor(t,i){super(t.x,t.y),this.original=t,this.change=i}get x(){return this._x=this.original.x}set x(t){this.change(t,this._y),this._x=this.original.x=t}get y(){return this._y=this.original.y}set y(t){this.change(this._x,t),this._y=this.original.y=t}}class Ls{constructor(){this._parent=null,this._children=[],this._pos=B(0,0),this._rotation=0,this._scale=B(1,1),this._isDirty=!1,this._isInverseDirty=!1,this._matrix=bt.identity(),this._inverse=bt.identity()}get parent(){return this._parent}set parent(t){if(this._parent){const i=this._parent._children.indexOf(this);i>-1&&this._parent._children.splice(i,1)}this._parent=t,this._parent&&this._parent._children.push(this),this.flagDirty()}get children(){return this._children}set pos(t){t.equals(this._pos)||(this._pos.x=t.x,this._pos.y=t.y,this.flagDirty())}get pos(){return new Uo(this._pos,(t,i)=>{(t!==this._pos.x||i!==this._pos.y)&&this.flagDirty()})}set globalPos(t){let i=t.clone();this.parent&&(i=this.parent.inverse.multiply(t)),i.equals(this._pos)||(this._pos=i,this.flagDirty())}get globalPos(){return new dh({getX:()=>this.matrix.data[4],getY:()=>this.matrix.data[5],setX:t=>{if(this.parent){const{x:i}=this.parent.inverse.multiply(B(t,this.pos.y));this.pos.x=i}else this.pos.x=t;t!==this.matrix.data[4]&&this.flagDirty()},setY:t=>{if(this.parent){const{y:i}=this.parent.inverse.multiply(B(this.pos.x,t));this.pos.y=i}else this.pos.y=t;t!==this.matrix.data[5]&&this.flagDirty()}})}set rotation(t){const i=T(t);i!==this._rotation&&this.flagDirty(),this._rotation=i}get rotation(){return this._rotation}set globalRotation(t){let i=0;this.parent&&(i=this.parent.globalRotation);const n=T(t+i);n!==this._rotation&&this.flagDirty(),this._rotation=n}get globalRotation(){return this.parent?this.matrix.getRotation():this.rotation}set scale(t){(t.x!==this._scale.x||t.y!==this._scale.y)&&(this._scale.x=t.x,this._scale.y=t.y,this.flagDirty())}get scale(){return new Uo(this._scale,(t,i)=>{(t!==this._scale.x||i!==this._scale.y)&&this.flagDirty()})}set globalScale(t){let i=B(1,1);this.parent&&(i=this.parent.globalScale),this.scale=t.scale(B(1/i.x,1/i.y))}get globalScale(){return new dh({getX:()=>this.parent?this.matrix.getScaleX():this.scale.x,getY:()=>this.parent?this.matrix.getScaleY():this.scale.y,setX:t=>{if(this.parent){const i=this.parent.globalScale.x;this.scale.x=t/i}else this.scale.x=t},setY:t=>{if(this.parent){const i=this.parent.globalScale.y;this.scale.y=t/i}else this.scale.y=t}})}get matrix(){return this._isDirty&&(this.parent===null?this._matrix=this._calculateMatrix():this._matrix=this.parent.matrix.multiply(this._calculateMatrix()),this._isDirty=!1),this._matrix}get inverse(){return this._isInverseDirty&&(this._inverse=this.matrix.inverse(),this._isInverseDirty=!1),this._inverse}_calculateMatrix(){return bt.identity().translate(this.pos.x,this.pos.y).rotate(this.rotation).scale(this.scale.x,this.scale.y)}flagDirty(){this._isDirty=!0,this._isInverseDirty=!0;for(let t=0;t<this._children.length;t++)this._children[t].flagDirty()}apply(t){return this.matrix.multiply(t)}applyInverse(t){return this.inverse.multiply(t)}setTransform(t,i,n){this._pos.x=t.x,this._pos.y=t.y,this._rotation=T(i),this._scale.x=n.x,this._scale.y=n.y,this.flagDirty()}clone(t){const i=t??new Ls;return this._pos.clone(i._pos),i._rotation=this._rotation,this._scale.clone(i._scale),i.flagDirty(),i}}function zd(u){return!!u&&!!u.prototype&&!!u.prototype.constructor}function O0(u){return!!(u!=null&&u.clone)}class pi{constructor(){this.owner=void 0}clone(){const t=new this.constructor;for(const i in this)if(this.hasOwnProperty(i)){const n=this[i];O0(n)&&i!=="owner"&&i!=="clone"?t[i]=n.clone():t[i]=n}return t}}class we{constructor(){this.observers=[],this.subscriptions=[]}register(t){this.observers.push(t)}subscribe(t){this.subscriptions.push(t)}unregister(t){const i=this.observers.indexOf(t);i!==-1&&this.observers.splice(i,1)}unsubscribe(t){const i=this.subscriptions.indexOf(t);i!==-1&&this.subscriptions.splice(i,1)}notifyAll(t){const i=this.observers.length;for(let a=0;a<i;a++)this.observers[a].notify(t);const n=this.subscriptions.length;for(let a=0;a<n;a++)this.subscriptions[a](t)}clear(){this.observers.length=0,this.subscriptions.length=0}}class it extends pi{constructor(){super(...arguments),this._logger=J.getInstance(),this._parentComponent=null,this._transform=new Ls,this._addChildTransform=t=>{const i=t.get(it);i&&(i._transform.parent=this._transform,i._parentComponent=this)},this.zIndexChanged$=new we,this._z=0,this._coordPlane=te.World}get(){return this._transform}onAdd(t){for(const i of t.children)this._addChildTransform(i);t.childrenAdded$.subscribe(i=>this._addChildTransform(i)),t.childrenRemoved$.subscribe(i=>{const n=i.get(it);n&&(n._transform.parent=null,n._parentComponent=null)})}onRemove(t){this._transform.parent=null,this._parentComponent=null}get z(){return this._z}set z(t){const i=this._z;this._z=t,i!==t&&this.zIndexChanged$.notifyAll(t)}get coordPlane(){return this._parentComponent?this._parentComponent.coordPlane:this._coordPlane}set coordPlane(t){var i;this._parentComponent?this._logger.warn(`Cannot set coordinate plane on child entity ${(i=this.owner)===null||i===void 0?void 0:i.name}, children inherit their coordinate plane from their parents.`):this._coordPlane=t}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get globalPos(){return this._transform.globalPos}set globalPos(t){this._transform.globalPos=t}get rotation(){return this._transform.rotation}set rotation(t){this._transform.rotation=t}get globalRotation(){return this._transform.globalRotation}set globalRotation(t){this._transform.globalRotation=t}get scale(){return this._transform.scale}set scale(t){this._transform.scale=t}get globalScale(){return this._transform.globalScale}set globalScale(t){this._transform.globalScale=t}applyInverse(t){return this._transform.applyInverse(t)}apply(t){return this._transform.apply(t)}clone(){const t=new it;return t._transform=this._transform.clone(),t._z=this._z,t}}class Ft extends pi{constructor(){super(...arguments),this.vel=E.Zero,this.acc=E.Zero,this.scaleFactor=E.Zero,this.angularVelocity=0,this.torque=0,this.inertia=1}}class Ei{static create(t,i){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);if(this._GROUPS.get(t)){const a=this._GROUPS.get(t);if(a.mask===i)return a;throw new Error(`Collision group ${t} already exists with a different mask!`)}const n=new Os(t,this._CURRENT_BIT,i!==void 0?i:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,n),n}static get groups(){return Array.from(this._GROUPS.values())}static groupByName(t){return this._GROUPS.get(t)}static reset(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}Ei._STARTING_BIT=1,Ei._MAX_GROUPS=32,Ei._CURRENT_GROUP=1,Ei._CURRENT_BIT=Ei._STARTING_BIT,Ei._GROUPS=new Map;class Os{constructor(t,i,n){this._name=t,this._category=i,this._mask=n}get name(){return this._name}get category(){return this._category}get mask(){return this._mask}canCollide(t){const i=this.category&t.mask,n=this.mask&t.category;return i!==0&&n!==0}invert(){const t=Ei.create("~("+this.name+")",~this.mask|0);return t._category=~this.category,t}static combine(t){const i=t.map(h=>h.name).join("+"),a=~t.reduce((h,d)=>d.category|h,0);return Ei.create(i,a)}static collidesWith(t){const i=`collidesWith(${t.map(a=>a.name).join("+")})`,n=t.reduce((a,h)=>h.category|a,0);return Ei.create(i,n)}toString(){return`
category: ${this.category.toString(2).padStart(32,"0")}
mask:     ${(this.mask>>>0).toString(2).padStart(32,"0")}
    `}}Os.All=new Os("Collide with all groups",-1,-1);class $e{constructor(t,i){this.colliderA=t,this.colliderB=i,this.id=null,this.id=$e.calculatePairHash(t.id,i.id)}static canCollide(t,i){var n,a;const h=(n=t==null?void 0:t.owner)===null||n===void 0?void 0:n.get(ct),d=(a=i==null?void 0:i.owner)===null||a===void 0?void 0:a.get(ct);return!(t.id===i.id||t.owner&&i.owner&&t.owner.id===i.owner.id||t.localBounds.hasZeroDimensions()||i.localBounds.hasZeroDimensions()||!h||!d||!h.group.canCollide(d.group)||h.collisionType===ft.Fixed&&d.collisionType===ft.Fixed||d.collisionType===ft.PreventCollision||h.collisionType===ft.PreventCollision||!h.active||!d.active)}get canCollide(){const t=this.colliderA,i=this.colliderB;return $e.canCollide(t,i)}collide(){return this.colliderA.collide(this.colliderB)}hasCollider(t){return t===this.colliderA||t===this.colliderB}static calculatePairHash(t,i){return t.value<i.value?`#${t.value}+${i.value}`:`#${i.value}+${t.value}`}}class _r{constructor(t,i){this.min=t,this.max=i}overlaps(t){return this.max>t.min&&t.max>this.min}getOverlap(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}class fh{constructor(t){this.parent=t,this.parent=t||null,this.data=null,this.bounds=new et,this.left=null,this.right=null,this.height=0}isLeaf(){return!this.left&&!this.right}}class ph{constructor(t,i=new et(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)){this._config=t,this.worldBounds=i,this.root=null,this.nodes={}}_insert(t){if(this.root===null){this.root=t,this.root.parent=null;return}const i=t.bounds;let n=this.root;for(;!n.isLeaf();){const p=n.left,m=n.right,y=n.bounds.getPerimeter(),b=n.bounds.combine(i).getPerimeter(),R=2*b,k=2*(b-y);let M=0;const z=i.combine(p.bounds);let X,N;p.isLeaf()?M=z.getPerimeter()+k:(N=p.bounds.getPerimeter(),X=z.getPerimeter(),M=X-N+k);let U=0;const Y=i.combine(m.bounds);if(m.isLeaf()?U=Y.getPerimeter()+k:(N=m.bounds.getPerimeter(),X=Y.getPerimeter(),U=X-N+k),R<M&&R<U)break;M<U?n=p:n=m}const a=n.parent,h=new fh(a);h.bounds=i.combine(n.bounds),h.height=n.height+1,a!==null?(a.left===n?a.left=h:a.right=h,h.left=n,h.right=t,n.parent=h,t.parent=h):(h.left=n,h.right=t,n.parent=h,t.parent=h,this.root=h);let d=t.parent;for(;d;){if(d=this._balance(d),!d.left)throw new Error("Parent of current leaf cannot have a null left child"+d);if(!d.right)throw new Error("Parent of current leaf cannot have a null right child"+d);d.height=1+Math.max(d.left.height,d.right.height),d.bounds=d.left.bounds.combine(d.right.bounds),d=d.parent}}_remove(t){if(t===this.root){this.root=null;return}const i=t.parent,n=i.parent;let a;if(i.left===t?a=i.right:a=i.left,n){n.left===i?n.left=a:n.right=a,a.parent=n;let h=n;for(;h;)h=this._balance(h),h.bounds=h.left.bounds.combine(h.right.bounds),h.height=1+Math.max(h.left.height,h.right.height),h=h.parent}else this.root=a,a.parent=null}trackCollider(t){const i=new fh;i.data=t,i.bounds=t.bounds,i.bounds.left-=2,i.bounds.top-=2,i.bounds.right+=2,i.bounds.bottom+=2,this.nodes[t.id.value]=i,this._insert(i)}updateCollider(t){var i;const n=this.nodes[t.id.value];if(!n)return!1;const a=t.bounds;if(!this.worldBounds.contains(a))return J.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(n.bounds.contains(a))return!1;if(this._remove(n),a.left-=this._config.boundsPadding,a.top-=this._config.boundsPadding,a.right+=this._config.boundsPadding,a.bottom+=this._config.boundsPadding,t.owner){const h=(i=t.owner)===null||i===void 0?void 0:i.get(ct);if(h){const d=h.vel.x*32/1e3*this._config.velocityMultiplier,p=h.vel.y*32/1e3*this._config.velocityMultiplier;d<0?a.left+=d:a.right+=d,p<0?a.top+=p:a.bottom+=p}}return n.bounds=a,this._insert(n),!0}untrackCollider(t){const i=this.nodes[t.id.value];i&&(this._remove(i),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}_balance(t){if(t===null)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;const i=t.left,n=t.right,a=t,h=i,d=n,p=i.left,m=i.right,y=n.left,w=n.right,b=d.height-h.height;if(b>1)return d.left=a,d.parent=a.parent,a.parent=d,d.parent?d.parent.left===a?d.parent.left=d:d.parent.right=d:this.root=d,y.height>w.height?(d.right=y,a.right=w,w.parent=a,a.bounds=h.bounds.combine(w.bounds),d.bounds=a.bounds.combine(y.bounds),a.height=1+Math.max(h.height,w.height),d.height=1+Math.max(a.height,y.height)):(d.right=w,a.right=y,y.parent=a,a.bounds=h.bounds.combine(y.bounds),d.bounds=a.bounds.combine(w.bounds),a.height=1+Math.max(h.height,y.height),d.height=1+Math.max(a.height,w.height)),d;if(b<-1){if(h.left=a,h.parent=a.parent,a.parent=h,h.parent)if(h.parent.left===a)h.parent.left=h;else{if(h.parent.right!==a)throw"Error rotating Dynamic Tree";h.parent.right=h}else this.root=h;return p.height>m.height?(h.right=p,a.left=m,m.parent=a,a.bounds=d.bounds.combine(m.bounds),h.bounds=a.bounds.combine(p.bounds),a.height=1+Math.max(d.height,m.height),h.height=1+Math.max(a.height,p.height)):(h.right=m,a.left=p,p.parent=a,a.bounds=d.bounds.combine(p.bounds),h.bounds=a.bounds.combine(m.bounds),a.height=1+Math.max(d.height,p.height),h.height=1+Math.max(a.height,m.height)),h}return t}getHeight(){return this.root===null?0:this.root.height}query(t,i){const n=t.bounds,a=h=>{if(h&&h.bounds.overlaps(n))if(h.isLeaf()&&h.data!==t){if(i.call(t,h.data))return!0}else return a(h.left)||a(h.right);return!1};a(this.root)}rayCastQuery(t,i=1/0,n){const a=h=>{if(h&&h.bounds.rayCast(t,i))if(h.isLeaf()){if(n.call(t,h.data))return!0}else return a(h.left)||a(h.right);return!1};a(this.root)}getNodes(){const t=i=>i?[i].concat(t(i.left),t(i.right)):[];return t(this.root)}debug(t){const i=n=>{n&&(n.isLeaf()?n.bounds.draw(t,G.Green):n.bounds.draw(t,G.White),n.left&&i(n.left),n.right&&i(n.right))};i(this.root)}}class ji{constructor(t,i){this.pos=t,this.dir=i.normalize()}intersect(t){const i=t.begin.sub(this.pos);if(this.dir.cross(t.getSlope())===0&&i.cross(this.dir)!==0)return-1;const n=this.dir.cross(t.getSlope());if(n===0)return-1;const a=i.cross(t.getSlope())/n;if(a>=0){const h=i.cross(this.dir)/n/t.getLength();if(h>=0&&h<=1)return a}return-1}intersectPoint(t){const i=this.intersect(t);return i<0?null:this.getPoint(i)}getPoint(t){return this.pos.add(this.dir.scale(t))}}class zo{constructor(t){this._config=t,this._pairs=new Set,this._collisionPairCache=[],this._colliders=[],this._dynamicCollisionTree=new ph(t.dynamicTree)}getColliders(){return this._colliders}rayCast(t,i){var n,a,h;const d=[],p=(n=i==null?void 0:i.maxDistance)!==null&&n!==void 0?n:1/0,m=i==null?void 0:i.collisionGroup,y=m?m.category:(a=i==null?void 0:i.collisionMask)!==null&&a!==void 0?a:Os.All.category,w=(h=i==null?void 0:i.searchAllColliders)!==null&&h!==void 0?h:!1;return this._dynamicCollisionTree.rayCastQuery(t,p,b=>{const k=b.owner.get(ct);if(i!=null&&i.ignoreCollisionGroupAll&&k.group===Os.All)return!1;const M=(y&k.group.category)!==0;if(k!=null&&k.group&&!M)return!1;const z=b.rayCast(t,p);if(z){if(i!=null&&i.filter){if(i.filter(z)&&(d.push(z),!w))return!0}else if(d.push(z),!w)return!0}return!1}),d}track(t){if(!t){J.getInstance().warn("Cannot track null collider");return}if(t instanceof ue){const i=t.getColliders();for(const n of i)n.owner=t.owner,this._colliders.push(n),this._dynamicCollisionTree.trackCollider(n)}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t)}untrack(t){if(!t){J.getInstance().warn("Cannot untrack a null collider");return}if(t instanceof ue){const i=t.getColliders();for(const n of i){const a=this._colliders.indexOf(n);a!==-1&&this._colliders.splice(a,1),this._dynamicCollisionTree.untrackCollider(n)}}else{const i=this._colliders.indexOf(t);i!==-1&&this._colliders.splice(i,1),this._dynamicCollisionTree.untrackCollider(t)}}_pairExists(t,i){const n=$e.calculatePairHash(t.id,i.id);return this._pairs.has(n)}broadphase(t,i,n){const a=i/1e3,h=t.filter(p=>{var m,y;const w=(m=p.owner)===null||m===void 0?void 0:m.get(ct);return((y=p.owner)===null||y===void 0?void 0:y.active)&&w.collisionType!==ft.PreventCollision});this._collisionPairCache=[],this._pairs.clear();let d;for(let p=0,m=h.length;p<m;p++)d=h[p],this._dynamicCollisionTree.query(d,y=>{if(!this._pairExists(d,y)&&$e.canCollide(d,y)){const w=new $e(d,y);this._pairs.add(w.id),this._collisionPairCache.push(w)}return!1});if(n&&(n.physics.pairs=this._collisionPairCache.length),this._config.continuous.checkForFastBodies)for(const p of h){const m=p.owner.get(ct);if(m.collisionType!==ft.Active)continue;const y=m.vel.size*a+m.acc.size*.5*a*a,w=Math.min(p.bounds.height,p.bounds.width);if(this._config.continuous.disableMinimumSpeedForFastBody||y>w/2){n&&n.physics.fastBodies++;const b=m.globalPos.sub(m.oldPos),R=p.center,k=p.getFurthestPoint(m.vel),M=k.sub(b),z=new ji(M,m.vel);z.pos=z.pos.add(z.dir.scale(-2*this._config.continuous.surfaceEpsilon));let X,N=new E(1/0,1/0);if(this._dynamicCollisionTree.rayCastQuery(z,y+this._config.continuous.surfaceEpsilon*2,U=>{if(!this._pairExists(p,U)&&$e.canCollide(p,U)){const Y=U.rayCast(z,y+this._config.continuous.surfaceEpsilon*10);if(Y){const H=Y.point.sub(M);H.size<N.size&&(N=H,X=U)}}return!1}),X&&E.isValid(N)){const U=new $e(p,X);this._pairs.has(U.id)||(this._pairs.add(U.id),this._collisionPairCache.push(U));const Y=R.sub(k);m.globalPos=M.add(Y).add(N).add(z.dir.scale(10*this._config.continuous.surfaceEpsilon)),p.update(m.transform.get()),n&&n.physics.fastBodyCollisions++}}}return this._collisionPairCache}narrowphase(t,i){let n=[];for(let a=0;a<t.length;a++){const h=t[a].collide();if(n=n.concat(h),i&&h.length>0)for(const d of h)i.physics.contacts.set(d.id,d)}return i&&(i.physics.collisions+=n.length),n}update(t){let i=0;const n=t.length;for(let a=0;a<n;a++)this._dynamicCollisionTree.updateCollider(t[a])&&i++;return i}debug(t){this._dynamicCollisionTree.debug(t)}}class ss{constructor(){this.id=g("collider",ss._ID++),this.composite=null,this.events=new v,this.offset=E.Zero}touching(t){return!!this.collide(t)}}ss._ID=0;var ns;(function(u){u.Arcade="arcade",u.Realistic="realistic"})(ns||(ns={}));var Ho;(function(u){u[u.DynamicAABBTree=0]="DynamicAABBTree"})(Ho||(Ho={}));var Wo;(function(u){u[u.Euler=0]="Euler"})(Wo||(Wo={}));class ut{static get gravity(){return ut.acc}static set gravity(t){ut.acc=t}static useArcadePhysics(){ut.collisionResolutionStrategy=ns.Arcade}static useRealisticPhysics(){ut.collisionResolutionStrategy=ns.Realistic}}ut.acc=new E(0,0),ut.enabled=!0,ut.broadphaseStrategy=Ho.DynamicAABBTree,ut.collisionResolutionStrategy=ns.Arcade,ut.defaultMass=10,ut.integrator=Wo.Euler,ut.dynamicTreeVelocityMultiplier=2,ut.boundsPadding=5,ut.positionIterations=3,ut.velocityIterations=8,ut.slop=1,ut.steeringFactor=.2,ut.warmStart=!0,ut.bodiesCanSleepByDefault=!1,ut.surfaceEpsilon=.1,ut.sleepEpsilon=.07,ut.wakeThreshold=ut.sleepEpsilon*3,ut.sleepBias=.9,ut.checkForFastBodies=!0,ut.disableMinimumSpeedForFastBody=!1;var Ns;(function(u){u.None="none",u.VerticalFirst="vertical-first",u.HorizontalFirst="horizontal-first"})(Ns||(Ns={}));const Hd={vertical:1,horizontal:2},Wd={horizontal:1,vertical:2},jd={horizontal:0,vertical:0},Ai={enabled:!0,gravity:B(0,0),solver:ns.Arcade,colliders:{compositeStrategy:"together"},continuous:{checkForFastBodies:!0,disableMinimumSpeedForFastBody:!1,surfaceEpsilon:.1},bodies:{canSleepByDefault:!1,sleepEpsilon:.07,wakeThreshold:.07*3,sleepBias:.9,defaultMass:10},dynamicTree:{boundsPadding:5,velocityMultiplier:2},arcade:{contactSolveBias:Ns.None},realistic:{positionIterations:3,velocityIterations:8,slop:1,steeringFactor:.2,warmStart:!0}};function gh(){return{enabled:ut.enabled,gravity:ut.gravity,solver:ut.collisionResolutionStrategy,continuous:{checkForFastBodies:ut.checkForFastBodies,disableMinimumSpeedForFastBody:ut.disableMinimumSpeedForFastBody,surfaceEpsilon:ut.surfaceEpsilon},colliders:{compositeStrategy:"together"},bodies:{canSleepByDefault:ut.bodiesCanSleepByDefault,sleepEpsilon:ut.sleepEpsilon,wakeThreshold:ut.wakeThreshold,sleepBias:ut.sleepBias,defaultMass:ut.defaultMass},dynamicTree:{boundsPadding:ut.boundsPadding,velocityMultiplier:ut.dynamicTreeVelocityMultiplier},arcade:{contactSolveBias:Ns.None},realistic:{positionIterations:ut.positionIterations,velocityIterations:ut.velocityIterations,slop:ut.slop,steeringFactor:ut.steeringFactor,warmStart:ut.warmStart}}}class ue extends ss{set compositeStrategy(t){this._compositeStrategy=t}get compositeStrategy(){return this._compositeStrategy}constructor(t){super(),this._collisionProcessor=new zo(Ai),this._dynamicAABBTree=new ph(Ai.dynamicTree),this._colliders=[];for(const i of t)this.addCollider(i)}clearColliders(){this._colliders=[]}addCollider(t){let i;t instanceof ue?(i=t.getColliders(),i.forEach(n=>n.offset.addEqual(t.offset))):i=[t];for(const n of i)n.events.pipe(this.events),n.composite=this,this._colliders.push(n),this._collisionProcessor.track(n),this._dynamicAABBTree.trackCollider(n)}removeCollider(t){t.events.pipe(this.events),t.composite=null,lt(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}getColliders(){return this._colliders}get worldPos(){var t,i;return((i=(t=this._transform)===null||t===void 0?void 0:t.pos)!==null&&i!==void 0?i:E.Zero).add(this.offset)}get center(){var t,i;return((i=(t=this._transform)===null||t===void 0?void 0:t.pos)!==null&&i!==void 0?i:E.Zero).add(this.offset)}get bounds(){var t,i;const n=this.getColliders();return n.reduce((h,d)=>h.combine(d.bounds),(i=(t=n[0])===null||t===void 0?void 0:t.bounds)!==null&&i!==void 0?i:new et().translate(this.worldPos)).translate(this.offset)}get localBounds(){var t,i;const n=this.getColliders();return n.reduce((h,d)=>h.combine(d.localBounds),(i=(t=n[0])===null||t===void 0?void 0:t.localBounds)!==null&&i!==void 0?i:new et)}get axes(){const t=this.getColliders();let i=[];for(const n of t)i=i.concat(n.axes);return i}getFurthestPoint(t){const i=this.getColliders(),n=[];for(const d of i)n.push(d.getFurthestPoint(t));let a=n[0],h=-Number.MAX_VALUE;for(const d of n){const p=d.dot(t);p>h&&(a=d,h=p)}return a}getInertia(t){const i=this.getColliders();let n=0;for(const a of i)n+=a.getInertia(t);return n}collide(t){let i=[t];t instanceof ue&&(i=t.getColliders());const n=[];for(const h of i)this._dynamicAABBTree.query(h,d=>(n.push(new $e(h,d)),!1));let a=[];for(const h of n)a=a.concat(h.collide());return a}getClosestLineBetween(t){const i=this.getColliders(),n=[];if(t instanceof ue){const a=t.getColliders();for(const h of i)for(const d of a){const p=h.getClosestLineBetween(d);p&&n.push(p)}}else for(const a of i){const h=t.getClosestLineBetween(a);h&&n.push(h)}if(n.length){let a=n[0].getLength(),h=n[0];for(const d of n){const p=d.getLength();p<a&&(a=p,h=d)}return h}return null}contains(t){const i=this.getColliders();for(const n of i)if(n.contains(t))return!0;return!1}rayCast(t,i){const n=this.getColliders(),a=[];for(const h of n){const d=h.rayCast(t,i);d&&a.push(d)}if(a.length){let h=a[0],d=h.point.dot(t.dir);for(const p of a){const m=t.dir.dot(p.point);m<d&&(h=p,d=m)}return h}return null}project(t){const i=this.getColliders(),n=[];for(const a of i){const h=a.project(t);h&&n.push(h)}if(n.length){const a=new _r(n[0].min,n[0].max);for(const h of n)a.min=Math.min(h.min,a.min),a.max=Math.max(h.max,a.max);return a}return null}update(t){if(t){const i=this.getColliders();for(const n of i)n.owner=this.owner,n.update(t)}}debug(t,i,n){const a=this.getColliders();t.save(),t.translate(this.offset.x,this.offset.y);for(const h of a)h.debug(t,i,n);t.restore()}clone(){const t=new ue(this._colliders.map(i=>i.clone()));return t.offset=this.offset.clone(),t}}class Ee{constructor(t,i){this.begin=t,this.end=i}get slope(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}get intercept(){return this.begin.y-this.slope*this.begin.x}normal(){return this._normal?this._normal:this._normal=this.end.sub(this.begin).normal()}dir(){return this._dir?this._dir:this._dir=this.end.sub(this.begin)}getPoints(){return[this.begin,this.end]}getSlope(){if(this._slope)return this._slope;const t=this.begin,i=this.end,n=t.distance(i);return this._slope=i.sub(t).scale(1/n)}getEdge(){const t=this.begin;return this.end.sub(t)}getLength(){if(this._length)return this._length;const t=this.begin,i=this.end,n=t.distance(i);return this._length=n}get midpoint(){return this.begin.add(this.end).scale(.5)}flip(){return new Ee(this.end,this.begin)}below(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}clip(t,i){let n=t;n=n.normalize();const a=n.dot(this.begin)-i,h=n.dot(this.end)-i,d=[];if(a<=0&&d.push(this.begin),h<=0&&d.push(this.end),a*h<0){const p=a/(a-h);d.push(this.begin.add(this.end.sub(this.begin).scale(p)))}return d.length!==2?null:new Ee(d[0],d[1])}distanceToPoint(t,i=!1){const n=t.x,a=t.y,h=this.getLength(),d=this.end.y-this.begin.y,p=this.end.x-this.begin.x,m=(d*n-p*a+this.end.x*this.begin.y-this.end.y*this.begin.x)/h;return i?m:Math.abs(m)}findVectorToPoint(t){const i=this.begin.sub(t),n=this.getSlope();return i.sub(n.scale(i.dot(n)))}findPoint(t=null,i=null){const n=this.slope,a=this.intercept;if(t!==null)return new E(t,n*t+a);if(i!==null)return new E((i-a)/n,i);throw new Error("You must provide an X or a Y value")}hasPoint(){let t,i=0;if(typeof arguments[0]=="number"&&typeof arguments[1]=="number")t=new E(arguments[0],arguments[1]),i=arguments[2]||0;else if(arguments[0]instanceof E)t=arguments[0],i=arguments[1]||0;else throw"Could not determine the arguments for Vector.hasPoint";const n=t.x-this.begin.x,a=t.y-this.begin.y,h=this.end.x-this.begin.x,d=this.end.y-this.begin.y,p=n*d-a*h;return Math.abs(p)>i?!1:Math.abs(h)>=Math.abs(d)?h>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:d>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y}}function jo(u,t,i,n){const a=u.sub(i),h=t.dot(t),d=t.dot(n),p=n.dot(n),m=t.dot(a),y=n.dot(a),w=h*p-d*d;let b=w,R=w;if(w===0||w<=.01){const z=m/d;return new Ee(u,i.add(n.scale(z)))}let k=d*y-p*m,M=h*y-d*m;return k<0?(k=0,M=y,R=p):k>b&&(k=b,M=y+d,R=p),M<0?(M=0,-m<0?k=0:-m>h?k=b:(k=-m,b=h)):M>R&&(M=R,-m+d<0?k=0:-m+d>h?k=b:(k=-m+d,b=h)),k=Math.abs(k)<.001?0:k/b,M=Math.abs(M)<.001?0:M/R,new Ee(u.add(t.scale(k)),i.add(n.scale(M)))}const Ti={PolygonPolygonClosestLine(u,t){const i=t.worldPos,n=i.sub(u.worldPos),a=n.negate(),h=new ji(u.worldPos,n),d=new ji(i,a),p=u.rayCast(h).point.add(h.dir.scale(.1)),m=t.rayCast(d).point.add(d.dir.scale(.1)),y=u.getClosestFace(p),w=t.getClosestFace(m),b=y.face.begin,R=y.face.getEdge(),k=w.face.begin,M=w.face.getEdge();return jo(b,R,k,M)},PolygonEdgeClosestLine(u,t){const n=t.worldPos.sub(u.worldPos),a=new ji(u.worldPos,n),h=u.rayCast(a).point.add(a.dir.scale(.1)),d=u.getClosestFace(h),p=d.face.begin,m=d.face.getEdge(),y=t.asLine(),w=y.begin,b=y.getEdge();return jo(p,m,w,b)},PolygonCircleClosestLine(u,t){const i=t.worldPos,n=i.sub(u.worldPos),a=new ji(u.worldPos,n.normalize()),h=u.rayCast(a).point.add(a.dir.scale(.1)),d=u.getClosestFace(h),p=d.face.begin,m=d.face.getEdge();let y=(m.x*(i.x-p.x)+m.y*(i.y-p.y))/(m.x*m.x+m.y*m.y);y>1?y=1:y<0&&(y=0);const w=Math.sqrt(Math.pow(p.x+m.x*y-i.x,2)+Math.pow(p.y+m.y*y-i.y,2))-t.radius,b=(p.x+m.x*y-i.x)*t.radius/(t.radius+w),R=(p.y+m.y*y-i.y)*t.radius/(t.radius+w);return new Ee(m.scale(y).add(p),new E(i.x+b,i.y+R))},CircleCircleClosestLine(u,t){const n=t.worldPos.sub(u.worldPos),h=u.worldPos.sub(t.worldPos),d=new ji(u.worldPos,n),p=new ji(t.worldPos,h),m=u.rayCast(d),y=t.rayCast(p);return new Ee(m.point,y.point)},CircleEdgeClosestLine(u,t){const i=u.worldPos,n=t.asLine(),a=n.begin,h=n.getEdge(),d=a,p=h;let m=(p.x*(i.x-d.x)+p.y*(i.y-d.y))/(p.x*p.x+p.y*p.y);m>1?m=1:m<0&&(m=0);const y=Math.sqrt(Math.pow(d.x+p.x*m-i.x,2)+Math.pow(d.y+p.y*m-i.y,2))-u.radius,w=(d.x+p.x*m-i.x)*u.radius/(u.radius+y),b=(d.y+p.y*m-i.y)*u.radius/(u.radius+y);return new Ee(p.scale(m).add(d),new E(i.x+w,i.y+b))},EdgeEdgeClosestLine(u,t){const i=u.asLine(),n=i.begin,a=i.getEdge(),h=n,d=a,p=t.asLine(),m=p.begin,y=p.getEdge();return jo(h,d,m,y)}};class de extends ss{get worldPos(){return this._globalMatrix.getPosition()}get radius(){var t;const i=this._transform,n=(t=i==null?void 0:i.globalScale)!==null&&t!==void 0?t:E.One;return this._naturalRadius*Math.min(n.x,n.y)}set radius(t){var i;const n=this._transform,a=(i=n==null?void 0:n.globalScale)!==null&&i!==void 0?i:E.One;this._naturalRadius=t/Math.min(a.x,a.y)}constructor(t){super(),this.offset=E.Zero,this._globalMatrix=bt.identity(),this.offset=t.offset||E.Zero,this.radius=t.radius||0,this._globalMatrix.translate(this.offset.x,this.offset.y)}clone(){return new de({offset:this.offset.clone(),radius:this.radius})}get center(){return this._globalMatrix.getPosition()}contains(t){var i,n;return((n=(i=this._transform)===null||i===void 0?void 0:i.pos)!==null&&n!==void 0?n:this.offset).distance(t)<=this.radius}rayCast(t,i=1/0){var n,a;const h=this.center,d=t.dir,p=t.pos,m=Math.sqrt(Math.pow(d.dot(p.sub(h)),2)-Math.pow(p.sub(h).distance(),2)+Math.pow(this.radius,2));if(m<0)return null;{let y=0;if(m===0){if(y=-d.dot(p.sub(h)),y>0&&y<i){const w=t.getPoint(y);return{point:w,normal:w.sub(h).normalize(),collider:this,body:(n=this.owner)===null||n===void 0?void 0:n.get(ct),distance:y}}return null}else{const w=-d.dot(p.sub(h))+m,b=-d.dot(p.sub(h))-m,R=[];w>=0&&R.push(w),b>=0&&R.push(b);const k=Math.min(...R);if(k<=i){const M=t.getPoint(k);return{point:M,normal:M.sub(h).normalize(),collider:this,body:(a=this.owner)===null||a===void 0?void 0:a.get(ct),distance:k}}return null}}}getClosestLineBetween(t){if(t instanceof de)return Ti.CircleCircleClosestLine(this,t);if(t instanceof ae)return Ti.PolygonCircleClosestLine(t,this).flip();if(t instanceof Me)return Ti.CircleEdgeClosestLine(this,t).flip();throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof de)return gi.CollideCircleCircle(this,t);if(t instanceof ae)return gi.CollideCirclePolygon(this,t);if(t instanceof Me)return gi.CollideCircleEdge(this,t);throw new Error(`Circle could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){return this.center.add(t.normalize().scale(this.radius))}getFurthestLocalPoint(t){return t.normalize().scale(this.radius)}get bounds(){var t,i,n;const a=this._transform,h=(t=a==null?void 0:a.globalScale)!==null&&t!==void 0?t:E.One,d=(i=a==null?void 0:a.globalRotation)!==null&&i!==void 0?i:0,p=(n=a==null?void 0:a.globalPos)!==null&&n!==void 0?n:E.Zero;return new et(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius).rotate(d).scale(h).translate(p)}get localBounds(){return new et(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius)}get axes(){return[]}getInertia(t){return t*this.radius*this.radius/2}update(t){var i;this._transform=t,((i=t.matrix)!==null&&i!==void 0?i:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const i=[],a=this.center.dot(t);return i.push(a),i.push(a+this.radius),i.push(a-this.radius),new _r(Math.min.apply(Math,i),Math.max.apply(Math,i))}debug(t,i,n){var a,h,d,p;const{lineWidth:m}={lineWidth:1,...n},y=this._transform,w=(a=y==null?void 0:y.globalScale)!==null&&a!==void 0?a:E.One,b=(h=y==null?void 0:y.globalRotation)!==null&&h!==void 0?h:0,R=(d=y==null?void 0:y.globalPos)!==null&&d!==void 0?d:E.Zero;t.save(),t.translate(R.x,R.y),t.rotate(b),t.scale(w.x,w.y),t.drawCircle((p=this.offset)!==null&&p!==void 0?p:E.Zero,this._naturalRadius,G.Transparent,i,m),t.restore()}}class Us{constructor(t,i,n,a,h,d,p,m){var y,w,b,R,k,M;if(this._canceled=!1,this.colliderA=t,this.colliderB=i,this.mtv=n,this.normal=a,this.tangent=h,this.points=d,this.localPoints=p,this.info=m,this.id=$e.calculatePairHash(t.id,i.id),t.composite||i.composite){const z=((y=t.composite)===null||y===void 0?void 0:y.compositeStrategy)==="separate"?t.id:(b=(w=t.composite)===null||w===void 0?void 0:w.id)!==null&&b!==void 0?b:t.id,X=((R=i.composite)===null||R===void 0?void 0:R.compositeStrategy)==="separate"?i.id:(M=(k=i.composite)===null||k===void 0?void 0:k.id)!==null&&M!==void 0?M:i.id;this.id+="|"+$e.calculatePairHash(z,X)}}matchAwake(){const t=this.colliderA.owner.get(ct),i=this.colliderB.owner.get(ct);t&&i&&t.sleeping!==i.sleeping&&(t.sleeping&&t.collisionType!==ft.Fixed&&i.sleepMotion>=t.wakeThreshold&&t.setSleeping(!1),i.sleeping&&i.collisionType!==ft.Fixed&&t.sleepMotion>=i.wakeThreshold&&i.setSleeping(!1))}isCanceled(){return this._canceled}cancel(){this._canceled=!0}}class mh{static findPolygonPolygonSeparation(t,i){let n=-Number.MAX_VALUE,a=null,h=null,d=-1,p=null;const m=t.getSides(),y=t.getLocalSides();for(let w=0;w<m.length;w++){const b=m[w],R=b.normal(),k=i.getFurthestPoint(R.negate()),M=b.distanceToPoint(k,!0);M>n&&(n=M,a=b,h=R,d=w,p=k)}return{collider:t,separation:h?n:99,axis:h,side:a,localSide:y[d],sideId:d,point:p,localPoint:h?i.getFurthestLocalPoint(h.negate()):null}}static findCirclePolygonSeparation(t,i){const n=i.axes,h=i.center.sub(t.worldPos),d=i.getFurthestPoint(h.negate());n.push(d.sub(t.worldPos).normalize());let p=Number.MAX_VALUE,m=null,y=-1;for(let w=0;w<n.length;w++){const b=i.project(n[w]),R=t.project(n[w]),k=b.getOverlap(R);if(k<=0)return null;k<p&&(p=k,m=n[w],y=w)}return y<0?null:m.normalize().scale(p)}}const gi={CollideCircleCircle(u,t){const i=u.worldPos,n=t.worldPos,a=u.radius+t.radius,h=i.distance(n);if(h>a)return[];const d=a-h,p=n.sub(i).normalize(),m=p.perpendicular(),y=p.scale(d),w=u.getFurthestPoint(p),b=u.getFurthestLocalPoint(p),R={collider:u,separation:d,axis:p,point:w};return[new Us(u,t,y,p,m,[w],[b],R)]},CollideCirclePolygon(u,t){var i,n;let a=mh.findCirclePolygonSeparation(u,t);if(!a)return[];a=a.dot(t.center.sub(u.center))<0?a.negate():a;const d=u.getFurthestPoint(a),m=((n=(i=u.owner)===null||i===void 0?void 0:i.get(it))!==null&&n!==void 0?n:new it).applyInverse(d),y=a.normalize(),w={collider:u,separation:-a.size,axis:y,point:d,localPoint:m,side:t.findSide(y.negate()),localSide:t.findLocalSide(y.negate())};return[new Us(u,t,a,y,y.perpendicular(),[d],[m],w)]},CollideCircleEdge(u,t){const i=u.center,n=t.asLine(),a=n.end.sub(n.begin),h=a.dot(n.end.sub(i)),d=a.dot(i.sub(n.begin)),p=t.asLine(),m=t.asLocalLine();if(d<=0){const N=n.begin.sub(i),U=N.dot(N);if(U>u.radius*u.radius)return[];const Y=N.normalize(),H=u.radius-Math.sqrt(U),tt={collider:u,separation:H,axis:Y,point:p.begin,side:p,localSide:m};return[new Us(u,t,Y.scale(H),Y,Y.perpendicular(),[p.begin],[m.begin],tt)]}if(h<=0){const N=n.end.sub(i),U=N.dot(N);if(U>u.radius*u.radius)return[];const Y=N.normalize(),H=u.radius-Math.sqrt(U),tt={collider:u,separation:H,axis:Y,point:p.end,side:p,localSide:m};return[new Us(u,t,Y.scale(H),Y,Y.perpendicular(),[p.end],[m.end],tt)]}const y=a.dot(a),w=n.begin.scale(h).add(n.end.scale(d)).scale(1/y),b=i.sub(w),R=b.dot(b);if(R>u.radius*u.radius)return[];let k=a.perpendicular();k.dot(i.sub(n.begin))<0&&(k.x=-k.x,k.y=-k.y),k=k.normalize();const M=u.radius-Math.sqrt(R),z=k.scale(M),X={collider:u,separation:M,axis:k,point:w,side:p,localSide:m};return[new Us(u,t,z,k.negate(),k.negate().perpendicular(),[w],[w.sub(t.worldPos)],X)]},CollideEdgeEdge(){return[]},CollidePolygonEdge(u,t){var i;const n=u.center,h=t.center.sub(n).normalize(),d=new ae({points:[t.begin,t.end,t.end.add(h.scale(100)),t.begin.add(h.scale(100))],offset:t.offset});d.owner=t.owner,((i=t.owner)===null||i===void 0?void 0:i.get(it))&&d.update(t.owner.get(it).get());const m=this.CollidePolygonPolygon(u,d);return m.length&&(m[0].colliderB=t,m[0].id=$e.calculatePairHash(u.id,t.id)),m},CollidePolygonPolygon(u,t){var i,n,a,h;const d=mh.findPolygonPolygonSeparation(u,t);if(d.separation>0)return[];const p=mh.findPolygonPolygonSeparation(t,u);if(p.separation>0)return[];const m=d.separation>p.separation?d:p,w=(m.collider===u?t:u).findSide(m.axis.negate()),b=m.side,R=b.dir().normalize(),k=w.clip(R.negate(),-R.dot(b.begin));let M=null;if(k&&(M=k.clip(R,R.dot(b.end))),M){const z=M.getPoints().filter(Y=>b.below(Y));let X=m.axis,N=X.perpendicular();t.center.sub(u.center).dot(X)<0&&(X=X.negate(),N=X.perpendicular());let U=[];if(m.collider===u){const Y=(n=(i=t.owner)===null||i===void 0?void 0:i.get(it))!==null&&n!==void 0?n:new it;U=z.map(H=>Y.applyInverse(H))}else{const Y=(h=(a=u.owner)===null||a===void 0?void 0:a.get(it))!==null&&h!==void 0?h:new it;U=z.map(H=>Y.applyInverse(H))}return[new Us(u,t,X.scale(-m.separation),X,N,z,U,m)]}return[]},FindContactSeparation(u,t){var i,n,a,h;const d=u.colliderA,p=(n=(i=u.colliderA.owner)===null||i===void 0?void 0:i.get(it))!==null&&n!==void 0?n:new it,m=u.colliderB,y=(h=(a=u.colliderB.owner)===null||a===void 0?void 0:a.get(it))!==null&&h!==void 0?h:new it;if(d instanceof de&&m instanceof de){const w=d.radius+m.radius,b=p.pos.distance(y.pos);return-(w-b)}if(d instanceof ae&&m instanceof ae&&u.info.localSide){let w,b;return u.info.collider===d?(w=new Ee(p.apply(u.info.localSide.begin),p.apply(u.info.localSide.end)),b=y.apply(t)):(w=new Ee(y.apply(u.info.localSide.begin),y.apply(u.info.localSide.end)),b=p.apply(t)),w.distanceToPoint(b,!0)}if(d instanceof ae&&m instanceof de||m instanceof ae&&d instanceof de){const w=p.apply(t);if(u.info.side)return u.info.side.distanceToPoint(w,!0)}if(d instanceof Me&&m instanceof ae||m instanceof Me&&d instanceof ae){let w;if(u.info.collider===d?w=y.apply(t):w=p.apply(t),u.info.side)return u.info.side.distanceToPoint(w,!0)}if(d instanceof de&&m instanceof Me||m instanceof de&&d instanceof Me){const w=y.apply(t);let b;d instanceof de&&(b=d.getFurthestPoint(u.normal));const R=w.distance(b);if(u.info.side)return R>0?-R:0}return 0}};class Me extends ss{constructor(t){var i;super(),this._globalMatrix=bt.identity(),this.begin=t.begin||E.Zero,this.end=t.end||E.Zero,this.offset=(i=t.offset)!==null&&i!==void 0?i:E.Zero}clone(){return new Me({begin:this.begin.clone(),end:this.end.clone()})}get worldPos(){var t;const i=this._transform;return(t=i==null?void 0:i.globalPos.add(this.offset))!==null&&t!==void 0?t:this.offset}get center(){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return t.average(i)}_getTransformedBegin(){return this._globalMatrix.multiply(this.begin)}_getTransformedEnd(){return this._globalMatrix.multiply(this.end)}getSlope(){const t=this._getTransformedBegin(),i=this._getTransformedEnd(),n=t.distance(i);return i.sub(t).scale(1/n)}getLength(){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return t.distance(i)}contains(){return!1}rayCast(t,i=1/0){var n;const a=this._getTransformedBegin().sub(t.pos);if(t.dir.cross(this.getSlope())===0&&a.cross(t.dir)!==0)return null;const h=t.dir.cross(this.getSlope());if(h===0)return null;const d=a.cross(this.getSlope())/h;if(d>=0&&d<=i){const p=a.cross(t.dir)/h/this.getLength();if(p>=0&&p<=1)return{distance:d,normal:this.asLine().normal(),collider:this,body:(n=this.owner)===null||n===void 0?void 0:n.get(ct),point:t.getPoint(d)}}return null}getClosestLineBetween(t){if(t instanceof de)return Ti.CircleEdgeClosestLine(t,this);if(t instanceof ae)return Ti.PolygonEdgeClosestLine(t,this).flip();if(t instanceof Me)return Ti.EdgeEdgeClosestLine(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof de)return gi.CollideCircleEdge(t,this);if(t instanceof ae)return gi.CollidePolygonEdge(t,this);if(t instanceof Me)return gi.CollideEdgeEdge();throw new Error(`Edge could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){const i=this._getTransformedBegin(),n=this._getTransformedEnd();return t.dot(i)>0?i:n}_boundsFromBeginEnd(t,i,n=10){return new et(Math.min(t.x,i.x)-n,Math.min(t.y,i.y)-n,Math.max(t.x,i.x)+n,Math.max(t.y,i.y)+n)}get bounds(){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return this._boundsFromBeginEnd(t,i)}get localBounds(){return this._boundsFromBeginEnd(this.begin,this.end)}asLine(){return new Ee(this._getTransformedBegin(),this._getTransformedEnd())}asLocalLine(){return new Ee(this.begin,this.end)}get axes(){const i=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),n=[];return n.push(i),n.push(i.negate()),n.push(i.normal()),n.push(i.normal().negate()),n}getInertia(t){const i=this.end.sub(this.begin).distance()/2;return t*i*i}update(t){var i;this._transform=t,((i=t.matrix)!==null&&i!==void 0?i:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const i=[],n=[this._getTransformedBegin(),this._getTransformedEnd()],a=n.length;for(let h=0;h<a;h++)i.push(n[h].dot(t));return new _r(Math.min.apply(Math,i),Math.max.apply(Math,i))}debug(t,i){const n=this._getTransformedBegin(),a=this._getTransformedEnd();t.drawLine(n,a,i,2),t.drawCircle(n,2,i),t.drawCircle(a,2,i)}}class ee{static registerGraphicsContext(t){ee._ctx=t}static draw(t){this._drawCalls.push(t)}static drawPoint(t,i){ee.draw(n=>{n.debug.drawPoint(t,i)})}static drawLine(t,i,n){ee.draw(a=>{a.debug.drawLine(t,i,n)})}static drawLines(t,i){t.length>1&&ee.draw(n=>{for(let a=0;a<t.length-1;a++)n.debug.drawLine(t[a],t[a+1],i)})}static drawText(t,i){ee.draw(n=>{n.debug.drawText(t,i)})}static drawPolygon(t,i){t.length>1&&ee.draw(n=>{const a=t[0],h=[...t,a];for(let d=0;d<h.length-1;d++)n.debug.drawLine(h[d],h[d+1],i)})}static drawCircle(t,i,n){const{color:a,strokeColor:h,width:d}={color:G.Black,strokeColor:void 0,width:void 0,...n};ee.draw(p=>{p.drawCircle(t,i,a,h,d)})}static drawBounds(t,i){ee.draw(n=>{n.debug.drawRect(t.left,t.top,t.width,t.height,i)})}static drawRay(t,i){const{distance:n,color:a}={color:G.Blue,distance:10,...i};ee.draw(h=>{const d=t.pos,p=t.pos.add(t.dir.scale(n));h.debug.drawLine(d,p,{color:a})})}static flush(t){t.save(),t.z=ee.z;for(const i of ee._drawCalls)i(t);t.restore(),ee.clear()}static clear(){ee._drawCalls.length=0}}ee._drawCalls=[],ee.z=1/0;class ae extends ss{flagDirty(){this._localBoundsDirty=!0,this._localSidesDirty=!0,this._transformedPointsDirty=!0,this._sidesDirty=!0}set points(t){this._points=t,this.flagDirty()}get points(){return this._points}constructor(t){var i,n;super(),this._logger=J.getInstance(),this._transformedPoints=[],this._sides=[],this._localSides=[],this._globalMatrix=bt.identity(),this._transformedPointsDirty=!0,this._sidesDirty=!0,this._localSidesDirty=!0,this._localBoundsDirty=!0,this.offset=(i=t.offset)!==null&&i!==void 0?i:E.Zero,this._globalMatrix.translate(this.offset.x,this.offset.y),this.points=(n=t.points)!==null&&n!==void 0?n:[],this._isCounterClockwiseWinding(this.points)||this.points.reverse(),this.isConvex()||t.suppressConvexWarning||this._logger.warn("Excalibur only supports convex polygon colliders and will not behave properly.Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles"),this._calculateTransformation()}_isCounterClockwiseWinding(t){let i=0;for(let n=0;n<t.length;n++)i+=(t[(n+1)%t.length].x-t[n].x)*(t[(n+1)%t.length].y+t[n].y);return i<0}isConvex(){if(this.points.length<3)return!1;let t=this.points[this.points.length-2],i=this.points[this.points.length-1],n=Math.atan2(i.y-t.y,i.x-t.x),a=0,h=0,d=0;for(const[p,m]of this.points.entries()){if(t=i,a=n,i=m,n=Math.atan2(i.y-t.y,i.x-t.x),t.equals(i))return!1;let y=n-a;if(y<=-Math.PI?y+=Math.PI*2:y>Math.PI&&(y-=Math.PI*2),p===0){if(y===0)return!1;h=y>0?1:-1}else if(h*y<=0)return!1;d+=y}return Math.abs(Math.round(d/(Math.PI*2)))===1}tessellate(){const t=[];for(let i=1;i<this.points.length-2;i++)t.push([this.points[0],this.points[i+1],this.points[i+2]]);return t.push([this.points[0],this.points[1],this.points[2]]),new ue(t.map(i=>fe.Polygon(i)))}triangulate(){if(this.points.length<3)throw Error("Invalid polygon");const t=[],i=[...this.points].reverse();let n=i.length;function a(b){return b===0?n-1:b-1}function h(b){return b===n-1?0:b+1}function d(b){const R=a(b),k=h(b),M=i[R],z=i[b],X=i[k],N=M.sub(z),U=X.sub(z);return!(N.cross(U)<0)}const p=i.map((b,R)=>d(R));function m(b,R,k,M){const z=k.sub(R),X=M.sub(k),N=R.sub(M),U=b.sub(R),Y=b.sub(k),H=b.sub(M),tt=z.cross(U),gt=X.cross(Y),$=N.cross(H);return!(tt>0||gt>0||$>0)}function y(){for(let b=0;b<n;b++)if(p[b]){const R=a(b),k=h(b),M=i[R],z=i[b],X=i[k];let N=!0;for(let U=0;U<n;U++){if(U===b||U===R||U===k)continue;const Y=i[U];if(m(Y,M,z,X)){N=!1;break}}if(N)return b}for(let b=0;b<n;b++)if(p[b])return b;return 0}function w(b){const R=a(b),k=h(b),M=i[R],z=i[b],X=i[k];t.push([M,z,X]),i.splice(b,1),p.splice(b,1),n--}for(;n>3;){const b=y();w(b);for(let R=0;R<n;R++)p[R]=d(R)}return t.push([i[0],i[1],i[2]]),new ue(t.map(b=>fe.Polygon(b,E.Zero,!0)))}clone(){return new ae({offset:this.offset.clone(),points:this.points.map(t=>t.clone())})}get worldPos(){return this._transform?this._transform.pos.add(this.offset):this.offset}get center(){return this.bounds.center}_calculateTransformation(){const t=this.points,i=t.length;this._transformedPoints.length=0;for(let n=0;n<i;n++)this._transformedPoints[n]=this._globalMatrix.multiply(t[n].clone())}getTransformedPoints(){return this._transformedPointsDirty&&(this._calculateTransformation(),this._transformedPointsDirty=!1),this._transformedPoints}getSides(){if(this._sidesDirty){const t=[],i=this.getTransformedPoints(),n=i.length;for(let a=0;a<n;a++)t.push(new Ee(i[a],i[(a+1)%n]));this._sides=t,this._sidesDirty=!1}return this._sides}getLocalSides(){if(this._localSidesDirty){const t=[],i=this.points,n=i.length;for(let a=0;a<n;a++)t.push(new Ee(i[a],i[(a+1)%n]));this._localSides=t,this._localSidesDirty=!1}return this._localSides}findSide(t){const i=this.getSides();let n=i[0],a=-Number.MAX_VALUE;for(let h=0;h<i.length;h++){const d=i[h],m=d.normal().dot(t);m>a&&(n=d,a=m)}return n}findLocalSide(t){const i=this.getLocalSides();let n=i[0],a=-Number.MAX_VALUE;for(let h=0;h<i.length;h++){const d=i[h],m=d.normal().dot(t);m>a&&(n=d,a=m)}return n}get axes(){const t=[],i=this.getSides();for(let n=0;n<i.length;n++)t.push(i[n].normal());return t}update(t){var i;t&&(this._transform=t,this._transformedPointsDirty=!0,this._sidesDirty=!0,((i=t.matrix)!==null&&i!==void 0?i:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y))}contains(t){const i=new ji(t,new E(1,0));return this.getSides().reduce(function(a,h){return i.intersect(h)>=0?a+1:a},0)%2!==0}getClosestLineBetween(t){if(t instanceof de)return Ti.PolygonCircleClosestLine(this,t);if(t instanceof ae)return Ti.PolygonPolygonClosestLine(this,t);if(t instanceof Me)return Ti.PolygonEdgeClosestLine(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof de)return gi.CollideCirclePolygon(t,this);if(t instanceof ae)return gi.CollidePolygonPolygon(this,t);if(t instanceof Me)return gi.CollidePolygonEdge(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){const i=this.getTransformedPoints();let n=null,a=-Number.MAX_VALUE;for(let h=0;h<i.length;h++){const d=t.dot(i[h]);d>a&&(a=d,n=i[h])}return n}getFurthestLocalPoint(t){const i=this.points;let n=i[0],a=-Number.MAX_VALUE;for(let h=0;h<i.length;h++){const d=t.dot(i[h]);d>a&&(a=d,n=i[h])}return n}getClosestFace(t){const i=this.getSides();let n=Number.POSITIVE_INFINITY,a=-1,h=-1;for(let d=0;d<i.length;d++){const p=i[d].distanceToPoint(t);p<n&&(n=p,a=d,h=p)}return a!==-1?{distance:i[a].normal().scale(h),face:i[a]}:null}get bounds(){return this.localBounds.transform(this._globalMatrix)}get localBounds(){return this._localBoundsDirty&&(this._localBounds=et.fromPoints(this.points),this._localBoundsDirty=!1),this._localBounds}getInertia(t){if(this._cachedMass===t&&this._cachedInertia)return this._cachedInertia;let i=0,n=0;const a=this.points;for(let h=0;h<a.length;h++){const d=(h+1)%a.length,p=a[d].cross(a[h]);i+=p*(a[h].dot(a[h])+a[h].dot(a[d])+a[d].dot(a[d])),n+=p}return this._cachedMass=t,this._cachedInertia=t/6*(i/n)}rayCast(t,i=1/0){var n;const a=this.getSides(),h=a.length;let d=Number.MAX_VALUE,p,m=-1;for(let y=0;y<h;y++){const w=t.intersect(a[y]);w>=0&&w<d&&w<=i&&(d=w,p=a[y],m=y)}return m>=0?{collider:this,distance:d,body:(n=this.owner)===null||n===void 0?void 0:n.get(ct),point:t.getPoint(d),normal:p.normal()}:null}project(t){const i=this.getTransformedPoints(),n=i.length;let a=Number.MAX_VALUE,h=-Number.MAX_VALUE;for(let d=0;d<n;d++){const p=i[d].dot(t);a=Math.min(a,p),h=Math.max(h,p)}return new _r(a,h)}debug(t,i,n){const a=this.getTransformedPoints();ee.drawPolygon(a,{color:i})}}class fe{static Box(t,i,n=E.Half,a=E.Zero){return new ae({points:new et(-t*n.x,-i*n.y,t-t*n.x,i-i*n.y).getPoints(),offset:a})}static Polygon(t,i=E.Zero,n=!1){return new ae({points:t,offset:i,suppressConvexWarning:n})}static Circle(t,i=E.Zero){return new de({radius:t,offset:i})}static Edge(t,i){return new Me({begin:t,end:i})}static Capsule(t,i,n=E.Zero){const a=J.getInstance();return t===i&&a.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider"),i>=t?new ue([fe.Circle(t/2,B(0,-i/2+t/2).add(n)),fe.Box(t,i-t,E.Half,n),fe.Circle(t/2,B(0,i/2-t/2).add(n))]):new ue([fe.Circle(i/2,B(-t/2+i/2,0).add(n)),fe.Box(t-i,i,E.Half,n),fe.Circle(i/2,B(t/2-i/2,0).add(n))])}}class jt extends pi{constructor(t){super(),this.events=new v,this.$colliderAdded=new we,this.$colliderRemoved=new we,this._collidersToRemove=[],this.set(t)}get(){return this._collider}set(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,t.events.pipe(this.events),this.$colliderAdded.notifyAll(t),this.update()),t}clear(){this._collider&&(this._collidersToRemove.push(this._collider),this._collider=null)}processColliderRemoval(){for(const t of this._collidersToRemove)t.events.unpipe(this.events),this.$colliderRemoved.notifyAll(t),t.owner=null}clone(){return new jt(this._collider.clone())}get bounds(){var t,i;return(i=(t=this._collider)===null||t===void 0?void 0:t.bounds)!==null&&i!==void 0?i:new et}get localBounds(){var t,i;return(i=(t=this._collider)===null||t===void 0?void 0:t.localBounds)!==null&&i!==void 0?i:new et}update(){var t;const i=(t=this.owner)===null||t===void 0?void 0:t.get(it);this._collider&&(this._collider.owner=this.owner,i&&this._collider.update(i.get()))}collide(t){let i=this._collider,n=t._collider;if(!i||!n)return[];let a=!1;if(n instanceof ue&&(i=n,n=this._collider,a=!0),this._collider){const h=i.collide(n);return h?(a&&h.forEach(d=>{d.mtv=d.mtv.negate(),d.normal=d.normal.negate(),d.tangent=d.normal.perpendicular(),d.colliderA=this._collider,d.colliderB=t._collider}),h):[]}return[]}onAdd(t){this._collider&&this.update(),this.events.on("precollision",i=>{const n=i;t.events.emit("precollision",new ks(n.target.owner,n.other.owner,n.side,n.intersection,n.contact)),t instanceof Le&&t.onPreCollisionResolve(n.target,n.other,n.side,n.contact)}),this.events.on("postcollision",i=>{const n=i;t.events.emit("postcollision",new Fs(n.target.owner,n.other.owner,n.side,n.intersection,n.contact)),t instanceof Le&&t.onPostCollisionResolve(n.target,n.other,n.side,n.contact)}),this.events.on("collisionstart",i=>{const n=i;t.events.emit("collisionstart",new pr(n.target.owner,n.other.owner,n.side,n.contact)),t instanceof Le&&t.onCollisionStart(n.target,n.other,n.side,n.contact)}),this.events.on("collisionend",i=>{const n=i;t.events.emit("collisionend",new gr(n.target.owner,n.other.owner,n.side,n.lastContact)),t instanceof Le&&t.onCollisionEnd(n.target,n.other,n.side,n.lastContact)})}onRemove(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}useBoxCollider(t,i,n=E.Half,a=E.Zero){const h=fe.Box(t,i,n,a);return this.set(h)}usePolygonCollider(t,i=E.Zero){const n=fe.Polygon(t,i);return this.set(n)}useCircleCollider(t,i=E.Zero){const n=fe.Circle(t,i);return this.set(n)}useEdgeCollider(t,i){const n=fe.Edge(t,i);return this.set(n)}useCompositeCollider(t){return this.set(new ue(t))}}var Ae;(function(u){u.Rotation="rotation",u.X="x",u.Y="y"})(Ae||(Ae={}));class ct extends pi{constructor(t){var i,n,a;super(),this.dependencies=[it,Ft],this.id=g("body",ct._ID++),this.events=new v,this.oldTransform=new Ls,this.__oldTransformCaptured=!1,this.enableFixedUpdateInterpolate=!0,this.collisionType=ft.PreventCollision,this.group=Os.All,this._sleeping=!1,this.bounciness=.2,this.friction=.99,this.useGravity=!0,this.limitDegreeOfFreedom=[],this.oldVel=new E(0,0),this.oldAcc=E.Zero,t?(this.collisionType=(i=t.type)!==null&&i!==void 0?i:this.collisionType,this.group=(n=t.group)!==null&&n!==void 0?n:this.group,this.useGravity=(a=t.useGravity)!==null&&a!==void 0?a:this.useGravity,this._bodyConfig={...Ai.bodies,...t.config}):this._bodyConfig={...Ai.bodies},this.updatePhysicsConfig(this._bodyConfig),this._mass=ct._DEFAULT_CONFIG.defaultMass}get matrix(){return this.transform.get().matrix}updatePhysicsConfig(t){this._bodyConfig={...Ai.bodies,...t},this.canSleep=this._bodyConfig.canSleepByDefault,this.sleepMotion=this._bodyConfig.sleepEpsilon*5,this.wakeThreshold=this._bodyConfig.wakeThreshold}static updateDefaultPhysicsConfig(t){ct._DEFAULT_CONFIG=t}get mass(){return this._mass}set mass(t){this._mass=t,this._cachedInertia=void 0,this._cachedInverseInertia=void 0}get inverseMass(){return this.collisionType===ft.Fixed?0:1/this.mass}get sleeping(){return this._sleeping}setSleeping(t){this._sleeping=t,t?(this.vel=E.Zero,this.acc=E.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=this._bodyConfig.sleepEpsilon*5}updateMotion(){this._sleeping&&this.setSleeping(!0);const t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),i=this._bodyConfig.sleepBias;this.sleepMotion=i*this.sleepMotion+(1-i)*t,this.sleepMotion=O(this.sleepMotion,0,10*this._bodyConfig.sleepEpsilon),this.canSleep&&this.sleepMotion<this._bodyConfig.sleepEpsilon&&this.setSleeping(!0)}get inertia(){if(this._cachedInertia)return this._cachedInertia;const t=this.owner.get(jt);if(t){t.$colliderAdded.subscribe(()=>{this._cachedInertia=null}),t.$colliderRemoved.subscribe(()=>{this._cachedInertia=null});const i=t.get();if(i)return this._cachedInertia=i.getInertia(this.mass)}return 0}get inverseInertia(){return this._cachedInverseInertia?this._cachedInverseInertia:this._cachedInverseInertia=this.collisionType===ft.Fixed?0:1/this.inertia}get active(){var t;return!!(!((t=this.owner)===null||t===void 0)&&t.active)}get center(){return this.globalPos}get transform(){var t;return(t=this.owner)===null||t===void 0?void 0:t.get(it)}get motion(){var t;return(t=this.owner)===null||t===void 0?void 0:t.get(Ft)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t}get globalPos(){return this.transform.globalPos}set globalPos(t){this.transform.globalPos=t}get oldPos(){return this.oldTransform.pos}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t}get torque(){return this.motion.torque}set torque(t){this.motion.torque=t}get oldRotation(){return this.oldTransform.rotation}get rotation(){return this.transform.globalRotation}set rotation(t){this.transform.globalRotation=t}get scale(){return this.transform.globalScale}set scale(t){this.transform.globalScale=t}get oldScale(){return this.oldTransform.scale}get scaleFactor(){return this.motion.scaleFactor}set scaleFactor(t){this.motion.scaleFactor=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}applyImpulse(t,i){if(this.collisionType!==ft.Active)return;const n=i.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(Ae.X)&&(n.x=0),this.limitDegreeOfFreedom.includes(Ae.Y)&&(n.y=0),this.vel.addEqual(n),!this.limitDegreeOfFreedom.includes(Ae.Rotation)){const a=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*a.cross(i)}}applyLinearImpulse(t){if(this.collisionType!==ft.Active)return;const i=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(Ae.X)&&(i.x=0),this.limitDegreeOfFreedom.includes(Ae.Y)&&(i.y=0),this.vel=this.vel.add(i)}applyAngularImpulse(t,i){if(this.collisionType===ft.Active&&!this.limitDegreeOfFreedom.includes(Ae.Rotation)){const n=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*n.cross(i)}}captureOldTransform(){this.__oldTransformCaptured=!0;const t=this.transform.get();t.clone(this.oldTransform),this.oldTransform.parent=t.parent,this.oldVel.setTo(this.vel.x,this.vel.y),this.oldAcc.setTo(this.acc.x,this.acc.y)}clone(){return super.clone()}}ct._ID=0,ct._DEFAULT_CONFIG={...Ai.bodies};class N0{constructor(t){this.data=t,this.type="Component Added"}}function U0(u){return!!u&&u.type==="Component Added"}class z0{constructor(t){this.data=t,this.type="Component Removed"}}function H0(u){return!!u&&u.type==="Component Removed"}const W0={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate",Kill:"kill"};class pe{constructor(t,i){this.id=pe._ID++,this.name=`Entity#${this.id}`,this.events=new v,this._tags=new Set,this.componentAdded$=new we,this.componentRemoved$=new we,this.tagAdded$=new we,this.tagRemoved$=new we,this.components=new Map,this._componentsToRemove=[],this._instanceOfComponentCacheDirty=!0,this._instanceOfComponentCache=new Map,this.scene=null,this.active=!0,this._parent=null,this.childrenAdded$=new we,this.childrenRemoved$=new we,this._children=[],this._isInitialized=!1;let n,a;if(Array.isArray(t))n=t,a=i;else if(t&&typeof t=="object"){const{components:h,name:d}=t;n=h??[],a=d}if(a&&(this.name=a),n)for(const h of n)this.addComponent(h)}kill(){this.active&&(this.active=!1,this.unparent()),this.emit("kill",new Bo(this))}isKilled(){return!this.active}get tags(){return this._tags}hasTag(t){return this._tags.has(t)}addTag(t){return this._tags.add(t),this.tagAdded$.notifyAll(t),this}removeTag(t){return this._tags.delete(t),this.tagRemoved$.notifyAll(t),this}get types(){return Array.from(this.components.keys())}getComponents(){return Array.from(this.components.values())}hasAll(t){for(let i=0;i<t.length;i++)if(!this.components.has(t[i]))return!1;return!0}hasAllTags(t){for(let i=0;i<t.length;i++)if(!this.tags.has(t[i]))return!1;return!0}_getCachedInstanceOfType(t){if(this._instanceOfComponentCacheDirty&&(this._instanceOfComponentCacheDirty=!1,this._instanceOfComponentCache.clear()),this._instanceOfComponentCache.has(t))return this._instanceOfComponentCache.get(t);for(const i of this.components.values())if(i instanceof t)return this._instanceOfComponentCache.set(t,i),i}get(t){const i=this._getCachedInstanceOfType(t);return i??this.components.get(t)}get parent(){return this._parent}get children(){return this._children}unparent(){this._parent&&(this._parent.removeChild(this),this._parent=null)}addChild(t){if(t.parent===null){if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t)}else throw new Error("Entity already has a parent, cannot add without unparenting");return this}removeChild(t){return t.parent===this&&(lt(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}removeAllChildren(){for(let t=this.children.length-1;t>=0;t--)this.removeChild(this.children[t]);return this}getAncestors(){const t=[this];let i=this.parent;for(;i;)t.push(i),i=i.parent;return t.reverse()}getDescendants(){let t=[this],i=[this];for(;i.length>0;){const n=i.pop();n&&(i=i.concat(n.children),t=t.concat(n.children))}return t}clone(){const t=new pe;for(const i of this.types){const n=this.get(i);n&&t.addComponent(n.clone())}for(const i of this.children)t.addChild(i.clone());return t}addTemplate(t,i=!1){for(const n of t.getComponents())this.addComponent(n.clone(),i);for(const n of t.children)this.addChild(n.clone().addTemplate(n));return this}addComponent(t,i=!1){if(this._instanceOfComponentCacheDirty=!0,this.has(t.constructor))if(i)this.removeComponent(t.constructor,!0);else return this;if(t.dependencies&&t.dependencies.length)for(const n of t.dependencies)this.addComponent(new n);return t.owner=this,this.components.set(t.constructor,t),t.onAdd&&t.onAdd(this),this.componentAdded$.notifyAll(t),this}removeComponent(t,i=!1){let n;if(zd(t)?n=t:n=t.constructor,i){const a=this.components.get(n);a&&(this.componentRemoved$.notifyAll(a),a.owner=void 0,a.onRemove&&a.onRemove(this)),this.components.delete(n),this._instanceOfComponentCacheDirty=!0}else this._componentsToRemove.push(n);return this}clearComponents(){const t=this.types;for(const i of t)this.removeComponent(i)}processComponentRemoval(){for(const t of this._componentsToRemove)this.removeComponent(t,!0);this._componentsToRemove.length=0}has(t){return this.components.has(t)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.onInitialize(t),this.events.emit("initialize",new yn(t,this)),this._isInitialized=!0)}_preupdate(t,i){this.events.emit("preupdate",new es(t,i,this)),this.onPreUpdate(t,i)}_postupdate(t,i){this.events.emit("postupdate",new is(t,i,this)),this.onPostUpdate(t,i)}onInitialize(t){}onPreUpdate(t,i){}onPostUpdate(t,i){}update(t,i){this._initialize(t),this._preupdate(t,i);for(const n of this.children)n.update(t,i);this._postupdate(t,i)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){i?this.events.off(t,i):this.events.off(t)}}pe._ID=0;var vr;(function(u){u.Forward="forward",u.Backward="backward"})(vr||(vr={}));var mi;(function(u){u.End="end",u.Loop="loop",u.PingPong="pingpong",u.Freeze="freeze"})(mi||(mi={}));const j0={Frame:"frame",Loop:"loop",End:"end"};class Pi extends zt{constructor(t){var i,n,a;super(t),this.events=new v,this.frames=[],this.strategy=mi.Loop,this.frameDuration=100,this._idempotencyToken=-1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=0,this._pingPongDirection=1,this._done=!1,this._playing=!0,this._speed=1,this._reversed=!1,this.frames=t.frames,this.speed=(i=t.speed)!==null&&i!==void 0?i:this.speed,this.strategy=(n=t.strategy)!==null&&n!==void 0?n:this.strategy,this.frameDuration=t.totalDuration?t.totalDuration/this.frames.length:(a=t.frameDuration)!==null&&a!==void 0?a:this.frameDuration,t.reverse&&this.reverse(),this.goToFrame(0)}clone(){return new Pi({frames:this.frames.map(t=>({...t})),frameDuration:this.frameDuration,speed:this.speed,reverse:this._reversed,strategy:this.strategy,...this.cloneGraphicOptions()})}get width(){const t=this.currentFrame;return t?Math.abs(t.graphic.width*this.scale.x):0}get height(){const t=this.currentFrame;return t?Math.abs(t.graphic.height*this.scale.y):0}static fromSpriteSheet(t,i,n,a=mi.Loop){const h=t.sprites.length-1,d=i.filter(p=>p<0||p>h);return d.length&&Pi._LOGGER.warn(`Indices into SpriteSheet were provided that don't exist: ${d.join(",")} no frame will be shown`),new Pi({frames:t.sprites.filter((p,m)=>i.indexOf(m)>-1).map(p=>({graphic:p,duration:n})),strategy:a})}static fromSpriteSheetCoordinates(t){const{spriteSheet:i,frameCoordinates:n,durationPerFrameMs:a,speed:h,strategy:d,reverse:p}=t,m=a??100,y=[];for(const w of n){const{x:b,y:R,duration:k,options:M}=w,z=i.getSprite(b,R,M);z?y.push({graphic:z,duration:k??m}):Pi._LOGGER.warn(`Skipping frame! SpriteSheet does not have coordinate (${b}, ${R}), please check your SpriteSheet to confirm that sprite exists`)}return new Pi({frames:y,strategy:d,speed:h,reverse:p})}get speed(){return this._speed}set speed(t){this._speed=O(Math.abs(t),0,1/0)}get currentFrame(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}get currentFrameIndex(){return this._currentFrame}get currentFrameTimeLeft(){return this._timeLeftInFrame}get isPlaying(){return this._playing}reverse(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}get direction(){return!!(this._reversed&&this._pingPongDirection===1)?vr.Backward:vr.Forward}play(){this._playing=!0}pause(){this._playing=!1,this._firstTick=!0}reset(){this._done=!1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=this.frameDuration;const t=this.frames[this._currentFrame];t&&(this._timeLeftInFrame=(t==null?void 0:t.duration)||this.frameDuration)}get canFinish(){switch(this.strategy){case mi.End:case mi.Freeze:return!0;default:return!1}}get done(){return this._done}goToFrame(t,i){this._currentFrame=t,this._timeLeftInFrame=i??this.frameDuration;const n=this.frames[this._currentFrame];n&&!this._done&&(this._timeLeftInFrame=i??((n==null?void 0:n.duration)||this.frameDuration),this.events.emit("frame",{...n,frameIndex:this.currentFrameIndex}))}_nextFrame(){const t=this._currentFrame;if(this._done)return t;let i=-1;switch(this.strategy){case mi.Loop:{i=(t+1)%this.frames.length,i===0&&this.events.emit("loop",this);break}case mi.End:{i=t+1,i>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break}case mi.Freeze:{i=O(t+1,0,this.frames.length-1),i>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break}case mi.PingPong:{t+this._pingPongDirection>=this.frames.length&&(this._pingPongDirection=-1,this.events.emit("loop",this)),t+this._pingPongDirection<0&&(this._pingPongDirection=1,this.events.emit("loop",this)),i=t+this._pingPongDirection%this.frames.length;break}}return i}tick(t,i=0){this._idempotencyToken!==i&&(this._idempotencyToken=i,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",{...this.currentFrame,frameIndex:this.currentFrameIndex})),this._timeLeftInFrame-=t*this._speed,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame())))}_drawImage(t,i,n){this.currentFrame&&this.currentFrame.graphic.draw(t,i,n)}}Pi._LOGGER=J.getInstance();class wn extends zt{constructor(t){var i;super(t),this._logger=J.getInstance(),this.useAnchor=!0,this.members=[],this.members=t.members,this.useAnchor=(i=t.useAnchor)!==null&&i!==void 0?i:this.useAnchor,this._updateDimensions()}clone(){return new wn({members:[...this.members],...this.cloneGraphicOptions()})}_updateDimensions(){const t=this.localBounds;return this.width=t.width,this.height=t.height,t}get localBounds(){let t=new et;for(const i of this.members)if(i instanceof zt)t=i.localBounds.combine(t);else{const{graphic:n,offset:a,useBounds:h}=i;n?(h===void 0?!0:h)&&(t=n.localBounds.translate(a).combine(t)):this._logger.warnOnce(`Graphics group member has an null or undefined graphic, member definition: ${JSON.stringify(i)}.`)}return t}_isAnimationOrGroup(t){return t instanceof Pi||t instanceof wn}tick(t,i){for(const n of this.members){let a;n instanceof zt?a=n:a=n.graphic,this._isAnimationOrGroup(a)&&a.tick(t,i)}}reset(){for(const t of this.members){let i;t instanceof zt?i=t:i=t.graphic,this._isAnimationOrGroup(i)&&i.reset()}}_preDraw(t,i,n){this._updateDimensions(),super._preDraw(t,this.useAnchor?i:0,this.useAnchor?n:0)}_drawImage(t,i,n){const a=E.Zero;for(const h of this.members){let d;h instanceof zt?d=h:(d=h.graphic,h.offset.clone(a)),d&&(t.save(),t.translate(i,n),d.draw(t,a.x,a.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore())}}}function _h(u){return!!u.tick}class ie extends pi{get offset(){return new Uo(this._offset,()=>{this.recalculateBounds()})}set offset(t){this._offset=t,this.recalculateBounds()}get anchor(){return new Uo(this._anchor,()=>{this.recalculateBounds()})}set anchor(t){this._anchor=t,this.recalculateBounds()}constructor(t){super(),this._logger=J.getInstance(),this._current="default",this._graphics={},this._options={},this.material=null,this.visible=!0,this.opacity=1,this._offset=E.Zero,this._anchor=E.Half,this.flipHorizontal=!1,this.flipVertical=!1,this.copyGraphics=!1,this._localBounds=null,t={visible:this.visible,graphics:{},...t};const{current:i,anchor:n,opacity:a,visible:h,graphics:d,offset:p,copyGraphics:m,onPreDraw:y,onPostDraw:w,onPreTransformDraw:b,onPostTransformDraw:R}=t;for(const[k,M]of Object.entries(d))M instanceof zt?this._graphics[k]=M:(this._graphics[k]=M.graphic,this._options[k]=M.options);this.offset=p??this.offset,this.opacity=a??this.opacity,this.anchor=n??this.anchor,this.copyGraphics=m??this.copyGraphics,this.onPreDraw=y??this.onPreDraw,this.onPostDraw=w??this.onPostDraw,this.onPreDraw=b??this.onPreTransformDraw,this.onPostTransformDraw=R??this.onPostTransformDraw,this.visible=!!h,this._current=i??this._current,i&&this._graphics[i]&&this.use(i)}getGraphic(t){return this._graphics[t]}getOptions(t){return this._options[t]}getNames(){return Object.keys(this._graphics)}get current(){return this._graphics[this._current]}get currentOptions(){return this._options[this._current]}get graphics(){return this._graphics}get options(){return this._options}add(t,i,n){let a="default",h=null,d;return typeof t=="string"&&i instanceof zt&&(a=t,h=i,d=n),t instanceof zt&&!(i instanceof zt)&&(h=t,d=i),this._graphics[a]=this.copyGraphics?h.clone():h,this._options[a]=this.copyGraphics?{...d}:d,a==="default"&&this.use("default"),h}remove(t){delete this._graphics[t],delete this._options[t],this._current===t&&(this._current="default",this.recalculateBounds())}show(t,i){return this.use(t,i)}use(t,i){var n;if(t instanceof zt){let a=t;this.copyGraphics&&(a=t.clone()),this._current="default",this._graphics[this._current]=a,this._options[this._current]=i}else this._current=t,this._options[this._current]=i,this._current in this._graphics||this._logger.warn(`Graphic ${this._current} is not registered with the graphics component owned by ${(n=this.owner)===null||n===void 0?void 0:n.name}. Nothing will be drawn.`);return this.recalculateBounds(),this.current}hide(){this._current="ex.none"}set localBounds(t){this._localBounds=t}recalculateBounds(){let t=new et;const i=this._graphics[this._current],n=this._options[this._current];if(!i){this._localBounds=t;return}let a=this.anchor,h=this.offset;n!=null&&n.anchor&&(a=n.anchor),n!=null&&n.offset&&(h=n.offset);const d=i.localBounds,p=-d.width*a.x+h.x,m=-d.height*a.y+h.y;i instanceof wn&&!i.useAnchor?t=i==null?void 0:i.localBounds.combine(t):t=i==null?void 0:i.localBounds.translate(B(p,m)).combine(t),this._localBounds=t}get localBounds(){return(!this._localBounds||this._localBounds.hasZeroDimensions())&&this.recalculateBounds(),this._localBounds}get bounds(){let t=this.localBounds;if(this.owner){const i=this.owner.get(it);i&&(t=t.transform(i.get().matrix))}return t}update(t,i=0){const n=this.current;n&&_h(n)&&n.tick(t,i)}clone(){const t=new ie;return t._graphics={...this._graphics},t._options={...this._options},t.offset=this.offset.clone(),t.opacity=this.opacity,t.anchor=this.anchor.clone(),t.copyGraphics=this.copyGraphics,t.onPreDraw=this.onPreDraw,t.onPostDraw=this.onPostDraw,t.visible=this.visible,t}}class yr extends mn{constructor(t){super(t),this.width=t.width,this.height=t.height,this.rasterize()}clone(){return new yr({width:this.width,height:this.height,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}class Vo extends mn{get radius(){return this._radius}set radius(t){this._radius=t,this.width=this._radius*2,this.height=this._radius*2,this.flagDirty()}constructor(t){var i,n,a;super(t),this._radius=0;const h=(i=t.lineWidth)!==null&&i!==void 0?i:t.strokeColor?1:0;this.padding=(n=t.padding)!==null&&n!==void 0?n:2+h/2,this.radius=t.radius,this.filtering=(a=t.filtering)!==null&&a!==void 0?a:Yt.Blended,this.rasterize()}clone(){return new Vo({radius:this.radius,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,Math.PI*2),this.color&&t.fill(),this.strokeColor&&t.stroke())}}class Ri extends pi{constructor(t){var i,n;super(),this.useColliderShape=!0,this.useGraphicsBounds=!0,this.useColliderShape=(i=t==null?void 0:t.useColliderShape)!==null&&i!==void 0?i:this.useColliderShape,this.useGraphicsBounds=(n=t==null?void 0:t.useGraphicsBounds)!==null&&n!==void 0?n:this.useGraphicsBounds,this.localBounds=t==null?void 0:t.localBounds}}class Rt{static CreateReversibleEasingFunction(t){return(i,n,a,h)=>a<n?n-(t(i,a,n,h)-a):t(i,n,a,h)}static CreateVectorEasingFunction(t){return(i,n,a,h)=>new E(t(i,n.x,a.x,h),t(i,n.y,a.y,h))}}Rt.Linear=Rt.CreateReversibleEasingFunction((u,t,i,n)=>(i=i-t,i*u/n+t)),Rt.EaseInQuad=Rt.CreateReversibleEasingFunction((u,t,i,n)=>(i=i-t,u/=n,i*u*u+t)),Rt.EaseOutQuad=Rt.CreateReversibleEasingFunction((u,t,i,n)=>(i=i-t,u/=n,-i*u*(u-2)+t)),Rt.EaseInOutQuad=Rt.CreateReversibleEasingFunction((u,t,i,n)=>(i=i-t,u/=n/2,u<1?i/2*u*u+t:(u--,-i/2*(u*(u-2)-1)+t))),Rt.EaseInCubic=Rt.CreateReversibleEasingFunction((u,t,i,n)=>(i=i-t,u/=n,i*u*u*u+t)),Rt.EaseOutCubic=Rt.CreateReversibleEasingFunction((u,t,i,n)=>(i=i-t,u/=n,u--,i*(u*u*u+1)+t)),Rt.EaseInOutCubic=Rt.CreateReversibleEasingFunction((u,t,i,n)=>(i=i-t,u/=n/2,u<1?i/2*u*u*u+t:(u-=2,i/2*(u*u*u+2)+t)));class Vd{constructor(t){this._actions=[],this._currentAction=null,this._completedActions=[],this._entity=t}add(t){this._actions.push(t)}remove(t){const i=this._actions.indexOf(t);this._actions.splice(i,1)}clearActions(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}getActions(){return this._actions.concat(this._completedActions)}hasNext(){return this._actions.length>0}isComplete(){return this._actions.length===0}reset(){this._actions=this.getActions();const t=this._actions.length;for(let i=0;i<t;i++)this._actions[i].reset();this._completedActions=[]}update(t){if(this._actions.length>0&&(this._currentAction!==this._actions[0]&&(this._currentAction=this._actions[0],this._entity.emit("actionstart",new oh(this._currentAction,this._entity))),this._currentAction.update(t),this._currentAction.isComplete(this._entity))){this._entity.emit("actioncomplete",new ah(this._currentAction,this._entity));const i=this._actions.shift();i&&this._completedActions.push(i)}}}class Gd{constructor(t,i,n){this._stopped=!1,this._repeatBuilder=i,this._repeatContext=new wr(t),this._actionQueue=this._repeatContext.getQueue(),this._repeat=n,this._originalRepeat=n,this._repeatBuilder(this._repeatContext),this._repeat--}update(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}isComplete(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._repeat=this._originalRepeat}}class Xd{constructor(t,i){this._stopped=!1,this._repeatBuilder=i,this._repeatContext=new wr(t),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}update(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}isComplete(){return this._stopped}stop(){this._stopped=!0,this._actionQueue.clearActions()}reset(){}}class Yd{constructor(t,i,n,a){if(this._started=!1,this._stopped=!1,this._entity=t,this._tx=t.get(it),this._motion=t.get(Ft),this._speed=a,this._offset=new E(i,n),a<=0)throw J.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+a),new Error("Speed must be greater than 0 pixels per second")}update(t){this._started||(this._started=!0,this._start=new E(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=B(this._end.x,this._end.y),this._motion.vel=B(0,0)):this._motion.vel=this._dir.scale(this._speed)}isComplete(t){const i=t.get(it);return this._stopped||i.pos.distance(this._start)>=this._distance}stop(){this._motion.vel=B(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class $d{constructor(t,i,n,a){this.entity=t,this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Ft),this._end=new E(i,n),this._speed=a}update(t){this._started||(this._started=!0,this._start=new E(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());const i=this._dir.scale(this._speed);this._motion.vel=B(i.x,i.y),this.isComplete(this.entity)&&(this._tx.pos=B(this._end.x,this._end.y),this._motion.vel=B(0,0))}isComplete(t){const i=t.get(it);return this._stopped||new E(i.pos.x,i.pos.y).distance(this._start)>=this._distance}stop(){this._motion.vel=B(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}var Qe;(function(u){u[u.ShortestPath=0]="ShortestPath",u[u.LongestPath=1]="LongestPath",u[u.Clockwise=2]="Clockwise",u[u.CounterClockwise=3]="CounterClockwise"})(Qe||(Qe={}));class Qd{constructor(t,i,n,a){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Ft),this._end=i,this._speed=n,this._rotationType=a||Qe.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;const i=Math.abs(this._end-this._start),n=I-i;switch(i>n?(this._shortDistance=n,this._longDistance=i):(this._shortDistance=i,this._longDistance=n),this._shortestPathIsPositive=(this._start-this._end+I)%I>=Math.PI,this._rotationType){case Qe.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case Qe.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case Qe.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case Qe.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance;break}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class qd{constructor(t,i,n,a){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Ft),this._speed=n,this._offset=i,this._rotationType=a||Qe.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;const i=Math.abs(this._end-this._start),n=I-i;switch(i>n?(this._shortDistance=n,this._longDistance=i):(this._shortDistance=i,this._longDistance=n),this._shortestPathIsPositive=(this._start-this._end+I)%I>=Math.PI,this._rotationType){case Qe.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case Qe.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case Qe.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case Qe.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance;break}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._start=void 0,this._currentNonCannonAngle=void 0,this._distance=void 0}}class Zd{constructor(t,i,n,a,h){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Ft),this._endX=i,this._endY=n,this._speedX=a,this._speedY=h}update(t){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{const i=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*i}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{const i=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*i}this.isComplete()&&(this._tx.scale=B(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startX)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Kd{constructor(t,i,n,a){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Ft),this._offset=new E(i,n),this._speedX=this._speedY=a}update(t){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Jd{constructor(t){this._method=null,this._hasBeenCalled=!1,this._method=t}update(t){this._method(),this._hasBeenCalled=!0}isComplete(){return this._hasBeenCalled}reset(){this._hasBeenCalled=!1}stop(){this._hasBeenCalled=!0}}class tf{constructor(t,i,n,a,h){this.easingFcn=h,this._currentLerpTime=0,this._lerpDuration=1*1e3,this._lerpStart=new E(0,0),this._lerpEnd=new E(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Ft),this._lerpDuration=a,this._lerpEnd=new E(i,n)}_initialize(){this._lerpStart=new E(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let i=this._tx.pos.x,n=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(this._lerpEnd.x<this._lerpStart.x?i=this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):i=this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),this._lerpEnd.y<this._lerpStart.y?n=this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):n=this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=B((i-this._tx.pos.x)/(t/1e3),(n-this._tx.pos.y)/(t/1e3))):(this._tx.pos=B(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=E.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=B(0,0),this._stopped=!0}}class ef{constructor(t,i,n,a,h){this.easingFcn=h,this._currentLerpTime=0,this._lerpDuration=1*1e3,this._lerpStart=new E(0,0),this._lerpEnd=new E(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Ft),this._lerpDuration=a,this._offset=new E(i,n)}_initialize(){this._lerpStart=new E(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._lerpEnd=this._lerpStart.add(this._offset)}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let i=this._tx.pos.x,n=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(this._lerpEnd.x<this._lerpStart.x?i=this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):i=this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),this._lerpEnd.y<this._lerpStart.y?n=this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):n=this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=B((i-this._tx.pos.x)/(t/1e3),(n-this._tx.pos.y)/(t/1e3))):(this._tx.pos=B(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=E.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=B(0,0),this._stopped=!0}}class sf{constructor(t,i,n,a=1){this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=t.get(ie),this._timeVisible=i,this._timeNotVisible=n,this._duration=(i+n)*a}update(t){this._started||(this._started=!0,this._elapsedTime=0,this._totalTime=0),this._graphics&&(this._elapsedTime+=t,this._totalTime+=t,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}isComplete(){return this._stopped||this._totalTime>=this._duration}stop(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._elapsedTime=0,this._totalTime=0}}class nf{constructor(t,i,n){this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=t.get(ie),this._endOpacity=i,this._speed=this._ogspeed=n}update(t){this._graphics&&(this._started||(this._started=!0,this._speed=this._ogspeed,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._graphics.opacity=this._endOpacity),J.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}isComplete(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}stop(){this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class rf{constructor(t){this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=t}update(t){this._started||(this._started=!0),this._elapsedTime+=t}isComplete(){return this._stopped||this._elapsedTime>=this._delay}stop(){this._stopped=!0}reset(){this._elapsedTime=0,this._started=!1,this._stopped=!1}}class of{constructor(t){this._stopped=!1,this._entity=t}update(t){this._entity.get(xn).clearActions(),this._entity.kill(),this._stopped=!0}isComplete(){return this._stopped}stop(){}reset(){}}class vh{constructor(t,i,n){this._started=!1,this._stopped=!1,this._tx=t.get(it),this._motion=t.get(Ft),this._followTx=i.get(it),this._followMotion=i.get(Ft),this._current=new E(this._tx.pos.x,this._tx.pos.y),this._end=new E(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=n!==void 0?n:this._current.distance(this._end),this._speed=0}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const i=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(i!==0&&(this._speed=i),this._current=B(this._tx.pos.x,this._tx.pos.y),this._end=B(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){const n=this._dir.scale(this._speed);this._motion.vel=B(n.x,n.y)}else this._motion.vel=B(0,0);this.isComplete()&&(this._tx.pos=B(this._end.x,this._end.y),this._motion.vel=B(0,0))}stop(){this._motion.vel=B(0,0),this._stopped=!0}isComplete(){return this._stopped}reset(){this._started=!1,this._stopped=!1}}class yh{constructor(t,i,n){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=t.get(it),this._motion=t.get(Ft),this._meetTx=i.get(it),this._meetMotion=i.get(Ft),this._current=new E(this._tx.pos.x,this._tx.pos.y),this._end=new E(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=n||0,n!==void 0&&(this._speedWasSpecified=!0)}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const i=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));i!==0&&!this._speedWasSpecified&&(this._speed=i),this._current=B(this._tx.pos.x,this._tx.pos.y),this._end=B(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();const n=this._dir.scale(this._speed);this._motion.vel=B(n.x,n.y),this.isComplete()&&(this._tx.pos=B(this._end.x,this._end.y),this._motion.vel=B(0,0))}isComplete(){return this._stopped||this._distanceBetween<=1}stop(){this._motion.vel=B(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._distanceBetween=void 0}}class wr{constructor(t){this._entity=t,this._queue=new Vd(t)}getQueue(){return this._queue}update(t){this._queue.update(t)}clearActions(){this._queue.clearActions()}runAction(t){return t.reset(),this._queue.add(t),this}easeTo(...t){var i,n;let a=0,h=0,d=0,p=Rt.Linear;return t[0]instanceof E?(a=t[0].x,h=t[0].y,d=t[1],p=(i=t[2])!==null&&i!==void 0?i:p):(a=t[0],h=t[1],d=t[2],p=(n=t[3])!==null&&n!==void 0?n:p),this._queue.add(new tf(this._entity,a,h,d,p)),this}easeBy(...t){var i,n;let a=0,h=0,d=0,p=Rt.Linear;return t[0]instanceof E?(a=t[0].x,h=t[0].y,d=t[1],p=(i=t[2])!==null&&i!==void 0?i:p):(a=t[0],h=t[1],d=t[2],p=(n=t[3])!==null&&n!==void 0?n:p),this._queue.add(new ef(this._entity,a,h,d,p)),this}moveTo(t,i,n){let a=0,h=0,d=0;return t instanceof E?(a=t.x,h=t.y,d=i):(a=t,h=i,d=n),this._queue.add(new $d(this._entity,a,h,d)),this}moveBy(t,i,n){let a=0,h=0,d=0;return t instanceof E?(a=t.x,h=t.y,d=i):(a=t,h=i,d=n),this._queue.add(new Yd(this._entity,a,h,d)),this}rotateTo(t,i,n){return this._queue.add(new Qd(this._entity,t,i,n)),this}rotateBy(t,i,n){return this._queue.add(new qd(this._entity,t,i,n)),this}scaleTo(t,i,n,a){let h=1,d=1,p=0,m=0;return t instanceof E&&i instanceof E&&(h=t.x,d=t.y,p=i.x,m=i.y),typeof t=="number"&&typeof i=="number"&&(h=t,d=i,p=n,m=a),this._queue.add(new Zd(this._entity,h,d,p,m)),this}scaleBy(t,i,n){let a=1,h=1;return t instanceof E&&(a=t.x,h=t.y,n=i),typeof t=="number"&&typeof i=="number"&&(a=t,h=i),this._queue.add(new Kd(this._entity,a,h,n)),this}blink(t,i,n=1){return this._queue.add(new sf(this._entity,t,i,n)),this}fade(t,i){return this._queue.add(new nf(this._entity,t,i)),this}delay(t){return this._queue.add(new rf(t)),this}die(){return this._queue.add(new of(this._entity)),this}callMethod(t){return this._queue.add(new Jd(t)),this}repeat(t,i){return i?(this._queue.add(new Gd(this._entity,t,i)),this):(this.repeatForever(t),this)}repeatForever(t){return this._queue.add(new Xd(this._entity,t)),this}follow(t,i){return i===void 0?this._queue.add(new vh(this._entity,t)):this._queue.add(new vh(this._entity,t,i)),this}meet(t,i){return i===void 0?this._queue.add(new yh(this._entity,t)):this._queue.add(new yh(this._entity,t,i)),this}toPromise(){return new Promise(i=>{this._queue.add(new Jd(()=>{i()}))})}}class xn extends pi{constructor(){super(...arguments),this.dependencies=[it,Ft],this._ctx=null}onAdd(t){this._ctx=new wr(t)}onRemove(){this._ctx=null}_getCtx(){if(!this._ctx)throw new Error("Actions component not attached to an entity, no context available");return this._ctx}getQueue(){if(!this._ctx)throw new Error("Actions component not attached to an entity, no queue available");return this._ctx.getQueue()}runAction(t){if(!this._ctx)throw new Error("Actions component not attached to an entity, cannot run action");return this._ctx.runAction(t)}update(t){var i;return(i=this._ctx)===null||i===void 0?void 0:i.update(t)}clearActions(){var t;(t=this._ctx)===null||t===void 0||t.clearActions()}easeTo(...t){return this._getCtx().easeTo.apply(this._ctx,t)}easeBy(...t){return this._getCtx().easeBy.apply(this._ctx,t)}moveTo(t,i,n){return this._getCtx().moveTo.apply(this._ctx,[t,i,n])}moveBy(t,i,n){return this._getCtx().moveBy.apply(this._ctx,[t,i,n])}rotateTo(t,i,n){return this._getCtx().rotateTo(t,i,n)}rotateBy(t,i,n){return this._getCtx().rotateBy(t,i,n)}scaleTo(t,i,n,a){return this._getCtx().scaleTo.apply(this._ctx,[t,i,n,a])}scaleBy(t,i,n){return this._getCtx().scaleBy.apply(this._ctx,[t,i,n])}blink(t,i,n){return this._getCtx().blink(t,i,n)}fade(t,i){return this._getCtx().fade(t,i)}delay(t){return this._getCtx().delay(t)}die(){return this._getCtx().die()}callMethod(t){return this._getCtx().callMethod(t)}repeat(t,i){return this._getCtx().repeat(t,i)}repeatForever(t){return this._getCtx().repeatForever(t)}follow(t,i){return this._getCtx().follow(t,i)}meet(t,i){return this._getCtx().meet(t,i)}toPromise(){return this._getCtx().toPromise()}}var Go;(function(u){u.Em="em",u.Rem="rem",u.Px="px",u.Pt="pt",u.Percent="%"})(Go||(Go={}));var Xo;(function(u){u.Left="left",u.Right="right",u.Center="center",u.Start="start",u.End="end"})(Xo||(Xo={}));var Yo;(function(u){u.Top="top",u.Hanging="hanging",u.Middle="middle",u.Alphabetic="alphabetic",u.Ideographic="ideographic",u.Bottom="bottom"})(Yo||(Yo={}));var $o;(function(u){u.Normal="normal",u.Italic="italic",u.Oblique="oblique"})($o||($o={}));var Qo;(function(u){u.LeftToRight="ltr",u.RightToLeft="rtl"})(Qo||(Qo={}));class bn{constructor(t,i,n,a){this.font=t,this.text=i,this.color=n,this.maxWidth=a,this._textFragments=[],this.disposed=!1,this._dirty=!0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.dimensions=this.measureText(i),this._setDimension(this.dimensions,this.ctx),this._lastHashCode=this.getHashCode()}measureText(t,i){if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);let n=null;i!=null?n=this._getLinesFromText(t,i):n=t.split(`
`);const a=n.reduce((R,k)=>R.length>k.length?R:k);this._applyFont(this.ctx);const h=this.ctx.measureText(a);let d=Math.abs(h.actualBoundingBoxAscent)+Math.abs(h.actualBoundingBoxDescent);const p=d*n.length;d=p;const m=p-Math.abs(h.actualBoundingBoxAscent),y=0,w=0;return new et({left:y-Math.abs(h.actualBoundingBoxLeft)-this.font.padding,top:w-Math.abs(h.actualBoundingBoxAscent)-this.font.padding,bottom:w+m+this.font.padding,right:y+Math.abs(h.actualBoundingBoxRight)+this.font.padding})}_setDimension(t,i){let n=1;this.font.lineHeight&&(n=this.font.lineHeight/this.font.size),i.canvas.width=(t.width+this.font.padding*2)*2*this.font.quality,i.canvas.height=(t.height+this.font.padding*2)*2*this.font.quality*n}static getHashCode(t,i,n){var a;return i+"__hashcode__"+t.fontString+t.showDebug+t.textAlign+t.baseAlign+t.direction+t.lineHeight+JSON.stringify(t.shadow)+(t.padding.toString()+t.smoothing.toString()+t.lineWidth.toString()+t.lineDash.toString()+((a=t.strokeColor)===null||a===void 0?void 0:a.toString())+(n?n.toString():t.color.toString()))}getHashCode(t=!0){return bn.getHashCode(this.font,this.text,t?this.color:void 0)}_applyRasterProperties(t){var i,n;t.translate(this.font.padding,this.font.padding),t.imageSmoothingEnabled=this.font.smoothing,t.lineWidth=this.font.lineWidth,t.setLineDash((i=this.font.lineDash)!==null&&i!==void 0?i:t.getLineDash()),t.strokeStyle=(n=this.font.strokeColor)===null||n===void 0?void 0:n.toString(),t.fillStyle=this.color.toString()}_applyFont(t){t.resetTransform(),t.translate(this.font.padding+t.canvas.width/2,this.font.padding+t.canvas.height/2),t.scale(this.font.quality,this.font.quality),t.textAlign=this.font.textAlign,t.textBaseline=this.font.baseAlign,t.font=this.font.fontString,t.direction=this.font.direction,this.font.shadow&&(t.shadowColor=this.font.shadow.color.toString(),t.shadowBlur=this.font.shadow.blur,t.shadowOffsetX=this.font.shadow.offset.x,t.shadowOffsetY=this.font.shadow.offset.y)}_drawText(t,i,n){this._applyRasterProperties(t),this._applyFont(t);for(let a=0;a<i.length;a++){const h=i[a];this.color&&t.fillText(h,0,a*n),this.font.strokeColor&&t.strokeText(h,0,a*n)}this.font.showDebug&&(ch(t,G.Green,-t.canvas.width/2,0,t.canvas.width/2,0,2),ch(t,G.Red,0,-t.canvas.height/2,0,t.canvas.height/2,2))}_splitTextBitmap(t){const i=[];let n=0,a=0;const h=Math.min(4096,t.canvas.width),d=Math.min(4096,t.canvas.height);for(;n<t.canvas.width;){for(;a<t.canvas.height;){const p=document.createElement("canvas");p.width=h,p.height=d,p.getContext("2d").drawImage(t.canvas,n,a,h,d,0,0,h,d),i.push({x:n,y:a,canvas:p}),a+=d}n+=h,a=0}return i}flagDirty(){this._dirty=!0}render(t,i,n,a){var h;if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);this._ex=t;const d=this.getHashCode();if(this._lastHashCode!==d&&(this._dirty=!0),this._dirty){this.dimensions=this.measureText(this.text,a),this._setDimension(this.dimensions,this.ctx);const p=this._getLinesFromText(this.text,a),m=(h=this.font.lineHeight)!==null&&h!==void 0?h:this.dimensions.height/p.length;if(this._drawText(this.ctx,p,m),t instanceof Wi)for(const y of this._textFragments)t.textureLoader.delete(y.canvas);if(this._textFragments=this._splitTextBitmap(this.ctx),t instanceof Wi)for(const y of this._textFragments)t.textureLoader.load(y.canvas,{filtering:this.font.filtering},!0);this._lastHashCode=d,this._dirty=!1}for(const p of this._textFragments)t.drawImage(p.canvas,0,0,p.canvas.width,p.canvas.height,p.x/this.font.quality+i-this.ctx.canvas.width/this.font.quality/2,p.y/this.font.quality+n-this.ctx.canvas.height/this.font.quality/2,p.canvas.width/this.font.quality,p.canvas.height/this.font.quality)}dispose(){if(this.disposed=!0,this.dimensions=void 0,this.canvas=void 0,this.ctx=void 0,this._ex instanceof Wi)for(const t of this._textFragments)this._ex.textureLoader.delete(t.canvas);this._textFragments.length=0}_getLinesFromText(t,i){if(this._cachedText===t&&this._cachedRenderWidth===i)return this._cachedLines;const n=t.split(`
`);if(i==null)return n;for(let a=0;a<n.length;a++){let h=n[a],d="";if(this.measureText(h).width>i){for(;this.measureText(h).width>i;)d=h[h.length-1]+d,h=h.slice(0,-1);n[a]=h,n[a+1]=d}}return this._cachedText=t,this._cachedLines=n,this._cachedRenderWidth=i,n}}class Ct{static measureText(t,i,n){const a=bn.getHashCode(i,t);if(Ct._MEASURE_CACHE.has(a))return Ct._MEASURE_CACHE.get(a);Ct._LOGGER.debug("Font text measurement cache miss");const h=i.measureTextWithoutCache(t,n);return Ct._MEASURE_CACHE.set(a,h),h}static getTextInstance(t,i,n){const a=bn.getHashCode(i,t,n);let h=Ct._TEXT_CACHE.get(a);return h||(h=new bn(i,t,n),Ct._TEXT_CACHE.set(a,h),Ct._LOGGER.debug("Font text instance cache miss")),Ct._TEXT_USAGE.set(h,performance.now()),h}static checkAndClearCache(){const t=[],i=new Set;for(const[a,h]of Ct._TEXT_USAGE.entries())if(h+Ct.FONT_TIMEOUT<performance.now())Ct._LOGGER.debug(`Text cache entry timed out ${a.text}`),t.push(a),a.dispose();else{const d=a.getHashCode(!1);i.add(d)}t.forEach(a=>{Ct._TEXT_USAGE.delete(a)}),this._TEXT_CACHE.clear();for(const[a]of this._TEXT_USAGE.entries())this._TEXT_CACHE.set(a.getHashCode(),a);const n=new Map;for(const a of i)Ct._MEASURE_CACHE.has(a)&&n.set(a,Ct._MEASURE_CACHE.get(a));this._MEASURE_CACHE.clear(),this._MEASURE_CACHE=n}static get cacheSize(){return Ct._TEXT_USAGE.size}static clearCache(){for(const[t]of Ct._TEXT_USAGE.entries())t.dispose();Ct._TEXT_USAGE.clear(),Ct._TEXT_CACHE.clear(),Ct._MEASURE_CACHE.clear()}}Ct.FONT_TIMEOUT=500,Ct._LOGGER=J.getInstance(),Ct._TEXT_USAGE=new Map,Ct._TEXT_CACHE=new Map,Ct._MEASURE_CACHE=new Map;class zs extends zt{constructor(t={}){var i,n,a,h,d,p,m,y,w,b,R,k,M,z,X,N,U,Y,H,tt;super(t),this.filtering=Yt.Blended,this.quality=2,this.padding=2,this.smoothing=!1,this.lineWidth=1,this.lineDash=[],this.color=G.Black,this.family="sans-serif",this.style=$o.Normal,this.bold=!1,this.unit=Go.Px,this.textAlign=Xo.Left,this.baseAlign=Yo.Top,this.direction=Qo.LeftToRight,this.lineHeight=void 0,this.size=10,this.shadow=null,this._textBounds=new et,this._textMeasurement=new bn(this,"",G.Black),this.smoothing=(i=t==null?void 0:t.smoothing)!==null&&i!==void 0?i:this.smoothing,this.padding=(n=t==null?void 0:t.padding)!==null&&n!==void 0?n:this.padding,this.color=(a=t==null?void 0:t.color)!==null&&a!==void 0?a:this.color,this.strokeColor=(h=t==null?void 0:t.strokeColor)!==null&&h!==void 0?h:this.strokeColor,this.lineDash=(d=t==null?void 0:t.lineDash)!==null&&d!==void 0?d:this.lineDash,this.lineWidth=(p=t==null?void 0:t.lineWidth)!==null&&p!==void 0?p:this.lineWidth,this.filtering=(m=t==null?void 0:t.filtering)!==null&&m!==void 0?m:this.filtering,this.family=(y=t==null?void 0:t.family)!==null&&y!==void 0?y:this.family,this.style=(w=t==null?void 0:t.style)!==null&&w!==void 0?w:this.style,this.bold=(b=t==null?void 0:t.bold)!==null&&b!==void 0?b:this.bold,this.size=(R=t==null?void 0:t.size)!==null&&R!==void 0?R:this.size,this.unit=(k=t==null?void 0:t.unit)!==null&&k!==void 0?k:this.unit,this.textAlign=(M=t==null?void 0:t.textAlign)!==null&&M!==void 0?M:this.textAlign,this.baseAlign=(z=t==null?void 0:t.baseAlign)!==null&&z!==void 0?z:this.baseAlign,this.direction=(X=t==null?void 0:t.direction)!==null&&X!==void 0?X:this.direction,this.lineHeight=(N=t==null?void 0:t.lineHeight)!==null&&N!==void 0?N:this.lineHeight,this.quality=(U=t==null?void 0:t.quality)!==null&&U!==void 0?U:this.quality,t!=null&&t.shadow&&(this.shadow={},this.shadow.blur=(Y=t.shadow.blur)!==null&&Y!==void 0?Y:this.shadow.blur,this.shadow.offset=(H=t.shadow.offset)!==null&&H!==void 0?H:this.shadow.offset,this.shadow.color=(tt=t.shadow.color)!==null&&tt!==void 0?tt:this.shadow.color)}clone(){return new zs({...this.cloneGraphicOptions(),size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null})}get fontString(){return`${this.style} ${this.bold?"bold":""} ${this.size}${this.unit} ${this.family}`}get localBounds(){return this._textBounds}_drawImage(t,i,n){}_rotate(t){var i;const n=(i=this.origin)!==null&&i!==void 0?i:this._textBounds.center;t.translate(n.x,n.y),t.rotate(this.rotation),t.translate(-n.x,-n.y)}_flip(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}measureTextWithoutCache(t,i){return this._textMeasurement.measureText(t,i)}measureText(t,i){return Ct.measureText(t,this,i)}_postDraw(t){t.restore()}render(t,i,n,a,h,d){const p=Ct.getTextInstance(i,this,n);this._textBounds=p.dimensions,this._preDraw(t,a,h),p.render(t,a,h,d),this._postDraw(t)}}class xr extends zt{constructor(t){var i,n;super(t),this._text="",this._textWidth=0,this._textHeight=0,this.font=(i=t.font)!==null&&i!==void 0?i:new zs,this.color=(n=t.color)!==null&&n!==void 0?n:this.color,this.text=t.text,this.maxWidth=t.maxWidth}clone(){var t,i;return new xr({text:this.text.slice(),color:(i=(t=this.color)===null||t===void 0?void 0:t.clone())!==null&&i!==void 0?i:G.Black,font:this.font.clone(),maxWidth:this.maxWidth})}get text(){return this._text}set text(t){this._text=t,this._calculateDimension()}get font(){return this._font}set font(t){this._font=t}get width(){return this._textWidth===0&&this._calculateDimension(),this._textWidth*this.scale.x}get height(){return this._textHeight===0&&this._calculateDimension(),this._textHeight*this.scale.y}_calculateDimension(){const{width:t,height:i}=this.font.measureText(this._text,this.maxWidth);this._textWidth=t,this._textHeight=i}get localBounds(){return this.font.measureText(this._text,this.maxWidth).scale(this.scale)}_rotate(t){}_flip(t){}_preDraw(t,i,n){(this.isStale()||this.font.isStale())&&(this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity),this.font.tint=this.tint,super._preDraw(t,i,n)}_drawImage(t,i,n){var a;let h=G.Black;this.font instanceof zs&&(h=(a=this.color)!==null&&a!==void 0?a:this.font.color);const{width:d,height:p}=this.font.measureText(this._text,this.maxWidth);this._textWidth=d,this._textHeight=p,this.font.render(t,this._text,h,i,n,this.maxWidth),this.font.showDebug&&(t.debug.drawRect(i-d,n-p,d*2,p*2),this.maxWidth!=null&&t.debug.drawRect(i,n,this.maxWidth,this.height,{color:G.Yellow}))}}class Le extends pe{get pos(){return this.transform.pos}set pos(t){this.transform.pos=t.clone()}get oldPos(){return this.body.oldPos}set oldPos(t){this.body.oldPos.setTo(t.x,t.y)}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t.clone()}get oldVel(){return this.body.oldVel}set oldVel(t){this.body.oldVel.setTo(t.x,t.y)}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t.clone()}set oldAcc(t){this.body.oldAcc.setTo(t.x,t.y)}get oldAcc(){return this.body.oldAcc}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}get scale(){return this.get(it).scale}set scale(t){this.get(it).scale=t}get anchor(){return this._anchor}set anchor(t){this._anchor=Ui(t,i=>this._handleAnchorChange(i)),this._handleAnchorChange(t)}_handleAnchorChange(t){this.graphics&&(this.graphics.anchor=t)}get offset(){return this._offset}set offset(t){this._offset=Ui(t,i=>this._handleOffsetChange(i)),this._handleOffsetChange(t)}_handleOffsetChange(t){this.graphics&&(this.graphics.offset=t)}get isOffScreen(){return this.hasTag("ex.offscreen")}get draggable(){return this._draggable}set draggable(t){t&&(t&&!this._draggable?(this.events.on("pointerdragstart",this._pointerDragStartHandler),this.events.on("pointerdragend",this._pointerDragEndHandler),this.events.on("pointerdragmove",this._pointerDragMoveHandler),this.events.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.events.off("pointerdragstart",this._pointerDragStartHandler),this.events.off("pointerdragend",this._pointerDragEndHandler),this.events.off("pointerdragmove",this._pointerDragMoveHandler),this.events.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}get color(){return this._color}set color(t){this._color=t.clone();const i=this.graphics.current;(i instanceof mn||i instanceof xr)&&(i.color=this._color)}constructor(t){super(),this.events=new v,this._anchor=Ui(E.Half,mt=>this._handleAnchorChange(mt)),this._offset=Ui(E.Zero,mt=>this._handleOffsetChange(mt)),this.logger=J.getInstance(),this._draggable=!1,this._dragging=!1,this._pointerDragStartHandler=()=>{this._dragging=!0},this._pointerDragEndHandler=()=>{this._dragging=!1},this._pointerDragMoveHandler=mt=>{this._dragging&&(this.pos=mt.worldPos)},this._pointerDragLeaveHandler=mt=>{this._dragging&&(this.pos=mt.worldPos)};const{name:i,x:n,y:a,pos:h,coordPlane:d,scale:p,width:m,height:y,radius:w,collider:b,vel:R,acc:k,rotation:M,angularVelocity:z,z:X,color:N,visible:U,opacity:Y,anchor:H,offset:tt,collisionType:gt,collisionGroup:$}={...t};this.name=i??this.name,this.anchor=H??Le.defaults.anchor.clone(),this.offset=tt??E.Zero,this.transform=new it,this.addComponent(this.transform),this.pos=h??B(n??0,a??0),this.rotation=M??0,this.scale=p??B(1,1),this.z=X??0,this.transform.coordPlane=d??te.World,this.pointer=new Ri,this.addComponent(this.pointer),this.graphics=new ie({anchor:this.anchor,offset:this.offset,opacity:Y}),this.addComponent(this.graphics),this.motion=new Ft,this.addComponent(this.motion),this.vel=R??E.Zero,this.acc=k??E.Zero,this.angularVelocity=z??0,this.actions=new xn,this.addComponent(this.actions),this.body=new ct,this.addComponent(this.body),this.body.collisionType=gt??ft.Passive,$&&(this.body.group=$),b?(this.collider=new jt(b),this.addComponent(this.collider)):w?(this.collider=new jt(fe.Circle(w)),this.addComponent(this.collider)):m>0&&y>0?(this.collider=new jt(fe.Box(m,y,this.anchor)),this.addComponent(this.collider)):(this.collider=new jt,this.addComponent(this.collider)),this.graphics.visible=U??!0,N&&(this.color=N,m&&y?this.graphics.add(new yr({color:N,width:m,height:y})):w&&this.graphics.add(new Vo({color:N,radius:w})))}clone(){const t=new Le({color:this.color.clone(),anchor:this.anchor.clone(),offset:this.offset.clone()});t.clearComponents(),t.processComponentRemoval(),t.addComponent(t.transform=this.transform.clone(),!0),t.addComponent(t.pointer=this.pointer.clone(),!0),t.addComponent(t.graphics=this.graphics.clone(),!0),t.addComponent(t.motion=this.motion.clone(),!0),t.addComponent(t.actions=this.actions.clone(),!0),t.addComponent(t.body=this.body.clone(),!0),t.addComponent(t.collider=this.collider.clone(),!0);const i=[this.transform,this.pointer,this.graphics,this.motion,this.actions,this.body,this.collider],n=this.getComponents();for(const a of n)i.includes(a)||t.addComponent(a.clone(),!0);return t}onInitialize(t){}_initialize(t){super._initialize(t);for(const i of this.children)i._initialize(t)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}_prekill(t){this.events.emit("prekill",new Nl(this)),this.onPreKill(t)}onPreKill(t){}_postkill(t){this.events.emit("postkill",new Ul(this)),this.onPostKill(t)}onPostKill(t){}kill(){this.scene?(this._prekill(this.scene),this.events.emit("kill",new Bo(this)),super.kill(),this._postkill(this.scene)):this.logger.warn(`Cannot kill actor named "${this.name}", it was never added to the Scene`)}unkill(){this.active=!0}isKilled(){return!this.active}get z(){return this.get(it).z}set z(t){this.get(it).z=t}get center(){const t=this.getGlobalPos();return new E(t.x+this.width/2-this.anchor.x*this.width,t.y+this.height/2-this.anchor.y*this.height)}get localCenter(){return new E(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}get width(){return this.collider.localBounds.width*this.getGlobalScale().x}get height(){return this.collider.localBounds.height*this.getGlobalScale().y}getGlobalRotation(){return this.get(it).globalRotation}getGlobalPos(){return this.get(it).globalPos}getGlobalScale(){return this.get(it).globalScale}contains(t,i,n=!1){const a=B(t,i),h=this.get(jt);h.update();const d=h.get();if(!d)return!1;const p=d.contains(a);return n?p||this.children.some(m=>m.contains(t,i,!0)):p}within(t,i){const n=this.get(jt),a=t.get(jt),h=n.get(),d=a.get();return h&&d?h.getClosestLineBetween(d).getLength()<=i:!1}update(t,i){this._initialize(t),this._preupdate(t,i),this._postupdate(t,i)}onPreUpdate(t,i){}onPostUpdate(t,i){}onPreCollisionResolve(t,i,n,a){}onPostCollisionResolve(t,i,n,a){}onCollisionStart(t,i,n,a){}onCollisionEnd(t,i,n,a){}_preupdate(t,i){this.events.emit("preupdate",new es(t,i,this)),this.onPreUpdate(t,i)}_postupdate(t,i){this.events.emit("postupdate",new is(t,i,this)),this.onPostUpdate(t,i)}}Le.defaults={anchor:E.Half};function af(u){return u instanceof wh}class wh extends Le{constructor(t){var i,n;super({...t}),this.get(it).coordPlane=te.Screen,this.anchor=(i=t==null?void 0:t.anchor)!==null&&i!==void 0?i:B(0,0),this.body.collisionType=(n=t==null?void 0:t.collisionType)!==null&&n!==void 0?n:ft.PreventCollision,this.pointer.useGraphicsBounds=!0,this.pointer.useColliderShape=!1,!(t!=null&&t.collider)&&(t==null?void 0:t.width)>0&&(t==null?void 0:t.height)>0&&this.collider.useBoxCollider(this.width,this.height,this.anchor)}_initialize(t){this._engine=t,super._initialize(t)}contains(t,i,n=!0){if(n)return super.contains(t,i);const a=this._engine.worldToScreenCoordinates(new E(t,i));return super.contains(a.x,a.y)}}class Hs{get complete(){return this._complete}constructor(t,i,n,a,h,d){if(this._logger=J.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this.randomRange=[0,0],this._baseInterval=10,this._generateRandomInterval=()=>this._baseInterval+this.random.integer(this.randomRange[0],this.randomRange[1]),this._complete=!1,this.scene=null,typeof t!="function"){const p=t;t=p.fcn,i=p.interval,n=p.repeats,a=p.numberOfRepeats,h=p.randomRange,d=p.random}if(a&&a>=0&&(this.maxNumberOfRepeats=a,!n))throw new Error("repeats must be set to true if numberOfRepeats is set");if(this.id=Hs._MAX_ID++,this._callbacks=[],this._baseInterval=this.interval=i,h){if(h[0]>h[1])throw new Error("min value must be lower than max value for range");this.random=d??new A,this.randomRange=h,this.interval=this._generateRandomInterval(),this.on(()=>{this.interval=this._generateRandomInterval()})}this.repeats=n||this.repeats,t&&this.on(t)}on(t){this._callbacks.push(t)}off(t){const i=this._callbacks.indexOf(t);this._callbacks.splice(i,1)}update(t){this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach(i=>{i.call(this)}),this._numberOfTicks++,this.repeats?this._elapsedTime=0:(this._complete=!0,this._running=!1,this._elapsedTime=0)))}reset(t,i){if(t&&t>=0&&(this._baseInterval=this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=i,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}get timesRepeated(){return this._numberOfTicks}getTimeRunning(){return this._totalTimeAlive}get timeToNextAction(){return this.complete?0:this.interval-this._elapsedTime}get timeElapsedTowardNextAction(){return this._elapsedTime}get isRunning(){return this._running}pause(){return this._running=!1,this}resume(){return this._running=!0,this}start(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}stop(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}cancel(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}Hs._MAX_ID=0;class qo extends pi{constructor(t){super(),this.parallaxFactor=B(1,1),this.parallaxFactor=t??this.parallaxFactor}}class Zo extends pi{constructor(t,i=!0){super(),this.draw=t,this.useTransform=i}}const V0={PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw",PointerUp:"pointerup",PointerDown:"pointerdown",PointerMove:"pointermove",PointerCancel:"pointercancel"};class lf extends pe{flagCollidersDirty(){this._collidersDirty=!0}flagTilesDirty(){for(let t=0;t<this.tiles.length;t++)this.tiles[t]&&this.tiles[t].flagDirty()}get x(){var t;return(t=this.transform.pos.x)!==null&&t!==void 0?t:0}set x(t){var i;!((i=this.transform)===null||i===void 0)&&i.pos&&(this.get(it).pos=B(t,this.y))}get y(){var t,i;return(i=(t=this.transform)===null||t===void 0?void 0:t.pos.y)!==null&&i!==void 0?i:0}set y(t){var i;!((i=this.transform)===null||i===void 0)&&i.pos&&(this.transform.pos=B(this.x,t))}get z(){var t;return(t=this.transform.z)!==null&&t!==void 0?t:0}set z(t){this.transform&&(this.transform.z=t)}get rotation(){var t,i;return(i=(t=this.transform)===null||t===void 0?void 0:t.rotation)!==null&&i!==void 0?i:0}set rotation(t){this.transform&&(this.transform.rotation=t)}get scale(){var t,i;return(i=(t=this.transform)===null||t===void 0?void 0:t.scale)!==null&&i!==void 0?i:E.One}set scale(t){var i;!((i=this.transform)===null||i===void 0)&&i.scale&&(this.transform.scale=t)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t}get vel(){return this._motion.vel}set vel(t){this._motion.vel=t}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}constructor(t){var i,n,a;super([],t.name),this.events=new v,this._token=0,this.logger=J.getInstance(),this.tiles=[],this._rows=[],this._cols=[],this.renderFromTopOfGraphic=!1,this.meshingLookBehind=10,this._collidersDirty=!0,this._forwardPointerEventToTile=d=>p=>{const m=this.getTileByPoint(p.worldPos);m&&m.events.emit(d,p)},this._originalOffsets=new WeakMap,this.meshingLookBehind=(i=t.meshingLookBehind)!==null&&i!==void 0?i:this.meshingLookBehind,this.addComponent(new it),this.addComponent(new Ft),this.addComponent(new ct({type:ft.Fixed})),this.addComponent(new ie({onPostDraw:(d,p)=>this.draw(d,p)})),this.addComponent(new Zo((d,p)=>this.debug(d,p),!1)),this.addComponent(new jt),this.addComponent(new Ri),this.pointer=this.get(Ri),this._graphics=this.get(ie),this.transform=this.get(it),this._motion=this.get(Ft),this.collider=this.get(jt),this._composite=this.collider.useCompositeCollider([]),this.transform.pos=(n=t.pos)!==null&&n!==void 0?n:E.Zero,this._oldPos=this.transform.pos.clone(),this._oldScale=this.transform.scale.clone(),this.renderFromTopOfGraphic=(a=t.renderFromTopOfGraphic)!==null&&a!==void 0?a:this.renderFromTopOfGraphic,this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight,this.rows=t.rows,this.columns=t.columns,this.tiles=new Array(this.rows*this.columns),this._rows=new Array(this.rows),this._cols=new Array(this.columns);let h=[];for(let d=0;d<this.columns;d++){for(let p=0;p<this.rows;p++){const m=new hf({x:d,y:p,map:this});m.map=this,this.tiles[d+p*this.columns]=m,h.push(m),this._rows[p]||(this._rows[p]=[]),this._rows[p].push(m)}this._cols[d]=h,h=[]}this._setupPointerToTile(),this._graphics.localBounds=new et({left:0,top:0,right:this.columns*this.tileWidth*this.scale.x,bottom:this.rows*this.tileHeight*this.scale.y})}_initialize(t){super._initialize(t),this._engine=t}_setupPointerToTile(){this.events.on("pointerup",this._forwardPointerEventToTile("pointerup")),this.events.on("pointerdown",this._forwardPointerEventToTile("pointerdown")),this.events.on("pointermove",this._forwardPointerEventToTile("pointermove")),this.events.on("pointercancel",this._forwardPointerEventToTile("pointercancel"))}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const i=t.offset;return this._originalOffsets.set(t,i),i}}_updateColliders(){this.collider.$colliderRemoved.notifyAll(this._composite),this._composite.clearColliders();const t=[];this._composite=this.collider.useCompositeCollider([]);let i;const n=(h,d)=>h&&d?h.top===d.top&&h.bottom===d.bottom&&h.right===d.left:!1,a=(h,d,p=this.meshingLookBehind)=>{if(!h)return!1;for(let m=d.length-1;m>=0;m--){if(p--<0)return!1;const y=d[m];if(n(y,h))return d[m]=y.combine(h),!0}return!1};for(let h=0;h<this.columns;h++){for(let d=0;d<this.rows;d++){const p=this.tiles[h+d*this.columns];if(p.solid)if(p.getColliders().length>0){for(const m of p.getColliders()){const y=this._getOrSetColliderOriginalOffset(m);m.offset=B(p.x*this.tileWidth*this.scale.x,p.y*this.tileHeight*this.scale.y).add(y),m.owner=this,this._composite.addCollider(m)}i&&!a(i,t)&&t.push(i),i=null}else i?i=i.combine(p.defaultGeometry):i=p.defaultGeometry;else i&&!a(i,t)&&t.push(i),i=null}i&&!a(i,t)&&t.push(i),i=null}for(const h of t){const d=fe.Box(h.width,h.height,E.Zero,B(h.left-this.pos.x,h.top-this.pos.y));d.owner=this,this._composite.addCollider(d)}this.collider.update(),this.collider.$colliderAdded.notifyAll(this._composite)}getTileByIndex(t){return this.tiles[t]}getTile(t,i){return t<0||i<0||t>=this.columns||i>=this.rows?null:this.tiles[t+i*this.columns]}getTileByPoint(t){const{x:i,y:n}=this._getTileCoordinates(t),a=this.getTile(i,n);return i>=0&&n>=0&&i<this.columns&&n<this.rows&&a?a:null}_getTileCoordinates(t){t=this.transform.applyInverse(t);const i=Math.floor(t.x/this.tileWidth),n=Math.floor(t.y/this.tileHeight);return{x:i,y:n}}getRows(){return this._rows}getColumns(){return this._cols}getOnScreenTiles(){let t=this._engine.screen.getWorldBounds();const i=this.get(qo);if(i&&this.isInitialized){let k=this.pos;const M=E.One.sub(i.parallaxFactor),z=this._engine.currentScene.camera.pos.scale(M);k=k.sub(z),t=t.translate(k)}const n=this.transform.coordPlane===te.Screen?this._engine.screen.getScreenBounds():t,a=this._getTileCoordinates(n.topLeft),h=this._getTileCoordinates(n.topRight),d=this._getTileCoordinates(n.bottomRight),p=this._getTileCoordinates(n.bottomLeft),m=Math.min(O(a.x,0,this.columns-1),O(h.x,0,this.columns-1)),y=Math.min(O(a.y,0,this.rows-1),O(h.y,0,this.rows-1)),w=Math.max(O(d.x,0,this.columns-1),O(p.x,0,this.columns-1)),b=Math.max(O(d.y,0,this.rows-1),O(p.y,0,this.rows-1)),R=[];for(let k=m;k<=w;k++)for(let M=y;M<=b;M++)R.push(this.getTile(k,M));return R}update(t,i){this._initialize(t),this.onPreUpdate(t,i),this.emit("preupdate",new es(t,i,this)),(!this._oldPos.equals(this.pos)||this._oldRotation!==this.rotation||!this._oldScale.equals(this.scale))&&(this.flagCollidersDirty(),this.flagTilesDirty()),this._collidersDirty&&(this._collidersDirty=!1,this._updateColliders()),this._token++,this.pos.clone(this._oldPos),this._oldRotation=this.rotation,this.scale.clone(this._oldScale),this.transform.pos=this.pos,this.onPostUpdate(t,i),this.emit("postupdate",new is(t,i,this))}draw(t,i){if(!this.isInitialized)return;this.emit("predraw",new _n(t,i,this));let n,a,h;const d=this.getOnScreenTiles();for(let p=0;p<d.length;p++){const m=d[p],y=m.getGraphicsOffsets();for(n=m.getGraphics(),a=0,h=n.length;a<h;a++){const w=n[a],b=y[a];if(w){_h(w)&&(w==null||w.tick(i,this._token));const R=this.renderFromTopOfGraphic?0:w.height-this.tileHeight;w.draw(t,m.x*this.tileWidth+b.x,m.y*this.tileHeight-R+b.y)}}}this.emit("postdraw",new vn(t,i,this))}debug(t,i){const{showAll:n,showGrid:a,gridColor:h,gridWidth:d,showSolidBounds:p,solidBoundsColor:m,showColliderGeometry:y}=i.tilemap,{geometryColor:w,geometryLineWidth:b,geometryPointSize:R}=i.collider,k=this.tileWidth*this.columns*this.scale.x,M=this.tileHeight*this.rows*this.scale.y,z=this.pos;if(a||n){for(let X=0;X<this.rows+1;X++){const N=B(0,X*this.tileHeight*this.scale.y);t.drawLine(z.add(N),z.add(B(k,N.y)),h,d)}for(let X=0;X<this.columns+1;X++){const N=B(X*this.tileWidth*this.scale.x,0);t.drawLine(z.add(N),z.add(B(N.x,M)),h,d)}}if(n||p||y){const X=this._composite.getColliders();t.save(),t.translate(this.pos.x,this.pos.y),t.scale(this.scale.x,this.scale.y);for(const N of X){const U=N.localBounds,Y=N.worldPos.sub(this.pos);p&&t.drawRectangle(Y,U.width,U.height,m)}if(t.restore(),y)for(const N of X)N.debug(t,w,{lineWidth:b,pointSize:R})}if(n||p){if(t.save(),t.z=999,p)for(let X=0;X<this.tiles.length;X++)this.tiles[X].bounds.draw(t);t.restore()}}}class hf{get pos(){return this._posDirty&&(this._recalculate(),this._posDirty=!1),this._pos}get width(){return this._width}get height(){return this._height}get solid(){return this._solid}set solid(t){var i;(i=this.map)===null||i===void 0||i.flagCollidersDirty(),this._solid=t}getGraphics(){return this._graphics}getGraphicsOffsets(){return this._offsets}addGraphic(t,i){this._graphics.push(t),i!=null&&i.offset?this._offsets.push(i.offset):this._offsets.push(E.Zero)}removeGraphic(t){const i=this._graphics.indexOf(t);i>-1&&(this._graphics.splice(i,1),this._offsets.splice(i,1))}clearGraphics(){this._graphics.length=0,this._offsets.length=0}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const i=this._colliders.indexOf(t);i>-1&&this._colliders.splice(i,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}constructor(t){var i,n;this._posDirty=!1,this.events=new v,this._solid=!1,this._graphics=[],this._offsets=[],this._colliders=[],this.data=new Map,this.x=t.x,this.y=t.y,this.map=t.map,this._width=t.map.tileWidth*this.map.scale.x,this._height=t.map.tileHeight*this.map.scale.y,this.solid=(i=t.solid)!==null&&i!==void 0?i:this.solid,this._graphics=(n=t.graphics)!==null&&n!==void 0?n:[],this._recalculate()}flagDirty(){return this._posDirty=!0}_recalculate(){const t=this.map.pos.add(B(this.x*this.map.tileWidth,this.y*this.map.tileHeight));this._geometry=new et(t.x,t.y,t.x+this.map.tileWidth,t.y+this.map.tileHeight),this._width=this.map.tileWidth*this.map.scale.x,this._height=this.map.tileHeight*this.map.scale.y,this._pos=this.map.pos.add(B(this.x*this._width,this.y*this._height)),this._bounds=new et(this._pos.x,this._pos.y,this._pos.x+this._width,this._pos.y+this._height),this.map.rotation&&(this._bounds=this._bounds.rotate(this.map.rotation,this.map.pos)),this._posDirty=!1}get bounds(){return this._posDirty&&this._recalculate(),this._bounds}get defaultGeometry(){return this._geometry}get center(){return this._posDirty&&this._recalculate(),new E(this._pos.x+this._width/2,this._pos.y+this._height/2)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){i?this.events.off(t,i):this.events.off(t)}}class cf{constructor(t){this.camera=t}lockToActor(t){this.camera.addStrategy(new uf(t))}lockToActorAxis(t,i){this.camera.addStrategy(new df(t,i))}elasticToActor(t,i,n){this.camera.addStrategy(new ff(t,i,n))}radiusAroundActor(t,i){this.camera.addStrategy(new pf(t,i))}limitCameraBounds(t){this.camera.addStrategy(new gf(t))}}var Ko;(function(u){u[u.X=0]="X",u[u.Y=1]="Y"})(Ko||(Ko={}));class uf{constructor(t){this.target=t,this.action=(i,n,a,h)=>i.center}}class df{constructor(t,i){this.target=t,this.axis=i,this.action=(n,a,h,d)=>{const p=n.center,m=a.getFocus();return this.axis===Ko.X?new E(p.x,m.y):new E(m.x,p.y)}}}class ff{constructor(t,i,n){this.target=t,this.cameraElasticity=i,this.cameraFriction=n,this.action=(a,h,d,p)=>{const m=a.center;let y=h.getFocus(),w=h.vel.clone();const b=m.sub(y).scale(this.cameraElasticity);w=w.add(b);const R=w.scale(-1).scale(this.cameraFriction);return w=w.add(R),y=y.add(w),y}}}class pf{constructor(t,i){this.target=t,this.radius=i,this.action=(n,a,h,d)=>{const p=n.center,m=a.getFocus(),y=p.sub(m),w=y.size;if(w>=this.radius){const b=w-this.radius;return m.add(y.normalize().scale(b))}return m}}}class gf{constructor(t){this.target=t,this.boundSizeChecked=!1,this.action=(i,n,a,h)=>{const d=n.getFocus();this.boundSizeChecked||((i.bottom-i.top<a.drawHeight||i.right-i.left<a.drawWidth)&&J.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),this.boundSizeChecked=!0);let p=d.x,m=d.y;return d.x<i.left+a.halfDrawWidth?p=i.left+a.halfDrawWidth:d.x>i.right-a.halfDrawWidth&&(p=i.right-a.halfDrawWidth),d.y<i.top+a.halfDrawHeight?m=i.top+a.halfDrawHeight:d.y>i.bottom-a.halfDrawHeight&&(m=i.bottom-a.halfDrawHeight),B(p,m)}}}const G0={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate"};class mf{constructor(){this.events=new v,this.transform=bt.identity(),this.inverse=bt.identity(),this._cameraStrategies=[],this.strategy=new cf(this),this._z=1,this.dz=0,this.az=0,this.rotation=0,this._angularVelocity=0,this._posChanged=!1,this._pos=Td(E.Zero,()=>this._posChanged=!0),this.drawPos=this.pos.clone(),this._oldPos=this.pos.clone(),this.vel=E.Zero,this.acc=E.Zero,this._cameraMoving=!1,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=null,this._lerpEnd=null,this._isShaking=!1,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._elapsedShakeTime=0,this._xShake=0,this._yShake=0,this._isZooming=!1,this._zoomStart=1,this._zoomEnd=1,this._currentZoomTime=0,this._zoomDuration=0,this._zoomEasing=Rt.EaseInOutCubic,this._easing=Rt.EaseInOutCubic,this._halfWidth=0,this._halfHeight=0,this._viewport=null,this._isInitialized=!1,this._snapPos=B(0,0)}get zoom(){return this._z}set zoom(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}get angularVelocity(){return this._angularVelocity}set angularVelocity(t){this._angularVelocity=t}get pos(){return this._pos}set pos(t){this._pos=Td(t,()=>this._posChanged=!0),this._posChanged=!0}get x(){return this.pos.x}set x(t){!this._follow&&!this._cameraMoving&&(this.pos=B(t,this.pos.y))}get y(){return this.pos.y}set y(t){!this._follow&&!this._cameraMoving&&(this.pos=B(this.pos.x,t))}get dx(){return this.vel.x}set dx(t){this.vel=B(t,this.vel.y)}get dy(){return this.vel.y}set dy(t){this.vel=B(this.vel.x,t)}get ax(){return this.acc.x}set ax(t){this.acc=B(t,this.acc.y)}get ay(){return this.acc.y}set ay(t){this.acc=B(this.acc.x,t)}getFocus(){return this.pos}move(t,i,n=Rt.EaseInOutCubic){if(typeof n!="function")throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise(a=>{this._lerpResolve=a}),this._lerpStart=this.getFocus().clone(),this._lerpDuration=i,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=n,this._lerpPromise)}shake(t,i,n){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=i,this._shakeDuration=n}zoomOverTime(t,i=0,n=Rt.EaseInOutCubic){if(this._zoomPromise=new Promise(a=>{this._zoomResolve=a}),i)this._isZooming=!0,this._zoomEasing=n,this._currentZoomTime=0,this._zoomDuration=i,this._zoomStart=this.zoom,this._zoomEnd=t;else return this._isZooming=!1,this.zoom=t,Promise.resolve(!0);return this._zoomPromise}get viewport(){return this._viewport?this._viewport:new et(0,0,0,0)}addStrategy(t){this._cameraStrategies.push(t)}removeStrategy(t){lt(t,this._cameraStrategies)}clearAllStrategies(){this._cameraStrategies.length=0}_preupdate(t,i){this.events.emit("preupdate",new es(t,i,this)),this.onPreUpdate(t,i)}onPreUpdate(t,i){}_postupdate(t,i){this.events.emit("postupdate",new is(t,i,this)),this.onPostUpdate(t,i)}onPostUpdate(t,i){}get isInitialized(){return this._isInitialized}_initialize(t){if(!this.isInitialized){this._engine=t,this._screen=t.screen;const i=this._screen.contentArea;let n=B(i.width/2,i.height/2);if(!this._engine.loadingComplete){const a=this._screen.peekResolution();a&&(n=B(a.width/2,a.height/2))}this._halfWidth=n.x,this._halfHeight=n.y,this._posChanged||(this.pos=n),this.pos.clone(this.drawPos),this.updateTransform(this.pos),this.runStrategies(t,t.clock.elapsed()),this.updateViewport(),this.updateTransform(this.pos),this.pos.clone(this._oldPos),this.onInitialize(t),this.events.emit("initialize",new yn(t,this)),this._isInitialized=!0}}onInitialize(t){}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}runStrategies(t,i){for(const n of this._cameraStrategies)this.pos=n.action.call(n,n.target,this,t,i)}updateViewport(){this._viewport=new et(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight)}update(t,i){if(this._initialize(t),this._preupdate(t,i),this.pos.clone(this._oldPos),this.pos=this.pos.add(this.vel.scale(i/1e3)),this.zoom+=this.dz*i/1e3,this.vel=this.vel.add(this.acc.scale(i/1e3)),this.dz+=this.az*i/1e3,this.rotation+=this.angularVelocity*i/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){const n=this._zoomEasing,a=n(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=a,this._currentZoomTime+=i}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){const a=Rt.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=a,this._currentLerpTime+=i}else{this.pos=this._lerpEnd;const n=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(n)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=i,this._xShake=(Math.random()*this._shakeMagnitudeX|0)+1,this._yShake=(Math.random()*this._shakeMagnitudeY|0)+1),this.runStrategies(t,i),this.updateViewport(),this.updateTransform(this.pos),this._postupdate(t,i)}draw(t){if(this.pos.clone(this.drawPos),this._engine.fixedUpdateFps){const i=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps),n=this.pos.scale(i).add(this._oldPos.scale(1-i));n.clone(this.drawPos),this.updateTransform(n)}if(t.snapToPixel){const i=this.drawPos.clone(this._snapPos);i.x=~~(i.x+vt*L(i.x)),i.y=~~(i.y+vt*L(i.y)),i.clone(this.drawPos),this.updateTransform(i)}t.multiply(this.transform)}updateTransform(t){const i=this._screen.resolution.width/this.zoom,n=this._screen.resolution.height/this.zoom,a=B(-t.x+i/2+this._xShake,-t.y+n/2+this._yShake);this.transform.reset(),this.transform.scale(this.zoom,this.zoom),this.transform.translate(i/2,n/2),this.transform.rotate(this.rotation),this.transform.translate(-i/2,-n/2),this.transform.translate(a.x,a.y),this.transform.inverse(this.inverse)}_isDoneShaking(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}const X0={ExitTrigger:"exit",EnterTrigger:"enter"},Y0={pos:E.Zero,width:10,height:10,visible:!1,action:()=>{},filter:()=>!0,repeat:-1};class _f extends Le{constructor(t){super({x:t.pos.x,y:t.pos.y,width:t.width,height:t.height}),this.events=new v,this.action=()=>{},this.filter=()=>!0,this.repeat=-1,t={...Y0,...t},this.filter=t.filter||this.filter,this.repeat=t.repeat||this.repeat,this.action=t.action||this.action,t.target&&(this.target=t.target),this.graphics.visible=t.visible,this.body.collisionType=ft.Passive,this.events.on("collisionstart",i=>{this.filter(i.other)&&(this.events.emit("enter",new nh(this,i.other)),this._dispatchAction(),this.repeat===0&&this.kill())}),this.events.on("collisionend",i=>{this.filter(i.other)&&this.events.emit("exit",new rh(this,i.other))})}set target(t){this._target=t,this.filter=i=>i===t}get target(){return this._target}_initialize(t){super._initialize(t)}_dispatchAction(){this.repeat!==0&&(this.action.call(this),this.repeat--)}}const Ii={Highest:-1/0,Higher:-5,Average:0,Lower:5,Lowest:1/0};var Oe;(function(u){u.Update="update",u.Draw="draw"})(Oe||(Oe={}));class oi{constructor(){this.priority=Ii.Average}}class vf{constructor(t){this._world=t,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}updateEntities(t,i){for(const n of this.entities)n.update(t.engine,i),n.active||this.removeEntity(n)}findEntitiesForRemoval(){for(const t of this.entities)t.active||this.removeEntity(t)}addEntity(t){t.active=!0,t.scene=this._world.scene,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.children.forEach(i=>{i.scene=t.scene,this.addEntity(i)}),t.childrenAdded$.register({notify:i=>{this.addEntity(i)}}),t.childrenRemoved$.register({notify:i=>{this.removeEntity(i,!1)}}))}removeEntity(t,i=!0){var n,a;let h=0;t instanceof pe?h=t.id:h=t;const d=this._entityIndex[h];if(d&&d.active&&(d.active=!1),d&&i){this._entitiesToRemove.push(d);return}delete this._entityIndex[h],d&&(d.scene=null,lt(d,this.entities),this._world.queryManager.removeEntity(d),d.children.forEach(p=>{p.scene=null,this.removeEntity(p,i)}),d.childrenAdded$.clear(),d.childrenRemoved$.clear(),!((a=(n=this._world)===null||n===void 0?void 0:n.scene)===null||a===void 0)&&a.engine&&this._world.scene.engine.stats.currFrame.actors.killed++)}processEntityRemovals(){for(const t of this._entitiesToRemove)t.active||this.removeEntity(t,!1);this._entitiesToRemove.length=0}processComponentRemovals(){for(const t of this.entities)t.processComponentRemoval()}getById(t){return this._entityIndex[t]}getByName(t){return this.entities.filter(i=>i.name===t)}clear(){for(let t=this.entities.length-1;t>=0;t--)this.removeEntity(this.entities[t])}}class br{constructor(t){if(this.requiredComponents=t,this.components=new Set,this.entities=[],this.entityAdded$=new we,this.entityRemoved$=new we,t.length===0)throw new Error("Cannot create query without components");for(const i of t)this.components.add(i);this.id=br.createId(t)}static createId(t){return t.slice().map(i=>i.name).sort().join("-")}checkAndAdd(t){return!this.entities.includes(t)&&t.hasAll(Array.from(this.components))?(this.entities.push(t),this.entityAdded$.notifyAll(t),!0):!1}removeEntity(t){const i=this.entities.indexOf(t);i>-1&&(this.entities.splice(i,1),this.entityRemoved$.notifyAll(t))}getEntities(t){return t&&this.entities.sort(t),this.entities}}class Cr{constructor(t){if(this.requiredTags=t,this.tags=new Set,this.entities=[],this.entityAdded$=new we,this.entityRemoved$=new we,t.length===0)throw new Error("Cannot create tag query without tags");for(const i of t)this.tags.add(i);this.id=Cr.createId(t)}static createId(t){return t.slice().sort().join("-")}checkAndAdd(t){return!this.entities.includes(t)&&t.hasAllTags(Array.from(this.tags))?(this.entities.push(t),this.entityAdded$.notifyAll(t),!0):!1}removeEntity(t){const i=this.entities.indexOf(t);i>-1&&(this.entities.splice(i,1),this.entityRemoved$.notifyAll(t))}getEntities(t){return t&&this.entities.sort(t),this.entities}}class yf{constructor(t){this._world=t,this._queries=new Map,this._addComponentHandlers=new Map,this._removeComponentHandlers=new Map,this._componentToQueriesIndex=new Map,this._tagQueries=new Map,this._addTagHandlers=new Map,this._removeTagHandlers=new Map,this._tagToQueriesIndex=new Map,this._createAddComponentHandler=i=>n=>{this.addComponent(i,n)},this._createRemoveComponentHandler=i=>n=>{this.removeComponent(i,n)},this._createAddTagHandler=i=>n=>{this.addTag(i,n)},this._createRemoveTagHandler=i=>n=>{this.removeTag(i,n)}}createQuery(t){const i=br.createId(t);if(this._queries.has(i))return this._queries.get(i);const n=new br(t);this._queries.set(n.id,n);for(const a of t){const h=this._componentToQueriesIndex.get(a);h?h.push(n):this._componentToQueriesIndex.set(a,[n])}for(const a of this._world.entities)this.addEntity(a);return n}createTagQuery(t){const i=Cr.createId(t);if(this._tagQueries.has(i))return this._tagQueries.get(i);const n=new Cr(t);this._tagQueries.set(n.id,n);for(const a of t){const h=this._tagToQueriesIndex.get(a);h?h.push(n):this._tagToQueriesIndex.set(a,[n])}for(const a of this._world.entities)this.addEntity(a);return n}addEntity(t){const i=this._addComponentHandlers.get(t),n=this._removeComponentHandlers.get(t),a=i??this._createAddComponentHandler(t),h=n??this._createRemoveComponentHandler(t);this._addComponentHandlers.set(t,a),this._removeComponentHandlers.set(t,h);const d=this._addTagHandlers.get(t),p=this._removeTagHandlers.get(t),m=d??this._createAddTagHandler(t),y=p??this._createRemoveTagHandler(t);this._addTagHandlers.set(t,m),this._removeTagHandlers.set(t,y);for(const w of this._queries.values())w.checkAndAdd(t);for(const w of this._tagQueries.values())w.checkAndAdd(t);t.componentAdded$.subscribe(a),t.componentRemoved$.subscribe(h),t.tagAdded$.subscribe(m),t.tagRemoved$.subscribe(y)}removeEntity(t){const i=this._addComponentHandlers.get(t),n=this._removeComponentHandlers.get(t);for(const d of this._queries.values())d.removeEntity(t);i&&t.componentAdded$.unsubscribe(i),n&&t.componentRemoved$.unsubscribe(n);const a=this._addTagHandlers.get(t),h=this._removeTagHandlers.get(t);for(const d of this._tagQueries.values())d.removeEntity(t);a&&t.tagAdded$.unsubscribe(a),h&&t.tagRemoved$.unsubscribe(h)}addComponent(t,i){var n;const a=(n=this._componentToQueriesIndex.get(i.constructor))!==null&&n!==void 0?n:[];for(const h of a)h.checkAndAdd(t)}removeComponent(t,i){var n;const a=(n=this._componentToQueriesIndex.get(i.constructor))!==null&&n!==void 0?n:[];for(const h of a)h.removeEntity(t)}addTag(t,i){var n;const a=(n=this._tagToQueriesIndex.get(i))!==null&&n!==void 0?n:[];for(const h of a)h.checkAndAdd(t)}removeTag(t,i){var n;const a=(n=this._tagToQueriesIndex.get(i))!==null&&n!==void 0?n:[];for(const h of a)h.removeEntity(t)}}function wf(u){var t,i;return!!(u!=null&&u.prototype)&&!!(!((i=(t=u==null?void 0:u.prototype)===null||t===void 0?void 0:t.constructor)===null||i===void 0)&&i.name)}class xf{constructor(t){this._world=t,this.systems=[],this.initialized=!1}get(t){return this.systems.find(i=>i instanceof t)}addSystem(t){let i;t instanceof oi?i=t:i=new t(this._world),this.systems.push(i),this.systems.sort((n,a)=>n.priority-a.priority),this.initialized&&i.initialize&&i.initialize(this._world,this._world.scene)}removeSystem(t){lt(t,this.systems)}initialize(){if(!this.initialized){this.initialized=!0;for(const t of this.systems)t.initialize&&t.initialize(this._world,this._world.scene)}}updateSystems(t,i,n){const a=this.systems.filter(h=>h.systemType===t);for(const h of a)h.preupdate&&h.preupdate(i,n);for(const h of a)h.update(n);for(const h of a)h.postupdate&&h.postupdate(i,n)}clear(){for(let t=this.systems.length-1;t>=0;t--)this.removeSystem(this.systems[t])}}class bf{constructor(t){this.scene=t,this.queryManager=new yf(this),this.entityManager=new vf(this),this.systemManager=new xf(this)}query(t){return this.queryManager.createQuery(t)}queryTags(t){return this.queryManager.createTagQuery(t)}update(t,i){t===Oe.Update&&this.entityManager.updateEntities(this.scene,i),this.systemManager.updateSystems(t,this.scene,i),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}add(t){t instanceof pe&&this.entityManager.addEntity(t),(t instanceof oi||wf(t))&&this.systemManager.addSystem(t)}get(t){return this.systemManager.get(t)}remove(t,i=!0){t instanceof pe&&this.entityManager.removeEntity(t,i),t instanceof oi&&this.systemManager.removeSystem(t)}get entities(){return this.entityManager.entities}clearEntities(){this.entityManager.clear()}clearSystems(){this.systemManager.clear()}}class Te{static integrate(t,i,n,a){const h=a/1e3;i.vel.addEqual(n.scale(h,Te._ACC)),t.pos.add(i.vel.scale(h,Te._VEL),Te._POS).addEqual(n.scale(.5*h*h,Te._VEL_ACC)),i.angularVelocity+=i.torque*(1/i.inertia)*h;const d=t.rotation+i.angularVelocity*h;t.scale.add(i.scaleFactor.scale(h,this._SCALE_FACTOR),Te._SCALE),t.get().setTransform(Te._POS,d,Te._SCALE)}}Te._POS=new E(0,0),Te._SCALE=new E(1,1),Te._ACC=new E(0,0),Te._VEL=new E(0,0),Te._VEL_ACC=new E(0,0),Te._SCALE_FACTOR=new E(0,0);class Cf extends oi{constructor(t,i){super(),this.world=t,this.physics=i,this.systemType=Oe.Update,this.priority=Ii.Higher,this._physicsConfigDirty=!1,i.$configUpdate.subscribe(()=>this._physicsConfigDirty=!0),this.query=this.world.query([it,Ft])}update(t){let i,n;const a=this.query.entities;for(let h=0;h<a.length;h++){i=a[h].get(it),n=a[h].get(Ft);const d=a[h].get(ct);if(this._physicsConfigDirty&&d&&d.updatePhysicsConfig(this.physics.config.bodies),d!=null&&d.sleeping)continue;const p=n.acc.clone();(d==null?void 0:d.collisionType)===ft.Active&&(d!=null&&d.useGravity)&&p.addEqual(this.physics.config.gravity),d==null||d.captureOldTransform(),Te.integrate(i,n,p,t)}this._physicsConfigDirty=!1}}class xh{constructor(t){this.config=t,this.directionMap=new Map,this.distanceMap=new Map}solve(t){this.preSolve(t),t=t.filter(n=>!n.isCanceled());let i;switch(this.config.contactSolveBias){case Ns.HorizontalFirst:{i=Wd;break}case Ns.VerticalFirst:{i=Hd;break}default:i=jd}t.sort((n,a)=>{const h=this.directionMap.get(n.id),d=this.directionMap.get(a.id),p=this.distanceMap.get(n.id),m=this.distanceMap.get(a.id);return i[h]-i[d]||p-m});for(const n of t)this.solvePosition(n),this.solveVelocity(n);return this.postSolve(t),t}preSolve(t){for(const n of t){if(Math.abs(n.mtv.x)<1e-4&&Math.abs(n.mtv.y)<1e-4){n.cancel();continue}const a=wt.fromDirection(n.mtv),h=n.mtv.negate(),d=n.colliderA.worldPos.squareDistance(n.colliderB.worldPos);this.distanceMap.set(n.id,d),this.directionMap.set(n.id,a===wt.Left||a===wt.Right?"horizontal":"vertical"),n.colliderA.events.emit("precollision",new ks(n.colliderA,n.colliderB,a,h,n)),n.colliderB.events.emit("precollision",new ks(n.colliderB,n.colliderA,wt.getOpposite(a),h.negate(),n))}}postSolve(t){var i,n;for(const a of t){if(a.isCanceled())continue;const h=a.colliderA,d=a.colliderB,p=(i=h.owner)===null||i===void 0?void 0:i.get(ct),m=(n=d.owner)===null||n===void 0?void 0:n.get(ct);if(p&&m&&(p.collisionType===ft.Passive||m.collisionType===ft.Passive))continue;const y=wt.fromDirection(a.mtv),w=a.mtv.negate();a.colliderA.events.emit("postcollision",new Fs(a.colliderA,a.colliderB,y,w,a)),a.colliderB.events.emit("postcollision",new Fs(a.colliderB,a.colliderA,wt.getOpposite(y),w.negate(),a))}}solvePosition(t){var i,n;if(!t.colliderA.bounds.overlaps(t.colliderB.bounds,1e-4)){t.cancel();return}if(Math.abs(t.mtv.x)<1e-4&&Math.abs(t.mtv.y)<1e-4){t.cancel();return}let h=t.mtv;const d=t.colliderA,p=t.colliderB,m=(i=d.owner)===null||i===void 0?void 0:i.get(ct),y=(n=p.owner)===null||n===void 0?void 0:n.get(ct);if(m&&y){if(m.collisionType===ft.Passive||y.collisionType===ft.Passive)return;m.collisionType===ft.Active&&y.collisionType===ft.Active&&(h=h.scale(.5)),m.collisionType===ft.Active&&(m.globalPos.x-=h.x,m.globalPos.y-=h.y,d.update(m.transform.get())),y.collisionType===ft.Active&&(y.globalPos.x+=h.x,y.globalPos.y+=h.y,p.update(y.transform.get()))}}solveVelocity(t){var i,n;if(t.isCanceled())return;const a=t.colliderA,h=t.colliderB,d=(i=a.owner)===null||i===void 0?void 0:i.get(ct),p=(n=h.owner)===null||n===void 0?void 0:n.get(ct);if(d&&p){if(d.collisionType===ft.Passive||p.collisionType===ft.Passive)return;const m=t.normal,y=m.negate();if(d.collisionType===ft.Active&&d.vel.normalize().dot(y)<0){const w=m.scale(m.dot(d.vel.negate()));d.vel=d.vel.add(w)}if(p.collisionType===ft.Active&&p.vel.normalize().dot(m)<0){const w=y.scale(y.dot(p.vel.negate()));p.vel=p.vel.add(w)}}}}class Sf{constructor(t,i,n){this.point=t,this.local=i,this.contact=n,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new E(0,0),this.bToContact=new E(0,0),this.originalVelocityAndRestitution=0,this.update()}update(){var t,i;const n=(t=this.contact.colliderA.owner)===null||t===void 0?void 0:t.get(ct),a=(i=this.contact.colliderB.owner)===null||i===void 0?void 0:i.get(ct);if(n&&a){const h=this.contact.normal,d=this.contact.tangent;this.aToContact=this.point.sub(n.globalPos),this.bToContact=this.point.sub(a.globalPos);const p=this.aToContact.cross(h),m=this.bToContact.cross(h);this.normalMass=n.inverseMass+a.inverseMass+n.inverseInertia*p*p+a.inverseInertia*m*m;const y=this.aToContact.cross(d),w=this.bToContact.cross(d);this.tangentMass=n.inverseMass+a.inverseMass+n.inverseInertia*y*y+a.inverseInertia*w*w}return this}getRelativeVelocity(){var t,i;const n=(t=this.contact.colliderA.owner)===null||t===void 0?void 0:t.get(ct),a=(i=this.contact.colliderB.owner)===null||i===void 0?void 0:i.get(ct);if(n&&a){const h=n.vel.add(E.cross(n.angularVelocity,this.aToContact));return a.vel.add(E.cross(a.angularVelocity,this.bToContact)).sub(h)}return E.Zero}}class bh{constructor(t){this.config=t,this.lastFrameContacts=new Map,this.idToContactConstraint=new Map}getContactConstraints(t){var i;return(i=this.idToContactConstraint.get(t))!==null&&i!==void 0?i:[]}solve(t){return this.preSolve(t),t=t.filter(i=>!i.isCanceled()),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}preSolve(t){var i,n,a;for(const p of t){if(Math.abs(p.mtv.x)<1e-4&&Math.abs(p.mtv.y)<1e-4){p.cancel();continue}const m=wt.fromDirection(p.mtv);p.colliderA.events.emit("precollision",new ks(p.colliderA,p.colliderB,m,p.mtv,p)),p.colliderA.events.emit("beforecollisionresolve",new Oo(p.colliderA,p.colliderB,m,p.mtv,p)),p.colliderB.events.emit("precollision",new ks(p.colliderB,p.colliderA,wt.getOpposite(m),p.mtv.negate(),p)),p.colliderB.events.emit("beforecollisionresolve",new Oo(p.colliderB,p.colliderA,wt.getOpposite(m),p.mtv.negate(),p)),p.matchAwake()}const d=Array.from(this.idToContactConstraint.keys());for(const p of t){const m=d.indexOf(p.id);m>-1&&d.splice(m,1);const y=(i=this.idToContactConstraint.get(p.id))!==null&&i!==void 0?i:[];let w=0;const b=p.colliderA.owner.get(ct),R=p.colliderB.owner.get(ct);if(b&&R)for(const k of p.points){const M=p.normal,z=p.tangent,X=k.sub(b.globalPos),N=k.sub(R.globalPos),U=X.cross(M),Y=N.cross(M),H=b.inverseMass+R.inverseMass+b.inverseInertia*U*U+R.inverseInertia*Y*Y,tt=X.cross(z),gt=N.cross(z),$=b.inverseMass+R.inverseMass+b.inverseInertia*tt*tt+R.inverseInertia*gt*gt;y[w]&&((a=(n=y[w])===null||n===void 0?void 0:n.point)===null||a===void 0?void 0:a.squareDistance(k))<4?(y[w].point=k,y[w].local=p.localPoints[w]):y[w]=new Sf(k,p.localPoints[w],p),y[w].aToContact=X,y[w].bToContact=N,y[w].normalMass=1/H,y[w].tangentMass=1/$;const mt=b.bounciness>R.bounciness?b.bounciness:R.bounciness,Bt=p.normal.dot(y[w].getRelativeVelocity());y[w].originalVelocityAndRestitution=0,Bt<-.1&&(y[w].originalVelocityAndRestitution=-mt*Bt),w++}this.idToContactConstraint.set(p.id,y)}for(const p of d)this.idToContactConstraint.delete(p);if(this.config.warmStart)this.warmStart(t);else for(const p of t){const m=this.getContactConstraints(p.id);for(const y of m)y.normalImpulse=0,y.tangentImpulse=0}}postSolve(t){for(const i of t){const n=i.colliderA.owner.get(ct),a=i.colliderB.owner.get(ct);if(n&&a){if(n.collisionType===ft.Passive||a.collisionType===ft.Passive)continue;n.updateMotion(),a.updateMotion()}const h=wt.fromDirection(i.mtv);i.colliderA.events.emit("postcollision",new Fs(i.colliderA,i.colliderB,h,i.mtv,i)),i.colliderA.events.emit("aftercollisionresolve",new No(i.colliderA,i.colliderB,h,i.mtv,i)),i.colliderB.events.emit("postcollision",new Fs(i.colliderB,i.colliderA,wt.getOpposite(h),i.mtv.negate(),i)),i.colliderB.events.emit("aftercollisionresolve",new No(i.colliderB,i.colliderA,wt.getOpposite(h),i.mtv.negate(),i))}this.lastFrameContacts.clear();for(const i of t)this.lastFrameContacts.set(i.id,i)}warmStart(t){var i,n,a;for(const h of t){const d=(i=h.colliderA.owner)===null||i===void 0?void 0:i.get(ct),p=(n=h.colliderB.owner)===null||n===void 0?void 0:n.get(ct);if(d&&p){const m=(a=this.idToContactConstraint.get(h.id))!==null&&a!==void 0?a:[];for(const y of m)if(this.config.warmStart){const w=h.normal.scale(y.normalImpulse),b=h.tangent.scale(y.tangentImpulse),R=w.add(b);d.applyImpulse(y.point,R.negate()),p.applyImpulse(y.point,R)}else y.normalImpulse=0,y.tangentImpulse=0}}}solvePosition(t){var i,n,a;for(let h=0;h<this.config.positionIterations;h++)for(const d of t){const p=(i=d.colliderA.owner)===null||i===void 0?void 0:i.get(ct),m=(n=d.colliderB.owner)===null||n===void 0?void 0:n.get(ct);if(p&&m){if(p.collisionType===ft.Passive||m.collisionType===ft.Passive)continue;const y=(a=this.idToContactConstraint.get(d.id))!==null&&a!==void 0?a:[];for(const w of y){const b=d.normal,R=gi.FindContactSeparation(d,w.local),k=this.config.steeringFactor,M=-5,z=this.config.slop,X=O(k*(R+z),M,0),N=b.scale(-X*w.normalMass);if(p.collisionType===ft.Active){const U=N.negate().scale(p.inverseMass);p.limitDegreeOfFreedom.includes(Ae.X)&&(U.x=0),p.limitDegreeOfFreedom.includes(Ae.Y)&&(U.y=0),p.globalPos=p.globalPos.add(U),p.limitDegreeOfFreedom.includes(Ae.Rotation)||(p.rotation-=w.aToContact.cross(N)*p.inverseInertia)}if(m.collisionType===ft.Active){const U=N.scale(m.inverseMass);m.limitDegreeOfFreedom.includes(Ae.X)&&(U.x=0),m.limitDegreeOfFreedom.includes(Ae.Y)&&(U.y=0),m.globalPos=m.globalPos.add(U),m.limitDegreeOfFreedom.includes(Ae.Rotation)||(m.rotation+=w.bToContact.cross(N)*m.inverseInertia)}}}}}solveVelocity(t){var i,n,a;for(let h=0;h<this.config.velocityIterations;h++)for(const d of t){const p=(i=d.colliderA.owner)===null||i===void 0?void 0:i.get(ct),m=(n=d.colliderB.owner)===null||n===void 0?void 0:n.get(ct);if(p&&m){if(p.collisionType===ft.Passive||m.collisionType===ft.Passive)continue;const y=Math.min(p.friction,m.friction),w=(a=this.idToContactConstraint.get(d.id))!==null&&a!==void 0?a:[];for(const b of w){let M=-b.getRelativeVelocity().dot(d.tangent)*b.tangentMass;const z=y*b.normalImpulse,X=O(b.tangentImpulse+M,-z,z);M=X-b.tangentImpulse,b.tangentImpulse=X;const N=d.tangent.scale(M);p.applyImpulse(b.point,N.negate()),m.applyImpulse(b.point,N)}for(const b of w){const k=b.getRelativeVelocity().dot(d.normal);let M=-b.normalMass*(k-b.originalVelocityAndRestitution);const z=Math.max(b.normalImpulse+M,0);M=z-b.normalImpulse,b.normalImpulse=z;const X=d.normal.scale(M);p.applyImpulse(b.point,X.negate()),m.applyImpulse(b.point,X)}}}}}class Ch extends oi{get _processor(){return this._physics.collisionProcessor}constructor(t,i){super(),this._physics=i,this.systemType=Oe.Update,this.priority=Ii.Higher,this._configDirty=!1,this._lastFrameContacts=new Map,this._currentFrameContacts=new Map,this._arcadeSolver=new xh(i.config.arcade),this._realisticSolver=new bh(i.config.realistic),this._physics.$configUpdate.subscribe(()=>this._configDirty=!0),this._trackCollider=n=>this._processor.track(n),this._untrackCollider=n=>this._processor.untrack(n),this.query=t.query([it,Ft,jt]),this.query.entityAdded$.subscribe(n=>{const a=n.get(jt);a.$colliderAdded.subscribe(this._trackCollider),a.$colliderRemoved.subscribe(this._untrackCollider);const h=a.get();h&&this._processor.track(h)}),this.query.entityRemoved$.subscribe(n=>{const a=n.get(jt),h=a.get();a&&h&&this._processor.untrack(h)})}initialize(t,i){this._engine=i.engine}update(t){var i,n,a,h;if(!this._physics.config.enabled)return;let d=[];for(const w of this.query.entities){const b=w.get(jt),R=b==null?void 0:b.get();if(b&&(!((i=b.owner)===null||i===void 0)&&i.active)&&R)if(b.update(),R instanceof ue){const k=R.getColliders();R.compositeStrategy||(R.compositeStrategy=this._physics.config.colliders.compositeStrategy),d=d.concat(k)}else d.push(R)}this._processor.update(d);const p=this._processor.broadphase(d,t);this._currentFrameContacts.clear();let m=this._processor.narrowphase(p,(h=(a=(n=this._engine)===null||n===void 0?void 0:n.debug)===null||a===void 0?void 0:a.stats)===null||h===void 0?void 0:h.currFrame);m=this.getSolver().solve(m);for(const w of m){if(w.isCanceled())continue;const b=w.id.indexOf("|");if(b>0){const R=w.id.substring(b+1);this._currentFrameContacts.set(R,w)}else this._currentFrameContacts.set(w.id,w)}this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts);for(const w of this.query.entities){const b=w.get(jt);b&&b.processColliderRemoval()}}getSolver(){return this._configDirty&&(this._configDirty=!1,this._arcadeSolver=new xh(this._physics.config.arcade),this._realisticSolver=new bh(this._physics.config.realistic)),this._physics.config.solver===ns.Realistic?this._realisticSolver:this._arcadeSolver}debug(t){this._processor.debug(t)}runContactStartEnd(){for(const[t,i]of this._currentFrameContacts)if(!this._lastFrameContacts.has(t)){const n=i.colliderA,a=i.colliderB,h=wt.fromDirection(i.mtv),d=wt.getOpposite(h);n.events.emit("collisionstart",new pr(n,a,h,i)),n.events.emit("contactstart",new Mo(n,a,h,i)),a.events.emit("collisionstart",new pr(a,n,d,i)),a.events.emit("contactstart",new Mo(a,n,d,i))}for(const[t,i]of this._lastFrameContacts)if(!this._currentFrameContacts.has(t)){const n=i.colliderA,a=i.colliderB,h=wt.fromDirection(i.mtv),d=wt.getOpposite(h);n.events.emit("collisionend",new gr(n,a,h,i)),n.events.emit("contactend",new Lo(n,a,h,i)),a.events.emit("collisionend",new gr(a,n,d,i)),a.events.emit("contactend",new Lo(a,n,d,i))}}}function Ef(u){return class extends u{assign(t){for(const i in t)typeof this[i]!="function"&&(this[i]=t[i])}constructor(...t){super(...t),t.filter(function(n){return n!==void 0}).length===1&&t[0]&&typeof t[0]=="object"&&!(t[0]instanceof Array)&&this.assign(t[0])}}}var Cn;(function(u){u[u.Circle=0]="Circle",u[u.Rectangle=1]="Rectangle"})(Cn||(Cn={}));class $0 extends pe{constructor(t,i,n,a,h,d,p,m,y,w,b){super(),this.position=new E(0,0),this.velocity=new E(0,0),this.acceleration=new E(0,0),this.particleRotationalVelocity=0,this.currentRotation=0,this.focus=null,this.focusAccel=0,this.opacity=1,this.beginColor=G.White,this.endColor=G.White,this.life=300,this.fadeFlag=!1,this._rRate=1,this._gRate=1,this._bRate=1,this._aRate=0,this._currentColor=G.White,this.emitter=null,this.particleSize=5,this.particleSprite=null,this.sizeRate=0,this.elapsedMultiplier=0,this.visible=!0,this.isOffscreen=!1;let R=t;if(R&&!(t instanceof Af)){const k=t;R=k.emitter,i=k.life,n=k.opacity,h=k.endColor,a=k.beginColor,d=k.position,p=k.velocity,m=k.acceleration,y=k.startSize,w=k.endSize,b=k.particleSprite}if(this.emitter=R,this.life=i||this.life,this.opacity=n||this.opacity,this.endColor=h||this.endColor.clone(),this.beginColor=a||this.beginColor.clone(),this._currentColor=this.beginColor.clone(),this.particleSprite=b,this.emitter.particleTransform===Sn.Global){const k=this.emitter.transform.globalPos;this.position=(d||this.position).add(k),this.velocity=(p||this.velocity).rotate(this.emitter.transform.globalRotation)}else this.velocity=p||this.velocity,this.position=d||this.position;this.acceleration=m||this.acceleration,this._rRate=(this.endColor.r-this.beginColor.r)/this.life,this._gRate=(this.endColor.g-this.beginColor.g)/this.life,this._bRate=(this.endColor.b-this.beginColor.b)/this.life,this._aRate=this.opacity/this.life,this.startSize=y||0,this.endSize=w||0,this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize),this.addComponent(this.transform=new it),this.addComponent(this.graphics=new ie),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=B(1,1),this.transform.z=this.emitter.z,this.particleSprite?(this.graphics.opacity=this.opacity,this.graphics.use(this.particleSprite)):(this.graphics.localBounds=et.fromDimension(this.particleSize,this.particleSize,E.Half),this.graphics.onPostDraw=k=>{k.save(),this.graphics.opacity=this.opacity;const M=this._currentColor.clone();M.a=1,k.debug.drawPoint(B(0,0),{color:M,size:this.particleSize}),k.restore()})}kill(){this.emitter.removeParticle(this)}update(t,i){if(this.life=this.life-i,this.elapsedMultiplier=this.elapsedMultiplier+i,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=O(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=O(this.sizeRate*i+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=O(this._currentColor.r+this._rRate*i,0,255),this._currentColor.g=O(this._currentColor.g+this._gRate*i,0,255),this._currentColor.b=O(this._currentColor.b+this._bRate*i,0,255),this._currentColor.a=O(this.opacity,1e-4,1),this.focus){const n=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(i/1e3);this.velocity=this.velocity.add(n)}else this.velocity=this.velocity.add(this.acceleration.scale(i/1e3));this.position=this.position.add(this.velocity.scale(i/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*i/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=B(1,1),this.graphics.opacity=this.opacity}}class Jo extends Ef($0){constructor(t,i,n,a,h,d,p,m,y,w,b){super(t,i,n,a,h,d,p,m,y,w,b)}}var Sn;(function(u){u.Global="global",u.Local="local"})(Sn||(Sn={}));class Af extends Le{get opacity(){return this.graphics.opacity}set opacity(t){this.graphics.opacity=t}get particleSprite(){return this._sprite}set particleSprite(t){t&&(this._sprite=t)}constructor(t){var i,n;super({width:(i=t.width)!==null&&i!==void 0?i:0,height:(n=t.height)!==null&&n!==void 0?n:0}),this._particlesToEmit=0,this.numParticles=0,this.isEmitting=!0,this.particles=[],this.deadParticles=[],this.minVel=0,this.maxVel=0,this.acceleration=new E(0,0),this.minAngle=0,this.maxAngle=0,this.emitRate=1,this.particleLife=2e3,this.fadeFlag=!1,this.focus=null,this.focusAccel=null,this.startSize=null,this.endSize=null,this.minSize=5,this.maxSize=5,this.beginColor=G.White,this.endColor=G.White,this._sprite=null,this.emitterType=Cn.Rectangle,this.radius=0,this.particleRotationalVelocity=0,this.randomRotation=!1,this.particleTransform=Sn.Global;const{x:a,y:h,z:d,pos:p,isEmitting:m,minVel:y,maxVel:w,acceleration:b,minAngle:R,maxAngle:k,emitRate:M,particleLife:z,opacity:X,fadeFlag:N,focus:U,focusAccel:Y,startSize:H,endSize:tt,minSize:gt,maxSize:$,beginColor:mt,endColor:Bt,particleSprite:le,emitterType:Ne,radius:Ue,particleRotationalVelocity:ze,particleTransform:Re,randomRotation:ge,random:me}={...t};this.pos=p??B(a??0,h??0),this.z=d??0,this.isEmitting=m??this.isEmitting,this.minVel=y??this.minVel,this.maxVel=w??this.maxVel,this.acceleration=b??this.acceleration,this.minAngle=R??this.minAngle,this.maxAngle=k??this.maxAngle,this.emitRate=M??this.emitRate,this.particleLife=z??this.particleLife,this.opacity=X??this.opacity,this.fadeFlag=N??this.fadeFlag,this.focus=U??this.focus,this.focusAccel=Y??this.focusAccel,this.startSize=H??this.startSize,this.endSize=tt??this.endSize,this.minSize=gt??this.minSize,this.maxSize=$??this.maxSize,this.beginColor=mt??this.beginColor,this.endColor=Bt??this.endColor,this.particleSprite=le??this.particleSprite,this.emitterType=Ne??this.emitterType,this.radius=Ue??this.radius,this.particleRotationalVelocity=ze??this.particleRotationalVelocity,this.randomRotation=ge??this.randomRotation,this.particleTransform=Re??this.particleTransform,this.body.collisionType=ft.PreventCollision,this.random=me??new A}removeParticle(t){this.deadParticles.push(t)}emitParticles(t){var i;for(let n=0;n<t;n++){const a=this._createParticle();this.particles.push(a),!((i=this===null||this===void 0?void 0:this.scene)===null||i===void 0)&&i.world&&(this.particleTransform===Sn.Global?this.scene.world.add(a):this.addChild(a))}}clearParticles(){this.particles.length=0}_createParticle(){let t=0,i=0;const n=j(this.minAngle,this.maxAngle,this.random),a=j(this.minVel,this.maxVel,this.random),h=this.startSize||j(this.minSize,this.maxSize,this.random),d=a*Math.cos(n),p=a*Math.sin(n);if(this.emitterType===Cn.Rectangle)t=j(0,this.width,this.random),i=j(0,this.height,this.random);else if(this.emitterType===Cn.Circle){const y=j(0,this.radius,this.random);t=y*Math.cos(n),i=y*Math.sin(n)}const m=new Jo(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new E(t,i),new E(d,p),this.acceleration,this.startSize,this.endSize,this.particleSprite);return m.fadeFlag=this.fadeFlag,m.particleSize=h,m.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(m.currentRotation=j(0,Math.PI*2,this.random)),this.focus&&(m.focus=this.focus.add(new E(this.pos.x,this.pos.y)),m.focusAccel=this.focusAccel),m}update(t,i){var n;super.update(t,i),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(i/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(let a=0;a<this.deadParticles.length;a++)lt(this.deadParticles[a],this.particles),!((n=this===null||this===void 0?void 0:this.scene)===null||n===void 0)&&n.world&&this.scene.world.remove(this.deadParticles[a],!1);this.deadParticles.length=0}}function Q0(u,t,i,n){if(u.parent!==t.parent){const w=u.clone(),b=u.globalPos.clone(),R=u.globalScale.clone(),k=u.globalRotation;w.parent=t.parent,w.globalPos=b,w.globalScale=R,w.globalRotation=k,u=w}let a=t.pos,h=t.scale,d=t.rotation;a=t.pos.scale(i).add(u.pos.scale(1-i)),h=t.scale.scale(i).add(u.scale.scale(1-i));const p=(1-i)*Math.cos(u.rotation)+i*Math.cos(t.rotation),m=(1-i)*Math.sin(u.rotation)+i*Math.sin(t.rotation);d=Math.atan2(m,p);const y=n??new Ls;return y.setTransform(a,d,h),y}class Tf extends oi{get sortedTransforms(){return this._sortedTransforms}constructor(t){super(),this.world=t,this.systemType=Oe.Draw,this.priority=Ii.Average,this._token=0,this._sortedTransforms=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0},this._targetInterpolationTransform=new Ls,this.query=this.world.query([it,ie]),this.query.entityAdded$.subscribe(i=>{const n=i.get(it);this._sortedTransforms.push(n),n.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}),this.query.entityRemoved$.subscribe(i=>{const n=i.get(it);n.zIndexChanged$.unsubscribe(this._zIndexUpdate);const a=this._sortedTransforms.indexOf(n);a>-1&&this._sortedTransforms.splice(a,1)})}initialize(t,i){this._camera=i.camera,this._engine=i.engine}preupdate(){this._graphicsContext=this._engine.graphicsContext,this._zHasChanged&&(this._sortedTransforms.sort((t,i)=>t.z-i.z),this._zHasChanged=!1)}update(t){this._token++;let i;Ct.checkAndClearCache(),this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext);for(const n of this._sortedTransforms){const a=n.owner;if(a.hasTag("ex.offscreen")||(i=a.get(ie),!i.visible))continue;i.onPreTransformDraw&&i.onPreTransformDraw(this._graphicsContext,t),a.events.emit("pretransformdraw",new Wl(this._graphicsContext,t,a)),n.coordPlane===te.Screen&&this._graphicsContext.restore(),this._graphicsContext.save(),n.coordPlane===te.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),i.update(t,this._token);const h=a.get(qo);if(h){const p=E.One.sub(h.parallaxFactor),m=this._camera.drawPos.scale(p);this._graphicsContext.translate(m.x,m.y)}this._applyTransform(a),i.material&&(this._graphicsContext.material=i.material),i.onPreDraw&&i.onPreDraw(this._graphicsContext,t),a.events.emit("predraw",new _n(this._graphicsContext,t,a));const d=a instanceof Jo?a.opacity:1;this._graphicsContext.opacity*=i.opacity*d,this._drawGraphicsComponent(i,n),i.onPostDraw&&i.onPostDraw(this._graphicsContext,t),a.events.emit("postdraw",new vn(this._graphicsContext,t,a)),this._graphicsContext.restore(),n.coordPlane===te.Screen&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext)),i.onPostTransformDraw&&i.onPostTransformDraw(this._graphicsContext,t),a.events.emit("posttransformdraw",new jl(this._graphicsContext,t,a))}this._graphicsContext.restore()}_drawGraphicsComponent(t,i){var n,a;if(t.visible){const h=t.flipHorizontal,d=t.flipVertical,p=t.current,m=(n=t.currentOptions)!==null&&n!==void 0?n:{};if(p){let y=t.anchor,w=t.offset,b=1,R=1;m!=null&&m.anchor&&(y=m.anchor),m!=null&&m.offset&&(w=m.offset);const k=i.globalScale;b*=p.scale.x*k.x,R*=p.scale.y*k.y;const M=-p.width*y.x+w.x*b,z=-p.height*y.y+w.y*R,X=p.flipHorizontal,N=p.flipVertical;if((h||d)&&(p.flipHorizontal=h?!X:X,p.flipVertical=d?!N:N),p==null||p.draw(this._graphicsContext,M,z),(h||d)&&(p.flipHorizontal=X,p.flipVertical=N),!((a=this._engine)===null||a===void 0)&&a.isDebug&&this._engine.debug.graphics.showBounds){const U=B(M,z);if(p instanceof wn)for(const Y of p.members){let H,tt=E.Zero;Y instanceof zt?H=Y:(H=Y.graphic,tt=Y.offset),p.useAnchor?H==null||H.localBounds.translate(U.add(tt)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor):H==null||H.localBounds.translate(tt).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}else p==null||p.localBounds.translate(U).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}}_applyTransform(t){const i=t.getAncestors();for(const n of i){const a=n==null?void 0:n.get(it),h=n==null?void 0:n.get(ct);let d=a.get();if(h&&this._engine.fixedUpdateFps&&h.__oldTransformCaptured&&h.enableFixedUpdateInterpolate){const p=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps);d=Q0(h.oldTransform,a.get(),p,this._targetInterpolationTransform)}a&&(this._graphicsContext.z=a.z,this._graphicsContext.translate(d.pos.x,d.pos.y),this._graphicsContext.scale(d.scale.x,d.scale.y),this._graphicsContext.rotate(d.rotation))}}}class Pf extends oi{constructor(t){super(),this.world=t,this.systemType=Oe.Draw,this.priority=Ii.Lowest,this.query=this.world.query([it])}initialize(t,i){this._graphicsContext=i.engine.graphicsContext,this._camera=i.camera,this._engine=i.engine,this._collisionSystem=t.systemManager.get(Ch)}update(){var t;if(!this._engine.isDebug)return;const i=this._engine.debug.filter;let n,a;const h=this._engine.debug.entity;let d;const p=this._engine.debug.transform;let m;const y=this._engine.debug.motion;let w;const b=this._engine.debug.collider,R=this._engine.debug.physics;let k;const M=this._engine.debug.graphics;let z,X;const N=this._engine.debug.body,U=this._engine.debug.camera;for(const Y of this.query.entities){if(Y.hasTag("offscreen")||Y instanceof Jo||i.useFilter&&(!(i.ids.length===0||i.ids.includes(Y.id))||!(i.nameQuery===""||Y.name.includes(i.nameQuery))))continue;let H=E.Zero;const tt=B(0,16);if(n=Y.id,a=Y.name,d=Y.get(it),this._pushCameraTransform(d),this._graphicsContext.save(),d.coordPlane===te.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),this._graphicsContext.z=p.debugZIndex,this._applyTransform(Y),d&&((p.showAll||p.showPosition)&&this._graphicsContext.debug.drawPoint(E.Zero,{size:4,color:p.positionColor}),(p.showAll||p.showPositionLabel)&&(this._graphicsContext.debug.drawText(`pos${d.pos.toString(2)}`,H),H=H.add(tt)),(p.showAll||p.showZIndex)&&(this._graphicsContext.debug.drawText(`z(${d.z.toFixed(1)})`,H),H=H.add(tt)),(h.showAll||h.showId)&&(this._graphicsContext.debug.drawText(`id(${n}) ${Y.parent?"child of id("+((t=Y.parent)===null||t===void 0?void 0:t.id)+")":""}`,H),H=H.add(tt)),(h.showAll||h.showName)&&(this._graphicsContext.debug.drawText(`name(${a})`,H),H=H.add(tt)),(p.showAll||p.showRotation)&&(this._graphicsContext.drawLine(E.Zero,E.fromAngle(d.rotation).scale(50).add(E.Zero),p.rotationColor,2),this._graphicsContext.debug.drawText(`rot deg(${P(d.rotation).toFixed(2)})`,H),H=H.add(tt)),(p.showAll||p.showScale)&&this._graphicsContext.drawLine(E.Zero,d.scale.add(E.Zero),p.scaleColor,2)),k=Y.get(ie),k&&(M.showAll||M.showBounds)&&k.localBounds.draw(this._graphicsContext,M.boundsColor),z=Y.get(Zo),z&&(z.useTransform||this._graphicsContext.restore(),z.draw(this._graphicsContext,this._engine.debug),z.useTransform||(this._graphicsContext.save(),this._applyTransform(Y))),X=Y.get(ct),X&&((N.showAll||N.showCollisionGroup)&&(this._graphicsContext.debug.drawText(`collision group(${X.group.name})`,H),H=H.add(tt)),(N.showAll||N.showCollisionType)&&(this._graphicsContext.debug.drawText(`collision type(${X.collisionType})`,H),H=H.add(tt)),(N.showAll||N.showMass)&&(this._graphicsContext.debug.drawText(`mass(${X.mass})`,H),H=H.add(tt)),(N.showAll||N.showMotion)&&(this._graphicsContext.debug.drawText(`motion(${X.sleepMotion})`,H),H=H.add(tt)),(N.showAll||N.showSleeping)&&(this._graphicsContext.debug.drawText(`sleeping(${X.canSleep?X.sleeping:"cant sleep"})`,H),H=H.add(tt))),this._graphicsContext.restore(),this._graphicsContext.save(),d.coordPlane===te.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),this._graphicsContext.z=p.debugZIndex,m=Y.get(Ft),m&&((y.showAll||y.showVelocity)&&(this._graphicsContext.debug.drawText(`vel${m.vel.toString(2)}`,H.add(d.globalPos)),this._graphicsContext.drawLine(d.globalPos,d.globalPos.add(m.vel),y.velocityColor,2),H=H.add(tt)),(y.showAll||y.showAcceleration)&&this._graphicsContext.drawLine(d.globalPos,d.globalPos.add(m.acc),y.accelerationColor,2)),w=Y.get(jt),w){const gt=w.get();if((b.showAll||b.showGeometry)&&gt&&gt.debug(this._graphicsContext,b.geometryColor,{lineWidth:b.geometryLineWidth,pointSize:b.geometryPointSize}),b.showAll||b.showBounds){if(gt instanceof ue){const $=gt.getColliders();for(const mt of $){const Bt=mt.bounds,le=B(Bt.left,Bt.top);this._graphicsContext.debug.drawRect(le.x,le.y,Bt.width,Bt.height,{color:b.boundsColor}),(b.showAll||b.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${mt.owner.id})`,le)}w.bounds.draw(this._graphicsContext,b.boundsColor)}else if(gt){const $=w.bounds,mt=B($.left,$.top);this._graphicsContext.debug.drawRect(mt.x,mt.y,$.width,$.height,{color:b.boundsColor}),(b.showAll||b.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${w.owner.id})`,mt)}}}this._graphicsContext.restore(),this._popCameraTransform(d)}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(R.showAll||R.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),R.showAll||R.showCollisionContacts||R.showCollisionNormals)for(const[Y,H]of this._engine.debug.stats.currFrame.physics.contacts){if(R.showAll||R.showCollisionContacts)for(const tt of H.points)this._graphicsContext.debug.drawPoint(tt,{size:R.contactSize,color:R.collisionContactColor});if(R.showAll||R.showCollisionNormals)for(const tt of H.points)this._graphicsContext.debug.drawLine(tt,H.normal.scale(30).add(tt),{color:R.collisionNormalColor})}this._graphicsContext.restore(),U&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(U.showAll||U.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,U.focusColor),(U.showAll||U.showZoom)&&this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`,this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}postupdate(t,i){this._engine.isDebug&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext),ee.flush(this._graphicsContext),this._graphicsContext.restore())}_applyTransform(t){const i=t.getAncestors();for(const n of i){const a=n==null?void 0:n.get(it);a&&(this._graphicsContext.translate(a.pos.x,a.pos.y),this._graphicsContext.scale(a.scale.x,a.scale.y),this._graphicsContext.rotate(a.rotation))}}_pushCameraTransform(t){t.coordPlane===te.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}_popCameraTransform(t){t.coordPlane===te.World&&this._graphicsContext.restore()}}class ta extends oi{constructor(t){super(),this.world=t,this.systemType=Oe.Update,this.priority=Ii.Higher,this.overrideUseColliderShape=!1,this.overrideUseGraphicsBounds=!1,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map,this._sortedTransforms=[],this._sortedEntities=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0},this.query=this.world.query([it,Ri]),this.query.entityAdded$.subscribe(i=>{const n=i.get(it);this._sortedTransforms.push(n),this._sortedEntities.push(n.owner),n.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}),this.query.entityRemoved$.subscribe(i=>{const n=i.get(it);n.zIndexChanged$.unsubscribe(this._zIndexUpdate);const a=this._sortedTransforms.indexOf(n);a>-1&&(this._sortedTransforms.splice(a,1),this._sortedEntities.splice(a,1))})}initialize(t,i){this._engine=i.engine,this._scene=i}preupdate(){this._receivers=[this._engine.input.pointers,this._scene.input.pointers],this._engineReceiver=this._engine.input.pointers,this._zHasChanged&&(this._sortedTransforms.sort((t,i)=>i.z-t.z),this._sortedEntities=this._sortedTransforms.map(t=>t.owner),this._zHasChanged=!1)}entityCurrentlyUnderPointer(t,i){return this.currentFrameEntityToPointers.has(t.id)&&this.currentFrameEntityToPointers.get(t.id).includes(i)}entityWasUnderPointer(t,i){return this.lastFrameEntityToPointers.has(t.id)&&this.lastFrameEntityToPointers.get(t.id).includes(i)}entered(t,i){return this.entityCurrentlyUnderPointer(t,i)&&!this.lastFrameEntityToPointers.has(t.id)}left(t,i){return!this.currentFrameEntityToPointers.has(t.id)&&this.entityWasUnderPointer(t,i)}addPointerToEntity(t,i){if(!this.currentFrameEntityToPointers.has(t.id)){this.currentFrameEntityToPointers.set(t.id,[i]);return}const n=this.currentFrameEntityToPointers.get(t.id);this.currentFrameEntityToPointers.set(t.id,n.concat(i))}update(){this._processPointerToEntity(this._sortedEntities),this._dispatchEvents(this._sortedEntities),this._receivers.forEach(t=>t.update()),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear(),this._receivers.forEach(t=>t.clear())}_processPointerToEntity(t){var i;let n,a,h,d;const p=this._engineReceiver;for(const m of t){if(n=m.get(it),d=(i=m.get(Ri))!==null&&i!==void 0?i:new Ri,d.localBounds){const y=d.localBounds.transform(n.get().matrix);for(const[w,b]of p.currentFramePointerCoords.entries())y.contains(n.coordPlane===te.World?b.worldPos:b.screenPos)&&this.addPointerToEntity(m,w)}if(a=m.get(jt),a&&(d.useColliderShape||this.overrideUseColliderShape)){a.update();const y=a.get();if(y)for(const[w,b]of p.currentFramePointerCoords.entries())y.contains(n.coordPlane===te.World?b.worldPos:b.screenPos)&&this.addPointerToEntity(m,w)}if(h=m.get(ie),h&&(d.useGraphicsBounds||this.overrideUseGraphicsBounds)){const y=h.localBounds.transform(n.get().matrix);for(const[w,b]of p.currentFramePointerCoords.entries())y.contains(n.coordPlane===te.World?b.worldPos:b.screenPos)&&this.addPointerToEntity(m,w)}}}_processDownAndEmit(t){const i=this._engineReceiver,n=new Map;for(const a of i.currentFrameDown)a.active&&t.active&&this.entityCurrentlyUnderPointer(t,a.pointerId)&&(t.events.emit("pointerdown",a),i.isDragStart(a.pointerId)&&t.events.emit("pointerdragstart",a)),n.set(a.pointerId,a);return n}_processUpAndEmit(t){const i=this._engineReceiver,n=new Map;for(const a of i.currentFrameUp)a.active&&t.active&&this.entityCurrentlyUnderPointer(t,a.pointerId)&&(t.events.emit("pointerup",a),i.isDragEnd(a.pointerId)&&t.events.emit("pointerdragend",a)),n.set(a.pointerId,a);return n}_processMoveAndEmit(t){const i=this._engineReceiver,n=new Map;for(const a of i.currentFrameMove)a.active&&t.active&&this.entityCurrentlyUnderPointer(t,a.pointerId)&&(t.events.emit("pointermove",a),i.isDragging(a.pointerId)&&t.events.emit("pointerdragmove",a)),n.set(a.pointerId,a);return n}_processEnterLeaveAndEmit(t,i){const n=this._engineReceiver;for(const a of i){if(a.active&&t.active&&this.entered(t,a.pointerId)){t.events.emit("pointerenter",a),n.isDragging(a.pointerId)&&t.events.emit("pointerdragenter",a);break}if(a.active&&t.active&&(this.left(t,a.pointerId)||this.entityCurrentlyUnderPointer(t,a.pointerId)&&a.type==="up")){t.events.emit("pointerleave",a),n.isDragging(a.pointerId)&&t.events.emit("pointerdragleave",a);break}}}_processCancelAndEmit(t){const i=this._engineReceiver;for(const n of i.currentFrameCancel)n.active&&t.active&&this.entityCurrentlyUnderPointer(t,n.pointerId)&&t.events.emit("pointercancel",n)}_processWheelAndEmit(t){const i=this._engineReceiver;for(const n of i.currentFrameWheel)n.active&&t.active&&this.entityCurrentlyUnderPointer(t,0)&&t.events.emit("pointerwheel",n)}_dispatchEvents(t){const i=new Set(this.lastFrameEntityToPointers.keys()),n=new Set(this.currentFrameEntityToPointers.keys()),a=t.filter(m=>i.has(m.id)||n.has(m.id));let h,d,p;for(const m of a){p=this._processDownAndEmit(m),d=this._processUpAndEmit(m),h=this._processMoveAndEmit(m);const y=[...h.values(),...p.values(),...d.values()];this._processEnterLeaveAndEmit(m,y),this._processCancelAndEmit(m),this._processWheelAndEmit(m)}}}class Rf extends oi{constructor(t){super(),this.world=t,this.systemType=Oe.Update,this.priority=Ii.Higher,this._actions=[],this.query=this.world.query([xn]),this.query.entityAdded$.subscribe(i=>this._actions.push(i.get(xn))),this.query.entityRemoved$.subscribe(i=>{const n=i.get(xn),a=this._actions.indexOf(n);a>-1&&this._actions.splice(a,1)})}update(t){for(const i of this._actions)i.update(t)}}class Sr extends pi{constructor(t){super(),this.elevation=0,this.columns=t.columns,this.rows=t.rows,this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight}}class If extends oi{constructor(t){super(),this.world=t,this.systemType=Oe.Update,this.priority=Ii.Lower,this.query=this.world.query([it,Sr])}update(){let t,i;for(const n of this.query.entities){t=n.get(it),i=n.get(Sr);const h=Math.max(i.columns*i.tileWidth,i.rows*i.tileHeight)*i.elevation+t.pos.y;t.z=h}}}class Df extends oi{constructor(t){super(),this.world=t,this.systemType=Oe.Draw,this.priority=Ii.Higher,this.query=this.world.query([it,ie])}initialize(t,i){this._camera=i.camera,this._screen=i.engine.screen}update(){this._worldBounds=this._screen.getWorldBounds();let t,i,n;for(const a of this.query.entities){i=a.get(ie),t=a.get(it),n=a.get(qo);let h;if(n){const p=E.One.sub(n.parallaxFactor);h=this._camera.pos.scale(p)}const d=this._isOffscreen(t,i,h);d&&!a.hasTag("ex.offscreen")&&(a.events.emit("exitviewport",new ih(a)),a.addTag("ex.offscreen")),!d&&a.hasTag("ex.offscreen")&&(a.events.emit("enterviewport",new sh(a)),a.removeTag("ex.offscreen"))}}_isOffscreen(t,i,n){if(t.coordPlane===te.World){let a=i.localBounds;n&&(a=a.translate(n));const h=a.transform(t.get().matrix);return!this._worldBounds.overlaps(h)}else return!1}}class kf{get config(){return i0(this._config,t=>{this.$configUpdate.notifyAll(t)})}set config(t){this._config=t,this.$configUpdate.notifyAll(t)}get collisionProcessor(){if(this._configDirty){this._configDirty=!1;const t=this._collisionProcessor.getColliders();this._collisionProcessor=new zo(this._config);for(const i of t)this._collisionProcessor.track(i)}return this._collisionProcessor}constructor(t){this.$configUpdate=new we,this._configDirty=!1,this.config=t,this.$configUpdate.subscribe(i=>{this._configDirty=!0,ct.updateDefaultPhysicsConfig(i.bodies)}),this._collisionProcessor=new zo(this.config)}rayCast(t,i){return this.collisionProcessor.rayCast(t,i)}}class Er{constructor(){this.events=new v,this.enabled=!1,this.supported=!!navigator.getGamepads,this._gamePadTimeStamps=[0,0,0,0],this._oldPads=[],this._pads=[],this._initSuccess=!1,this._navigator=navigator,this._minimumConfiguration=null,this._enabled=!0}init(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}toggleEnabled(t){this._enabled=t}setMinimumGamepadConfiguration(t){this._enableAndUpdate(),this._minimumConfiguration=t}_enableAndUpdate(){this.enabled||(this.enabled=!0,this.update())}_isGamepadValid(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;const i=t.axes.filter(a=>typeof a!==void 0).length,n=t.buttons.filter(a=>typeof a!==void 0).length;return i>=this._minimumConfiguration.axis&&n>=this._minimumConfiguration.buttons&&t.connected}emit(t,i){this.events.emit(t,i)}on(t,i){return this._enableAndUpdate(),this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this._enableAndUpdate(),this.events.off(t,i)}update(){if(!this.enabled||!this.supported||!this._enabled)return;this.init();const t=this._navigator.getGamepads();for(let i=0;i<t.length;i++){if(t[i])!this.at(i).connected&&this._isGamepadValid(t[i])&&this.events.emit("connect",new $l(i,this.at(i))),this.at(i).connected=!0;else{const m=this.at(i);m.connected&&this.events.emit("disconnect",new Ql(i,m)),m.connected=!1;continue}if(this.at(i).update(),t[i].timestamp&&t[i].timestamp===this._gamePadTimeStamps[i])continue;this._gamePadTimeStamps[i]=t[i].timestamp,this.at(i).navigatorGamepad=t[i];let n,a,h,d,p;for(n in En)a=En[n],typeof a=="number"&&t[i].buttons[a]&&(p=t[i].buttons[a].value,p!==this._oldPads[i].getButton(a)&&(t[i].buttons[a].pressed?(this.at(i).updateButton(a,p),this.at(i).events.emit("button",new ql(a,p,this.at(i)))):this.at(i).updateButton(a,0)));for(h in An)d=An[h],typeof d=="number"&&(p=t[i].axes[d],p!==this._oldPads[i].getAxes(d)&&(this.at(i).updateAxes(d,p),this.at(i).events.emit("axis",new Zl(d,p,this.at(i)))));this._oldPads[i]=this._clonePad(t[i])}}at(t){if(this._enableAndUpdate(),t>=this._pads.length)for(let i=this._pads.length-1,n=t;i<n;i++)this._pads.push(new Ar),this._oldPads.push(new Ar);return this._pads[t]}getValidGamepads(){this._enableAndUpdate();const t=[];for(let i=0;i<this._pads.length;i++)this._isGamepadValid(this.at(i).navigatorGamepad)&&this.at(i).connected&&t.push(this.at(i));return t}count(){return this._pads.filter(t=>t.connected).length}_clonePads(t){const i=[];for(let n=0,a=t.length;n<a;n++)i.push(this._clonePad(t[n]));return i}_clonePad(t){let i,n;const a=new Ar;if(!t)return a;for(i=0,n=t.buttons.length;i<n;i++)t.buttons[i]&&a.updateButton(i,t.buttons[i].value);for(i=0,n=t.axes.length;i<n;i++)a.updateAxes(i,t.axes[i]);return a}}Er.MinAxisMoveThreshold=.05;class Ar{constructor(){this.events=new v,this.connected=!1,this._axes=new Array(4),this._buttons=new Array(16),this._buttonsUp=new Array(16),this._buttonsDown=new Array(16);for(let t=0;t<this._buttons.length;t++)this._buttons[t]=0;for(let t=0;t<this._axes.length;t++)this._axes[t]=0}update(){this._buttonsDown=new Array(16),this._buttonsUp=new Array(16)}isButtonPressed(t,i=1){return this._buttons[t]>=i}isButtonHeld(t,i=1){return this._buttons[t]>=i}wasButtonPressed(t,i=1){return this._buttonsDown[t]>=i}wasButtonReleased(t){return!!this._buttonsUp[t]}getButton(t){return this._buttons[t]}getAxes(t){const i=this._axes[t];return Math.abs(i)<Er.MinAxisMoveThreshold?0:i}updateButton(t,i){i===0&&this._buttons[t]?this._buttonsUp[t]=1:this._buttonsDown[t]=i,this._buttons[t]=i}updateAxes(t,i){this._axes[t]=i}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}var En;(function(u){u[u.Face1=0]="Face1",u[u.Face2=1]="Face2",u[u.Face3=2]="Face3",u[u.Face4=3]="Face4",u[u.LeftBumper=4]="LeftBumper",u[u.RightBumper=5]="RightBumper",u[u.LeftTrigger=6]="LeftTrigger",u[u.RightTrigger=7]="RightTrigger",u[u.Select=8]="Select",u[u.Start=9]="Start",u[u.LeftStick=10]="LeftStick",u[u.RightStick=11]="RightStick",u[u.DpadUp=12]="DpadUp",u[u.DpadDown=13]="DpadDown",u[u.DpadLeft=14]="DpadLeft",u[u.DpadRight=15]="DpadRight"})(En||(En={}));var An;(function(u){u[u.LeftStickX=0]="LeftStickX",u[u.LeftStickY=1]="LeftStickY",u[u.RightStickX=2]="RightStickX",u[u.RightStickY=3]="RightStickY"})(An||(An={}));class Ff{constructor(t){this.inputs=t,this._handlers=new Map}execute(){for(const[t,i]of this._handlers.entries()){const n=t(this.inputs);n&&i(n)}}on(t,i){this._handlers.set(t,i)}}function Bf(){try{const u=()=>{};window.top.addEventListener("blur",u),window.top.removeEventListener("blur",u)}catch{return!0}return!1}var Tn;(function(u){u.Num0="Numpad0",u.Num1="Numpad1",u.Num2="Numpad2",u.Num3="Numpad3",u.Num4="Numpad4",u.Num5="Numpad5",u.Num6="Numpad6",u.Num7="Numpad7",u.Num8="Numpad8",u.Num9="Numpad9",u.NumAdd="NumpadAdd",u.NumSubtract="NumpadSubtract",u.NumMultiply="NumpadMultiply",u.NumDivide="NumpadDivide",u.NumDecimal="NumpadDecimal",u.Numpad0="Numpad0",u.Numpad1="Numpad1",u.Numpad2="Numpad2",u.Numpad3="Numpad3",u.Numpad4="Numpad4",u.Numpad5="Numpad5",u.Numpad6="Numpad6",u.Numpad7="Numpad7",u.Numpad8="Numpad8",u.Numpad9="Numpad9",u.NumpadAdd="NumpadAdd",u.NumpadSubtract="NumpadSubtract",u.NumpadMultiply="NumpadMultiply",u.NumpadDivide="NumpadDivide",u.NumpadDecimal="NumpadDecimal",u.NumLock="NumLock",u.ShiftLeft="ShiftLeft",u.ShiftRight="ShiftRight",u.AltLeft="AltLeft",u.AltRight="AltRight",u.ControlLeft="ControlLeft",u.ControlRight="ControlRight",u.MetaLeft="MetaLeft",u.MetaRight="MetaRight",u.Key0="Digit0",u.Key1="Digit1",u.Key2="Digit2",u.Key3="Digit3",u.Key4="Digit4",u.Key5="Digit5",u.Key6="Digit6",u.Key7="Digit7",u.Key8="Digit8",u.Key9="Digit9",u.Digit0="Digit0",u.Digit1="Digit1",u.Digit2="Digit2",u.Digit3="Digit3",u.Digit4="Digit4",u.Digit5="Digit5",u.Digit6="Digit6",u.Digit7="Digit7",u.Digit8="Digit8",u.Digit9="Digit9",u.F1="F1",u.F2="F2",u.F3="F3",u.F4="F4",u.F5="F5",u.F6="F6",u.F7="F7",u.F8="F8",u.F9="F9",u.F10="F10",u.F11="F11",u.F12="F12",u.A="KeyA",u.B="KeyB",u.C="KeyC",u.D="KeyD",u.E="KeyE",u.F="KeyF",u.G="KeyG",u.H="KeyH",u.I="KeyI",u.J="KeyJ",u.K="KeyK",u.L="KeyL",u.M="KeyM",u.N="KeyN",u.O="KeyO",u.P="KeyP",u.Q="KeyQ",u.R="KeyR",u.S="KeyS",u.T="KeyT",u.U="KeyU",u.V="KeyV",u.W="KeyW",u.X="KeyX",u.Y="KeyY",u.Z="KeyZ",u.KeyA="KeyA",u.KeyB="KeyB",u.KeyC="KeyC",u.KeyD="KeyD",u.KeyE="KeyE",u.KeyF="KeyF",u.KeyG="KeyG",u.KeyH="KeyH",u.KeyI="KeyI",u.KeyJ="KeyJ",u.KeyK="KeyK",u.KeyL="KeyL",u.KeyM="KeyM",u.KeyN="KeyN",u.KeyO="KeyO",u.KeyP="KeyP",u.KeyQ="KeyQ",u.KeyR="KeyR",u.KeyS="KeyS",u.KeyT="KeyT",u.KeyU="KeyU",u.KeyV="KeyV",u.KeyW="KeyW",u.KeyX="KeyX",u.KeyY="KeyY",u.KeyZ="KeyZ",u.Semicolon="Semicolon",u.Quote="Quote",u.Comma="Comma",u.Minus="Minus",u.Period="Period",u.Slash="Slash",u.Equal="Equal",u.BracketLeft="BracketLeft",u.Backslash="Backslash",u.BracketRight="BracketRight",u.Backquote="Backquote",u.Up="ArrowUp",u.Down="ArrowDown",u.Left="ArrowLeft",u.Right="ArrowRight",u.ArrowUp="ArrowUp",u.ArrowDown="ArrowDown",u.ArrowLeft="ArrowLeft",u.ArrowRight="ArrowRight",u.Space="Space",u.Backspace="Backspace",u.Delete="Delete",u.Esc="Escape",u.Escape="Escape",u.Enter="Enter",u.NumpadEnter="NumpadEnter",u.ContextMenu="ContextMenu"})(Tn||(Tn={}));class Pn extends _t{constructor(t,i,n){super(),this.key=t,this.value=i,this.originalEvent=n}}class Sh{constructor(){this.events=new v,this._enabled=!0,this._keys=[],this._keysUp=[],this._keysDown=[],this._releaseAllKeys=t=>{for(const i of this._keys){const n=new Pn(i,t.key,t);this.events.emit("up",n),this.events.emit("release",n)}this._keysUp=Array.from(new Set(this._keys.concat(this._keysUp))),this._keys.length=0},this._handleKeyDown=t=>{if(!this._enabled)return;!t.metaKey&&(this._keys.includes(Tn.MetaLeft)||this._keys.includes(Tn.MetaRight))&&this._releaseAllKeys(t);const i=t.code;if(this._keys.indexOf(i)===-1){this._keys.push(i),this._keysDown.push(i);const n=new Pn(i,t.key,t);this.events.emit("down",n),this.events.emit("press",n)}},this._handleKeyUp=t=>{if(!this._enabled)return;const i=t.code,n=this._keys.indexOf(i);this._keys.splice(n,1),this._keysUp.push(i);const a=new Pn(i,t.key,t);this.events.emit("up",a),this.events.emit("release",a),t.key==="Meta"&&this._releaseAllKeys(t)}}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}init(t){let{global:i}=t;const{grabWindowFocus:n}=t;i||(Bf()?(i=window,n&&window.focus(),J.getInstance().warn("Excalibur might be in a cross-origin iframe, in order to receive keyboard events it must be in focus")):i=window.top),i.addEventListener("blur",()=>{this._keys.length=0}),i.addEventListener("keyup",this._handleKeyUp),i.addEventListener("keydown",this._handleKeyDown)}toggleEnabled(t){this._enabled=t}update(){this._keysDown.length=0,this._keysUp.length=0;for(let t=0;t<this._keys.length;t++)this.events.emit("hold",new Pn(this._keys[t]))}getKeys(){return this._keys}wasPressed(t){return this._keysDown.indexOf(t)>-1}isHeld(t){return this._keys.indexOf(t)>-1}wasReleased(t){return this._keysUp.indexOf(t)>-1}triggerEvent(t,i,n){t==="down"&&this._handleKeyDown(new KeyboardEvent("keydown",{code:i,key:n??null})),t==="up"&&this._handleKeyUp(new KeyboardEvent("keyup",{code:i,key:n??null}))}}class Tr{static fromPagePosition(t,i,n){let a,h,d,p;arguments.length===3?(a=t,h=i,d=new E(a,h),p=n):(d=t,a=d.x,h=d.y,p=i);const m=p.screen.pageToScreenCoordinates(d),y=p.screen.screenToWorldCoordinates(m);return new Tr(y,d,m)}constructor(t,i,n){this.worldPos=t,this.pagePos=i,this.screenPos=n}}class Rn{cancel(){this.active=!1}get pagePos(){return this.coordinates.pagePos}get screenPos(){return this.coordinates.screenPos}get worldPos(){return this.coordinates.worldPos}constructor(t,i,n,a,h,d){this.type=t,this.pointerId=i,this.button=n,this.pointerType=a,this.coordinates=h,this.nativeEvent=d,this.active=!0}}class Eh{cancel(){this.active=!1}constructor(t,i,n,a,h,d,p,m,y,w,b,R){this.x=t,this.y=i,this.pageX=n,this.pageY=a,this.screenX=h,this.screenY=d,this.index=p,this.deltaX=m,this.deltaY=y,this.deltaZ=w,this.deltaMode=b,this.ev=R,this.active=!0}}class Ah{constructor(){this.events=new v,this.lastPagePos=E.Zero,this.lastScreenPos=E.Zero,this.lastWorldPos=E.Zero,this._onPointerMove=t=>{this.lastPagePos=new E(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new E(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new E(t.worldPos.x,t.worldPos.y)},this._onPointerDown=t=>{this.lastPagePos=new E(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new E(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new E(t.worldPos.x,t.worldPos.y)},this.on("move",this._onPointerMove),this.on("down",this._onPointerDown)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}}var Ws;(function(u){u.Pixel="Pixel",u.Line="Line",u.Page="Page"})(Ws||(Ws={}));var Vi;(function(u){u[u.NoButton=-1]="NoButton",u[u.Left=0]="Left",u[u.Middle=1]="Middle",u[u.Right=2]="Right",u[u.Unknown=3]="Unknown"})(Vi||(Vi={}));var Di;(function(u){u.Left="Left",u.Middle="Middle",u.Right="Right",u.Unknown="Unknown",u.NoButton="NoButton"})(Di||(Di={}));var ki;(function(u){u.Touch="Touch",u.Mouse="Mouse",u.Pen="Pen",u.Unknown="Unknown"})(ki||(ki={}));function q0(u){return globalThis.TouchEvent&&u instanceof globalThis.TouchEvent}function Z0(u){return globalThis.PointerEvent&&u instanceof globalThis.PointerEvent}class Pr{constructor(t,i){this.target=t,this.engine=i,this.events=new v,this.primary=new Ah,this._activeNativePointerIdsToNormalized=new Map,this.lastFramePointerCoords=new Map,this.currentFramePointerCoords=new Map,this.currentFramePointerDown=new Map,this.lastFramePointerDown=new Map,this.currentFrameDown=[],this.currentFrameUp=[],this.currentFrameMove=[],this.currentFrameCancel=[],this.currentFrameWheel=[],this._enabled=!0,this._pointers=[this.primary],this._boundHandle=this._handle.bind(this),this._boundWheel=this._handleWheel.bind(this)}toggleEnabled(t){this._enabled=t}recreate(t,i){const n=new Pr(t,i);return n.primary=this.primary,n._pointers=this._pointers,n}at(t){if(t>=this._pointers.length)for(let i=this._pointers.length-1,n=t;i<n;i++)this._pointers.push(new Ah);return this._pointers[t]}count(){return this._pointers.length}isDown(t){var i;return(i=this.currentFramePointerDown.get(t))!==null&&i!==void 0?i:!1}wasDown(t){var i;return(i=this.lastFramePointerDown.get(t))!==null&&i!==void 0?i:!1}isDragging(t){return this.isDown(t)}isDragStart(t){return this.isDown(t)&&!this.wasDown(t)}isDragEnd(t){return!this.isDown(t)&&this.wasDown(t)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}update(){this.lastFramePointerDown=new Map(this.currentFramePointerDown),this.lastFramePointerCoords=new Map(this.currentFramePointerCoords);for(const t of this.currentFrameDown)this.emit("down",t),this.at(t.pointerId).emit("down",t),this.primary.emit("pointerdown",t);for(const t of this.currentFrameUp)this.emit("up",t),this.at(t.pointerId).emit("up",t);for(const t of this.currentFrameMove)this.emit("move",t),this.at(t.pointerId).emit("move",t);for(const t of this.currentFrameCancel)this.emit("cancel",t),this.at(t.pointerId).emit("cancel",t);for(const t of this.currentFrameWheel)this.emit("wheel",t),this.primary.emit("pointerwheel",t),this.primary.emit("wheel",t)}clear(){for(const t of this.currentFrameUp){this.currentFramePointerCoords.delete(t.pointerId);const i=this._activeNativePointerIdsToNormalized.entries();for(const[n,a]of i)a===t.pointerId&&this._activeNativePointerIdsToNormalized.delete(n)}this.currentFrameDown.length=0,this.currentFrameUp.length=0,this.currentFrameMove.length=0,this.currentFrameCancel.length=0,this.currentFrameWheel.length=0}init(t){var i;if(this.engine.isDisposed())return;this.target===this.engine.canvas?this.engine.canvas.style.touchAction="none":document.body.style.touchAction="none",window.PointerEvent?(this.target.addEventListener("pointerdown",this._boundHandle),this.target.addEventListener("pointerup",this._boundHandle),this.target.addEventListener("pointermove",this._boundHandle),this.target.addEventListener("pointercancel",this._boundHandle)):(this.target.addEventListener("touchstart",this._boundHandle),this.target.addEventListener("touchend",this._boundHandle),this.target.addEventListener("touchmove",this._boundHandle),this.target.addEventListener("touchcancel",this._boundHandle),this.target.addEventListener("mousedown",this._boundHandle),this.target.addEventListener("mouseup",this._boundHandle),this.target.addEventListener("mousemove",this._boundHandle));const n={passive:!(this.engine.pageScrollPreventionMode===rs.All||this.engine.pageScrollPreventionMode===rs.Canvas)};if("onwheel"in document.createElement("div")?this.target.addEventListener("wheel",this._boundWheel,n):document.onmousewheel!==void 0?this.target.addEventListener("mousewheel",this._boundWheel,n):this.target.addEventListener("MozMousePixelScroll",this._boundWheel,n),((i=t==null?void 0:t.grabWindowFocus)!==null&&i!==void 0?i:!0)&&Bf()){const h=()=>{window.focus()};window.PointerEvent?this.target.addEventListener("pointerdown",h):(this.target.addEventListener("touchstart",h),this.target.addEventListener("mousedown",h))}}detach(){window.PointerEvent?(this.target.removeEventListener("pointerdown",this._boundHandle),this.target.removeEventListener("pointerup",this._boundHandle),this.target.removeEventListener("pointermove",this._boundHandle),this.target.removeEventListener("pointercancel",this._boundHandle)):(this.target.removeEventListener("touchstart",this._boundHandle),this.target.removeEventListener("touchend",this._boundHandle),this.target.removeEventListener("touchmove",this._boundHandle),this.target.removeEventListener("touchcancel",this._boundHandle),this.target.removeEventListener("mousedown",this._boundHandle),this.target.removeEventListener("mouseup",this._boundHandle),this.target.removeEventListener("mousemove",this._boundHandle)),"onwheel"in document.createElement("div")?this.target.removeEventListener("wheel",this._boundWheel):document.onmousewheel!==void 0?this.target.addEventListener("mousewheel",this._boundWheel):this.target.addEventListener("MozMousePixelScroll",this._boundWheel)}_normalizePointerId(t){this._activeNativePointerIdsToNormalized.set(t,-1);const n=Array.from(this._activeNativePointerIdsToNormalized.keys()).sort((a,h)=>a-h).findIndex(a=>a===t);return this._activeNativePointerIdsToNormalized.set(t,n),n}_handle(t){if(!this._enabled)return;t.preventDefault();const i=new Map;let n,a;if(q0(t)){n=Di.Unknown,a=ki.Touch;for(let h=0;h<t.changedTouches.length;h++){const d=t.changedTouches[h],p=Tr.fromPagePosition(d.pageX,d.pageY,this.engine),m=h+1,y=this._normalizePointerId(m);this.currentFramePointerCoords.set(y,p),i.set(y,p)}}else{n=this._nativeButtonToPointerButton(t.button),a=ki.Mouse;const h=Tr.fromPagePosition(t.pageX,t.pageY,this.engine);let d=1;Z0(t)&&(d=t.pointerId,a=this._stringToPointerType(t.pointerType));const p=this._normalizePointerId(d);this.currentFramePointerCoords.set(p,h),i.set(p,h)}for(const[h,d]of i.entries())switch(t.type){case"mousedown":case"pointerdown":case"touchstart":this.currentFrameDown.push(new Rn("down",h,n,a,d,t)),this.currentFramePointerDown.set(h,!0);break;case"mouseup":case"pointerup":case"touchend":this.currentFrameUp.push(new Rn("up",h,n,a,d,t)),this.currentFramePointerDown.set(h,!1);break;case"mousemove":case"pointermove":case"touchmove":this.currentFrameMove.push(new Rn("move",h,n,a,d,t));break;case"touchcancel":case"pointercancel":this.currentFrameCancel.push(new Rn("cancel",h,n,a,d,t));break}}_handleWheel(t){if(!this._enabled)return;(this.engine.pageScrollPreventionMode===rs.All||this.engine.pageScrollPreventionMode===rs.Canvas&&t.target===this.engine.canvas)&&t.preventDefault();const i=this.engine.screen.pageToScreenCoordinates(B(t.pageX,t.pageY)),n=this.engine.screen.screenToWorldCoordinates(i),a=-1/40,h=t.deltaX||t.wheelDeltaX*a||0,d=t.deltaY||t.wheelDeltaY*a||t.wheelDelta*a||t.detail||0,p=t.deltaZ||0;let m=Ws.Pixel;t.deltaMode&&(t.deltaMode===1?m=Ws.Line:t.deltaMode===2&&(m=Ws.Page));const y=new Eh(n.x,n.y,t.pageX,t.pageY,i.x,i.y,0,h,d,p,m,t);this.currentFrameWheel.push(y)}triggerEvent(t,i){const n=this.engine.screen.worldToPageCoordinates(i);window.PointerEvent?this._handle(new window.PointerEvent("pointer"+t,{pointerId:0,clientX:n.x,clientY:n.y})):this._handle(new window.MouseEvent("mouse"+t,{clientX:n.x,clientY:n.y}));const a=this.engine.currentScene.world.get(ta);a.preupdate(this.engine.currentScene,1),a.update(1)}_nativeButtonToPointerButton(t){switch(t){case Vi.NoButton:return Di.NoButton;case Vi.Left:return Di.Left;case Vi.Middle:return Di.Middle;case Vi.Right:return Di.Right;case Vi.Unknown:return Di.Unknown;default:return Et(t)}}_stringToPointerType(t){switch(t){case"touch":return ki.Touch;case"mouse":return ki.Mouse;case"pen":return ki.Pen;default:return ki.Unknown}}}class Th{constructor(t){this._enabled=!0;const{pointerTarget:i,grabWindowFocus:n,engine:a}=t;this.keyboard=new Sh,this.pointers=new Pr(i,a),this.gamepads=new Er,this.keyboard.init({grabWindowFocus:n}),this.pointers.init({grabWindowFocus:n}),this.gamepads.init(),this.inputMapper=new Ff({keyboard:this.keyboard,pointers:this.pointers,gamepads:this.gamepads})}get enabled(){return this._enabled}toggleEnabled(t){this._enabled=t,this.keyboard.toggleEnabled(this._enabled),this.pointers.toggleEnabled(this._enabled),this.gamepads.toggleEnabled(this._enabled)}update(){this._enabled&&(this.inputMapper.execute(),this.keyboard.update(),this.gamepads.update())}}class K0{}const J0={Initialize:"initialize",Activate:"activate",Deactivate:"deactivate",PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw",PreDebugDraw:"predebugdraw",PostDebugDraw:"postdebugdraw",PreLoad:"preload"};function Fi(u){var t,i;return!!(u!=null&&u.prototype)&&!!(!((i=(t=u==null?void 0:u.prototype)===null||t===void 0?void 0:t.constructor)===null||i===void 0)&&i.name)}class qe{get actors(){return this.world.entityManager.entities.filter(t=>t instanceof Le)}get entities(){return this.world.entityManager.entities}get triggers(){return this.world.entityManager.entities.filter(t=>t instanceof _f)}get tileMaps(){return this.world.entityManager.entities.filter(t=>t instanceof lf)}get timers(){return this._timers}constructor(){this._logger=J.getInstance(),this.events=new v,this.camera=new mf,this.world=new bf(this),this.physics=new kf(Ai),this._isInitialized=!1,this._timers=[],this._cancelQueue=[],this.world.add(Rf),this.world.add(new Cf(this.world,this.physics)),this.world.add(new Ch(this.world,this.physics)),this.world.add(ta),this.world.add(If),this.world.add(Df),this.world.add(Tf),this.world.add(Pf)}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}onPreLoad(t){}onTransition(t){}onInitialize(t){}onActivate(t){}onDeactivate(t){}onPreUpdate(t,i){}onPostUpdate(t,i){}onPreDraw(t,i){}onPostDraw(t,i){}_initializeChildren(){for(const t of this.entities)t._initialize(this.engine)}get isInitialized(){return this._isInitialized}async _initialize(t){var i;if(!this.isInitialized){try{this.engine=t,this.physics.config=this.engine.physics,this.input=new Th({pointerTarget:t.pointerScope===x.Canvas?t.canvas:document,grabWindowFocus:t.grabWindowFocus,engine:t}),this.camera._initialize(t),this.world.systemManager.initialize(),await this.onInitialize(t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.events.emit("initialize",new yn(t,this))}catch(n){throw this._logger.error(`Error during scene initialization for scene ${(i=t.director)===null||i===void 0?void 0:i.getSceneName(this)}!`),n}this._isInitialized=!0}}async _activate(t){var i,n;try{this._logger.debug("Scene.onActivate",this),this.input.toggleEnabled(!0),await this.onActivate(t)}catch(a){throw this._logger.error(`Error during scene activation for scene ${(n=(i=this.engine)===null||i===void 0?void 0:i.director)===null||n===void 0?void 0:n.getSceneName(this)}!`),a}}async _deactivate(t){this._logger.debug("Scene.onDeactivate",this),this.input.toggleEnabled(!1),await this.onDeactivate(t)}_preupdate(t,i){this.emit("preupdate",new es(t,i,this)),this.onPreUpdate(t,i)}_postupdate(t,i){this.emit("postupdate",new is(t,i,this)),this.onPostUpdate(t,i)}_predraw(t,i){this.emit("predraw",new _n(t,i,this)),this.onPreDraw(t,i)}_postdraw(t,i){this.emit("postdraw",new vn(t,i,this)),this.onPostDraw(t,i)}update(t,i){var n;if(!this.isInitialized){this._logger.warnOnce(`Scene update called before initialize for scene ${(n=t.director)===null||n===void 0?void 0:n.getSceneName(this)}!`);return}this._preupdate(t,i);let a,h;for(a=0,h=this._cancelQueue.length;a<h;a++)this.removeTimer(this._cancelQueue[a]);this._cancelQueue.length=0;for(const d of this._timers)d.update(i);this.world.update(Oe.Update,i),this.camera&&this.camera.update(t,i),this._collectActorStats(t),this._postupdate(t,i),this.input.update()}draw(t,i){var n;if(!this.isInitialized){this._logger.warnOnce("Scene draw called before initialize!");return}this._predraw(t,i),this.world.update(Oe.Draw,i),!((n=this.engine)===null||n===void 0)&&n.isDebug&&this.debugDraw(t),this._postdraw(t,i)}debugDraw(t){this.emit("predebugdraw",new Vl(t,this)),this.emit("postdebugdraw",new Gl(t,this))}contains(t){return this.actors.indexOf(t)>-1}add(t){if(this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof Hs){dt(this._timers,t)||this.addTimer(t);return}}transfer(t){let i;t instanceof pe&&t.scene&&t.scene!==this&&(i=t.scene,t.scene.world.remove(t,!1)),t instanceof Hs&&t.scene&&(i=t.scene,t.scene.removeTimer(t)),i==null||i.emit("entityremoved",{target:t}),this.add(t)}remove(t){t instanceof pe&&(this.emit("entityremoved",{target:t}),t.active&&t.kill(),this.world.remove(t)),t instanceof Hs&&this.removeTimer(t)}clear(t=!0){for(let i=this.entities.length-1;i>=0;i--)this.world.remove(this.entities[i],t);for(let i=this.timers.length-1;i>=0;i--)this.removeTimer(this.timers[i])}addTimer(t){return this._timers.push(t),t.scene=this,t}removeTimer(t){const i=this._timers.indexOf(t);return i!==-1&&this._timers.splice(i,1),t}cancelTimer(t){return this._cancelQueue.push(t),t}isTimerActive(t){return this._timers.indexOf(t)>-1&&!t.complete}isCurrentScene(){return this.engine?this.engine.currentScene===this:!1}_collectActorStats(t){const i=this.actors.filter(n=>n instanceof wh);for(const n of i)t.stats.currFrame.actors.ui++;for(const n of this.actors){t.stats.currFrame.actors.alive++;for(const a of n.children)af(a)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}}}var js;(function(u){u.Protanope="Protanope",u.Deuteranope="Deuteranope",u.Tritanope="Tritanope"})(js||(js={}));const ty=`#version 300 es\r
precision mediump float;\r
// our texture\r
uniform sampler2D u_image;\r
// the texCoords passed in from the vertex shader.\r
in vec2 v_texcoord;\r
\r
// color blind type\r
uniform int u_type;\r
\r
// simulation?\r
uniform bool u_simulate;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  vec4 o =  texture(u_image, v_texcoord);\r
  // RGB to LMS matrix conversion\r
  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\r
  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\r
  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\r
  // Simulate color blindness\r
  float l;\r
  float m;\r
  float s;\r
  //MODE CODE//\r
  if (u_type == 0) {\r
    // Protanope\r
    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\r
    m = 0.0 * L + 1.0 * M + 0.0 * S;\r
    s = 0.0 * L + 0.0 * M + 1.0 * S;;\r
  } else if (u_type == 1) {\r
    // Deuteranope\r
    l = 1.0 * L + 0.0 * M + 0.0 * S;\r
    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\r
    s = 0.0 * L + 0.0 * M + 1.0 * S;\r
  } else if (u_type == 2) {\r
    // Tritanope\r
    l = 1.0 * L + 0.0 * M + 0.0 * S;\r
    m = 0.0 * L + 1.0 * M + 0.0 * S;\r
    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\r
  }\r
\r
  // LMS to RGB matrix conversion\r
  vec4 error; // simulate the colors\r
  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\r
  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\r
  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\r
  error.a = 1.0;\r
  vec4 diff = o - error;\r
  vec4 correction; // correct the colors\r
  correction.r = 0.0;\r
  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\r
  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\r
  correction = o + correction;\r
  correction.a = o.a;\r
  //SIMULATE//\r
\r
  // sim \r
  if (u_simulate) {\r
    fragColor = error.rgba;\r
  } else {\r
    fragColor = correction.rgba;\r
  }\r
}`;class Mf{constructor(t,i){this._shader=new Ye({gl:t,vertexSource:`#version 300 es
      in vec2 a_position;
      in vec2 a_texcoord;
      out vec2 v_texcoord;

      void main() {
        gl_Position = vec4(a_position, 0.0, 1.0);
        // Pass the texcoord to the fragment shader.
        v_texcoord = a_texcoord;
      }`,fragmentSource:i}),this._shader.compile(),this._buffer=new zi({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new Hi({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}getShader(){return this._shader}getLayout(){return this._layout}}class Lf{constructor(t,i=!1){this._colorBlindnessMode=t,this._simulate=!1,this._simulate=i}initialize(t){this._shader=new Mf(t,ty),this.simulate=this._simulate,this.colorBlindnessMode=this._colorBlindnessMode}getShader(){return this._shader.getShader()}getLayout(){return this._shader.getLayout()}set colorBlindnessMode(t){if(this._colorBlindnessMode=t,this._shader){const i=this._shader.getShader();i.use(),this._colorBlindnessMode===js.Protanope?i.setUniformInt("u_type",0):this._colorBlindnessMode===js.Deuteranope?i.setUniformInt("u_type",1):this._colorBlindnessMode===js.Tritanope&&i.setUniformInt("u_type",2)}}get colorBlindnessMode(){return this._colorBlindnessMode}set simulate(t){if(this._simulate=t,this._shader){const i=this._shader.getShader();i.use(),i.setUniformBoolean("u_simulate",t)}}get simulate(){return this._simulate}}class Of{constructor(t){this._engine=t,this._colorBlindPostProcessor=new Lf(js.Protanope)}correct(t){this._engine.graphicsContext instanceof Wi&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!1,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}simulate(t){this._engine.graphicsContext instanceof Wi&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!0,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}clear(){this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor)}}class Nf{constructor(t){this.stats={currFrame:new Rr,prevFrame:new Rr},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!1,showName:!1},this.transform={showAll:!1,debugZIndex:1e7,showPosition:!1,showPositionLabel:!1,positionColor:G.Yellow,showZIndex:!1,showScale:!1,scaleColor:G.Green,showRotation:!1,rotationColor:G.Blue},this.graphics={showAll:!1,showBounds:!1,boundsColor:G.Yellow},this.collider={showAll:!1,showBounds:!1,boundsColor:G.Blue,showOwner:!1,showGeometry:!0,geometryColor:G.Green,geometryLineWidth:1,geometryPointSize:.5},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:G.Cyan,showCollisionContacts:!0,contactSize:2,collisionContactColor:G.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:G.Yellow,showAcceleration:!1,accelerationColor:G.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:G.Red,showZoom:!1},this.tilemap={showAll:!1,showGrid:!1,gridColor:G.Red,gridWidth:.5,showSolidBounds:!1,solidBoundsColor:G.fromHex("#8080807F"),showColliderGeometry:!0},this.isometric={showAll:!1,showPosition:!1,positionColor:G.Yellow,positionSize:1,showGrid:!1,gridColor:G.Red,gridWidth:1,showColliderGeometry:!0},this._engine=t,this.colorBlindMode=new Of(this._engine)}useTestClock(){const t=this._engine.clock,i=t.isRunning();t.stop();const n=t.toTestClock();return i&&n.start(),this._engine.clock=n,n}useStandardClock(){const t=this._engine.clock,i=t.isRunning();t.stop();const n=t.toStandardClock();return i&&n.start(),this._engine.clock=n,n}}class Rr{constructor(){this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new ea,this._graphicsStats={drawCalls:0,drawnImages:0}}reset(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}clone(){const t=new Rr;return t.reset(this),t}get id(){return this._id}set id(t){this._id=t}get delta(){return this._delta}set delta(t){this._delta=t}get fps(){return this._fps}set fps(t){this._fps=t}get actors(){return this._actorStats}get duration(){return this._durationStats}get physics(){return this._physicsStats}get graphics(){return this._graphicsStats}}class ea{constructor(){this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}reset(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}clone(){const t=new ea;return t.reset(this),t}get pairs(){return this._pairs}set pairs(t){this._pairs=t}get collisions(){return this._collisions}set collisions(t){this._collisions=t}get contacts(){return this._contacts}set contacts(t){this._contacts=t}get fastBodies(){return this._fastBodies}set fastBodies(t){this._fastBodies=t}get fastBodyCollisions(){return this._fastBodyCollisions}set fastBodyCollisions(t){this._fastBodyCollisions=t}get broadphase(){return this._broadphase}set broadphase(t){this._broadphase=t}get narrowphase(){return this._narrowphase}set narrowphase(t){this._narrowphase=t}}class Ph{on(t,i){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(i),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}off(t,i){i||(i=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,i),this._nativeHandlers[t]=null}_decorate(t){return i=>{this._paused||t(i)}}pause(){this._paused=!0}resume(){this._paused=!1}clear(){for(const t in this._nativeHandlers)this.off(t)}constructor(t){this.nativeComponent=t,this._paused=!1,this._nativeHandlers={}}}class Uf{constructor(t,i){this._windowGlobal=t,this._documentGlobal=i,this._windowComponent=new Ph(this._windowGlobal),this._documentComponent=new Ph(this._documentGlobal)}get window(){return this._windowComponent}get document(){return this._documentComponent}pause(){this.window.pause(),this.document.pause()}resume(){this.window.resume(),this.document.resume()}clear(){this.window.clear(),this.document.clear()}}const zf={pixelArtSampler:!1,nativeContextAntialiasing:!1,multiSampleAntialiasing:!0,filtering:Yt.Blended,canvasImageRendering:"auto"},Hf={pixelArtSampler:!0,nativeContextAntialiasing:!1,multiSampleAntialiasing:!0,filtering:Yt.Blended,canvasImageRendering:"auto"};class Wf{constructor(t){var i;this._samplePeriod=100,this._currentFrameTime=0,this._frames=0,this._previousSampleTime=0,this._beginFrameTime=0,this._fps=t.initialFps,this._samplePeriod=(i=t.samplePeriod)!==null&&i!==void 0?i:this._samplePeriod,this._currentFrameTime=1e3/t.initialFps,this._nowFn=t.nowFn,this._previousSampleTime=this._nowFn()}start(){this._beginFrameTime=this._nowFn()}end(){this._frames++;const t=this._nowFn();this._currentFrameTime=t-this._beginFrameTime,t>=this._previousSampleTime+this._samplePeriod&&(this._fps=this._frames*1e3/(t-this._previousSampleTime),this._previousSampleTime=t,this._frames=0)}get fps(){return this._fps}get instant(){return 1e3/this._currentFrameTime}}class Rh{constructor(t){var i,n,a;this._onFatalException=()=>{},this._maxFps=1/0,this._lastTime=0,this._elapsed=1,this._scheduledCbs=[],this._totalElapsed=0,this._options=t,this.tick=t.tick,this._lastTime=(i=this.now())!==null&&i!==void 0?i:0,this._maxFps=(n=t.maxFps)!==null&&n!==void 0?n:this._maxFps,this._onFatalException=(a=t.onFatalException)!==null&&a!==void 0?a:this._onFatalException,this.fpsSampler=new Wf({initialFps:60,nowFn:()=>this.now()})}elapsed(){return this._elapsed}now(){return performance.now()}toTestClock(){return new jf({...this._options,defaultUpdateMs:16.6})}toStandardClock(){return new Ih({...this._options})}setFatalExceptionHandler(t){this._onFatalException=t}schedule(t,i=0,n="preframe"){const a=this._totalElapsed+i;this._scheduledCbs.push([t,a,n])}__runScheduledCbs(t="preframe"){for(let i=this._scheduledCbs.length-1;i>-1;i--)t===this._scheduledCbs[i][2]&&this._scheduledCbs[i][1]<=this._totalElapsed&&(this._scheduledCbs[i][0](this._elapsed),this._scheduledCbs.splice(i,1))}update(t){try{this.fpsSampler.start();const i=this.now();let n=i-this._lastTime||1;const a=1e3/this._maxFps;if(n>=a){let h=0;a!==0&&(h=n%a,n=n-h),n>200&&(n=1),this._elapsed=t||n,this._totalElapsed+=this._elapsed,this.__runScheduledCbs("preframe"),this.tick(t||n),this.__runScheduledCbs("postframe"),a!==0?this._lastTime=i-h:this._lastTime=i,this.fpsSampler.end()}}catch(i){this._onFatalException(i),this.stop()}}}class Ih extends Rh{constructor(t){super(t),this._running=!1}isRunning(){return this._running}start(){if(this._running)return;this._running=!0;const t=()=>{if(this._running)try{this._requestId=window.requestAnimationFrame(t),this.update()}catch(i){throw window.cancelAnimationFrame(this._requestId),i}};t()}stop(){window.cancelAnimationFrame(this._requestId),this._running=!1}}class jf extends Rh{constructor(t){super({...t}),this._logger=J.getInstance(),this._running=!1,this._currentTime=0,this._updateMs=t.defaultUpdateMs}now(){var t;return(t=this._currentTime)!==null&&t!==void 0?t:0}isRunning(){return this._running}start(){this._running=!0}stop(){this._running=!1}step(t){const i=t??this._updateMs;this._running?(this.update(i),this._currentTime+=i):this._logger.warn("The clock is not running, no step will be performed")}run(t,i){for(let n=0;n<t;n++)this.step(i??this._updateMs)}}var ey=It(4296);class Vf{constructor(){this._toasterCss=ey.A.toString(),this._isInitialized=!1}_initialize(){this._isInitialized||(this._container=document.createElement("div"),this._container.id="ex-toast-container",document.body.appendChild(this._container),this._isInitialized=!0,this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._toasterCss,document.head.appendChild(this._styleBlock))}dispose(){this._container.parentElement.removeChild(this._container),this._styleBlock.parentElement.removeChild(this._styleBlock),this._isInitialized=!1}_createFragment(t){const i=document.createElement("span");return i.innerText=t,i}toast(t,i,n){this._initialize();const a=document.createElement("div");a.className="ex-toast-message";const h=t.split("[LINK]").map(w=>this._createFragment(w));if(i){const w=document.createElement("a");w.href=i,n?w.innerText=n:w.innerText=i,h.splice(1,0,w)}const d=document.createElement("div");h.forEach(w=>{d.appendChild(w)}),a.appendChild(d);const p=document.createElement("button");p.innerText="x",p.addEventListener("click",()=>{this._container.removeChild(a)}),a.appendChild(p);const m=w=>{if(w.key==="Escape")try{this._container.removeChild(a)}catch{}document.removeEventListener("keydown",m)};document.addEventListener("keydown",m);const y=this._container.firstChild;this._container.insertBefore(a,y)}}const iy={NavigationStart:"navigationstart",Navigation:"navigation",NavigationEnd:"navigationend"};class Gf{get isTransitioning(){return this._isTransitioning}constructor(t,i){this._engine=t,this.events=new v,this._logger=J.getInstance(),this._initialized=!1,this.scenes={},this._sceneToInstance=new Map,this._sceneToLoader=new Map,this._sceneToTransition=new Map,this._loadedScenes=new Set,this._isTransitioning=!1,this.rootScene=this.currentScene=new qe,this.add("root",this.rootScene),this.currentScene=this.rootScene,this.currentSceneName="root";for(const n in i){const a=i[n];this.add(n,a),n==="root"&&(this.rootScene=this.getSceneInstance("root"),this.currentScene=this.rootScene)}}async onInitialize(){if(!this._initialized)if(this._initialized=!0,this._deferredGoto){const t=this._deferredGoto,i=this._deferredTransition;this._deferredGoto=null,this._deferredTransition=null,await this.swapScene(t),i&&await this.playTransition(i)}else await this.swapScene("root")}get isInitialized(){return this._initialized}configureStart(t,i){const n=i==null?void 0:i.loader;n instanceof mr?this.mainLoader=n:hh(n)?this.mainLoader=new n:this.mainLoader=new Ms;let a;if(i){const{inTransition:h}=i;a=h}this.startScene=t,a?this.swapScene(this.startScene).then(()=>{this.playTransition(a)}):this.swapScene(this.startScene),this.currentSceneName=this.startScene}_getLoader(t){return this._sceneToLoader.get(t)}_getInTransition(t){var i;const n=this.scenes[t];return n instanceof qe||Fi(n)?null:(i=n==null?void 0:n.transitions)===null||i===void 0?void 0:i.in}_getOutTransition(t){var i;const n=this.scenes[t];return n instanceof qe||Fi(n)?null:(i=n==null?void 0:n.transitions)===null||i===void 0?void 0:i.out}getDeferredScene(){const t=this.getSceneDefinition(this._deferredGoto);return this._deferredGoto&&t?t:null}getSceneDefinition(t){const i=this.scenes[t];if(i instanceof qe||Fi(i))return i;if(i)return i.scene}getSceneName(t){for(const[i,n]of Object.entries(this.scenes))if(n instanceof qe){if(t===n)return i}else if(!Fi(n)&&t===n.scene)return i;for(const[i,n]of Object.entries(this.scenes))if(Fi(n)){if(t.constructor===n)return i}else if(!(n instanceof qe)&&t.constructor===n.scene)return i;return null}assertAdded(t){return this}assertRemoved(t){return this}add(t,i){if(!(i instanceof qe)&&!Fi(i)){const{loader:n,transitions:a}=i,{in:h,out:d}=a??{};this._sceneToTransition.set(t,{in:h,out:d}),hh(n)?this._sceneToLoader.set(t,new n):this._sceneToLoader.set(t,n)}return this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=i,this.assertAdded(t)}remove(t){if(t instanceof qe||Fi(t)){const i=t;for(const n in this.scenes)if(this.scenes.hasOwnProperty(n)){const a=this.scenes[n];let h;if(a instanceof qe||Fi(a)?h=a:h=a.scene,h===i){if(n===this.currentSceneName)throw new Error(`Cannot remove a currently active scene: ${n}`);this._sceneToInstance.delete(n),this._sceneToTransition.delete(n),this._sceneToLoader.delete(n),delete this.scenes[n]}}}if(typeof t=="string"){if(t===this.currentSceneName)throw new Error(`Cannot remove a currently active scene: ${t}`);this._sceneToInstance.delete(t),this._sceneToTransition.delete(t),this._sceneToLoader.delete(t),delete this.scenes[t]}}async goto(t,i){var n,a,h,d,p,m;const y=this.getSceneInstance(t);if(!y){this._logger.warn(`Scene ${t} does not exist! Check the name, are you sure you added it?`);return}const w=this.currentSceneName,b=(a=(n=this._engine.input)===null||n===void 0?void 0:n.enabled)!==null&&a!==void 0?a:!0;this._isTransitioning=!0;const R=(h=this.getSceneInstance(w))===null||h===void 0?void 0:h.onTransition("out"),k=y==null?void 0:y.onTransition("in");i={sourceOut:(d=this._getOutTransition(this.currentSceneName))!==null&&d!==void 0?d:R,destinationIn:(p=this._getInTransition(t))!==null&&p!==void 0?p:k,...i};const{sourceOut:M,destinationIn:z,sceneActivationData:X}=i,N=M??this._getOutTransition(this.currentSceneName),U=z??this._getInTransition(t),Y=(N==null?void 0:N.hideLoader)||(U==null?void 0:U.hideLoader);Y&&this.maybeLoadScene(t,Y),this._emitEvent("navigationstart",w,t),await this.playTransition(N),await this.maybeLoadScene(t,Y),await(U==null?void 0:U.onPreviousSceneDeactivate(this.currentScene)),await this.swapScene(t,X),this._emitEvent("navigation",w,t),await this.playTransition(U),this._emitEvent("navigationend",w,t),(m=this._engine.input)===null||m===void 0||m.toggleEnabled(b),this._isTransitioning=!1}getSceneInstance(t){const i=this.getSceneDefinition(t);if(!i)return;if(this._sceneToInstance.has(t))return this._sceneToInstance.get(t);if(i instanceof qe)return this._sceneToInstance.set(t,i),i;const n=new i;return this._sceneToInstance.set(t,n),n}async maybeLoadScene(t,i=!1){var n;const a=(n=this._getLoader(t))!==null&&n!==void 0?n:new mr,h=this.getSceneDefinition(t),d=this.getSceneInstance(t);h&&d&&!this._loadedScenes.has(d)&&(d.onPreLoad(a),d.events.emit("preload",{loader:a}),i?this._engine.load(a,i):await this._engine.load(a),this._loadedScenes.add(d))}async playTransition(t){var i,n,a,h,d,p,m;if(!this.isInitialized){this._deferredTransition=t;return}if(t){this.currentTransition=t;const y=this._engine.currentScene,w=(n=(i=y.input)===null||i===void 0?void 0:i.enabled)!==null&&n!==void 0?n:!0;(a=y.input)===null||a===void 0||a.toggleEnabled(!t.blockInput),(h=this._engine.input)===null||h===void 0||h.toggleEnabled(!t.blockInput),await this.currentTransition.play(this._engine),(d=y.input)===null||d===void 0||d.toggleEnabled(w)}(p=this.currentTransition)===null||p===void 0||p.kill(),(m=this.currentTransition)===null||m===void 0||m.reset(),this.currentTransition=null}async swapScene(t,i){const n=this._engine;if(!this.isInitialized){this._deferredGoto=t;return}const a=this.getSceneInstance(t);if(a){const h=this.currentScene,d=a;if(this._logger.debug("Going to scene:",t),this.currentScene.isInitialized){const y={engine:n,previousScene:h,nextScene:d};await this.currentScene._deactivate(y),this.currentScene.events.emit("deactivate",new eh(y,this.currentScene))}const p=this._sceneToLoader.get(t);await(p==null?void 0:p.areResourcesLoaded()),this.currentScene=d,this.currentSceneName=t,n.screen.setCurrentCamera(d.camera),await this.currentScene._initialize(n);const m={engine:n,previousScene:h,nextScene:d,data:i};await this.currentScene._activate(m),this.currentScene.events.emit("activate",new th(m,this.currentScene))}else this._logger.error("Scene",t,"does not exist!")}_emitEvent(t,i,n){const a=this.getSceneDefinition(i),h=this.getSceneDefinition(n);this.events.emit(t,{sourceScene:a,sourceName:i,destinationScene:h,destinationName:n})}}function sy(){const u={scope:(t,i)=>(u.value=t,i()),value:void 0};return u}function ny(u){return u.value}c();const ry={FallbackGraphicsContext:"fallbackgraphicscontext",Initialize:"initialize",Visible:"visible",Hidden:"hidden",Start:"start",Stop:"stop",PreUpdate:"preupdate",PostUpdate:"postupdate",PreFrame:"preframe",PostFrame:"postframe",PreDraw:"predraw",PostDraw:"postdraw"};var rs;(function(u){u[u.None=0]="None",u[u.Canvas=1]="Canvas",u[u.All=2]="All"})(rs||(rs={}));class Pe{static useEngine(){const t=ny(Pe.Context);if(!t)throw new Error("Cannot inject engine with `useEngine()`, `useEngine()` was called outside of Engine lifecycle scope.");return t}get canvasWidth(){return this.screen.canvasWidth}get halfCanvasWidth(){return this.screen.halfCanvasWidth}get canvasHeight(){return this.screen.canvasHeight}get halfCanvasHeight(){return this.screen.halfCanvasHeight}get drawWidth(){return this.screen.drawWidth}get halfDrawWidth(){return this.screen.halfDrawWidth}get drawHeight(){return this.screen.drawHeight}get halfDrawHeight(){return this.screen.halfDrawHeight}get isHiDpi(){return this.screen.isHiDpi}get stats(){return this.debug.stats}get currentScene(){return this.director.currentScene}get currentSceneName(){return this.director.currentSceneName}get rootScene(){return this.director.rootScene}get scenes(){return this.director.scenes}get isFullscreen(){return this.screen.isFullScreen}get displayMode(){return this.screen.displayMode}get pixelRatio(){return this.screen.pixelRatio}get isDebug(){return this._isDebug}get snapToPixel(){return this.graphicsContext.snapToPixel}set snapToPixel(t){this.graphicsContext.snapToPixel=t}emit(t,i){this.events.emit(t,i)}on(t,i){return this.events.on(t,i)}once(t,i){return this.events.once(t,i)}off(t,i){this.events.off(t,i)}constructor(t){var i,n,a,h,d,p,m,y;this.scope=Y=>Pe.Context.scope(this,Y),this.version=Lh,this.events=new v,this.maxFps=Number.POSITIVE_INFINITY,this._inputEnabled=!0,this._suppressPlayButton=!1,this.pauseAudioWhenHidden=!0,this._isDebug=!1,this.enableCanvasTransparency=!0,this.onFatalException=Y=>{J.getInstance().fatal(Y,Y.stack)},this._toaster=new Vf,this._timescale=1,this._isInitialized=!1,this._originalOptions={},this._handleWebGLContextLost=Y=>{var H;Y.preventDefault(),this.clock.stop(),this._logger.fatalOnce("WebGL Graphics Lost",Y);const tt=document.createElement("div");tt.id="ex-webgl-graphics-context-lost",tt.style.position="absolute",tt.style.zIndex="99",tt.style.left="50%",tt.style.top="50%",tt.style.display="flex",tt.style.flexDirection="column",tt.style.transform="translate(-50%, -50%)",tt.style.backgroundColor="white",tt.style.padding="10px",tt.style.borderStyle="solid 1px";const gt=document.createElement("div");if(gt.innerHTML=`
      <h1>There was an issue rendering, please refresh the page.</h1>
      <div>
        <p>WebGL Graphics Context Lost</p>

        <button id="ex-webgl-graphics-reload">Refresh Page</button>

        <p>There are a few reasons this might happen:</p>
        <ul>
          <li>Two or more pages are placing a high demand on the GPU</li>
          <li>Another page or operation has stalled the GPU and the browser has decided to reset the GPU</li>
          <li>The computer has multiple GPUs and the user has switched between them</li>
          <li>Graphics driver has crashed or restarted</li>
          <li>Graphics driver was updated</li>
        </ul>
      </div>
    `,tt.appendChild(gt),!((H=this.canvas)===null||H===void 0)&&H.parentElement){this.canvas.parentElement.appendChild(tt);const $=gt.querySelector("#ex-webgl-graphics-reload");$==null||$.addEventListener("click",()=>location.reload())}},this._performanceThresholdTriggered=!1,this._fpsSamples=[],this._disposed=!1,this._isLoading=!1,this._hideLoader=!1,this._isReadyFuture=new _,this.currentFrameElapsedMs=0,this.currentFrameLagMs=0,this._lagMs=0,this._screenShotRequests=[],t={...Pe._DEFAULT_ENGINE_OPTIONS,...t},this._originalOptions=t,f.freeze(),this.browser=new Uf(window,document);const w=new Ud;if(!t.suppressMinimumBrowserFeatureDetection&&!(this._compatible=w.test())){const Y=document.createElement("div");if(Y.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(Y),w.failedTests.forEach(function(H){const tt=document.createElement("div");tt.innerText="Browser feature missing "+H,document.body.appendChild(tt)}),t.canvasElementId){const H=document.getElementById(t.canvasElementId);H&&H.parentElement.removeChild(H)}return}else this._compatible=!0;if(console.log&&!t.suppressConsoleBootMessage&&(console.log(`%cPowered by Excalibur.js (v${Lh})`,"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log(`
      /| ________________
O|===|* >________________>
      \\|`),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(this._suppressPlayButton=!0),this._logger=J.getInstance(),this._logger.defaultLevel===at.Debug&&w.logBrowserFeatures(),this._logger.debug("Building engine..."),this.canvasElementId=t.canvasElementId,t.canvasElementId){if(this._logger.debug("Using Canvas element specified: "+t.canvasElementId),document.getElementById(t.canvasElementId)===null)throw new Error("Cannot find existing element in the DOM, please ensure element is created prior to engine creation.");this.canvas=document.getElementById(t.canvasElementId)}else t.canvasElement?(this._logger.debug("Using Canvas element specified:",t.canvasElement),this.canvas=t.canvasElement):(this._logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));let b=(i=t.displayMode)!==null&&i!==void 0?i:Jt.Fixed;t.width&&t.height||t.viewport?(t.displayMode===void 0&&(b=Jt.Fixed),this._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(this._logger.debug("Engine viewport is fit"),b=Jt.FitScreen),this._originalDisplayMode=b;let R,k,M,z,X,N;typeof t.antialiasing=="object"?{pixelArtSampler:R,nativeContextAntialiasing:M,multiSampleAntialiasing:N,filtering:X,canvasImageRendering:z}={...t.pixelArt?Hf:zf,...t.antialiasing}:(R=!!t.pixelArt,M=!1,N=t.antialiasing,z=t.antialiasing?"auto":"pixelated",X=t.antialiasing?Yt.Blended:Yt.Pixel),M&&N&&this._logger.warnOnce("Cannot use antialias setting nativeContextAntialiasing and multiSampleAntialiasing at the same time, they are incompatible settings. If you aren't sure use multiSampleAntialiasing"),t.pixelArt&&(k=.25),(!t.antialiasing||X===Yt.Pixel)&&(k=0),k=(a=(n=t.uvPadding)!==null&&n!==void 0?n:k)!==null&&a!==void 0?a:.01;let U=f.isEnabled("use-canvas-context");if(!U)try{this.graphicsContext=new Wi({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,pixelArtSampler:R,antialiasing:M,multiSampleAntialiasing:N,uvPadding:k,powerPreference:t.powerPreference,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting,handleContextLost:(h=t.handleContextLost)!==null&&h!==void 0?h:this._handleWebGLContextLost,handleContextRestored:t.handleContextRestored})}catch(Y){this._logger.warn(`Excalibur could not load webgl for some reason (${Y.message}) and loaded a Canvas 2D fallback. Some features of Excalibur will not work in this mode. 

Read more about this issue at https://excaliburjs.com/docs/performance`),U=!0}U&&(this.graphicsContext=new Io({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,antialiasing:M,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})),this.screen=new Ll({canvas:this.canvas,context:this.graphicsContext,antialiasing:M,canvasImageRendering:z,browser:this.browser,viewport:(d=t.viewport)!==null&&d!==void 0?d:t.width&&t.height?{width:t.width,height:t.height}:Ml.SVGA,resolution:t.resolution,displayMode:b,pixelRatio:t.suppressHiDPIScaling?1:(p=t.pixelRatio)!==null&&p!==void 0?p:null}),$t.filtering=X,t.backgroundColor&&(this.backgroundColor=t.backgroundColor.clone()),this.grabWindowFocus=t.grabWindowFocus,this.pointerScope=t.pointerScope,this.maxFps=(m=t.maxFps)!==null&&m!==void 0?m:this.maxFps,this.fixedUpdateFps=(y=t.fixedUpdateFps)!==null&&y!==void 0?y:this.fixedUpdateFps,this.clock=new Ih({maxFps:this.maxFps,tick:this._mainloop.bind(this),onFatalException:Y=>this.onFatalException(Y)}),this.enableCanvasTransparency=t.enableCanvasTransparency,typeof t.physics=="boolean"?this.physics={...Ai,...gh(),enabled:t.physics}:this.physics={...Ai,...gh(),...t.physics},this.debug=new Nf(this),this.director=new Gf(this,t.scenes),this._initialize(t),window.___EXCALIBUR_DEVTOOL=this,Pe.InstanceCount++}_monitorPerformanceThresholdAndTriggerFallback(){const{allow:t}=this._originalOptions.configurePerformanceCanvas2DFallback;let{threshold:i,showPlayerMessage:n}=this._originalOptions.configurePerformanceCanvas2DFallback;if(i===void 0&&(i=Pe._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold),n===void 0&&(n=Pe._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage),!f.isEnabled("use-canvas-context")&&t&&this.ready&&!this._performanceThresholdTriggered){this._fpsSamples.length===i.numberOfFrames&&this._fpsSamples.splice(0,1),this._fpsSamples.push(this.clock.fpsSampler.fps);let a=0;for(let d=0;d<this._fpsSamples.length;d++)a+=this._fpsSamples[d];const h=a/this._fpsSamples.length;this._fpsSamples.length===i.numberOfFrames&&h<=i.fps&&(this._performanceThresholdTriggered=!0,this._logger.warn(`Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.
this might mean your browser doesn't have webgl enabled or hardware acceleration is unavailable.

If in Chrome:
  * Visit Settings > Advanced > System, and ensure "Use Hardware Acceleration" is checked.
  * Visit chrome://flags/#ignore-gpu-blocklist and ensure "Override software rendering list" is "enabled"
If in Firefox, visit about:config
  * Ensure webgl.disabled = false
  * Ensure webgl.force-enabled = true
  * Ensure layers.acceleration.force-enabled = true

Read more about this issue at https://excaliburjs.com/docs/performance`),n&&this._toaster.toast("Excalibur is encountering performance issues. It's possible that your browser doesn't have hardware acceleration enabled. Visit [LINK] for more information and potential solutions.","https://excaliburjs.com/docs/performance"),this.useCanvas2DFallback(),this.emit("fallbackgraphicscontext",this.graphicsContext))}}useCanvas2DFallback(){var t,i,n;const a=this.canvas.cloneNode(!1);this.canvas.parentNode.replaceChild(a,this.canvas),this.canvas=a;const h={...this._originalOptions,antialiasing:this.getAntialiasing()},d=this._originalDisplayMode;this.graphicsContext=new Io({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,antialiasing:h.antialiasing,backgroundColor:h.backgroundColor,snapToPixel:h.snapToPixel,useDrawSorting:h.useDrawSorting}),this.screen&&this.screen.dispose(),this.screen=new Ll({canvas:this.canvas,context:this.graphicsContext,antialiasing:(t=h.antialiasing)!==null&&t!==void 0?t:!0,browser:this.browser,viewport:(i=h.viewport)!==null&&i!==void 0?i:h.width&&h.height?{width:h.width,height:h.height}:Ml.SVGA,resolution:h.resolution,displayMode:d,pixelRatio:h.suppressHiDPIScaling?1:(n=h.pixelRatio)!==null&&n!==void 0?n:null}),this.screen.setCurrentCamera(this.currentScene.camera),this.input.pointers.detach();const p=h&&h.pointerScope===x.Document?document:this.canvas;this.input.pointers=this.input.pointers.recreate(p,this),this.input.pointers.init()}dispose(){this._disposed||(this._disposed=!0,this.stop(),this.input.toggleEnabled(!1),this.canvas.parentNode.removeChild(this.canvas),this.canvas=null,this.screen.dispose(),this.graphicsContext.dispose(),this.graphicsContext=null,Pe.InstanceCount--)}isDisposed(){return this._disposed}getWorldBounds(){return this.screen.getWorldBounds()}get timescale(){return this._timescale}set timescale(t){if(t<=0){J.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0.");return}this._timescale=t}addTimer(t){return this.currentScene.addTimer(t)}removeTimer(t){return this.currentScene.removeTimer(t)}addScene(t,i){return this.director.add(t,i),this}removeScene(t){this.director.remove(t)}add(t){if(arguments.length===2){this.director.add(arguments[0],arguments[1]);return}const i=this.director.getDeferredScene();i instanceof qe?i.add(t):this.currentScene.add(t)}remove(t){t instanceof pe&&this.currentScene.remove(t),(t instanceof qe||Fi(t))&&this.removeScene(t),typeof t=="string"&&this.removeScene(t)}async goto(t,i){await this.scope(async()=>{await this.director.goto(t,i)})}async goToScene(t,i){await this.scope(async()=>{await this.director.goto(t,i)})}screenToWorldCoordinates(t){return this.screen.screenToWorldCoordinates(t)}worldToScreenCoordinates(t){return this.screen.worldToScreenCoordinates(t)}_initialize(t){var i,n;this.pageScrollPreventionMode=t.scrollPreventionMode;const a=t&&t.pointerScope===x.Document?document:this.canvas,h=(n=(i=this._originalOptions)===null||i===void 0?void 0:i.grabWindowFocus)!==null&&n!==void 0?n:!0;this.input=new Th({pointerTarget:a,grabWindowFocus:h,engine:this}),this.inputMapper=this.input.inputMapper,this.browser.document.on("visibilitychange",()=>{document.visibilityState==="hidden"?(this.events.emit("hidden",new Jl(this)),this._logger.debug("Window hidden")):document.visibilityState==="visible"&&(this.events.emit("visible",new Kl(this)),this._logger.debug("Window visible"))}),!this.canvasElementId&&!t.canvasElement&&document.body.appendChild(this.canvas)}toggleInputEnabled(t){this._inputEnabled=t,this.input.toggleEnabled(this._inputEnabled)}onInitialize(t){}setAntialiasing(t){this.screen.antialiasing=t}getAntialiasing(){return this.screen.antialiasing}get isInitialized(){return this._isInitialized}async _overrideInitialize(t){this.isInitialized||(await this.director.onInitialize(),await this.onInitialize(t),this.events.emit("initialize",new yn(t,this)),this._isInitialized=!0)}_update(t){var i;if(this._isLoading){(i=this._loader)===null||i===void 0||i.onUpdate(this,t),this.input.update();return}this.clock.__runScheduledCbs("preupdate"),this._preupdate(t),this.currentScene.update(this,t),this.graphicsContext.updatePostProcessors(t),this.clock.__runScheduledCbs("postupdate"),this._postupdate(t),this.input.update()}_preupdate(t){this.emit("preupdate",new es(this,t,this)),this.onPreUpdate(this,t)}onPreUpdate(t,i){}_postupdate(t){this.emit("postupdate",new is(this,t,this)),this.onPostUpdate(this,t)}onPostUpdate(t,i){}_draw(t){var i,n;if(this.graphicsContext.beginDrawLifecycle(),this.graphicsContext.clear(),this.clock.__runScheduledCbs("predraw"),this._predraw(this.graphicsContext,t),this._isLoading){this._hideLoader||((i=this._loader)===null||i===void 0||i.canvas.draw(this.graphicsContext,0,0),this.clock.__runScheduledCbs("postdraw"),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle());return}this.graphicsContext.backgroundColor=(n=this.currentScene.backgroundColor)!==null&&n!==void 0?n:this.backgroundColor,this.currentScene.draw(this.graphicsContext,t),this.clock.__runScheduledCbs("postdraw"),this._postdraw(this.graphicsContext,t),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle(),this._checkForScreenShots()}_predraw(t,i){this.emit("predraw",new _n(t,i,this)),this.onPreDraw(t,i)}onPreDraw(t,i){}_postdraw(t,i){this.emit("postdraw",new vn(t,i,this)),this.onPostDraw(t,i)}onPostDraw(t,i){}showDebug(t){this._isDebug=t}toggleDebug(){return this._isDebug=!this._isDebug,this._isDebug}get loadingComplete(){return!this._isLoading}get ready(){return this._isReadyFuture.isCompleted}isReady(){return this._isReadyFuture.promise}async start(t,i){await this.scope(async()=>{if(!this._compatible)throw new Error("Excalibur is incompatible with your browser");this._isLoading=!0;let n;return t instanceof mr?n=t:typeof t=="string"&&(this.director.configureStart(t,i),n=this.director.mainLoader),this._logger.debug("Starting game clock..."),this.browser.resume(),this.clock.start(),this._logger.debug("Game clock started"),await this.load(n??new Ms),await this._overrideInitialize(this),this._isReadyFuture.resolve(),this.emit("start",new zl(this)),this._isReadyFuture.promise})}_mainloop(t){this.scope(()=>{this.emit("preframe",new Xl(this,this.stats.prevFrame));const i=t*this.timescale;this.currentFrameElapsedMs=i;const n=this.stats.prevFrame.id+1;this.stats.currFrame.reset(),this.stats.currFrame.id=n,this.stats.currFrame.delta=i,this.stats.currFrame.fps=this.clock.fpsSampler.fps,kt.clear();const a=this.clock.now(),h=1e3/this.fixedUpdateFps;if(this.fixedUpdateFps)for(this._lagMs+=i;this._lagMs>=h;)this._update(h),this._lagMs-=h;else this._update(i);const d=this.clock.now();this.currentFrameLagMs=this._lagMs,this._draw(i);const p=this.clock.now();this.stats.currFrame.duration.update=d-a,this.stats.currFrame.duration.draw=p-d,this.stats.currFrame.graphics.drawnImages=kt.DrawnImagesCount,this.stats.currFrame.graphics.drawCalls=kt.DrawCallCount,this.emit("postframe",new Yl(this,this.stats.currFrame)),this.stats.prevFrame.reset(this.stats.currFrame),this._monitorPerformanceThresholdAndTriggerFallback()})}stop(){this.clock.isRunning()&&(this.emit("stop",new Hl(this)),this.browser.pause(),this.clock.stop(),this._logger.debug("Game stopped"))}isRunning(){return this.clock.isRunning()}screenshot(t=!1){return new Promise(n=>{this._screenShotRequests.push({preserveHiDPIResolution:t,resolve:n})})}_checkForScreenShots(){for(const t of this._screenShotRequests){const i=t.preserveHiDPIResolution?this.canvas.width:this.screen.resolution.width,n=t.preserveHiDPIResolution?this.canvas.height:this.screen.resolution.height,a=document.createElement("canvas");a.width=i,a.height=n;const h=a.getContext("2d");h.imageSmoothingEnabled=this.screen.antialiasing,h.drawImage(this.canvas,0,0,i,n);const d=new Image,p=a.toDataURL("image/png");d.src=p,t.resolve(d)}this._screenShotRequests.length=0}async load(t,i=!1){await this.scope(async()=>{try{if(t.isLoaded())return;this._loader=t,this._isLoading=!0,this._hideLoader=i,t instanceof Ms&&(t.suppressPlayButton=t.suppressPlayButton||this._suppressPlayButton),this._loader.onInitialize(this),await t.load()}catch(n){this._logger.error("Error loading resources, things may not behave properly",n),await Promise.resolve()}finally{this._isLoading=!1,this._hideLoader=!1,this._loader=null}})}}Pe.Context=sy(),Pe.InstanceCount=0,Pe._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,useDrawSorting:!0,configurePerformanceCanvas2DFallback:{allow:!1,showPlayerMessage:!1,threshold:{fps:20,numberOfFrames:100}},canvasElementId:"",canvasElement:void 0,snapToPixel:!1,antialiasing:!0,pixelArt:!1,powerPreference:"high-performance",pointerScope:x.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,grabWindowFocus:!0,scrollPreventionMode:rs.Canvas,backgroundColor:G.fromHex("#2185d0")};class oy{constructor(){this._handlers={},this._wiredEventDispatchers=[],this._deferedHandlerRemovals=[]}clear(){this._handlers={},this._wiredEventDispatchers=[]}_processDeferredHandlerRemovals(){for(const t of this._deferedHandlerRemovals)this._removeHandler(t.name,t.handler);this._deferedHandlerRemovals.length=0}emit(t,i){if(this._processDeferredHandlerRemovals(),!t)return;t=t.toLowerCase(),(typeof i>"u"||i===null)&&(i=new _t);let n,a;if(this._handlers[t])for(n=0,a=this._handlers[t].length,n;n<a;n++)this._handlers[t][n](i);for(n=0,a=this._wiredEventDispatchers.length,n;n<a;n++)this._wiredEventDispatchers[n].emit(t,i)}on(t,i){this._processDeferredHandlerRemovals(),t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(i)}off(t,i){this._deferedHandlerRemovals.push({name:t,handler:i})}_removeHandler(t,i){t=t.toLowerCase();const n=this._handlers[t];if(n)if(!i)this._handlers[t].length=0;else{const a=n.indexOf(i);a>-1&&this._handlers[t].splice(a,1)}}once(t,i){this._processDeferredHandlerRemovals();const n=a=>{const h=a||new _t;this.off(t,n),i(h)};this.on(t,n)}wire(t){t._wiredEventDispatchers.push(this)}unwire(t){const i=t._wiredEventDispatchers.indexOf(this);i>-1&&t._wiredEventDispatchers.splice(i,1)}}class ay extends Le{get font(){return this._font}set font(t){this._font=t,this._text.font=t}get text(){return this._text.text}set text(t){this._text.text=t}get color(){return this._text.color}set color(t){this._text&&(this._text.color=t)}get opacity(){return this._text.opacity}set opacity(t){this._text.opacity=t}get spriteFont(){return this._spriteFont}set spriteFont(t){t&&(this._spriteFont=t,this._text.font=this._spriteFont)}constructor(t){super(t),this._font=new zs,this._text=new xr({text:"",font:this._font});const{text:i,pos:n,x:a,y:h,spriteFont:d,font:p,color:m}={text:"",...t};this.pos=n??(a&&h?B(a,h):this.pos),this.text=i??this.text,this.font=p??this.font,this.spriteFont=d??this.spriteFont,this._text.color=m??this.color;const y=this.get(ie);y.anchor=E.Zero,y.use(this._text)}_initialize(t){super._initialize(t)}getTextWidth(){return this._text.width}}class Xf extends pe{getGraphics(){return this._graphics}addGraphic(t,i){this._graphics.push(t),this._gfx.visible=this.map.visible,this._gfx.opacity=this.map.opacity,i!=null&&i.offset&&(this._gfx.offset=i.offset),this._gfx.localBounds=this._recalculateBounds()}_recalculateBounds(){let t=this._tileBounds.clone();for(const i of this._graphics){const n=B(this.map.graphicsOffset.x-this.map.tileWidth/2,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:i.height-this.map.tileHeight));t=t.combine(i.localBounds.translate(n))}return t}removeGraphic(t){const i=this._graphics.indexOf(t);i>-1&&this._graphics.splice(i,1),this._gfx.localBounds=this._recalculateBounds()}clearGraphics(){this._graphics.length=0,this._gfx.visible=!1,this._gfx.localBounds=this._recalculateBounds()}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const i=this._colliders.indexOf(t);i>-1&&this._colliders.splice(i,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}get pos(){return this.map.tileToWorld(B(this.x,this.y))}get center(){return this.pos.add(B(0,this.map.tileHeight/2))}constructor(t,i,n,a){super([new it,new ie({offset:n??E.Zero,onPostDraw:(R,k)=>this.draw(R,k)}),new Sr(a)]),this.solid=!1,this.events=new v,this._tileBounds=new et,this._graphics=[],this._colliders=[],this.data=new Map,this.x=t,this.y=i,this.map=a,this._transform=this.get(it),this._isometricEntityComponent=this.get(Sr);const h=this.map.tileWidth/2,d=this.map.tileHeight/2,p=(this.x-this.y)*h,m=(this.x+this.y)*d;this._transform.pos=B(p,m),this._isometricEntityComponent.elevation=a.elevation,this._gfx=this.get(ie),this._gfx.visible=!1;const y=this.map.tileWidth,w=this.map.tileHeight,b=B(0,this.map.renderFromTopOfGraphic?w:0);this._gfx.localBounds=this._tileBounds=new et({left:-y/2,top:-w,right:y/2,bottom:w}).translate(b)}draw(t,i){const n=this.map.tileWidth/2;t.save(),t.translate(-n,0);for(const a of this._graphics)a.draw(t,this.map.graphicsOffset.x,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:a.height-this.map.tileHeight));t.restore()}}class ly extends pe{constructor(t){super([new it,new ct({type:ft.Fixed}),new jt,new Ri,new Zo((w,b)=>this.debug(w,b),!1)],t.name),this.elevation=0,this.visible=!0,this.opacity=1,this.renderFromTopOfGraphic=!1,this.graphicsOffset=B(0,0),this._forwardPointerEventToTile=w=>b=>{const R=this.getTileByPoint(b.worldPos);R&&R.events.emit(w,b)},this._collidersDirty=!1,this._originalOffsets=new WeakMap;const{pos:i,tileWidth:n,tileHeight:a,columns:h,rows:d,renderFromTopOfGraphic:p,graphicsOffset:m,elevation:y}=t;this.transform=this.get(it),i&&(this.transform.pos=i),this.collider=this.get(jt),this.collider&&this.collider.set(this._composite=new ue([])),this.pointer=this.get(Ri),this.renderFromTopOfGraphic=p??this.renderFromTopOfGraphic,this.graphicsOffset=m??this.graphicsOffset,this.elevation=y??this.elevation,this.tileWidth=n,this.tileHeight=a,this.columns=h,this.rows=d,this.tiles=new Array(h*d);for(let w=0;w<d;w++)for(let b=0;b<h;b++){const R=new Xf(b,w,this.graphicsOffset,this);this.tiles[b+w*h]=R,this.addChild(R)}this.pointer.localBounds=et.fromDimension(n*h*this.transform.scale.x,a*d*this.transform.scale.y,B(.5,0)),this._setupPointerToTile()}_setupPointerToTile(){this.events.on("pointerup",this._forwardPointerEventToTile("pointerup")),this.events.on("pointerdown",this._forwardPointerEventToTile("pointerdown")),this.events.on("pointermove",this._forwardPointerEventToTile("pointermove")),this.events.on("pointercancel",this._forwardPointerEventToTile("pointercancel"))}update(){this._collidersDirty&&(this.updateColliders(),this._collidersDirty=!1)}flagCollidersDirty(){this._collidersDirty=!0}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const i=t.offset;return this._originalOffsets.set(t,i),i}}updateColliders(){this._composite.clearColliders();const t=this.get(it).pos;for(const i of this.tiles)if(i.solid)for(const n of i.getColliders()){const a=this._getOrSetColliderOriginalOffset(n);n.offset=this.tileToWorld(B(i.x,i.y)).sub(t).add(a).sub(B(this.tileWidth/2,this.tileHeight)),n.owner=this,this._composite.addCollider(n)}this.collider.update()}worldToTile(t){t=t.sub(this.transform.globalPos);const i=this.tileWidth/2,n=this.tileHeight/2;return B(~~((t.x/i+t.y/n)/2),~~((t.y/n-t.x/i)/2))}tileToWorld(t){const i=this.tileWidth/2,n=this.tileHeight/2,a=(t.x-t.y)*i,h=(t.x+t.y)*n;return B(a,h).add(this.transform.pos)}getTile(t,i){return t<0||i<0||t>=this.columns||i>=this.rows?null:this.tiles[t+i*this.columns]}getTileByPoint(t){const i=this.worldToTile(t);return this.getTile(i.x,i.y)}_getMaxZIndex(){let t=Number.NEGATIVE_INFINITY;for(const i of this.tiles){const n=i.get(it).z;n>t&&(t=n)}return t}debug(t,i){const{showAll:n,showPosition:a,positionColor:h,positionSize:d,showGrid:p,gridColor:m,gridWidth:y,showColliderGeometry:w}=i.isometric,{geometryColor:b,geometryLineWidth:R,geometryPointSize:k}=i.collider;if(t.save(),t.z=this._getMaxZIndex()+.5,n||p){for(let M=0;M<this.rows+1;M++){const z=this.tileToWorld(B(0,M)),X=this.tileToWorld(B(this.columns,M));t.drawLine(z,X,m,y)}for(let M=0;M<this.columns+1;M++){const z=this.tileToWorld(B(M,0)),X=this.tileToWorld(B(M,this.rows));t.drawLine(z,X,m,y)}}if(n||a)for(const M of this.tiles)t.drawCircle(this.tileToWorld(B(M.x,M.y)),d,h);if(n||w){for(const M of this.tiles)if(M.solid)for(const z of M.getColliders())z.debug(t,b,{lineWidth:R,pointSize:k})}t.restore()}}class Dh{constructor(t,i){this._stopped=!1,this._sequenceBuilder=i,this._sequenceContext=new wr(t),this._actionQueue=this._sequenceContext.getQueue(),this._sequenceBuilder(this._sequenceContext)}update(t){this._actionQueue.update(t)}isComplete(){return this._stopped||this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._stopped=!1,this._actionQueue.reset()}clone(t){return new Dh(t,this._sequenceBuilder)}}class hy{constructor(t){this._actions=t}update(t){for(let i=0;i<this._actions.length;i++)this._actions[i].update(t)}isComplete(t){return this._actions.every(i=>i.isComplete(t))}reset(){this._actions.forEach(t=>t.reset())}stop(){this._actions.forEach(t=>t.stop())}}class In{constructor(t,i){this.bounds=t,this.options=i,this._defaultOptions={maxDepth:10,capacity:10,level:0},this.items=[],this._isDivided=!1,this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null,this.options={...this._defaultOptions,...i},this.halfWidth=t.width/2,this.halfHeight=t.height/2}_split(){this._isDivided=!0;const t={maxDepth:this.options.maxDepth,capacity:this.options.capacity,level:this.options.level+1};this.topLeft=new In(new et({left:this.bounds.left,top:this.bounds.top,right:this.bounds.left+this.halfWidth,bottom:this.bounds.top+this.halfHeight}),t),this.topRight=new In(new et({left:this.bounds.left+this.halfWidth,top:this.bounds.top,right:this.bounds.right,bottom:this.bounds.top+this.halfHeight}),t),this.bottomLeft=new In(new et({left:this.bounds.left,top:this.bounds.top+this.halfHeight,right:this.bounds.left+this.halfWidth,bottom:this.bounds.bottom}),t),this.bottomRight=new In(new et({left:this.bounds.left+this.halfWidth,top:this.bounds.top+this.halfHeight,right:this.bounds.right,bottom:this.bounds.bottom}),t)}_insertIntoSubNodes(t){var i,n,a,h;!((i=this.topLeft)===null||i===void 0)&&i.bounds.overlaps(t.bounds)&&this.topLeft.insert(t),!((n=this.topRight)===null||n===void 0)&&n.bounds.overlaps(t.bounds)&&this.topRight.insert(t),!((a=this.bottomLeft)===null||a===void 0)&&a.bounds.overlaps(t.bounds)&&this.bottomLeft.insert(t),!((h=this.bottomRight)===null||h===void 0)&&h.bounds.overlaps(t.bounds)&&this.bottomRight.insert(t)}insert(t){if(this._isDivided){this._insertIntoSubNodes(t);return}if(this.items.push(t),this.items.length>this.options.capacity&&this.options.level<this.options.maxDepth){this._isDivided||this._split();for(const i of this.items)this._insertIntoSubNodes(i);this.items.length=0}}remove(t){var i,n,a,h;if(this.bounds.overlaps(t.bounds)){if(!this._isDivided){const d=this.items.indexOf(t);d>-1&&this.items.splice(d,1);return}!((i=this.topLeft)===null||i===void 0)&&i.bounds.overlaps(t.bounds)&&this.topLeft.remove(t),!((n=this.topRight)===null||n===void 0)&&n.bounds.overlaps(t.bounds)&&this.topRight.remove(t),!((a=this.bottomLeft)===null||a===void 0)&&a.bounds.overlaps(t.bounds)&&this.bottomLeft.remove(t),!((h=this.bottomRight)===null||h===void 0)&&h.bounds.overlaps(t.bounds)&&this.bottomRight.remove(t)}}query(t){let i=this.items;return this._isDivided&&(this.topLeft.bounds.overlaps(t)&&(i=i.concat(this.topLeft.query(t))),this.topRight.bounds.overlaps(t)&&(i=i.concat(this.topRight.query(t))),this.bottomLeft.bounds.overlaps(t)&&(i=i.concat(this.bottomLeft.query(t))),this.bottomRight.bounds.overlaps(t)&&(i=i.concat(this.bottomRight.query(t)))),i=i.filter((n,a)=>i.indexOf(n)>=a),i}clear(){this.items=[],this._isDivided=!1,this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null}getAllItems(){let t=this.items;return this._isDivided&&(t=t.concat(this.topLeft.getAllItems()),t=t.concat(this.topRight.getAllItems()),t=t.concat(this.bottomLeft.getAllItems()),t=t.concat(this.bottomRight.getAllItems())),t=t.filter((i,n)=>t.indexOf(i)>=n),t}getTreeDepth(){return this._isDivided?1+Math.max(this.topLeft.getTreeDepth(),this.topRight.getTreeDepth(),this.bottomLeft.getTreeDepth(),this.bottomRight.getTreeDepth()):0}debug(t){this.bounds.draw(t,G.Yellow),this._isDivided&&(this.topLeft.bounds.draw(t,G.Yellow),this.topRight.bounds.draw(t,G.Yellow),this.bottomLeft.bounds.draw(t,G.Yellow),this.bottomRight.bounds.draw(t,G.Yellow))}}function cy(u){return!!u._initialize}function uy(u){return!!u.onInitialize}function dy(u){return!!u._preupdate}function fy(u){return!!u.onPreUpdate}function py(u){return!!u.onPostUpdate}function gy(u){return!!u.onPostUpdate}function my(u){return!!u.onPreDraw}function _y(u){return!!u.onPostDraw}class vy{constructor(t,i=G.Magenta,n=!1){this.path=t,this.color=i,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new dr(t,"arraybuffer",n),this._transparentColor=i}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){const t=await this._resource.load();this._stream=new Yf(t),this._gif=new $f(this._stream,this._transparentColor);const i=this._gif.images.map(n=>new pn(n.src,!1));return await Promise.all(i.map(n=>n.load())),this.data=this._textures=i}isLoaded(){return!!this.data}toSprite(t=0){return this._textures[t].toSprite()}toSpriteSheet(){const t=this._textures.map(i=>i.toSprite());return new Is({sprites:t})}toAnimation(t){const i=this.toSpriteSheet(),n=i.sprites.length;return this._animation=Pi.fromSpriteSheet(i,W(0,n),t),this._animation}get readCheckBytes(){return this._gif.checkBytes}}const ia=u=>u.reduce(function(t,i){return t*2+i},0),kh=u=>{const t=[];for(let i=7;i>=0;i--)t.push(!!(u&1<<i));return t};class Yf{constructor(t){if(this.data=null,this.len=0,this.position=0,this.readByte=()=>{if(this.position>=this.data.byteLength)throw new Error("Attempted to read past end of stream.");return this.data[this.position++]},this.readBytes=i=>{const n=[];for(let a=0;a<i;a++)n.push(this.readByte());return n},this.read=i=>{let n="";for(let a=0;a<i;a++)n+=String.fromCharCode(this.readByte());return n},this.readUnsigned=()=>{const i=this.readBytes(2);return(i[1]<<8)+i[0]},this.data=new Uint8Array(t),this.len=this.data.byteLength,this.len===0)throw new Error("No data loaded from file")}}const yy=function(u,t){let i=0;const n=function(R){let k=0;for(let M=0;M<R;M++)t.charCodeAt(i>>3)&1<<(i&7)&&(k|=1<<M),i++;return k},a=[],h=1<<u,d=h+1;let p=u+1,m=[];const y=function(){m=[],p=u+1;for(let R=0;R<h;R++)m[R]=[R];m[h]=[],m[d]=null};let w,b;for(;;){if(b=w,w=n(p),w===h){y();continue}if(w===d)break;if(w<m.length)b!==h&&m.push(m[b].concat(m[w][0]));else{if(w!==m.length)throw new Error("Invalid LZW code.");m.push(m[b].concat(m[b][0]))}a.push.apply(a,m[w]),m.length===1<<p&&p<12&&p++}return a};class $f{constructor(t,i=G.Magenta){this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=n=>{const a=[];for(let h=0;h<n;h++){const p="#"+this._st.readBytes(3).map(m=>{const y=m.toString(16);return y.length===1?"0"+y:y}).join("");a.push(p)}return a},this.readSubBlocks=()=>{let n,a;a="";do n=this._st.readByte(),a+=this._st.read(n);while(n!==0);return a},this.parseHeader=()=>{const n={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(n.sig=this._st.read(3),n.ver=this._st.read(3),n.sig!=="GIF")throw new Error("Not a GIF file.");n.width=this._st.readUnsigned(),n.height=this._st.readUnsigned();const a=kh(this._st.readByte());n.gctFlag=a.shift(),n.colorRes=ia(a.splice(0,3)),n.sorted=a.shift(),n.globalColorTableSize=ia(a.splice(0,3)),n.bgColor=this._st.readByte(),n.pixelAspectRatio=this._st.readByte(),n.gctFlag&&(n.globalColorTable=this.parseColorTable(1<<n.globalColorTableSize+1),this.globalColorTable=n.globalColorTable),this._handler.hdr&&this._handler.hdr(n)&&this.checkBytes.push(this._handler.hdr)},this.parseExt=n=>{const a=y=>{this.checkBytes.push(this._st.readByte());const w=kh(this._st.readByte());y.reserved=w.splice(0,3),y.disposalMethod=ia(w.splice(0,3)),y.userInput=w.shift(),y.transparencyGiven=w.shift(),y.delayTime=this._st.readUnsigned(),y.transparencyIndex=this._st.readByte(),y.terminator=this._st.readByte(),this._handler.gce&&this._handler.gce(y)&&this.checkBytes.push(this._handler.gce)},h=y=>{y.comment=this.readSubBlocks(),this._handler.com&&this._handler.com(y)&&this.checkBytes.push(this._handler.com)},d=y=>{this.checkBytes.push(this._st.readByte()),y.ptHeader=this._st.readBytes(12),y.ptData=this.readSubBlocks(),this._handler.pte&&this._handler.pte(y)&&this.checkBytes.push(this._handler.pte)},p=y=>{const w=R=>{this.checkBytes.push(this._st.readByte()),R.unknown=this._st.readByte(),R.iterations=this._st.readUnsigned(),R.terminator=this._st.readByte(),this._handler.app&&this._handler.app.NETSCAPE&&this._handler.app.NETSCAPE(R)&&this.checkBytes.push(this._handler.app)},b=R=>{R.appData=this.readSubBlocks(),this._handler.app&&this._handler.app[R.identifier]&&this._handler.app[R.identifier](R)&&this.checkBytes.push(this._handler.app[R.identifier])};switch(this.checkBytes.push(this._st.readByte()),y.identifier=this._st.read(8),y.authCode=this._st.read(3),y.identifier){case"NETSCAPE":w(y);break;default:b(y);break}},m=y=>{y.data=this.readSubBlocks(),this._handler.unknown&&this._handler.unknown(y)&&this.checkBytes.push(this._handler.unknown)};switch(n.label=this._st.readByte(),n.label){case 249:n.extType="gce",a(n);break;case 254:n.extType="com",h(n);break;case 1:n.extType="pte",d(n);break;case 255:n.extType="app",p(n);break;default:n.extType="unknown",m(n);break}},this.parseImg=n=>{const a=(p,m)=>{const y=new Array(p.length),w=p.length/m,b=(z,X)=>{const N=p.slice(X*m,(X+1)*m);y.splice.apply(y,[z*m,m].concat(N))},R=[0,4,2,1],k=[8,8,4,2];let M=0;for(let z=0;z<4;z++)for(let X=R[z];X<w;X+=k[z])b(X,M),M++;return y};n.leftPos=this._st.readUnsigned(),n.topPos=this._st.readUnsigned(),n.width=this._st.readUnsigned(),n.height=this._st.readUnsigned();const h=kh(this._st.readByte());n.lctFlag=h.shift(),n.interlaced=h.shift(),n.sorted=h.shift(),n.reserved=h.splice(0,2),n.lctSize=ia(h.splice(0,3)),n.lctFlag&&(n.lct=this.parseColorTable(1<<n.lctSize+1)),n.lzwMinCodeSize=this._st.readByte();const d=this.readSubBlocks();n.pixels=yy(n.lzwMinCodeSize,d),n.interlaced&&(n.pixels=a(n.pixels,n.width)),this.frames.push(n),this.arrayToImage(n),this._handler.img&&this._handler.img(n)&&this.checkBytes.push(this._handler)},this.parseBlock=()=>{const n={sentinel:this._st.readByte(),type:""};switch(String.fromCharCode(n.sentinel)){case"!":n.type="ext",this.parseExt(n);break;case",":n.type="img",this.parseImg(n);break;case";":n.type="eof",this._handler.eof&&this._handler.eof(n)&&this.checkBytes.push(this._handler.eof);break;default:throw new Error("Unknown block: 0x"+n.sentinel.toString(16))}n.type!=="eof"&&this.parseBlock()},this.arrayToImage=n=>{let a=0;const h=document.createElement("canvas");h.id=a.toString(),h.width=n.width,h.height=n.height,a++;const d=h.getContext("2d"),p=1;let m=0,y=0;for(let b=0;b<n.pixels.length;b++)y%n.width===0&&(m++,y=0),this.globalColorTable[n.pixels[b]]===this._transparentColor.toHex()?d.fillStyle="rgba(0, 0, 0, 0)":d.fillStyle=this.globalColorTable[n.pixels[b]],d.fillRect(y,m,p,p),y++;const w=new Image;w.src=h.toDataURL(),this.images.push(w)},this._st=t,this._handler={},this._transparentColor=i,this.parseHeader(),this.parseBlock()}}class wy{constructor(t,i,{bustCache:n,...a}={}){this.path=t,this.family=i,this._isLoaded=!1,this._resource=new dr(t,"blob",n),this._options=a}async load(){if(this.isLoaded())return this.data;try{const t=await this._resource.load(),i=URL.createObjectURL(t);this.data||(this.data=new FontFace(this.family,`url(${i})`),document.fonts.add(this.data)),await this.data.load(),this._isLoaded=!0}catch(t){throw`Error loading FontSource from path '${this.path}' with error [${t.message}]`}return this.data}isLoaded(){return this._isLoaded}toFont(t){return new zs({family:this.family,...this._options,...t})}}const xy=/^\s*(?:function)?\*/;function Qf(u){return typeof u!="function"?!1:xy.test(Function.prototype.toString.call(u))?!0:Object.getPrototypeOf?Object.getPrototypeOf(u)===Object.getPrototypeOf(new Function("return function * () {}")()):!1}function qf(...u){let t,i,n,a;Qf(u[0])&&(i=globalThis,t=u[0],n=u[1]),Qf(u[1])&&(i=u[0],t=u[1],n=u[2]),u[1]instanceof Pe&&(i=u[0],a=u[1],t=u[2],n=u[3]),u[0]instanceof Pe&&(i=globalThis,a=u[0],t=u[1],n=u[2]);const h=n==null?void 0:n.timing;let d;try{d=a??Pe.useEngine()}catch{throw Error(`Cannot run coroutine without engine parameter outside of an excalibur lifecycle method.
Pass an engine parameter to ex.coroutine(engine, function * {...})`)}const p=t.bind(i);return new Promise((m,y)=>{const w=p(),b=R=>{try{const{done:k,value:M}=w.next(R);k&&m(),M instanceof Promise?M.then(()=>{d.clock.schedule(b,0,h)}):M===void 0||M===void 0?d.clock.schedule(b,0,h):d.clock.schedule(b,M||0,h)}catch(k){y(k)}};b(d.clock.elapsed())})}class Fh extends pe{get progress(){return this._currentProgress}get complete(){return this.direction==="out"?this.progress>=1:this.progress<=0}constructor(t){var i,n,a,h;super(),this._logger=J.getInstance(),this.transform=new it,this.graphics=new ie,this._completeFuture=new _,this.started=!1,this._currentDistance=0,this._currentProgress=0,this.done=this._completeFuture.promise,this.name=`Transition#${this.id}`,this.duration=t.duration,this.easing=(i=t.easing)!==null&&i!==void 0?i:Rt.Linear,this.direction=(n=t.direction)!==null&&n!==void 0?n:"out",this.hideLoader=(a=t.hideLoader)!==null&&a!==void 0?a:!1,this.blockInput=(h=t.blockInput)!==null&&h!==void 0?h:!1,this.transform.coordPlane=te.Screen,this.transform.pos=E.Zero,this.transform.z=1/0,this.graphics.anchor=E.Zero,this.addComponent(this.transform),this.addComponent(this.graphics),this.direction==="out"?this._currentProgress=0:this._currentProgress=1}updateTransition(t,i){this.complete||(this._currentDistance+=O(i/this.duration,0,1),this._currentDistance>=1&&(this._currentDistance=1),this.direction==="out"?this._currentProgress=O(this.easing(this._currentDistance,0,1,1),0,1):this._currentProgress=O(this.easing(this._currentDistance,1,0,1),0,1))}async onPreviousSceneDeactivate(t){}onStart(t){}onUpdate(t){}onEnd(t){}onReset(){}reset(){this.started=!1,this._completeFuture=new _,this.done=this._completeFuture.promise,this._currentDistance=0,this.direction==="out"?this._currentProgress=0:this._currentProgress=1,this.onReset()}play(t,i){this.started&&(this.reset(),this._logger.warn(`Attempted to play a transition ${this.name} that is already playing, reset transition.`)),(i??t.currentScene).add(this);const a=this;return qf(t,function*(){for(;!a.complete;){const h=yield;a.updateTransition(t,h),a.execute()}})}execute(){this.isInitialized&&(this.started||(this.started=!0,this.onStart(this.progress)),this.onUpdate(this.progress),this.complete&&!this._completeFuture.isCompleted&&(this.onEnd(this.progress),this._completeFuture.resolve()))}}class by extends Fh{constructor(t){var i,n;super({...t,duration:(i=t.duration)!==null&&i!==void 0?i:2e3}),this.name=`FadeInOut#${this.id}`,this.color=(n=t.color)!==null&&n!==void 0?n:G.Black}onInitialize(t){this.transform.pos=t.screen.unsafeArea.topLeft,this.screenCover=new yr({width:t.screen.resolution.width,height:t.screen.resolution.height,color:this.color}),this.graphics.add(this.screenCover),this.graphics.opacity=this.progress}onReset(){this.graphics.opacity=this.progress}onStart(t){this.graphics.opacity=t}onEnd(t){this.graphics.opacity=t}onUpdate(t){this.graphics.opacity=t}}class Cy extends Fh{constructor(t){super({direction:"in",...t}),this.name=`CrossFade#${this.id}`}async onPreviousSceneDeactivate(t){this.image=await t.engine.screenshot(!0),await this.image.decode()}onInitialize(t){this.engine=t,this.transform.pos=t.screen.unsafeArea.topLeft,this.screenCover=pn.fromHtmlImageElement(this.image).toSprite(),this.graphics.add(this.screenCover),this.transform.scale=B(1/t.screen.pixelRatio,1/t.screen.pixelRatio),this.graphics.opacity=this.progress}onStart(t){this.graphics.opacity=this.progress}onReset(){this.graphics.opacity=this.progress}onEnd(t){this.graphics.opacity=t}onUpdate(t){this.graphics.opacity=t}}class Bh extends zt{constructor(t){super(),this.color=G.Black,this.thickness=1;const{start:i,end:n,color:a,thickness:h}=t;this.start=i,this.end=n,this.color=a??this.color,this.thickness=h??this.thickness,this._localBounds=this._calculateBounds();const{width:d,height:p}=this._localBounds;this.width=d,this.height=p}get localBounds(){return this._localBounds}_calculateBounds(){const t=this.end.sub(this.start).normal(),i=this.thickness/2,n=[this.start.add(t.scale(i)),this.end.add(t.scale(i)),this.end.add(t.scale(-i)),this.start.add(t.scale(-i))];return et.fromPoints(n)}_drawImage(t,i,n){t.drawLine(this.start,this.end,this.color,this.thickness)}clone(){return new Bh({start:this.start,end:this.end,color:this.color,thickness:this.thickness})}}class Mh extends mn{get points(){return this._points}set points(t){this._points=t;const i=this.minPoint;this.width=this._points.reduce((n,a)=>Math.max(a.x,n),0)-i.x,this.height=this._points.reduce((n,a)=>Math.max(a.y,n),0)-i.y,this.flagDirty()}get minPoint(){const t=this._points.reduce((n,a)=>Math.min(a.x,n),1/0),i=this._points.reduce((n,a)=>Math.min(a.y,n),1/0);return B(t,i)}constructor(t){super(t),this.points=t.points,this.filtering=Yt.Blended,this.rasterize()}clone(){return new Mh({points:this.points.map(t=>t.clone()),...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){if(this.points&&this.points.length){t.beginPath();const i=this.minPoint.negate(),n=this.points[0].add(i);t.moveTo(n.x,n.y),this.points.forEach(a=>{t.lineTo(a.x+i.x,a.y+i.y)}),t.lineTo(n.x,n.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}const Zf=5,Dn={},Sy=()=>{for(const u in Dn)Dn[u]=0},sa=(u,t)=>{const i=f.isEnabled("suppress-obsolete-message");Dn[u]<Zf&&!i&&(J.getInstance().warn(u),console.trace&&t.showStackTrace&&console.trace()),Dn[u]++};function Ey(u){return u={message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrace:!1,...u},function(t,i,n){if(n&&!(typeof n.value=="function"||typeof n.get=="function"||typeof n.set=="function"))throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");const h=`${`${t.name||""}${t.name&&i?".":""}${i||""}`} is marked obsolete: ${u.message}`+(u.alternateMethod?` Use ${u.alternateMethod} instead`:"");Dn[h]||(Dn[h]=0);const d=n?{...n}:t;if(!n){class p extends d{constructor(...y){sa(h,u),super(...y)}}return p}return n&&n.value?(d.value=function(){return sa(h,u),n.value.apply(this,arguments)},d):(n&&n.get&&(d.get=function(){return sa(h,u),n.get.apply(this,arguments)}),n&&n.set&&(d.set=function(){return sa(h,u),n.set.apply(this,arguments)}),d)}}class Ay{constructor(){this._queue=[]}get length(){return this._queue.length}enqueue(){const t=new _;return this._queue.push(t),t.promise}dequeue(t){this._queue.shift().resolve(t)}}class Ty{constructor(t){this._count=t,this._waitQueue=new Ay}get count(){return this._count}get waiting(){return this._waitQueue.length}async enter(){return this._count!==0?(this._count--,Promise.resolve()):this._waitQueue.enqueue()}exit(t=1){if(t!==0){for(;t!==0&&this._waitQueue.length!==0;)this._waitQueue.dequeue(null),t--;this._count+=t}}}const Lh="0.29.3";c()})();C.eKr;C.yVm;C.a7j;C.U_w;C.JF2;C.htg;C.HXL;C.mcg;var pc=C.Agj;C.u6S;C.x7M;C.X55;C.m3M;C.aE5;C.YJU;C.eZi;C.GNv;C.Y56;C._0v;C.vhs;C.Z8b;C.Yfw;C.IcQ;C.Rl2;C.kgJ;C.GTT;C.ypY;C.i7d;C.fQ3;C.HlI;C.jlt;C.VQc;C.zD7;C.I0I;C.AUF;C.JoF;C.MlA;C.PZh;C.qA;C.CrD;C.dQK;C.D3r;C.Qpo;C.D9n;C.b6v;C.mvh;var gc=C.Bpo,mc=C.Q1f;C.IKv;C.fcV;C.Glf;C.uAl;C.ElT;C.MPu;C.Z8r;C.QSL;C.sPV;C.nAn;C.zCU;C.QrV;C.fF9;C.xI8;C.yar;C.SP7;C.oRy;C.f5X;C.V1c;C.Mlx;C.ZCo;C.Vy3;C.J5p;C.mL_;C.Guw;C.VKx;C.N5j;C.pgY;C.OP3;C.rl5;C.eod;var l1=C.q5Z;C.YUC;C.saR;C.hvr;C.Qol;C.Wf4;C.JCs;C.gJV;C.fWD;C.Va_;var h1=C.N$8;C._jQ;C.rxj;C.rhv;C.wCu;C.HAp;C.Zy1;C.Qev;C.bkB;C.wfL;C.sVA;C.$Gs;C.CJ0;C.NWh;C.tWi;C.xAj;C.zWh;C.i_4;C.iIx;C.c9e;C.KQV;C.weH;C.jXp;C.zzY;C.yRQ;C.MtE;C.rPj;C.KLc;C.Fir;C.V5f;C.Xj7;C.Wud;C.FVg;C.g5Y;C.YQB;C.KPb;C.nHK;C.TX_;C.r3n;C.vYh;C.hnk;C.D2R;C.n1o;C.RLG;C.fBU;C.Adb;C.bEs;C.wCy;C.CbD;C.x_C;var c1=C.pde;C.pGf;C.ibQ;C.QlN;C.shR;C.Yjk;C._u1;C.OBI;C.klh;C.s3S;C.D$R;C.xth;C.JU7;C.h9x;C.N1A;C.e_k;C.aHM;C.tlv;C.Vi9;C.ieR;C.$bb;C.VyI;C.imn;C.uqu;C.QnL;C.vnc;C.wk_;C.GH0;C._1r;C.l0X;C.HHX;C.tjk;C.rWe;C.j9l;C.NVp;C.cPK;C.XoL;C.RmF;C.DXI;C.tCD;C.oGn;C.J3D;C.vCJ;C.f9l;C.AQx;C.v9m;C.yRJ;C.EU6;C.m3O;C.Ryz;C.OxP;C.LEs;C.Ec;C.Pi5;C.gmH;C.tS;C.XxX;C.bCz;C.nYS;C.yiT;C.NHl;C.mO8;C.PXI;C.bn5;C.Ywr;C.cMd;C.Bs6;C.G0k;C.pyn;C.QeM;C.aPX;C.ITP;C.BY0;C.MFw;C.sBn;C.S3L;C.XKQ;C.ESI;C.uxz;C.o8N;C.u_r;C.RlV;C.gVA;C.M_G;C.GRB;C.kM6;C.dO8;C.jgM;C.FWq;C.s3j;C.hlw;C.B7e;C.H_X;C.S_d;C.U7E;C.Z58;C.yh2;C.ff$;C.cWi;C.NBt;C.oNz;C.QlU;C.Xey;C.jft;C.Mtr;C.ypk;C.mnM;C.bAZ;C.ABN;C.VK6;C.kxk;C.DT1;C.FLG;C.qN_;C.Z37;C.FtL;C.Z6X;C.iQT;C.ziO;C.OEF;C.uuE;C.tiv;C.T$Y;C.EYj;C.nOB;C.Tap;C.FAs;C.B_P;C.aA5;var u1=C.M4G;C.l$l;C.dLy;C.WZP;C.eB6;C.nFK;C.l9z;C.YOF;C.yhB;C.J0N;C.Miz;C.Bj4;C.Rcs;C.vJ4;C.TqC;C.nM0;C.X1u;C.SpZ;C.DX8;C.Yx$;C.HK4;C.SE$;C.qE8;C.Pz7;C.sX_;C.JuI;C.Nl$;C.OwT;C.P$G;C.mHV;C.Fx_;C.WFC;C.aDq;C.jIg;C.UH3;C.K6X;C.C1Y;C.Aw1;C.A8$;C.hsx;C.l9E;C.aSf;C.Zex;C.mXP;C.vt$;C.hCA;C.pjR;C.U43;C.pSZ;C.y17;C.jVr;C._SZ;C.xWn;C.ehJ;C.t6s;C.Eyn;function d1(){const e=Q.useRef(null),s=Q.useRef(null),[r,o]=Q.useState(!1),l=50,c=50,f=()=>{if(e.current){const _=new h1({canvasElement:e.current,displayMode:l1.FillContainer});s.current=_;const v=new pc({x:_.drawWidth/2,y:_.drawHeight-l/2,width:_.drawWidth+100,height:l,color:mc.fromHex("333333")});v.body.collisionType=gc.Fixed,_.add(v);const x=new pc({x:100,y:_.drawHeight-l,width:50,height:50,color:mc.fromHex("ff0000")});x.body.collisionType=gc.Active,x.body.bounciness=0,_.add(x),_.input.keyboard.on("press",I=>{I.key===c1.Keys.Space&&x.vel.y===0&&(x.vel.y=-600)}),_.on("postupdate",()=>{x.pos.y<_.drawHeight-l-c/2?x.vel.y+=20:(x.vel.y=0,x.pos.y=_.drawHeight-l-c/2)});const S=()=>{const I=new pc({x:_.drawWidth+50,y:_.drawHeight-l,width:50,height:50,color:mc.fromHex("0000ff")});I.body.collisionType=gc.Active,I.vel.x=-200,_.add(I),I.on("exitviewport",()=>{I.pos.x+I.width<0&&_.remove(I)})},A=new u1({fcn:()=>S(),repeats:!0,randomRange:[500,1500],interval:1e3});_.currentScene.add(A),A.start(),x.on("collisionstart",I=>{I.other===v?x.vel.y=0:(_.stop(),o(!0))}),_.start()}},g=()=>{o(!1),s.current&&(s.current.stop(),s.current=null),f()};return Q.useEffect(()=>(f(),()=>{s.current&&s.current.stop()}),[]),Z.jsx("section",{className:"flex h-full items-center p-3",children:Z.jsxs("div",{className:"flex w-full flex-col items-center justify-center",children:[Z.jsx("canvas",{ref:e}),r&&Z.jsx("div",{style:{textAlign:"center",marginTop:20},children:Z.jsx("button",{onClick:g,style:{padding:"10px 20px",fontSize:"16px"},className:"rounded-md bg-secondary px-5 py-2 text-xs",children:"Restart Game"})})]})})}const Dg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAABHNCSVQICAgIfAhkiAAAATZJREFUSEtjZCAC/P//nwWoLB6IbYBYFYiVgVgCqvUzkL4CxD+BOIORkHlAwwyBatYAsRIhtUB5N7wGAg2zBCo6AMRsRBgGUoLbQKBh/EAF14FYkkjDQMrccboQaGAtUEETCYaBlHrgM/AukeGGbCd2A4GukwaqeoLHde+BcsVAfBCIHzIyMv6FqcXqQmhkHMNjoBfQkO3Y5HEZ6AxUvAeHgS+AhuGMKFwGugEN24nDwJNAAy1wuR6Xge5ADTtwaDoKNBCUY7CCIWAgMEYdsLjdBCjWjcNXoIIgF2sMMzIeYAQa+J/E3IBL+XNg2EpR08ADQAMdqWngDKCBmdQ0sBBo4ARqGugJNHAHNQ1UAhp4H2QgtZLNIaCB/4ZATsGWSoHBMJwLh1Evg0NgNJbRE8JQr/WonbABL1K4mEmaPHoAAAAASUVORK5CYII=",f1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAsCAYAAAD8WEF4AAAABHNCSVQICAgIfAhkiAAABIxJREFUWEe1mT1oFEEUx+8UURH8AAsFwaSwEAsTFMXGXAqxUTSkE8EEi5Qq+NEIRu1UUNsgehZiIxgsVFAwCoKiaMRGUPAshFj5AaIoeP7/4e3xbnZmdmZ3MjDZze7Me7+Zee/tm7l6u92+VKvVDqGGlm9o2Fuv13mdkwKmSQjeI8Lf4NqgvjpeLMc/06hrIzRPovNQRPvgpuBpovEB6fBdQMlXq/MPGjRweaQkfsJ9y6KhD8+WyfMjAOaqJCvgOAxhF5XAfuiYBe3ACrA2B4KyYddSQ9gInl+TvnzHNrZBRQ/AkM3+o5Dd1IJmZzYr6MBRbJT/L6MxR9pVDHuaQpvBaLK8TK4YV5YmyWJdNROWnV4rWUOAobHrAVFgCzWJOWDwPaIzA70OnSO2CeiCZQN0HsfllDS2ej7a7MX720pgl22FzrQ4N2eUk8TyGKANV/8crABrc7B6vuG101DSHwqZtYOMKdwPyP+dEBULy6UhcLbULnPQIe80gLkqQcUSovqKnNU6szK7OoxYPd8S8gahkLPlLUaI6oqlvo5OWAHWy2T1fOML2EK/XMjTACEhKsoMlE0Ver44CQflDXky+KAQVQpWFGjPpzlwqTtfFQWhQ17OHGJCVGlYgdGJhdXzfSEvNkRVhTXNwer5xhewE/KM54UhqhKszG4DV53s5D4EgKJN0n47IQ/3NCOdRRWGqMqwAqyTHdotbdNMdnTI+402i0R5cIhKBUtz0B8CV7KjQ16mO5dFuaCSwDrMweX5H5XSm1iBfbFwZnvvR8El3PD8FtrZct8reH5QZCTJfUvBygzrZKeJmRs1B4dBveJA5Hnl3LcKbJncNyrZSWIGmRDDHP7i+QbM8HutJFXuS5mlZ1YBa8+fAexqizl0hbwyuW8qWO4qxhXgCcCcM2Y3KOQVRYtKM4sl3gEF91HnKUVJc189gNKwAGVK+BR1iQicwXWVz/Njc98kDgalayDohYJ7gvth1A+o3l1vyHbfZQ7RMwtlnEmCrheh73DdCjv9YXh+aO6b298lgQXMfAi6h0pbZfmCugmgnzMFxiFIdO7rc7KomQXIVQjLvlS/ZEbfagWSaLeUOUTlvklgAXEUgs6LsH+47saM3rUJt+x6bblvD/p6t/um7KCZhfJd6HgHNWs/BtAJ3yyEeL6xJS9MdgphIXAzoOjtiwXuAkCP+UD5TswhNvf1JjtF5wZcKnr+SoHj+dYwYNtFsAJsJjuu3Febg/Pc13cisxQKX6KuE7BnuA4A9E8IaNYmMPc1t/vWc1/XwdwCKHtAOFHKk3AK+BoDqoB17us66Cvc7rtgb0BRtg0h4BaA8utUqsiuN/bcNxfybOezJ0F0Vqi45Fx6mkClYvH8XsvOWJsD9dl/UxCH4Pf9llDRiehM+tC4KvCUMi2XOThz387MYuTbIIiHGAuF6DhAs49AJUhluz2493q+L+RlPy3R45+jrhDBEwAdS0JoCDHMIVTFbMjjj3YE5C6Uo2Z5iLoTL/lJnZNiJDshOlpo1E/YM7jZLj3o+fsB+jNEQtk2stQMVTGl+R/V8GS18NcxwwAAAABJRU5ErkJggg==",p1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAw9JREFUWEetl4910zAQxusJgAlIJyCdgGQCygQ4E1AmoJ0AOgHpBLQTECagTEA6AWWC8P307vwusuTaTfSenu3T6e67v5Kbk8LY7XYzkT9oLmzZnyX2Gm2rBZ+3TdPclRibSDTF34LiKQqf4gXMVwG5jowdACmfa+GH5suKpAez6ClFrL8dYFoLxMrXEwCz/FdQ/g+0mrjufozGEo/kYgzhu8hAXUsutBMHgOUwMn7zLobH5yqugGlFJ7w+ltKxacz6P0bF8tmxlEs2iTzTxOJHfV/q/bPpuhGtBUAkXonI98FDcnHxFxN0L7lnFpKtaC+gi9YAYKN3T5qzsTHXvphoD9qH4G5o/VYf75yALt4z+nIPgDPVzLdw4cJzzbxaSFbK7MYULfQEBNZ2SZd5PAHY5ShLAMTWmktrZerb8Oh7izm85FRXSb2QBwC4cTagPGYwyYoiF4xH3oS90MnyXiVJH7zfjfcqeuCnNuC2vVHoEbj4IhcuvuhyZHRujwKNj7JnjAKwFiPlxEilU/ISNOumG72mLNc4LSQnQCcB+KsNxHJUj8hi/EkA6KjdmOSBjPlOwojf4MgaWy+shwAY3aRCYh8VQDGpSu44JoCZFPg5kdrpiBDEMusl7aQQWGZT017j1DZZXh1SEE9WGhLd8HlJaABaPb0J0VgAUbwjSDl88DOKjW2yBwwEVvvhAwhKC/dubZ1Dh9NvEYztWW+88BT7QDoeS761YxQQsd2WWJ22kqh1RVY8plMnxIrXMNcAGHKa0aXmxwHN3BvboTzJGtUqvw+8Kh0gUaE1GjI9NiWM4P64l3AVDxA+NyIdx7jKe30xbkO+nromfVx+57bvFACtPjzLN7JiOVXoWP6sAlKV+DWJzPYTrJpAYxVVXE8Okf1ufTqoHEDMTPaTbOkme4hS32uWc0F15STrHPnxzyjmAntRvtH0prPVO3PMWBgTVvPuiiFzrPPfkeTm/4YxQ8comsqD5eexk/Yaj7mrFaNXxlQlJX4UYxz/hXthLXY+l2Bg+HSXTgHjIdt6yy5t/g9cxM+6jM9e3QAAAABJRU5ErkJggg==",g1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAuCAYAAABap1twAAAABHNCSVQICAgIfAhkiAAAAvRJREFUWEftmItV2zAUhvEEpRM0maB0gsIEhQlqNmgnwJmgZYLCBA0TECZoO0HTDWCC8H9GShVHL2NRTE/uOYpzrNen+5Lkas/IarU6099aZWLfPdNzrnlnVVX9ZP6KH8F91+P4mYBC054Icl4JrlELtDc2uRXQFMDfIzBrSDmnAK7GpjqHZ7YDHGidnQYHKlD58H8Okhuph2x/qPI2oKorvSefHUTaxLTcW4N/NNpXFbajjyonBgBQQFwBaqLyQ+VSZalSq3xSeZVp+16AMwPHlsjEc7tfxiaTC+2rnj48Fwb0Qs8PGZDZgJeCqTXZQQ5UaGL1Z2F7GmOp/2j0TQIyG/DdEDAfhAAx97cSgL8Ehz8VFWN6tBjzxywNfhYggVFcBIkvEmwhyQKc4jPF6TSgAAkezqKPBnwS87o0iY0iqcFzaY+8tSUaGAevVdAup9/2iG5F9fT7okJ+xE0wp2+chV6+D6gwCdgeu7udnclt1ULtjhw4gooEbeVW9a8DgI3eh070SUCv//muCQJo7zeI6g/1uO4AHakJ2tqQhB/GAd1J3VE9OexKbdeXLpOQuUpYuVM9O8mWBBZj20UBowGigUk9tQpaqQWwsRebRWA+3lO/4aOdBYeuHVHAGw2KqZ5cIpHcD5C9WLT7Pl/KWYUxJ3vxhi8+FvDhXrptOnyNFEKCxfeWMTizKNIIR7PGA4eVugGV5YM0wm9Off7jBAqAtHN9jICw50GiG7CL7kJMBJNPvQGk98k0Y8ds9IekvQ4EJ1HnWJdFrgFNlNtvQbH+2YB2EKspQL07TGA22hP1aNVqNmdhvQFzBi3ZZgc4VJs7Db5YDd6JPOdu3JqY1BH6MjBUA6H+3LFJUynIFrBWw9T1rzToucmLHIZjypnZj+hk+djtqjTgUjvL1Fw9FxHIB0DEnDRQe2hfLA15zNaZgPwLWHr2PuMZSKzY/V4zDkDHil1XGxegcbVGT3vLGx+ggbSZZZyABpKT+2QdxX2c+l+2vQfOkqOdRa6s+AAAAABJRU5ErkJggg==",m1="/ais-telegram-webpages/assets/msw-6jIDzMdt.png",jv="/ais-telegram-webpages/assets/mgg-jRCbbsf_.png";function _1({task:e}){return Z.jsxs("div",{className:"task-card",children:[Z.jsx(dn,{src:e.icon}),Z.jsx("div",{className:"instruction",children:e.instruction}),Z.jsx("div",{className:"reward",children:Z.jsx("span",{children:e.reward})}),Z.jsx(md,{className:"cta-button",children:"Go"})]})}function v1(){const e=[{link:"/msw",icon:jv,instruction:"Join the MGG Community",reward:"1000000"},{link:"/mgg",icon:m1,instruction:"Join the MSW Community",reward:"1000000"},{link:"/facebook",icon:Dg,instruction:"Follow us on Facebook",reward:"1000000"},{link:"/x",icon:f1,instruction:"Follow us on X",reward:"1000000"},{link:"/instagram",icon:p1,instruction:"Follow us on Instagram",reward:"1000000"},{link:"/discord-mgg",icon:g1,instruction:"Join MGG Discord server",reward:"1000000"},{link:"/discord-msw",icon:Dg,instruction:"Join MSW Discord server",reward:"1000000"}];return Z.jsxs("section",{className:"flex-1 items-center overflow-auto",children:[Z.jsx("h1",{className:"py-3 text-center text-4xl font-bold text-white",children:"Tasks"}),Z.jsx("div",{className:"flex w-auto flex-col items-center gap-3 p-3",children:e.map((s,r)=>Z.jsx(_1,{task:s},r))})]})}/**
 * @remix-run/router v1.19.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vo(){return vo=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},vo.apply(this,arguments)}var ps;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ps||(ps={}));const kg="popstate";function y1(e){e===void 0&&(e={});function s(o,l){let{pathname:c,search:f,hash:g}=o.location;return yu("",{pathname:c,search:f,hash:g},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function r(o,l){return typeof l=="string"?l:Gv(l)}return x1(s,r,null,e)}function re(e,s){if(e===!1||e===null||typeof e>"u")throw new Error(s)}function Vv(e,s){if(!e){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function w1(){return Math.random().toString(36).substr(2,8)}function Fg(e,s){return{usr:e.state,key:e.key,idx:s}}function yu(e,s,r,o){return r===void 0&&(r=null),vo({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof s=="string"?cr(s):s,{state:r,key:s&&s.key||o||w1()})}function Gv(e){let{pathname:s="/",search:r="",hash:o=""}=e;return r&&r!=="?"&&(s+=r.charAt(0)==="?"?r:"?"+r),o&&o!=="#"&&(s+=o.charAt(0)==="#"?o:"#"+o),s}function cr(e){let s={};if(e){let r=e.indexOf("#");r>=0&&(s.hash=e.substr(r),e=e.substr(0,r));let o=e.indexOf("?");o>=0&&(s.search=e.substr(o),e=e.substr(0,o)),e&&(s.pathname=e)}return s}function x1(e,s,r,o){o===void 0&&(o={});let{window:l=document.defaultView,v5Compat:c=!1}=o,f=l.history,g=ps.Pop,_=null,v=x();v==null&&(v=0,f.replaceState(vo({},f.state,{idx:v}),""));function x(){return(f.state||{idx:null}).idx}function S(){g=ps.Pop;let O=x(),T=O==null?null:O-v;v=O,_&&_({action:g,location:L.location,delta:T})}function A(O,T){g=ps.Push;let P=yu(L.location,O,T);v=x()+1;let D=Fg(P,v),W=L.createHref(P);try{f.pushState(D,"",W)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;l.location.assign(W)}c&&_&&_({action:g,location:L.location,delta:1})}function I(O,T){g=ps.Replace;let P=yu(L.location,O,T);v=x();let D=Fg(P,v),W=L.createHref(P);f.replaceState(D,"",W),c&&_&&_({action:g,location:L.location,delta:0})}function F(O){let T=l.location.origin!=="null"?l.location.origin:l.location.href,P=typeof O=="string"?O:Gv(O);return P=P.replace(/ $/,"%20"),re(T,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,T)}let L={get action(){return g},get location(){return e(l,f)},listen(O){if(_)throw new Error("A history only accepts one active listener");return l.addEventListener(kg,S),_=O,()=>{l.removeEventListener(kg,S),_=null}},createHref(O){return s(l,O)},createURL:F,encodeLocation(O){let T=F(O);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:A,replace:I,go(O){return f.go(O)}};return L}var Bg;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Bg||(Bg={}));function b1(e,s,r){return r===void 0&&(r="/"),C1(e,s,r,!1)}function C1(e,s,r,o){let l=typeof s=="string"?cr(s):s,c=$v(l.pathname||"/",r);if(c==null)return null;let f=Xv(e);S1(f);let g=null;for(let _=0;g==null&&_<f.length;++_){let v=M1(c);g=F1(f[_],v,o)}return g}function Xv(e,s,r,o){s===void 0&&(s=[]),r===void 0&&(r=[]),o===void 0&&(o="");let l=(c,f,g)=>{let _={relativePath:g===void 0?c.path||"":g,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};_.relativePath.startsWith("/")&&(re(_.relativePath.startsWith(o),'Absolute route path "'+_.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_.relativePath=_.relativePath.slice(o.length));let v=sn([o,_.relativePath]),x=r.concat(_);c.children&&c.children.length>0&&(re(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),Xv(c.children,s,x,v)),!(c.path==null&&!c.index)&&s.push({path:v,score:D1(v,c.index),routesMeta:x})};return e.forEach((c,f)=>{var g;if(c.path===""||!((g=c.path)!=null&&g.includes("?")))l(c,f);else for(let _ of Yv(c.path))l(c,f,_)}),s}function Yv(e){let s=e.split("/");if(s.length===0)return[];let[r,...o]=s,l=r.endsWith("?"),c=r.replace(/\?$/,"");if(o.length===0)return l?[c,""]:[c];let f=Yv(o.join("/")),g=[];return g.push(...f.map(_=>_===""?c:[c,_].join("/"))),l&&g.push(...f),g.map(_=>e.startsWith("/")&&_===""?"/":_)}function S1(e){e.sort((s,r)=>s.score!==r.score?r.score-s.score:k1(s.routesMeta.map(o=>o.childrenIndex),r.routesMeta.map(o=>o.childrenIndex)))}const E1=/^:[\w-]+$/,A1=3,T1=2,P1=1,R1=10,I1=-2,Mg=e=>e==="*";function D1(e,s){let r=e.split("/"),o=r.length;return r.some(Mg)&&(o+=I1),s&&(o+=T1),r.filter(l=>!Mg(l)).reduce((l,c)=>l+(E1.test(c)?A1:c===""?P1:R1),o)}function k1(e,s){return e.length===s.length&&e.slice(0,-1).every((o,l)=>o===s[l])?e[e.length-1]-s[s.length-1]:0}function F1(e,s,r){let{routesMeta:o}=e,l={},c="/",f=[];for(let g=0;g<o.length;++g){let _=o[g],v=g===o.length-1,x=c==="/"?s:s.slice(c.length)||"/",S=Lg({path:_.relativePath,caseSensitive:_.caseSensitive,end:v},x),A=_.route;if(!S&&v&&r&&!o[o.length-1].route.index&&(S=Lg({path:_.relativePath,caseSensitive:_.caseSensitive,end:!1},x)),!S)return null;Object.assign(l,S.params),f.push({params:l,pathname:sn([c,S.pathname]),pathnameBase:H1(sn([c,S.pathnameBase])),route:A}),S.pathnameBase!=="/"&&(c=sn([c,S.pathnameBase]))}return f}function Lg(e,s){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,o]=B1(e.path,e.caseSensitive,e.end),l=s.match(r);if(!l)return null;let c=l[0],f=c.replace(/(.)\/+$/,"$1"),g=l.slice(1);return{params:o.reduce((v,x,S)=>{let{paramName:A,isOptional:I}=x;if(A==="*"){let L=g[S]||"";f=c.slice(0,c.length-L.length).replace(/(.)\/+$/,"$1")}const F=g[S];return I&&!F?v[A]=void 0:v[A]=(F||"").replace(/%2F/g,"/"),v},{}),pathname:c,pathnameBase:f,pattern:e}}function B1(e,s,r){s===void 0&&(s=!1),r===void 0&&(r=!0),Vv(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let o=[],l="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,g,_)=>(o.push({paramName:g,isOptional:_!=null}),_?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(o.push({paramName:"*"}),l+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?l+="\\/*$":e!==""&&e!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,s?void 0:"i"),o]}function M1(e){try{return e.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return Vv(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),e}}function $v(e,s){if(s==="/")return e;if(!e.toLowerCase().startsWith(s.toLowerCase()))return null;let r=s.endsWith("/")?s.length-1:s.length,o=e.charAt(r);return o&&o!=="/"?null:e.slice(r)||"/"}function L1(e,s){s===void 0&&(s="/");let{pathname:r,search:o="",hash:l=""}=typeof e=="string"?cr(e):e;return{pathname:r?r.startsWith("/")?r:O1(r,s):s,search:W1(o),hash:j1(l)}}function O1(e,s){let r=s.replace(/\/+$/,"").split("/");return e.split("/").forEach(l=>{l===".."?r.length>1&&r.pop():l!=="."&&r.push(l)}),r.length>1?r.join("/"):"/"}function _c(e,s,r,o){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function N1(e){return e.filter((s,r)=>r===0||s.route.path&&s.route.path.length>0)}function U1(e,s){let r=N1(e);return s?r.map((o,l)=>l===r.length-1?o.pathname:o.pathnameBase):r.map(o=>o.pathnameBase)}function z1(e,s,r,o){o===void 0&&(o=!1);let l;typeof e=="string"?l=cr(e):(l=vo({},e),re(!l.pathname||!l.pathname.includes("?"),_c("?","pathname","search",l)),re(!l.pathname||!l.pathname.includes("#"),_c("#","pathname","hash",l)),re(!l.search||!l.search.includes("#"),_c("#","search","hash",l)));let c=e===""||l.pathname==="",f=c?"/":l.pathname,g;if(f==null)g=r;else{let S=s.length-1;if(!o&&f.startsWith("..")){let A=f.split("/");for(;A[0]==="..";)A.shift(),S-=1;l.pathname=A.join("/")}g=S>=0?s[S]:"/"}let _=L1(l,g),v=f&&f!=="/"&&f.endsWith("/"),x=(c||f===".")&&r.endsWith("/");return!_.pathname.endsWith("/")&&(v||x)&&(_.pathname+="/"),_}const sn=e=>e.join("/").replace(/\/\/+/g,"/"),H1=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),W1=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,j1=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function V1(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Qv=["post","put","patch","delete"];new Set(Qv);const G1=["get",...Qv];new Set(G1);/**
 * React Router v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yo(){return yo=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},yo.apply(this,arguments)}const Cd=Q.createContext(null),X1=Q.createContext(null),Il=Q.createContext(null),Dl=Q.createContext(null),ur=Q.createContext({outlet:null,matches:[],isDataRoute:!1}),qv=Q.createContext(null);function kl(){return Q.useContext(Dl)!=null}function Zv(){return kl()||re(!1),Q.useContext(Dl).location}function Kv(e){Q.useContext(Il).static||Q.useLayoutEffect(e)}function Y1(){let{isDataRoute:e}=Q.useContext(ur);return e?oS():$1()}function $1(){kl()||re(!1);let e=Q.useContext(Cd),{basename:s,future:r,navigator:o}=Q.useContext(Il),{matches:l}=Q.useContext(ur),{pathname:c}=Zv(),f=JSON.stringify(U1(l,r.v7_relativeSplatPath)),g=Q.useRef(!1);return Kv(()=>{g.current=!0}),Q.useCallback(function(v,x){if(x===void 0&&(x={}),!g.current)return;if(typeof v=="number"){o.go(v);return}let S=z1(v,JSON.parse(f),c,x.relative==="path");e==null&&s!=="/"&&(S.pathname=S.pathname==="/"?s:sn([s,S.pathname])),(x.replace?o.replace:o.push)(S,x.state,x)},[s,o,f,c,e])}function Q1(e,s){return q1(e,s)}function q1(e,s,r,o){kl()||re(!1);let{navigator:l}=Q.useContext(Il),{matches:c}=Q.useContext(ur),f=c[c.length-1],g=f?f.params:{};f&&f.pathname;let _=f?f.pathnameBase:"/";f&&f.route;let v=Zv(),x;if(s){var S;let O=typeof s=="string"?cr(s):s;_==="/"||(S=O.pathname)!=null&&S.startsWith(_)||re(!1),x=O}else x=v;let A=x.pathname||"/",I=A;if(_!=="/"){let O=_.replace(/^\//,"").split("/");I="/"+A.replace(/^\//,"").split("/").slice(O.length).join("/")}let F=b1(e,{pathname:I}),L=eS(F&&F.map(O=>Object.assign({},O,{params:Object.assign({},g,O.params),pathname:sn([_,l.encodeLocation?l.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?_:sn([_,l.encodeLocation?l.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),c,r,o);return s&&L?Q.createElement(Dl.Provider,{value:{location:yo({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:ps.Pop}},L):L}function Z1(){let e=rS(),s=V1(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Q.createElement(Q.Fragment,null,Q.createElement("h2",null,"Unexpected Application Error!"),Q.createElement("h3",{style:{fontStyle:"italic"}},s),r?Q.createElement("pre",{style:l},r):null,null)}const K1=Q.createElement(Z1,null);class J1 extends Q.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,r){return r.location!==s.location||r.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:r.error,location:r.location,revalidation:s.revalidation||r.revalidation}}componentDidCatch(s,r){console.error("React Router caught the following error during render",s,r)}render(){return this.state.error!==void 0?Q.createElement(ur.Provider,{value:this.props.routeContext},Q.createElement(qv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function tS(e){let{routeContext:s,match:r,children:o}=e,l=Q.useContext(Cd);return l&&l.static&&l.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=r.route.id),Q.createElement(ur.Provider,{value:s},o)}function eS(e,s,r,o){var l;if(s===void 0&&(s=[]),r===void 0&&(r=null),o===void 0&&(o=null),e==null){var c;if(!r)return null;if(r.errors)e=r.matches;else if((c=o)!=null&&c.v7_partialHydration&&s.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let f=e,g=(l=r)==null?void 0:l.errors;if(g!=null){let x=f.findIndex(S=>S.route.id&&(g==null?void 0:g[S.route.id])!==void 0);x>=0||re(!1),f=f.slice(0,Math.min(f.length,x+1))}let _=!1,v=-1;if(r&&o&&o.v7_partialHydration)for(let x=0;x<f.length;x++){let S=f[x];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(v=x),S.route.id){let{loaderData:A,errors:I}=r,F=S.route.loader&&A[S.route.id]===void 0&&(!I||I[S.route.id]===void 0);if(S.route.lazy||F){_=!0,v>=0?f=f.slice(0,v+1):f=[f[0]];break}}}return f.reduceRight((x,S,A)=>{let I,F=!1,L=null,O=null;r&&(I=g&&S.route.id?g[S.route.id]:void 0,L=S.route.errorElement||K1,_&&(v<0&&A===0?(F=!0,O=null):v===A&&(F=!0,O=S.route.hydrateFallbackElement||null)));let T=s.concat(f.slice(0,A+1)),P=()=>{let D;return I?D=L:F?D=O:S.route.Component?D=Q.createElement(S.route.Component,null):S.route.element?D=S.route.element:D=x,Q.createElement(tS,{match:S,routeContext:{outlet:x,matches:T,isDataRoute:r!=null},children:D})};return r&&(S.route.ErrorBoundary||S.route.errorElement||A===0)?Q.createElement(J1,{location:r.location,revalidation:r.revalidation,component:L,error:I,children:P(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):P()},null)}var Jv=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Jv||{}),ll=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ll||{});function iS(e){let s=Q.useContext(Cd);return s||re(!1),s}function sS(e){let s=Q.useContext(X1);return s||re(!1),s}function nS(e){let s=Q.useContext(ur);return s||re(!1),s}function t0(e){let s=nS(),r=s.matches[s.matches.length-1];return r.route.id||re(!1),r.route.id}function rS(){var e;let s=Q.useContext(qv),r=sS(ll.UseRouteError),o=t0(ll.UseRouteError);return s!==void 0?s:(e=r.errors)==null?void 0:e[o]}function oS(){let{router:e}=iS(Jv.UseNavigateStable),s=t0(ll.UseNavigateStable),r=Q.useRef(!1);return Kv(()=>{r.current=!0}),Q.useCallback(function(l,c){c===void 0&&(c={}),r.current&&(typeof l=="number"?e.navigate(l):e.navigate(l,yo({fromRouteId:s},c)))},[e,s])}function Ma(e){re(!1)}function aS(e){let{basename:s="/",children:r=null,location:o,navigationType:l=ps.Pop,navigator:c,static:f=!1,future:g}=e;kl()&&re(!1);let _=s.replace(/^\/*/,"/"),v=Q.useMemo(()=>({basename:_,navigator:c,static:f,future:yo({v7_relativeSplatPath:!1},g)}),[_,g,c,f]);typeof o=="string"&&(o=cr(o));let{pathname:x="/",search:S="",hash:A="",state:I=null,key:F="default"}=o,L=Q.useMemo(()=>{let O=$v(x,_);return O==null?null:{location:{pathname:O,search:S,hash:A,state:I,key:F},navigationType:l}},[_,x,S,A,I,F,l]);return L==null?null:Q.createElement(Il.Provider,{value:v},Q.createElement(Dl.Provider,{children:r,value:L}))}function lS(e){let{children:s,location:r}=e;return Q1(wu(s),r)}new Promise(()=>{});function wu(e,s){s===void 0&&(s=[]);let r=[];return Q.Children.forEach(e,(o,l)=>{if(!Q.isValidElement(o))return;let c=[...s,l];if(o.type===Q.Fragment){r.push.apply(r,wu(o.props.children,c));return}o.type!==Ma&&re(!1),!o.props.index||!o.props.children||re(!1);let f={id:o.props.id||c.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(f.children=wu(o.props.children,c)),r.push(f)}),r}/**
 * React Router DOM v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const hS="6";try{window.__reactRouterVersion=hS}catch{}const cS="startTransition",Og=Gy[cS];function uS(e){let{basename:s,children:r,future:o,window:l}=e,c=Q.useRef();c.current==null&&(c.current=y1({window:l,v5Compat:!0}));let f=c.current,[g,_]=Q.useState({action:f.action,location:f.location}),{v7_startTransition:v}=o||{},x=Q.useCallback(S=>{v&&Og?Og(()=>_(S)):_(S)},[_,v]);return Q.useLayoutEffect(()=>f.listen(x),[f,x]),Q.createElement(aS,{basename:s,children:r,location:g.location,navigationType:g.action,navigator:f,future:o})}var Ng;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ng||(Ng={}));var Ug;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Ug||(Ug={}));const dS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAgCAYAAAB6kdqOAAAABHNCSVQICAgIfAhkiAAAAVlJREFUWEft1m0RwjAMBmDqAAk4YBJACVjAwXCAA0ABEhgOkAAOhgJ4C+tuK2uT9IMf3HbXP3RNH9I2nXrimeR9jkqptT0Fpp3itxPaBv1X068yg3yYMxAFWo22NKicIA7GJKZF5QJJMH3UwJJd8EYVsa1qpH/n2DNmmVzh70MZ2iJgGQH6GtpsYArzwMBFdpAIg9OWFSTF6NRmA4VggkCugtbdOKEYMciaqFfQDCgGIwI5JuqhYjFsEDHRG4V2Q+Md7c7dZdcI1qYG6ICBK09t0igN0neT6/nUGQ9GmqEKA+aBBZOFYYP0i82yhaCcGMQs7Iyxlsw6QRKUD7NH3Lt9TYlAwkxRmDXifd2bYhATxcHoUGlABIqLSQtyoLynaeDbK12GBjb6jKozPwF1MjWjit7PQNxiOYKoTP1Nhqg/mrKfdexTTkjFGkFBGSqpURn7KxRT/TnTPi+ImnZn2O6OawAAAABJRU5ErkJggg==",fS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAXCAYAAACf+8ZRAAAABHNCSVQICAgIfAhkiAAAAmhJREFUWEfFl481BDEQh20FdOBU4FRgVcBVgApQgVUBKuAqQAVOBVwFVgWo4Py+ldzL7uXfsUfey3u7m5nJl8lkMlusRdpsNtvX8IH6QL2MyfY0NpGdWv2+KIqHkM3CNyDYQ32vDGxPPEubAb4S/Lir2YIW7IYEbox3l55lRQr3snss+A9rfw5tgB81MFzR5L8x+yLlPQvuQt9FPEx8oWjbqR7Wf0PxA13ifIReAy0vH5mw8NqScDeMKgme/2DimMqUGFafmN3mebejQJjcWuhXDQ5CFv8AGuDSjVvjTBbggteS2SrkZVIaoRFsfwDdeLALILZS3zhnbhsBjTAp7j+hOWR4tdXExu4TBW4bA93dggcZwPvZTTbIOM/ZCouCIU/7ouAJ6FnHxoWgq2UBPHZSJp6MADFbq++4MR1JwR//AQ3sgQU0IcAFQgq9Uie1EhakVe+dATSr3HTcskpPfwLkyRLLhNfUF9Ncl6x43jTJhftuTrWbipg05xwEz4ts4uHtVExpvIlptuEyJtxjyhvL1pFvLk9CCCGdAU38dNNKS6FH6IUDx0Tm0L1neBmRLXsj3uolmKt7hGZS5jpzDiKVZW6h1uyUhcbbxFSoCCIdzQsmeSZWXOU4DI9be6WeAU81DvFQHLVb5SWv85TVFY+PBExq/K7ybEtVewkoih4OdaiRkXKyg0+/dWMu/G6ZK5kVubk75cRreSEG3OjLNuAnKWPO+JueuYjcWr7taY/XAQl5hxhjcfzH1bkgJltVwKiHzhC7duWr/JjH+2PbgR/onV6a7wBS105yQUNy5pKy9hHDJrajTvgCAZ8NyvA3Y5cAAAAASUVORK5CYII=";function pS(){const[e,s]=Q.useState("/exchange"),r=[{key:"/",icon:jv,label:"Home"},{key:"/tasks",icon:dS,label:"Tasks"},{key:"/jumping-game",icon:fS,label:"Minigames"}],o=Y1(),l=c=>{s(c),o(c)};return Z.jsx("nav",{className:"flex flex-row justify-center gap-2 bg-violet-800 px-1 py-2",children:r.map(c=>Z.jsx(fg,{className:`nav-card basis-1/6 ${e===c.key?"active":""}`,onClick:()=>l(c.key),children:Z.jsxs(fg.Body,{className:"bottomnav-card-body",children:[Z.jsx(dn,{src:c.icon,className:"img-fluid",rounded:!0,draggable:"false"}),Z.jsx("div",{className:"text-center align-text-bottom text-xs",children:c.label})]})},c.key))})}const gS=e=>new Promise((s,r)=>{const o=document.querySelector(`script[src="${e}"]`);if(o){s(o);return}const l=document.createElement("script");l.src=e,l.async=!0,l.onload=()=>s(l),l.onerror=()=>r(new Error(`Failed to load script: ${e}`)),document.head.appendChild(l)}),Sd=Q.createContext(null);function mS(){const[e,s]=Q.useState(null),r="https://telegram.org/js/telegram-web-app.js",o="https://ec51-103-225-136-38.ngrok-free.app",{setPlayFabId:l}=Wv();return Q.useEffect(()=>{const c=async _=>{try{const x=await(await fetch(o+"/playFab/validate/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({initData:_})})).json();x.valid?(l(x.loginData.PlayFabId),console.log(x)):console.error("Data validation failed!")}catch(v){console.error("Error validating data:",v)}};(async()=>{var _,v,x,S;try{await gS(r),console.log("Script loaded");const A=()=>window.Telegram!==void 0&&window.Telegram.WebApp!==void 0&&window.Telegram.WebApp.initData!=="";console.log(window.Telegram!==void 0),console.log((_=window.Telegram)==null?void 0:_.WebApp),console.log((x=(v=window.Telegram)==null?void 0:v.WebApp)==null?void 0:x.initData),console.log(A());let I;A()?(I=(S=window.Telegram)==null?void 0:S.WebApp,I.ready(),c(I.initData),s(I),console.log("Telegram initialized:",JSON.stringify(I)),I.expand(),I.onEvent("mainButtonClicked",()=>{console.log("Main Button Clicked")})):await rb(async()=>{const{mockTelegram:F}=await import("./mockTelegramAPI-DvOFz-i2.js");return{mockTelegram:F}},[]).then(({mockTelegram:F})=>{var L;F(),I=(L=window.Telegram)==null?void 0:L.WebApp,I&&(s(I),console.log("Using mock data:",JSON.stringify(I)))})}catch(A){console.error("Error loading Telegram Web App script:",A)}})();const g=()=>{console.log("Viewport changed. App may have been resized, minimized, or put in the background.")};return()=>{window.Telegram&&window.Telegram.WebApp&&window.Telegram.WebApp.offEvent("viewportChanged",g)}},[]),Z.jsx(Sd.Provider,{value:{tgData:e,setTgData:s},children:Z.jsx(uS,{basename:"/ais-telegram-webpages",children:Z.jsxs("main",{className:"flex h-dvh flex-col overflow-hidden bg-violet-900",children:[Z.jsx("div",{className:"flex flex-1 flex-col overflow-hidden",children:Z.jsxs(lS,{children:[Z.jsx(Ma,{path:"/",element:Z.jsx(o1,{})}),Z.jsx(Ma,{path:"/tasks",element:Z.jsx(v1,{})}),Z.jsx(Ma,{path:"/jumping-game",element:Z.jsx(d1,{})})]})}),Z.jsx(pS,{})]})})})}vc.createRoot(document.getElementById("root")).render(Z.jsx(qg.StrictMode,{children:Z.jsxs(r1,{children:[Z.jsx(mS,{}),","]})}));
